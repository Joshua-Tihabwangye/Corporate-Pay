var tM=Object.defineProperty;var sM=(t,s,a)=>s in t?tM(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a;var kw=(t,s,a)=>sM(t,typeof s!="symbol"?s+"":s,a);function aM(t,s){for(var a=0;a<s.length;a++){const l=s[a];if(typeof l!="string"&&!Array.isArray(l)){for(const n in l)if(n!=="default"&&!(n in t)){const r=Object.getOwnPropertyDescriptor(l,n);r&&Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:()=>l[n]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function a(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(n){if(n.ep)return;n.ep=!0;const r=a(n);fetch(n.href,r)}})();function lM(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Bo(t){if(t.__esModule)return t;var s=t.default;if(typeof s=="function"){var a=function l(){return this instanceof l?Reflect.construct(s,arguments,this.constructor):s.apply(this,arguments)};a.prototype=s.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(t).forEach(function(l){var n=Object.getOwnPropertyDescriptor(t,l);Object.defineProperty(a,l,n.get?n:{enumerable:!0,get:function(){return t[l]}})}),a}var OC={exports:{}},yg={},TC={exports:{}},es={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zx=Symbol.for("react.element"),nM=Symbol.for("react.portal"),rM=Symbol.for("react.fragment"),iM=Symbol.for("react.strict_mode"),oM=Symbol.for("react.profiler"),dM=Symbol.for("react.provider"),cM=Symbol.for("react.context"),uM=Symbol.for("react.forward_ref"),mM=Symbol.for("react.suspense"),xM=Symbol.for("react.memo"),pM=Symbol.for("react.lazy"),Cw=Symbol.iterator;function hM(t){return t===null||typeof t!="object"?null:(t=Cw&&t[Cw]||t["@@iterator"],typeof t=="function"?t:null)}var RC={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},DC=Object.assign,IC={};function Au(t,s,a){this.props=t,this.context=s,this.refs=IC,this.updater=a||RC}Au.prototype.isReactComponent={};Au.prototype.setState=function(t,s){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,s,"setState")};Au.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function $C(){}$C.prototype=Au.prototype;function py(t,s,a){this.props=t,this.context=s,this.refs=IC,this.updater=a||RC}var hy=py.prototype=new $C;hy.constructor=py;DC(hy,Au.prototype);hy.isPureReactComponent=!0;var Sw=Array.isArray,LC=Object.prototype.hasOwnProperty,gy={current:null},FC={key:!0,ref:!0,__self:!0,__source:!0};function UC(t,s,a){var l,n={},r=null,i=null;if(s!=null)for(l in s.ref!==void 0&&(i=s.ref),s.key!==void 0&&(r=""+s.key),s)LC.call(s,l)&&!FC.hasOwnProperty(l)&&(n[l]=s[l]);var o=arguments.length-2;if(o===1)n.children=a;else if(1<o){for(var c=Array(o),x=0;x<o;x++)c[x]=arguments[x+2];n.children=c}if(t&&t.defaultProps)for(l in o=t.defaultProps,o)n[l]===void 0&&(n[l]=o[l]);return{$$typeof:Zx,type:t,key:r,ref:i,props:n,_owner:gy.current}}function gM(t,s){return{$$typeof:Zx,type:t.type,key:s,ref:t.ref,props:t.props,_owner:t._owner}}function fy(t){return typeof t=="object"&&t!==null&&t.$$typeof===Zx}function fM(t){var s={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(a){return s[a]})}var Aw=/\/+/g;function Af(t,s){return typeof t=="object"&&t!==null&&t.key!=null?fM(""+t.key):s.toString(36)}function Qh(t,s,a,l,n){var r=typeof t;(r==="undefined"||r==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(r){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case Zx:case nM:i=!0}}if(i)return i=t,n=n(i),t=l===""?"."+Af(i,0):l,Sw(n)?(a="",t!=null&&(a=t.replace(Aw,"$&/")+"/"),Qh(n,s,a,"",function(x){return x})):n!=null&&(fy(n)&&(n=gM(n,a+(!n.key||i&&i.key===n.key?"":(""+n.key).replace(Aw,"$&/")+"/")+t)),s.push(n)),1;if(i=0,l=l===""?".":l+":",Sw(t))for(var o=0;o<t.length;o++){r=t[o];var c=l+Af(r,o);i+=Qh(r,s,a,c,n)}else if(c=hM(t),typeof c=="function")for(t=c.call(t),o=0;!(r=t.next()).done;)r=r.value,c=l+Af(r,o++),i+=Qh(r,s,a,c,n);else if(r==="object")throw s=String(t),Error("Objects are not valid as a React child (found: "+(s==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":s)+"). If you meant to render a collection of children, use an array instead.");return i}function gp(t,s,a){if(t==null)return t;var l=[],n=0;return Qh(t,l,"","",function(r){return s.call(a,r,n++)}),l}function vM(t){if(t._status===-1){var s=t._result;s=s(),s.then(function(a){(t._status===0||t._status===-1)&&(t._status=1,t._result=a)},function(a){(t._status===0||t._status===-1)&&(t._status=2,t._result=a)}),t._status===-1&&(t._status=0,t._result=s)}if(t._status===1)return t._result.default;throw t._result}var tn={current:null},Yh={transition:null},bM={ReactCurrentDispatcher:tn,ReactCurrentBatchConfig:Yh,ReactCurrentOwner:gy};function VC(){throw Error("act(...) is not supported in production builds of React.")}es.Children={map:gp,forEach:function(t,s,a){gp(t,function(){s.apply(this,arguments)},a)},count:function(t){var s=0;return gp(t,function(){s++}),s},toArray:function(t){return gp(t,function(s){return s})||[]},only:function(t){if(!fy(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};es.Component=Au;es.Fragment=rM;es.Profiler=oM;es.PureComponent=py;es.StrictMode=iM;es.Suspense=mM;es.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bM;es.act=VC;es.cloneElement=function(t,s,a){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var l=DC({},t.props),n=t.key,r=t.ref,i=t._owner;if(s!=null){if(s.ref!==void 0&&(r=s.ref,i=gy.current),s.key!==void 0&&(n=""+s.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(c in s)LC.call(s,c)&&!FC.hasOwnProperty(c)&&(l[c]=s[c]===void 0&&o!==void 0?o[c]:s[c])}var c=arguments.length-2;if(c===1)l.children=a;else if(1<c){o=Array(c);for(var x=0;x<c;x++)o[x]=arguments[x+2];l.children=o}return{$$typeof:Zx,type:t.type,key:n,ref:r,props:l,_owner:i}};es.createContext=function(t){return t={$$typeof:cM,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:dM,_context:t},t.Consumer=t};es.createElement=UC;es.createFactory=function(t){var s=UC.bind(null,t);return s.type=t,s};es.createRef=function(){return{current:null}};es.forwardRef=function(t){return{$$typeof:uM,render:t}};es.isValidElement=fy;es.lazy=function(t){return{$$typeof:pM,_payload:{_status:-1,_result:t},_init:vM}};es.memo=function(t,s){return{$$typeof:xM,type:t,compare:s===void 0?null:s}};es.startTransition=function(t){var s=Yh.transition;Yh.transition={};try{t()}finally{Yh.transition=s}};es.unstable_act=VC;es.useCallback=function(t,s){return tn.current.useCallback(t,s)};es.useContext=function(t){return tn.current.useContext(t)};es.useDebugValue=function(){};es.useDeferredValue=function(t){return tn.current.useDeferredValue(t)};es.useEffect=function(t,s){return tn.current.useEffect(t,s)};es.useId=function(){return tn.current.useId()};es.useImperativeHandle=function(t,s,a){return tn.current.useImperativeHandle(t,s,a)};es.useInsertionEffect=function(t,s){return tn.current.useInsertionEffect(t,s)};es.useLayoutEffect=function(t,s){return tn.current.useLayoutEffect(t,s)};es.useMemo=function(t,s){return tn.current.useMemo(t,s)};es.useReducer=function(t,s,a){return tn.current.useReducer(t,s,a)};es.useRef=function(t){return tn.current.useRef(t)};es.useState=function(t){return tn.current.useState(t)};es.useSyncExternalStore=function(t,s,a){return tn.current.useSyncExternalStore(t,s,a)};es.useTransition=function(){return tn.current.useTransition()};es.version="18.3.1";TC.exports=es;var d=TC.exports;const Xt=lM(d),y0=aM({__proto__:null,default:Xt},[d]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jM=d,yM=Symbol.for("react.element"),NM=Symbol.for("react.fragment"),wM=Object.prototype.hasOwnProperty,kM=jM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,CM={key:!0,ref:!0,__self:!0,__source:!0};function _C(t,s,a){var l,n={},r=null,i=null;a!==void 0&&(r=""+a),s.key!==void 0&&(r=""+s.key),s.ref!==void 0&&(i=s.ref);for(l in s)wM.call(s,l)&&!CM.hasOwnProperty(l)&&(n[l]=s[l]);if(t&&t.defaultProps)for(l in s=t.defaultProps,s)n[l]===void 0&&(n[l]=s[l]);return{$$typeof:yM,type:t,key:r,ref:i,props:n,_owner:kM.current}}yg.Fragment=NM;yg.jsx=_C;yg.jsxs=_C;OC.exports=yg;var e=OC.exports,Ob={},BC={exports:{}},Ln={},GC={exports:{}},qC={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function s(Y,Ie){var ce=Y.length;Y.push(Ie);e:for(;0<ce;){var me=ce-1>>>1,pe=Y[me];if(0<n(pe,Ie))Y[me]=Ie,Y[ce]=pe,ce=me;else break e}}function a(Y){return Y.length===0?null:Y[0]}function l(Y){if(Y.length===0)return null;var Ie=Y[0],ce=Y.pop();if(ce!==Ie){Y[0]=ce;e:for(var me=0,pe=Y.length,de=pe>>>1;me<de;){var ye=2*(me+1)-1,Qe=Y[ye],Fe=ye+1,ke=Y[Fe];if(0>n(Qe,ce))Fe<pe&&0>n(ke,Qe)?(Y[me]=ke,Y[Fe]=ce,me=Fe):(Y[me]=Qe,Y[ye]=ce,me=ye);else if(Fe<pe&&0>n(ke,ce))Y[me]=ke,Y[Fe]=ce,me=Fe;else break e}}return Ie}function n(Y,Ie){var ce=Y.sortIndex-Ie.sortIndex;return ce!==0?ce:Y.id-Ie.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;t.unstable_now=function(){return r.now()}}else{var i=Date,o=i.now();t.unstable_now=function(){return i.now()-o}}var c=[],x=[],j=1,g=null,N=3,$=!1,T=!1,k=!1,q=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function U(Y){for(var Ie=a(x);Ie!==null;){if(Ie.callback===null)l(x);else if(Ie.startTime<=Y)l(x),Ie.sortIndex=Ie.expirationTime,s(c,Ie);else break;Ie=a(x)}}function ae(Y){if(k=!1,U(Y),!T)if(a(c)!==null)T=!0,Oe(ie);else{var Ie=a(x);Ie!==null&&he(ae,Ie.startTime-Y)}}function ie(Y,Ie){T=!1,k&&(k=!1,L(J),J=-1),$=!0;var ce=N;try{for(U(Ie),g=a(c);g!==null&&(!(g.expirationTime>Ie)||Y&&!be());){var me=g.callback;if(typeof me=="function"){g.callback=null,N=g.priorityLevel;var pe=me(g.expirationTime<=Ie);Ie=t.unstable_now(),typeof pe=="function"?g.callback=pe:g===a(c)&&l(c),U(Ie)}else l(c);g=a(c)}if(g!==null)var de=!0;else{var ye=a(x);ye!==null&&he(ae,ye.startTime-Ie),de=!1}return de}finally{g=null,N=ce,$=!1}}var _=!1,W=null,J=-1,we=5,G=-1;function be(){return!(t.unstable_now()-G<we)}function Ge(){if(W!==null){var Y=t.unstable_now();G=Y;var Ie=!0;try{Ie=W(!0,Y)}finally{Ie?Me():(_=!1,W=null)}}else _=!1}var Me;if(typeof R=="function")Me=function(){R(Ge)};else if(typeof MessageChannel<"u"){var je=new MessageChannel,Ue=je.port2;je.port1.onmessage=Ge,Me=function(){Ue.postMessage(null)}}else Me=function(){q(Ge,0)};function Oe(Y){W=Y,_||(_=!0,Me())}function he(Y,Ie){J=q(function(){Y(t.unstable_now())},Ie)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Y){Y.callback=null},t.unstable_continueExecution=function(){T||$||(T=!0,Oe(ie))},t.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):we=0<Y?Math.floor(1e3/Y):5},t.unstable_getCurrentPriorityLevel=function(){return N},t.unstable_getFirstCallbackNode=function(){return a(c)},t.unstable_next=function(Y){switch(N){case 1:case 2:case 3:var Ie=3;break;default:Ie=N}var ce=N;N=Ie;try{return Y()}finally{N=ce}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Y,Ie){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var ce=N;N=Y;try{return Ie()}finally{N=ce}},t.unstable_scheduleCallback=function(Y,Ie,ce){var me=t.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?me+ce:me):ce=me,Y){case 1:var pe=-1;break;case 2:pe=250;break;case 5:pe=1073741823;break;case 4:pe=1e4;break;default:pe=5e3}return pe=ce+pe,Y={id:j++,callback:Ie,priorityLevel:Y,startTime:ce,expirationTime:pe,sortIndex:-1},ce>me?(Y.sortIndex=ce,s(x,Y),a(c)===null&&Y===a(x)&&(k?(L(J),J=-1):k=!0,he(ae,ce-me))):(Y.sortIndex=pe,s(c,Y),T||$||(T=!0,Oe(ie))),Y},t.unstable_shouldYield=be,t.unstable_wrapCallback=function(Y){var Ie=N;return function(){var ce=N;N=Ie;try{return Y.apply(this,arguments)}finally{N=ce}}}})(qC);GC.exports=qC;var SM=GC.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AM=d,In=SM;function at(t){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+t,a=1;a<arguments.length;a++)s+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+t+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var zC=new Set,bx={};function Wd(t,s){pu(t,s),pu(t+"Capture",s)}function pu(t,s){for(bx[t]=s,t=0;t<s.length;t++)zC.add(s[t])}var Mi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tb=Object.prototype.hasOwnProperty,EM=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ew={},Mw={};function MM(t){return Tb.call(Mw,t)?!0:Tb.call(Ew,t)?!1:EM.test(t)?Mw[t]=!0:(Ew[t]=!0,!1)}function PM(t,s,a,l){if(a!==null&&a.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return l?!1:a!==null?!a.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function OM(t,s,a,l){if(s===null||typeof s>"u"||PM(t,s,a,l))return!0;if(l)return!1;if(a!==null)switch(a.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function sn(t,s,a,l,n,r,i){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=l,this.attributeNamespace=n,this.mustUseProperty=a,this.propertyName=t,this.type=s,this.sanitizeURL=r,this.removeEmptyString=i}var kl={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){kl[t]=new sn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var s=t[0];kl[s]=new sn(s,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){kl[t]=new sn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){kl[t]=new sn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){kl[t]=new sn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){kl[t]=new sn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){kl[t]=new sn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){kl[t]=new sn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){kl[t]=new sn(t,5,!1,t.toLowerCase(),null,!1,!1)});var vy=/[\-:]([a-z])/g;function by(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var s=t.replace(vy,by);kl[s]=new sn(s,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var s=t.replace(vy,by);kl[s]=new sn(s,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var s=t.replace(vy,by);kl[s]=new sn(s,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){kl[t]=new sn(t,1,!1,t.toLowerCase(),null,!1,!1)});kl.xlinkHref=new sn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){kl[t]=new sn(t,1,!1,t.toLowerCase(),null,!0,!0)});function jy(t,s,a,l){var n=kl.hasOwnProperty(s)?kl[s]:null;(n!==null?n.type!==0:l||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(OM(s,a,n,l)&&(a=null),l||n===null?MM(s)&&(a===null?t.removeAttribute(s):t.setAttribute(s,""+a)):n.mustUseProperty?t[n.propertyName]=a===null?n.type===3?!1:"":a:(s=n.attributeName,l=n.attributeNamespace,a===null?t.removeAttribute(s):(n=n.type,a=n===3||n===4&&a===!0?"":""+a,l?t.setAttributeNS(l,s,a):t.setAttribute(s,a))))}var Fi=AM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,fp=Symbol.for("react.element"),Fc=Symbol.for("react.portal"),Uc=Symbol.for("react.fragment"),yy=Symbol.for("react.strict_mode"),Rb=Symbol.for("react.profiler"),WC=Symbol.for("react.provider"),HC=Symbol.for("react.context"),Ny=Symbol.for("react.forward_ref"),Db=Symbol.for("react.suspense"),Ib=Symbol.for("react.suspense_list"),wy=Symbol.for("react.memo"),xo=Symbol.for("react.lazy"),XC=Symbol.for("react.offscreen"),Pw=Symbol.iterator;function Gu(t){return t===null||typeof t!="object"?null:(t=Pw&&t[Pw]||t["@@iterator"],typeof t=="function"?t:null)}var xa=Object.assign,Ef;function Um(t){if(Ef===void 0)try{throw Error()}catch(a){var s=a.stack.trim().match(/\n( *(at )?)/);Ef=s&&s[1]||""}return`
`+Ef+t}var Mf=!1;function Pf(t,s){if(!t||Mf)return"";Mf=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(x){var l=x}Reflect.construct(t,[],s)}else{try{s.call()}catch(x){l=x}t.call(s.prototype)}else{try{throw Error()}catch(x){l=x}t()}}catch(x){if(x&&l&&typeof x.stack=="string"){for(var n=x.stack.split(`
`),r=l.stack.split(`
`),i=n.length-1,o=r.length-1;1<=i&&0<=o&&n[i]!==r[o];)o--;for(;1<=i&&0<=o;i--,o--)if(n[i]!==r[o]){if(i!==1||o!==1)do if(i--,o--,0>o||n[i]!==r[o]){var c=`
`+n[i].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=i&&0<=o);break}}}finally{Mf=!1,Error.prepareStackTrace=a}return(t=t?t.displayName||t.name:"")?Um(t):""}function TM(t){switch(t.tag){case 5:return Um(t.type);case 16:return Um("Lazy");case 13:return Um("Suspense");case 19:return Um("SuspenseList");case 0:case 2:case 15:return t=Pf(t.type,!1),t;case 11:return t=Pf(t.type.render,!1),t;case 1:return t=Pf(t.type,!0),t;default:return""}}function $b(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Uc:return"Fragment";case Fc:return"Portal";case Rb:return"Profiler";case yy:return"StrictMode";case Db:return"Suspense";case Ib:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case HC:return(t.displayName||"Context")+".Consumer";case WC:return(t._context.displayName||"Context")+".Provider";case Ny:var s=t.render;return t=t.displayName,t||(t=s.displayName||s.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case wy:return s=t.displayName||null,s!==null?s:$b(t.type)||"Memo";case xo:s=t._payload,t=t._init;try{return $b(t(s))}catch{}}return null}function RM(t){var s=t.type;switch(t.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=s.render,t=t.displayName||t.name||"",s.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $b(s);case 8:return s===yy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function Fo(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function KC(t){var s=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function DM(t){var s=KC(t)?"checked":"value",a=Object.getOwnPropertyDescriptor(t.constructor.prototype,s),l=""+t[s];if(!t.hasOwnProperty(s)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var n=a.get,r=a.set;return Object.defineProperty(t,s,{configurable:!0,get:function(){return n.call(this)},set:function(i){l=""+i,r.call(this,i)}}),Object.defineProperty(t,s,{enumerable:a.enumerable}),{getValue:function(){return l},setValue:function(i){l=""+i},stopTracking:function(){t._valueTracker=null,delete t[s]}}}}function vp(t){t._valueTracker||(t._valueTracker=DM(t))}function QC(t){if(!t)return!1;var s=t._valueTracker;if(!s)return!0;var a=s.getValue(),l="";return t&&(l=KC(t)?t.checked?"true":"false":t.value),t=l,t!==a?(s.setValue(t),!0):!1}function N0(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Lb(t,s){var a=s.checked;return xa({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??t._wrapperState.initialChecked})}function Ow(t,s){var a=s.defaultValue==null?"":s.defaultValue,l=s.checked!=null?s.checked:s.defaultChecked;a=Fo(s.value!=null?s.value:a),t._wrapperState={initialChecked:l,initialValue:a,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function YC(t,s){s=s.checked,s!=null&&jy(t,"checked",s,!1)}function Fb(t,s){YC(t,s);var a=Fo(s.value),l=s.type;if(a!=null)l==="number"?(a===0&&t.value===""||t.value!=a)&&(t.value=""+a):t.value!==""+a&&(t.value=""+a);else if(l==="submit"||l==="reset"){t.removeAttribute("value");return}s.hasOwnProperty("value")?Ub(t,s.type,a):s.hasOwnProperty("defaultValue")&&Ub(t,s.type,Fo(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(t.defaultChecked=!!s.defaultChecked)}function Tw(t,s,a){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var l=s.type;if(!(l!=="submit"&&l!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+t._wrapperState.initialValue,a||s===t.value||(t.value=s),t.defaultValue=s}a=t.name,a!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,a!==""&&(t.name=a)}function Ub(t,s,a){(s!=="number"||N0(t.ownerDocument)!==t)&&(a==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+a&&(t.defaultValue=""+a))}var Vm=Array.isArray;function nu(t,s,a,l){if(t=t.options,s){s={};for(var n=0;n<a.length;n++)s["$"+a[n]]=!0;for(a=0;a<t.length;a++)n=s.hasOwnProperty("$"+t[a].value),t[a].selected!==n&&(t[a].selected=n),n&&l&&(t[a].defaultSelected=!0)}else{for(a=""+Fo(a),s=null,n=0;n<t.length;n++){if(t[n].value===a){t[n].selected=!0,l&&(t[n].defaultSelected=!0);return}s!==null||t[n].disabled||(s=t[n])}s!==null&&(s.selected=!0)}}function Vb(t,s){if(s.dangerouslySetInnerHTML!=null)throw Error(at(91));return xa({},s,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Rw(t,s){var a=s.value;if(a==null){if(a=s.children,s=s.defaultValue,a!=null){if(s!=null)throw Error(at(92));if(Vm(a)){if(1<a.length)throw Error(at(93));a=a[0]}s=a}s==null&&(s=""),a=s}t._wrapperState={initialValue:Fo(a)}}function JC(t,s){var a=Fo(s.value),l=Fo(s.defaultValue);a!=null&&(a=""+a,a!==t.value&&(t.value=a),s.defaultValue==null&&t.defaultValue!==a&&(t.defaultValue=a)),l!=null&&(t.defaultValue=""+l)}function Dw(t){var s=t.textContent;s===t._wrapperState.initialValue&&s!==""&&s!==null&&(t.value=s)}function ZC(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _b(t,s){return t==null||t==="http://www.w3.org/1999/xhtml"?ZC(s):t==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var bp,e3=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,a,l,n){MSApp.execUnsafeLocalFunction(function(){return t(s,a,l,n)})}:t}(function(t,s){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=s;else{for(bp=bp||document.createElement("div"),bp.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=bp.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;s.firstChild;)t.appendChild(s.firstChild)}});function jx(t,s){if(s){var a=t.firstChild;if(a&&a===t.lastChild&&a.nodeType===3){a.nodeValue=s;return}}t.textContent=s}var Xm={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},IM=["Webkit","ms","Moz","O"];Object.keys(Xm).forEach(function(t){IM.forEach(function(s){s=s+t.charAt(0).toUpperCase()+t.substring(1),Xm[s]=Xm[t]})});function t3(t,s,a){return s==null||typeof s=="boolean"||s===""?"":a||typeof s!="number"||s===0||Xm.hasOwnProperty(t)&&Xm[t]?(""+s).trim():s+"px"}function s3(t,s){t=t.style;for(var a in s)if(s.hasOwnProperty(a)){var l=a.indexOf("--")===0,n=t3(a,s[a],l);a==="float"&&(a="cssFloat"),l?t.setProperty(a,n):t[a]=n}}var $M=xa({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bb(t,s){if(s){if($M[t]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(at(137,t));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(at(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(at(61))}if(s.style!=null&&typeof s.style!="object")throw Error(at(62))}}function Gb(t,s){if(t.indexOf("-")===-1)return typeof s.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qb=null;function ky(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var zb=null,ru=null,iu=null;function Iw(t){if(t=sp(t)){if(typeof zb!="function")throw Error(at(280));var s=t.stateNode;s&&(s=Sg(s),zb(t.stateNode,t.type,s))}}function a3(t){ru?iu?iu.push(t):iu=[t]:ru=t}function l3(){if(ru){var t=ru,s=iu;if(iu=ru=null,Iw(t),s)for(t=0;t<s.length;t++)Iw(s[t])}}function n3(t,s){return t(s)}function r3(){}var Of=!1;function i3(t,s,a){if(Of)return t(s,a);Of=!0;try{return n3(t,s,a)}finally{Of=!1,(ru!==null||iu!==null)&&(r3(),l3())}}function yx(t,s){var a=t.stateNode;if(a===null)return null;var l=Sg(a);if(l===null)return null;a=l[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(t=t.type,l=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!l;break e;default:t=!1}if(t)return null;if(a&&typeof a!="function")throw Error(at(231,s,typeof a));return a}var Wb=!1;if(Mi)try{var qu={};Object.defineProperty(qu,"passive",{get:function(){Wb=!0}}),window.addEventListener("test",qu,qu),window.removeEventListener("test",qu,qu)}catch{Wb=!1}function LM(t,s,a,l,n,r,i,o,c){var x=Array.prototype.slice.call(arguments,3);try{s.apply(a,x)}catch(j){this.onError(j)}}var Km=!1,w0=null,k0=!1,Hb=null,FM={onError:function(t){Km=!0,w0=t}};function UM(t,s,a,l,n,r,i,o,c){Km=!1,w0=null,LM.apply(FM,arguments)}function VM(t,s,a,l,n,r,i,o,c){if(UM.apply(this,arguments),Km){if(Km){var x=w0;Km=!1,w0=null}else throw Error(at(198));k0||(k0=!0,Hb=x)}}function Hd(t){var s=t,a=t;if(t.alternate)for(;s.return;)s=s.return;else{t=s;do s=t,s.flags&4098&&(a=s.return),t=s.return;while(t)}return s.tag===3?a:null}function o3(t){if(t.tag===13){var s=t.memoizedState;if(s===null&&(t=t.alternate,t!==null&&(s=t.memoizedState)),s!==null)return s.dehydrated}return null}function $w(t){if(Hd(t)!==t)throw Error(at(188))}function _M(t){var s=t.alternate;if(!s){if(s=Hd(t),s===null)throw Error(at(188));return s!==t?null:t}for(var a=t,l=s;;){var n=a.return;if(n===null)break;var r=n.alternate;if(r===null){if(l=n.return,l!==null){a=l;continue}break}if(n.child===r.child){for(r=n.child;r;){if(r===a)return $w(n),t;if(r===l)return $w(n),s;r=r.sibling}throw Error(at(188))}if(a.return!==l.return)a=n,l=r;else{for(var i=!1,o=n.child;o;){if(o===a){i=!0,a=n,l=r;break}if(o===l){i=!0,l=n,a=r;break}o=o.sibling}if(!i){for(o=r.child;o;){if(o===a){i=!0,a=r,l=n;break}if(o===l){i=!0,l=r,a=n;break}o=o.sibling}if(!i)throw Error(at(189))}}if(a.alternate!==l)throw Error(at(190))}if(a.tag!==3)throw Error(at(188));return a.stateNode.current===a?t:s}function d3(t){return t=_M(t),t!==null?c3(t):null}function c3(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var s=c3(t);if(s!==null)return s;t=t.sibling}return null}var u3=In.unstable_scheduleCallback,Lw=In.unstable_cancelCallback,BM=In.unstable_shouldYield,GM=In.unstable_requestPaint,Ra=In.unstable_now,qM=In.unstable_getCurrentPriorityLevel,Cy=In.unstable_ImmediatePriority,m3=In.unstable_UserBlockingPriority,C0=In.unstable_NormalPriority,zM=In.unstable_LowPriority,x3=In.unstable_IdlePriority,Ng=null,Jr=null;function WM(t){if(Jr&&typeof Jr.onCommitFiberRoot=="function")try{Jr.onCommitFiberRoot(Ng,t,void 0,(t.current.flags&128)===128)}catch{}}var kr=Math.clz32?Math.clz32:KM,HM=Math.log,XM=Math.LN2;function KM(t){return t>>>=0,t===0?32:31-(HM(t)/XM|0)|0}var jp=64,yp=4194304;function _m(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function S0(t,s){var a=t.pendingLanes;if(a===0)return 0;var l=0,n=t.suspendedLanes,r=t.pingedLanes,i=a&268435455;if(i!==0){var o=i&~n;o!==0?l=_m(o):(r&=i,r!==0&&(l=_m(r)))}else i=a&~n,i!==0?l=_m(i):r!==0&&(l=_m(r));if(l===0)return 0;if(s!==0&&s!==l&&!(s&n)&&(n=l&-l,r=s&-s,n>=r||n===16&&(r&4194240)!==0))return s;if(l&4&&(l|=a&16),s=t.entangledLanes,s!==0)for(t=t.entanglements,s&=l;0<s;)a=31-kr(s),n=1<<a,l|=t[a],s&=~n;return l}function QM(t,s){switch(t){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function YM(t,s){for(var a=t.suspendedLanes,l=t.pingedLanes,n=t.expirationTimes,r=t.pendingLanes;0<r;){var i=31-kr(r),o=1<<i,c=n[i];c===-1?(!(o&a)||o&l)&&(n[i]=QM(o,s)):c<=s&&(t.expiredLanes|=o),r&=~o}}function Xb(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function p3(){var t=jp;return jp<<=1,!(jp&4194240)&&(jp=64),t}function Tf(t){for(var s=[],a=0;31>a;a++)s.push(t);return s}function ep(t,s,a){t.pendingLanes|=s,s!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,s=31-kr(s),t[s]=a}function JM(t,s){var a=t.pendingLanes&~s;t.pendingLanes=s,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=s,t.mutableReadLanes&=s,t.entangledLanes&=s,s=t.entanglements;var l=t.eventTimes;for(t=t.expirationTimes;0<a;){var n=31-kr(a),r=1<<n;s[n]=0,l[n]=-1,t[n]=-1,a&=~r}}function Sy(t,s){var a=t.entangledLanes|=s;for(t=t.entanglements;a;){var l=31-kr(a),n=1<<l;n&s|t[l]&s&&(t[l]|=s),a&=~n}}var ks=0;function h3(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var g3,Ay,f3,v3,b3,Kb=!1,Np=[],Ao=null,Eo=null,Mo=null,Nx=new Map,wx=new Map,go=[],ZM="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Fw(t,s){switch(t){case"focusin":case"focusout":Ao=null;break;case"dragenter":case"dragleave":Eo=null;break;case"mouseover":case"mouseout":Mo=null;break;case"pointerover":case"pointerout":Nx.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":wx.delete(s.pointerId)}}function zu(t,s,a,l,n,r){return t===null||t.nativeEvent!==r?(t={blockedOn:s,domEventName:a,eventSystemFlags:l,nativeEvent:r,targetContainers:[n]},s!==null&&(s=sp(s),s!==null&&Ay(s)),t):(t.eventSystemFlags|=l,s=t.targetContainers,n!==null&&s.indexOf(n)===-1&&s.push(n),t)}function eP(t,s,a,l,n){switch(s){case"focusin":return Ao=zu(Ao,t,s,a,l,n),!0;case"dragenter":return Eo=zu(Eo,t,s,a,l,n),!0;case"mouseover":return Mo=zu(Mo,t,s,a,l,n),!0;case"pointerover":var r=n.pointerId;return Nx.set(r,zu(Nx.get(r)||null,t,s,a,l,n)),!0;case"gotpointercapture":return r=n.pointerId,wx.set(r,zu(wx.get(r)||null,t,s,a,l,n)),!0}return!1}function j3(t){var s=Ad(t.target);if(s!==null){var a=Hd(s);if(a!==null){if(s=a.tag,s===13){if(s=o3(a),s!==null){t.blockedOn=s,b3(t.priority,function(){f3(a)});return}}else if(s===3&&a.stateNode.current.memoizedState.isDehydrated){t.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Jh(t){if(t.blockedOn!==null)return!1;for(var s=t.targetContainers;0<s.length;){var a=Qb(t.domEventName,t.eventSystemFlags,s[0],t.nativeEvent);if(a===null){a=t.nativeEvent;var l=new a.constructor(a.type,a);qb=l,a.target.dispatchEvent(l),qb=null}else return s=sp(a),s!==null&&Ay(s),t.blockedOn=a,!1;s.shift()}return!0}function Uw(t,s,a){Jh(t)&&a.delete(s)}function tP(){Kb=!1,Ao!==null&&Jh(Ao)&&(Ao=null),Eo!==null&&Jh(Eo)&&(Eo=null),Mo!==null&&Jh(Mo)&&(Mo=null),Nx.forEach(Uw),wx.forEach(Uw)}function Wu(t,s){t.blockedOn===s&&(t.blockedOn=null,Kb||(Kb=!0,In.unstable_scheduleCallback(In.unstable_NormalPriority,tP)))}function kx(t){function s(n){return Wu(n,t)}if(0<Np.length){Wu(Np[0],t);for(var a=1;a<Np.length;a++){var l=Np[a];l.blockedOn===t&&(l.blockedOn=null)}}for(Ao!==null&&Wu(Ao,t),Eo!==null&&Wu(Eo,t),Mo!==null&&Wu(Mo,t),Nx.forEach(s),wx.forEach(s),a=0;a<go.length;a++)l=go[a],l.blockedOn===t&&(l.blockedOn=null);for(;0<go.length&&(a=go[0],a.blockedOn===null);)j3(a),a.blockedOn===null&&go.shift()}var ou=Fi.ReactCurrentBatchConfig,A0=!0;function sP(t,s,a,l){var n=ks,r=ou.transition;ou.transition=null;try{ks=1,Ey(t,s,a,l)}finally{ks=n,ou.transition=r}}function aP(t,s,a,l){var n=ks,r=ou.transition;ou.transition=null;try{ks=4,Ey(t,s,a,l)}finally{ks=n,ou.transition=r}}function Ey(t,s,a,l){if(A0){var n=Qb(t,s,a,l);if(n===null)Bf(t,s,l,E0,a),Fw(t,l);else if(eP(n,t,s,a,l))l.stopPropagation();else if(Fw(t,l),s&4&&-1<ZM.indexOf(t)){for(;n!==null;){var r=sp(n);if(r!==null&&g3(r),r=Qb(t,s,a,l),r===null&&Bf(t,s,l,E0,a),r===n)break;n=r}n!==null&&l.stopPropagation()}else Bf(t,s,l,null,a)}}var E0=null;function Qb(t,s,a,l){if(E0=null,t=ky(l),t=Ad(t),t!==null)if(s=Hd(t),s===null)t=null;else if(a=s.tag,a===13){if(t=o3(s),t!==null)return t;t=null}else if(a===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;t=null}else s!==t&&(t=null);return E0=t,null}function y3(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qM()){case Cy:return 1;case m3:return 4;case C0:case zM:return 16;case x3:return 536870912;default:return 16}default:return 16}}var jo=null,My=null,Zh=null;function N3(){if(Zh)return Zh;var t,s=My,a=s.length,l,n="value"in jo?jo.value:jo.textContent,r=n.length;for(t=0;t<a&&s[t]===n[t];t++);var i=a-t;for(l=1;l<=i&&s[a-l]===n[r-l];l++);return Zh=n.slice(t,1<l?1-l:void 0)}function e0(t){var s=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&s===13&&(t=13)):t=s,t===10&&(t=13),32<=t||t===13?t:0}function wp(){return!0}function Vw(){return!1}function Fn(t){function s(a,l,n,r,i){this._reactName=a,this._targetInst=n,this.type=l,this.nativeEvent=r,this.target=i,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(a=t[o],this[o]=a?a(r):r[o]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?wp:Vw,this.isPropagationStopped=Vw,this}return xa(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=wp)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=wp)},persist:function(){},isPersistent:wp}),s}var Eu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Py=Fn(Eu),tp=xa({},Eu,{view:0,detail:0}),lP=Fn(tp),Rf,Df,Hu,wg=xa({},tp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Oy,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Hu&&(Hu&&t.type==="mousemove"?(Rf=t.screenX-Hu.screenX,Df=t.screenY-Hu.screenY):Df=Rf=0,Hu=t),Rf)},movementY:function(t){return"movementY"in t?t.movementY:Df}}),_w=Fn(wg),nP=xa({},wg,{dataTransfer:0}),rP=Fn(nP),iP=xa({},tp,{relatedTarget:0}),If=Fn(iP),oP=xa({},Eu,{animationName:0,elapsedTime:0,pseudoElement:0}),dP=Fn(oP),cP=xa({},Eu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),uP=Fn(cP),mP=xa({},Eu,{data:0}),Bw=Fn(mP),xP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},pP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gP(t){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(t):(t=hP[t])?!!s[t]:!1}function Oy(){return gP}var fP=xa({},tp,{key:function(t){if(t.key){var s=xP[t.key]||t.key;if(s!=="Unidentified")return s}return t.type==="keypress"?(t=e0(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?pP[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Oy,charCode:function(t){return t.type==="keypress"?e0(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?e0(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),vP=Fn(fP),bP=xa({},wg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gw=Fn(bP),jP=xa({},tp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Oy}),yP=Fn(jP),NP=xa({},Eu,{propertyName:0,elapsedTime:0,pseudoElement:0}),wP=Fn(NP),kP=xa({},wg,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),CP=Fn(kP),SP=[9,13,27,32],Ty=Mi&&"CompositionEvent"in window,Qm=null;Mi&&"documentMode"in document&&(Qm=document.documentMode);var AP=Mi&&"TextEvent"in window&&!Qm,w3=Mi&&(!Ty||Qm&&8<Qm&&11>=Qm),qw=" ",zw=!1;function k3(t,s){switch(t){case"keyup":return SP.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function C3(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Vc=!1;function EP(t,s){switch(t){case"compositionend":return C3(s);case"keypress":return s.which!==32?null:(zw=!0,qw);case"textInput":return t=s.data,t===qw&&zw?null:t;default:return null}}function MP(t,s){if(Vc)return t==="compositionend"||!Ty&&k3(t,s)?(t=N3(),Zh=My=jo=null,Vc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return w3&&s.locale!=="ko"?null:s.data;default:return null}}var PP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ww(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s==="input"?!!PP[t.type]:s==="textarea"}function S3(t,s,a,l){a3(l),s=M0(s,"onChange"),0<s.length&&(a=new Py("onChange","change",null,a,l),t.push({event:a,listeners:s}))}var Ym=null,Cx=null;function OP(t){L3(t,0)}function kg(t){var s=Gc(t);if(QC(s))return t}function TP(t,s){if(t==="change")return s}var A3=!1;if(Mi){var $f;if(Mi){var Lf="oninput"in document;if(!Lf){var Hw=document.createElement("div");Hw.setAttribute("oninput","return;"),Lf=typeof Hw.oninput=="function"}$f=Lf}else $f=!1;A3=$f&&(!document.documentMode||9<document.documentMode)}function Xw(){Ym&&(Ym.detachEvent("onpropertychange",E3),Cx=Ym=null)}function E3(t){if(t.propertyName==="value"&&kg(Cx)){var s=[];S3(s,Cx,t,ky(t)),i3(OP,s)}}function RP(t,s,a){t==="focusin"?(Xw(),Ym=s,Cx=a,Ym.attachEvent("onpropertychange",E3)):t==="focusout"&&Xw()}function DP(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return kg(Cx)}function IP(t,s){if(t==="click")return kg(s)}function $P(t,s){if(t==="input"||t==="change")return kg(s)}function LP(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var Er=typeof Object.is=="function"?Object.is:LP;function Sx(t,s){if(Er(t,s))return!0;if(typeof t!="object"||t===null||typeof s!="object"||s===null)return!1;var a=Object.keys(t),l=Object.keys(s);if(a.length!==l.length)return!1;for(l=0;l<a.length;l++){var n=a[l];if(!Tb.call(s,n)||!Er(t[n],s[n]))return!1}return!0}function Kw(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Qw(t,s){var a=Kw(t);t=0;for(var l;a;){if(a.nodeType===3){if(l=t+a.textContent.length,t<=s&&l>=s)return{node:a,offset:s-t};t=l}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Kw(a)}}function M3(t,s){return t&&s?t===s?!0:t&&t.nodeType===3?!1:s&&s.nodeType===3?M3(t,s.parentNode):"contains"in t?t.contains(s):t.compareDocumentPosition?!!(t.compareDocumentPosition(s)&16):!1:!1}function P3(){for(var t=window,s=N0();s instanceof t.HTMLIFrameElement;){try{var a=typeof s.contentWindow.location.href=="string"}catch{a=!1}if(a)t=s.contentWindow;else break;s=N0(t.document)}return s}function Ry(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s&&(s==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||s==="textarea"||t.contentEditable==="true")}function FP(t){var s=P3(),a=t.focusedElem,l=t.selectionRange;if(s!==a&&a&&a.ownerDocument&&M3(a.ownerDocument.documentElement,a)){if(l!==null&&Ry(a)){if(s=l.start,t=l.end,t===void 0&&(t=s),"selectionStart"in a)a.selectionStart=s,a.selectionEnd=Math.min(t,a.value.length);else if(t=(s=a.ownerDocument||document)&&s.defaultView||window,t.getSelection){t=t.getSelection();var n=a.textContent.length,r=Math.min(l.start,n);l=l.end===void 0?r:Math.min(l.end,n),!t.extend&&r>l&&(n=l,l=r,r=n),n=Qw(a,r);var i=Qw(a,l);n&&i&&(t.rangeCount!==1||t.anchorNode!==n.node||t.anchorOffset!==n.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(s=s.createRange(),s.setStart(n.node,n.offset),t.removeAllRanges(),r>l?(t.addRange(s),t.extend(i.node,i.offset)):(s.setEnd(i.node,i.offset),t.addRange(s)))}}for(s=[],t=a;t=t.parentNode;)t.nodeType===1&&s.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<s.length;a++)t=s[a],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var UP=Mi&&"documentMode"in document&&11>=document.documentMode,_c=null,Yb=null,Jm=null,Jb=!1;function Yw(t,s,a){var l=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Jb||_c==null||_c!==N0(l)||(l=_c,"selectionStart"in l&&Ry(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),Jm&&Sx(Jm,l)||(Jm=l,l=M0(Yb,"onSelect"),0<l.length&&(s=new Py("onSelect","select",null,s,a),t.push({event:s,listeners:l}),s.target=_c)))}function kp(t,s){var a={};return a[t.toLowerCase()]=s.toLowerCase(),a["Webkit"+t]="webkit"+s,a["Moz"+t]="moz"+s,a}var Bc={animationend:kp("Animation","AnimationEnd"),animationiteration:kp("Animation","AnimationIteration"),animationstart:kp("Animation","AnimationStart"),transitionend:kp("Transition","TransitionEnd")},Ff={},O3={};Mi&&(O3=document.createElement("div").style,"AnimationEvent"in window||(delete Bc.animationend.animation,delete Bc.animationiteration.animation,delete Bc.animationstart.animation),"TransitionEvent"in window||delete Bc.transitionend.transition);function Cg(t){if(Ff[t])return Ff[t];if(!Bc[t])return t;var s=Bc[t],a;for(a in s)if(s.hasOwnProperty(a)&&a in O3)return Ff[t]=s[a];return t}var T3=Cg("animationend"),R3=Cg("animationiteration"),D3=Cg("animationstart"),I3=Cg("transitionend"),$3=new Map,Jw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Go(t,s){$3.set(t,s),Wd(s,[t])}for(var Uf=0;Uf<Jw.length;Uf++){var Vf=Jw[Uf],VP=Vf.toLowerCase(),_P=Vf[0].toUpperCase()+Vf.slice(1);Go(VP,"on"+_P)}Go(T3,"onAnimationEnd");Go(R3,"onAnimationIteration");Go(D3,"onAnimationStart");Go("dblclick","onDoubleClick");Go("focusin","onFocus");Go("focusout","onBlur");Go(I3,"onTransitionEnd");pu("onMouseEnter",["mouseout","mouseover"]);pu("onMouseLeave",["mouseout","mouseover"]);pu("onPointerEnter",["pointerout","pointerover"]);pu("onPointerLeave",["pointerout","pointerover"]);Wd("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Wd("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Wd("onBeforeInput",["compositionend","keypress","textInput","paste"]);Wd("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Wd("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Wd("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),BP=new Set("cancel close invalid load scroll toggle".split(" ").concat(Bm));function Zw(t,s,a){var l=t.type||"unknown-event";t.currentTarget=a,VM(l,s,void 0,t),t.currentTarget=null}function L3(t,s){s=(s&4)!==0;for(var a=0;a<t.length;a++){var l=t[a],n=l.event;l=l.listeners;e:{var r=void 0;if(s)for(var i=l.length-1;0<=i;i--){var o=l[i],c=o.instance,x=o.currentTarget;if(o=o.listener,c!==r&&n.isPropagationStopped())break e;Zw(n,o,x),r=c}else for(i=0;i<l.length;i++){if(o=l[i],c=o.instance,x=o.currentTarget,o=o.listener,c!==r&&n.isPropagationStopped())break e;Zw(n,o,x),r=c}}}if(k0)throw t=Hb,k0=!1,Hb=null,t}function Gs(t,s){var a=s[aj];a===void 0&&(a=s[aj]=new Set);var l=t+"__bubble";a.has(l)||(F3(s,t,2,!1),a.add(l))}function _f(t,s,a){var l=0;s&&(l|=4),F3(a,t,l,s)}var Cp="_reactListening"+Math.random().toString(36).slice(2);function Ax(t){if(!t[Cp]){t[Cp]=!0,zC.forEach(function(a){a!=="selectionchange"&&(BP.has(a)||_f(a,!1,t),_f(a,!0,t))});var s=t.nodeType===9?t:t.ownerDocument;s===null||s[Cp]||(s[Cp]=!0,_f("selectionchange",!1,s))}}function F3(t,s,a,l){switch(y3(s)){case 1:var n=sP;break;case 4:n=aP;break;default:n=Ey}a=n.bind(null,s,a,t),n=void 0,!Wb||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(n=!0),l?n!==void 0?t.addEventListener(s,a,{capture:!0,passive:n}):t.addEventListener(s,a,!0):n!==void 0?t.addEventListener(s,a,{passive:n}):t.addEventListener(s,a,!1)}function Bf(t,s,a,l,n){var r=l;if(!(s&1)&&!(s&2)&&l!==null)e:for(;;){if(l===null)return;var i=l.tag;if(i===3||i===4){var o=l.stateNode.containerInfo;if(o===n||o.nodeType===8&&o.parentNode===n)break;if(i===4)for(i=l.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===n||c.nodeType===8&&c.parentNode===n))return;i=i.return}for(;o!==null;){if(i=Ad(o),i===null)return;if(c=i.tag,c===5||c===6){l=r=i;continue e}o=o.parentNode}}l=l.return}i3(function(){var x=r,j=ky(a),g=[];e:{var N=$3.get(t);if(N!==void 0){var $=Py,T=t;switch(t){case"keypress":if(e0(a)===0)break e;case"keydown":case"keyup":$=vP;break;case"focusin":T="focus",$=If;break;case"focusout":T="blur",$=If;break;case"beforeblur":case"afterblur":$=If;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":$=_w;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":$=rP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":$=yP;break;case T3:case R3:case D3:$=dP;break;case I3:$=wP;break;case"scroll":$=lP;break;case"wheel":$=CP;break;case"copy":case"cut":case"paste":$=uP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":$=Gw}var k=(s&4)!==0,q=!k&&t==="scroll",L=k?N!==null?N+"Capture":null:N;k=[];for(var R=x,U;R!==null;){U=R;var ae=U.stateNode;if(U.tag===5&&ae!==null&&(U=ae,L!==null&&(ae=yx(R,L),ae!=null&&k.push(Ex(R,ae,U)))),q)break;R=R.return}0<k.length&&(N=new $(N,T,null,a,j),g.push({event:N,listeners:k}))}}if(!(s&7)){e:{if(N=t==="mouseover"||t==="pointerover",$=t==="mouseout"||t==="pointerout",N&&a!==qb&&(T=a.relatedTarget||a.fromElement)&&(Ad(T)||T[Pi]))break e;if(($||N)&&(N=j.window===j?j:(N=j.ownerDocument)?N.defaultView||N.parentWindow:window,$?(T=a.relatedTarget||a.toElement,$=x,T=T?Ad(T):null,T!==null&&(q=Hd(T),T!==q||T.tag!==5&&T.tag!==6)&&(T=null)):($=null,T=x),$!==T)){if(k=_w,ae="onMouseLeave",L="onMouseEnter",R="mouse",(t==="pointerout"||t==="pointerover")&&(k=Gw,ae="onPointerLeave",L="onPointerEnter",R="pointer"),q=$==null?N:Gc($),U=T==null?N:Gc(T),N=new k(ae,R+"leave",$,a,j),N.target=q,N.relatedTarget=U,ae=null,Ad(j)===x&&(k=new k(L,R+"enter",T,a,j),k.target=U,k.relatedTarget=q,ae=k),q=ae,$&&T)t:{for(k=$,L=T,R=0,U=k;U;U=Yd(U))R++;for(U=0,ae=L;ae;ae=Yd(ae))U++;for(;0<R-U;)k=Yd(k),R--;for(;0<U-R;)L=Yd(L),U--;for(;R--;){if(k===L||L!==null&&k===L.alternate)break t;k=Yd(k),L=Yd(L)}k=null}else k=null;$!==null&&e2(g,N,$,k,!1),T!==null&&q!==null&&e2(g,q,T,k,!0)}}e:{if(N=x?Gc(x):window,$=N.nodeName&&N.nodeName.toLowerCase(),$==="select"||$==="input"&&N.type==="file")var ie=TP;else if(Ww(N))if(A3)ie=$P;else{ie=DP;var _=RP}else($=N.nodeName)&&$.toLowerCase()==="input"&&(N.type==="checkbox"||N.type==="radio")&&(ie=IP);if(ie&&(ie=ie(t,x))){S3(g,ie,a,j);break e}_&&_(t,N,x),t==="focusout"&&(_=N._wrapperState)&&_.controlled&&N.type==="number"&&Ub(N,"number",N.value)}switch(_=x?Gc(x):window,t){case"focusin":(Ww(_)||_.contentEditable==="true")&&(_c=_,Yb=x,Jm=null);break;case"focusout":Jm=Yb=_c=null;break;case"mousedown":Jb=!0;break;case"contextmenu":case"mouseup":case"dragend":Jb=!1,Yw(g,a,j);break;case"selectionchange":if(UP)break;case"keydown":case"keyup":Yw(g,a,j)}var W;if(Ty)e:{switch(t){case"compositionstart":var J="onCompositionStart";break e;case"compositionend":J="onCompositionEnd";break e;case"compositionupdate":J="onCompositionUpdate";break e}J=void 0}else Vc?k3(t,a)&&(J="onCompositionEnd"):t==="keydown"&&a.keyCode===229&&(J="onCompositionStart");J&&(w3&&a.locale!=="ko"&&(Vc||J!=="onCompositionStart"?J==="onCompositionEnd"&&Vc&&(W=N3()):(jo=j,My="value"in jo?jo.value:jo.textContent,Vc=!0)),_=M0(x,J),0<_.length&&(J=new Bw(J,t,null,a,j),g.push({event:J,listeners:_}),W?J.data=W:(W=C3(a),W!==null&&(J.data=W)))),(W=AP?EP(t,a):MP(t,a))&&(x=M0(x,"onBeforeInput"),0<x.length&&(j=new Bw("onBeforeInput","beforeinput",null,a,j),g.push({event:j,listeners:x}),j.data=W))}L3(g,s)})}function Ex(t,s,a){return{instance:t,listener:s,currentTarget:a}}function M0(t,s){for(var a=s+"Capture",l=[];t!==null;){var n=t,r=n.stateNode;n.tag===5&&r!==null&&(n=r,r=yx(t,a),r!=null&&l.unshift(Ex(t,r,n)),r=yx(t,s),r!=null&&l.push(Ex(t,r,n))),t=t.return}return l}function Yd(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function e2(t,s,a,l,n){for(var r=s._reactName,i=[];a!==null&&a!==l;){var o=a,c=o.alternate,x=o.stateNode;if(c!==null&&c===l)break;o.tag===5&&x!==null&&(o=x,n?(c=yx(a,r),c!=null&&i.unshift(Ex(a,c,o))):n||(c=yx(a,r),c!=null&&i.push(Ex(a,c,o)))),a=a.return}i.length!==0&&t.push({event:s,listeners:i})}var GP=/\r\n?/g,qP=/\u0000|\uFFFD/g;function t2(t){return(typeof t=="string"?t:""+t).replace(GP,`
`).replace(qP,"")}function Sp(t,s,a){if(s=t2(s),t2(t)!==s&&a)throw Error(at(425))}function P0(){}var Zb=null,ej=null;function tj(t,s){return t==="textarea"||t==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var sj=typeof setTimeout=="function"?setTimeout:void 0,zP=typeof clearTimeout=="function"?clearTimeout:void 0,s2=typeof Promise=="function"?Promise:void 0,WP=typeof queueMicrotask=="function"?queueMicrotask:typeof s2<"u"?function(t){return s2.resolve(null).then(t).catch(HP)}:sj;function HP(t){setTimeout(function(){throw t})}function Gf(t,s){var a=s,l=0;do{var n=a.nextSibling;if(t.removeChild(a),n&&n.nodeType===8)if(a=n.data,a==="/$"){if(l===0){t.removeChild(n),kx(s);return}l--}else a!=="$"&&a!=="$?"&&a!=="$!"||l++;a=n}while(a);kx(s)}function Po(t){for(;t!=null;t=t.nextSibling){var s=t.nodeType;if(s===1||s===3)break;if(s===8){if(s=t.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return t}function a2(t){t=t.previousSibling;for(var s=0;t;){if(t.nodeType===8){var a=t.data;if(a==="$"||a==="$!"||a==="$?"){if(s===0)return t;s--}else a==="/$"&&s++}t=t.previousSibling}return null}var Mu=Math.random().toString(36).slice(2),Kr="__reactFiber$"+Mu,Mx="__reactProps$"+Mu,Pi="__reactContainer$"+Mu,aj="__reactEvents$"+Mu,XP="__reactListeners$"+Mu,KP="__reactHandles$"+Mu;function Ad(t){var s=t[Kr];if(s)return s;for(var a=t.parentNode;a;){if(s=a[Pi]||a[Kr]){if(a=s.alternate,s.child!==null||a!==null&&a.child!==null)for(t=a2(t);t!==null;){if(a=t[Kr])return a;t=a2(t)}return s}t=a,a=t.parentNode}return null}function sp(t){return t=t[Kr]||t[Pi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Gc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(at(33))}function Sg(t){return t[Mx]||null}var lj=[],qc=-1;function qo(t){return{current:t}}function Ks(t){0>qc||(t.current=lj[qc],lj[qc]=null,qc--)}function Fs(t,s){qc++,lj[qc]=t.current,t.current=s}var Uo={},Ll=qo(Uo),mn=qo(!1),Ud=Uo;function hu(t,s){var a=t.type.contextTypes;if(!a)return Uo;var l=t.stateNode;if(l&&l.__reactInternalMemoizedUnmaskedChildContext===s)return l.__reactInternalMemoizedMaskedChildContext;var n={},r;for(r in a)n[r]=s[r];return l&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=n),n}function xn(t){return t=t.childContextTypes,t!=null}function O0(){Ks(mn),Ks(Ll)}function l2(t,s,a){if(Ll.current!==Uo)throw Error(at(168));Fs(Ll,s),Fs(mn,a)}function U3(t,s,a){var l=t.stateNode;if(s=s.childContextTypes,typeof l.getChildContext!="function")return a;l=l.getChildContext();for(var n in l)if(!(n in s))throw Error(at(108,RM(t)||"Unknown",n));return xa({},a,l)}function T0(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Uo,Ud=Ll.current,Fs(Ll,t),Fs(mn,mn.current),!0}function n2(t,s,a){var l=t.stateNode;if(!l)throw Error(at(169));a?(t=U3(t,s,Ud),l.__reactInternalMemoizedMergedChildContext=t,Ks(mn),Ks(Ll),Fs(Ll,t)):Ks(mn),Fs(mn,a)}var bi=null,Ag=!1,qf=!1;function V3(t){bi===null?bi=[t]:bi.push(t)}function QP(t){Ag=!0,V3(t)}function zo(){if(!qf&&bi!==null){qf=!0;var t=0,s=ks;try{var a=bi;for(ks=1;t<a.length;t++){var l=a[t];do l=l(!0);while(l!==null)}bi=null,Ag=!1}catch(n){throw bi!==null&&(bi=bi.slice(t+1)),u3(Cy,zo),n}finally{ks=s,qf=!1}}return null}var zc=[],Wc=0,R0=null,D0=0,Qn=[],Yn=0,Vd=null,wi=1,ki="";function bd(t,s){zc[Wc++]=D0,zc[Wc++]=R0,R0=t,D0=s}function _3(t,s,a){Qn[Yn++]=wi,Qn[Yn++]=ki,Qn[Yn++]=Vd,Vd=t;var l=wi;t=ki;var n=32-kr(l)-1;l&=~(1<<n),a+=1;var r=32-kr(s)+n;if(30<r){var i=n-n%5;r=(l&(1<<i)-1).toString(32),l>>=i,n-=i,wi=1<<32-kr(s)+n|a<<n|l,ki=r+t}else wi=1<<r|a<<n|l,ki=t}function Dy(t){t.return!==null&&(bd(t,1),_3(t,1,0))}function Iy(t){for(;t===R0;)R0=zc[--Wc],zc[Wc]=null,D0=zc[--Wc],zc[Wc]=null;for(;t===Vd;)Vd=Qn[--Yn],Qn[Yn]=null,ki=Qn[--Yn],Qn[Yn]=null,wi=Qn[--Yn],Qn[Yn]=null}var On=null,Pn=null,na=!1,jr=null;function B3(t,s){var a=Zn(5,null,null,0);a.elementType="DELETED",a.stateNode=s,a.return=t,s=t.deletions,s===null?(t.deletions=[a],t.flags|=16):s.push(a)}function r2(t,s){switch(t.tag){case 5:var a=t.type;return s=s.nodeType!==1||a.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(t.stateNode=s,On=t,Pn=Po(s.firstChild),!0):!1;case 6:return s=t.pendingProps===""||s.nodeType!==3?null:s,s!==null?(t.stateNode=s,On=t,Pn=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(a=Vd!==null?{id:wi,overflow:ki}:null,t.memoizedState={dehydrated:s,treeContext:a,retryLane:1073741824},a=Zn(18,null,null,0),a.stateNode=s,a.return=t,t.child=a,On=t,Pn=null,!0):!1;default:return!1}}function nj(t){return(t.mode&1)!==0&&(t.flags&128)===0}function rj(t){if(na){var s=Pn;if(s){var a=s;if(!r2(t,s)){if(nj(t))throw Error(at(418));s=Po(a.nextSibling);var l=On;s&&r2(t,s)?B3(l,a):(t.flags=t.flags&-4097|2,na=!1,On=t)}}else{if(nj(t))throw Error(at(418));t.flags=t.flags&-4097|2,na=!1,On=t}}}function i2(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;On=t}function Ap(t){if(t!==On)return!1;if(!na)return i2(t),na=!0,!1;var s;if((s=t.tag!==3)&&!(s=t.tag!==5)&&(s=t.type,s=s!=="head"&&s!=="body"&&!tj(t.type,t.memoizedProps)),s&&(s=Pn)){if(nj(t))throw G3(),Error(at(418));for(;s;)B3(t,s),s=Po(s.nextSibling)}if(i2(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(at(317));e:{for(t=t.nextSibling,s=0;t;){if(t.nodeType===8){var a=t.data;if(a==="/$"){if(s===0){Pn=Po(t.nextSibling);break e}s--}else a!=="$"&&a!=="$!"&&a!=="$?"||s++}t=t.nextSibling}Pn=null}}else Pn=On?Po(t.stateNode.nextSibling):null;return!0}function G3(){for(var t=Pn;t;)t=Po(t.nextSibling)}function gu(){Pn=On=null,na=!1}function $y(t){jr===null?jr=[t]:jr.push(t)}var YP=Fi.ReactCurrentBatchConfig;function Xu(t,s,a){if(t=a.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(at(309));var l=a.stateNode}if(!l)throw Error(at(147,t));var n=l,r=""+t;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===r?s.ref:(s=function(i){var o=n.refs;i===null?delete o[r]:o[r]=i},s._stringRef=r,s)}if(typeof t!="string")throw Error(at(284));if(!a._owner)throw Error(at(290,t))}return t}function Ep(t,s){throw t=Object.prototype.toString.call(s),Error(at(31,t==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":t))}function o2(t){var s=t._init;return s(t._payload)}function q3(t){function s(L,R){if(t){var U=L.deletions;U===null?(L.deletions=[R],L.flags|=16):U.push(R)}}function a(L,R){if(!t)return null;for(;R!==null;)s(L,R),R=R.sibling;return null}function l(L,R){for(L=new Map;R!==null;)R.key!==null?L.set(R.key,R):L.set(R.index,R),R=R.sibling;return L}function n(L,R){return L=Do(L,R),L.index=0,L.sibling=null,L}function r(L,R,U){return L.index=U,t?(U=L.alternate,U!==null?(U=U.index,U<R?(L.flags|=2,R):U):(L.flags|=2,R)):(L.flags|=1048576,R)}function i(L){return t&&L.alternate===null&&(L.flags|=2),L}function o(L,R,U,ae){return R===null||R.tag!==6?(R=Yf(U,L.mode,ae),R.return=L,R):(R=n(R,U),R.return=L,R)}function c(L,R,U,ae){var ie=U.type;return ie===Uc?j(L,R,U.props.children,ae,U.key):R!==null&&(R.elementType===ie||typeof ie=="object"&&ie!==null&&ie.$$typeof===xo&&o2(ie)===R.type)?(ae=n(R,U.props),ae.ref=Xu(L,R,U),ae.return=L,ae):(ae=i0(U.type,U.key,U.props,null,L.mode,ae),ae.ref=Xu(L,R,U),ae.return=L,ae)}function x(L,R,U,ae){return R===null||R.tag!==4||R.stateNode.containerInfo!==U.containerInfo||R.stateNode.implementation!==U.implementation?(R=Jf(U,L.mode,ae),R.return=L,R):(R=n(R,U.children||[]),R.return=L,R)}function j(L,R,U,ae,ie){return R===null||R.tag!==7?(R=Dd(U,L.mode,ae,ie),R.return=L,R):(R=n(R,U),R.return=L,R)}function g(L,R,U){if(typeof R=="string"&&R!==""||typeof R=="number")return R=Yf(""+R,L.mode,U),R.return=L,R;if(typeof R=="object"&&R!==null){switch(R.$$typeof){case fp:return U=i0(R.type,R.key,R.props,null,L.mode,U),U.ref=Xu(L,null,R),U.return=L,U;case Fc:return R=Jf(R,L.mode,U),R.return=L,R;case xo:var ae=R._init;return g(L,ae(R._payload),U)}if(Vm(R)||Gu(R))return R=Dd(R,L.mode,U,null),R.return=L,R;Ep(L,R)}return null}function N(L,R,U,ae){var ie=R!==null?R.key:null;if(typeof U=="string"&&U!==""||typeof U=="number")return ie!==null?null:o(L,R,""+U,ae);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case fp:return U.key===ie?c(L,R,U,ae):null;case Fc:return U.key===ie?x(L,R,U,ae):null;case xo:return ie=U._init,N(L,R,ie(U._payload),ae)}if(Vm(U)||Gu(U))return ie!==null?null:j(L,R,U,ae,null);Ep(L,U)}return null}function $(L,R,U,ae,ie){if(typeof ae=="string"&&ae!==""||typeof ae=="number")return L=L.get(U)||null,o(R,L,""+ae,ie);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case fp:return L=L.get(ae.key===null?U:ae.key)||null,c(R,L,ae,ie);case Fc:return L=L.get(ae.key===null?U:ae.key)||null,x(R,L,ae,ie);case xo:var _=ae._init;return $(L,R,U,_(ae._payload),ie)}if(Vm(ae)||Gu(ae))return L=L.get(U)||null,j(R,L,ae,ie,null);Ep(R,ae)}return null}function T(L,R,U,ae){for(var ie=null,_=null,W=R,J=R=0,we=null;W!==null&&J<U.length;J++){W.index>J?(we=W,W=null):we=W.sibling;var G=N(L,W,U[J],ae);if(G===null){W===null&&(W=we);break}t&&W&&G.alternate===null&&s(L,W),R=r(G,R,J),_===null?ie=G:_.sibling=G,_=G,W=we}if(J===U.length)return a(L,W),na&&bd(L,J),ie;if(W===null){for(;J<U.length;J++)W=g(L,U[J],ae),W!==null&&(R=r(W,R,J),_===null?ie=W:_.sibling=W,_=W);return na&&bd(L,J),ie}for(W=l(L,W);J<U.length;J++)we=$(W,L,J,U[J],ae),we!==null&&(t&&we.alternate!==null&&W.delete(we.key===null?J:we.key),R=r(we,R,J),_===null?ie=we:_.sibling=we,_=we);return t&&W.forEach(function(be){return s(L,be)}),na&&bd(L,J),ie}function k(L,R,U,ae){var ie=Gu(U);if(typeof ie!="function")throw Error(at(150));if(U=ie.call(U),U==null)throw Error(at(151));for(var _=ie=null,W=R,J=R=0,we=null,G=U.next();W!==null&&!G.done;J++,G=U.next()){W.index>J?(we=W,W=null):we=W.sibling;var be=N(L,W,G.value,ae);if(be===null){W===null&&(W=we);break}t&&W&&be.alternate===null&&s(L,W),R=r(be,R,J),_===null?ie=be:_.sibling=be,_=be,W=we}if(G.done)return a(L,W),na&&bd(L,J),ie;if(W===null){for(;!G.done;J++,G=U.next())G=g(L,G.value,ae),G!==null&&(R=r(G,R,J),_===null?ie=G:_.sibling=G,_=G);return na&&bd(L,J),ie}for(W=l(L,W);!G.done;J++,G=U.next())G=$(W,L,J,G.value,ae),G!==null&&(t&&G.alternate!==null&&W.delete(G.key===null?J:G.key),R=r(G,R,J),_===null?ie=G:_.sibling=G,_=G);return t&&W.forEach(function(Ge){return s(L,Ge)}),na&&bd(L,J),ie}function q(L,R,U,ae){if(typeof U=="object"&&U!==null&&U.type===Uc&&U.key===null&&(U=U.props.children),typeof U=="object"&&U!==null){switch(U.$$typeof){case fp:e:{for(var ie=U.key,_=R;_!==null;){if(_.key===ie){if(ie=U.type,ie===Uc){if(_.tag===7){a(L,_.sibling),R=n(_,U.props.children),R.return=L,L=R;break e}}else if(_.elementType===ie||typeof ie=="object"&&ie!==null&&ie.$$typeof===xo&&o2(ie)===_.type){a(L,_.sibling),R=n(_,U.props),R.ref=Xu(L,_,U),R.return=L,L=R;break e}a(L,_);break}else s(L,_);_=_.sibling}U.type===Uc?(R=Dd(U.props.children,L.mode,ae,U.key),R.return=L,L=R):(ae=i0(U.type,U.key,U.props,null,L.mode,ae),ae.ref=Xu(L,R,U),ae.return=L,L=ae)}return i(L);case Fc:e:{for(_=U.key;R!==null;){if(R.key===_)if(R.tag===4&&R.stateNode.containerInfo===U.containerInfo&&R.stateNode.implementation===U.implementation){a(L,R.sibling),R=n(R,U.children||[]),R.return=L,L=R;break e}else{a(L,R);break}else s(L,R);R=R.sibling}R=Jf(U,L.mode,ae),R.return=L,L=R}return i(L);case xo:return _=U._init,q(L,R,_(U._payload),ae)}if(Vm(U))return T(L,R,U,ae);if(Gu(U))return k(L,R,U,ae);Ep(L,U)}return typeof U=="string"&&U!==""||typeof U=="number"?(U=""+U,R!==null&&R.tag===6?(a(L,R.sibling),R=n(R,U),R.return=L,L=R):(a(L,R),R=Yf(U,L.mode,ae),R.return=L,L=R),i(L)):a(L,R)}return q}var fu=q3(!0),z3=q3(!1),I0=qo(null),$0=null,Hc=null,Ly=null;function Fy(){Ly=Hc=$0=null}function Uy(t){var s=I0.current;Ks(I0),t._currentValue=s}function ij(t,s,a){for(;t!==null;){var l=t.alternate;if((t.childLanes&s)!==s?(t.childLanes|=s,l!==null&&(l.childLanes|=s)):l!==null&&(l.childLanes&s)!==s&&(l.childLanes|=s),t===a)break;t=t.return}}function du(t,s){$0=t,Ly=Hc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&s&&(un=!0),t.firstContext=null)}function tr(t){var s=t._currentValue;if(Ly!==t)if(t={context:t,memoizedValue:s,next:null},Hc===null){if($0===null)throw Error(at(308));Hc=t,$0.dependencies={lanes:0,firstContext:t}}else Hc=Hc.next=t;return s}var Ed=null;function Vy(t){Ed===null?Ed=[t]:Ed.push(t)}function W3(t,s,a,l){var n=s.interleaved;return n===null?(a.next=a,Vy(s)):(a.next=n.next,n.next=a),s.interleaved=a,Oi(t,l)}function Oi(t,s){t.lanes|=s;var a=t.alternate;for(a!==null&&(a.lanes|=s),a=t,t=t.return;t!==null;)t.childLanes|=s,a=t.alternate,a!==null&&(a.childLanes|=s),a=t,t=t.return;return a.tag===3?a.stateNode:null}var po=!1;function _y(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function H3(t,s){t=t.updateQueue,s.updateQueue===t&&(s.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Si(t,s){return{eventTime:t,lane:s,tag:0,payload:null,callback:null,next:null}}function Oo(t,s,a){var l=t.updateQueue;if(l===null)return null;if(l=l.shared,os&2){var n=l.pending;return n===null?s.next=s:(s.next=n.next,n.next=s),l.pending=s,Oi(t,a)}return n=l.interleaved,n===null?(s.next=s,Vy(l)):(s.next=n.next,n.next=s),l.interleaved=s,Oi(t,a)}function t0(t,s,a){if(s=s.updateQueue,s!==null&&(s=s.shared,(a&4194240)!==0)){var l=s.lanes;l&=t.pendingLanes,a|=l,s.lanes=a,Sy(t,a)}}function d2(t,s){var a=t.updateQueue,l=t.alternate;if(l!==null&&(l=l.updateQueue,a===l)){var n=null,r=null;if(a=a.firstBaseUpdate,a!==null){do{var i={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};r===null?n=r=i:r=r.next=i,a=a.next}while(a!==null);r===null?n=r=s:r=r.next=s}else n=r=s;a={baseState:l.baseState,firstBaseUpdate:n,lastBaseUpdate:r,shared:l.shared,effects:l.effects},t.updateQueue=a;return}t=a.lastBaseUpdate,t===null?a.firstBaseUpdate=s:t.next=s,a.lastBaseUpdate=s}function L0(t,s,a,l){var n=t.updateQueue;po=!1;var r=n.firstBaseUpdate,i=n.lastBaseUpdate,o=n.shared.pending;if(o!==null){n.shared.pending=null;var c=o,x=c.next;c.next=null,i===null?r=x:i.next=x,i=c;var j=t.alternate;j!==null&&(j=j.updateQueue,o=j.lastBaseUpdate,o!==i&&(o===null?j.firstBaseUpdate=x:o.next=x,j.lastBaseUpdate=c))}if(r!==null){var g=n.baseState;i=0,j=x=c=null,o=r;do{var N=o.lane,$=o.eventTime;if((l&N)===N){j!==null&&(j=j.next={eventTime:$,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var T=t,k=o;switch(N=s,$=a,k.tag){case 1:if(T=k.payload,typeof T=="function"){g=T.call($,g,N);break e}g=T;break e;case 3:T.flags=T.flags&-65537|128;case 0:if(T=k.payload,N=typeof T=="function"?T.call($,g,N):T,N==null)break e;g=xa({},g,N);break e;case 2:po=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,N=n.effects,N===null?n.effects=[o]:N.push(o))}else $={eventTime:$,lane:N,tag:o.tag,payload:o.payload,callback:o.callback,next:null},j===null?(x=j=$,c=g):j=j.next=$,i|=N;if(o=o.next,o===null){if(o=n.shared.pending,o===null)break;N=o,o=N.next,N.next=null,n.lastBaseUpdate=N,n.shared.pending=null}}while(!0);if(j===null&&(c=g),n.baseState=c,n.firstBaseUpdate=x,n.lastBaseUpdate=j,s=n.shared.interleaved,s!==null){n=s;do i|=n.lane,n=n.next;while(n!==s)}else r===null&&(n.shared.lanes=0);Bd|=i,t.lanes=i,t.memoizedState=g}}function c2(t,s,a){if(t=s.effects,s.effects=null,t!==null)for(s=0;s<t.length;s++){var l=t[s],n=l.callback;if(n!==null){if(l.callback=null,l=a,typeof n!="function")throw Error(at(191,n));n.call(l)}}}var ap={},Zr=qo(ap),Px=qo(ap),Ox=qo(ap);function Md(t){if(t===ap)throw Error(at(174));return t}function By(t,s){switch(Fs(Ox,s),Fs(Px,t),Fs(Zr,ap),t=s.nodeType,t){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:_b(null,"");break;default:t=t===8?s.parentNode:s,s=t.namespaceURI||null,t=t.tagName,s=_b(s,t)}Ks(Zr),Fs(Zr,s)}function vu(){Ks(Zr),Ks(Px),Ks(Ox)}function X3(t){Md(Ox.current);var s=Md(Zr.current),a=_b(s,t.type);s!==a&&(Fs(Px,t),Fs(Zr,a))}function Gy(t){Px.current===t&&(Ks(Zr),Ks(Px))}var da=qo(0);function F0(t){for(var s=t;s!==null;){if(s.tag===13){var a=s.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var zf=[];function qy(){for(var t=0;t<zf.length;t++)zf[t]._workInProgressVersionPrimary=null;zf.length=0}var s0=Fi.ReactCurrentDispatcher,Wf=Fi.ReactCurrentBatchConfig,_d=0,ma=null,tl=null,ml=null,U0=!1,Zm=!1,Tx=0,JP=0;function Al(){throw Error(at(321))}function zy(t,s){if(s===null)return!1;for(var a=0;a<s.length&&a<t.length;a++)if(!Er(t[a],s[a]))return!1;return!0}function Wy(t,s,a,l,n,r){if(_d=r,ma=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,s0.current=t===null||t.memoizedState===null?s6:a6,t=a(l,n),Zm){r=0;do{if(Zm=!1,Tx=0,25<=r)throw Error(at(301));r+=1,ml=tl=null,s.updateQueue=null,s0.current=l6,t=a(l,n)}while(Zm)}if(s0.current=V0,s=tl!==null&&tl.next!==null,_d=0,ml=tl=ma=null,U0=!1,s)throw Error(at(300));return t}function Hy(){var t=Tx!==0;return Tx=0,t}function zr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ml===null?ma.memoizedState=ml=t:ml=ml.next=t,ml}function sr(){if(tl===null){var t=ma.alternate;t=t!==null?t.memoizedState:null}else t=tl.next;var s=ml===null?ma.memoizedState:ml.next;if(s!==null)ml=s,tl=t;else{if(t===null)throw Error(at(310));tl=t,t={memoizedState:tl.memoizedState,baseState:tl.baseState,baseQueue:tl.baseQueue,queue:tl.queue,next:null},ml===null?ma.memoizedState=ml=t:ml=ml.next=t}return ml}function Rx(t,s){return typeof s=="function"?s(t):s}function Hf(t){var s=sr(),a=s.queue;if(a===null)throw Error(at(311));a.lastRenderedReducer=t;var l=tl,n=l.baseQueue,r=a.pending;if(r!==null){if(n!==null){var i=n.next;n.next=r.next,r.next=i}l.baseQueue=n=r,a.pending=null}if(n!==null){r=n.next,l=l.baseState;var o=i=null,c=null,x=r;do{var j=x.lane;if((_d&j)===j)c!==null&&(c=c.next={lane:0,action:x.action,hasEagerState:x.hasEagerState,eagerState:x.eagerState,next:null}),l=x.hasEagerState?x.eagerState:t(l,x.action);else{var g={lane:j,action:x.action,hasEagerState:x.hasEagerState,eagerState:x.eagerState,next:null};c===null?(o=c=g,i=l):c=c.next=g,ma.lanes|=j,Bd|=j}x=x.next}while(x!==null&&x!==r);c===null?i=l:c.next=o,Er(l,s.memoizedState)||(un=!0),s.memoizedState=l,s.baseState=i,s.baseQueue=c,a.lastRenderedState=l}if(t=a.interleaved,t!==null){n=t;do r=n.lane,ma.lanes|=r,Bd|=r,n=n.next;while(n!==t)}else n===null&&(a.lanes=0);return[s.memoizedState,a.dispatch]}function Xf(t){var s=sr(),a=s.queue;if(a===null)throw Error(at(311));a.lastRenderedReducer=t;var l=a.dispatch,n=a.pending,r=s.memoizedState;if(n!==null){a.pending=null;var i=n=n.next;do r=t(r,i.action),i=i.next;while(i!==n);Er(r,s.memoizedState)||(un=!0),s.memoizedState=r,s.baseQueue===null&&(s.baseState=r),a.lastRenderedState=r}return[r,l]}function K3(){}function Q3(t,s){var a=ma,l=sr(),n=s(),r=!Er(l.memoizedState,n);if(r&&(l.memoizedState=n,un=!0),l=l.queue,Xy(Z3.bind(null,a,l,t),[t]),l.getSnapshot!==s||r||ml!==null&&ml.memoizedState.tag&1){if(a.flags|=2048,Dx(9,J3.bind(null,a,l,n,s),void 0,null),xl===null)throw Error(at(349));_d&30||Y3(a,s,n)}return n}function Y3(t,s,a){t.flags|=16384,t={getSnapshot:s,value:a},s=ma.updateQueue,s===null?(s={lastEffect:null,stores:null},ma.updateQueue=s,s.stores=[t]):(a=s.stores,a===null?s.stores=[t]:a.push(t))}function J3(t,s,a,l){s.value=a,s.getSnapshot=l,eS(s)&&tS(t)}function Z3(t,s,a){return a(function(){eS(s)&&tS(t)})}function eS(t){var s=t.getSnapshot;t=t.value;try{var a=s();return!Er(t,a)}catch{return!0}}function tS(t){var s=Oi(t,1);s!==null&&Cr(s,t,1,-1)}function u2(t){var s=zr();return typeof t=="function"&&(t=t()),s.memoizedState=s.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Rx,lastRenderedState:t},s.queue=t,t=t.dispatch=t6.bind(null,ma,t),[s.memoizedState,t]}function Dx(t,s,a,l){return t={tag:t,create:s,destroy:a,deps:l,next:null},s=ma.updateQueue,s===null?(s={lastEffect:null,stores:null},ma.updateQueue=s,s.lastEffect=t.next=t):(a=s.lastEffect,a===null?s.lastEffect=t.next=t:(l=a.next,a.next=t,t.next=l,s.lastEffect=t)),t}function sS(){return sr().memoizedState}function a0(t,s,a,l){var n=zr();ma.flags|=t,n.memoizedState=Dx(1|s,a,void 0,l===void 0?null:l)}function Eg(t,s,a,l){var n=sr();l=l===void 0?null:l;var r=void 0;if(tl!==null){var i=tl.memoizedState;if(r=i.destroy,l!==null&&zy(l,i.deps)){n.memoizedState=Dx(s,a,r,l);return}}ma.flags|=t,n.memoizedState=Dx(1|s,a,r,l)}function m2(t,s){return a0(8390656,8,t,s)}function Xy(t,s){return Eg(2048,8,t,s)}function aS(t,s){return Eg(4,2,t,s)}function lS(t,s){return Eg(4,4,t,s)}function nS(t,s){if(typeof s=="function")return t=t(),s(t),function(){s(null)};if(s!=null)return t=t(),s.current=t,function(){s.current=null}}function rS(t,s,a){return a=a!=null?a.concat([t]):null,Eg(4,4,nS.bind(null,s,t),a)}function Ky(){}function iS(t,s){var a=sr();s=s===void 0?null:s;var l=a.memoizedState;return l!==null&&s!==null&&zy(s,l[1])?l[0]:(a.memoizedState=[t,s],t)}function oS(t,s){var a=sr();s=s===void 0?null:s;var l=a.memoizedState;return l!==null&&s!==null&&zy(s,l[1])?l[0]:(t=t(),a.memoizedState=[t,s],t)}function dS(t,s,a){return _d&21?(Er(a,s)||(a=p3(),ma.lanes|=a,Bd|=a,t.baseState=!0),s):(t.baseState&&(t.baseState=!1,un=!0),t.memoizedState=a)}function ZP(t,s){var a=ks;ks=a!==0&&4>a?a:4,t(!0);var l=Wf.transition;Wf.transition={};try{t(!1),s()}finally{ks=a,Wf.transition=l}}function cS(){return sr().memoizedState}function e6(t,s,a){var l=Ro(t);if(a={lane:l,action:a,hasEagerState:!1,eagerState:null,next:null},uS(t))mS(s,a);else if(a=W3(t,s,a,l),a!==null){var n=Yl();Cr(a,t,l,n),xS(a,s,l)}}function t6(t,s,a){var l=Ro(t),n={lane:l,action:a,hasEagerState:!1,eagerState:null,next:null};if(uS(t))mS(s,n);else{var r=t.alternate;if(t.lanes===0&&(r===null||r.lanes===0)&&(r=s.lastRenderedReducer,r!==null))try{var i=s.lastRenderedState,o=r(i,a);if(n.hasEagerState=!0,n.eagerState=o,Er(o,i)){var c=s.interleaved;c===null?(n.next=n,Vy(s)):(n.next=c.next,c.next=n),s.interleaved=n;return}}catch{}finally{}a=W3(t,s,n,l),a!==null&&(n=Yl(),Cr(a,t,l,n),xS(a,s,l))}}function uS(t){var s=t.alternate;return t===ma||s!==null&&s===ma}function mS(t,s){Zm=U0=!0;var a=t.pending;a===null?s.next=s:(s.next=a.next,a.next=s),t.pending=s}function xS(t,s,a){if(a&4194240){var l=s.lanes;l&=t.pendingLanes,a|=l,s.lanes=a,Sy(t,a)}}var V0={readContext:tr,useCallback:Al,useContext:Al,useEffect:Al,useImperativeHandle:Al,useInsertionEffect:Al,useLayoutEffect:Al,useMemo:Al,useReducer:Al,useRef:Al,useState:Al,useDebugValue:Al,useDeferredValue:Al,useTransition:Al,useMutableSource:Al,useSyncExternalStore:Al,useId:Al,unstable_isNewReconciler:!1},s6={readContext:tr,useCallback:function(t,s){return zr().memoizedState=[t,s===void 0?null:s],t},useContext:tr,useEffect:m2,useImperativeHandle:function(t,s,a){return a=a!=null?a.concat([t]):null,a0(4194308,4,nS.bind(null,s,t),a)},useLayoutEffect:function(t,s){return a0(4194308,4,t,s)},useInsertionEffect:function(t,s){return a0(4,2,t,s)},useMemo:function(t,s){var a=zr();return s=s===void 0?null:s,t=t(),a.memoizedState=[t,s],t},useReducer:function(t,s,a){var l=zr();return s=a!==void 0?a(s):s,l.memoizedState=l.baseState=s,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:s},l.queue=t,t=t.dispatch=e6.bind(null,ma,t),[l.memoizedState,t]},useRef:function(t){var s=zr();return t={current:t},s.memoizedState=t},useState:u2,useDebugValue:Ky,useDeferredValue:function(t){return zr().memoizedState=t},useTransition:function(){var t=u2(!1),s=t[0];return t=ZP.bind(null,t[1]),zr().memoizedState=t,[s,t]},useMutableSource:function(){},useSyncExternalStore:function(t,s,a){var l=ma,n=zr();if(na){if(a===void 0)throw Error(at(407));a=a()}else{if(a=s(),xl===null)throw Error(at(349));_d&30||Y3(l,s,a)}n.memoizedState=a;var r={value:a,getSnapshot:s};return n.queue=r,m2(Z3.bind(null,l,r,t),[t]),l.flags|=2048,Dx(9,J3.bind(null,l,r,a,s),void 0,null),a},useId:function(){var t=zr(),s=xl.identifierPrefix;if(na){var a=ki,l=wi;a=(l&~(1<<32-kr(l)-1)).toString(32)+a,s=":"+s+"R"+a,a=Tx++,0<a&&(s+="H"+a.toString(32)),s+=":"}else a=JP++,s=":"+s+"r"+a.toString(32)+":";return t.memoizedState=s},unstable_isNewReconciler:!1},a6={readContext:tr,useCallback:iS,useContext:tr,useEffect:Xy,useImperativeHandle:rS,useInsertionEffect:aS,useLayoutEffect:lS,useMemo:oS,useReducer:Hf,useRef:sS,useState:function(){return Hf(Rx)},useDebugValue:Ky,useDeferredValue:function(t){var s=sr();return dS(s,tl.memoizedState,t)},useTransition:function(){var t=Hf(Rx)[0],s=sr().memoizedState;return[t,s]},useMutableSource:K3,useSyncExternalStore:Q3,useId:cS,unstable_isNewReconciler:!1},l6={readContext:tr,useCallback:iS,useContext:tr,useEffect:Xy,useImperativeHandle:rS,useInsertionEffect:aS,useLayoutEffect:lS,useMemo:oS,useReducer:Xf,useRef:sS,useState:function(){return Xf(Rx)},useDebugValue:Ky,useDeferredValue:function(t){var s=sr();return tl===null?s.memoizedState=t:dS(s,tl.memoizedState,t)},useTransition:function(){var t=Xf(Rx)[0],s=sr().memoizedState;return[t,s]},useMutableSource:K3,useSyncExternalStore:Q3,useId:cS,unstable_isNewReconciler:!1};function fr(t,s){if(t&&t.defaultProps){s=xa({},s),t=t.defaultProps;for(var a in t)s[a]===void 0&&(s[a]=t[a]);return s}return s}function oj(t,s,a,l){s=t.memoizedState,a=a(l,s),a=a==null?s:xa({},s,a),t.memoizedState=a,t.lanes===0&&(t.updateQueue.baseState=a)}var Mg={isMounted:function(t){return(t=t._reactInternals)?Hd(t)===t:!1},enqueueSetState:function(t,s,a){t=t._reactInternals;var l=Yl(),n=Ro(t),r=Si(l,n);r.payload=s,a!=null&&(r.callback=a),s=Oo(t,r,n),s!==null&&(Cr(s,t,n,l),t0(s,t,n))},enqueueReplaceState:function(t,s,a){t=t._reactInternals;var l=Yl(),n=Ro(t),r=Si(l,n);r.tag=1,r.payload=s,a!=null&&(r.callback=a),s=Oo(t,r,n),s!==null&&(Cr(s,t,n,l),t0(s,t,n))},enqueueForceUpdate:function(t,s){t=t._reactInternals;var a=Yl(),l=Ro(t),n=Si(a,l);n.tag=2,s!=null&&(n.callback=s),s=Oo(t,n,l),s!==null&&(Cr(s,t,l,a),t0(s,t,l))}};function x2(t,s,a,l,n,r,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(l,r,i):s.prototype&&s.prototype.isPureReactComponent?!Sx(a,l)||!Sx(n,r):!0}function pS(t,s,a){var l=!1,n=Uo,r=s.contextType;return typeof r=="object"&&r!==null?r=tr(r):(n=xn(s)?Ud:Ll.current,l=s.contextTypes,r=(l=l!=null)?hu(t,n):Uo),s=new s(a,r),t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=Mg,t.stateNode=s,s._reactInternals=t,l&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=n,t.__reactInternalMemoizedMaskedChildContext=r),s}function p2(t,s,a,l){t=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(a,l),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(a,l),s.state!==t&&Mg.enqueueReplaceState(s,s.state,null)}function dj(t,s,a,l){var n=t.stateNode;n.props=a,n.state=t.memoizedState,n.refs={},_y(t);var r=s.contextType;typeof r=="object"&&r!==null?n.context=tr(r):(r=xn(s)?Ud:Ll.current,n.context=hu(t,r)),n.state=t.memoizedState,r=s.getDerivedStateFromProps,typeof r=="function"&&(oj(t,s,r,a),n.state=t.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(s=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),s!==n.state&&Mg.enqueueReplaceState(n,n.state,null),L0(t,a,n,l),n.state=t.memoizedState),typeof n.componentDidMount=="function"&&(t.flags|=4194308)}function bu(t,s){try{var a="",l=s;do a+=TM(l),l=l.return;while(l);var n=a}catch(r){n=`
Error generating stack: `+r.message+`
`+r.stack}return{value:t,source:s,stack:n,digest:null}}function Kf(t,s,a){return{value:t,source:null,stack:a??null,digest:s??null}}function cj(t,s){try{console.error(s.value)}catch(a){setTimeout(function(){throw a})}}var n6=typeof WeakMap=="function"?WeakMap:Map;function hS(t,s,a){a=Si(-1,a),a.tag=3,a.payload={element:null};var l=s.value;return a.callback=function(){B0||(B0=!0,jj=l),cj(t,s)},a}function gS(t,s,a){a=Si(-1,a),a.tag=3;var l=t.type.getDerivedStateFromError;if(typeof l=="function"){var n=s.value;a.payload=function(){return l(n)},a.callback=function(){cj(t,s)}}var r=t.stateNode;return r!==null&&typeof r.componentDidCatch=="function"&&(a.callback=function(){cj(t,s),typeof l!="function"&&(To===null?To=new Set([this]):To.add(this));var i=s.stack;this.componentDidCatch(s.value,{componentStack:i!==null?i:""})}),a}function h2(t,s,a){var l=t.pingCache;if(l===null){l=t.pingCache=new n6;var n=new Set;l.set(s,n)}else n=l.get(s),n===void 0&&(n=new Set,l.set(s,n));n.has(a)||(n.add(a),t=b6.bind(null,t,s,a),s.then(t,t))}function g2(t){do{var s;if((s=t.tag===13)&&(s=t.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return t;t=t.return}while(t!==null);return null}function f2(t,s,a,l,n){return t.mode&1?(t.flags|=65536,t.lanes=n,t):(t===s?t.flags|=65536:(t.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(s=Si(-1,1),s.tag=2,Oo(a,s,1))),a.lanes|=1),t)}var r6=Fi.ReactCurrentOwner,un=!1;function zl(t,s,a,l){s.child=t===null?z3(s,null,a,l):fu(s,t.child,a,l)}function v2(t,s,a,l,n){a=a.render;var r=s.ref;return du(s,n),l=Wy(t,s,a,l,r,n),a=Hy(),t!==null&&!un?(s.updateQueue=t.updateQueue,s.flags&=-2053,t.lanes&=~n,Ti(t,s,n)):(na&&a&&Dy(s),s.flags|=1,zl(t,s,l,n),s.child)}function b2(t,s,a,l,n){if(t===null){var r=a.type;return typeof r=="function"&&!aN(r)&&r.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(s.tag=15,s.type=r,fS(t,s,r,l,n)):(t=i0(a.type,null,l,s,s.mode,n),t.ref=s.ref,t.return=s,s.child=t)}if(r=t.child,!(t.lanes&n)){var i=r.memoizedProps;if(a=a.compare,a=a!==null?a:Sx,a(i,l)&&t.ref===s.ref)return Ti(t,s,n)}return s.flags|=1,t=Do(r,l),t.ref=s.ref,t.return=s,s.child=t}function fS(t,s,a,l,n){if(t!==null){var r=t.memoizedProps;if(Sx(r,l)&&t.ref===s.ref)if(un=!1,s.pendingProps=l=r,(t.lanes&n)!==0)t.flags&131072&&(un=!0);else return s.lanes=t.lanes,Ti(t,s,n)}return uj(t,s,a,l,n)}function vS(t,s,a){var l=s.pendingProps,n=l.children,r=t!==null?t.memoizedState:null;if(l.mode==="hidden")if(!(s.mode&1))s.memoizedState={baseLanes:0,cachePool:null,transitions:null},Fs(Kc,Sn),Sn|=a;else{if(!(a&1073741824))return t=r!==null?r.baseLanes|a:a,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:t,cachePool:null,transitions:null},s.updateQueue=null,Fs(Kc,Sn),Sn|=t,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},l=r!==null?r.baseLanes:a,Fs(Kc,Sn),Sn|=l}else r!==null?(l=r.baseLanes|a,s.memoizedState=null):l=a,Fs(Kc,Sn),Sn|=l;return zl(t,s,n,a),s.child}function bS(t,s){var a=s.ref;(t===null&&a!==null||t!==null&&t.ref!==a)&&(s.flags|=512,s.flags|=2097152)}function uj(t,s,a,l,n){var r=xn(a)?Ud:Ll.current;return r=hu(s,r),du(s,n),a=Wy(t,s,a,l,r,n),l=Hy(),t!==null&&!un?(s.updateQueue=t.updateQueue,s.flags&=-2053,t.lanes&=~n,Ti(t,s,n)):(na&&l&&Dy(s),s.flags|=1,zl(t,s,a,n),s.child)}function j2(t,s,a,l,n){if(xn(a)){var r=!0;T0(s)}else r=!1;if(du(s,n),s.stateNode===null)l0(t,s),pS(s,a,l),dj(s,a,l,n),l=!0;else if(t===null){var i=s.stateNode,o=s.memoizedProps;i.props=o;var c=i.context,x=a.contextType;typeof x=="object"&&x!==null?x=tr(x):(x=xn(a)?Ud:Ll.current,x=hu(s,x));var j=a.getDerivedStateFromProps,g=typeof j=="function"||typeof i.getSnapshotBeforeUpdate=="function";g||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==l||c!==x)&&p2(s,i,l,x),po=!1;var N=s.memoizedState;i.state=N,L0(s,l,i,n),c=s.memoizedState,o!==l||N!==c||mn.current||po?(typeof j=="function"&&(oj(s,a,j,l),c=s.memoizedState),(o=po||x2(s,a,o,l,N,c,x))?(g||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(s.flags|=4194308)):(typeof i.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=l,s.memoizedState=c),i.props=l,i.state=c,i.context=x,l=o):(typeof i.componentDidMount=="function"&&(s.flags|=4194308),l=!1)}else{i=s.stateNode,H3(t,s),o=s.memoizedProps,x=s.type===s.elementType?o:fr(s.type,o),i.props=x,g=s.pendingProps,N=i.context,c=a.contextType,typeof c=="object"&&c!==null?c=tr(c):(c=xn(a)?Ud:Ll.current,c=hu(s,c));var $=a.getDerivedStateFromProps;(j=typeof $=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==g||N!==c)&&p2(s,i,l,c),po=!1,N=s.memoizedState,i.state=N,L0(s,l,i,n);var T=s.memoizedState;o!==g||N!==T||mn.current||po?(typeof $=="function"&&(oj(s,a,$,l),T=s.memoizedState),(x=po||x2(s,a,x,l,N,T,c)||!1)?(j||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(l,T,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(l,T,c)),typeof i.componentDidUpdate=="function"&&(s.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&N===t.memoizedState||(s.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&N===t.memoizedState||(s.flags|=1024),s.memoizedProps=l,s.memoizedState=T),i.props=l,i.state=T,i.context=c,l=x):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&N===t.memoizedState||(s.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&N===t.memoizedState||(s.flags|=1024),l=!1)}return mj(t,s,a,l,r,n)}function mj(t,s,a,l,n,r){bS(t,s);var i=(s.flags&128)!==0;if(!l&&!i)return n&&n2(s,a,!1),Ti(t,s,r);l=s.stateNode,r6.current=s;var o=i&&typeof a.getDerivedStateFromError!="function"?null:l.render();return s.flags|=1,t!==null&&i?(s.child=fu(s,t.child,null,r),s.child=fu(s,null,o,r)):zl(t,s,o,r),s.memoizedState=l.state,n&&n2(s,a,!0),s.child}function jS(t){var s=t.stateNode;s.pendingContext?l2(t,s.pendingContext,s.pendingContext!==s.context):s.context&&l2(t,s.context,!1),By(t,s.containerInfo)}function y2(t,s,a,l,n){return gu(),$y(n),s.flags|=256,zl(t,s,a,l),s.child}var xj={dehydrated:null,treeContext:null,retryLane:0};function pj(t){return{baseLanes:t,cachePool:null,transitions:null}}function yS(t,s,a){var l=s.pendingProps,n=da.current,r=!1,i=(s.flags&128)!==0,o;if((o=i)||(o=t!==null&&t.memoizedState===null?!1:(n&2)!==0),o?(r=!0,s.flags&=-129):(t===null||t.memoizedState!==null)&&(n|=1),Fs(da,n&1),t===null)return rj(s),t=s.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(s.mode&1?t.data==="$!"?s.lanes=8:s.lanes=1073741824:s.lanes=1,null):(i=l.children,t=l.fallback,r?(l=s.mode,r=s.child,i={mode:"hidden",children:i},!(l&1)&&r!==null?(r.childLanes=0,r.pendingProps=i):r=Tg(i,l,0,null),t=Dd(t,l,a,null),r.return=s,t.return=s,r.sibling=t,s.child=r,s.child.memoizedState=pj(a),s.memoizedState=xj,t):Qy(s,i));if(n=t.memoizedState,n!==null&&(o=n.dehydrated,o!==null))return i6(t,s,i,l,o,n,a);if(r){r=l.fallback,i=s.mode,n=t.child,o=n.sibling;var c={mode:"hidden",children:l.children};return!(i&1)&&s.child!==n?(l=s.child,l.childLanes=0,l.pendingProps=c,s.deletions=null):(l=Do(n,c),l.subtreeFlags=n.subtreeFlags&14680064),o!==null?r=Do(o,r):(r=Dd(r,i,a,null),r.flags|=2),r.return=s,l.return=s,l.sibling=r,s.child=l,l=r,r=s.child,i=t.child.memoizedState,i=i===null?pj(a):{baseLanes:i.baseLanes|a,cachePool:null,transitions:i.transitions},r.memoizedState=i,r.childLanes=t.childLanes&~a,s.memoizedState=xj,l}return r=t.child,t=r.sibling,l=Do(r,{mode:"visible",children:l.children}),!(s.mode&1)&&(l.lanes=a),l.return=s,l.sibling=null,t!==null&&(a=s.deletions,a===null?(s.deletions=[t],s.flags|=16):a.push(t)),s.child=l,s.memoizedState=null,l}function Qy(t,s){return s=Tg({mode:"visible",children:s},t.mode,0,null),s.return=t,t.child=s}function Mp(t,s,a,l){return l!==null&&$y(l),fu(s,t.child,null,a),t=Qy(s,s.pendingProps.children),t.flags|=2,s.memoizedState=null,t}function i6(t,s,a,l,n,r,i){if(a)return s.flags&256?(s.flags&=-257,l=Kf(Error(at(422))),Mp(t,s,i,l)):s.memoizedState!==null?(s.child=t.child,s.flags|=128,null):(r=l.fallback,n=s.mode,l=Tg({mode:"visible",children:l.children},n,0,null),r=Dd(r,n,i,null),r.flags|=2,l.return=s,r.return=s,l.sibling=r,s.child=l,s.mode&1&&fu(s,t.child,null,i),s.child.memoizedState=pj(i),s.memoizedState=xj,r);if(!(s.mode&1))return Mp(t,s,i,null);if(n.data==="$!"){if(l=n.nextSibling&&n.nextSibling.dataset,l)var o=l.dgst;return l=o,r=Error(at(419)),l=Kf(r,l,void 0),Mp(t,s,i,l)}if(o=(i&t.childLanes)!==0,un||o){if(l=xl,l!==null){switch(i&-i){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(l.suspendedLanes|i)?0:n,n!==0&&n!==r.retryLane&&(r.retryLane=n,Oi(t,n),Cr(l,t,n,-1))}return sN(),l=Kf(Error(at(421))),Mp(t,s,i,l)}return n.data==="$?"?(s.flags|=128,s.child=t.child,s=j6.bind(null,t),n._reactRetry=s,null):(t=r.treeContext,Pn=Po(n.nextSibling),On=s,na=!0,jr=null,t!==null&&(Qn[Yn++]=wi,Qn[Yn++]=ki,Qn[Yn++]=Vd,wi=t.id,ki=t.overflow,Vd=s),s=Qy(s,l.children),s.flags|=4096,s)}function N2(t,s,a){t.lanes|=s;var l=t.alternate;l!==null&&(l.lanes|=s),ij(t.return,s,a)}function Qf(t,s,a,l,n){var r=t.memoizedState;r===null?t.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:l,tail:a,tailMode:n}:(r.isBackwards=s,r.rendering=null,r.renderingStartTime=0,r.last=l,r.tail=a,r.tailMode=n)}function NS(t,s,a){var l=s.pendingProps,n=l.revealOrder,r=l.tail;if(zl(t,s,l.children,a),l=da.current,l&2)l=l&1|2,s.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=s.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&N2(t,a,s);else if(t.tag===19)N2(t,a,s);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===s)break e;for(;t.sibling===null;){if(t.return===null||t.return===s)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}l&=1}if(Fs(da,l),!(s.mode&1))s.memoizedState=null;else switch(n){case"forwards":for(a=s.child,n=null;a!==null;)t=a.alternate,t!==null&&F0(t)===null&&(n=a),a=a.sibling;a=n,a===null?(n=s.child,s.child=null):(n=a.sibling,a.sibling=null),Qf(s,!1,n,a,r);break;case"backwards":for(a=null,n=s.child,s.child=null;n!==null;){if(t=n.alternate,t!==null&&F0(t)===null){s.child=n;break}t=n.sibling,n.sibling=a,a=n,n=t}Qf(s,!0,a,null,r);break;case"together":Qf(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function l0(t,s){!(s.mode&1)&&t!==null&&(t.alternate=null,s.alternate=null,s.flags|=2)}function Ti(t,s,a){if(t!==null&&(s.dependencies=t.dependencies),Bd|=s.lanes,!(a&s.childLanes))return null;if(t!==null&&s.child!==t.child)throw Error(at(153));if(s.child!==null){for(t=s.child,a=Do(t,t.pendingProps),s.child=a,a.return=s;t.sibling!==null;)t=t.sibling,a=a.sibling=Do(t,t.pendingProps),a.return=s;a.sibling=null}return s.child}function o6(t,s,a){switch(s.tag){case 3:jS(s),gu();break;case 5:X3(s);break;case 1:xn(s.type)&&T0(s);break;case 4:By(s,s.stateNode.containerInfo);break;case 10:var l=s.type._context,n=s.memoizedProps.value;Fs(I0,l._currentValue),l._currentValue=n;break;case 13:if(l=s.memoizedState,l!==null)return l.dehydrated!==null?(Fs(da,da.current&1),s.flags|=128,null):a&s.child.childLanes?yS(t,s,a):(Fs(da,da.current&1),t=Ti(t,s,a),t!==null?t.sibling:null);Fs(da,da.current&1);break;case 19:if(l=(a&s.childLanes)!==0,t.flags&128){if(l)return NS(t,s,a);s.flags|=128}if(n=s.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),Fs(da,da.current),l)break;return null;case 22:case 23:return s.lanes=0,vS(t,s,a)}return Ti(t,s,a)}var wS,hj,kS,CS;wS=function(t,s){for(var a=s.child;a!==null;){if(a.tag===5||a.tag===6)t.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};hj=function(){};kS=function(t,s,a,l){var n=t.memoizedProps;if(n!==l){t=s.stateNode,Md(Zr.current);var r=null;switch(a){case"input":n=Lb(t,n),l=Lb(t,l),r=[];break;case"select":n=xa({},n,{value:void 0}),l=xa({},l,{value:void 0}),r=[];break;case"textarea":n=Vb(t,n),l=Vb(t,l),r=[];break;default:typeof n.onClick!="function"&&typeof l.onClick=="function"&&(t.onclick=P0)}Bb(a,l);var i;a=null;for(x in n)if(!l.hasOwnProperty(x)&&n.hasOwnProperty(x)&&n[x]!=null)if(x==="style"){var o=n[x];for(i in o)o.hasOwnProperty(i)&&(a||(a={}),a[i]="")}else x!=="dangerouslySetInnerHTML"&&x!=="children"&&x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(bx.hasOwnProperty(x)?r||(r=[]):(r=r||[]).push(x,null));for(x in l){var c=l[x];if(o=n!=null?n[x]:void 0,l.hasOwnProperty(x)&&c!==o&&(c!=null||o!=null))if(x==="style")if(o){for(i in o)!o.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(a||(a={}),a[i]="");for(i in c)c.hasOwnProperty(i)&&o[i]!==c[i]&&(a||(a={}),a[i]=c[i])}else a||(r||(r=[]),r.push(x,a)),a=c;else x==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(r=r||[]).push(x,c)):x==="children"?typeof c!="string"&&typeof c!="number"||(r=r||[]).push(x,""+c):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&(bx.hasOwnProperty(x)?(c!=null&&x==="onScroll"&&Gs("scroll",t),r||o===c||(r=[])):(r=r||[]).push(x,c))}a&&(r=r||[]).push("style",a);var x=r;(s.updateQueue=x)&&(s.flags|=4)}};CS=function(t,s,a,l){a!==l&&(s.flags|=4)};function Ku(t,s){if(!na)switch(t.tailMode){case"hidden":s=t.tail;for(var a=null;s!==null;)s.alternate!==null&&(a=s),s=s.sibling;a===null?t.tail=null:a.sibling=null;break;case"collapsed":a=t.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?s||t.tail===null?t.tail=null:t.tail.sibling=null:l.sibling=null}}function El(t){var s=t.alternate!==null&&t.alternate.child===t.child,a=0,l=0;if(s)for(var n=t.child;n!==null;)a|=n.lanes|n.childLanes,l|=n.subtreeFlags&14680064,l|=n.flags&14680064,n.return=t,n=n.sibling;else for(n=t.child;n!==null;)a|=n.lanes|n.childLanes,l|=n.subtreeFlags,l|=n.flags,n.return=t,n=n.sibling;return t.subtreeFlags|=l,t.childLanes=a,s}function d6(t,s,a){var l=s.pendingProps;switch(Iy(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return El(s),null;case 1:return xn(s.type)&&O0(),El(s),null;case 3:return l=s.stateNode,vu(),Ks(mn),Ks(Ll),qy(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(t===null||t.child===null)&&(Ap(s)?s.flags|=4:t===null||t.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,jr!==null&&(wj(jr),jr=null))),hj(t,s),El(s),null;case 5:Gy(s);var n=Md(Ox.current);if(a=s.type,t!==null&&s.stateNode!=null)kS(t,s,a,l,n),t.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!l){if(s.stateNode===null)throw Error(at(166));return El(s),null}if(t=Md(Zr.current),Ap(s)){l=s.stateNode,a=s.type;var r=s.memoizedProps;switch(l[Kr]=s,l[Mx]=r,t=(s.mode&1)!==0,a){case"dialog":Gs("cancel",l),Gs("close",l);break;case"iframe":case"object":case"embed":Gs("load",l);break;case"video":case"audio":for(n=0;n<Bm.length;n++)Gs(Bm[n],l);break;case"source":Gs("error",l);break;case"img":case"image":case"link":Gs("error",l),Gs("load",l);break;case"details":Gs("toggle",l);break;case"input":Ow(l,r),Gs("invalid",l);break;case"select":l._wrapperState={wasMultiple:!!r.multiple},Gs("invalid",l);break;case"textarea":Rw(l,r),Gs("invalid",l)}Bb(a,r),n=null;for(var i in r)if(r.hasOwnProperty(i)){var o=r[i];i==="children"?typeof o=="string"?l.textContent!==o&&(r.suppressHydrationWarning!==!0&&Sp(l.textContent,o,t),n=["children",o]):typeof o=="number"&&l.textContent!==""+o&&(r.suppressHydrationWarning!==!0&&Sp(l.textContent,o,t),n=["children",""+o]):bx.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&Gs("scroll",l)}switch(a){case"input":vp(l),Tw(l,r,!0);break;case"textarea":vp(l),Dw(l);break;case"select":case"option":break;default:typeof r.onClick=="function"&&(l.onclick=P0)}l=n,s.updateQueue=l,l!==null&&(s.flags|=4)}else{i=n.nodeType===9?n:n.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=ZC(a)),t==="http://www.w3.org/1999/xhtml"?a==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof l.is=="string"?t=i.createElement(a,{is:l.is}):(t=i.createElement(a),a==="select"&&(i=t,l.multiple?i.multiple=!0:l.size&&(i.size=l.size))):t=i.createElementNS(t,a),t[Kr]=s,t[Mx]=l,wS(t,s,!1,!1),s.stateNode=t;e:{switch(i=Gb(a,l),a){case"dialog":Gs("cancel",t),Gs("close",t),n=l;break;case"iframe":case"object":case"embed":Gs("load",t),n=l;break;case"video":case"audio":for(n=0;n<Bm.length;n++)Gs(Bm[n],t);n=l;break;case"source":Gs("error",t),n=l;break;case"img":case"image":case"link":Gs("error",t),Gs("load",t),n=l;break;case"details":Gs("toggle",t),n=l;break;case"input":Ow(t,l),n=Lb(t,l),Gs("invalid",t);break;case"option":n=l;break;case"select":t._wrapperState={wasMultiple:!!l.multiple},n=xa({},l,{value:void 0}),Gs("invalid",t);break;case"textarea":Rw(t,l),n=Vb(t,l),Gs("invalid",t);break;default:n=l}Bb(a,n),o=n;for(r in o)if(o.hasOwnProperty(r)){var c=o[r];r==="style"?s3(t,c):r==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&e3(t,c)):r==="children"?typeof c=="string"?(a!=="textarea"||c!=="")&&jx(t,c):typeof c=="number"&&jx(t,""+c):r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&r!=="autoFocus"&&(bx.hasOwnProperty(r)?c!=null&&r==="onScroll"&&Gs("scroll",t):c!=null&&jy(t,r,c,i))}switch(a){case"input":vp(t),Tw(t,l,!1);break;case"textarea":vp(t),Dw(t);break;case"option":l.value!=null&&t.setAttribute("value",""+Fo(l.value));break;case"select":t.multiple=!!l.multiple,r=l.value,r!=null?nu(t,!!l.multiple,r,!1):l.defaultValue!=null&&nu(t,!!l.multiple,l.defaultValue,!0);break;default:typeof n.onClick=="function"&&(t.onclick=P0)}switch(a){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}}l&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return El(s),null;case 6:if(t&&s.stateNode!=null)CS(t,s,t.memoizedProps,l);else{if(typeof l!="string"&&s.stateNode===null)throw Error(at(166));if(a=Md(Ox.current),Md(Zr.current),Ap(s)){if(l=s.stateNode,a=s.memoizedProps,l[Kr]=s,(r=l.nodeValue!==a)&&(t=On,t!==null))switch(t.tag){case 3:Sp(l.nodeValue,a,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Sp(l.nodeValue,a,(t.mode&1)!==0)}r&&(s.flags|=4)}else l=(a.nodeType===9?a:a.ownerDocument).createTextNode(l),l[Kr]=s,s.stateNode=l}return El(s),null;case 13:if(Ks(da),l=s.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(na&&Pn!==null&&s.mode&1&&!(s.flags&128))G3(),gu(),s.flags|=98560,r=!1;else if(r=Ap(s),l!==null&&l.dehydrated!==null){if(t===null){if(!r)throw Error(at(318));if(r=s.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(at(317));r[Kr]=s}else gu(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;El(s),r=!1}else jr!==null&&(wj(jr),jr=null),r=!0;if(!r)return s.flags&65536?s:null}return s.flags&128?(s.lanes=a,s):(l=l!==null,l!==(t!==null&&t.memoizedState!==null)&&l&&(s.child.flags|=8192,s.mode&1&&(t===null||da.current&1?ll===0&&(ll=3):sN())),s.updateQueue!==null&&(s.flags|=4),El(s),null);case 4:return vu(),hj(t,s),t===null&&Ax(s.stateNode.containerInfo),El(s),null;case 10:return Uy(s.type._context),El(s),null;case 17:return xn(s.type)&&O0(),El(s),null;case 19:if(Ks(da),r=s.memoizedState,r===null)return El(s),null;if(l=(s.flags&128)!==0,i=r.rendering,i===null)if(l)Ku(r,!1);else{if(ll!==0||t!==null&&t.flags&128)for(t=s.child;t!==null;){if(i=F0(t),i!==null){for(s.flags|=128,Ku(r,!1),l=i.updateQueue,l!==null&&(s.updateQueue=l,s.flags|=4),s.subtreeFlags=0,l=a,a=s.child;a!==null;)r=a,t=l,r.flags&=14680066,i=r.alternate,i===null?(r.childLanes=0,r.lanes=t,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=i.childLanes,r.lanes=i.lanes,r.child=i.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=i.memoizedProps,r.memoizedState=i.memoizedState,r.updateQueue=i.updateQueue,r.type=i.type,t=i.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),a=a.sibling;return Fs(da,da.current&1|2),s.child}t=t.sibling}r.tail!==null&&Ra()>ju&&(s.flags|=128,l=!0,Ku(r,!1),s.lanes=4194304)}else{if(!l)if(t=F0(i),t!==null){if(s.flags|=128,l=!0,a=t.updateQueue,a!==null&&(s.updateQueue=a,s.flags|=4),Ku(r,!0),r.tail===null&&r.tailMode==="hidden"&&!i.alternate&&!na)return El(s),null}else 2*Ra()-r.renderingStartTime>ju&&a!==1073741824&&(s.flags|=128,l=!0,Ku(r,!1),s.lanes=4194304);r.isBackwards?(i.sibling=s.child,s.child=i):(a=r.last,a!==null?a.sibling=i:s.child=i,r.last=i)}return r.tail!==null?(s=r.tail,r.rendering=s,r.tail=s.sibling,r.renderingStartTime=Ra(),s.sibling=null,a=da.current,Fs(da,l?a&1|2:a&1),s):(El(s),null);case 22:case 23:return tN(),l=s.memoizedState!==null,t!==null&&t.memoizedState!==null!==l&&(s.flags|=8192),l&&s.mode&1?Sn&1073741824&&(El(s),s.subtreeFlags&6&&(s.flags|=8192)):El(s),null;case 24:return null;case 25:return null}throw Error(at(156,s.tag))}function c6(t,s){switch(Iy(s),s.tag){case 1:return xn(s.type)&&O0(),t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 3:return vu(),Ks(mn),Ks(Ll),qy(),t=s.flags,t&65536&&!(t&128)?(s.flags=t&-65537|128,s):null;case 5:return Gy(s),null;case 13:if(Ks(da),t=s.memoizedState,t!==null&&t.dehydrated!==null){if(s.alternate===null)throw Error(at(340));gu()}return t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 19:return Ks(da),null;case 4:return vu(),null;case 10:return Uy(s.type._context),null;case 22:case 23:return tN(),null;case 24:return null;default:return null}}var Pp=!1,Il=!1,u6=typeof WeakSet=="function"?WeakSet:Set,bt=null;function Xc(t,s){var a=t.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(l){ba(t,s,l)}else a.current=null}function gj(t,s,a){try{a()}catch(l){ba(t,s,l)}}var w2=!1;function m6(t,s){if(Zb=A0,t=P3(),Ry(t)){if("selectionStart"in t)var a={start:t.selectionStart,end:t.selectionEnd};else e:{a=(a=t.ownerDocument)&&a.defaultView||window;var l=a.getSelection&&a.getSelection();if(l&&l.rangeCount!==0){a=l.anchorNode;var n=l.anchorOffset,r=l.focusNode;l=l.focusOffset;try{a.nodeType,r.nodeType}catch{a=null;break e}var i=0,o=-1,c=-1,x=0,j=0,g=t,N=null;t:for(;;){for(var $;g!==a||n!==0&&g.nodeType!==3||(o=i+n),g!==r||l!==0&&g.nodeType!==3||(c=i+l),g.nodeType===3&&(i+=g.nodeValue.length),($=g.firstChild)!==null;)N=g,g=$;for(;;){if(g===t)break t;if(N===a&&++x===n&&(o=i),N===r&&++j===l&&(c=i),($=g.nextSibling)!==null)break;g=N,N=g.parentNode}g=$}a=o===-1||c===-1?null:{start:o,end:c}}else a=null}a=a||{start:0,end:0}}else a=null;for(ej={focusedElem:t,selectionRange:a},A0=!1,bt=s;bt!==null;)if(s=bt,t=s.child,(s.subtreeFlags&1028)!==0&&t!==null)t.return=s,bt=t;else for(;bt!==null;){s=bt;try{var T=s.alternate;if(s.flags&1024)switch(s.tag){case 0:case 11:case 15:break;case 1:if(T!==null){var k=T.memoizedProps,q=T.memoizedState,L=s.stateNode,R=L.getSnapshotBeforeUpdate(s.elementType===s.type?k:fr(s.type,k),q);L.__reactInternalSnapshotBeforeUpdate=R}break;case 3:var U=s.stateNode.containerInfo;U.nodeType===1?U.textContent="":U.nodeType===9&&U.documentElement&&U.removeChild(U.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(at(163))}}catch(ae){ba(s,s.return,ae)}if(t=s.sibling,t!==null){t.return=s.return,bt=t;break}bt=s.return}return T=w2,w2=!1,T}function ex(t,s,a){var l=s.updateQueue;if(l=l!==null?l.lastEffect:null,l!==null){var n=l=l.next;do{if((n.tag&t)===t){var r=n.destroy;n.destroy=void 0,r!==void 0&&gj(s,a,r)}n=n.next}while(n!==l)}}function Pg(t,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var a=s=s.next;do{if((a.tag&t)===t){var l=a.create;a.destroy=l()}a=a.next}while(a!==s)}}function fj(t){var s=t.ref;if(s!==null){var a=t.stateNode;switch(t.tag){case 5:t=a;break;default:t=a}typeof s=="function"?s(t):s.current=t}}function SS(t){var s=t.alternate;s!==null&&(t.alternate=null,SS(s)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(s=t.stateNode,s!==null&&(delete s[Kr],delete s[Mx],delete s[aj],delete s[XP],delete s[KP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function AS(t){return t.tag===5||t.tag===3||t.tag===4}function k2(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||AS(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function vj(t,s,a){var l=t.tag;if(l===5||l===6)t=t.stateNode,s?a.nodeType===8?a.parentNode.insertBefore(t,s):a.insertBefore(t,s):(a.nodeType===8?(s=a.parentNode,s.insertBefore(t,a)):(s=a,s.appendChild(t)),a=a._reactRootContainer,a!=null||s.onclick!==null||(s.onclick=P0));else if(l!==4&&(t=t.child,t!==null))for(vj(t,s,a),t=t.sibling;t!==null;)vj(t,s,a),t=t.sibling}function bj(t,s,a){var l=t.tag;if(l===5||l===6)t=t.stateNode,s?a.insertBefore(t,s):a.appendChild(t);else if(l!==4&&(t=t.child,t!==null))for(bj(t,s,a),t=t.sibling;t!==null;)bj(t,s,a),t=t.sibling}var vl=null,br=!1;function Gi(t,s,a){for(a=a.child;a!==null;)ES(t,s,a),a=a.sibling}function ES(t,s,a){if(Jr&&typeof Jr.onCommitFiberUnmount=="function")try{Jr.onCommitFiberUnmount(Ng,a)}catch{}switch(a.tag){case 5:Il||Xc(a,s);case 6:var l=vl,n=br;vl=null,Gi(t,s,a),vl=l,br=n,vl!==null&&(br?(t=vl,a=a.stateNode,t.nodeType===8?t.parentNode.removeChild(a):t.removeChild(a)):vl.removeChild(a.stateNode));break;case 18:vl!==null&&(br?(t=vl,a=a.stateNode,t.nodeType===8?Gf(t.parentNode,a):t.nodeType===1&&Gf(t,a),kx(t)):Gf(vl,a.stateNode));break;case 4:l=vl,n=br,vl=a.stateNode.containerInfo,br=!0,Gi(t,s,a),vl=l,br=n;break;case 0:case 11:case 14:case 15:if(!Il&&(l=a.updateQueue,l!==null&&(l=l.lastEffect,l!==null))){n=l=l.next;do{var r=n,i=r.destroy;r=r.tag,i!==void 0&&(r&2||r&4)&&gj(a,s,i),n=n.next}while(n!==l)}Gi(t,s,a);break;case 1:if(!Il&&(Xc(a,s),l=a.stateNode,typeof l.componentWillUnmount=="function"))try{l.props=a.memoizedProps,l.state=a.memoizedState,l.componentWillUnmount()}catch(o){ba(a,s,o)}Gi(t,s,a);break;case 21:Gi(t,s,a);break;case 22:a.mode&1?(Il=(l=Il)||a.memoizedState!==null,Gi(t,s,a),Il=l):Gi(t,s,a);break;default:Gi(t,s,a)}}function C2(t){var s=t.updateQueue;if(s!==null){t.updateQueue=null;var a=t.stateNode;a===null&&(a=t.stateNode=new u6),s.forEach(function(l){var n=y6.bind(null,t,l);a.has(l)||(a.add(l),l.then(n,n))})}}function rr(t,s){var a=s.deletions;if(a!==null)for(var l=0;l<a.length;l++){var n=a[l];try{var r=t,i=s,o=i;e:for(;o!==null;){switch(o.tag){case 5:vl=o.stateNode,br=!1;break e;case 3:vl=o.stateNode.containerInfo,br=!0;break e;case 4:vl=o.stateNode.containerInfo,br=!0;break e}o=o.return}if(vl===null)throw Error(at(160));ES(r,i,n),vl=null,br=!1;var c=n.alternate;c!==null&&(c.return=null),n.return=null}catch(x){ba(n,s,x)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)MS(s,t),s=s.sibling}function MS(t,s){var a=t.alternate,l=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(rr(s,t),Mr(t),l&4){try{ex(3,t,t.return),Pg(3,t)}catch(k){ba(t,t.return,k)}try{ex(5,t,t.return)}catch(k){ba(t,t.return,k)}}break;case 1:rr(s,t),Mr(t),l&512&&a!==null&&Xc(a,a.return);break;case 5:if(rr(s,t),Mr(t),l&512&&a!==null&&Xc(a,a.return),t.flags&32){var n=t.stateNode;try{jx(n,"")}catch(k){ba(t,t.return,k)}}if(l&4&&(n=t.stateNode,n!=null)){var r=t.memoizedProps,i=a!==null?a.memoizedProps:r,o=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{o==="input"&&r.type==="radio"&&r.name!=null&&YC(n,r),Gb(o,i);var x=Gb(o,r);for(i=0;i<c.length;i+=2){var j=c[i],g=c[i+1];j==="style"?s3(n,g):j==="dangerouslySetInnerHTML"?e3(n,g):j==="children"?jx(n,g):jy(n,j,g,x)}switch(o){case"input":Fb(n,r);break;case"textarea":JC(n,r);break;case"select":var N=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!r.multiple;var $=r.value;$!=null?nu(n,!!r.multiple,$,!1):N!==!!r.multiple&&(r.defaultValue!=null?nu(n,!!r.multiple,r.defaultValue,!0):nu(n,!!r.multiple,r.multiple?[]:"",!1))}n[Mx]=r}catch(k){ba(t,t.return,k)}}break;case 6:if(rr(s,t),Mr(t),l&4){if(t.stateNode===null)throw Error(at(162));n=t.stateNode,r=t.memoizedProps;try{n.nodeValue=r}catch(k){ba(t,t.return,k)}}break;case 3:if(rr(s,t),Mr(t),l&4&&a!==null&&a.memoizedState.isDehydrated)try{kx(s.containerInfo)}catch(k){ba(t,t.return,k)}break;case 4:rr(s,t),Mr(t);break;case 13:rr(s,t),Mr(t),n=t.child,n.flags&8192&&(r=n.memoizedState!==null,n.stateNode.isHidden=r,!r||n.alternate!==null&&n.alternate.memoizedState!==null||(Zy=Ra())),l&4&&C2(t);break;case 22:if(j=a!==null&&a.memoizedState!==null,t.mode&1?(Il=(x=Il)||j,rr(s,t),Il=x):rr(s,t),Mr(t),l&8192){if(x=t.memoizedState!==null,(t.stateNode.isHidden=x)&&!j&&t.mode&1)for(bt=t,j=t.child;j!==null;){for(g=bt=j;bt!==null;){switch(N=bt,$=N.child,N.tag){case 0:case 11:case 14:case 15:ex(4,N,N.return);break;case 1:Xc(N,N.return);var T=N.stateNode;if(typeof T.componentWillUnmount=="function"){l=N,a=N.return;try{s=l,T.props=s.memoizedProps,T.state=s.memoizedState,T.componentWillUnmount()}catch(k){ba(l,a,k)}}break;case 5:Xc(N,N.return);break;case 22:if(N.memoizedState!==null){A2(g);continue}}$!==null?($.return=N,bt=$):A2(g)}j=j.sibling}e:for(j=null,g=t;;){if(g.tag===5){if(j===null){j=g;try{n=g.stateNode,x?(r=n.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none"):(o=g.stateNode,c=g.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=t3("display",i))}catch(k){ba(t,t.return,k)}}}else if(g.tag===6){if(j===null)try{g.stateNode.nodeValue=x?"":g.memoizedProps}catch(k){ba(t,t.return,k)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===t)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===t)break e;for(;g.sibling===null;){if(g.return===null||g.return===t)break e;j===g&&(j=null),g=g.return}j===g&&(j=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:rr(s,t),Mr(t),l&4&&C2(t);break;case 21:break;default:rr(s,t),Mr(t)}}function Mr(t){var s=t.flags;if(s&2){try{e:{for(var a=t.return;a!==null;){if(AS(a)){var l=a;break e}a=a.return}throw Error(at(160))}switch(l.tag){case 5:var n=l.stateNode;l.flags&32&&(jx(n,""),l.flags&=-33);var r=k2(t);bj(t,r,n);break;case 3:case 4:var i=l.stateNode.containerInfo,o=k2(t);vj(t,o,i);break;default:throw Error(at(161))}}catch(c){ba(t,t.return,c)}t.flags&=-3}s&4096&&(t.flags&=-4097)}function x6(t,s,a){bt=t,PS(t)}function PS(t,s,a){for(var l=(t.mode&1)!==0;bt!==null;){var n=bt,r=n.child;if(n.tag===22&&l){var i=n.memoizedState!==null||Pp;if(!i){var o=n.alternate,c=o!==null&&o.memoizedState!==null||Il;o=Pp;var x=Il;if(Pp=i,(Il=c)&&!x)for(bt=n;bt!==null;)i=bt,c=i.child,i.tag===22&&i.memoizedState!==null?E2(n):c!==null?(c.return=i,bt=c):E2(n);for(;r!==null;)bt=r,PS(r),r=r.sibling;bt=n,Pp=o,Il=x}S2(t)}else n.subtreeFlags&8772&&r!==null?(r.return=n,bt=r):S2(t)}}function S2(t){for(;bt!==null;){var s=bt;if(s.flags&8772){var a=s.alternate;try{if(s.flags&8772)switch(s.tag){case 0:case 11:case 15:Il||Pg(5,s);break;case 1:var l=s.stateNode;if(s.flags&4&&!Il)if(a===null)l.componentDidMount();else{var n=s.elementType===s.type?a.memoizedProps:fr(s.type,a.memoizedProps);l.componentDidUpdate(n,a.memoizedState,l.__reactInternalSnapshotBeforeUpdate)}var r=s.updateQueue;r!==null&&c2(s,r,l);break;case 3:var i=s.updateQueue;if(i!==null){if(a=null,s.child!==null)switch(s.child.tag){case 5:a=s.child.stateNode;break;case 1:a=s.child.stateNode}c2(s,i,a)}break;case 5:var o=s.stateNode;if(a===null&&s.flags&4){a=o;var c=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&a.focus();break;case"img":c.src&&(a.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var x=s.alternate;if(x!==null){var j=x.memoizedState;if(j!==null){var g=j.dehydrated;g!==null&&kx(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(at(163))}Il||s.flags&512&&fj(s)}catch(N){ba(s,s.return,N)}}if(s===t){bt=null;break}if(a=s.sibling,a!==null){a.return=s.return,bt=a;break}bt=s.return}}function A2(t){for(;bt!==null;){var s=bt;if(s===t){bt=null;break}var a=s.sibling;if(a!==null){a.return=s.return,bt=a;break}bt=s.return}}function E2(t){for(;bt!==null;){var s=bt;try{switch(s.tag){case 0:case 11:case 15:var a=s.return;try{Pg(4,s)}catch(c){ba(s,a,c)}break;case 1:var l=s.stateNode;if(typeof l.componentDidMount=="function"){var n=s.return;try{l.componentDidMount()}catch(c){ba(s,n,c)}}var r=s.return;try{fj(s)}catch(c){ba(s,r,c)}break;case 5:var i=s.return;try{fj(s)}catch(c){ba(s,i,c)}}}catch(c){ba(s,s.return,c)}if(s===t){bt=null;break}var o=s.sibling;if(o!==null){o.return=s.return,bt=o;break}bt=s.return}}var p6=Math.ceil,_0=Fi.ReactCurrentDispatcher,Yy=Fi.ReactCurrentOwner,er=Fi.ReactCurrentBatchConfig,os=0,xl=null,Ka=null,Nl=0,Sn=0,Kc=qo(0),ll=0,Ix=null,Bd=0,Og=0,Jy=0,tx=null,dn=null,Zy=0,ju=1/0,vi=null,B0=!1,jj=null,To=null,Op=!1,yo=null,G0=0,sx=0,yj=null,n0=-1,r0=0;function Yl(){return os&6?Ra():n0!==-1?n0:n0=Ra()}function Ro(t){return t.mode&1?os&2&&Nl!==0?Nl&-Nl:YP.transition!==null?(r0===0&&(r0=p3()),r0):(t=ks,t!==0||(t=window.event,t=t===void 0?16:y3(t.type)),t):1}function Cr(t,s,a,l){if(50<sx)throw sx=0,yj=null,Error(at(185));ep(t,a,l),(!(os&2)||t!==xl)&&(t===xl&&(!(os&2)&&(Og|=a),ll===4&&fo(t,Nl)),pn(t,l),a===1&&os===0&&!(s.mode&1)&&(ju=Ra()+500,Ag&&zo()))}function pn(t,s){var a=t.callbackNode;YM(t,s);var l=S0(t,t===xl?Nl:0);if(l===0)a!==null&&Lw(a),t.callbackNode=null,t.callbackPriority=0;else if(s=l&-l,t.callbackPriority!==s){if(a!=null&&Lw(a),s===1)t.tag===0?QP(M2.bind(null,t)):V3(M2.bind(null,t)),WP(function(){!(os&6)&&zo()}),a=null;else{switch(h3(l)){case 1:a=Cy;break;case 4:a=m3;break;case 16:a=C0;break;case 536870912:a=x3;break;default:a=C0}a=FS(a,OS.bind(null,t))}t.callbackPriority=s,t.callbackNode=a}}function OS(t,s){if(n0=-1,r0=0,os&6)throw Error(at(327));var a=t.callbackNode;if(cu()&&t.callbackNode!==a)return null;var l=S0(t,t===xl?Nl:0);if(l===0)return null;if(l&30||l&t.expiredLanes||s)s=q0(t,l);else{s=l;var n=os;os|=2;var r=RS();(xl!==t||Nl!==s)&&(vi=null,ju=Ra()+500,Rd(t,s));do try{f6();break}catch(o){TS(t,o)}while(!0);Fy(),_0.current=r,os=n,Ka!==null?s=0:(xl=null,Nl=0,s=ll)}if(s!==0){if(s===2&&(n=Xb(t),n!==0&&(l=n,s=Nj(t,n))),s===1)throw a=Ix,Rd(t,0),fo(t,l),pn(t,Ra()),a;if(s===6)fo(t,l);else{if(n=t.current.alternate,!(l&30)&&!h6(n)&&(s=q0(t,l),s===2&&(r=Xb(t),r!==0&&(l=r,s=Nj(t,r))),s===1))throw a=Ix,Rd(t,0),fo(t,l),pn(t,Ra()),a;switch(t.finishedWork=n,t.finishedLanes=l,s){case 0:case 1:throw Error(at(345));case 2:jd(t,dn,vi);break;case 3:if(fo(t,l),(l&130023424)===l&&(s=Zy+500-Ra(),10<s)){if(S0(t,0)!==0)break;if(n=t.suspendedLanes,(n&l)!==l){Yl(),t.pingedLanes|=t.suspendedLanes&n;break}t.timeoutHandle=sj(jd.bind(null,t,dn,vi),s);break}jd(t,dn,vi);break;case 4:if(fo(t,l),(l&4194240)===l)break;for(s=t.eventTimes,n=-1;0<l;){var i=31-kr(l);r=1<<i,i=s[i],i>n&&(n=i),l&=~r}if(l=n,l=Ra()-l,l=(120>l?120:480>l?480:1080>l?1080:1920>l?1920:3e3>l?3e3:4320>l?4320:1960*p6(l/1960))-l,10<l){t.timeoutHandle=sj(jd.bind(null,t,dn,vi),l);break}jd(t,dn,vi);break;case 5:jd(t,dn,vi);break;default:throw Error(at(329))}}}return pn(t,Ra()),t.callbackNode===a?OS.bind(null,t):null}function Nj(t,s){var a=tx;return t.current.memoizedState.isDehydrated&&(Rd(t,s).flags|=256),t=q0(t,s),t!==2&&(s=dn,dn=a,s!==null&&wj(s)),t}function wj(t){dn===null?dn=t:dn.push.apply(dn,t)}function h6(t){for(var s=t;;){if(s.flags&16384){var a=s.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var l=0;l<a.length;l++){var n=a[l],r=n.getSnapshot;n=n.value;try{if(!Er(r(),n))return!1}catch{return!1}}}if(a=s.child,s.subtreeFlags&16384&&a!==null)a.return=s,s=a;else{if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function fo(t,s){for(s&=~Jy,s&=~Og,t.suspendedLanes|=s,t.pingedLanes&=~s,t=t.expirationTimes;0<s;){var a=31-kr(s),l=1<<a;t[a]=-1,s&=~l}}function M2(t){if(os&6)throw Error(at(327));cu();var s=S0(t,0);if(!(s&1))return pn(t,Ra()),null;var a=q0(t,s);if(t.tag!==0&&a===2){var l=Xb(t);l!==0&&(s=l,a=Nj(t,l))}if(a===1)throw a=Ix,Rd(t,0),fo(t,s),pn(t,Ra()),a;if(a===6)throw Error(at(345));return t.finishedWork=t.current.alternate,t.finishedLanes=s,jd(t,dn,vi),pn(t,Ra()),null}function eN(t,s){var a=os;os|=1;try{return t(s)}finally{os=a,os===0&&(ju=Ra()+500,Ag&&zo())}}function Gd(t){yo!==null&&yo.tag===0&&!(os&6)&&cu();var s=os;os|=1;var a=er.transition,l=ks;try{if(er.transition=null,ks=1,t)return t()}finally{ks=l,er.transition=a,os=s,!(os&6)&&zo()}}function tN(){Sn=Kc.current,Ks(Kc)}function Rd(t,s){t.finishedWork=null,t.finishedLanes=0;var a=t.timeoutHandle;if(a!==-1&&(t.timeoutHandle=-1,zP(a)),Ka!==null)for(a=Ka.return;a!==null;){var l=a;switch(Iy(l),l.tag){case 1:l=l.type.childContextTypes,l!=null&&O0();break;case 3:vu(),Ks(mn),Ks(Ll),qy();break;case 5:Gy(l);break;case 4:vu();break;case 13:Ks(da);break;case 19:Ks(da);break;case 10:Uy(l.type._context);break;case 22:case 23:tN()}a=a.return}if(xl=t,Ka=t=Do(t.current,null),Nl=Sn=s,ll=0,Ix=null,Jy=Og=Bd=0,dn=tx=null,Ed!==null){for(s=0;s<Ed.length;s++)if(a=Ed[s],l=a.interleaved,l!==null){a.interleaved=null;var n=l.next,r=a.pending;if(r!==null){var i=r.next;r.next=n,l.next=i}a.pending=l}Ed=null}return t}function TS(t,s){do{var a=Ka;try{if(Fy(),s0.current=V0,U0){for(var l=ma.memoizedState;l!==null;){var n=l.queue;n!==null&&(n.pending=null),l=l.next}U0=!1}if(_d=0,ml=tl=ma=null,Zm=!1,Tx=0,Yy.current=null,a===null||a.return===null){ll=1,Ix=s,Ka=null;break}e:{var r=t,i=a.return,o=a,c=s;if(s=Nl,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var x=c,j=o,g=j.tag;if(!(j.mode&1)&&(g===0||g===11||g===15)){var N=j.alternate;N?(j.updateQueue=N.updateQueue,j.memoizedState=N.memoizedState,j.lanes=N.lanes):(j.updateQueue=null,j.memoizedState=null)}var $=g2(i);if($!==null){$.flags&=-257,f2($,i,o,r,s),$.mode&1&&h2(r,x,s),s=$,c=x;var T=s.updateQueue;if(T===null){var k=new Set;k.add(c),s.updateQueue=k}else T.add(c);break e}else{if(!(s&1)){h2(r,x,s),sN();break e}c=Error(at(426))}}else if(na&&o.mode&1){var q=g2(i);if(q!==null){!(q.flags&65536)&&(q.flags|=256),f2(q,i,o,r,s),$y(bu(c,o));break e}}r=c=bu(c,o),ll!==4&&(ll=2),tx===null?tx=[r]:tx.push(r),r=i;do{switch(r.tag){case 3:r.flags|=65536,s&=-s,r.lanes|=s;var L=hS(r,c,s);d2(r,L);break e;case 1:o=c;var R=r.type,U=r.stateNode;if(!(r.flags&128)&&(typeof R.getDerivedStateFromError=="function"||U!==null&&typeof U.componentDidCatch=="function"&&(To===null||!To.has(U)))){r.flags|=65536,s&=-s,r.lanes|=s;var ae=gS(r,o,s);d2(r,ae);break e}}r=r.return}while(r!==null)}IS(a)}catch(ie){s=ie,Ka===a&&a!==null&&(Ka=a=a.return);continue}break}while(!0)}function RS(){var t=_0.current;return _0.current=V0,t===null?V0:t}function sN(){(ll===0||ll===3||ll===2)&&(ll=4),xl===null||!(Bd&268435455)&&!(Og&268435455)||fo(xl,Nl)}function q0(t,s){var a=os;os|=2;var l=RS();(xl!==t||Nl!==s)&&(vi=null,Rd(t,s));do try{g6();break}catch(n){TS(t,n)}while(!0);if(Fy(),os=a,_0.current=l,Ka!==null)throw Error(at(261));return xl=null,Nl=0,ll}function g6(){for(;Ka!==null;)DS(Ka)}function f6(){for(;Ka!==null&&!BM();)DS(Ka)}function DS(t){var s=LS(t.alternate,t,Sn);t.memoizedProps=t.pendingProps,s===null?IS(t):Ka=s,Yy.current=null}function IS(t){var s=t;do{var a=s.alternate;if(t=s.return,s.flags&32768){if(a=c6(a,s),a!==null){a.flags&=32767,Ka=a;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ll=6,Ka=null;return}}else if(a=d6(a,s,Sn),a!==null){Ka=a;return}if(s=s.sibling,s!==null){Ka=s;return}Ka=s=t}while(s!==null);ll===0&&(ll=5)}function jd(t,s,a){var l=ks,n=er.transition;try{er.transition=null,ks=1,v6(t,s,a,l)}finally{er.transition=n,ks=l}return null}function v6(t,s,a,l){do cu();while(yo!==null);if(os&6)throw Error(at(327));a=t.finishedWork;var n=t.finishedLanes;if(a===null)return null;if(t.finishedWork=null,t.finishedLanes=0,a===t.current)throw Error(at(177));t.callbackNode=null,t.callbackPriority=0;var r=a.lanes|a.childLanes;if(JM(t,r),t===xl&&(Ka=xl=null,Nl=0),!(a.subtreeFlags&2064)&&!(a.flags&2064)||Op||(Op=!0,FS(C0,function(){return cu(),null})),r=(a.flags&15990)!==0,a.subtreeFlags&15990||r){r=er.transition,er.transition=null;var i=ks;ks=1;var o=os;os|=4,Yy.current=null,m6(t,a),MS(a,t),FP(ej),A0=!!Zb,ej=Zb=null,t.current=a,x6(a),GM(),os=o,ks=i,er.transition=r}else t.current=a;if(Op&&(Op=!1,yo=t,G0=n),r=t.pendingLanes,r===0&&(To=null),WM(a.stateNode),pn(t,Ra()),s!==null)for(l=t.onRecoverableError,a=0;a<s.length;a++)n=s[a],l(n.value,{componentStack:n.stack,digest:n.digest});if(B0)throw B0=!1,t=jj,jj=null,t;return G0&1&&t.tag!==0&&cu(),r=t.pendingLanes,r&1?t===yj?sx++:(sx=0,yj=t):sx=0,zo(),null}function cu(){if(yo!==null){var t=h3(G0),s=er.transition,a=ks;try{if(er.transition=null,ks=16>t?16:t,yo===null)var l=!1;else{if(t=yo,yo=null,G0=0,os&6)throw Error(at(331));var n=os;for(os|=4,bt=t.current;bt!==null;){var r=bt,i=r.child;if(bt.flags&16){var o=r.deletions;if(o!==null){for(var c=0;c<o.length;c++){var x=o[c];for(bt=x;bt!==null;){var j=bt;switch(j.tag){case 0:case 11:case 15:ex(8,j,r)}var g=j.child;if(g!==null)g.return=j,bt=g;else for(;bt!==null;){j=bt;var N=j.sibling,$=j.return;if(SS(j),j===x){bt=null;break}if(N!==null){N.return=$,bt=N;break}bt=$}}}var T=r.alternate;if(T!==null){var k=T.child;if(k!==null){T.child=null;do{var q=k.sibling;k.sibling=null,k=q}while(k!==null)}}bt=r}}if(r.subtreeFlags&2064&&i!==null)i.return=r,bt=i;else e:for(;bt!==null;){if(r=bt,r.flags&2048)switch(r.tag){case 0:case 11:case 15:ex(9,r,r.return)}var L=r.sibling;if(L!==null){L.return=r.return,bt=L;break e}bt=r.return}}var R=t.current;for(bt=R;bt!==null;){i=bt;var U=i.child;if(i.subtreeFlags&2064&&U!==null)U.return=i,bt=U;else e:for(i=R;bt!==null;){if(o=bt,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Pg(9,o)}}catch(ie){ba(o,o.return,ie)}if(o===i){bt=null;break e}var ae=o.sibling;if(ae!==null){ae.return=o.return,bt=ae;break e}bt=o.return}}if(os=n,zo(),Jr&&typeof Jr.onPostCommitFiberRoot=="function")try{Jr.onPostCommitFiberRoot(Ng,t)}catch{}l=!0}return l}finally{ks=a,er.transition=s}}return!1}function P2(t,s,a){s=bu(a,s),s=hS(t,s,1),t=Oo(t,s,1),s=Yl(),t!==null&&(ep(t,1,s),pn(t,s))}function ba(t,s,a){if(t.tag===3)P2(t,t,a);else for(;s!==null;){if(s.tag===3){P2(s,t,a);break}else if(s.tag===1){var l=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(To===null||!To.has(l))){t=bu(a,t),t=gS(s,t,1),s=Oo(s,t,1),t=Yl(),s!==null&&(ep(s,1,t),pn(s,t));break}}s=s.return}}function b6(t,s,a){var l=t.pingCache;l!==null&&l.delete(s),s=Yl(),t.pingedLanes|=t.suspendedLanes&a,xl===t&&(Nl&a)===a&&(ll===4||ll===3&&(Nl&130023424)===Nl&&500>Ra()-Zy?Rd(t,0):Jy|=a),pn(t,s)}function $S(t,s){s===0&&(t.mode&1?(s=yp,yp<<=1,!(yp&130023424)&&(yp=4194304)):s=1);var a=Yl();t=Oi(t,s),t!==null&&(ep(t,s,a),pn(t,a))}function j6(t){var s=t.memoizedState,a=0;s!==null&&(a=s.retryLane),$S(t,a)}function y6(t,s){var a=0;switch(t.tag){case 13:var l=t.stateNode,n=t.memoizedState;n!==null&&(a=n.retryLane);break;case 19:l=t.stateNode;break;default:throw Error(at(314))}l!==null&&l.delete(s),$S(t,a)}var LS;LS=function(t,s,a){if(t!==null)if(t.memoizedProps!==s.pendingProps||mn.current)un=!0;else{if(!(t.lanes&a)&&!(s.flags&128))return un=!1,o6(t,s,a);un=!!(t.flags&131072)}else un=!1,na&&s.flags&1048576&&_3(s,D0,s.index);switch(s.lanes=0,s.tag){case 2:var l=s.type;l0(t,s),t=s.pendingProps;var n=hu(s,Ll.current);du(s,a),n=Wy(null,s,l,t,n,a);var r=Hy();return s.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,xn(l)?(r=!0,T0(s)):r=!1,s.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,_y(s),n.updater=Mg,s.stateNode=n,n._reactInternals=s,dj(s,l,t,a),s=mj(null,s,l,!0,r,a)):(s.tag=0,na&&r&&Dy(s),zl(null,s,n,a),s=s.child),s;case 16:l=s.elementType;e:{switch(l0(t,s),t=s.pendingProps,n=l._init,l=n(l._payload),s.type=l,n=s.tag=w6(l),t=fr(l,t),n){case 0:s=uj(null,s,l,t,a);break e;case 1:s=j2(null,s,l,t,a);break e;case 11:s=v2(null,s,l,t,a);break e;case 14:s=b2(null,s,l,fr(l.type,t),a);break e}throw Error(at(306,l,""))}return s;case 0:return l=s.type,n=s.pendingProps,n=s.elementType===l?n:fr(l,n),uj(t,s,l,n,a);case 1:return l=s.type,n=s.pendingProps,n=s.elementType===l?n:fr(l,n),j2(t,s,l,n,a);case 3:e:{if(jS(s),t===null)throw Error(at(387));l=s.pendingProps,r=s.memoizedState,n=r.element,H3(t,s),L0(s,l,null,a);var i=s.memoizedState;if(l=i.element,r.isDehydrated)if(r={element:l,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},s.updateQueue.baseState=r,s.memoizedState=r,s.flags&256){n=bu(Error(at(423)),s),s=y2(t,s,l,a,n);break e}else if(l!==n){n=bu(Error(at(424)),s),s=y2(t,s,l,a,n);break e}else for(Pn=Po(s.stateNode.containerInfo.firstChild),On=s,na=!0,jr=null,a=z3(s,null,l,a),s.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(gu(),l===n){s=Ti(t,s,a);break e}zl(t,s,l,a)}s=s.child}return s;case 5:return X3(s),t===null&&rj(s),l=s.type,n=s.pendingProps,r=t!==null?t.memoizedProps:null,i=n.children,tj(l,n)?i=null:r!==null&&tj(l,r)&&(s.flags|=32),bS(t,s),zl(t,s,i,a),s.child;case 6:return t===null&&rj(s),null;case 13:return yS(t,s,a);case 4:return By(s,s.stateNode.containerInfo),l=s.pendingProps,t===null?s.child=fu(s,null,l,a):zl(t,s,l,a),s.child;case 11:return l=s.type,n=s.pendingProps,n=s.elementType===l?n:fr(l,n),v2(t,s,l,n,a);case 7:return zl(t,s,s.pendingProps,a),s.child;case 8:return zl(t,s,s.pendingProps.children,a),s.child;case 12:return zl(t,s,s.pendingProps.children,a),s.child;case 10:e:{if(l=s.type._context,n=s.pendingProps,r=s.memoizedProps,i=n.value,Fs(I0,l._currentValue),l._currentValue=i,r!==null)if(Er(r.value,i)){if(r.children===n.children&&!mn.current){s=Ti(t,s,a);break e}}else for(r=s.child,r!==null&&(r.return=s);r!==null;){var o=r.dependencies;if(o!==null){i=r.child;for(var c=o.firstContext;c!==null;){if(c.context===l){if(r.tag===1){c=Si(-1,a&-a),c.tag=2;var x=r.updateQueue;if(x!==null){x=x.shared;var j=x.pending;j===null?c.next=c:(c.next=j.next,j.next=c),x.pending=c}}r.lanes|=a,c=r.alternate,c!==null&&(c.lanes|=a),ij(r.return,a,s),o.lanes|=a;break}c=c.next}}else if(r.tag===10)i=r.type===s.type?null:r.child;else if(r.tag===18){if(i=r.return,i===null)throw Error(at(341));i.lanes|=a,o=i.alternate,o!==null&&(o.lanes|=a),ij(i,a,s),i=r.sibling}else i=r.child;if(i!==null)i.return=r;else for(i=r;i!==null;){if(i===s){i=null;break}if(r=i.sibling,r!==null){r.return=i.return,i=r;break}i=i.return}r=i}zl(t,s,n.children,a),s=s.child}return s;case 9:return n=s.type,l=s.pendingProps.children,du(s,a),n=tr(n),l=l(n),s.flags|=1,zl(t,s,l,a),s.child;case 14:return l=s.type,n=fr(l,s.pendingProps),n=fr(l.type,n),b2(t,s,l,n,a);case 15:return fS(t,s,s.type,s.pendingProps,a);case 17:return l=s.type,n=s.pendingProps,n=s.elementType===l?n:fr(l,n),l0(t,s),s.tag=1,xn(l)?(t=!0,T0(s)):t=!1,du(s,a),pS(s,l,n),dj(s,l,n,a),mj(null,s,l,!0,t,a);case 19:return NS(t,s,a);case 22:return vS(t,s,a)}throw Error(at(156,s.tag))};function FS(t,s){return u3(t,s)}function N6(t,s,a,l){this.tag=t,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zn(t,s,a,l){return new N6(t,s,a,l)}function aN(t){return t=t.prototype,!(!t||!t.isReactComponent)}function w6(t){if(typeof t=="function")return aN(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ny)return 11;if(t===wy)return 14}return 2}function Do(t,s){var a=t.alternate;return a===null?(a=Zn(t.tag,s,t.key,t.mode),a.elementType=t.elementType,a.type=t.type,a.stateNode=t.stateNode,a.alternate=t,t.alternate=a):(a.pendingProps=s,a.type=t.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=t.flags&14680064,a.childLanes=t.childLanes,a.lanes=t.lanes,a.child=t.child,a.memoizedProps=t.memoizedProps,a.memoizedState=t.memoizedState,a.updateQueue=t.updateQueue,s=t.dependencies,a.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},a.sibling=t.sibling,a.index=t.index,a.ref=t.ref,a}function i0(t,s,a,l,n,r){var i=2;if(l=t,typeof t=="function")aN(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case Uc:return Dd(a.children,n,r,s);case yy:i=8,n|=8;break;case Rb:return t=Zn(12,a,s,n|2),t.elementType=Rb,t.lanes=r,t;case Db:return t=Zn(13,a,s,n),t.elementType=Db,t.lanes=r,t;case Ib:return t=Zn(19,a,s,n),t.elementType=Ib,t.lanes=r,t;case XC:return Tg(a,n,r,s);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case WC:i=10;break e;case HC:i=9;break e;case Ny:i=11;break e;case wy:i=14;break e;case xo:i=16,l=null;break e}throw Error(at(130,t==null?t:typeof t,""))}return s=Zn(i,a,s,n),s.elementType=t,s.type=l,s.lanes=r,s}function Dd(t,s,a,l){return t=Zn(7,t,l,s),t.lanes=a,t}function Tg(t,s,a,l){return t=Zn(22,t,l,s),t.elementType=XC,t.lanes=a,t.stateNode={isHidden:!1},t}function Yf(t,s,a){return t=Zn(6,t,null,s),t.lanes=a,t}function Jf(t,s,a){return s=Zn(4,t.children!==null?t.children:[],t.key,s),s.lanes=a,s.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},s}function k6(t,s,a,l,n){this.tag=s,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Tf(0),this.expirationTimes=Tf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tf(0),this.identifierPrefix=l,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function lN(t,s,a,l,n,r,i,o,c){return t=new k6(t,s,a,o,c),s===1?(s=1,r===!0&&(s|=8)):s=0,r=Zn(3,null,null,s),t.current=r,r.stateNode=t,r.memoizedState={element:l,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},_y(r),t}function C6(t,s,a){var l=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fc,key:l==null?null:""+l,children:t,containerInfo:s,implementation:a}}function US(t){if(!t)return Uo;t=t._reactInternals;e:{if(Hd(t)!==t||t.tag!==1)throw Error(at(170));var s=t;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(xn(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(at(171))}if(t.tag===1){var a=t.type;if(xn(a))return U3(t,a,s)}return s}function VS(t,s,a,l,n,r,i,o,c){return t=lN(a,l,!0,t,n,r,i,o,c),t.context=US(null),a=t.current,l=Yl(),n=Ro(a),r=Si(l,n),r.callback=s??null,Oo(a,r,n),t.current.lanes=n,ep(t,n,l),pn(t,l),t}function Rg(t,s,a,l){var n=s.current,r=Yl(),i=Ro(n);return a=US(a),s.context===null?s.context=a:s.pendingContext=a,s=Si(r,i),s.payload={element:t},l=l===void 0?null:l,l!==null&&(s.callback=l),t=Oo(n,s,i),t!==null&&(Cr(t,n,i,r),t0(t,n,i)),i}function z0(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function O2(t,s){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var a=t.retryLane;t.retryLane=a!==0&&a<s?a:s}}function nN(t,s){O2(t,s),(t=t.alternate)&&O2(t,s)}function S6(){return null}var _S=typeof reportError=="function"?reportError:function(t){console.error(t)};function rN(t){this._internalRoot=t}Dg.prototype.render=rN.prototype.render=function(t){var s=this._internalRoot;if(s===null)throw Error(at(409));Rg(t,s,null,null)};Dg.prototype.unmount=rN.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var s=t.containerInfo;Gd(function(){Rg(null,t,null,null)}),s[Pi]=null}};function Dg(t){this._internalRoot=t}Dg.prototype.unstable_scheduleHydration=function(t){if(t){var s=v3();t={blockedOn:null,target:t,priority:s};for(var a=0;a<go.length&&s!==0&&s<go[a].priority;a++);go.splice(a,0,t),a===0&&j3(t)}};function iN(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ig(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function T2(){}function A6(t,s,a,l,n){if(n){if(typeof l=="function"){var r=l;l=function(){var x=z0(i);r.call(x)}}var i=VS(s,l,t,0,null,!1,!1,"",T2);return t._reactRootContainer=i,t[Pi]=i.current,Ax(t.nodeType===8?t.parentNode:t),Gd(),i}for(;n=t.lastChild;)t.removeChild(n);if(typeof l=="function"){var o=l;l=function(){var x=z0(c);o.call(x)}}var c=lN(t,0,!1,null,null,!1,!1,"",T2);return t._reactRootContainer=c,t[Pi]=c.current,Ax(t.nodeType===8?t.parentNode:t),Gd(function(){Rg(s,c,a,l)}),c}function $g(t,s,a,l,n){var r=a._reactRootContainer;if(r){var i=r;if(typeof n=="function"){var o=n;n=function(){var c=z0(i);o.call(c)}}Rg(s,i,t,n)}else i=A6(a,s,t,n,l);return z0(i)}g3=function(t){switch(t.tag){case 3:var s=t.stateNode;if(s.current.memoizedState.isDehydrated){var a=_m(s.pendingLanes);a!==0&&(Sy(s,a|1),pn(s,Ra()),!(os&6)&&(ju=Ra()+500,zo()))}break;case 13:Gd(function(){var l=Oi(t,1);if(l!==null){var n=Yl();Cr(l,t,1,n)}}),nN(t,1)}};Ay=function(t){if(t.tag===13){var s=Oi(t,134217728);if(s!==null){var a=Yl();Cr(s,t,134217728,a)}nN(t,134217728)}};f3=function(t){if(t.tag===13){var s=Ro(t),a=Oi(t,s);if(a!==null){var l=Yl();Cr(a,t,s,l)}nN(t,s)}};v3=function(){return ks};b3=function(t,s){var a=ks;try{return ks=t,s()}finally{ks=a}};zb=function(t,s,a){switch(s){case"input":if(Fb(t,a),s=a.name,a.type==="radio"&&s!=null){for(a=t;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<a.length;s++){var l=a[s];if(l!==t&&l.form===t.form){var n=Sg(l);if(!n)throw Error(at(90));QC(l),Fb(l,n)}}}break;case"textarea":JC(t,a);break;case"select":s=a.value,s!=null&&nu(t,!!a.multiple,s,!1)}};n3=eN;r3=Gd;var E6={usingClientEntryPoint:!1,Events:[sp,Gc,Sg,a3,l3,eN]},Qu={findFiberByHostInstance:Ad,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},M6={bundleType:Qu.bundleType,version:Qu.version,rendererPackageName:Qu.rendererPackageName,rendererConfig:Qu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Fi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=d3(t),t===null?null:t.stateNode},findFiberByHostInstance:Qu.findFiberByHostInstance||S6,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Tp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Tp.isDisabled&&Tp.supportsFiber)try{Ng=Tp.inject(M6),Jr=Tp}catch{}}Ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=E6;Ln.createPortal=function(t,s){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!iN(s))throw Error(at(200));return C6(t,s,null,a)};Ln.createRoot=function(t,s){if(!iN(t))throw Error(at(299));var a=!1,l="",n=_S;return s!=null&&(s.unstable_strictMode===!0&&(a=!0),s.identifierPrefix!==void 0&&(l=s.identifierPrefix),s.onRecoverableError!==void 0&&(n=s.onRecoverableError)),s=lN(t,1,!1,null,null,a,!1,l,n),t[Pi]=s.current,Ax(t.nodeType===8?t.parentNode:t),new rN(s)};Ln.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var s=t._reactInternals;if(s===void 0)throw typeof t.render=="function"?Error(at(188)):(t=Object.keys(t).join(","),Error(at(268,t)));return t=d3(s),t=t===null?null:t.stateNode,t};Ln.flushSync=function(t){return Gd(t)};Ln.hydrate=function(t,s,a){if(!Ig(s))throw Error(at(200));return $g(null,t,s,!0,a)};Ln.hydrateRoot=function(t,s,a){if(!iN(t))throw Error(at(405));var l=a!=null&&a.hydratedSources||null,n=!1,r="",i=_S;if(a!=null&&(a.unstable_strictMode===!0&&(n=!0),a.identifierPrefix!==void 0&&(r=a.identifierPrefix),a.onRecoverableError!==void 0&&(i=a.onRecoverableError)),s=VS(s,null,t,1,a??null,n,!1,r,i),t[Pi]=s.current,Ax(t),l)for(t=0;t<l.length;t++)a=l[t],n=a._getVersion,n=n(a._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[a,n]:s.mutableSourceEagerHydrationData.push(a,n);return new Dg(s)};Ln.render=function(t,s,a){if(!Ig(s))throw Error(at(200));return $g(null,t,s,!1,a)};Ln.unmountComponentAtNode=function(t){if(!Ig(t))throw Error(at(40));return t._reactRootContainer?(Gd(function(){$g(null,null,t,!1,function(){t._reactRootContainer=null,t[Pi]=null})}),!0):!1};Ln.unstable_batchedUpdates=eN;Ln.unstable_renderSubtreeIntoContainer=function(t,s,a,l){if(!Ig(a))throw Error(at(200));if(t==null||t._reactInternals===void 0)throw Error(at(38));return $g(t,s,a,!1,l)};Ln.version="18.3.1-next-f1338f8080-20240426";function BS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(BS)}catch(t){console.error(t)}}BS(),BC.exports=Ln;var P6=BC.exports,R2=P6;Ob.createRoot=R2.createRoot,Ob.hydrateRoot=R2.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $x(){return $x=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(t[l]=a[l])}return t},$x.apply(this,arguments)}var No;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(No||(No={}));const D2="popstate";function O6(t){t===void 0&&(t={});function s(l,n){let{pathname:r,search:i,hash:o}=l.location;return kj("",{pathname:r,search:i,hash:o},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function a(l,n){return typeof n=="string"?n:W0(n)}return R6(s,a,null,t)}function La(t,s){if(t===!1||t===null||typeof t>"u")throw new Error(s)}function oN(t,s){if(!t){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function T6(){return Math.random().toString(36).substr(2,8)}function I2(t,s){return{usr:t.state,key:t.key,idx:s}}function kj(t,s,a,l){return a===void 0&&(a=null),$x({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof s=="string"?Pu(s):s,{state:a,key:s&&s.key||l||T6()})}function W0(t){let{pathname:s="/",search:a="",hash:l=""}=t;return a&&a!=="?"&&(s+=a.charAt(0)==="?"?a:"?"+a),l&&l!=="#"&&(s+=l.charAt(0)==="#"?l:"#"+l),s}function Pu(t){let s={};if(t){let a=t.indexOf("#");a>=0&&(s.hash=t.substr(a),t=t.substr(0,a));let l=t.indexOf("?");l>=0&&(s.search=t.substr(l),t=t.substr(0,l)),t&&(s.pathname=t)}return s}function R6(t,s,a,l){l===void 0&&(l={});let{window:n=document.defaultView,v5Compat:r=!1}=l,i=n.history,o=No.Pop,c=null,x=j();x==null&&(x=0,i.replaceState($x({},i.state,{idx:x}),""));function j(){return(i.state||{idx:null}).idx}function g(){o=No.Pop;let q=j(),L=q==null?null:q-x;x=q,c&&c({action:o,location:k.location,delta:L})}function N(q,L){o=No.Push;let R=kj(k.location,q,L);x=j()+1;let U=I2(R,x),ae=k.createHref(R);try{i.pushState(U,"",ae)}catch(ie){if(ie instanceof DOMException&&ie.name==="DataCloneError")throw ie;n.location.assign(ae)}r&&c&&c({action:o,location:k.location,delta:1})}function $(q,L){o=No.Replace;let R=kj(k.location,q,L);x=j();let U=I2(R,x),ae=k.createHref(R);i.replaceState(U,"",ae),r&&c&&c({action:o,location:k.location,delta:0})}function T(q){let L=n.location.origin!=="null"?n.location.origin:n.location.href,R=typeof q=="string"?q:W0(q);return R=R.replace(/ $/,"%20"),La(L,"No window.location.(origin|href) available to create URL for href: "+R),new URL(R,L)}let k={get action(){return o},get location(){return t(n,i)},listen(q){if(c)throw new Error("A history only accepts one active listener");return n.addEventListener(D2,g),c=q,()=>{n.removeEventListener(D2,g),c=null}},createHref(q){return s(n,q)},createURL:T,encodeLocation(q){let L=T(q);return{pathname:L.pathname,search:L.search,hash:L.hash}},push:N,replace:$,go(q){return i.go(q)}};return k}var $2;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})($2||($2={}));function D6(t,s,a){return a===void 0&&(a="/"),I6(t,s,a)}function I6(t,s,a,l){let n=typeof s=="string"?Pu(s):s,r=dN(n.pathname||"/",a);if(r==null)return null;let i=GS(t);$6(i);let o=null;for(let c=0;o==null&&c<i.length;++c){let x=X6(r);o=z6(i[c],x)}return o}function GS(t,s,a,l){s===void 0&&(s=[]),a===void 0&&(a=[]),l===void 0&&(l="");let n=(r,i,o)=>{let c={relativePath:o===void 0?r.path||"":o,caseSensitive:r.caseSensitive===!0,childrenIndex:i,route:r};c.relativePath.startsWith("/")&&(La(c.relativePath.startsWith(l),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+l+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(l.length));let x=Io([l,c.relativePath]),j=a.concat(c);r.children&&r.children.length>0&&(La(r.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+x+'".')),GS(r.children,s,j,x)),!(r.path==null&&!r.index)&&s.push({path:x,score:G6(x,r.index),routesMeta:j})};return t.forEach((r,i)=>{var o;if(r.path===""||!((o=r.path)!=null&&o.includes("?")))n(r,i);else for(let c of qS(r.path))n(r,i,c)}),s}function qS(t){let s=t.split("/");if(s.length===0)return[];let[a,...l]=s,n=a.endsWith("?"),r=a.replace(/\?$/,"");if(l.length===0)return n?[r,""]:[r];let i=qS(l.join("/")),o=[];return o.push(...i.map(c=>c===""?r:[r,c].join("/"))),n&&o.push(...i),o.map(c=>t.startsWith("/")&&c===""?"/":c)}function $6(t){t.sort((s,a)=>s.score!==a.score?a.score-s.score:q6(s.routesMeta.map(l=>l.childrenIndex),a.routesMeta.map(l=>l.childrenIndex)))}const L6=/^:[\w-]+$/,F6=3,U6=2,V6=1,_6=10,B6=-2,L2=t=>t==="*";function G6(t,s){let a=t.split("/"),l=a.length;return a.some(L2)&&(l+=B6),s&&(l+=U6),a.filter(n=>!L2(n)).reduce((n,r)=>n+(L6.test(r)?F6:r===""?V6:_6),l)}function q6(t,s){return t.length===s.length&&t.slice(0,-1).every((l,n)=>l===s[n])?t[t.length-1]-s[s.length-1]:0}function z6(t,s,a){let{routesMeta:l}=t,n={},r="/",i=[];for(let o=0;o<l.length;++o){let c=l[o],x=o===l.length-1,j=r==="/"?s:s.slice(r.length)||"/",g=W6({path:c.relativePath,caseSensitive:c.caseSensitive,end:x},j),N=c.route;if(!g)return null;Object.assign(n,g.params),i.push({params:n,pathname:Io([r,g.pathname]),pathnameBase:Z6(Io([r,g.pathnameBase])),route:N}),g.pathnameBase!=="/"&&(r=Io([r,g.pathnameBase]))}return i}function W6(t,s){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[a,l]=H6(t.path,t.caseSensitive,t.end),n=s.match(a);if(!n)return null;let r=n[0],i=r.replace(/(.)\/+$/,"$1"),o=n.slice(1);return{params:l.reduce((x,j,g)=>{let{paramName:N,isOptional:$}=j;if(N==="*"){let k=o[g]||"";i=r.slice(0,r.length-k.length).replace(/(.)\/+$/,"$1")}const T=o[g];return $&&!T?x[N]=void 0:x[N]=(T||"").replace(/%2F/g,"/"),x},{}),pathname:r,pathnameBase:i,pattern:t}}function H6(t,s,a){s===void 0&&(s=!1),a===void 0&&(a=!0),oN(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let l=[],n="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,c)=>(l.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(l.push({paramName:"*"}),n+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?n+="\\/*$":t!==""&&t!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,s?void 0:"i"),l]}function X6(t){try{return t.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return oN(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+s+").")),t}}function dN(t,s){if(s==="/")return t;if(!t.toLowerCase().startsWith(s.toLowerCase()))return null;let a=s.endsWith("/")?s.length-1:s.length,l=t.charAt(a);return l&&l!=="/"?null:t.slice(a)||"/"}const K6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Q6=t=>K6.test(t);function Y6(t,s){s===void 0&&(s="/");let{pathname:a,search:l="",hash:n=""}=typeof t=="string"?Pu(t):t,r;if(a)if(Q6(a))r=a;else{if(a.includes("//")){let i=a;a=a.replace(/\/\/+/g,"/"),oN(!1,"Pathnames cannot have embedded double slashes - normalizing "+(i+" -> "+a))}a.startsWith("/")?r=F2(a.substring(1),"/"):r=F2(a,s)}else r=s;return{pathname:r,search:eO(l),hash:tO(n)}}function F2(t,s){let a=s.replace(/\/+$/,"").split("/");return t.split("/").forEach(n=>{n===".."?a.length>1&&a.pop():n!=="."&&a.push(n)}),a.length>1?a.join("/"):"/"}function Zf(t,s,a,l){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+s+"` field ["+JSON.stringify(l)+"].  Please separate it out to the ")+("`to."+a+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function J6(t){return t.filter((s,a)=>a===0||s.route.path&&s.route.path.length>0)}function cN(t,s){let a=J6(t);return s?a.map((l,n)=>n===a.length-1?l.pathname:l.pathnameBase):a.map(l=>l.pathnameBase)}function uN(t,s,a,l){l===void 0&&(l=!1);let n;typeof t=="string"?n=Pu(t):(n=$x({},t),La(!n.pathname||!n.pathname.includes("?"),Zf("?","pathname","search",n)),La(!n.pathname||!n.pathname.includes("#"),Zf("#","pathname","hash",n)),La(!n.search||!n.search.includes("#"),Zf("#","search","hash",n)));let r=t===""||n.pathname==="",i=r?"/":n.pathname,o;if(i==null)o=a;else{let g=s.length-1;if(!l&&i.startsWith("..")){let N=i.split("/");for(;N[0]==="..";)N.shift(),g-=1;n.pathname=N.join("/")}o=g>=0?s[g]:"/"}let c=Y6(n,o),x=i&&i!=="/"&&i.endsWith("/"),j=(r||i===".")&&a.endsWith("/");return!c.pathname.endsWith("/")&&(x||j)&&(c.pathname+="/"),c}const Io=t=>t.join("/").replace(/\/\/+/g,"/"),Z6=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),eO=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,tO=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function sO(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const zS=["post","put","patch","delete"];new Set(zS);const aO=["get",...zS];new Set(aO);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Lx(){return Lx=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(t[l]=a[l])}return t},Lx.apply(this,arguments)}const mN=d.createContext(null),lO=d.createContext(null),Wo=d.createContext(null),Lg=d.createContext(null),Ui=d.createContext({outlet:null,matches:[],isDataRoute:!1}),WS=d.createContext(null);function nO(t,s){let{relative:a}=s===void 0?{}:s;Ou()||La(!1);let{basename:l,navigator:n}=d.useContext(Wo),{hash:r,pathname:i,search:o}=KS(t,{relative:a}),c=i;return l!=="/"&&(c=i==="/"?l:Io([l,i])),n.createHref({pathname:c,search:o,hash:r})}function Ou(){return d.useContext(Lg)!=null}function lp(){return Ou()||La(!1),d.useContext(Lg).location}function HS(t){d.useContext(Wo).static||d.useLayoutEffect(t)}function Xd(){let{isDataRoute:t}=d.useContext(Ui);return t?vO():rO()}function rO(){Ou()||La(!1);let t=d.useContext(mN),{basename:s,future:a,navigator:l}=d.useContext(Wo),{matches:n}=d.useContext(Ui),{pathname:r}=lp(),i=JSON.stringify(cN(n,a.v7_relativeSplatPath)),o=d.useRef(!1);return HS(()=>{o.current=!0}),d.useCallback(function(x,j){if(j===void 0&&(j={}),!o.current)return;if(typeof x=="number"){l.go(x);return}let g=uN(x,JSON.parse(i),r,j.relative==="path");t==null&&s!=="/"&&(g.pathname=g.pathname==="/"?s:Io([s,g.pathname])),(j.replace?l.replace:l.push)(g,j.state,j)},[s,l,i,r,t])}function XS(){let{matches:t}=d.useContext(Ui),s=t[t.length-1];return s?s.params:{}}function KS(t,s){let{relative:a}=s===void 0?{}:s,{future:l}=d.useContext(Wo),{matches:n}=d.useContext(Ui),{pathname:r}=lp(),i=JSON.stringify(cN(n,l.v7_relativeSplatPath));return d.useMemo(()=>uN(t,JSON.parse(i),r,a==="path"),[t,i,r,a])}function iO(t,s){return oO(t,s)}function oO(t,s,a,l){Ou()||La(!1);let{navigator:n}=d.useContext(Wo),{matches:r}=d.useContext(Ui),i=r[r.length-1],o=i?i.params:{};i&&i.pathname;let c=i?i.pathnameBase:"/";i&&i.route;let x=lp(),j;if(s){var g;let q=typeof s=="string"?Pu(s):s;c==="/"||(g=q.pathname)!=null&&g.startsWith(c)||La(!1),j=q}else j=x;let N=j.pathname||"/",$=N;if(c!=="/"){let q=c.replace(/^\//,"").split("/");$="/"+N.replace(/^\//,"").split("/").slice(q.length).join("/")}let T=D6(t,{pathname:$}),k=xO(T&&T.map(q=>Object.assign({},q,{params:Object.assign({},o,q.params),pathname:Io([c,n.encodeLocation?n.encodeLocation(q.pathname).pathname:q.pathname]),pathnameBase:q.pathnameBase==="/"?c:Io([c,n.encodeLocation?n.encodeLocation(q.pathnameBase).pathname:q.pathnameBase])})),r,a,l);return s&&k?d.createElement(Lg.Provider,{value:{location:Lx({pathname:"/",search:"",hash:"",state:null,key:"default"},j),navigationType:No.Pop}},k):k}function dO(){let t=fO(),s=sO(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),a=t instanceof Error?t.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return d.createElement(d.Fragment,null,d.createElement("h2",null,"Unexpected Application Error!"),d.createElement("h3",{style:{fontStyle:"italic"}},s),a?d.createElement("pre",{style:n},a):null,null)}const cO=d.createElement(dO,null);class uO extends d.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,a){return a.location!==s.location||a.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:a.error,location:a.location,revalidation:s.revalidation||a.revalidation}}componentDidCatch(s,a){console.error("React Router caught the following error during render",s,a)}render(){return this.state.error!==void 0?d.createElement(Ui.Provider,{value:this.props.routeContext},d.createElement(WS.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function mO(t){let{routeContext:s,match:a,children:l}=t,n=d.useContext(mN);return n&&n.static&&n.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=a.route.id),d.createElement(Ui.Provider,{value:s},l)}function xO(t,s,a,l){var n;if(s===void 0&&(s=[]),a===void 0&&(a=null),l===void 0&&(l=null),t==null){var r;if(!a)return null;if(a.errors)t=a.matches;else if((r=l)!=null&&r.v7_partialHydration&&s.length===0&&!a.initialized&&a.matches.length>0)t=a.matches;else return null}let i=t,o=(n=a)==null?void 0:n.errors;if(o!=null){let j=i.findIndex(g=>g.route.id&&(o==null?void 0:o[g.route.id])!==void 0);j>=0||La(!1),i=i.slice(0,Math.min(i.length,j+1))}let c=!1,x=-1;if(a&&l&&l.v7_partialHydration)for(let j=0;j<i.length;j++){let g=i[j];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(x=j),g.route.id){let{loaderData:N,errors:$}=a,T=g.route.loader&&N[g.route.id]===void 0&&(!$||$[g.route.id]===void 0);if(g.route.lazy||T){c=!0,x>=0?i=i.slice(0,x+1):i=[i[0]];break}}}return i.reduceRight((j,g,N)=>{let $,T=!1,k=null,q=null;a&&($=o&&g.route.id?o[g.route.id]:void 0,k=g.route.errorElement||cO,c&&(x<0&&N===0?(bO("route-fallback"),T=!0,q=null):x===N&&(T=!0,q=g.route.hydrateFallbackElement||null)));let L=s.concat(i.slice(0,N+1)),R=()=>{let U;return $?U=k:T?U=q:g.route.Component?U=d.createElement(g.route.Component,null):g.route.element?U=g.route.element:U=j,d.createElement(mO,{match:g,routeContext:{outlet:j,matches:L,isDataRoute:a!=null},children:U})};return a&&(g.route.ErrorBoundary||g.route.errorElement||N===0)?d.createElement(uO,{location:a.location,revalidation:a.revalidation,component:k,error:$,children:R(),routeContext:{outlet:null,matches:L,isDataRoute:!0}}):R()},null)}var QS=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(QS||{}),YS=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(YS||{});function pO(t){let s=d.useContext(mN);return s||La(!1),s}function hO(t){let s=d.useContext(lO);return s||La(!1),s}function gO(t){let s=d.useContext(Ui);return s||La(!1),s}function JS(t){let s=gO(),a=s.matches[s.matches.length-1];return a.route.id||La(!1),a.route.id}function fO(){var t;let s=d.useContext(WS),a=hO(),l=JS();return s!==void 0?s:(t=a.errors)==null?void 0:t[l]}function vO(){let{router:t}=pO(QS.UseNavigateStable),s=JS(YS.UseNavigateStable),a=d.useRef(!1);return HS(()=>{a.current=!0}),d.useCallback(function(n,r){r===void 0&&(r={}),a.current&&(typeof n=="number"?t.navigate(n):t.navigate(n,Lx({fromRouteId:s},r)))},[t,s])}const U2={};function bO(t,s,a){U2[t]||(U2[t]=!0)}function jO(t,s){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function yO(t){let{to:s,replace:a,state:l,relative:n}=t;Ou()||La(!1);let{future:r,static:i}=d.useContext(Wo),{matches:o}=d.useContext(Ui),{pathname:c}=lp(),x=Xd(),j=uN(s,cN(o,r.v7_relativeSplatPath),c,n==="path"),g=JSON.stringify(j);return d.useEffect(()=>x(JSON.parse(g),{replace:a,state:l,relative:n}),[x,g,n,a,l]),null}function Ic(t){La(!1)}function NO(t){let{basename:s="/",children:a=null,location:l,navigationType:n=No.Pop,navigator:r,static:i=!1,future:o}=t;Ou()&&La(!1);let c=s.replace(/^\/*/,"/"),x=d.useMemo(()=>({basename:c,navigator:r,static:i,future:Lx({v7_relativeSplatPath:!1},o)}),[c,o,r,i]);typeof l=="string"&&(l=Pu(l));let{pathname:j="/",search:g="",hash:N="",state:$=null,key:T="default"}=l,k=d.useMemo(()=>{let q=dN(j,c);return q==null?null:{location:{pathname:q,search:g,hash:N,state:$,key:T},navigationType:n}},[c,j,g,N,$,T,n]);return k==null?null:d.createElement(Wo.Provider,{value:x},d.createElement(Lg.Provider,{children:a,value:k}))}function wO(t){let{children:s,location:a}=t;return iO(Cj(s),a)}new Promise(()=>{});function Cj(t,s){s===void 0&&(s=[]);let a=[];return d.Children.forEach(t,(l,n)=>{if(!d.isValidElement(l))return;let r=[...s,n];if(l.type===d.Fragment){a.push.apply(a,Cj(l.props.children,r));return}l.type!==Ic&&La(!1),!l.props.index||!l.props.children||La(!1);let i={id:l.props.id||r.join("-"),caseSensitive:l.props.caseSensitive,element:l.props.element,Component:l.props.Component,index:l.props.index,path:l.props.path,loader:l.props.loader,action:l.props.action,errorElement:l.props.errorElement,ErrorBoundary:l.props.ErrorBoundary,hasErrorBoundary:l.props.ErrorBoundary!=null||l.props.errorElement!=null,shouldRevalidate:l.props.shouldRevalidate,handle:l.props.handle,lazy:l.props.lazy};l.props.children&&(i.children=Cj(l.props.children,r)),a.push(i)}),a}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Sj(){return Sj=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(t[l]=a[l])}return t},Sj.apply(this,arguments)}function kO(t,s){if(t==null)return{};var a={},l=Object.keys(t),n,r;for(r=0;r<l.length;r++)n=l[r],!(s.indexOf(n)>=0)&&(a[n]=t[n]);return a}function CO(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function SO(t,s){return t.button===0&&(!s||s==="_self")&&!CO(t)}const AO=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],EO="6";try{window.__reactRouterVersion=EO}catch{}const MO="startTransition",V2=y0[MO];function PO(t){let{basename:s,children:a,future:l,window:n}=t,r=d.useRef();r.current==null&&(r.current=O6({window:n,v5Compat:!0}));let i=r.current,[o,c]=d.useState({action:i.action,location:i.location}),{v7_startTransition:x}=l||{},j=d.useCallback(g=>{x&&V2?V2(()=>c(g)):c(g)},[c,x]);return d.useLayoutEffect(()=>i.listen(j),[i,j]),d.useEffect(()=>jO(l),[l]),d.createElement(NO,{basename:s,children:a,location:o.location,navigationType:o.action,navigator:i,future:l})}const OO=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",TO=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Rp=d.forwardRef(function(s,a){let{onClick:l,relative:n,reloadDocument:r,replace:i,state:o,target:c,to:x,preventScrollReset:j,viewTransition:g}=s,N=kO(s,AO),{basename:$}=d.useContext(Wo),T,k=!1;if(typeof x=="string"&&TO.test(x)&&(T=x,OO))try{let U=new URL(window.location.href),ae=x.startsWith("//")?new URL(U.protocol+x):new URL(x),ie=dN(ae.pathname,$);ae.origin===U.origin&&ie!=null?x=ie+ae.search+ae.hash:k=!0}catch{}let q=nO(x,{relative:n}),L=RO(x,{replace:i,state:o,target:c,preventScrollReset:j,relative:n,viewTransition:g});function R(U){l&&l(U),U.defaultPrevented||L(U)}return d.createElement("a",Sj({},N,{href:T||q,onClick:k||r?l:R,ref:a,target:c}))});var _2;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(_2||(_2={}));var B2;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(B2||(B2={}));function RO(t,s){let{target:a,replace:l,state:n,preventScrollReset:r,relative:i,viewTransition:o}=s===void 0?{}:s,c=Xd(),x=lp(),j=KS(t,{relative:i});return d.useCallback(g=>{if(SO(g,a)){g.preventDefault();let N=l!==void 0?l:W0(x)===W0(j);c(t,{replace:N,state:n,preventScrollReset:r,relative:i,viewTransition:o})}},[x,c,j,l,n,a,t,r,i,o])}const Fx={black:"#000",white:"#fff"},Jd={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},Zd={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},ec={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},tc={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},sc={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"},Yu={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},DO={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"};function yu(t){let s="https://mui.com/production-error/?code="+t;for(let a=1;a<arguments.length;a+=1)s+="&args[]="+encodeURIComponent(arguments[a]);return"Minified MUI error #"+t+"; visit "+s+" for the full message."}const IO=Object.freeze(Object.defineProperty({__proto__:null,default:yu},Symbol.toStringTag,{value:"Module"})),H0="$$material";function st(){return st=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var l in a)({}).hasOwnProperty.call(a,l)&&(t[l]=a[l])}return t},st.apply(null,arguments)}function Na(t,s){if(t==null)return{};var a={};for(var l in t)if({}.hasOwnProperty.call(t,l)){if(s.indexOf(l)!==-1)continue;a[l]=t[l]}return a}function $O(t){if(t.sheet)return t.sheet;for(var s=0;s<document.styleSheets.length;s++)if(document.styleSheets[s].ownerNode===t)return document.styleSheets[s]}function LO(t){var s=document.createElement("style");return s.setAttribute("data-emotion",t.key),t.nonce!==void 0&&s.setAttribute("nonce",t.nonce),s.appendChild(document.createTextNode("")),s.setAttribute("data-s",""),s}var FO=function(){function t(a){var l=this;this._insertTag=function(n){var r;l.tags.length===0?l.insertionPoint?r=l.insertionPoint.nextSibling:l.prepend?r=l.container.firstChild:r=l.before:r=l.tags[l.tags.length-1].nextSibling,l.container.insertBefore(n,r),l.tags.push(n)},this.isSpeedy=a.speedy===void 0?!0:a.speedy,this.tags=[],this.ctr=0,this.nonce=a.nonce,this.key=a.key,this.container=a.container,this.prepend=a.prepend,this.insertionPoint=a.insertionPoint,this.before=null}var s=t.prototype;return s.hydrate=function(l){l.forEach(this._insertTag)},s.insert=function(l){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(LO(this));var n=this.tags[this.tags.length-1];if(this.isSpeedy){var r=$O(n);try{r.insertRule(l,r.cssRules.length)}catch{}}else n.appendChild(document.createTextNode(l));this.ctr++},s.flush=function(){this.tags.forEach(function(l){var n;return(n=l.parentNode)==null?void 0:n.removeChild(l)}),this.tags=[],this.ctr=0},t}(),Ol="-ms-",X0="-moz-",gs="-webkit-",ZS="comm",xN="rule",pN="decl",UO="@import",e5="@keyframes",VO="@layer",_O=Math.abs,Fg=String.fromCharCode,BO=Object.assign;function GO(t,s){return jl(t,0)^45?(((s<<2^jl(t,0))<<2^jl(t,1))<<2^jl(t,2))<<2^jl(t,3):0}function t5(t){return t.trim()}function qO(t,s){return(t=s.exec(t))?t[0]:t}function fs(t,s,a){return t.replace(s,a)}function Aj(t,s){return t.indexOf(s)}function jl(t,s){return t.charCodeAt(s)|0}function Ux(t,s,a){return t.slice(s,a)}function Wr(t){return t.length}function hN(t){return t.length}function Dp(t,s){return s.push(t),t}function zO(t,s){return t.map(s).join("")}var Ug=1,Nu=1,s5=0,gn=0,Xa=0,Tu="";function Vg(t,s,a,l,n,r,i){return{value:t,root:s,parent:a,type:l,props:n,children:r,line:Ug,column:Nu,length:i,return:""}}function Ju(t,s){return BO(Vg("",null,null,"",null,null,0),t,{length:-t.length},s)}function WO(){return Xa}function HO(){return Xa=gn>0?jl(Tu,--gn):0,Nu--,Xa===10&&(Nu=1,Ug--),Xa}function Tn(){return Xa=gn<s5?jl(Tu,gn++):0,Nu++,Xa===10&&(Nu=1,Ug++),Xa}function ei(){return jl(Tu,gn)}function o0(){return gn}function np(t,s){return Ux(Tu,t,s)}function Vx(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function a5(t){return Ug=Nu=1,s5=Wr(Tu=t),gn=0,[]}function l5(t){return Tu="",t}function d0(t){return t5(np(gn-1,Ej(t===91?t+2:t===40?t+1:t)))}function XO(t){for(;(Xa=ei())&&Xa<33;)Tn();return Vx(t)>2||Vx(Xa)>3?"":" "}function KO(t,s){for(;--s&&Tn()&&!(Xa<48||Xa>102||Xa>57&&Xa<65||Xa>70&&Xa<97););return np(t,o0()+(s<6&&ei()==32&&Tn()==32))}function Ej(t){for(;Tn();)switch(Xa){case t:return gn;case 34:case 39:t!==34&&t!==39&&Ej(Xa);break;case 40:t===41&&Ej(t);break;case 92:Tn();break}return gn}function QO(t,s){for(;Tn()&&t+Xa!==57;)if(t+Xa===84&&ei()===47)break;return"/*"+np(s,gn-1)+"*"+Fg(t===47?t:Tn())}function YO(t){for(;!Vx(ei());)Tn();return np(t,gn)}function JO(t){return l5(c0("",null,null,null,[""],t=a5(t),0,[0],t))}function c0(t,s,a,l,n,r,i,o,c){for(var x=0,j=0,g=i,N=0,$=0,T=0,k=1,q=1,L=1,R=0,U="",ae=n,ie=r,_=l,W=U;q;)switch(T=R,R=Tn()){case 40:if(T!=108&&jl(W,g-1)==58){Aj(W+=fs(d0(R),"&","&\f"),"&\f")!=-1&&(L=-1);break}case 34:case 39:case 91:W+=d0(R);break;case 9:case 10:case 13:case 32:W+=XO(T);break;case 92:W+=KO(o0()-1,7);continue;case 47:switch(ei()){case 42:case 47:Dp(ZO(QO(Tn(),o0()),s,a),c);break;default:W+="/"}break;case 123*k:o[x++]=Wr(W)*L;case 125*k:case 59:case 0:switch(R){case 0:case 125:q=0;case 59+j:L==-1&&(W=fs(W,/\f/g,"")),$>0&&Wr(W)-g&&Dp($>32?q2(W+";",l,a,g-1):q2(fs(W," ","")+";",l,a,g-2),c);break;case 59:W+=";";default:if(Dp(_=G2(W,s,a,x,j,n,o,U,ae=[],ie=[],g),r),R===123)if(j===0)c0(W,s,_,_,ae,r,g,o,ie);else switch(N===99&&jl(W,3)===110?100:N){case 100:case 108:case 109:case 115:c0(t,_,_,l&&Dp(G2(t,_,_,0,0,n,o,U,n,ae=[],g),ie),n,ie,g,o,l?ae:ie);break;default:c0(W,_,_,_,[""],ie,0,o,ie)}}x=j=$=0,k=L=1,U=W="",g=i;break;case 58:g=1+Wr(W),$=T;default:if(k<1){if(R==123)--k;else if(R==125&&k++==0&&HO()==125)continue}switch(W+=Fg(R),R*k){case 38:L=j>0?1:(W+="\f",-1);break;case 44:o[x++]=(Wr(W)-1)*L,L=1;break;case 64:ei()===45&&(W+=d0(Tn())),N=ei(),j=g=Wr(U=W+=YO(o0())),R++;break;case 45:T===45&&Wr(W)==2&&(k=0)}}return r}function G2(t,s,a,l,n,r,i,o,c,x,j){for(var g=n-1,N=n===0?r:[""],$=hN(N),T=0,k=0,q=0;T<l;++T)for(var L=0,R=Ux(t,g+1,g=_O(k=i[T])),U=t;L<$;++L)(U=t5(k>0?N[L]+" "+R:fs(R,/&\f/g,N[L])))&&(c[q++]=U);return Vg(t,s,a,n===0?xN:o,c,x,j)}function ZO(t,s,a){return Vg(t,s,a,ZS,Fg(WO()),Ux(t,2,-2),0)}function q2(t,s,a,l){return Vg(t,s,a,pN,Ux(t,0,l),Ux(t,l+1,-1),l)}function uu(t,s){for(var a="",l=hN(t),n=0;n<l;n++)a+=s(t[n],n,t,s)||"";return a}function eT(t,s,a,l){switch(t.type){case VO:if(t.children.length)break;case UO:case pN:return t.return=t.return||t.value;case ZS:return"";case e5:return t.return=t.value+"{"+uu(t.children,l)+"}";case xN:t.value=t.props.join(",")}return Wr(a=uu(t.children,l))?t.return=t.value+"{"+a+"}":""}function tT(t){var s=hN(t);return function(a,l,n,r){for(var i="",o=0;o<s;o++)i+=t[o](a,l,n,r)||"";return i}}function sT(t){return function(s){s.root||(s=s.return)&&t(s)}}function n5(t){var s=Object.create(null);return function(a){return s[a]===void 0&&(s[a]=t(a)),s[a]}}var aT=function(s,a,l){for(var n=0,r=0;n=r,r=ei(),n===38&&r===12&&(a[l]=1),!Vx(r);)Tn();return np(s,gn)},lT=function(s,a){var l=-1,n=44;do switch(Vx(n)){case 0:n===38&&ei()===12&&(a[l]=1),s[l]+=aT(gn-1,a,l);break;case 2:s[l]+=d0(n);break;case 4:if(n===44){s[++l]=ei()===58?"&\f":"",a[l]=s[l].length;break}default:s[l]+=Fg(n)}while(n=Tn());return s},nT=function(s,a){return l5(lT(a5(s),a))},z2=new WeakMap,rT=function(s){if(!(s.type!=="rule"||!s.parent||s.length<1)){for(var a=s.value,l=s.parent,n=s.column===l.column&&s.line===l.line;l.type!=="rule";)if(l=l.parent,!l)return;if(!(s.props.length===1&&a.charCodeAt(0)!==58&&!z2.get(l))&&!n){z2.set(s,!0);for(var r=[],i=nT(a,r),o=l.props,c=0,x=0;c<i.length;c++)for(var j=0;j<o.length;j++,x++)s.props[x]=r[c]?i[c].replace(/&\f/g,o[j]):o[j]+" "+i[c]}}},iT=function(s){if(s.type==="decl"){var a=s.value;a.charCodeAt(0)===108&&a.charCodeAt(2)===98&&(s.return="",s.value="")}};function r5(t,s){switch(GO(t,s)){case 5103:return gs+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return gs+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return gs+t+X0+t+Ol+t+t;case 6828:case 4268:return gs+t+Ol+t+t;case 6165:return gs+t+Ol+"flex-"+t+t;case 5187:return gs+t+fs(t,/(\w+).+(:[^]+)/,gs+"box-$1$2"+Ol+"flex-$1$2")+t;case 5443:return gs+t+Ol+"flex-item-"+fs(t,/flex-|-self/,"")+t;case 4675:return gs+t+Ol+"flex-line-pack"+fs(t,/align-content|flex-|-self/,"")+t;case 5548:return gs+t+Ol+fs(t,"shrink","negative")+t;case 5292:return gs+t+Ol+fs(t,"basis","preferred-size")+t;case 6060:return gs+"box-"+fs(t,"-grow","")+gs+t+Ol+fs(t,"grow","positive")+t;case 4554:return gs+fs(t,/([^-])(transform)/g,"$1"+gs+"$2")+t;case 6187:return fs(fs(fs(t,/(zoom-|grab)/,gs+"$1"),/(image-set)/,gs+"$1"),t,"")+t;case 5495:case 3959:return fs(t,/(image-set\([^]*)/,gs+"$1$`$1");case 4968:return fs(fs(t,/(.+:)(flex-)?(.*)/,gs+"box-pack:$3"+Ol+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+gs+t+t;case 4095:case 3583:case 4068:case 2532:return fs(t,/(.+)-inline(.+)/,gs+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Wr(t)-1-s>6)switch(jl(t,s+1)){case 109:if(jl(t,s+4)!==45)break;case 102:return fs(t,/(.+:)(.+)-([^]+)/,"$1"+gs+"$2-$3$1"+X0+(jl(t,s+3)==108?"$3":"$2-$3"))+t;case 115:return~Aj(t,"stretch")?r5(fs(t,"stretch","fill-available"),s)+t:t}break;case 4949:if(jl(t,s+1)!==115)break;case 6444:switch(jl(t,Wr(t)-3-(~Aj(t,"!important")&&10))){case 107:return fs(t,":",":"+gs)+t;case 101:return fs(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+gs+(jl(t,14)===45?"inline-":"")+"box$3$1"+gs+"$2$3$1"+Ol+"$2box$3")+t}break;case 5936:switch(jl(t,s+11)){case 114:return gs+t+Ol+fs(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return gs+t+Ol+fs(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return gs+t+Ol+fs(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return gs+t+Ol+t+t}return t}var oT=function(s,a,l,n){if(s.length>-1&&!s.return)switch(s.type){case pN:s.return=r5(s.value,s.length);break;case e5:return uu([Ju(s,{value:fs(s.value,"@","@"+gs)})],n);case xN:if(s.length)return zO(s.props,function(r){switch(qO(r,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return uu([Ju(s,{props:[fs(r,/:(read-\w+)/,":"+X0+"$1")]})],n);case"::placeholder":return uu([Ju(s,{props:[fs(r,/:(plac\w+)/,":"+gs+"input-$1")]}),Ju(s,{props:[fs(r,/:(plac\w+)/,":"+X0+"$1")]}),Ju(s,{props:[fs(r,/:(plac\w+)/,Ol+"input-$1")]})],n)}return""})}},dT=[oT],i5=function(s){var a=s.key;if(a==="css"){var l=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(l,function(k){var q=k.getAttribute("data-emotion");q.indexOf(" ")!==-1&&(document.head.appendChild(k),k.setAttribute("data-s",""))})}var n=s.stylisPlugins||dT,r={},i,o=[];i=s.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+a+' "]'),function(k){for(var q=k.getAttribute("data-emotion").split(" "),L=1;L<q.length;L++)r[q[L]]=!0;o.push(k)});var c,x=[rT,iT];{var j,g=[eT,sT(function(k){j.insert(k)})],N=tT(x.concat(n,g)),$=function(q){return uu(JO(q),N)};c=function(q,L,R,U){j=R,$(q?q+"{"+L.styles+"}":L.styles),U&&(T.inserted[L.name]=!0)}}var T={key:a,sheet:new FO({key:a,container:i,nonce:s.nonce,speedy:s.speedy,prepend:s.prepend,insertionPoint:s.insertionPoint}),nonce:s.nonce,inserted:r,registered:{},insert:c};return T.sheet.hydrate(o),T},o5={exports:{}},Cs={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pl=typeof Symbol=="function"&&Symbol.for,gN=pl?Symbol.for("react.element"):60103,fN=pl?Symbol.for("react.portal"):60106,_g=pl?Symbol.for("react.fragment"):60107,Bg=pl?Symbol.for("react.strict_mode"):60108,Gg=pl?Symbol.for("react.profiler"):60114,qg=pl?Symbol.for("react.provider"):60109,zg=pl?Symbol.for("react.context"):60110,vN=pl?Symbol.for("react.async_mode"):60111,Wg=pl?Symbol.for("react.concurrent_mode"):60111,Hg=pl?Symbol.for("react.forward_ref"):60112,Xg=pl?Symbol.for("react.suspense"):60113,cT=pl?Symbol.for("react.suspense_list"):60120,Kg=pl?Symbol.for("react.memo"):60115,Qg=pl?Symbol.for("react.lazy"):60116,uT=pl?Symbol.for("react.block"):60121,mT=pl?Symbol.for("react.fundamental"):60117,xT=pl?Symbol.for("react.responder"):60118,pT=pl?Symbol.for("react.scope"):60119;function Un(t){if(typeof t=="object"&&t!==null){var s=t.$$typeof;switch(s){case gN:switch(t=t.type,t){case vN:case Wg:case _g:case Gg:case Bg:case Xg:return t;default:switch(t=t&&t.$$typeof,t){case zg:case Hg:case Qg:case Kg:case qg:return t;default:return s}}case fN:return s}}}function d5(t){return Un(t)===Wg}Cs.AsyncMode=vN;Cs.ConcurrentMode=Wg;Cs.ContextConsumer=zg;Cs.ContextProvider=qg;Cs.Element=gN;Cs.ForwardRef=Hg;Cs.Fragment=_g;Cs.Lazy=Qg;Cs.Memo=Kg;Cs.Portal=fN;Cs.Profiler=Gg;Cs.StrictMode=Bg;Cs.Suspense=Xg;Cs.isAsyncMode=function(t){return d5(t)||Un(t)===vN};Cs.isConcurrentMode=d5;Cs.isContextConsumer=function(t){return Un(t)===zg};Cs.isContextProvider=function(t){return Un(t)===qg};Cs.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===gN};Cs.isForwardRef=function(t){return Un(t)===Hg};Cs.isFragment=function(t){return Un(t)===_g};Cs.isLazy=function(t){return Un(t)===Qg};Cs.isMemo=function(t){return Un(t)===Kg};Cs.isPortal=function(t){return Un(t)===fN};Cs.isProfiler=function(t){return Un(t)===Gg};Cs.isStrictMode=function(t){return Un(t)===Bg};Cs.isSuspense=function(t){return Un(t)===Xg};Cs.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===_g||t===Wg||t===Gg||t===Bg||t===Xg||t===cT||typeof t=="object"&&t!==null&&(t.$$typeof===Qg||t.$$typeof===Kg||t.$$typeof===qg||t.$$typeof===zg||t.$$typeof===Hg||t.$$typeof===mT||t.$$typeof===xT||t.$$typeof===pT||t.$$typeof===uT)};Cs.typeOf=Un;o5.exports=Cs;var hT=o5.exports,c5=hT,gT={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},fT={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},u5={};u5[c5.ForwardRef]=gT;u5[c5.Memo]=fT;var vT=!0;function m5(t,s,a){var l="";return a.split(" ").forEach(function(n){t[n]!==void 0?s.push(t[n]+";"):n&&(l+=n+" ")}),l}var bN=function(s,a,l){var n=s.key+"-"+a.name;(l===!1||vT===!1)&&s.registered[n]===void 0&&(s.registered[n]=a.styles)},jN=function(s,a,l){bN(s,a,l);var n=s.key+"-"+a.name;if(s.inserted[a.name]===void 0){var r=a;do s.insert(a===r?"."+n:"",r,s.sheet,!0),r=r.next;while(r!==void 0)}};function bT(t){for(var s=0,a,l=0,n=t.length;n>=4;++l,n-=4)a=t.charCodeAt(l)&255|(t.charCodeAt(++l)&255)<<8|(t.charCodeAt(++l)&255)<<16|(t.charCodeAt(++l)&255)<<24,a=(a&65535)*1540483477+((a>>>16)*59797<<16),a^=a>>>24,s=(a&65535)*1540483477+((a>>>16)*59797<<16)^(s&65535)*1540483477+((s>>>16)*59797<<16);switch(n){case 3:s^=(t.charCodeAt(l+2)&255)<<16;case 2:s^=(t.charCodeAt(l+1)&255)<<8;case 1:s^=t.charCodeAt(l)&255,s=(s&65535)*1540483477+((s>>>16)*59797<<16)}return s^=s>>>13,s=(s&65535)*1540483477+((s>>>16)*59797<<16),((s^s>>>15)>>>0).toString(36)}var jT={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},yT=/[A-Z]|^ms/g,NT=/_EMO_([^_]+?)_([^]*?)_EMO_/g,x5=function(s){return s.charCodeAt(1)===45},W2=function(s){return s!=null&&typeof s!="boolean"},ev=n5(function(t){return x5(t)?t:t.replace(yT,"-$&").toLowerCase()}),H2=function(s,a){switch(s){case"animation":case"animationName":if(typeof a=="string")return a.replace(NT,function(l,n,r){return Hr={name:n,styles:r,next:Hr},n})}return jT[s]!==1&&!x5(s)&&typeof a=="number"&&a!==0?a+"px":a};function _x(t,s,a){if(a==null)return"";var l=a;if(l.__emotion_styles!==void 0)return l;switch(typeof a){case"boolean":return"";case"object":{var n=a;if(n.anim===1)return Hr={name:n.name,styles:n.styles,next:Hr},n.name;var r=a;if(r.styles!==void 0){var i=r.next;if(i!==void 0)for(;i!==void 0;)Hr={name:i.name,styles:i.styles,next:Hr},i=i.next;var o=r.styles+";";return o}return wT(t,s,a)}case"function":{if(t!==void 0){var c=Hr,x=a(t);return Hr=c,_x(t,s,x)}break}}var j=a;if(s==null)return j;var g=s[j];return g!==void 0?g:j}function wT(t,s,a){var l="";if(Array.isArray(a))for(var n=0;n<a.length;n++)l+=_x(t,s,a[n])+";";else for(var r in a){var i=a[r];if(typeof i!="object"){var o=i;s!=null&&s[o]!==void 0?l+=r+"{"+s[o]+"}":W2(o)&&(l+=ev(r)+":"+H2(r,o)+";")}else if(Array.isArray(i)&&typeof i[0]=="string"&&(s==null||s[i[0]]===void 0))for(var c=0;c<i.length;c++)W2(i[c])&&(l+=ev(r)+":"+H2(r,i[c])+";");else{var x=_x(t,s,i);switch(r){case"animation":case"animationName":{l+=ev(r)+":"+x+";";break}default:l+=r+"{"+x+"}"}}}return l}var X2=/label:\s*([^\s;{]+)\s*(;|$)/g,Hr;function rp(t,s,a){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var l=!0,n="";Hr=void 0;var r=t[0];if(r==null||r.raw===void 0)l=!1,n+=_x(a,s,r);else{var i=r;n+=i[0]}for(var o=1;o<t.length;o++)if(n+=_x(a,s,t[o]),l){var c=r;n+=c[o]}X2.lastIndex=0;for(var x="",j;(j=X2.exec(n))!==null;)x+="-"+j[1];var g=bT(n)+x;return{name:g,styles:n,next:Hr}}var kT=function(s){return s()},p5=y0.useInsertionEffect?y0.useInsertionEffect:!1,h5=p5||kT,K2=p5||d.useLayoutEffect,g5=d.createContext(typeof HTMLElement<"u"?i5({key:"css"}):null),CT=g5.Provider,yN=function(s){return d.forwardRef(function(a,l){var n=d.useContext(g5);return s(a,n,l)})},Ru=d.createContext({}),NN={}.hasOwnProperty,Mj="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",ST=function(s,a){var l={};for(var n in a)NN.call(a,n)&&(l[n]=a[n]);return l[Mj]=s,l},AT=function(s){var a=s.cache,l=s.serialized,n=s.isStringTag;return bN(a,l,n),h5(function(){return jN(a,l,n)}),null},ET=yN(function(t,s,a){var l=t.css;typeof l=="string"&&s.registered[l]!==void 0&&(l=s.registered[l]);var n=t[Mj],r=[l],i="";typeof t.className=="string"?i=m5(s.registered,r,t.className):t.className!=null&&(i=t.className+" ");var o=rp(r,void 0,d.useContext(Ru));i+=s.key+"-"+o.name;var c={};for(var x in t)NN.call(t,x)&&x!=="css"&&x!==Mj&&(c[x]=t[x]);return c.className=i,a&&(c.ref=a),d.createElement(d.Fragment,null,d.createElement(AT,{cache:s,serialized:o,isStringTag:typeof n=="string"}),d.createElement(n,c))}),MT=ET,tv={exports:{}},Q2;function f5(){return Q2||(Q2=1,function(t){function s(){return t.exports=s=Object.assign?Object.assign.bind():function(a){for(var l=1;l<arguments.length;l++){var n=arguments[l];for(var r in n)({}).hasOwnProperty.call(n,r)&&(a[r]=n[r])}return a},t.exports.__esModule=!0,t.exports.default=t.exports,s.apply(null,arguments)}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports}(tv)),tv.exports}f5();var Y2=function(s,a){var l=arguments;if(a==null||!NN.call(a,"css"))return d.createElement.apply(void 0,l);var n=l.length,r=new Array(n);r[0]=MT,r[1]=ST(s,a);for(var i=2;i<n;i++)r[i]=l[i];return d.createElement.apply(null,r)};(function(t){var s;s||(s=t.JSX||(t.JSX={}))})(Y2||(Y2={}));var PT=yN(function(t,s){var a=t.styles,l=rp([a],void 0,d.useContext(Ru)),n=d.useRef();return K2(function(){var r=s.key+"-global",i=new s.sheet.constructor({key:r,nonce:s.sheet.nonce,container:s.sheet.container,speedy:s.sheet.isSpeedy}),o=!1,c=document.querySelector('style[data-emotion="'+r+" "+l.name+'"]');return s.sheet.tags.length&&(i.before=s.sheet.tags[0]),c!==null&&(o=!0,c.setAttribute("data-emotion",r),i.hydrate([c])),n.current=[i,o],function(){i.flush()}},[s]),K2(function(){var r=n.current,i=r[0],o=r[1];if(o){r[1]=!1;return}if(l.next!==void 0&&jN(s,l.next,!0),i.tags.length){var c=i.tags[i.tags.length-1].nextElementSibling;i.before=c,i.flush()}s.insert("",l,i,!1)},[s,l.name]),null});function v5(){for(var t=arguments.length,s=new Array(t),a=0;a<t;a++)s[a]=arguments[a];return rp(s)}function Yg(){var t=v5.apply(void 0,arguments),s="animation-"+t.name;return{name:s,styles:"@keyframes "+s+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var OT=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|popover|popoverTarget|popoverTargetAction|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,TT=n5(function(t){return OT.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),RT=TT,DT=function(s){return s!=="theme"},J2=function(s){return typeof s=="string"&&s.charCodeAt(0)>96?RT:DT},Z2=function(s,a,l){var n;if(a){var r=a.shouldForwardProp;n=s.__emotion_forwardProp&&r?function(i){return s.__emotion_forwardProp(i)&&r(i)}:r}return typeof n!="function"&&l&&(n=s.__emotion_forwardProp),n},IT=function(s){var a=s.cache,l=s.serialized,n=s.isStringTag;return bN(a,l,n),h5(function(){return jN(a,l,n)}),null},$T=function t(s,a){var l=s.__emotion_real===s,n=l&&s.__emotion_base||s,r,i;a!==void 0&&(r=a.label,i=a.target);var o=Z2(s,a,l),c=o||J2(n),x=!c("as");return function(){var j=arguments,g=l&&s.__emotion_styles!==void 0?s.__emotion_styles.slice(0):[];if(r!==void 0&&g.push("label:"+r+";"),j[0]==null||j[0].raw===void 0)g.push.apply(g,j);else{var N=j[0];g.push(N[0]);for(var $=j.length,T=1;T<$;T++)g.push(j[T],N[T])}var k=yN(function(q,L,R){var U=x&&q.as||n,ae="",ie=[],_=q;if(q.theme==null){_={};for(var W in q)_[W]=q[W];_.theme=d.useContext(Ru)}typeof q.className=="string"?ae=m5(L.registered,ie,q.className):q.className!=null&&(ae=q.className+" ");var J=rp(g.concat(ie),L.registered,_);ae+=L.key+"-"+J.name,i!==void 0&&(ae+=" "+i);var we=x&&o===void 0?J2(U):c,G={};for(var be in q)x&&be==="as"||we(be)&&(G[be]=q[be]);return G.className=ae,R&&(G.ref=R),d.createElement(d.Fragment,null,d.createElement(IT,{cache:L,serialized:J,isStringTag:typeof U=="string"}),d.createElement(U,G))});return k.displayName=r!==void 0?r:"Styled("+(typeof n=="string"?n:n.displayName||n.name||"Component")+")",k.defaultProps=s.defaultProps,k.__emotion_real=k,k.__emotion_base=n,k.__emotion_styles=g,k.__emotion_forwardProp=o,Object.defineProperty(k,"toString",{value:function(){return"."+i}}),k.withComponent=function(q,L){var R=t(q,st({},a,L,{shouldForwardProp:Z2(k,L,!0)}));return R.apply(void 0,g)},k}},LT=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],Pj=$T.bind(null);LT.forEach(function(t){Pj[t]=Pj(t)});function FT(t,s){const a=i5({key:"css",prepend:t});if(s){const l=a.insert;a.insert=(...n)=>(n[1].styles.match(/^@layer\s+[^{]*$/)||(n[1].styles=`@layer mui {${n[1].styles}}`),l(...n))}return a}const sv=new Map;function b5(t){const{injectFirst:s,enableCssLayer:a,children:l}=t,n=d.useMemo(()=>{const r=`${s}-${a}`;if(typeof document=="object"&&sv.has(r))return sv.get(r);const i=FT(s,a);return sv.set(r,i),i},[s,a]);return s||a?e.jsx(CT,{value:n,children:l}):l}function UT(t){return t==null||Object.keys(t).length===0}function j5(t){const{styles:s,defaultTheme:a={}}=t,l=typeof s=="function"?n=>s(UT(n)?a:n):s;return e.jsx(PT,{styles:l})}function VT(t,s){return Pj(t,s)}const _T=(t,s)=>{Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=s(t.__emotion_styles))},e1=[];function y5(t){return e1[0]=t,rp(e1)}const BT=Object.freeze(Object.defineProperty({__proto__:null,GlobalStyles:j5,StyledEngineProvider:b5,ThemeContext:Ru,css:v5,default:VT,internal_processStyles:_T,internal_serializeStyles:y5,keyframes:Yg},Symbol.toStringTag,{value:"Module"}));function vo(t){if(typeof t!="object"||t===null)return!1;const s=Object.getPrototypeOf(t);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function N5(t){if(d.isValidElement(t)||!vo(t))return t;const s={};return Object.keys(t).forEach(a=>{s[a]=N5(t[a])}),s}function ti(t,s,a={clone:!0}){const l=a.clone?st({},t):t;return vo(t)&&vo(s)&&Object.keys(s).forEach(n=>{d.isValidElement(s[n])?l[n]=s[n]:vo(s[n])&&Object.prototype.hasOwnProperty.call(t,n)&&vo(t[n])?l[n]=ti(t[n],s[n],a):a.clone?l[n]=vo(s[n])?N5(s[n]):s[n]:l[n]=s[n]}),l}const GT=Object.freeze(Object.defineProperty({__proto__:null,default:ti,isPlainObject:vo},Symbol.toStringTag,{value:"Module"})),qT=["values","unit","step"],zT=t=>{const s=Object.keys(t).map(a=>({key:a,val:t[a]}))||[];return s.sort((a,l)=>a.val-l.val),s.reduce((a,l)=>st({},a,{[l.key]:l.val}),{})};function w5(t){const{values:s={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:a="px",step:l=5}=t,n=Na(t,qT),r=zT(s),i=Object.keys(r);function o(N){return`@media (min-width:${typeof s[N]=="number"?s[N]:N}${a})`}function c(N){return`@media (max-width:${(typeof s[N]=="number"?s[N]:N)-l/100}${a})`}function x(N,$){const T=i.indexOf($);return`@media (min-width:${typeof s[N]=="number"?s[N]:N}${a}) and (max-width:${(T!==-1&&typeof s[i[T]]=="number"?s[i[T]]:$)-l/100}${a})`}function j(N){return i.indexOf(N)+1<i.length?x(N,i[i.indexOf(N)+1]):o(N)}function g(N){const $=i.indexOf(N);return $===0?o(i[1]):$===i.length-1?c(i[$]):x(N,i[i.indexOf(N)+1]).replace("@media","@media not all and")}return st({keys:i,values:r,up:o,down:c,between:x,only:j,not:g,unit:a},n)}const WT={borderRadius:4};function ax(t,s){return s?ti(t,s,{clone:!1}):t}const wN={xs:0,sm:600,md:900,lg:1200,xl:1536},t1={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${wN[t]}px)`};function Ri(t,s,a){const l=t.theme||{};if(Array.isArray(s)){const r=l.breakpoints||t1;return s.reduce((i,o,c)=>(i[r.up(r.keys[c])]=a(s[c]),i),{})}if(typeof s=="object"){const r=l.breakpoints||t1;return Object.keys(s).reduce((i,o)=>{if(Object.keys(r.values||wN).indexOf(o)!==-1){const c=r.up(o);i[c]=a(s[o],o)}else{const c=o;i[c]=s[c]}return i},{})}return a(s)}function HT(t={}){var s;return((s=t.keys)==null?void 0:s.reduce((l,n)=>{const r=t.up(n);return l[r]={},l},{}))||{}}function s1(t,s){return t.reduce((a,l)=>{const n=a[l];return(!n||Object.keys(n).length===0)&&delete a[l],a},s)}function ws(t){if(typeof t!="string")throw new Error(yu(7));return t.charAt(0).toUpperCase()+t.slice(1)}const XT=Object.freeze(Object.defineProperty({__proto__:null,default:ws},Symbol.toStringTag,{value:"Module"}));function Jg(t,s,a=!0){if(!s||typeof s!="string")return null;if(t&&t.vars&&a){const l=`vars.${s}`.split(".").reduce((n,r)=>n&&n[r]?n[r]:null,t);if(l!=null)return l}return s.split(".").reduce((l,n)=>l&&l[n]!=null?l[n]:null,t)}function K0(t,s,a,l=a){let n;return typeof t=="function"?n=t(a):Array.isArray(t)?n=t[a]||l:n=Jg(t,a)||l,s&&(n=s(n,l,t)),n}function Fa(t){const{prop:s,cssProperty:a=t.prop,themeKey:l,transform:n}=t,r=i=>{if(i[s]==null)return null;const o=i[s],c=i.theme,x=Jg(c,l)||{};return Ri(i,o,g=>{let N=K0(x,n,g);return g===N&&typeof g=="string"&&(N=K0(x,n,`${s}${g==="default"?"":ws(g)}`,g)),a===!1?N:{[a]:N}})};return r.propTypes={},r.filterProps=[s],r}function KT(t){const s={};return a=>(s[a]===void 0&&(s[a]=t(a)),s[a])}const QT={m:"margin",p:"padding"},YT={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},a1={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},JT=KT(t=>{if(t.length>2)if(a1[t])t=a1[t];else return[t];const[s,a]=t.split(""),l=QT[s],n=YT[a]||"";return Array.isArray(n)?n.map(r=>l+r):[l+n]}),kN=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],CN=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...kN,...CN];function ip(t,s,a,l){var n;const r=(n=Jg(t,s,!1))!=null?n:a;return typeof r=="number"?i=>typeof i=="string"?i:r*i:Array.isArray(r)?i=>typeof i=="string"?i:r[i]:typeof r=="function"?r:()=>{}}function k5(t){return ip(t,"spacing",8)}function op(t,s){if(typeof s=="string"||s==null)return s;const a=Math.abs(s),l=t(a);return s>=0?l:typeof l=="number"?-l:`-${l}`}function ZT(t,s){return a=>t.reduce((l,n)=>(l[n]=op(s,a),l),{})}function eR(t,s,a,l){if(s.indexOf(a)===-1)return null;const n=JT(a),r=ZT(n,l),i=t[a];return Ri(t,i,r)}function C5(t,s){const a=k5(t.theme);return Object.keys(t).map(l=>eR(t,s,l,a)).reduce(ax,{})}function ha(t){return C5(t,kN)}ha.propTypes={};ha.filterProps=kN;function ga(t){return C5(t,CN)}ga.propTypes={};ga.filterProps=CN;function tR(t=8){if(t.mui)return t;const s=k5({spacing:t}),a=(...l)=>(l.length===0?[1]:l).map(r=>{const i=s(r);return typeof i=="number"?`${i}px`:i}).join(" ");return a.mui=!0,a}function Zg(...t){const s=t.reduce((l,n)=>(n.filterProps.forEach(r=>{l[r]=n}),l),{}),a=l=>Object.keys(l).reduce((n,r)=>s[r]?ax(n,s[r](l)):n,{});return a.propTypes={},a.filterProps=t.reduce((l,n)=>l.concat(n.filterProps),[]),a}function Jn(t){return typeof t!="number"?t:`${t}px solid`}function lr(t,s){return Fa({prop:t,themeKey:"borders",transform:s})}const sR=lr("border",Jn),aR=lr("borderTop",Jn),lR=lr("borderRight",Jn),nR=lr("borderBottom",Jn),rR=lr("borderLeft",Jn),iR=lr("borderColor"),oR=lr("borderTopColor"),dR=lr("borderRightColor"),cR=lr("borderBottomColor"),uR=lr("borderLeftColor"),mR=lr("outline",Jn),xR=lr("outlineColor"),ef=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const s=ip(t.theme,"shape.borderRadius",4),a=l=>({borderRadius:op(s,l)});return Ri(t,t.borderRadius,a)}return null};ef.propTypes={};ef.filterProps=["borderRadius"];Zg(sR,aR,lR,nR,rR,iR,oR,dR,cR,uR,ef,mR,xR);const tf=t=>{if(t.gap!==void 0&&t.gap!==null){const s=ip(t.theme,"spacing",8),a=l=>({gap:op(s,l)});return Ri(t,t.gap,a)}return null};tf.propTypes={};tf.filterProps=["gap"];const sf=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const s=ip(t.theme,"spacing",8),a=l=>({columnGap:op(s,l)});return Ri(t,t.columnGap,a)}return null};sf.propTypes={};sf.filterProps=["columnGap"];const af=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const s=ip(t.theme,"spacing",8),a=l=>({rowGap:op(s,l)});return Ri(t,t.rowGap,a)}return null};af.propTypes={};af.filterProps=["rowGap"];const pR=Fa({prop:"gridColumn"}),hR=Fa({prop:"gridRow"}),gR=Fa({prop:"gridAutoFlow"}),fR=Fa({prop:"gridAutoColumns"}),vR=Fa({prop:"gridAutoRows"}),bR=Fa({prop:"gridTemplateColumns"}),jR=Fa({prop:"gridTemplateRows"}),yR=Fa({prop:"gridTemplateAreas"}),NR=Fa({prop:"gridArea"});Zg(tf,sf,af,pR,hR,gR,fR,vR,bR,jR,yR,NR);function mu(t,s){return s==="grey"?s:t}const wR=Fa({prop:"color",themeKey:"palette",transform:mu}),kR=Fa({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:mu}),CR=Fa({prop:"backgroundColor",themeKey:"palette",transform:mu});Zg(wR,kR,CR);function Mn(t){return t<=1&&t!==0?`${t*100}%`:t}const SR=Fa({prop:"width",transform:Mn}),SN=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const s=a=>{var l,n;const r=((l=t.theme)==null||(l=l.breakpoints)==null||(l=l.values)==null?void 0:l[a])||wN[a];return r?((n=t.theme)==null||(n=n.breakpoints)==null?void 0:n.unit)!=="px"?{maxWidth:`${r}${t.theme.breakpoints.unit}`}:{maxWidth:r}:{maxWidth:Mn(a)}};return Ri(t,t.maxWidth,s)}return null};SN.filterProps=["maxWidth"];const AR=Fa({prop:"minWidth",transform:Mn}),ER=Fa({prop:"height",transform:Mn}),MR=Fa({prop:"maxHeight",transform:Mn}),PR=Fa({prop:"minHeight",transform:Mn});Fa({prop:"size",cssProperty:"width",transform:Mn});Fa({prop:"size",cssProperty:"height",transform:Mn});const OR=Fa({prop:"boxSizing"});Zg(SR,SN,AR,ER,MR,PR,OR);const dp={border:{themeKey:"borders",transform:Jn},borderTop:{themeKey:"borders",transform:Jn},borderRight:{themeKey:"borders",transform:Jn},borderBottom:{themeKey:"borders",transform:Jn},borderLeft:{themeKey:"borders",transform:Jn},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Jn},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:ef},color:{themeKey:"palette",transform:mu},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:mu},backgroundColor:{themeKey:"palette",transform:mu},p:{style:ga},pt:{style:ga},pr:{style:ga},pb:{style:ga},pl:{style:ga},px:{style:ga},py:{style:ga},padding:{style:ga},paddingTop:{style:ga},paddingRight:{style:ga},paddingBottom:{style:ga},paddingLeft:{style:ga},paddingX:{style:ga},paddingY:{style:ga},paddingInline:{style:ga},paddingInlineStart:{style:ga},paddingInlineEnd:{style:ga},paddingBlock:{style:ga},paddingBlockStart:{style:ga},paddingBlockEnd:{style:ga},m:{style:ha},mt:{style:ha},mr:{style:ha},mb:{style:ha},ml:{style:ha},mx:{style:ha},my:{style:ha},margin:{style:ha},marginTop:{style:ha},marginRight:{style:ha},marginBottom:{style:ha},marginLeft:{style:ha},marginX:{style:ha},marginY:{style:ha},marginInline:{style:ha},marginInlineStart:{style:ha},marginInlineEnd:{style:ha},marginBlock:{style:ha},marginBlockStart:{style:ha},marginBlockEnd:{style:ha},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:tf},rowGap:{style:af},columnGap:{style:sf},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Mn},maxWidth:{style:SN},minWidth:{transform:Mn},height:{transform:Mn},maxHeight:{transform:Mn},minHeight:{transform:Mn},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function TR(...t){const s=t.reduce((l,n)=>l.concat(Object.keys(n)),[]),a=new Set(s);return t.every(l=>a.size===Object.keys(l).length)}function RR(t,s){return typeof t=="function"?t(s):t}function S5(){function t(a,l,n,r){const i={[a]:l,theme:n},o=r[a];if(!o)return{[a]:l};const{cssProperty:c=a,themeKey:x,transform:j,style:g}=o;if(l==null)return null;if(x==="typography"&&l==="inherit")return{[a]:l};const N=Jg(n,x)||{};return g?g(i):Ri(i,l,T=>{let k=K0(N,j,T);return T===k&&typeof T=="string"&&(k=K0(N,j,`${a}${T==="default"?"":ws(T)}`,T)),c===!1?k:{[c]:k}})}function s(a){var l;const{sx:n,theme:r={},nested:i}=a||{};if(!n)return null;const o=(l=r.unstable_sxConfig)!=null?l:dp;function c(x){let j=x;if(typeof x=="function")j=x(r);else if(typeof x!="object")return x;if(!j)return null;const g=HT(r.breakpoints),N=Object.keys(g);let $=g;return Object.keys(j).forEach(T=>{const k=RR(j[T],r);if(k!=null)if(typeof k=="object")if(o[T])$=ax($,t(T,k,r,o));else{const q=Ri({theme:r},k,L=>({[T]:L}));TR(q,k)?$[T]=s({sx:k,theme:r,nested:!0}):$=ax($,q)}else $=ax($,t(T,k,r,o))}),!i&&r.modularCssLayers?{"@layer sx":s1(N,$)}:s1(N,$)}return Array.isArray(n)?n.map(c):c(n)}return s}const lf=S5();lf.filterProps=["sx"];function A5(t,s){const a=this;return a.vars&&typeof a.getColorSchemeSelector=="function"?{[a.getColorSchemeSelector(t).replace(/(\[[^\]]+\])/,"*:where($1)")]:s}:a.palette.mode===t?s:{}}const DR=["breakpoints","palette","spacing","shape"];function AN(t={},...s){const{breakpoints:a={},palette:l={},spacing:n,shape:r={}}=t,i=Na(t,DR),o=w5(a),c=tR(n);let x=ti({breakpoints:o,direction:"ltr",components:{},palette:st({mode:"light"},l),spacing:c,shape:st({},WT,r)},i);return x.applyStyles=A5,x=s.reduce((j,g)=>ti(j,g),x),x.unstable_sxConfig=st({},dp,i==null?void 0:i.unstable_sxConfig),x.unstable_sx=function(g){return lf({sx:g,theme:this})},x}const IR=Object.freeze(Object.defineProperty({__proto__:null,default:AN,private_createBreakpoints:w5,unstable_applyStyles:A5},Symbol.toStringTag,{value:"Module"}));function $R(t){return Object.keys(t).length===0}function EN(t=null){const s=d.useContext(Ru);return!s||$R(s)?t:s}const LR=AN();function FR(t=LR){return EN(t)}function av(t){const s=y5(t);return t!==s&&s.styles?(s.styles.match(/^@layer\s+[^{]*$/)||(s.styles=`@layer global{${s.styles}}`),s):t}function E5({styles:t,themeId:s,defaultTheme:a={}}){const l=FR(a),n=s&&l[s]||l;let r=typeof t=="function"?t(n):t;return n.modularCssLayers&&(Array.isArray(r)?r=r.map(i=>av(typeof i=="function"?i(n):i)):r=av(r)),e.jsx(j5,{styles:r})}const UR=["sx"],VR=t=>{var s,a;const l={systemProps:{},otherProps:{}},n=(s=t==null||(a=t.theme)==null?void 0:a.unstable_sxConfig)!=null?s:dp;return Object.keys(t).forEach(r=>{n[r]?l.systemProps[r]=t[r]:l.otherProps[r]=t[r]}),l};function M5(t){const{sx:s}=t,a=Na(t,UR),{systemProps:l,otherProps:n}=VR(a);let r;return Array.isArray(s)?r=[l,...s]:typeof s=="function"?r=(...i)=>{const o=s(...i);return vo(o)?st({},l,o):l}:r=st({},l,s),st({},n,{sx:r})}const _R=Object.freeze(Object.defineProperty({__proto__:null,default:lf,extendSxProp:M5,unstable_createStyleFunctionSx:S5,unstable_defaultSxConfig:dp},Symbol.toStringTag,{value:"Module"})),l1=t=>t,BR=()=>{let t=l1;return{configure(s){t=s},generate(s){return t(s)},reset(){t=l1}}},GR=BR();function P5(t){var s,a,l="";if(typeof t=="string"||typeof t=="number")l+=t;else if(typeof t=="object")if(Array.isArray(t)){var n=t.length;for(s=0;s<n;s++)t[s]&&(a=P5(t[s]))&&(l&&(l+=" "),l+=a)}else for(a in t)t[a]&&(l&&(l+=" "),l+=a);return l}function Ha(){for(var t,s,a=0,l="",n=arguments.length;a<n;a++)(t=arguments[a])&&(s=P5(t))&&(l&&(l+=" "),l+=s);return l}const qR={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function Vi(t,s,a="Mui"){const l=qR[s];return l?`${a}-${l}`:`${GR.generate(t)}-${s}`}function _i(t,s,a="Mui"){const l={};return s.forEach(n=>{l[n]=Vi(t,n,a)}),l}var O5={exports:{}},Os={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MN=Symbol.for("react.transitional.element"),PN=Symbol.for("react.portal"),nf=Symbol.for("react.fragment"),rf=Symbol.for("react.strict_mode"),of=Symbol.for("react.profiler"),df=Symbol.for("react.consumer"),cf=Symbol.for("react.context"),uf=Symbol.for("react.forward_ref"),mf=Symbol.for("react.suspense"),xf=Symbol.for("react.suspense_list"),pf=Symbol.for("react.memo"),hf=Symbol.for("react.lazy"),zR=Symbol.for("react.view_transition"),WR=Symbol.for("react.client.reference");function nr(t){if(typeof t=="object"&&t!==null){var s=t.$$typeof;switch(s){case MN:switch(t=t.type,t){case nf:case of:case rf:case mf:case xf:case zR:return t;default:switch(t=t&&t.$$typeof,t){case cf:case uf:case hf:case pf:return t;case df:return t;default:return s}}case PN:return s}}}Os.ContextConsumer=df;Os.ContextProvider=cf;Os.Element=MN;Os.ForwardRef=uf;Os.Fragment=nf;Os.Lazy=hf;Os.Memo=pf;Os.Portal=PN;Os.Profiler=of;Os.StrictMode=rf;Os.Suspense=mf;Os.SuspenseList=xf;Os.isContextConsumer=function(t){return nr(t)===df};Os.isContextProvider=function(t){return nr(t)===cf};Os.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===MN};Os.isForwardRef=function(t){return nr(t)===uf};Os.isFragment=function(t){return nr(t)===nf};Os.isLazy=function(t){return nr(t)===hf};Os.isMemo=function(t){return nr(t)===pf};Os.isPortal=function(t){return nr(t)===PN};Os.isProfiler=function(t){return nr(t)===of};Os.isStrictMode=function(t){return nr(t)===rf};Os.isSuspense=function(t){return nr(t)===mf};Os.isSuspenseList=function(t){return nr(t)===xf};Os.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===nf||t===of||t===rf||t===mf||t===xf||typeof t=="object"&&t!==null&&(t.$$typeof===hf||t.$$typeof===pf||t.$$typeof===cf||t.$$typeof===df||t.$$typeof===uf||t.$$typeof===WR||t.getModuleId!==void 0)};Os.typeOf=nr;O5.exports=Os;var n1=O5.exports;const HR=/^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^(\s/]*)\s*/;function T5(t){const s=`${t}`.match(HR);return s&&s[1]||""}function R5(t,s=""){return t.displayName||t.name||T5(t)||s}function r1(t,s,a){const l=R5(s);return t.displayName||(l!==""?`${a}(${l})`:a)}function XR(t){if(t!=null){if(typeof t=="string")return t;if(typeof t=="function")return R5(t,"Component");if(typeof t=="object")switch(t.$$typeof){case n1.ForwardRef:return r1(t,t.render,"ForwardRef");case n1.Memo:return r1(t,t.type,"memo");default:return}}}const KR=Object.freeze(Object.defineProperty({__proto__:null,default:XR,getFunctionName:T5},Symbol.toStringTag,{value:"Module"}));function Q0(t,s){const a=st({},s);return Object.keys(t).forEach(l=>{if(l.toString().match(/^(components|slots)$/))a[l]=st({},t[l],a[l]);else if(l.toString().match(/^(componentsProps|slotProps)$/)){const n=t[l]||{},r=s[l];a[l]={},!r||!Object.keys(r)?a[l]=n:!n||!Object.keys(n)?a[l]=r:(a[l]=st({},r),Object.keys(n).forEach(i=>{a[l][i]=Q0(n[i],r[i])}))}else a[l]===void 0&&(a[l]=t[l])}),a}const D5=typeof window<"u"?d.useLayoutEffect:d.useEffect;function QR(t,s=Number.MIN_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER){return Math.max(s,Math.min(t,a))}const YR=Object.freeze(Object.defineProperty({__proto__:null,default:QR},Symbol.toStringTag,{value:"Module"}));function JR(t,s){typeof t=="function"?t(s):t&&(t.current=s)}let i1=0;function ZR(t){const[s,a]=d.useState(t),l=t||s;return d.useEffect(()=>{s==null&&(i1+=1,a(`mui-${i1}`))},[s]),l}const o1=y0.useId;function eD(t){return o1!==void 0?o1():ZR(t)}function Ip(t){const s=d.useRef(t);return D5(()=>{s.current=t}),d.useRef((...a)=>(0,s.current)(...a)).current}function Oj(...t){return d.useMemo(()=>t.every(s=>s==null)?null:s=>{t.forEach(a=>{JR(a,s)})},t)}const d1={};function tD(t,s){const a=d.useRef(d1);return a.current===d1&&(a.current=t(s)),a}const sD=[];function aD(t){d.useEffect(t,sD)}class gf{constructor(){this.currentId=null,this.clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new gf}start(s,a){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,a()},s)}}function lD(){const t=tD(gf.create).current;return aD(t.disposeEffect),t}let ff=!0,Tj=!1;const nD=new gf,rD={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function iD(t){const{type:s,tagName:a}=t;return!!(a==="INPUT"&&rD[s]&&!t.readOnly||a==="TEXTAREA"&&!t.readOnly||t.isContentEditable)}function oD(t){t.metaKey||t.altKey||t.ctrlKey||(ff=!0)}function lv(){ff=!1}function dD(){this.visibilityState==="hidden"&&Tj&&(ff=!0)}function cD(t){t.addEventListener("keydown",oD,!0),t.addEventListener("mousedown",lv,!0),t.addEventListener("pointerdown",lv,!0),t.addEventListener("touchstart",lv,!0),t.addEventListener("visibilitychange",dD,!0)}function uD(t){const{target:s}=t;try{return s.matches(":focus-visible")}catch{}return ff||iD(s)}function mD(){const t=d.useCallback(n=>{n!=null&&cD(n.ownerDocument)},[]),s=d.useRef(!1);function a(){return s.current?(Tj=!0,nD.start(100,()=>{Tj=!1}),s.current=!1,!0):!1}function l(n){return uD(n)?(s.current=!0,!0):!1}return{isFocusVisibleRef:s,onFocus:l,onBlur:a,ref:t}}function Ho(t,s,a=void 0){const l={};return Object.keys(t).forEach(n=>{l[n]=t[n].reduce((r,i)=>{if(i){const o=s(i);o!==""&&r.push(o),a&&a[i]&&r.push(a[i])}return r},[]).join(" ")}),l}function xD(t){return typeof t=="string"}function pD(t,s,a){return t===void 0||xD(t)?s:st({},s,{ownerState:st({},s.ownerState,a)})}function hD(t,s=[]){if(t===void 0)return{};const a={};return Object.keys(t).filter(l=>l.match(/^on[A-Z]/)&&typeof t[l]=="function"&&!s.includes(l)).forEach(l=>{a[l]=t[l]}),a}function c1(t){if(t===void 0)return{};const s={};return Object.keys(t).filter(a=>!(a.match(/^on[A-Z]/)&&typeof t[a]=="function")).forEach(a=>{s[a]=t[a]}),s}function gD(t){const{getSlotProps:s,additionalProps:a,externalSlotProps:l,externalForwardedProps:n,className:r}=t;if(!s){const $=Ha(a==null?void 0:a.className,r,n==null?void 0:n.className,l==null?void 0:l.className),T=st({},a==null?void 0:a.style,n==null?void 0:n.style,l==null?void 0:l.style),k=st({},a,n,l);return $.length>0&&(k.className=$),Object.keys(T).length>0&&(k.style=T),{props:k,internalRef:void 0}}const i=hD(st({},n,l)),o=c1(l),c=c1(n),x=s(i),j=Ha(x==null?void 0:x.className,a==null?void 0:a.className,r,n==null?void 0:n.className,l==null?void 0:l.className),g=st({},x==null?void 0:x.style,a==null?void 0:a.style,n==null?void 0:n.style,l==null?void 0:l.style),N=st({},x,a,c,o);return j.length>0&&(N.className=j),Object.keys(g).length>0&&(N.style=g),{props:N,internalRef:x.ref}}function fD(t,s,a){return typeof t=="function"?t(s,a):t}const I5=d.createContext(null);function $5(){return d.useContext(I5)}const vD=typeof Symbol=="function"&&Symbol.for,bD=vD?Symbol.for("mui.nested"):"__THEME_NESTED__";function jD(t,s){return typeof s=="function"?s(t):st({},t,s)}function yD(t){const{children:s,theme:a}=t,l=$5(),n=d.useMemo(()=>{const r=l===null?a:jD(l,a);return r!=null&&(r[bD]=l!==null),r},[a,l]);return e.jsx(I5.Provider,{value:n,children:s})}const ND=["value"],wD=d.createContext();function kD(t){let{value:s}=t,a=Na(t,ND);return e.jsx(wD.Provider,st({value:s??!0},a))}const L5=d.createContext(void 0);function CD({value:t,children:s}){return e.jsx(L5.Provider,{value:t,children:s})}function SD(t){const{theme:s,name:a,props:l}=t;if(!s||!s.components||!s.components[a])return l;const n=s.components[a];return n.defaultProps?Q0(n.defaultProps,l):!n.styleOverrides&&!n.variants?Q0(n,l):l}function AD({props:t,name:s}){const a=d.useContext(L5);return SD({props:t,name:s,theme:{components:a}})}function ED(t){const s=EN(),a=eD()||"",{modularCssLayers:l}=t;let n="mui.global, mui.components, mui.theme, mui.custom, mui.sx";return!l||s!==null?n="":typeof l=="string"?n=l.replace(/mui(?!\.)/g,n):n=`@layer ${n};`,D5(()=>{const r=document.querySelector("head");if(!r)return;const i=r.firstChild;if(n){var o;if(i&&(o=i.hasAttribute)!=null&&o.call(i,"data-mui-layer-order")&&i.getAttribute("data-mui-layer-order")===a)return;const x=document.createElement("style");x.setAttribute("data-mui-layer-order",a),x.textContent=n,r.prepend(x)}else{var c;(c=r.querySelector(`style[data-mui-layer-order="${a}"]`))==null||c.remove()}},[n,a]),n?e.jsx(E5,{styles:n}):null}const u1={};function m1(t,s,a,l=!1){return d.useMemo(()=>{const n=t&&s[t]||s;if(typeof a=="function"){const r=a(n),i=t?st({},s,{[t]:r}):r;return l?()=>i:i}return t?st({},s,{[t]:a}):st({},s,a)},[t,s,a,l])}function MD(t){const{children:s,theme:a,themeId:l}=t,n=EN(u1),r=$5()||u1,i=m1(l,n,a),o=m1(l,r,a,!0),c=i.direction==="rtl",x=ED(i);return e.jsx(yD,{theme:o,children:e.jsx(Ru.Provider,{value:i,children:e.jsx(kD,{value:c,children:e.jsxs(CD,{value:i==null?void 0:i.components,children:[x,s]})})})})}function PD(t,s){return st({toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}}},s)}var Ua={},F5={exports:{}};(function(t){function s(a){return a&&a.__esModule?a:{default:a}}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports})(F5);var U5=F5.exports;const OD=Bo(IO),TD=Bo(YR);var V5=U5;Object.defineProperty(Ua,"__esModule",{value:!0});var wo=Ua.alpha=q5;Ua.blend=GD;Ua.colorChannel=void 0;var Rj=Ua.darken=TN;Ua.decomposeColor=ar;Ua.emphasize=z5;var RD=Ua.getContrastRatio=FD;Ua.getLuminance=Y0;Ua.hexToRgb=_5;Ua.hslToRgb=G5;var Dj=Ua.lighten=RN;Ua.private_safeAlpha=UD;Ua.private_safeColorChannel=void 0;Ua.private_safeDarken=VD;Ua.private_safeEmphasize=BD;Ua.private_safeLighten=_D;Ua.recomposeColor=Du;Ua.rgbToHex=LD;var x1=V5(OD),DD=V5(TD);function ON(t,s=0,a=1){return(0,DD.default)(t,s,a)}function _5(t){t=t.slice(1);const s=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let a=t.match(s);return a&&a[0].length===1&&(a=a.map(l=>l+l)),a?`rgb${a.length===4?"a":""}(${a.map((l,n)=>n<3?parseInt(l,16):Math.round(parseInt(l,16)/255*1e3)/1e3).join(", ")})`:""}function ID(t){const s=t.toString(16);return s.length===1?`0${s}`:s}function ar(t){if(t.type)return t;if(t.charAt(0)==="#")return ar(_5(t));const s=t.indexOf("("),a=t.substring(0,s);if(["rgb","rgba","hsl","hsla","color"].indexOf(a)===-1)throw new Error((0,x1.default)(9,t));let l=t.substring(s+1,t.length-1),n;if(a==="color"){if(l=l.split(" "),n=l.shift(),l.length===4&&l[3].charAt(0)==="/"&&(l[3]=l[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(n)===-1)throw new Error((0,x1.default)(10,n))}else l=l.split(",");return l=l.map(r=>parseFloat(r)),{type:a,values:l,colorSpace:n}}const B5=t=>{const s=ar(t);return s.values.slice(0,3).map((a,l)=>s.type.indexOf("hsl")!==-1&&l!==0?`${a}%`:a).join(" ")};Ua.colorChannel=B5;const $D=(t,s)=>{try{return B5(t)}catch{return t}};Ua.private_safeColorChannel=$D;function Du(t){const{type:s,colorSpace:a}=t;let{values:l}=t;return s.indexOf("rgb")!==-1?l=l.map((n,r)=>r<3?parseInt(n,10):n):s.indexOf("hsl")!==-1&&(l[1]=`${l[1]}%`,l[2]=`${l[2]}%`),s.indexOf("color")!==-1?l=`${a} ${l.join(" ")}`:l=`${l.join(", ")}`,`${s}(${l})`}function LD(t){if(t.indexOf("#")===0)return t;const{values:s}=ar(t);return`#${s.map((a,l)=>ID(l===3?Math.round(255*a):a)).join("")}`}function G5(t){t=ar(t);const{values:s}=t,a=s[0],l=s[1]/100,n=s[2]/100,r=l*Math.min(n,1-n),i=(x,j=(x+a/30)%12)=>n-r*Math.max(Math.min(j-3,9-j,1),-1);let o="rgb";const c=[Math.round(i(0)*255),Math.round(i(8)*255),Math.round(i(4)*255)];return t.type==="hsla"&&(o+="a",c.push(s[3])),Du({type:o,values:c})}function Y0(t){t=ar(t);let s=t.type==="hsl"||t.type==="hsla"?ar(G5(t)).values:t.values;return s=s.map(a=>(t.type!=="color"&&(a/=255),a<=.03928?a/12.92:((a+.055)/1.055)**2.4)),Number((.2126*s[0]+.7152*s[1]+.0722*s[2]).toFixed(3))}function FD(t,s){const a=Y0(t),l=Y0(s);return(Math.max(a,l)+.05)/(Math.min(a,l)+.05)}function q5(t,s){return t=ar(t),s=ON(s),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${s}`:t.values[3]=s,Du(t)}function UD(t,s,a){try{return q5(t,s)}catch{return t}}function TN(t,s){if(t=ar(t),s=ON(s),t.type.indexOf("hsl")!==-1)t.values[2]*=1-s;else if(t.type.indexOf("rgb")!==-1||t.type.indexOf("color")!==-1)for(let a=0;a<3;a+=1)t.values[a]*=1-s;return Du(t)}function VD(t,s,a){try{return TN(t,s)}catch{return t}}function RN(t,s){if(t=ar(t),s=ON(s),t.type.indexOf("hsl")!==-1)t.values[2]+=(100-t.values[2])*s;else if(t.type.indexOf("rgb")!==-1)for(let a=0;a<3;a+=1)t.values[a]+=(255-t.values[a])*s;else if(t.type.indexOf("color")!==-1)for(let a=0;a<3;a+=1)t.values[a]+=(1-t.values[a])*s;return Du(t)}function _D(t,s,a){try{return RN(t,s)}catch{return t}}function z5(t,s=.15){return Y0(t)>.5?TN(t,s):RN(t,s)}function BD(t,s,a){try{return z5(t,s)}catch{return t}}function GD(t,s,a,l=1){const n=(c,x)=>Math.round((c**(1/l)*(1-a)+x**(1/l)*a)**l),r=ar(t),i=ar(s),o=[n(r.values[0],i.values[0]),n(r.values[1],i.values[1]),n(r.values[2],i.values[2])];return Du({type:"rgb",values:o})}const qD=["mode","contrastThreshold","tonalOffset"],p1={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Fx.white,default:Fx.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},nv={text:{primary:Fx.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Fx.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function h1(t,s,a,l){const n=l.light||l,r=l.dark||l*1.5;t[s]||(t.hasOwnProperty(a)?t[s]=t[a]:s==="light"?t.light=Dj(t.main,n):s==="dark"&&(t.dark=Rj(t.main,r)))}function zD(t="light"){return t==="dark"?{main:ec[200],light:ec[50],dark:ec[400]}:{main:ec[700],light:ec[400],dark:ec[800]}}function WD(t="light"){return t==="dark"?{main:Zd[200],light:Zd[50],dark:Zd[400]}:{main:Zd[500],light:Zd[300],dark:Zd[700]}}function HD(t="light"){return t==="dark"?{main:Jd[500],light:Jd[300],dark:Jd[700]}:{main:Jd[700],light:Jd[400],dark:Jd[800]}}function XD(t="light"){return t==="dark"?{main:tc[400],light:tc[300],dark:tc[700]}:{main:tc[700],light:tc[500],dark:tc[900]}}function KD(t="light"){return t==="dark"?{main:sc[400],light:sc[300],dark:sc[700]}:{main:sc[800],light:sc[500],dark:sc[900]}}function QD(t="light"){return t==="dark"?{main:Yu[400],light:Yu[300],dark:Yu[700]}:{main:"#ed6c02",light:Yu[500],dark:Yu[900]}}function YD(t){const{mode:s="light",contrastThreshold:a=3,tonalOffset:l=.2}=t,n=Na(t,qD),r=t.primary||zD(s),i=t.secondary||WD(s),o=t.error||HD(s),c=t.info||XD(s),x=t.success||KD(s),j=t.warning||QD(s);function g(k){return RD(k,nv.text.primary)>=a?nv.text.primary:p1.text.primary}const N=({color:k,name:q,mainShade:L=500,lightShade:R=300,darkShade:U=700})=>{if(k=st({},k),!k.main&&k[L]&&(k.main=k[L]),!k.hasOwnProperty("main"))throw new Error(yu(11,q?` (${q})`:"",L));if(typeof k.main!="string")throw new Error(yu(12,q?` (${q})`:"",JSON.stringify(k.main)));return h1(k,"light",R,l),h1(k,"dark",U,l),k.contrastText||(k.contrastText=g(k.main)),k},$={dark:nv,light:p1};return ti(st({common:st({},Fx),mode:s,primary:N({color:r,name:"primary"}),secondary:N({color:i,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:N({color:o,name:"error"}),warning:N({color:j,name:"warning"}),info:N({color:c,name:"info"}),success:N({color:x,name:"success"}),grey:DO,contrastThreshold:a,getContrastText:g,augmentColor:N,tonalOffset:l},$[s]),n)}const JD=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function ZD(t){return Math.round(t*1e5)/1e5}const g1={textTransform:"uppercase"},f1='"Roboto", "Helvetica", "Arial", sans-serif';function eI(t,s){const a=typeof s=="function"?s(t):s,{fontFamily:l=f1,fontSize:n=14,fontWeightLight:r=300,fontWeightRegular:i=400,fontWeightMedium:o=500,fontWeightBold:c=700,htmlFontSize:x=16,allVariants:j,pxToRem:g}=a,N=Na(a,JD),$=n/14,T=g||(L=>`${L/x*$}rem`),k=(L,R,U,ae,ie)=>st({fontFamily:l,fontWeight:L,fontSize:T(R),lineHeight:U},l===f1?{letterSpacing:`${ZD(ae/R)}em`}:{},ie,j),q={h1:k(r,96,1.167,-1.5),h2:k(r,60,1.2,-.5),h3:k(i,48,1.167,0),h4:k(i,34,1.235,.25),h5:k(i,24,1.334,0),h6:k(o,20,1.6,.15),subtitle1:k(i,16,1.75,.15),subtitle2:k(o,14,1.57,.1),body1:k(i,16,1.5,.15),body2:k(i,14,1.43,.15),button:k(o,14,1.75,.4,g1),caption:k(i,12,1.66,.4),overline:k(i,12,2.66,1,g1),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return ti(st({htmlFontSize:x,pxToRem:T,fontFamily:l,fontSize:n,fontWeightLight:r,fontWeightRegular:i,fontWeightMedium:o,fontWeightBold:c},q),N,{clone:!1})}const tI=.2,sI=.14,aI=.12;function Ys(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${tI})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${sI})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${aI})`].join(",")}const lI=["none",Ys(0,2,1,-1,0,1,1,0,0,1,3,0),Ys(0,3,1,-2,0,2,2,0,0,1,5,0),Ys(0,3,3,-2,0,3,4,0,0,1,8,0),Ys(0,2,4,-1,0,4,5,0,0,1,10,0),Ys(0,3,5,-1,0,5,8,0,0,1,14,0),Ys(0,3,5,-1,0,6,10,0,0,1,18,0),Ys(0,4,5,-2,0,7,10,1,0,2,16,1),Ys(0,5,5,-3,0,8,10,1,0,3,14,2),Ys(0,5,6,-3,0,9,12,1,0,3,16,2),Ys(0,6,6,-3,0,10,14,1,0,4,18,3),Ys(0,6,7,-4,0,11,15,1,0,4,20,3),Ys(0,7,8,-4,0,12,17,2,0,5,22,4),Ys(0,7,8,-4,0,13,19,2,0,5,24,4),Ys(0,7,9,-4,0,14,21,2,0,5,26,4),Ys(0,8,9,-5,0,15,22,2,0,6,28,5),Ys(0,8,10,-5,0,16,24,2,0,6,30,5),Ys(0,8,11,-5,0,17,26,2,0,6,32,5),Ys(0,9,11,-5,0,18,28,2,0,7,34,6),Ys(0,9,12,-6,0,19,29,2,0,7,36,6),Ys(0,10,13,-6,0,20,31,3,0,8,38,7),Ys(0,10,13,-6,0,21,33,3,0,8,40,7),Ys(0,10,14,-6,0,22,35,3,0,8,42,7),Ys(0,11,14,-7,0,23,36,3,0,9,44,8),Ys(0,11,15,-7,0,24,38,3,0,9,46,8)],nI=["duration","easing","delay"],rI={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},iI={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function v1(t){return`${Math.round(t)}ms`}function oI(t){if(!t)return 0;const s=t/36;return Math.round((4+15*s**.25+s/5)*10)}function dI(t){const s=st({},rI,t.easing),a=st({},iI,t.duration);return st({getAutoHeightDuration:oI,create:(n=["all"],r={})=>{const{duration:i=a.standard,easing:o=s.easeInOut,delay:c=0}=r;return Na(r,nI),(Array.isArray(n)?n:[n]).map(x=>`${x} ${typeof i=="string"?i:v1(i)} ${o} ${typeof c=="string"?c:v1(c)}`).join(",")}},t,{easing:s,duration:a})}const cI={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},uI=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function W5(t={},...s){const{mixins:a={},palette:l={},transitions:n={},typography:r={}}=t,i=Na(t,uI);if(t.vars&&t.generateCssVars===void 0)throw new Error(yu(18));const o=YD(l),c=AN(t);let x=ti(c,{mixins:PD(c.breakpoints,a),palette:o,shadows:lI.slice(),typography:eI(o,r),transitions:dI(n),zIndex:st({},cI)});return x=ti(x,i),x=s.reduce((j,g)=>ti(j,g),x),x.unstable_sxConfig=st({},dp,i==null?void 0:i.unstable_sxConfig),x.unstable_sx=function(g){return lf({sx:g,theme:this})},x}function b1(t){return String(parseFloat(t)).length===String(t).length}function mI(t){return String(t).match(/[\d.\-+]*\s*(.*)/)[1]||""}function Yo(t){return parseFloat(t)}function xI(t){return(s,a)=>{const l=mI(s);if(l===a)return s;let n=Yo(s);l!=="px"&&(l==="em"||l==="rem")&&(n=Yo(s)*Yo(t));let r=n;if(a!=="px")if(a==="em")r=n/Yo(t);else if(a==="rem")r=n/Yo(t);else return s;return parseFloat(r.toFixed(5))+a}}function pI({size:t,grid:s}){const a=t-t%s,l=a+s;return t-a<l-t?a:l}function hI({lineHeight:t,pixels:s,htmlFontSize:a}){return s/(t*a)}function gI({cssProperty:t,min:s,max:a,unit:l="rem",breakpoints:n=[600,900,1200],transform:r=null}){const i={[t]:`${s}${l}`},o=(a-s)/n[n.length-1];return n.forEach(c=>{let x=s+o*c;r!==null&&(x=r(x)),i[`@media (min-width:${c}px)`]={[t]:`${Math.round(x*1e4)/1e4}${l}`}}),i}function fI(t,s={}){const{breakpoints:a=["sm","md","lg"],disableAlign:l=!1,factor:n=2,variants:r=["h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","caption","button","overline"]}=s,i=st({},t);i.typography=st({},i.typography);const o=i.typography,c=xI(o.htmlFontSize),x=a.map(j=>i.breakpoints.values[j]);return r.forEach(j=>{const g=o[j];if(!g)return;const N=parseFloat(c(g.fontSize,"rem"));if(N<=1)return;const $=N,T=1+($-1)/n;let{lineHeight:k}=g;if(!b1(k)&&!l)throw new Error(yu(6));b1(k)||(k=parseFloat(c(k,"rem"))/parseFloat(N));let q=null;l||(q=L=>pI({size:L,grid:hI({pixels:4,lineHeight:k,htmlFontSize:o.htmlFontSize})})),o[j]=st({},g,gI({cssProperty:"fontSize",min:T,max:$,unit:"rem",breakpoints:x,transform:q}))}),i}const H5=W5();var cp={},rv={exports:{}},j1;function vI(){return j1||(j1=1,function(t){function s(a,l){if(a==null)return{};var n={};for(var r in a)if({}.hasOwnProperty.call(a,r)){if(l.indexOf(r)!==-1)continue;n[r]=a[r]}return n}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports}(rv)),rv.exports}const bI=Bo(BT),jI=Bo(GT),yI=Bo(XT),NI=Bo(KR),wI=Bo(IR),kI=Bo(_R);var Iu=U5;Object.defineProperty(cp,"__esModule",{value:!0});var CI=cp.default=FI;cp.shouldForwardProp=u0;cp.systemDefaultTheme=void 0;var Xn=Iu(f5()),Ij=Iu(vI()),J0=TI(bI),SI=jI;Iu(yI);Iu(NI);var AI=Iu(wI),EI=Iu(kI);const MI=["ownerState"],PI=["variants"],OI=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function X5(t){if(typeof WeakMap!="function")return null;var s=new WeakMap,a=new WeakMap;return(X5=function(l){return l?a:s})(t)}function TI(t,s){if(t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var a=X5(s);if(a&&a.has(t))return a.get(t);var l={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)){var i=n?Object.getOwnPropertyDescriptor(t,r):null;i&&(i.get||i.set)?Object.defineProperty(l,r,i):l[r]=t[r]}return l.default=t,a&&a.set(t,l),l}function RI(t){return Object.keys(t).length===0}function DI(t){return typeof t=="string"&&t.charCodeAt(0)>96}function u0(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}function y1(t,s){return s&&t&&typeof t=="object"&&t.styles&&!t.styles.startsWith("@layer")&&(t.styles=`@layer ${s}{${String(t.styles)}}`),t}const II=cp.systemDefaultTheme=(0,AI.default)(),$I=t=>t&&t.charAt(0).toLowerCase()+t.slice(1);function $p({defaultTheme:t,theme:s,themeId:a}){return RI(s)?t:s[a]||s}function LI(t){return t?(s,a)=>a[t]:null}function m0(t,s,a){let{ownerState:l}=s,n=(0,Ij.default)(s,MI);const r=typeof t=="function"?t((0,Xn.default)({ownerState:l},n)):t;if(Array.isArray(r))return r.flatMap(i=>m0(i,(0,Xn.default)({ownerState:l},n),a));if(r&&typeof r=="object"&&Array.isArray(r.variants)){const{variants:i=[]}=r;let c=(0,Ij.default)(r,PI);return i.forEach(x=>{let j=!0;if(typeof x.props=="function"?j=x.props((0,Xn.default)({ownerState:l},n,l)):Object.keys(x.props).forEach(g=>{(l==null?void 0:l[g])!==x.props[g]&&n[g]!==x.props[g]&&(j=!1)}),j){Array.isArray(c)||(c=[c]);const g=typeof x.style=="function"?x.style((0,Xn.default)({ownerState:l},n,l)):x.style;c.push(a?y1((0,J0.internal_serializeStyles)(g),a):g)}}),c}return a?y1((0,J0.internal_serializeStyles)(r),a):r}function FI(t={}){const{themeId:s,defaultTheme:a=II,rootShouldForwardProp:l=u0,slotShouldForwardProp:n=u0}=t,r=i=>(0,EI.default)((0,Xn.default)({},i,{theme:$p((0,Xn.default)({},i,{defaultTheme:a,themeId:s}))}));return r.__mui_systemSx=!0,(i,o={})=>{(0,J0.internal_processStyles)(i,_=>_.filter(W=>!(W!=null&&W.__mui_systemSx)));const{name:c,slot:x,skipVariantsResolver:j,skipSx:g,overridesResolver:N=LI($I(x))}=o,$=(0,Ij.default)(o,OI),T=c&&c.startsWith("Mui")||x?"components":"custom",k=j!==void 0?j:x&&x!=="Root"&&x!=="root"||!1,q=g||!1;let L,R=u0;x==="Root"||x==="root"?R=l:x?R=n:DI(i)&&(R=void 0);const U=(0,J0.default)(i,(0,Xn.default)({shouldForwardProp:R,label:L},$)),ae=_=>typeof _=="function"&&_.__emotion_real!==_||(0,SI.isPlainObject)(_)?W=>{const J=$p({theme:W.theme,defaultTheme:a,themeId:s});return m0(_,(0,Xn.default)({},W,{theme:J}),J.modularCssLayers?T:void 0)}:_,ie=(_,...W)=>{let J=ae(_);const we=W?W.map(ae):[];c&&N&&we.push(Ge=>{const Me=$p((0,Xn.default)({},Ge,{defaultTheme:a,themeId:s}));if(!Me.components||!Me.components[c]||!Me.components[c].styleOverrides)return null;const je=Me.components[c].styleOverrides,Ue={};return Object.entries(je).forEach(([Oe,he])=>{Ue[Oe]=m0(he,(0,Xn.default)({},Ge,{theme:Me}),Me.modularCssLayers?"theme":void 0)}),N(Ge,Ue)}),c&&!k&&we.push(Ge=>{var Me;const je=$p((0,Xn.default)({},Ge,{defaultTheme:a,themeId:s})),Ue=je==null||(Me=je.components)==null||(Me=Me[c])==null?void 0:Me.variants;return m0({variants:Ue},(0,Xn.default)({},Ge,{theme:je}),je.modularCssLayers?"theme":void 0)}),q||we.push(r);const G=we.length-W.length;if(Array.isArray(_)&&G>0){const Ge=new Array(G).fill("");J=[..._,...Ge],J.raw=[..._.raw,...Ge]}const be=U(J,...we);return i.muiName&&(be.muiName=i.muiName),be};return U.withConfig&&(ie.withConfig=U.withConfig),ie}}function UI(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const K5=t=>UI(t)&&t!=="classes",an=CI({themeId:H0,defaultTheme:H5,rootShouldForwardProp:K5}),VI=["theme"];function _I(t){let{theme:s}=t,a=Na(t,VI);const l=s[H0];let n=l||s;return typeof s!="function"&&(l&&!l.vars?n=st({},l,{vars:null}):s&&!s.vars&&(n=st({},s,{vars:null}))),e.jsx(MD,st({},a,{themeId:l?H0:void 0,theme:n}))}const N1=t=>{let s;return t<1?s=5.11916*t**2:s=4.5*Math.log(t+1)+2,(s/100).toFixed(2)};function oi(t){return AD(t)}function BI(t){return Vi("MuiSvgIcon",t)}_i("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const GI=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],qI=t=>{const{color:s,fontSize:a,classes:l}=t,n={root:["root",s!=="inherit"&&`color${ws(s)}`,`fontSize${ws(a)}`]};return Ho(n,BI,l)},zI=an("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:a}=t;return[s.root,a.color!=="inherit"&&s[`color${ws(a.color)}`],s[`fontSize${ws(a.fontSize)}`]]}})(({theme:t,ownerState:s})=>{var a,l,n,r,i,o,c,x,j,g,N,$,T;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:s.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(a=t.transitions)==null||(l=a.create)==null?void 0:l.call(a,"fill",{duration:(n=t.transitions)==null||(n=n.duration)==null?void 0:n.shorter}),fontSize:{inherit:"inherit",small:((r=t.typography)==null||(i=r.pxToRem)==null?void 0:i.call(r,20))||"1.25rem",medium:((o=t.typography)==null||(c=o.pxToRem)==null?void 0:c.call(o,24))||"1.5rem",large:((x=t.typography)==null||(j=x.pxToRem)==null?void 0:j.call(x,35))||"2.1875rem"}[s.fontSize],color:(g=(N=(t.vars||t).palette)==null||(N=N[s.color])==null?void 0:N.main)!=null?g:{action:($=(t.vars||t).palette)==null||($=$.action)==null?void 0:$.active,disabled:(T=(t.vars||t).palette)==null||(T=T.action)==null?void 0:T.disabled,inherit:void 0}[s.color]}}),$j=d.forwardRef(function(s,a){const l=oi({props:s,name:"MuiSvgIcon"}),{children:n,className:r,color:i="inherit",component:o="svg",fontSize:c="medium",htmlColor:x,inheritViewBox:j=!1,titleAccess:g,viewBox:N="0 0 24 24"}=l,$=Na(l,GI),T=d.isValidElement(n)&&n.type==="svg",k=st({},l,{color:i,component:o,fontSize:c,instanceFontSize:s.fontSize,inheritViewBox:j,viewBox:N,hasSvgAsChild:T}),q={};j||(q.viewBox=N);const L=qI(k);return e.jsxs(zI,st({as:o,className:Ha(L.root,r),focusable:"false",color:x,"aria-hidden":g?void 0:!0,role:g?"img":void 0,ref:a},q,$,T&&n.props,{ownerState:k,children:[T?n.props.children:n,g?e.jsx("title",{children:g}):null]}))});$j.muiName="SvgIcon";function up(t,s){function a(l,n){return e.jsx($j,st({"data-testid":`${s}Icon`,ref:n},l,{children:t}))}return a.muiName=$j.muiName,d.memo(d.forwardRef(a))}function Lj(t,s){return Lj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,l){return a.__proto__=l,a},Lj(t,s)}function WI(t,s){t.prototype=Object.create(s.prototype),t.prototype.constructor=t,Lj(t,s)}const w1=Xt.createContext(null);function HI(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function DN(t,s){var a=function(r){return s&&d.isValidElement(r)?s(r):r},l=Object.create(null);return t&&d.Children.map(t,function(n){return n}).forEach(function(n){l[n.key]=a(n)}),l}function XI(t,s){t=t||{},s=s||{};function a(j){return j in s?s[j]:t[j]}var l=Object.create(null),n=[];for(var r in t)r in s?n.length&&(l[r]=n,n=[]):n.push(r);var i,o={};for(var c in s){if(l[c])for(i=0;i<l[c].length;i++){var x=l[c][i];o[l[c][i]]=a(x)}o[c]=a(c)}for(i=0;i<n.length;i++)o[n[i]]=a(n[i]);return o}function Pd(t,s,a){return a[s]!=null?a[s]:t.props[s]}function KI(t,s){return DN(t.children,function(a){return d.cloneElement(a,{onExited:s.bind(null,a),in:!0,appear:Pd(a,"appear",t),enter:Pd(a,"enter",t),exit:Pd(a,"exit",t)})})}function QI(t,s,a){var l=DN(t.children),n=XI(s,l);return Object.keys(n).forEach(function(r){var i=n[r];if(d.isValidElement(i)){var o=r in s,c=r in l,x=s[r],j=d.isValidElement(x)&&!x.props.in;c&&(!o||j)?n[r]=d.cloneElement(i,{onExited:a.bind(null,i),in:!0,exit:Pd(i,"exit",t),enter:Pd(i,"enter",t)}):!c&&o&&!j?n[r]=d.cloneElement(i,{in:!1}):c&&o&&d.isValidElement(x)&&(n[r]=d.cloneElement(i,{onExited:a.bind(null,i),in:x.props.in,exit:Pd(i,"exit",t),enter:Pd(i,"enter",t)}))}}),n}var YI=Object.values||function(t){return Object.keys(t).map(function(s){return t[s]})},JI={component:"div",childFactory:function(s){return s}},IN=function(t){WI(s,t);function s(l,n){var r;r=t.call(this,l,n)||this;var i=r.handleExited.bind(HI(r));return r.state={contextValue:{isMounting:!0},handleExited:i,firstRender:!0},r}var a=s.prototype;return a.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},a.componentWillUnmount=function(){this.mounted=!1},s.getDerivedStateFromProps=function(n,r){var i=r.children,o=r.handleExited,c=r.firstRender;return{children:c?KI(n,o):QI(n,i,o),firstRender:!1}},a.handleExited=function(n,r){var i=DN(this.props.children);n.key in i||(n.props.onExited&&n.props.onExited(r),this.mounted&&this.setState(function(o){var c=st({},o.children);return delete c[n.key],{children:c}}))},a.render=function(){var n=this.props,r=n.component,i=n.childFactory,o=Na(n,["component","childFactory"]),c=this.state.contextValue,x=YI(this.state.children).map(i);return delete o.appear,delete o.enter,delete o.exit,r===null?Xt.createElement(w1.Provider,{value:c},x):Xt.createElement(w1.Provider,{value:c},Xt.createElement(r,o,x))},s}(Xt.Component);IN.propTypes={};IN.defaultProps=JI;function ZI(t){return Vi("MuiPaper",t)}_i("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const e9=["className","component","elevation","square","variant"],t9=t=>{const{square:s,elevation:a,variant:l,classes:n}=t,r={root:["root",l,!s&&"rounded",l==="elevation"&&`elevation${a}`]};return Ho(r,ZI,n)},s9=an("div",{name:"MuiPaper",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:a}=t;return[s.root,s[a.variant],!a.square&&s.rounded,a.variant==="elevation"&&s[`elevation${a.elevation}`]]}})(({theme:t,ownerState:s})=>{var a;return st({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow")},!s.square&&{borderRadius:t.shape.borderRadius},s.variant==="outlined"&&{border:`1px solid ${(t.vars||t).palette.divider}`},s.variant==="elevation"&&st({boxShadow:(t.vars||t).shadows[s.elevation]},!t.vars&&t.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${wo("#fff",N1(s.elevation))}, ${wo("#fff",N1(s.elevation))})`},t.vars&&{backgroundImage:(a=t.vars.overlays)==null?void 0:a[s.elevation]}))}),a9=d.forwardRef(function(s,a){const l=oi({props:s,name:"MuiPaper"}),{className:n,component:r="div",elevation:i=1,square:o=!1,variant:c="elevation"}=l,x=Na(l,e9),j=st({},l,{component:r,elevation:i,square:o,variant:c}),g=t9(j);return e.jsx(s9,st({as:r,ownerState:j,className:Ha(g.root,n),ref:a},x))}),l9=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],n9=["component","slots","slotProps"],r9=["component"];function k1(t,s){const{className:a,elementType:l,ownerState:n,externalForwardedProps:r,getSlotOwnerState:i,internalForwardedProps:o}=s,c=Na(s,l9),{component:x,slots:j={[t]:void 0},slotProps:g={[t]:void 0}}=r,N=Na(r,n9),$=j[t]||l,T=fD(g[t],n),k=gD(st({className:a},c,{externalForwardedProps:t==="root"?N:void 0,externalSlotProps:T})),{props:{component:q},internalRef:L}=k,R=Na(k.props,r9),U=Oj(L,T==null?void 0:T.ref,s.ref),ae=i?i(R):{},ie=st({},n,ae),_=t==="root"?q||x:q,W=pD($,st({},t==="root"&&!x&&!j[t]&&o,t!=="root"&&!j[t]&&o,R,_&&{as:_},{ref:U}),ie);return Object.keys(ae).forEach(J=>{delete W[J]}),[$,W]}function i9(t){const{className:s,classes:a,pulsate:l=!1,rippleX:n,rippleY:r,rippleSize:i,in:o,onExited:c,timeout:x}=t,[j,g]=d.useState(!1),N=Ha(s,a.ripple,a.rippleVisible,l&&a.ripplePulsate),$={width:i,height:i,top:-(i/2)+r,left:-(i/2)+n},T=Ha(a.child,j&&a.childLeaving,l&&a.childPulsate);return!o&&!j&&g(!0),d.useEffect(()=>{if(!o&&c!=null){const k=setTimeout(c,x);return()=>{clearTimeout(k)}}},[c,o,x]),e.jsx("span",{className:N,style:$,children:e.jsx("span",{className:T})})}const Kn=_i("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),o9=["center","classes","className"];let vf=t=>t,C1,S1,A1,E1;const Fj=550,d9=80,c9=Yg(C1||(C1=vf`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),u9=Yg(S1||(S1=vf`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),m9=Yg(A1||(A1=vf`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),x9=an("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),p9=an(i9,{name:"MuiTouchRipple",slot:"Ripple"})(E1||(E1=vf`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),Kn.rippleVisible,c9,Fj,({theme:t})=>t.transitions.easing.easeInOut,Kn.ripplePulsate,({theme:t})=>t.transitions.duration.shorter,Kn.child,Kn.childLeaving,u9,Fj,({theme:t})=>t.transitions.easing.easeInOut,Kn.childPulsate,m9,({theme:t})=>t.transitions.easing.easeInOut),h9=d.forwardRef(function(s,a){const l=oi({props:s,name:"MuiTouchRipple"}),{center:n=!1,classes:r={},className:i}=l,o=Na(l,o9),[c,x]=d.useState([]),j=d.useRef(0),g=d.useRef(null);d.useEffect(()=>{g.current&&(g.current(),g.current=null)},[c]);const N=d.useRef(!1),$=lD(),T=d.useRef(null),k=d.useRef(null),q=d.useCallback(ae=>{const{pulsate:ie,rippleX:_,rippleY:W,rippleSize:J,cb:we}=ae;x(G=>[...G,e.jsx(p9,{classes:{ripple:Ha(r.ripple,Kn.ripple),rippleVisible:Ha(r.rippleVisible,Kn.rippleVisible),ripplePulsate:Ha(r.ripplePulsate,Kn.ripplePulsate),child:Ha(r.child,Kn.child),childLeaving:Ha(r.childLeaving,Kn.childLeaving),childPulsate:Ha(r.childPulsate,Kn.childPulsate)},timeout:Fj,pulsate:ie,rippleX:_,rippleY:W,rippleSize:J},j.current)]),j.current+=1,g.current=we},[r]),L=d.useCallback((ae={},ie={},_=()=>{})=>{const{pulsate:W=!1,center:J=n||ie.pulsate,fakeElement:we=!1}=ie;if((ae==null?void 0:ae.type)==="mousedown"&&N.current){N.current=!1;return}(ae==null?void 0:ae.type)==="touchstart"&&(N.current=!0);const G=we?null:k.current,be=G?G.getBoundingClientRect():{width:0,height:0,left:0,top:0};let Ge,Me,je;if(J||ae===void 0||ae.clientX===0&&ae.clientY===0||!ae.clientX&&!ae.touches)Ge=Math.round(be.width/2),Me=Math.round(be.height/2);else{const{clientX:Ue,clientY:Oe}=ae.touches&&ae.touches.length>0?ae.touches[0]:ae;Ge=Math.round(Ue-be.left),Me=Math.round(Oe-be.top)}if(J)je=Math.sqrt((2*be.width**2+be.height**2)/3),je%2===0&&(je+=1);else{const Ue=Math.max(Math.abs((G?G.clientWidth:0)-Ge),Ge)*2+2,Oe=Math.max(Math.abs((G?G.clientHeight:0)-Me),Me)*2+2;je=Math.sqrt(Ue**2+Oe**2)}ae!=null&&ae.touches?T.current===null&&(T.current=()=>{q({pulsate:W,rippleX:Ge,rippleY:Me,rippleSize:je,cb:_})},$.start(d9,()=>{T.current&&(T.current(),T.current=null)})):q({pulsate:W,rippleX:Ge,rippleY:Me,rippleSize:je,cb:_})},[n,q,$]),R=d.useCallback(()=>{L({},{pulsate:!0})},[L]),U=d.useCallback((ae,ie)=>{if($.clear(),(ae==null?void 0:ae.type)==="touchend"&&T.current){T.current(),T.current=null,$.start(0,()=>{U(ae,ie)});return}T.current=null,x(_=>_.length>0?_.slice(1):_),g.current=ie},[$]);return d.useImperativeHandle(a,()=>({pulsate:R,start:L,stop:U}),[R,L,U]),e.jsx(x9,st({className:Ha(Kn.root,r.root,i),ref:k},o,{children:e.jsx(IN,{component:null,exit:!0,children:c})}))});function g9(t){return Vi("MuiButtonBase",t)}const f9=_i("MuiButtonBase",["root","disabled","focusVisible"]),v9=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],b9=t=>{const{disabled:s,focusVisible:a,focusVisibleClassName:l,classes:n}=t,i=Ho({root:["root",s&&"disabled",a&&"focusVisible"]},g9,n);return a&&l&&(i.root+=` ${l}`),i},j9=an("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(t,s)=>s.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${f9.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),Q5=d.forwardRef(function(s,a){const l=oi({props:s,name:"MuiButtonBase"}),{action:n,centerRipple:r=!1,children:i,className:o,component:c="button",disabled:x=!1,disableRipple:j=!1,disableTouchRipple:g=!1,focusRipple:N=!1,LinkComponent:$="a",onBlur:T,onClick:k,onContextMenu:q,onDragLeave:L,onFocus:R,onFocusVisible:U,onKeyDown:ae,onKeyUp:ie,onMouseDown:_,onMouseLeave:W,onMouseUp:J,onTouchEnd:we,onTouchMove:G,onTouchStart:be,tabIndex:Ge=0,TouchRippleProps:Me,touchRippleRef:je,type:Ue}=l,Oe=Na(l,v9),he=d.useRef(null),Y=d.useRef(null),Ie=Oj(Y,je),{isFocusVisibleRef:ce,onFocus:me,onBlur:pe,ref:de}=mD(),[ye,Qe]=d.useState(!1);x&&ye&&Qe(!1),d.useImperativeHandle(n,()=>({focusVisible:()=>{Qe(!0),he.current.focus()}}),[]);const[Fe,ke]=d.useState(!1);d.useEffect(()=>{ke(!0)},[]);const fe=Fe&&!j&&!x;d.useEffect(()=>{ye&&N&&!j&&Fe&&Y.current.pulsate()},[j,N,ye,Fe]);function Ve($e,ge,ue=g){return Ip(Ke=>(ge&&ge(Ke),!ue&&Y.current&&Y.current[$e](Ke),!0))}const ne=Ve("start",_),Te=Ve("stop",q),Ee=Ve("stop",L),Re=Ve("stop",J),ze=Ve("stop",$e=>{ye&&$e.preventDefault(),W&&W($e)}),qe=Ve("start",be),He=Ve("stop",we),_e=Ve("stop",G),le=Ve("stop",$e=>{pe($e),ce.current===!1&&Qe(!1),T&&T($e)},!1),z=Ip($e=>{he.current||(he.current=$e.currentTarget),me($e),ce.current===!0&&(Qe(!0),U&&U($e)),R&&R($e)}),Pe=()=>{const $e=he.current;return c&&c!=="button"&&!($e.tagName==="A"&&$e.href)},Be=d.useRef(!1),xe=Ip($e=>{N&&!Be.current&&ye&&Y.current&&$e.key===" "&&(Be.current=!0,Y.current.stop($e,()=>{Y.current.start($e)})),$e.target===$e.currentTarget&&Pe()&&$e.key===" "&&$e.preventDefault(),ae&&ae($e),$e.target===$e.currentTarget&&Pe()&&$e.key==="Enter"&&!x&&($e.preventDefault(),k&&k($e))}),Ne=Ip($e=>{N&&$e.key===" "&&Y.current&&ye&&!$e.defaultPrevented&&(Be.current=!1,Y.current.stop($e,()=>{Y.current.pulsate($e)})),ie&&ie($e),k&&$e.target===$e.currentTarget&&Pe()&&$e.key===" "&&!$e.defaultPrevented&&k($e)});let M=c;M==="button"&&(Oe.href||Oe.to)&&(M=$);const H={};M==="button"?(H.type=Ue===void 0?"button":Ue,H.disabled=x):(!Oe.href&&!Oe.to&&(H.role="button"),x&&(H["aria-disabled"]=x));const Ae=Oj(a,de,he),oe=st({},l,{centerRipple:r,component:c,disabled:x,disableRipple:j,disableTouchRipple:g,focusRipple:N,tabIndex:Ge,focusVisible:ye}),De=b9(oe);return e.jsxs(j9,st({as:M,className:Ha(De.root,o),ownerState:oe,onBlur:le,onClick:k,onContextMenu:Te,onFocus:z,onKeyDown:xe,onKeyUp:Ne,onMouseDown:ne,onMouseLeave:ze,onMouseUp:Re,onDragLeave:Ee,onTouchEnd:He,onTouchMove:_e,onTouchStart:qe,ref:Ae,tabIndex:x?-1:Ge,type:Ue},H,Oe,{children:[i,fe?e.jsx(h9,st({ref:Ie,center:r},Me)):null]}))});function y9(t){return Vi("MuiAlert",t)}const M1=_i("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]);function N9(t){return Vi("MuiIconButton",t)}const w9=_i("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),k9=["edge","children","className","color","disabled","disableFocusRipple","size"],C9=t=>{const{classes:s,disabled:a,color:l,edge:n,size:r}=t,i={root:["root",a&&"disabled",l!=="default"&&`color${ws(l)}`,n&&`edge${ws(n)}`,`size${ws(r)}`]};return Ho(i,N9,s)},S9=an(Q5,{name:"MuiIconButton",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:a}=t;return[s.root,a.color!=="default"&&s[`color${ws(a.color)}`],a.edge&&s[`edge${ws(a.edge)}`],s[`size${ws(a.size)}`]]}})(({theme:t,ownerState:s})=>st({textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(t.vars||t).palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest})},!s.disableRipple&&{"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:wo(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},s.edge==="start"&&{marginLeft:s.size==="small"?-3:-12},s.edge==="end"&&{marginRight:s.size==="small"?-3:-12}),({theme:t,ownerState:s})=>{var a;const l=(a=(t.vars||t).palette)==null?void 0:a[s.color];return st({},s.color==="inherit"&&{color:"inherit"},s.color!=="inherit"&&s.color!=="default"&&st({color:l==null?void 0:l.main},!s.disableRipple&&{"&:hover":st({},l&&{backgroundColor:t.vars?`rgba(${l.mainChannel} / ${t.vars.palette.action.hoverOpacity})`:wo(l.main,t.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),s.size==="small"&&{padding:5,fontSize:t.typography.pxToRem(18)},s.size==="large"&&{padding:12,fontSize:t.typography.pxToRem(28)},{[`&.${w9.disabled}`]:{backgroundColor:"transparent",color:(t.vars||t).palette.action.disabled}})}),A9=d.forwardRef(function(s,a){const l=oi({props:s,name:"MuiIconButton"}),{edge:n=!1,children:r,className:i,color:o="default",disabled:c=!1,disableFocusRipple:x=!1,size:j="medium"}=l,g=Na(l,k9),N=st({},l,{edge:n,color:o,disabled:c,disableFocusRipple:x,size:j}),$=C9(N);return e.jsx(S9,st({className:Ha($.root,i),centerRipple:!0,focusRipple:!x,disabled:c,ref:a},g,{ownerState:N,children:r}))}),E9=up(e.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),M9=up(e.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),P9=up(e.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),O9=up(e.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),T9=up(e.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),R9=["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"],D9=t=>{const{variant:s,color:a,severity:l,classes:n}=t,r={root:["root",`color${ws(a||l)}`,`${s}${ws(a||l)}`,`${s}`],icon:["icon"],message:["message"],action:["action"]};return Ho(r,y9,n)},I9=an(a9,{name:"MuiAlert",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:a}=t;return[s.root,s[a.variant],s[`${a.variant}${ws(a.color||a.severity)}`]]}})(({theme:t})=>{const s=t.palette.mode==="light"?Rj:Dj,a=t.palette.mode==="light"?Dj:Rj;return st({},t.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(t.palette).filter(([,l])=>l.main&&l.light).map(([l])=>({props:{colorSeverity:l,variant:"standard"},style:{color:t.vars?t.vars.palette.Alert[`${l}Color`]:s(t.palette[l].light,.6),backgroundColor:t.vars?t.vars.palette.Alert[`${l}StandardBg`]:a(t.palette[l].light,.9),[`& .${M1.icon}`]:t.vars?{color:t.vars.palette.Alert[`${l}IconColor`]}:{color:t.palette[l].main}}})),...Object.entries(t.palette).filter(([,l])=>l.main&&l.light).map(([l])=>({props:{colorSeverity:l,variant:"outlined"},style:{color:t.vars?t.vars.palette.Alert[`${l}Color`]:s(t.palette[l].light,.6),border:`1px solid ${(t.vars||t).palette[l].light}`,[`& .${M1.icon}`]:t.vars?{color:t.vars.palette.Alert[`${l}IconColor`]}:{color:t.palette[l].main}}})),...Object.entries(t.palette).filter(([,l])=>l.main&&l.dark).map(([l])=>({props:{colorSeverity:l,variant:"filled"},style:st({fontWeight:t.typography.fontWeightMedium},t.vars?{color:t.vars.palette.Alert[`${l}FilledColor`],backgroundColor:t.vars.palette.Alert[`${l}FilledBg`]}:{backgroundColor:t.palette.mode==="dark"?t.palette[l].dark:t.palette[l].main,color:t.palette.getContrastText(t.palette[l].main)})}))]})}),$9=an("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(t,s)=>s.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),L9=an("div",{name:"MuiAlert",slot:"Message",overridesResolver:(t,s)=>s.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),P1=an("div",{name:"MuiAlert",slot:"Action",overridesResolver:(t,s)=>s.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),O1={success:e.jsx(E9,{fontSize:"inherit"}),warning:e.jsx(M9,{fontSize:"inherit"}),error:e.jsx(P9,{fontSize:"inherit"}),info:e.jsx(O9,{fontSize:"inherit"})},F9=d.forwardRef(function(s,a){const l=oi({props:s,name:"MuiAlert"}),{action:n,children:r,className:i,closeText:o="Close",color:c,components:x={},componentsProps:j={},icon:g,iconMapping:N=O1,onClose:$,role:T="alert",severity:k="success",slotProps:q={},slots:L={},variant:R="standard"}=l,U=Na(l,R9),ae=st({},l,{color:c,severity:k,variant:R,colorSeverity:c||k}),ie=D9(ae),_={slots:st({closeButton:x.CloseButton,closeIcon:x.CloseIcon},L),slotProps:st({},j,q)},[W,J]=k1("closeButton",{elementType:A9,externalForwardedProps:_,ownerState:ae}),[we,G]=k1("closeIcon",{elementType:T9,externalForwardedProps:_,ownerState:ae});return e.jsxs(I9,st({role:T,elevation:0,ownerState:ae,className:Ha(ie.root,i),ref:a},U,{children:[g!==!1?e.jsx($9,{ownerState:ae,className:ie.icon,children:g||N[k]||O1[k]}):null,e.jsx(L9,{ownerState:ae,className:ie.message,children:r}),n!=null?e.jsx(P1,{ownerState:ae,className:ie.action,children:n}):null,n==null&&$?e.jsx(P1,{ownerState:ae,className:ie.action,children:e.jsx(W,st({size:"small","aria-label":o,title:o,color:"inherit",onClick:$},J,{children:e.jsx(we,st({fontSize:"small"},G))}))}):null]}))});function U9(t){return Vi("MuiTypography",t)}_i("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const V9=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],_9=t=>{const{align:s,gutterBottom:a,noWrap:l,paragraph:n,variant:r,classes:i}=t,o={root:["root",r,t.align!=="inherit"&&`align${ws(s)}`,a&&"gutterBottom",l&&"noWrap",n&&"paragraph"]};return Ho(o,U9,i)},B9=an("span",{name:"MuiTypography",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:a}=t;return[s.root,a.variant&&s[a.variant],a.align!=="inherit"&&s[`align${ws(a.align)}`],a.noWrap&&s.noWrap,a.gutterBottom&&s.gutterBottom,a.paragraph&&s.paragraph]}})(({theme:t,ownerState:s})=>st({margin:0},s.variant==="inherit"&&{font:"inherit"},s.variant!=="inherit"&&t.typography[s.variant],s.align!=="inherit"&&{textAlign:s.align},s.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},s.gutterBottom&&{marginBottom:"0.35em"},s.paragraph&&{marginBottom:16})),T1={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},G9={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},q9=t=>G9[t]||t,z9=d.forwardRef(function(s,a){const l=oi({props:s,name:"MuiTypography"}),n=q9(l.color),r=M5(st({},l,{color:n})),{align:i="inherit",className:o,component:c,gutterBottom:x=!1,noWrap:j=!1,paragraph:g=!1,variant:N="body1",variantMapping:$=T1}=r,T=Na(r,V9),k=st({},r,{align:i,color:n,className:o,component:c,gutterBottom:x,noWrap:j,paragraph:g,variant:N,variantMapping:$}),q=c||(g?"p":$[N]||T1[N])||"span",L=_9(k);return e.jsx(B9,st({as:q,ref:a,ownerState:k,className:Ha(L.root,o)},T))});function W9(t){return Vi("MuiAlertTitle",t)}_i("MuiAlertTitle",["root"]);const H9=["className"],X9=t=>{const{classes:s}=t;return Ho({root:["root"]},W9,s)},K9=an(z9,{name:"MuiAlertTitle",slot:"Root",overridesResolver:(t,s)=>s.root})(({theme:t})=>({fontWeight:t.typography.fontWeightMedium,marginTop:-2})),Q9=d.forwardRef(function(s,a){const l=oi({props:s,name:"MuiAlertTitle"}),{className:n}=l,r=Na(l,H9),i=l,o=X9(i);return e.jsx(K9,st({gutterBottom:!0,component:"div",ownerState:i,ref:a,className:Ha(o.root,n)},r))});function Y9(t){return e.jsx(E5,st({},t,{defaultTheme:H5,themeId:H0}))}function J9(t){return Vi("MuiButton",t)}const Lp=_i("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),Z9=d.createContext({}),e$=d.createContext(void 0),t$=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],s$=t=>{const{color:s,disableElevation:a,fullWidth:l,size:n,variant:r,classes:i}=t,o={root:["root",r,`${r}${ws(s)}`,`size${ws(n)}`,`${r}Size${ws(n)}`,`color${ws(s)}`,a&&"disableElevation",l&&"fullWidth"],label:["label"],startIcon:["icon","startIcon",`iconSize${ws(n)}`],endIcon:["icon","endIcon",`iconSize${ws(n)}`]},c=Ho(o,J9,i);return st({},i,c)},Y5=t=>st({},t.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},t.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},t.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),a$=an(Q5,{shouldForwardProp:t=>K5(t)||t==="classes",name:"MuiButton",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:a}=t;return[s.root,s[a.variant],s[`${a.variant}${ws(a.color)}`],s[`size${ws(a.size)}`],s[`${a.variant}Size${ws(a.size)}`],a.color==="inherit"&&s.colorInherit,a.disableElevation&&s.disableElevation,a.fullWidth&&s.fullWidth]}})(({theme:t,ownerState:s})=>{var a,l;const n=t.palette.mode==="light"?t.palette.grey[300]:t.palette.grey[800],r=t.palette.mode==="light"?t.palette.grey.A100:t.palette.grey[700];return st({},t.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":st({textDecoration:"none",backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:wo(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},s.variant==="text"&&s.color!=="inherit"&&{backgroundColor:t.vars?`rgba(${t.vars.palette[s.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:wo(t.palette[s.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},s.variant==="outlined"&&s.color!=="inherit"&&{border:`1px solid ${(t.vars||t).palette[s.color].main}`,backgroundColor:t.vars?`rgba(${t.vars.palette[s.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:wo(t.palette[s.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},s.variant==="contained"&&{backgroundColor:t.vars?t.vars.palette.Button.inheritContainedHoverBg:r,boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2],backgroundColor:(t.vars||t).palette.grey[300]}},s.variant==="contained"&&s.color!=="inherit"&&{backgroundColor:(t.vars||t).palette[s.color].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[s.color].main}}),"&:active":st({},s.variant==="contained"&&{boxShadow:(t.vars||t).shadows[8]}),[`&.${Lp.focusVisible}`]:st({},s.variant==="contained"&&{boxShadow:(t.vars||t).shadows[6]}),[`&.${Lp.disabled}`]:st({color:(t.vars||t).palette.action.disabled},s.variant==="outlined"&&{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`},s.variant==="contained"&&{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground})},s.variant==="text"&&{padding:"6px 8px"},s.variant==="text"&&s.color!=="inherit"&&{color:(t.vars||t).palette[s.color].main},s.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},s.variant==="outlined"&&s.color!=="inherit"&&{color:(t.vars||t).palette[s.color].main,border:t.vars?`1px solid rgba(${t.vars.palette[s.color].mainChannel} / 0.5)`:`1px solid ${wo(t.palette[s.color].main,.5)}`},s.variant==="contained"&&{color:t.vars?t.vars.palette.text.primary:(a=(l=t.palette).getContrastText)==null?void 0:a.call(l,t.palette.grey[300]),backgroundColor:t.vars?t.vars.palette.Button.inheritContainedBg:n,boxShadow:(t.vars||t).shadows[2]},s.variant==="contained"&&s.color!=="inherit"&&{color:(t.vars||t).palette[s.color].contrastText,backgroundColor:(t.vars||t).palette[s.color].main},s.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},s.size==="small"&&s.variant==="text"&&{padding:"4px 5px",fontSize:t.typography.pxToRem(13)},s.size==="large"&&s.variant==="text"&&{padding:"8px 11px",fontSize:t.typography.pxToRem(15)},s.size==="small"&&s.variant==="outlined"&&{padding:"3px 9px",fontSize:t.typography.pxToRem(13)},s.size==="large"&&s.variant==="outlined"&&{padding:"7px 21px",fontSize:t.typography.pxToRem(15)},s.size==="small"&&s.variant==="contained"&&{padding:"4px 10px",fontSize:t.typography.pxToRem(13)},s.size==="large"&&s.variant==="contained"&&{padding:"8px 22px",fontSize:t.typography.pxToRem(15)},s.fullWidth&&{width:"100%"})},({ownerState:t})=>t.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${Lp.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${Lp.disabled}`]:{boxShadow:"none"}}),l$=an("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(t,s)=>{const{ownerState:a}=t;return[s.startIcon,s[`iconSize${ws(a.size)}`]]}})(({ownerState:t})=>st({display:"inherit",marginRight:8,marginLeft:-4},t.size==="small"&&{marginLeft:-2},Y5(t))),n$=an("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(t,s)=>{const{ownerState:a}=t;return[s.endIcon,s[`iconSize${ws(a.size)}`]]}})(({ownerState:t})=>st({display:"inherit",marginRight:-4,marginLeft:8},t.size==="small"&&{marginRight:-2},Y5(t))),R1=d.forwardRef(function(s,a){const l=d.useContext(Z9),n=d.useContext(e$),r=Q0(l,s),i=oi({props:r,name:"MuiButton"}),{children:o,color:c="primary",component:x="button",className:j,disabled:g=!1,disableElevation:N=!1,disableFocusRipple:$=!1,endIcon:T,focusVisibleClassName:k,fullWidth:q=!1,size:L="medium",startIcon:R,type:U,variant:ae="text"}=i,ie=Na(i,t$),_=st({},i,{color:c,component:x,disabled:g,disableElevation:N,disableFocusRipple:$,fullWidth:q,size:L,type:U,variant:ae}),W=s$(_),J=R&&e.jsx(l$,{className:W.startIcon,ownerState:_,children:R}),we=T&&e.jsx(n$,{className:W.endIcon,ownerState:_,children:T}),G=n||"";return e.jsxs(a$,st({ownerState:_,className:Ha(l.className,W.root,j,G),component:x,disabled:g,focusRipple:!$,focusVisibleClassName:Ha(W.focusVisible,k),ref:a,type:U},ie,{classes:W,children:[J,o,we]}))}),r$=(t,s)=>st({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},s&&!t.vars&&{colorScheme:t.palette.mode}),i$=t=>st({color:(t.vars||t).palette.text.primary},t.typography.body1,{backgroundColor:(t.vars||t).palette.background.default,"@media print":{backgroundColor:(t.vars||t).palette.common.white}}),o$=(t,s=!1)=>{var a;const l={};s&&t.colorSchemes&&Object.entries(t.colorSchemes).forEach(([i,o])=>{var c;l[t.getColorSchemeSelector(i).replace(/\s*&/,"")]={colorScheme:(c=o.palette)==null?void 0:c.mode}});let n=st({html:r$(t,s),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:t.typography.fontWeightBold},body:st({margin:0},i$(t),{"&::backdrop":{backgroundColor:(t.vars||t).palette.background.default}})},l);const r=(a=t.components)==null||(a=a.MuiCssBaseline)==null?void 0:a.styleOverrides;return r&&(n=[n,r]),n};function d$(t){const s=oi({props:t,name:"MuiCssBaseline"}),{children:a,enableColorScheme:l=!1}=s;return e.jsxs(d.Fragment,{children:[e.jsx(Y9,{styles:n=>o$(n,l)}),a]})}const is={HOME:"/",SIGNIN:"/signin",AUTH:{LOGIN:"/auth/login",MFA:"/auth/mfa",INVITE:"/auth/invite",INVITE_TOKEN:"/auth/invite/:token"},CONSOLE:{ROOT:"/console",DASHBOARD:"/console/dashboard"},PAGES_PREVIEW:"/pages/:id"},$N=d.createContext({});function LN(t){const s=d.useRef(null);return s.current===null&&(s.current=t()),s.current}const bf=d.createContext(null),FN=d.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class c$ extends d.Component{getSnapshotBeforeUpdate(s){const a=this.props.childRef.current;if(a&&s.isPresent&&!this.props.isPresent){const l=this.props.sizeRef.current;l.height=a.offsetHeight||0,l.width=a.offsetWidth||0,l.top=a.offsetTop,l.left=a.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function u$({children:t,isPresent:s}){const a=d.useId(),l=d.useRef(null),n=d.useRef({width:0,height:0,top:0,left:0}),{nonce:r}=d.useContext(FN);return d.useInsertionEffect(()=>{const{width:i,height:o,top:c,left:x}=n.current;if(s||!l.current||!i||!o)return;l.current.dataset.motionPopId=a;const j=document.createElement("style");return r&&(j.nonce=r),document.head.appendChild(j),j.sheet&&j.sheet.insertRule(`
          [data-motion-pop-id="${a}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${o}px !important;
            top: ${c}px !important;
            left: ${x}px !important;
          }
        `),()=>{document.head.removeChild(j)}},[s]),e.jsx(c$,{isPresent:s,childRef:l,sizeRef:n,children:d.cloneElement(t,{ref:l})})}const m$=({children:t,initial:s,isPresent:a,onExitComplete:l,custom:n,presenceAffectsLayout:r,mode:i})=>{const o=LN(x$),c=d.useId(),x=d.useCallback(g=>{o.set(g,!0);for(const N of o.values())if(!N)return;l&&l()},[o,l]),j=d.useMemo(()=>({id:c,initial:s,isPresent:a,custom:n,onExitComplete:x,register:g=>(o.set(g,!1),()=>o.delete(g))}),r?[Math.random(),x]:[a,x]);return d.useMemo(()=>{o.forEach((g,N)=>o.set(N,!1))},[a]),d.useEffect(()=>{!a&&!o.size&&l&&l()},[a]),i==="popLayout"&&(t=e.jsx(u$,{isPresent:a,children:t})),e.jsx(bf.Provider,{value:j,children:t})};function x$(){return new Map}function J5(t=!0){const s=d.useContext(bf);if(s===null)return[!0,null];const{isPresent:a,onExitComplete:l,register:n}=s,r=d.useId();d.useEffect(()=>{t&&n(r)},[t]);const i=d.useCallback(()=>t&&l&&l(r),[r,l,t]);return!a&&l?[!1,i]:[!0]}const Fp=t=>t.key||"";function D1(t){const s=[];return d.Children.forEach(t,a=>{d.isValidElement(a)&&s.push(a)}),s}const UN=typeof window<"u",Z5=UN?d.useLayoutEffect:d.useEffect,lt=({children:t,custom:s,initial:a=!0,onExitComplete:l,presenceAffectsLayout:n=!0,mode:r="sync",propagate:i=!1})=>{const[o,c]=J5(i),x=d.useMemo(()=>D1(t),[t]),j=i&&!o?[]:x.map(Fp),g=d.useRef(!0),N=d.useRef(x),$=LN(()=>new Map),[T,k]=d.useState(x),[q,L]=d.useState(x);Z5(()=>{g.current=!1,N.current=x;for(let ae=0;ae<q.length;ae++){const ie=Fp(q[ae]);j.includes(ie)?$.delete(ie):$.get(ie)!==!0&&$.set(ie,!1)}},[q,j.length,j.join("-")]);const R=[];if(x!==T){let ae=[...x];for(let ie=0;ie<q.length;ie++){const _=q[ie],W=Fp(_);j.includes(W)||(ae.splice(ie,0,_),R.push(_))}r==="wait"&&R.length&&(ae=R),L(D1(ae)),k(x);return}const{forceRender:U}=d.useContext($N);return e.jsx(e.Fragment,{children:q.map(ae=>{const ie=Fp(ae),_=i&&!o?!1:x===q||j.includes(ie),W=()=>{if($.has(ie))$.set(ie,!0);else return;let J=!0;$.forEach(we=>{we||(J=!1)}),J&&(U==null||U(),L(N.current),i&&(c==null||c()),l&&l())};return e.jsx(m$,{isPresent:_,initial:!g.current||a?void 0:!1,custom:_?void 0:s,presenceAffectsLayout:n,mode:r,onExitComplete:_?void 0:W,children:ae},ie)})})},Rn=t=>t;let eA=Rn;function VN(t){let s;return()=>(s===void 0&&(s=t()),s)}const wu=(t,s,a)=>{const l=s-t;return l===0?1:(a-t)/l},Ai=t=>t*1e3,Ei=t=>t/1e3,p$={useManualTiming:!1};function h$(t){let s=new Set,a=new Set,l=!1,n=!1;const r=new WeakSet;let i={delta:0,timestamp:0,isProcessing:!1};function o(x){r.has(x)&&(c.schedule(x),t()),x(i)}const c={schedule:(x,j=!1,g=!1)=>{const $=g&&l?s:a;return j&&r.add(x),$.has(x)||$.add(x),x},cancel:x=>{a.delete(x),r.delete(x)},process:x=>{if(i=x,l){n=!0;return}l=!0,[s,a]=[a,s],s.forEach(o),s.clear(),l=!1,n&&(n=!1,c.process(x))}};return c}const Up=["read","resolveKeyframes","update","preRender","render","postRender"],g$=40;function tA(t,s){let a=!1,l=!0;const n={delta:0,timestamp:0,isProcessing:!1},r=()=>a=!0,i=Up.reduce((L,R)=>(L[R]=h$(r),L),{}),{read:o,resolveKeyframes:c,update:x,preRender:j,render:g,postRender:N}=i,$=()=>{const L=performance.now();a=!1,n.delta=l?1e3/60:Math.max(Math.min(L-n.timestamp,g$),1),n.timestamp=L,n.isProcessing=!0,o.process(n),c.process(n),x.process(n),j.process(n),g.process(n),N.process(n),n.isProcessing=!1,a&&s&&(l=!1,t($))},T=()=>{a=!0,l=!0,n.isProcessing||t($)};return{schedule:Up.reduce((L,R)=>{const U=i[R];return L[R]=(ae,ie=!1,_=!1)=>(a||T(),U.schedule(ae,ie,_)),L},{}),cancel:L=>{for(let R=0;R<Up.length;R++)i[Up[R]].cancel(L)},state:n,steps:i}}const{schedule:Qs,cancel:Vo,state:bl,steps:iv}=tA(typeof requestAnimationFrame<"u"?requestAnimationFrame:Rn,!0),sA=d.createContext({strict:!1}),I1={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},ku={};for(const t in I1)ku[t]={isEnabled:s=>I1[t].some(a=>!!s[a])};function f$(t){for(const s in t)ku[s]={...ku[s],...t[s]}}const v$=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Z0(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||v$.has(t)}let aA=t=>!Z0(t);function b$(t){t&&(aA=s=>s.startsWith("on")?!Z0(s):t(s))}try{b$(require("@emotion/is-prop-valid").default)}catch{}function j$(t,s,a){const l={};for(const n in t)n==="values"&&typeof t.values=="object"||(aA(n)||a===!0&&Z0(n)||!s&&!Z0(n)||t.draggable&&n.startsWith("onDrag"))&&(l[n]=t[n]);return l}function y$(t){if(typeof Proxy>"u")return t;const s=new Map,a=(...l)=>t(...l);return new Proxy(a,{get:(l,n)=>n==="create"?t:(s.has(n)||s.set(n,t(n)),s.get(n))})}const jf=d.createContext({});function Bx(t){return typeof t=="string"||Array.isArray(t)}function yf(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const _N=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],BN=["initial",..._N];function Nf(t){return yf(t.animate)||BN.some(s=>Bx(t[s]))}function lA(t){return!!(Nf(t)||t.variants)}function N$(t,s){if(Nf(t)){const{initial:a,animate:l}=t;return{initial:a===!1||Bx(a)?a:void 0,animate:Bx(l)?l:void 0}}return t.inherit!==!1?s:{}}function w$(t){const{initial:s,animate:a}=N$(t,d.useContext(jf));return d.useMemo(()=>({initial:s,animate:a}),[$1(s),$1(a)])}function $1(t){return Array.isArray(t)?t.join(" "):t}const k$=Symbol.for("motionComponentSymbol");function Qc(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function C$(t,s,a){return d.useCallback(l=>{l&&t.onMount&&t.onMount(l),s&&(l?s.mount(l):s.unmount()),a&&(typeof a=="function"?a(l):Qc(a)&&(a.current=l))},[s])}const GN=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),S$="framerAppearId",nA="data-"+GN(S$),{schedule:qN}=tA(queueMicrotask,!1),rA=d.createContext({});function A$(t,s,a,l,n){var r,i;const{visualElement:o}=d.useContext(jf),c=d.useContext(sA),x=d.useContext(bf),j=d.useContext(FN).reducedMotion,g=d.useRef(null);l=l||c.renderer,!g.current&&l&&(g.current=l(t,{visualState:s,parent:o,props:a,presenceContext:x,blockInitialAnimation:x?x.initial===!1:!1,reducedMotionConfig:j}));const N=g.current,$=d.useContext(rA);N&&!N.projection&&n&&(N.type==="html"||N.type==="svg")&&E$(g.current,a,n,$);const T=d.useRef(!1);d.useInsertionEffect(()=>{N&&T.current&&N.update(a,x)});const k=a[nA],q=d.useRef(!!k&&!(!((r=window.MotionHandoffIsComplete)===null||r===void 0)&&r.call(window,k))&&((i=window.MotionHasOptimisedAnimation)===null||i===void 0?void 0:i.call(window,k)));return Z5(()=>{N&&(T.current=!0,window.MotionIsMounted=!0,N.updateFeatures(),qN.render(N.render),q.current&&N.animationState&&N.animationState.animateChanges())}),d.useEffect(()=>{N&&(!q.current&&N.animationState&&N.animationState.animateChanges(),q.current&&(queueMicrotask(()=>{var L;(L=window.MotionHandoffMarkAsComplete)===null||L===void 0||L.call(window,k)}),q.current=!1))}),N}function E$(t,s,a,l){const{layoutId:n,layout:r,drag:i,dragConstraints:o,layoutScroll:c,layoutRoot:x}=s;t.projection=new a(t.latestValues,s["data-framer-portal-id"]?void 0:iA(t.parent)),t.projection.setOptions({layoutId:n,layout:r,alwaysMeasureLayout:!!i||o&&Qc(o),visualElement:t,animationType:typeof r=="string"?r:"both",initialPromotionConfig:l,layoutScroll:c,layoutRoot:x})}function iA(t){if(t)return t.options.allowProjection!==!1?t.projection:iA(t.parent)}function M$({preloadedFeatures:t,createVisualElement:s,useRender:a,useVisualState:l,Component:n}){var r,i;t&&f$(t);function o(x,j){let g;const N={...d.useContext(FN),...x,layoutId:P$(x)},{isStatic:$}=N,T=w$(x),k=l(x,$);if(!$&&UN){O$();const q=T$(N);g=q.MeasureLayout,T.visualElement=A$(n,k,N,s,q.ProjectionNode)}return e.jsxs(jf.Provider,{value:T,children:[g&&T.visualElement?e.jsx(g,{visualElement:T.visualElement,...N}):null,a(n,x,C$(k,T.visualElement,j),k,$,T.visualElement)]})}o.displayName=`motion.${typeof n=="string"?n:`create(${(i=(r=n.displayName)!==null&&r!==void 0?r:n.name)!==null&&i!==void 0?i:""})`}`;const c=d.forwardRef(o);return c[k$]=n,c}function P$({layoutId:t}){const s=d.useContext($N).id;return s&&t!==void 0?s+"-"+t:t}function O$(t,s){d.useContext(sA).strict}function T$(t){const{drag:s,layout:a}=ku;if(!s&&!a)return{};const l={...s,...a};return{MeasureLayout:s!=null&&s.isEnabled(t)||a!=null&&a.isEnabled(t)?l.MeasureLayout:void 0,ProjectionNode:l.ProjectionNode}}const R$=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function zN(t){return typeof t!="string"||t.includes("-")?!1:!!(R$.indexOf(t)>-1||/[A-Z]/u.test(t))}function L1(t){const s=[{},{}];return t==null||t.values.forEach((a,l)=>{s[0][l]=a.get(),s[1][l]=a.getVelocity()}),s}function WN(t,s,a,l){if(typeof s=="function"){const[n,r]=L1(l);s=s(a!==void 0?a:t.custom,n,r)}if(typeof s=="string"&&(s=t.variants&&t.variants[s]),typeof s=="function"){const[n,r]=L1(l);s=s(a!==void 0?a:t.custom,n,r)}return s}const Uj=t=>Array.isArray(t),D$=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),I$=t=>Uj(t)?t[t.length-1]||0:t,$l=t=>!!(t&&t.getVelocity);function x0(t){const s=$l(t)?t.get():t;return D$(s)?s.toValue():s}function $$({scrapeMotionValuesFromProps:t,createRenderState:s,onUpdate:a},l,n,r){const i={latestValues:L$(l,n,r,t),renderState:s()};return a&&(i.onMount=o=>a({props:l,current:o,...i}),i.onUpdate=o=>a(o)),i}const oA=t=>(s,a)=>{const l=d.useContext(jf),n=d.useContext(bf),r=()=>$$(t,s,l,n);return a?r():LN(r)};function L$(t,s,a,l){const n={},r=l(t,{});for(const N in r)n[N]=x0(r[N]);let{initial:i,animate:o}=t;const c=Nf(t),x=lA(t);s&&x&&!c&&t.inherit!==!1&&(i===void 0&&(i=s.initial),o===void 0&&(o=s.animate));let j=a?a.initial===!1:!1;j=j||i===!1;const g=j?o:i;if(g&&typeof g!="boolean"&&!yf(g)){const N=Array.isArray(g)?g:[g];for(let $=0;$<N.length;$++){const T=WN(t,N[$]);if(T){const{transitionEnd:k,transition:q,...L}=T;for(const R in L){let U=L[R];if(Array.isArray(U)){const ae=j?U.length-1:0;U=U[ae]}U!==null&&(n[R]=U)}for(const R in k)n[R]=k[R]}}}return n}const $u=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Kd=new Set($u),dA=t=>s=>typeof s=="string"&&s.startsWith(t),cA=dA("--"),F$=dA("var(--"),HN=t=>F$(t)?U$.test(t.split("/*")[0].trim()):!1,U$=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,uA=(t,s)=>s&&typeof t=="number"?s.transform(t):t,Di=(t,s,a)=>a>s?s:a<t?t:a,Lu={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Gx={...Lu,transform:t=>Di(0,1,t)},Vp={...Lu,default:1},mp=t=>({test:s=>typeof s=="string"&&s.endsWith(t)&&s.split(" ").length===1,parse:parseFloat,transform:s=>`${s}${t}`}),mo=mp("deg"),si=mp("%"),Ot=mp("px"),V$=mp("vh"),_$=mp("vw"),F1={...si,parse:t=>si.parse(t)/100,transform:t=>si.transform(t*100)},B$={borderWidth:Ot,borderTopWidth:Ot,borderRightWidth:Ot,borderBottomWidth:Ot,borderLeftWidth:Ot,borderRadius:Ot,radius:Ot,borderTopLeftRadius:Ot,borderTopRightRadius:Ot,borderBottomRightRadius:Ot,borderBottomLeftRadius:Ot,width:Ot,maxWidth:Ot,height:Ot,maxHeight:Ot,top:Ot,right:Ot,bottom:Ot,left:Ot,padding:Ot,paddingTop:Ot,paddingRight:Ot,paddingBottom:Ot,paddingLeft:Ot,margin:Ot,marginTop:Ot,marginRight:Ot,marginBottom:Ot,marginLeft:Ot,backgroundPositionX:Ot,backgroundPositionY:Ot},G$={rotate:mo,rotateX:mo,rotateY:mo,rotateZ:mo,scale:Vp,scaleX:Vp,scaleY:Vp,scaleZ:Vp,skew:mo,skewX:mo,skewY:mo,distance:Ot,translateX:Ot,translateY:Ot,translateZ:Ot,x:Ot,y:Ot,z:Ot,perspective:Ot,transformPerspective:Ot,opacity:Gx,originX:F1,originY:F1,originZ:Ot},U1={...Lu,transform:Math.round},XN={...B$,...G$,zIndex:U1,size:Ot,fillOpacity:Gx,strokeOpacity:Gx,numOctaves:U1},q$={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},z$=$u.length;function W$(t,s,a){let l="",n=!0;for(let r=0;r<z$;r++){const i=$u[r],o=t[i];if(o===void 0)continue;let c=!0;if(typeof o=="number"?c=o===(i.startsWith("scale")?1:0):c=parseFloat(o)===0,!c||a){const x=uA(o,XN[i]);if(!c){n=!1;const j=q$[i]||i;l+=`${j}(${x}) `}a&&(s[i]=x)}}return l=l.trim(),a?l=a(s,n?"":l):n&&(l="none"),l}function KN(t,s,a){const{style:l,vars:n,transformOrigin:r}=t;let i=!1,o=!1;for(const c in s){const x=s[c];if(Kd.has(c)){i=!0;continue}else if(cA(c)){n[c]=x;continue}else{const j=uA(x,XN[c]);c.startsWith("origin")?(o=!0,r[c]=j):l[c]=j}}if(s.transform||(i||a?l.transform=W$(s,t.transform,a):l.transform&&(l.transform="none")),o){const{originX:c="50%",originY:x="50%",originZ:j=0}=r;l.transformOrigin=`${c} ${x} ${j}`}}const H$={offset:"stroke-dashoffset",array:"stroke-dasharray"},X$={offset:"strokeDashoffset",array:"strokeDasharray"};function K$(t,s,a=1,l=0,n=!0){t.pathLength=1;const r=n?H$:X$;t[r.offset]=Ot.transform(-l);const i=Ot.transform(s),o=Ot.transform(a);t[r.array]=`${i} ${o}`}function V1(t,s,a){return typeof t=="string"?t:Ot.transform(s+a*t)}function Q$(t,s,a){const l=V1(s,t.x,t.width),n=V1(a,t.y,t.height);return`${l} ${n}`}function QN(t,{attrX:s,attrY:a,attrScale:l,originX:n,originY:r,pathLength:i,pathSpacing:o=1,pathOffset:c=0,...x},j,g){if(KN(t,x,g),j){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:N,style:$,dimensions:T}=t;N.transform&&(T&&($.transform=N.transform),delete N.transform),T&&(n!==void 0||r!==void 0||$.transform)&&($.transformOrigin=Q$(T,n!==void 0?n:.5,r!==void 0?r:.5)),s!==void 0&&(N.x=s),a!==void 0&&(N.y=a),l!==void 0&&(N.scale=l),i!==void 0&&K$(N,i,o,c,!1)}const YN=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),mA=()=>({...YN(),attrs:{}}),JN=t=>typeof t=="string"&&t.toLowerCase()==="svg";function xA(t,{style:s,vars:a},l,n){Object.assign(t.style,s,n&&n.getProjectionStyles(l));for(const r in a)t.style.setProperty(r,a[r])}const pA=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function hA(t,s,a,l){xA(t,s,void 0,l);for(const n in s.attrs)t.setAttribute(pA.has(n)?n:GN(n),s.attrs[n])}const eg={};function Y$(t){Object.assign(eg,t)}function gA(t,{layout:s,layoutId:a}){return Kd.has(t)||t.startsWith("origin")||(s||a!==void 0)&&(!!eg[t]||t==="opacity")}function ZN(t,s,a){var l;const{style:n}=t,r={};for(const i in n)($l(n[i])||s.style&&$l(s.style[i])||gA(i,t)||((l=a==null?void 0:a.getValue(i))===null||l===void 0?void 0:l.liveStyle)!==void 0)&&(r[i]=n[i]);return r}function fA(t,s,a){const l=ZN(t,s,a);for(const n in t)if($l(t[n])||$l(s[n])){const r=$u.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;l[r]=t[n]}return l}function J$(t,s){try{s.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{s.dimensions={x:0,y:0,width:0,height:0}}}const _1=["x","y","width","height","cx","cy","r"],Z$={useVisualState:oA({scrapeMotionValuesFromProps:fA,createRenderState:mA,onUpdate:({props:t,prevProps:s,current:a,renderState:l,latestValues:n})=>{if(!a)return;let r=!!t.drag;if(!r){for(const o in n)if(Kd.has(o)){r=!0;break}}if(!r)return;let i=!s;if(s)for(let o=0;o<_1.length;o++){const c=_1[o];t[c]!==s[c]&&(i=!0)}i&&Qs.read(()=>{J$(a,l),Qs.render(()=>{QN(l,n,JN(a.tagName),t.transformTemplate),hA(a,l)})})}})},e7={useVisualState:oA({scrapeMotionValuesFromProps:ZN,createRenderState:YN})};function vA(t,s,a){for(const l in s)!$l(s[l])&&!gA(l,a)&&(t[l]=s[l])}function t7({transformTemplate:t},s){return d.useMemo(()=>{const a=YN();return KN(a,s,t),Object.assign({},a.vars,a.style)},[s])}function s7(t,s){const a=t.style||{},l={};return vA(l,a,t),Object.assign(l,t7(t,s)),l}function a7(t,s){const a={},l=s7(t,s);return t.drag&&t.dragListener!==!1&&(a.draggable=!1,l.userSelect=l.WebkitUserSelect=l.WebkitTouchCallout="none",l.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(a.tabIndex=0),a.style=l,a}function l7(t,s,a,l){const n=d.useMemo(()=>{const r=mA();return QN(r,s,JN(l),t.transformTemplate),{...r.attrs,style:{...r.style}}},[s]);if(t.style){const r={};vA(r,t.style,t),n.style={...r,...n.style}}return n}function n7(t=!1){return(a,l,n,{latestValues:r},i)=>{const c=(zN(a)?l7:a7)(l,r,i,a),x=j$(l,typeof a=="string",t),j=a!==d.Fragment?{...x,...c,ref:n}:{},{children:g}=l,N=d.useMemo(()=>$l(g)?g.get():g,[g]);return d.createElement(a,{...j,children:N})}}function r7(t,s){return function(l,{forwardMotionProps:n}={forwardMotionProps:!1}){const i={...zN(l)?Z$:e7,preloadedFeatures:t,useRender:n7(n),createVisualElement:s,Component:l};return M$(i)}}function bA(t,s){if(!Array.isArray(s))return!1;const a=s.length;if(a!==t.length)return!1;for(let l=0;l<a;l++)if(s[l]!==t[l])return!1;return!0}function wf(t,s,a){const l=t.getProps();return WN(l,s,a!==void 0?a:l.custom,t)}const i7=VN(()=>window.ScrollTimeline!==void 0);class o7{constructor(s){this.stop=()=>this.runAll("stop"),this.animations=s.filter(Boolean)}get finished(){return Promise.all(this.animations.map(s=>"finished"in s?s.finished:s))}getAll(s){return this.animations[0][s]}setAll(s,a){for(let l=0;l<this.animations.length;l++)this.animations[l][s]=a}attachTimeline(s,a){const l=this.animations.map(n=>{if(i7()&&n.attachTimeline)return n.attachTimeline(s);if(typeof a=="function")return a(n)});return()=>{l.forEach((n,r)=>{n&&n(),this.animations[r].stop()})}}get time(){return this.getAll("time")}set time(s){this.setAll("time",s)}get speed(){return this.getAll("speed")}set speed(s){this.setAll("speed",s)}get startTime(){return this.getAll("startTime")}get duration(){let s=0;for(let a=0;a<this.animations.length;a++)s=Math.max(s,this.animations[a].duration);return s}runAll(s){this.animations.forEach(a=>a[s]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class d7 extends o7{then(s,a){return Promise.all(this.animations).then(s).catch(a)}}function ew(t,s){return t?t[s]||t.default||t:void 0}const Vj=2e4;function jA(t){let s=0;const a=50;let l=t.next(s);for(;!l.done&&s<Vj;)s+=a,l=t.next(s);return s>=Vj?1/0:s}function tw(t){return typeof t=="function"}function B1(t,s){t.timeline=s,t.onfinish=null}const sw=t=>Array.isArray(t)&&typeof t[0]=="number",c7={linearEasing:void 0};function u7(t,s){const a=VN(t);return()=>{var l;return(l=c7[s])!==null&&l!==void 0?l:a()}}const tg=u7(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),yA=(t,s,a=10)=>{let l="";const n=Math.max(Math.round(s/a),2);for(let r=0;r<n;r++)l+=t(wu(0,n-1,r))+", ";return`linear(${l.substring(0,l.length-2)})`};function NA(t){return!!(typeof t=="function"&&tg()||!t||typeof t=="string"&&(t in _j||tg())||sw(t)||Array.isArray(t)&&t.every(NA))}const Gm=([t,s,a,l])=>`cubic-bezier(${t}, ${s}, ${a}, ${l})`,_j={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Gm([0,.65,.55,1]),circOut:Gm([.55,0,1,.45]),backIn:Gm([.31,.01,.66,-.59]),backOut:Gm([.33,1.53,.69,.99])};function wA(t,s){if(t)return typeof t=="function"&&tg()?yA(t,s):sw(t)?Gm(t):Array.isArray(t)?t.map(a=>wA(a,s)||_j.easeOut):_j[t]}const hr={x:!1,y:!1};function kA(){return hr.x||hr.y}function m7(t,s,a){var l;if(t instanceof Element)return[t];if(typeof t=="string"){let n=document;const r=(l=void 0)!==null&&l!==void 0?l:n.querySelectorAll(t);return r?Array.from(r):[]}return Array.from(t)}function CA(t,s){const a=m7(t),l=new AbortController,n={passive:!0,...s,signal:l.signal};return[a,n,()=>l.abort()]}function G1(t){return s=>{s.pointerType==="touch"||kA()||t(s)}}function x7(t,s,a={}){const[l,n,r]=CA(t,a),i=G1(o=>{const{target:c}=o,x=s(o);if(typeof x!="function"||!c)return;const j=G1(g=>{x(g),c.removeEventListener("pointerleave",j)});c.addEventListener("pointerleave",j,n)});return l.forEach(o=>{o.addEventListener("pointerenter",i,n)}),r}const SA=(t,s)=>s?t===s?!0:SA(t,s.parentElement):!1,aw=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,p7=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function h7(t){return p7.has(t.tagName)||t.tabIndex!==-1}const qm=new WeakSet;function q1(t){return s=>{s.key==="Enter"&&t(s)}}function ov(t,s){t.dispatchEvent(new PointerEvent("pointer"+s,{isPrimary:!0,bubbles:!0}))}const g7=(t,s)=>{const a=t.currentTarget;if(!a)return;const l=q1(()=>{if(qm.has(a))return;ov(a,"down");const n=q1(()=>{ov(a,"up")}),r=()=>ov(a,"cancel");a.addEventListener("keyup",n,s),a.addEventListener("blur",r,s)});a.addEventListener("keydown",l,s),a.addEventListener("blur",()=>a.removeEventListener("keydown",l),s)};function z1(t){return aw(t)&&!kA()}function f7(t,s,a={}){const[l,n,r]=CA(t,a),i=o=>{const c=o.currentTarget;if(!z1(o)||qm.has(c))return;qm.add(c);const x=s(o),j=($,T)=>{window.removeEventListener("pointerup",g),window.removeEventListener("pointercancel",N),!(!z1($)||!qm.has(c))&&(qm.delete(c),typeof x=="function"&&x($,{success:T}))},g=$=>{j($,a.useGlobalTarget||SA(c,$.target))},N=$=>{j($,!1)};window.addEventListener("pointerup",g,n),window.addEventListener("pointercancel",N,n)};return l.forEach(o=>{!h7(o)&&o.getAttribute("tabindex")===null&&(o.tabIndex=0),(a.useGlobalTarget?window:o).addEventListener("pointerdown",i,n),o.addEventListener("focus",x=>g7(x,n),n)}),r}function v7(t){return t==="x"||t==="y"?hr[t]?null:(hr[t]=!0,()=>{hr[t]=!1}):hr.x||hr.y?null:(hr.x=hr.y=!0,()=>{hr.x=hr.y=!1})}const AA=new Set(["width","height","top","left","right","bottom",...$u]);let p0;function b7(){p0=void 0}const ai={now:()=>(p0===void 0&&ai.set(bl.isProcessing||p$.useManualTiming?bl.timestamp:performance.now()),p0),set:t=>{p0=t,queueMicrotask(b7)}};function lw(t,s){t.indexOf(s)===-1&&t.push(s)}function nw(t,s){const a=t.indexOf(s);a>-1&&t.splice(a,1)}class rw{constructor(){this.subscriptions=[]}add(s){return lw(this.subscriptions,s),()=>nw(this.subscriptions,s)}notify(s,a,l){const n=this.subscriptions.length;if(n)if(n===1)this.subscriptions[0](s,a,l);else for(let r=0;r<n;r++){const i=this.subscriptions[r];i&&i(s,a,l)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function EA(t,s){return s?t*(1e3/s):0}const W1=30,j7=t=>!isNaN(parseFloat(t));class y7{constructor(s,a={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(l,n=!0)=>{const r=ai.now();this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(l),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),n&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(s),this.owner=a.owner}setCurrent(s){this.current=s,this.updatedAt=ai.now(),this.canTrackVelocity===null&&s!==void 0&&(this.canTrackVelocity=j7(this.current))}setPrevFrameValue(s=this.current){this.prevFrameValue=s,this.prevUpdatedAt=this.updatedAt}onChange(s){return this.on("change",s)}on(s,a){this.events[s]||(this.events[s]=new rw);const l=this.events[s].add(a);return s==="change"?()=>{l(),Qs.read(()=>{this.events.change.getSize()||this.stop()})}:l}clearListeners(){for(const s in this.events)this.events[s].clear()}attach(s,a){this.passiveEffect=s,this.stopPassiveEffect=a}set(s,a=!0){!a||!this.passiveEffect?this.updateAndNotify(s,a):this.passiveEffect(s,this.updateAndNotify)}setWithVelocity(s,a,l){this.set(a),this.prev=void 0,this.prevFrameValue=s,this.prevUpdatedAt=this.updatedAt-l}jump(s,a=!0){this.updateAndNotify(s),this.prev=s,this.prevUpdatedAt=this.prevFrameValue=void 0,a&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const s=ai.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||s-this.updatedAt>W1)return 0;const a=Math.min(this.updatedAt-this.prevUpdatedAt,W1);return EA(parseFloat(this.current)-parseFloat(this.prevFrameValue),a)}start(s){return this.stop(),new Promise(a=>{this.hasAnimated=!0,this.animation=s(a),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function qx(t,s){return new y7(t,s)}function N7(t,s,a){t.hasValue(s)?t.getValue(s).set(a):t.addValue(s,qx(a))}function w7(t,s){const a=wf(t,s);let{transitionEnd:l={},transition:n={},...r}=a||{};r={...r,...l};for(const i in r){const o=I$(r[i]);N7(t,i,o)}}function k7(t){return!!($l(t)&&t.add)}function Bj(t,s){const a=t.getValue("willChange");if(k7(a))return a.add(s)}function MA(t){return t.props[nA]}const PA=(t,s,a)=>(((1-3*a+3*s)*t+(3*a-6*s))*t+3*s)*t,C7=1e-7,S7=12;function A7(t,s,a,l,n){let r,i,o=0;do i=s+(a-s)/2,r=PA(i,l,n)-t,r>0?a=i:s=i;while(Math.abs(r)>C7&&++o<S7);return i}function xp(t,s,a,l){if(t===s&&a===l)return Rn;const n=r=>A7(r,0,1,t,a);return r=>r===0||r===1?r:PA(n(r),s,l)}const OA=t=>s=>s<=.5?t(2*s)/2:(2-t(2*(1-s)))/2,TA=t=>s=>1-t(1-s),RA=xp(.33,1.53,.69,.99),iw=TA(RA),DA=OA(iw),IA=t=>(t*=2)<1?.5*iw(t):.5*(2-Math.pow(2,-10*(t-1))),ow=t=>1-Math.sin(Math.acos(t)),$A=TA(ow),LA=OA(ow),FA=t=>/^0[^.\s]+$/u.test(t);function E7(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||FA(t):!0}const lx=t=>Math.round(t*1e5)/1e5,dw=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function M7(t){return t==null}const P7=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,cw=(t,s)=>a=>!!(typeof a=="string"&&P7.test(a)&&a.startsWith(t)||s&&!M7(a)&&Object.prototype.hasOwnProperty.call(a,s)),UA=(t,s,a)=>l=>{if(typeof l!="string")return l;const[n,r,i,o]=l.match(dw);return{[t]:parseFloat(n),[s]:parseFloat(r),[a]:parseFloat(i),alpha:o!==void 0?parseFloat(o):1}},O7=t=>Di(0,255,t),dv={...Lu,transform:t=>Math.round(O7(t))},Od={test:cw("rgb","red"),parse:UA("red","green","blue"),transform:({red:t,green:s,blue:a,alpha:l=1})=>"rgba("+dv.transform(t)+", "+dv.transform(s)+", "+dv.transform(a)+", "+lx(Gx.transform(l))+")"};function T7(t){let s="",a="",l="",n="";return t.length>5?(s=t.substring(1,3),a=t.substring(3,5),l=t.substring(5,7),n=t.substring(7,9)):(s=t.substring(1,2),a=t.substring(2,3),l=t.substring(3,4),n=t.substring(4,5),s+=s,a+=a,l+=l,n+=n),{red:parseInt(s,16),green:parseInt(a,16),blue:parseInt(l,16),alpha:n?parseInt(n,16)/255:1}}const Gj={test:cw("#"),parse:T7,transform:Od.transform},Yc={test:cw("hsl","hue"),parse:UA("hue","saturation","lightness"),transform:({hue:t,saturation:s,lightness:a,alpha:l=1})=>"hsla("+Math.round(t)+", "+si.transform(lx(s))+", "+si.transform(lx(a))+", "+lx(Gx.transform(l))+")"},Rl={test:t=>Od.test(t)||Gj.test(t)||Yc.test(t),parse:t=>Od.test(t)?Od.parse(t):Yc.test(t)?Yc.parse(t):Gj.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Od.transform(t):Yc.transform(t)},R7=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function D7(t){var s,a;return isNaN(t)&&typeof t=="string"&&(((s=t.match(dw))===null||s===void 0?void 0:s.length)||0)+(((a=t.match(R7))===null||a===void 0?void 0:a.length)||0)>0}const VA="number",_A="color",I7="var",$7="var(",H1="${}",L7=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function zx(t){const s=t.toString(),a=[],l={color:[],number:[],var:[]},n=[];let r=0;const o=s.replace(L7,c=>(Rl.test(c)?(l.color.push(r),n.push(_A),a.push(Rl.parse(c))):c.startsWith($7)?(l.var.push(r),n.push(I7),a.push(c)):(l.number.push(r),n.push(VA),a.push(parseFloat(c))),++r,H1)).split(H1);return{values:a,split:o,indexes:l,types:n}}function BA(t){return zx(t).values}function GA(t){const{split:s,types:a}=zx(t),l=s.length;return n=>{let r="";for(let i=0;i<l;i++)if(r+=s[i],n[i]!==void 0){const o=a[i];o===VA?r+=lx(n[i]):o===_A?r+=Rl.transform(n[i]):r+=n[i]}return r}}const F7=t=>typeof t=="number"?0:t;function U7(t){const s=BA(t);return GA(t)(s.map(F7))}const _o={test:D7,parse:BA,createTransformer:GA,getAnimatableNone:U7},V7=new Set(["brightness","contrast","saturate","opacity"]);function _7(t){const[s,a]=t.slice(0,-1).split("(");if(s==="drop-shadow")return t;const[l]=a.match(dw)||[];if(!l)return t;const n=a.replace(l,"");let r=V7.has(s)?1:0;return l!==a&&(r*=100),s+"("+r+n+")"}const B7=/\b([a-z-]*)\(.*?\)/gu,qj={..._o,getAnimatableNone:t=>{const s=t.match(B7);return s?s.map(_7).join(" "):t}},G7={...XN,color:Rl,backgroundColor:Rl,outlineColor:Rl,fill:Rl,stroke:Rl,borderColor:Rl,borderTopColor:Rl,borderRightColor:Rl,borderBottomColor:Rl,borderLeftColor:Rl,filter:qj,WebkitFilter:qj},uw=t=>G7[t];function qA(t,s){let a=uw(t);return a!==qj&&(a=_o),a.getAnimatableNone?a.getAnimatableNone(s):void 0}const q7=new Set(["auto","none","0"]);function z7(t,s,a){let l=0,n;for(;l<t.length&&!n;){const r=t[l];typeof r=="string"&&!q7.has(r)&&zx(r).values.length&&(n=t[l]),l++}if(n&&a)for(const r of s)t[r]=qA(a,n)}const X1=t=>t===Lu||t===Ot,K1=(t,s)=>parseFloat(t.split(", ")[s]),Q1=(t,s)=>(a,{transform:l})=>{if(l==="none"||!l)return 0;const n=l.match(/^matrix3d\((.+)\)$/u);if(n)return K1(n[1],s);{const r=l.match(/^matrix\((.+)\)$/u);return r?K1(r[1],t):0}},W7=new Set(["x","y","z"]),H7=$u.filter(t=>!W7.has(t));function X7(t){const s=[];return H7.forEach(a=>{const l=t.getValue(a);l!==void 0&&(s.push([a,l.get()]),l.set(a.startsWith("scale")?1:0))}),s}const Cu={width:({x:t},{paddingLeft:s="0",paddingRight:a="0"})=>t.max-t.min-parseFloat(s)-parseFloat(a),height:({y:t},{paddingTop:s="0",paddingBottom:a="0"})=>t.max-t.min-parseFloat(s)-parseFloat(a),top:(t,{top:s})=>parseFloat(s),left:(t,{left:s})=>parseFloat(s),bottom:({y:t},{top:s})=>parseFloat(s)+(t.max-t.min),right:({x:t},{left:s})=>parseFloat(s)+(t.max-t.min),x:Q1(4,13),y:Q1(5,14)};Cu.translateX=Cu.x;Cu.translateY=Cu.y;const Id=new Set;let zj=!1,Wj=!1;function zA(){if(Wj){const t=Array.from(Id).filter(l=>l.needsMeasurement),s=new Set(t.map(l=>l.element)),a=new Map;s.forEach(l=>{const n=X7(l);n.length&&(a.set(l,n),l.render())}),t.forEach(l=>l.measureInitialState()),s.forEach(l=>{l.render();const n=a.get(l);n&&n.forEach(([r,i])=>{var o;(o=l.getValue(r))===null||o===void 0||o.set(i)})}),t.forEach(l=>l.measureEndState()),t.forEach(l=>{l.suspendedScrollY!==void 0&&window.scrollTo(0,l.suspendedScrollY)})}Wj=!1,zj=!1,Id.forEach(t=>t.complete()),Id.clear()}function WA(){Id.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Wj=!0)})}function K7(){WA(),zA()}class mw{constructor(s,a,l,n,r,i=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...s],this.onComplete=a,this.name=l,this.motionValue=n,this.element=r,this.isAsync=i}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Id.add(this),zj||(zj=!0,Qs.read(WA),Qs.resolveKeyframes(zA))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:s,name:a,element:l,motionValue:n}=this;for(let r=0;r<s.length;r++)if(s[r]===null)if(r===0){const i=n==null?void 0:n.get(),o=s[s.length-1];if(i!==void 0)s[0]=i;else if(l&&a){const c=l.readValue(a,o);c!=null&&(s[0]=c)}s[0]===void 0&&(s[0]=o),n&&i===void 0&&n.set(s[0])}else s[r]=s[r-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Id.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Id.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const HA=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),Q7=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Y7(t){const s=Q7.exec(t);if(!s)return[,];const[,a,l,n]=s;return[`--${a??l}`,n]}function XA(t,s,a=1){const[l,n]=Y7(t);if(!l)return;const r=window.getComputedStyle(s).getPropertyValue(l);if(r){const i=r.trim();return HA(i)?parseFloat(i):i}return HN(n)?XA(n,s,a+1):n}const KA=t=>s=>s.test(t),J7={test:t=>t==="auto",parse:t=>t},QA=[Lu,Ot,si,mo,_$,V$,J7],Y1=t=>QA.find(KA(t));class YA extends mw{constructor(s,a,l,n,r){super(s,a,l,n,r,!0)}readKeyframes(){const{unresolvedKeyframes:s,element:a,name:l}=this;if(!a||!a.current)return;super.readKeyframes();for(let c=0;c<s.length;c++){let x=s[c];if(typeof x=="string"&&(x=x.trim(),HN(x))){const j=XA(x,a.current);j!==void 0&&(s[c]=j),c===s.length-1&&(this.finalKeyframe=x)}}if(this.resolveNoneKeyframes(),!AA.has(l)||s.length!==2)return;const[n,r]=s,i=Y1(n),o=Y1(r);if(i!==o)if(X1(i)&&X1(o))for(let c=0;c<s.length;c++){const x=s[c];typeof x=="string"&&(s[c]=parseFloat(x))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:s,name:a}=this,l=[];for(let n=0;n<s.length;n++)E7(s[n])&&l.push(n);l.length&&z7(s,l,a)}measureInitialState(){const{element:s,unresolvedKeyframes:a,name:l}=this;if(!s||!s.current)return;l==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Cu[l](s.measureViewportBox(),window.getComputedStyle(s.current)),a[0]=this.measuredOrigin;const n=a[a.length-1];n!==void 0&&s.getValue(l,n).jump(n,!1)}measureEndState(){var s;const{element:a,name:l,unresolvedKeyframes:n}=this;if(!a||!a.current)return;const r=a.getValue(l);r&&r.jump(this.measuredOrigin,!1);const i=n.length-1,o=n[i];n[i]=Cu[l](a.measureViewportBox(),window.getComputedStyle(a.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),!((s=this.removedTransforms)===null||s===void 0)&&s.length&&this.removedTransforms.forEach(([c,x])=>{a.getValue(c).set(x)}),this.resolveNoneKeyframes()}}const J1=(t,s)=>s==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(_o.test(t)||t==="0")&&!t.startsWith("url("));function Z7(t){const s=t[0];if(t.length===1)return!0;for(let a=0;a<t.length;a++)if(t[a]!==s)return!0}function e8(t,s,a,l){const n=t[0];if(n===null)return!1;if(s==="display"||s==="visibility")return!0;const r=t[t.length-1],i=J1(n,s),o=J1(r,s);return!i||!o?!1:Z7(t)||(a==="spring"||tw(a))&&l}const t8=t=>t!==null;function kf(t,{repeat:s,repeatType:a="loop"},l){const n=t.filter(t8),r=s&&a!=="loop"&&s%2===1?0:n.length-1;return!r||l===void 0?n[r]:l}const s8=40;class JA{constructor({autoplay:s=!0,delay:a=0,type:l="keyframes",repeat:n=0,repeatDelay:r=0,repeatType:i="loop",...o}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=ai.now(),this.options={autoplay:s,delay:a,type:l,repeat:n,repeatDelay:r,repeatType:i,...o},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>s8?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&K7(),this._resolved}onKeyframesResolved(s,a){this.resolvedAt=ai.now(),this.hasAttemptedResolve=!0;const{name:l,type:n,velocity:r,delay:i,onComplete:o,onUpdate:c,isGenerator:x}=this.options;if(!x&&!e8(s,l,n,r))if(i)this.options.duration=0;else{c&&c(kf(s,this.options,a)),o&&o(),this.resolveFinishedPromise();return}const j=this.initPlayback(s,a);j!==!1&&(this._resolved={keyframes:s,finalKeyframe:a,...j},this.onPostResolved())}onPostResolved(){}then(s,a){return this.currentFinishedPromise.then(s,a)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(s=>{this.resolveFinishedPromise=s})}}const ua=(t,s,a)=>t+(s-t)*a;function cv(t,s,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?t+(s-t)*6*a:a<1/2?s:a<2/3?t+(s-t)*(2/3-a)*6:t}function a8({hue:t,saturation:s,lightness:a,alpha:l}){t/=360,s/=100,a/=100;let n=0,r=0,i=0;if(!s)n=r=i=a;else{const o=a<.5?a*(1+s):a+s-a*s,c=2*a-o;n=cv(c,o,t+1/3),r=cv(c,o,t),i=cv(c,o,t-1/3)}return{red:Math.round(n*255),green:Math.round(r*255),blue:Math.round(i*255),alpha:l}}function sg(t,s){return a=>a>0?s:t}const uv=(t,s,a)=>{const l=t*t,n=a*(s*s-l)+l;return n<0?0:Math.sqrt(n)},l8=[Gj,Od,Yc],n8=t=>l8.find(s=>s.test(t));function Z1(t){const s=n8(t);if(!s)return!1;let a=s.parse(t);return s===Yc&&(a=a8(a)),a}const ek=(t,s)=>{const a=Z1(t),l=Z1(s);if(!a||!l)return sg(t,s);const n={...a};return r=>(n.red=uv(a.red,l.red,r),n.green=uv(a.green,l.green,r),n.blue=uv(a.blue,l.blue,r),n.alpha=ua(a.alpha,l.alpha,r),Od.transform(n))},r8=(t,s)=>a=>s(t(a)),pp=(...t)=>t.reduce(r8),Hj=new Set(["none","hidden"]);function i8(t,s){return Hj.has(t)?a=>a<=0?t:s:a=>a>=1?s:t}function o8(t,s){return a=>ua(t,s,a)}function xw(t){return typeof t=="number"?o8:typeof t=="string"?HN(t)?sg:Rl.test(t)?ek:u8:Array.isArray(t)?ZA:typeof t=="object"?Rl.test(t)?ek:d8:sg}function ZA(t,s){const a=[...t],l=a.length,n=t.map((r,i)=>xw(r)(r,s[i]));return r=>{for(let i=0;i<l;i++)a[i]=n[i](r);return a}}function d8(t,s){const a={...t,...s},l={};for(const n in a)t[n]!==void 0&&s[n]!==void 0&&(l[n]=xw(t[n])(t[n],s[n]));return n=>{for(const r in l)a[r]=l[r](n);return a}}function c8(t,s){var a;const l=[],n={color:0,var:0,number:0};for(let r=0;r<s.values.length;r++){const i=s.types[r],o=t.indexes[i][n[i]],c=(a=t.values[o])!==null&&a!==void 0?a:0;l[r]=c,n[i]++}return l}const u8=(t,s)=>{const a=_o.createTransformer(s),l=zx(t),n=zx(s);return l.indexes.var.length===n.indexes.var.length&&l.indexes.color.length===n.indexes.color.length&&l.indexes.number.length>=n.indexes.number.length?Hj.has(t)&&!n.values.length||Hj.has(s)&&!l.values.length?i8(t,s):pp(ZA(c8(l,n),n.values),a):sg(t,s)};function eE(t,s,a){return typeof t=="number"&&typeof s=="number"&&typeof a=="number"?ua(t,s,a):xw(t)(t,s)}const m8=5;function tE(t,s,a){const l=Math.max(s-m8,0);return EA(a-t(l),s-l)}const fa={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},mv=.001;function x8({duration:t=fa.duration,bounce:s=fa.bounce,velocity:a=fa.velocity,mass:l=fa.mass}){let n,r,i=1-s;i=Di(fa.minDamping,fa.maxDamping,i),t=Di(fa.minDuration,fa.maxDuration,Ei(t)),i<1?(n=x=>{const j=x*i,g=j*t,N=j-a,$=Xj(x,i),T=Math.exp(-g);return mv-N/$*T},r=x=>{const g=x*i*t,N=g*a+a,$=Math.pow(i,2)*Math.pow(x,2)*t,T=Math.exp(-g),k=Xj(Math.pow(x,2),i);return(-n(x)+mv>0?-1:1)*((N-$)*T)/k}):(n=x=>{const j=Math.exp(-x*t),g=(x-a)*t+1;return-mv+j*g},r=x=>{const j=Math.exp(-x*t),g=(a-x)*(t*t);return j*g});const o=5/t,c=h8(n,r,o);if(t=Ai(t),isNaN(c))return{stiffness:fa.stiffness,damping:fa.damping,duration:t};{const x=Math.pow(c,2)*l;return{stiffness:x,damping:i*2*Math.sqrt(l*x),duration:t}}}const p8=12;function h8(t,s,a){let l=a;for(let n=1;n<p8;n++)l=l-t(l)/s(l);return l}function Xj(t,s){return t*Math.sqrt(1-s*s)}const g8=["duration","bounce"],f8=["stiffness","damping","mass"];function tk(t,s){return s.some(a=>t[a]!==void 0)}function v8(t){let s={velocity:fa.velocity,stiffness:fa.stiffness,damping:fa.damping,mass:fa.mass,isResolvedFromDuration:!1,...t};if(!tk(t,f8)&&tk(t,g8))if(t.visualDuration){const a=t.visualDuration,l=2*Math.PI/(a*1.2),n=l*l,r=2*Di(.05,1,1-(t.bounce||0))*Math.sqrt(n);s={...s,mass:fa.mass,stiffness:n,damping:r}}else{const a=x8(t);s={...s,...a,mass:fa.mass},s.isResolvedFromDuration=!0}return s}function sE(t=fa.visualDuration,s=fa.bounce){const a=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:s}:t;let{restSpeed:l,restDelta:n}=a;const r=a.keyframes[0],i=a.keyframes[a.keyframes.length-1],o={done:!1,value:r},{stiffness:c,damping:x,mass:j,duration:g,velocity:N,isResolvedFromDuration:$}=v8({...a,velocity:-Ei(a.velocity||0)}),T=N||0,k=x/(2*Math.sqrt(c*j)),q=i-r,L=Ei(Math.sqrt(c/j)),R=Math.abs(q)<5;l||(l=R?fa.restSpeed.granular:fa.restSpeed.default),n||(n=R?fa.restDelta.granular:fa.restDelta.default);let U;if(k<1){const ie=Xj(L,k);U=_=>{const W=Math.exp(-k*L*_);return i-W*((T+k*L*q)/ie*Math.sin(ie*_)+q*Math.cos(ie*_))}}else if(k===1)U=ie=>i-Math.exp(-L*ie)*(q+(T+L*q)*ie);else{const ie=L*Math.sqrt(k*k-1);U=_=>{const W=Math.exp(-k*L*_),J=Math.min(ie*_,300);return i-W*((T+k*L*q)*Math.sinh(J)+ie*q*Math.cosh(J))/ie}}const ae={calculatedDuration:$&&g||null,next:ie=>{const _=U(ie);if($)o.done=ie>=g;else{let W=0;k<1&&(W=ie===0?Ai(T):tE(U,ie,_));const J=Math.abs(W)<=l,we=Math.abs(i-_)<=n;o.done=J&&we}return o.value=o.done?i:_,o},toString:()=>{const ie=Math.min(jA(ae),Vj),_=yA(W=>ae.next(ie*W).value,ie,30);return ie+"ms "+_}};return ae}function sk({keyframes:t,velocity:s=0,power:a=.8,timeConstant:l=325,bounceDamping:n=10,bounceStiffness:r=500,modifyTarget:i,min:o,max:c,restDelta:x=.5,restSpeed:j}){const g=t[0],N={done:!1,value:g},$=J=>o!==void 0&&J<o||c!==void 0&&J>c,T=J=>o===void 0?c:c===void 0||Math.abs(o-J)<Math.abs(c-J)?o:c;let k=a*s;const q=g+k,L=i===void 0?q:i(q);L!==q&&(k=L-g);const R=J=>-k*Math.exp(-J/l),U=J=>L+R(J),ae=J=>{const we=R(J),G=U(J);N.done=Math.abs(we)<=x,N.value=N.done?L:G};let ie,_;const W=J=>{$(N.value)&&(ie=J,_=sE({keyframes:[N.value,T(N.value)],velocity:tE(U,J,N.value),damping:n,stiffness:r,restDelta:x,restSpeed:j}))};return W(0),{calculatedDuration:null,next:J=>{let we=!1;return!_&&ie===void 0&&(we=!0,ae(J),W(J)),ie!==void 0&&J>=ie?_.next(J-ie):(!we&&ae(J),N)}}}const b8=xp(.42,0,1,1),j8=xp(0,0,.58,1),aE=xp(.42,0,.58,1),y8=t=>Array.isArray(t)&&typeof t[0]!="number",N8={linear:Rn,easeIn:b8,easeInOut:aE,easeOut:j8,circIn:ow,circInOut:LA,circOut:$A,backIn:iw,backInOut:DA,backOut:RA,anticipate:IA},ak=t=>{if(sw(t)){eA(t.length===4);const[s,a,l,n]=t;return xp(s,a,l,n)}else if(typeof t=="string")return N8[t];return t};function w8(t,s,a){const l=[],n=a||eE,r=t.length-1;for(let i=0;i<r;i++){let o=n(t[i],t[i+1]);if(s){const c=Array.isArray(s)?s[i]||Rn:s;o=pp(c,o)}l.push(o)}return l}function k8(t,s,{clamp:a=!0,ease:l,mixer:n}={}){const r=t.length;if(eA(r===s.length),r===1)return()=>s[0];if(r===2&&s[0]===s[1])return()=>s[1];const i=t[0]===t[1];t[0]>t[r-1]&&(t=[...t].reverse(),s=[...s].reverse());const o=w8(s,l,n),c=o.length,x=j=>{if(i&&j<t[0])return s[0];let g=0;if(c>1)for(;g<t.length-2&&!(j<t[g+1]);g++);const N=wu(t[g],t[g+1],j);return o[g](N)};return a?j=>x(Di(t[0],t[r-1],j)):x}function C8(t,s){const a=t[t.length-1];for(let l=1;l<=s;l++){const n=wu(0,s,l);t.push(ua(a,1,n))}}function S8(t){const s=[0];return C8(s,t.length-1),s}function A8(t,s){return t.map(a=>a*s)}function E8(t,s){return t.map(()=>s||aE).splice(0,t.length-1)}function ag({duration:t=300,keyframes:s,times:a,ease:l="easeInOut"}){const n=y8(l)?l.map(ak):ak(l),r={done:!1,value:s[0]},i=A8(a&&a.length===s.length?a:S8(s),t),o=k8(i,s,{ease:Array.isArray(n)?n:E8(s,n)});return{calculatedDuration:t,next:c=>(r.value=o(c),r.done=c>=t,r)}}const M8=t=>{const s=({timestamp:a})=>t(a);return{start:()=>Qs.update(s,!0),stop:()=>Vo(s),now:()=>bl.isProcessing?bl.timestamp:ai.now()}},P8={decay:sk,inertia:sk,tween:ag,keyframes:ag,spring:sE},O8=t=>t/100;class pw extends JA{constructor(s){super(s),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:c}=this.options;c&&c()};const{name:a,motionValue:l,element:n,keyframes:r}=this.options,i=(n==null?void 0:n.KeyframeResolver)||mw,o=(c,x)=>this.onKeyframesResolved(c,x);this.resolver=new i(r,o,a,l,n),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(s){const{type:a="keyframes",repeat:l=0,repeatDelay:n=0,repeatType:r,velocity:i=0}=this.options,o=tw(a)?a:P8[a]||ag;let c,x;o!==ag&&typeof s[0]!="number"&&(c=pp(O8,eE(s[0],s[1])),s=[0,100]);const j=o({...this.options,keyframes:s});r==="mirror"&&(x=o({...this.options,keyframes:[...s].reverse(),velocity:-i})),j.calculatedDuration===null&&(j.calculatedDuration=jA(j));const{calculatedDuration:g}=j,N=g+n,$=N*(l+1)-n;return{generator:j,mirroredGenerator:x,mapPercentToKeyframes:c,calculatedDuration:g,resolvedDuration:N,totalDuration:$}}onPostResolved(){const{autoplay:s=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!s?this.pause():this.state=this.pendingPlayState}tick(s,a=!1){const{resolved:l}=this;if(!l){const{keyframes:J}=this.options;return{done:!0,value:J[J.length-1]}}const{finalKeyframe:n,generator:r,mirroredGenerator:i,mapPercentToKeyframes:o,keyframes:c,calculatedDuration:x,totalDuration:j,resolvedDuration:g}=l;if(this.startTime===null)return r.next(0);const{delay:N,repeat:$,repeatType:T,repeatDelay:k,onUpdate:q}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,s):this.speed<0&&(this.startTime=Math.min(s-j/this.speed,this.startTime)),a?this.currentTime=s:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(s-this.startTime)*this.speed;const L=this.currentTime-N*(this.speed>=0?1:-1),R=this.speed>=0?L<0:L>j;this.currentTime=Math.max(L,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=j);let U=this.currentTime,ae=r;if($){const J=Math.min(this.currentTime,j)/g;let we=Math.floor(J),G=J%1;!G&&J>=1&&(G=1),G===1&&we--,we=Math.min(we,$+1),!!(we%2)&&(T==="reverse"?(G=1-G,k&&(G-=k/g)):T==="mirror"&&(ae=i)),U=Di(0,1,G)*g}const ie=R?{done:!1,value:c[0]}:ae.next(U);o&&(ie.value=o(ie.value));let{done:_}=ie;!R&&x!==null&&(_=this.speed>=0?this.currentTime>=j:this.currentTime<=0);const W=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&_);return W&&n!==void 0&&(ie.value=kf(c,this.options,n)),q&&q(ie.value),W&&this.finish(),ie}get duration(){const{resolved:s}=this;return s?Ei(s.calculatedDuration):0}get time(){return Ei(this.currentTime)}set time(s){s=Ai(s),this.currentTime=s,this.holdTime!==null||this.speed===0?this.holdTime=s:this.driver&&(this.startTime=this.driver.now()-s/this.speed)}get speed(){return this.playbackSpeed}set speed(s){const a=this.playbackSpeed!==s;this.playbackSpeed=s,a&&(this.time=Ei(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:s=M8,onPlay:a,startTime:l}=this.options;this.driver||(this.driver=s(r=>this.tick(r))),a&&a();const n=this.driver.now();this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=n):this.startTime=l??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var s;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(s=this.currentTime)!==null&&s!==void 0?s:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:s}=this.options;s&&s()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(s){return this.startTime=0,this.tick(s,!0)}}const T8=new Set(["opacity","clipPath","filter","transform"]);function R8(t,s,a,{delay:l=0,duration:n=300,repeat:r=0,repeatType:i="loop",ease:o="easeInOut",times:c}={}){const x={[s]:a};c&&(x.offset=c);const j=wA(o,n);return Array.isArray(j)&&(x.easing=j),t.animate(x,{delay:l,duration:n,easing:Array.isArray(j)?"linear":j,fill:"both",iterations:r+1,direction:i==="reverse"?"alternate":"normal"})}const D8=VN(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),lg=10,I8=2e4;function $8(t){return tw(t.type)||t.type==="spring"||!NA(t.ease)}function L8(t,s){const a=new pw({...s,keyframes:t,repeat:0,delay:0,isGenerator:!0});let l={done:!1,value:t[0]};const n=[];let r=0;for(;!l.done&&r<I8;)l=a.sample(r),n.push(l.value),r+=lg;return{times:void 0,keyframes:n,duration:r-lg,ease:"linear"}}const lE={anticipate:IA,backInOut:DA,circInOut:LA};function F8(t){return t in lE}class lk extends JA{constructor(s){super(s);const{name:a,motionValue:l,element:n,keyframes:r}=this.options;this.resolver=new YA(r,(i,o)=>this.onKeyframesResolved(i,o),a,l,n),this.resolver.scheduleResolve()}initPlayback(s,a){let{duration:l=300,times:n,ease:r,type:i,motionValue:o,name:c,startTime:x}=this.options;if(!o.owner||!o.owner.current)return!1;if(typeof r=="string"&&tg()&&F8(r)&&(r=lE[r]),$8(this.options)){const{onComplete:g,onUpdate:N,motionValue:$,element:T,...k}=this.options,q=L8(s,k);s=q.keyframes,s.length===1&&(s[1]=s[0]),l=q.duration,n=q.times,r=q.ease,i="keyframes"}const j=R8(o.owner.current,c,s,{...this.options,duration:l,times:n,ease:r});return j.startTime=x??this.calcStartTime(),this.pendingTimeline?(B1(j,this.pendingTimeline),this.pendingTimeline=void 0):j.onfinish=()=>{const{onComplete:g}=this.options;o.set(kf(s,this.options,a)),g&&g(),this.cancel(),this.resolveFinishedPromise()},{animation:j,duration:l,times:n,type:i,ease:r,keyframes:s}}get duration(){const{resolved:s}=this;if(!s)return 0;const{duration:a}=s;return Ei(a)}get time(){const{resolved:s}=this;if(!s)return 0;const{animation:a}=s;return Ei(a.currentTime||0)}set time(s){const{resolved:a}=this;if(!a)return;const{animation:l}=a;l.currentTime=Ai(s)}get speed(){const{resolved:s}=this;if(!s)return 1;const{animation:a}=s;return a.playbackRate}set speed(s){const{resolved:a}=this;if(!a)return;const{animation:l}=a;l.playbackRate=s}get state(){const{resolved:s}=this;if(!s)return"idle";const{animation:a}=s;return a.playState}get startTime(){const{resolved:s}=this;if(!s)return null;const{animation:a}=s;return a.startTime}attachTimeline(s){if(!this._resolved)this.pendingTimeline=s;else{const{resolved:a}=this;if(!a)return Rn;const{animation:l}=a;B1(l,s)}return Rn}play(){if(this.isStopped)return;const{resolved:s}=this;if(!s)return;const{animation:a}=s;a.playState==="finished"&&this.updateFinishedPromise(),a.play()}pause(){const{resolved:s}=this;if(!s)return;const{animation:a}=s;a.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:s}=this;if(!s)return;const{animation:a,keyframes:l,duration:n,type:r,ease:i,times:o}=s;if(a.playState==="idle"||a.playState==="finished")return;if(this.time){const{motionValue:x,onUpdate:j,onComplete:g,element:N,...$}=this.options,T=new pw({...$,keyframes:l,duration:n,type:r,ease:i,times:o,isGenerator:!0}),k=Ai(this.time);x.setWithVelocity(T.sample(k-lg).value,T.sample(k).value,lg)}const{onStop:c}=this.options;c&&c(),this.cancel()}complete(){const{resolved:s}=this;s&&s.animation.finish()}cancel(){const{resolved:s}=this;s&&s.animation.cancel()}static supports(s){const{motionValue:a,name:l,repeatDelay:n,repeatType:r,damping:i,type:o}=s;if(!a||!a.owner||!(a.owner.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:x}=a.owner.getProps();return D8()&&l&&T8.has(l)&&!c&&!x&&!n&&r!=="mirror"&&i!==0&&o!=="inertia"}}const U8={type:"spring",stiffness:500,damping:25,restSpeed:10},V8=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),_8={type:"keyframes",duration:.8},B8={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},G8=(t,{keyframes:s})=>s.length>2?_8:Kd.has(t)?t.startsWith("scale")?V8(s[1]):U8:B8;function q8({when:t,delay:s,delayChildren:a,staggerChildren:l,staggerDirection:n,repeat:r,repeatType:i,repeatDelay:o,from:c,elapsed:x,...j}){return!!Object.keys(j).length}const hw=(t,s,a,l={},n,r)=>i=>{const o=ew(l,t)||{},c=o.delay||l.delay||0;let{elapsed:x=0}=l;x=x-Ai(c);let j={keyframes:Array.isArray(a)?a:[null,a],ease:"easeOut",velocity:s.getVelocity(),...o,delay:-x,onUpdate:N=>{s.set(N),o.onUpdate&&o.onUpdate(N)},onComplete:()=>{i(),o.onComplete&&o.onComplete()},name:t,motionValue:s,element:r?void 0:n};q8(o)||(j={...j,...G8(t,j)}),j.duration&&(j.duration=Ai(j.duration)),j.repeatDelay&&(j.repeatDelay=Ai(j.repeatDelay)),j.from!==void 0&&(j.keyframes[0]=j.from);let g=!1;if((j.type===!1||j.duration===0&&!j.repeatDelay)&&(j.duration=0,j.delay===0&&(g=!0)),g&&!r&&s.get()!==void 0){const N=kf(j.keyframes,o);if(N!==void 0)return Qs.update(()=>{j.onUpdate(N),j.onComplete()}),new d7([])}return!r&&lk.supports(j)?new lk(j):new pw(j)};function z8({protectedKeys:t,needsAnimating:s},a){const l=t.hasOwnProperty(a)&&s[a]!==!0;return s[a]=!1,l}function nE(t,s,{delay:a=0,transitionOverride:l,type:n}={}){var r;let{transition:i=t.getDefaultTransition(),transitionEnd:o,...c}=s;l&&(i=l);const x=[],j=n&&t.animationState&&t.animationState.getState()[n];for(const g in c){const N=t.getValue(g,(r=t.latestValues[g])!==null&&r!==void 0?r:null),$=c[g];if($===void 0||j&&z8(j,g))continue;const T={delay:a,...ew(i||{},g)};let k=!1;if(window.MotionHandoffAnimation){const L=MA(t);if(L){const R=window.MotionHandoffAnimation(L,g,Qs);R!==null&&(T.startTime=R,k=!0)}}Bj(t,g),N.start(hw(g,N,$,t.shouldReduceMotion&&AA.has(g)?{type:!1}:T,t,k));const q=N.animation;q&&x.push(q)}return o&&Promise.all(x).then(()=>{Qs.update(()=>{o&&w7(t,o)})}),x}function Kj(t,s,a={}){var l;const n=wf(t,s,a.type==="exit"?(l=t.presenceContext)===null||l===void 0?void 0:l.custom:void 0);let{transition:r=t.getDefaultTransition()||{}}=n||{};a.transitionOverride&&(r=a.transitionOverride);const i=n?()=>Promise.all(nE(t,n,a)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(x=0)=>{const{delayChildren:j=0,staggerChildren:g,staggerDirection:N}=r;return W8(t,s,j+x,g,N,a)}:()=>Promise.resolve(),{when:c}=r;if(c){const[x,j]=c==="beforeChildren"?[i,o]:[o,i];return x().then(()=>j())}else return Promise.all([i(),o(a.delay)])}function W8(t,s,a=0,l=0,n=1,r){const i=[],o=(t.variantChildren.size-1)*l,c=n===1?(x=0)=>x*l:(x=0)=>o-x*l;return Array.from(t.variantChildren).sort(H8).forEach((x,j)=>{x.notify("AnimationStart",s),i.push(Kj(x,s,{...r,delay:a+c(j)}).then(()=>x.notify("AnimationComplete",s)))}),Promise.all(i)}function H8(t,s){return t.sortNodePosition(s)}function X8(t,s,a={}){t.notify("AnimationStart",s);let l;if(Array.isArray(s)){const n=s.map(r=>Kj(t,r,a));l=Promise.all(n)}else if(typeof s=="string")l=Kj(t,s,a);else{const n=typeof s=="function"?wf(t,s,a.custom):s;l=Promise.all(nE(t,n,a))}return l.then(()=>{t.notify("AnimationComplete",s)})}const K8=BN.length;function rE(t){if(!t)return;if(!t.isControllingVariants){const a=t.parent?rE(t.parent)||{}:{};return t.props.initial!==void 0&&(a.initial=t.props.initial),a}const s={};for(let a=0;a<K8;a++){const l=BN[a],n=t.props[l];(Bx(n)||n===!1)&&(s[l]=n)}return s}const Q8=[..._N].reverse(),Y8=_N.length;function J8(t){return s=>Promise.all(s.map(({animation:a,options:l})=>X8(t,a,l)))}function Z8(t){let s=J8(t),a=nk(),l=!0;const n=c=>(x,j)=>{var g;const N=wf(t,j,c==="exit"?(g=t.presenceContext)===null||g===void 0?void 0:g.custom:void 0);if(N){const{transition:$,transitionEnd:T,...k}=N;x={...x,...k,...T}}return x};function r(c){s=c(t)}function i(c){const{props:x}=t,j=rE(t.parent)||{},g=[],N=new Set;let $={},T=1/0;for(let q=0;q<Y8;q++){const L=Q8[q],R=a[L],U=x[L]!==void 0?x[L]:j[L],ae=Bx(U),ie=L===c?R.isActive:null;ie===!1&&(T=q);let _=U===j[L]&&U!==x[L]&&ae;if(_&&l&&t.manuallyAnimateOnMount&&(_=!1),R.protectedKeys={...$},!R.isActive&&ie===null||!U&&!R.prevProp||yf(U)||typeof U=="boolean")continue;const W=eL(R.prevProp,U);let J=W||L===c&&R.isActive&&!_&&ae||q>T&&ae,we=!1;const G=Array.isArray(U)?U:[U];let be=G.reduce(n(L),{});ie===!1&&(be={});const{prevResolvedValues:Ge={}}=R,Me={...Ge,...be},je=he=>{J=!0,N.has(he)&&(we=!0,N.delete(he)),R.needsAnimating[he]=!0;const Y=t.getValue(he);Y&&(Y.liveStyle=!1)};for(const he in Me){const Y=be[he],Ie=Ge[he];if($.hasOwnProperty(he))continue;let ce=!1;Uj(Y)&&Uj(Ie)?ce=!bA(Y,Ie):ce=Y!==Ie,ce?Y!=null?je(he):N.add(he):Y!==void 0&&N.has(he)?je(he):R.protectedKeys[he]=!0}R.prevProp=U,R.prevResolvedValues=be,R.isActive&&($={...$,...be}),l&&t.blockInitialAnimation&&(J=!1),J&&(!(_&&W)||we)&&g.push(...G.map(he=>({animation:he,options:{type:L}})))}if(N.size){const q={};N.forEach(L=>{const R=t.getBaseTarget(L),U=t.getValue(L);U&&(U.liveStyle=!0),q[L]=R??null}),g.push({animation:q})}let k=!!g.length;return l&&(x.initial===!1||x.initial===x.animate)&&!t.manuallyAnimateOnMount&&(k=!1),l=!1,k?s(g):Promise.resolve()}function o(c,x){var j;if(a[c].isActive===x)return Promise.resolve();(j=t.variantChildren)===null||j===void 0||j.forEach(N=>{var $;return($=N.animationState)===null||$===void 0?void 0:$.setActive(c,x)}),a[c].isActive=x;const g=i(c);for(const N in a)a[N].protectedKeys={};return g}return{animateChanges:i,setActive:o,setAnimateFunction:r,getState:()=>a,reset:()=>{a=nk(),l=!0}}}function eL(t,s){return typeof s=="string"?s!==t:Array.isArray(s)?!bA(s,t):!1}function Jo(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function nk(){return{animate:Jo(!0),whileInView:Jo(),whileHover:Jo(),whileTap:Jo(),whileDrag:Jo(),whileFocus:Jo(),exit:Jo()}}class Xo{constructor(s){this.isMounted=!1,this.node=s}update(){}}class tL extends Xo{constructor(s){super(s),s.animationState||(s.animationState=Z8(s))}updateAnimationControlsSubscription(){const{animate:s}=this.node.getProps();yf(s)&&(this.unmountControls=s.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:s}=this.node.getProps(),{animate:a}=this.node.prevProps||{};s!==a&&this.updateAnimationControlsSubscription()}unmount(){var s;this.node.animationState.reset(),(s=this.unmountControls)===null||s===void 0||s.call(this)}}let sL=0;class aL extends Xo{constructor(){super(...arguments),this.id=sL++}update(){if(!this.node.presenceContext)return;const{isPresent:s,onExitComplete:a}=this.node.presenceContext,{isPresent:l}=this.node.prevPresenceContext||{};if(!this.node.animationState||s===l)return;const n=this.node.animationState.setActive("exit",!s);a&&!s&&n.then(()=>a(this.id))}mount(){const{register:s}=this.node.presenceContext||{};s&&(this.unmount=s(this.id))}unmount(){}}const lL={animation:{Feature:tL},exit:{Feature:aL}};function Wx(t,s,a,l={passive:!0}){return t.addEventListener(s,a,l),()=>t.removeEventListener(s,a)}function hp(t){return{point:{x:t.pageX,y:t.pageY}}}const nL=t=>s=>aw(s)&&t(s,hp(s));function nx(t,s,a,l){return Wx(t,s,nL(a),l)}const rk=(t,s)=>Math.abs(t-s);function rL(t,s){const a=rk(t.x,s.x),l=rk(t.y,s.y);return Math.sqrt(a**2+l**2)}class iE{constructor(s,a,{transformPagePoint:l,contextWindow:n,dragSnapToOrigin:r=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=pv(this.lastMoveEventInfo,this.history),N=this.startEvent!==null,$=rL(g.offset,{x:0,y:0})>=3;if(!N&&!$)return;const{point:T}=g,{timestamp:k}=bl;this.history.push({...T,timestamp:k});const{onStart:q,onMove:L}=this.handlers;N||(q&&q(this.lastMoveEvent,g),this.startEvent=this.lastMoveEvent),L&&L(this.lastMoveEvent,g)},this.handlePointerMove=(g,N)=>{this.lastMoveEvent=g,this.lastMoveEventInfo=xv(N,this.transformPagePoint),Qs.update(this.updatePoint,!0)},this.handlePointerUp=(g,N)=>{this.end();const{onEnd:$,onSessionEnd:T,resumeAnimation:k}=this.handlers;if(this.dragSnapToOrigin&&k&&k(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const q=pv(g.type==="pointercancel"?this.lastMoveEventInfo:xv(N,this.transformPagePoint),this.history);this.startEvent&&$&&$(g,q),T&&T(g,q)},!aw(s))return;this.dragSnapToOrigin=r,this.handlers=a,this.transformPagePoint=l,this.contextWindow=n||window;const i=hp(s),o=xv(i,this.transformPagePoint),{point:c}=o,{timestamp:x}=bl;this.history=[{...c,timestamp:x}];const{onSessionStart:j}=a;j&&j(s,pv(o,this.history)),this.removeListeners=pp(nx(this.contextWindow,"pointermove",this.handlePointerMove),nx(this.contextWindow,"pointerup",this.handlePointerUp),nx(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(s){this.handlers=s}end(){this.removeListeners&&this.removeListeners(),Vo(this.updatePoint)}}function xv(t,s){return s?{point:s(t.point)}:t}function ik(t,s){return{x:t.x-s.x,y:t.y-s.y}}function pv({point:t},s){return{point:t,delta:ik(t,oE(s)),offset:ik(t,iL(s)),velocity:oL(s,.1)}}function iL(t){return t[0]}function oE(t){return t[t.length-1]}function oL(t,s){if(t.length<2)return{x:0,y:0};let a=t.length-1,l=null;const n=oE(t);for(;a>=0&&(l=t[a],!(n.timestamp-l.timestamp>Ai(s)));)a--;if(!l)return{x:0,y:0};const r=Ei(n.timestamp-l.timestamp);if(r===0)return{x:0,y:0};const i={x:(n.x-l.x)/r,y:(n.y-l.y)/r};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}const dE=1e-4,dL=1-dE,cL=1+dE,cE=.01,uL=0-cE,mL=0+cE;function $n(t){return t.max-t.min}function xL(t,s,a){return Math.abs(t-s)<=a}function ok(t,s,a,l=.5){t.origin=l,t.originPoint=ua(s.min,s.max,t.origin),t.scale=$n(a)/$n(s),t.translate=ua(a.min,a.max,t.origin)-t.originPoint,(t.scale>=dL&&t.scale<=cL||isNaN(t.scale))&&(t.scale=1),(t.translate>=uL&&t.translate<=mL||isNaN(t.translate))&&(t.translate=0)}function rx(t,s,a,l){ok(t.x,s.x,a.x,l?l.originX:void 0),ok(t.y,s.y,a.y,l?l.originY:void 0)}function dk(t,s,a){t.min=a.min+s.min,t.max=t.min+$n(s)}function pL(t,s,a){dk(t.x,s.x,a.x),dk(t.y,s.y,a.y)}function ck(t,s,a){t.min=s.min-a.min,t.max=t.min+$n(s)}function ix(t,s,a){ck(t.x,s.x,a.x),ck(t.y,s.y,a.y)}function hL(t,{min:s,max:a},l){return s!==void 0&&t<s?t=l?ua(s,t,l.min):Math.max(t,s):a!==void 0&&t>a&&(t=l?ua(a,t,l.max):Math.min(t,a)),t}function uk(t,s,a){return{min:s!==void 0?t.min+s:void 0,max:a!==void 0?t.max+a-(t.max-t.min):void 0}}function gL(t,{top:s,left:a,bottom:l,right:n}){return{x:uk(t.x,a,n),y:uk(t.y,s,l)}}function mk(t,s){let a=s.min-t.min,l=s.max-t.max;return s.max-s.min<t.max-t.min&&([a,l]=[l,a]),{min:a,max:l}}function fL(t,s){return{x:mk(t.x,s.x),y:mk(t.y,s.y)}}function vL(t,s){let a=.5;const l=$n(t),n=$n(s);return n>l?a=wu(s.min,s.max-l,t.min):l>n&&(a=wu(t.min,t.max-n,s.min)),Di(0,1,a)}function bL(t,s){const a={};return s.min!==void 0&&(a.min=s.min-t.min),s.max!==void 0&&(a.max=s.max-t.min),a}const Qj=.35;function jL(t=Qj){return t===!1?t=0:t===!0&&(t=Qj),{x:xk(t,"left","right"),y:xk(t,"top","bottom")}}function xk(t,s,a){return{min:pk(t,s),max:pk(t,a)}}function pk(t,s){return typeof t=="number"?t:t[s]||0}const hk=()=>({translate:0,scale:1,origin:0,originPoint:0}),Jc=()=>({x:hk(),y:hk()}),gk=()=>({min:0,max:0}),Oa=()=>({x:gk(),y:gk()});function Hn(t){return[t("x"),t("y")]}function uE({top:t,left:s,right:a,bottom:l}){return{x:{min:s,max:a},y:{min:t,max:l}}}function yL({x:t,y:s}){return{top:s.min,right:t.max,bottom:s.max,left:t.min}}function NL(t,s){if(!s)return t;const a=s({x:t.left,y:t.top}),l=s({x:t.right,y:t.bottom});return{top:a.y,left:a.x,bottom:l.y,right:l.x}}function hv(t){return t===void 0||t===1}function Yj({scale:t,scaleX:s,scaleY:a}){return!hv(t)||!hv(s)||!hv(a)}function yd(t){return Yj(t)||mE(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function mE(t){return fk(t.x)||fk(t.y)}function fk(t){return t&&t!=="0%"}function ng(t,s,a){const l=t-a,n=s*l;return a+n}function vk(t,s,a,l,n){return n!==void 0&&(t=ng(t,n,l)),ng(t,a,l)+s}function Jj(t,s=0,a=1,l,n){t.min=vk(t.min,s,a,l,n),t.max=vk(t.max,s,a,l,n)}function xE(t,{x:s,y:a}){Jj(t.x,s.translate,s.scale,s.originPoint),Jj(t.y,a.translate,a.scale,a.originPoint)}const bk=.999999999999,jk=1.0000000000001;function wL(t,s,a,l=!1){const n=a.length;if(!n)return;s.x=s.y=1;let r,i;for(let o=0;o<n;o++){r=a[o],i=r.projectionDelta;const{visualElement:c}=r.options;c&&c.props.style&&c.props.style.display==="contents"||(l&&r.options.layoutScroll&&r.scroll&&r!==r.root&&eu(t,{x:-r.scroll.offset.x,y:-r.scroll.offset.y}),i&&(s.x*=i.x.scale,s.y*=i.y.scale,xE(t,i)),l&&yd(r.latestValues)&&eu(t,r.latestValues))}s.x<jk&&s.x>bk&&(s.x=1),s.y<jk&&s.y>bk&&(s.y=1)}function Zc(t,s){t.min=t.min+s,t.max=t.max+s}function yk(t,s,a,l,n=.5){const r=ua(t.min,t.max,n);Jj(t,s,a,r,l)}function eu(t,s){yk(t.x,s.x,s.scaleX,s.scale,s.originX),yk(t.y,s.y,s.scaleY,s.scale,s.originY)}function pE(t,s){return uE(NL(t.getBoundingClientRect(),s))}function kL(t,s,a){const l=pE(t,a),{scroll:n}=s;return n&&(Zc(l.x,n.offset.x),Zc(l.y,n.offset.y)),l}const hE=({current:t})=>t?t.ownerDocument.defaultView:null,CL=new WeakMap;class SL{constructor(s){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Oa(),this.visualElement=s}start(s,{snapToCursor:a=!1}={}){const{presenceContext:l}=this.visualElement;if(l&&l.isPresent===!1)return;const n=j=>{const{dragSnapToOrigin:g}=this.getProps();g?this.pauseAnimation():this.stopAnimation(),a&&this.snapToCursor(hp(j).point)},r=(j,g)=>{const{drag:N,dragPropagation:$,onDragStart:T}=this.getProps();if(N&&!$&&(this.openDragLock&&this.openDragLock(),this.openDragLock=v7(N),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Hn(q=>{let L=this.getAxisMotionValue(q).get()||0;if(si.test(L)){const{projection:R}=this.visualElement;if(R&&R.layout){const U=R.layout.layoutBox[q];U&&(L=$n(U)*(parseFloat(L)/100))}}this.originPoint[q]=L}),T&&Qs.postRender(()=>T(j,g)),Bj(this.visualElement,"transform");const{animationState:k}=this.visualElement;k&&k.setActive("whileDrag",!0)},i=(j,g)=>{const{dragPropagation:N,dragDirectionLock:$,onDirectionLock:T,onDrag:k}=this.getProps();if(!N&&!this.openDragLock)return;const{offset:q}=g;if($&&this.currentDirection===null){this.currentDirection=AL(q),this.currentDirection!==null&&T&&T(this.currentDirection);return}this.updateAxis("x",g.point,q),this.updateAxis("y",g.point,q),this.visualElement.render(),k&&k(j,g)},o=(j,g)=>this.stop(j,g),c=()=>Hn(j=>{var g;return this.getAnimationState(j)==="paused"&&((g=this.getAxisMotionValue(j).animation)===null||g===void 0?void 0:g.play())}),{dragSnapToOrigin:x}=this.getProps();this.panSession=new iE(s,{onSessionStart:n,onStart:r,onMove:i,onSessionEnd:o,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:x,contextWindow:hE(this.visualElement)})}stop(s,a){const l=this.isDragging;if(this.cancel(),!l)return;const{velocity:n}=a;this.startAnimation(n);const{onDragEnd:r}=this.getProps();r&&Qs.postRender(()=>r(s,a))}cancel(){this.isDragging=!1;const{projection:s,animationState:a}=this.visualElement;s&&(s.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:l}=this.getProps();!l&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),a&&a.setActive("whileDrag",!1)}updateAxis(s,a,l){const{drag:n}=this.getProps();if(!l||!_p(s,n,this.currentDirection))return;const r=this.getAxisMotionValue(s);let i=this.originPoint[s]+l[s];this.constraints&&this.constraints[s]&&(i=hL(i,this.constraints[s],this.elastic[s])),r.set(i)}resolveConstraints(){var s;const{dragConstraints:a,dragElastic:l}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(s=this.visualElement.projection)===null||s===void 0?void 0:s.layout,r=this.constraints;a&&Qc(a)?this.constraints||(this.constraints=this.resolveRefConstraints()):a&&n?this.constraints=gL(n.layoutBox,a):this.constraints=!1,this.elastic=jL(l),r!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&Hn(i=>{this.constraints!==!1&&this.getAxisMotionValue(i)&&(this.constraints[i]=bL(n.layoutBox[i],this.constraints[i]))})}resolveRefConstraints(){const{dragConstraints:s,onMeasureDragConstraints:a}=this.getProps();if(!s||!Qc(s))return!1;const l=s.current,{projection:n}=this.visualElement;if(!n||!n.layout)return!1;const r=kL(l,n.root,this.visualElement.getTransformPagePoint());let i=fL(n.layout.layoutBox,r);if(a){const o=a(yL(i));this.hasMutatedConstraints=!!o,o&&(i=uE(o))}return i}startAnimation(s){const{drag:a,dragMomentum:l,dragElastic:n,dragTransition:r,dragSnapToOrigin:i,onDragTransitionEnd:o}=this.getProps(),c=this.constraints||{},x=Hn(j=>{if(!_p(j,a,this.currentDirection))return;let g=c&&c[j]||{};i&&(g={min:0,max:0});const N=n?200:1e6,$=n?40:1e7,T={type:"inertia",velocity:l?s[j]:0,bounceStiffness:N,bounceDamping:$,timeConstant:750,restDelta:1,restSpeed:10,...r,...g};return this.startAxisValueAnimation(j,T)});return Promise.all(x).then(o)}startAxisValueAnimation(s,a){const l=this.getAxisMotionValue(s);return Bj(this.visualElement,s),l.start(hw(s,l,0,a,this.visualElement,!1))}stopAnimation(){Hn(s=>this.getAxisMotionValue(s).stop())}pauseAnimation(){Hn(s=>{var a;return(a=this.getAxisMotionValue(s).animation)===null||a===void 0?void 0:a.pause()})}getAnimationState(s){var a;return(a=this.getAxisMotionValue(s).animation)===null||a===void 0?void 0:a.state}getAxisMotionValue(s){const a=`_drag${s.toUpperCase()}`,l=this.visualElement.getProps(),n=l[a];return n||this.visualElement.getValue(s,(l.initial?l.initial[s]:void 0)||0)}snapToCursor(s){Hn(a=>{const{drag:l}=this.getProps();if(!_p(a,l,this.currentDirection))return;const{projection:n}=this.visualElement,r=this.getAxisMotionValue(a);if(n&&n.layout){const{min:i,max:o}=n.layout.layoutBox[a];r.set(s[a]-ua(i,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:s,dragConstraints:a}=this.getProps(),{projection:l}=this.visualElement;if(!Qc(a)||!l||!this.constraints)return;this.stopAnimation();const n={x:0,y:0};Hn(i=>{const o=this.getAxisMotionValue(i);if(o&&this.constraints!==!1){const c=o.get();n[i]=vL({min:c,max:c},this.constraints[i])}});const{transformTemplate:r}=this.visualElement.getProps();this.visualElement.current.style.transform=r?r({},""):"none",l.root&&l.root.updateScroll(),l.updateLayout(),this.resolveConstraints(),Hn(i=>{if(!_p(i,s,null))return;const o=this.getAxisMotionValue(i),{min:c,max:x}=this.constraints[i];o.set(ua(c,x,n[i]))})}addListeners(){if(!this.visualElement.current)return;CL.set(this.visualElement,this);const s=this.visualElement.current,a=nx(s,"pointerdown",c=>{const{drag:x,dragListener:j=!0}=this.getProps();x&&j&&this.start(c)}),l=()=>{const{dragConstraints:c}=this.getProps();Qc(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,r=n.addEventListener("measure",l);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),Qs.read(l);const i=Wx(window,"resize",()=>this.scalePositionWithinConstraints()),o=n.addEventListener("didUpdate",({delta:c,hasLayoutChanged:x})=>{this.isDragging&&x&&(Hn(j=>{const g=this.getAxisMotionValue(j);g&&(this.originPoint[j]+=c[j].translate,g.set(g.get()+c[j].translate))}),this.visualElement.render())});return()=>{i(),a(),r(),o&&o()}}getProps(){const s=this.visualElement.getProps(),{drag:a=!1,dragDirectionLock:l=!1,dragPropagation:n=!1,dragConstraints:r=!1,dragElastic:i=Qj,dragMomentum:o=!0}=s;return{...s,drag:a,dragDirectionLock:l,dragPropagation:n,dragConstraints:r,dragElastic:i,dragMomentum:o}}}function _p(t,s,a){return(s===!0||s===t)&&(a===null||a===t)}function AL(t,s=10){let a=null;return Math.abs(t.y)>s?a="y":Math.abs(t.x)>s&&(a="x"),a}class EL extends Xo{constructor(s){super(s),this.removeGroupControls=Rn,this.removeListeners=Rn,this.controls=new SL(s)}mount(){const{dragControls:s}=this.node.getProps();s&&(this.removeGroupControls=s.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Rn}unmount(){this.removeGroupControls(),this.removeListeners()}}const Nk=t=>(s,a)=>{t&&Qs.postRender(()=>t(s,a))};class ML extends Xo{constructor(){super(...arguments),this.removePointerDownListener=Rn}onPointerDown(s){this.session=new iE(s,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:hE(this.node)})}createPanHandlers(){const{onPanSessionStart:s,onPanStart:a,onPan:l,onPanEnd:n}=this.node.getProps();return{onSessionStart:Nk(s),onStart:Nk(a),onMove:l,onEnd:(r,i)=>{delete this.session,n&&Qs.postRender(()=>n(r,i))}}}mount(){this.removePointerDownListener=nx(this.node.current,"pointerdown",s=>this.onPointerDown(s))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const h0={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function wk(t,s){return s.max===s.min?0:t/(s.max-s.min)*100}const Zu={correct:(t,s)=>{if(!s.target)return t;if(typeof t=="string")if(Ot.test(t))t=parseFloat(t);else return t;const a=wk(t,s.target.x),l=wk(t,s.target.y);return`${a}% ${l}%`}},PL={correct:(t,{treeScale:s,projectionDelta:a})=>{const l=t,n=_o.parse(t);if(n.length>5)return l;const r=_o.createTransformer(t),i=typeof n[0]!="number"?1:0,o=a.x.scale*s.x,c=a.y.scale*s.y;n[0+i]/=o,n[1+i]/=c;const x=ua(o,c,.5);return typeof n[2+i]=="number"&&(n[2+i]/=x),typeof n[3+i]=="number"&&(n[3+i]/=x),r(n)}};class OL extends d.Component{componentDidMount(){const{visualElement:s,layoutGroup:a,switchLayoutGroup:l,layoutId:n}=this.props,{projection:r}=s;Y$(TL),r&&(a.group&&a.group.add(r),l&&l.register&&n&&l.register(r),r.root.didUpdate(),r.addEventListener("animationComplete",()=>{this.safeToRemove()}),r.setOptions({...r.options,onExitComplete:()=>this.safeToRemove()})),h0.hasEverUpdated=!0}getSnapshotBeforeUpdate(s){const{layoutDependency:a,visualElement:l,drag:n,isPresent:r}=this.props,i=l.projection;return i&&(i.isPresent=r,n||s.layoutDependency!==a||a===void 0?i.willUpdate():this.safeToRemove(),s.isPresent!==r&&(r?i.promote():i.relegate()||Qs.postRender(()=>{const o=i.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:s}=this.props.visualElement;s&&(s.root.didUpdate(),qN.postRender(()=>{!s.currentAnimation&&s.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:s,layoutGroup:a,switchLayoutGroup:l}=this.props,{projection:n}=s;n&&(n.scheduleCheckAfterUnmount(),a&&a.group&&a.group.remove(n),l&&l.deregister&&l.deregister(n))}safeToRemove(){const{safeToRemove:s}=this.props;s&&s()}render(){return null}}function gE(t){const[s,a]=J5(),l=d.useContext($N);return e.jsx(OL,{...t,layoutGroup:l,switchLayoutGroup:d.useContext(rA),isPresent:s,safeToRemove:a})}const TL={borderRadius:{...Zu,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Zu,borderTopRightRadius:Zu,borderBottomLeftRadius:Zu,borderBottomRightRadius:Zu,boxShadow:PL};function RL(t,s,a){const l=$l(t)?t:qx(t);return l.start(hw("",l,s,a)),l.animation}function DL(t){return t instanceof SVGElement&&t.tagName!=="svg"}const IL=(t,s)=>t.depth-s.depth;class $L{constructor(){this.children=[],this.isDirty=!1}add(s){lw(this.children,s),this.isDirty=!0}remove(s){nw(this.children,s),this.isDirty=!0}forEach(s){this.isDirty&&this.children.sort(IL),this.isDirty=!1,this.children.forEach(s)}}function LL(t,s){const a=ai.now(),l=({timestamp:n})=>{const r=n-a;r>=s&&(Vo(l),t(r-s))};return Qs.read(l,!0),()=>Vo(l)}const fE=["TopLeft","TopRight","BottomLeft","BottomRight"],FL=fE.length,kk=t=>typeof t=="string"?parseFloat(t):t,Ck=t=>typeof t=="number"||Ot.test(t);function UL(t,s,a,l,n,r){n?(t.opacity=ua(0,a.opacity!==void 0?a.opacity:1,VL(l)),t.opacityExit=ua(s.opacity!==void 0?s.opacity:1,0,_L(l))):r&&(t.opacity=ua(s.opacity!==void 0?s.opacity:1,a.opacity!==void 0?a.opacity:1,l));for(let i=0;i<FL;i++){const o=`border${fE[i]}Radius`;let c=Sk(s,o),x=Sk(a,o);if(c===void 0&&x===void 0)continue;c||(c=0),x||(x=0),c===0||x===0||Ck(c)===Ck(x)?(t[o]=Math.max(ua(kk(c),kk(x),l),0),(si.test(x)||si.test(c))&&(t[o]+="%")):t[o]=x}(s.rotate||a.rotate)&&(t.rotate=ua(s.rotate||0,a.rotate||0,l))}function Sk(t,s){return t[s]!==void 0?t[s]:t.borderRadius}const VL=vE(0,.5,$A),_L=vE(.5,.95,Rn);function vE(t,s,a){return l=>l<t?0:l>s?1:a(wu(t,s,l))}function Ak(t,s){t.min=s.min,t.max=s.max}function Vn(t,s){Ak(t.x,s.x),Ak(t.y,s.y)}function Ek(t,s){t.translate=s.translate,t.scale=s.scale,t.originPoint=s.originPoint,t.origin=s.origin}function Mk(t,s,a,l,n){return t-=s,t=ng(t,1/a,l),n!==void 0&&(t=ng(t,1/n,l)),t}function BL(t,s=0,a=1,l=.5,n,r=t,i=t){if(si.test(s)&&(s=parseFloat(s),s=ua(i.min,i.max,s/100)-i.min),typeof s!="number")return;let o=ua(r.min,r.max,l);t===r&&(o-=s),t.min=Mk(t.min,s,a,o,n),t.max=Mk(t.max,s,a,o,n)}function Pk(t,s,[a,l,n],r,i){BL(t,s[a],s[l],s[n],s.scale,r,i)}const GL=["x","scaleX","originX"],qL=["y","scaleY","originY"];function Ok(t,s,a,l){Pk(t.x,s,GL,a?a.x:void 0,l?l.x:void 0),Pk(t.y,s,qL,a?a.y:void 0,l?l.y:void 0)}function Tk(t){return t.translate===0&&t.scale===1}function bE(t){return Tk(t.x)&&Tk(t.y)}function Rk(t,s){return t.min===s.min&&t.max===s.max}function zL(t,s){return Rk(t.x,s.x)&&Rk(t.y,s.y)}function Dk(t,s){return Math.round(t.min)===Math.round(s.min)&&Math.round(t.max)===Math.round(s.max)}function jE(t,s){return Dk(t.x,s.x)&&Dk(t.y,s.y)}function Ik(t){return $n(t.x)/$n(t.y)}function $k(t,s){return t.translate===s.translate&&t.scale===s.scale&&t.originPoint===s.originPoint}class WL{constructor(){this.members=[]}add(s){lw(this.members,s),s.scheduleRender()}remove(s){if(nw(this.members,s),s===this.prevLead&&(this.prevLead=void 0),s===this.lead){const a=this.members[this.members.length-1];a&&this.promote(a)}}relegate(s){const a=this.members.findIndex(n=>s===n);if(a===0)return!1;let l;for(let n=a;n>=0;n--){const r=this.members[n];if(r.isPresent!==!1){l=r;break}}return l?(this.promote(l),!0):!1}promote(s,a){const l=this.lead;if(s!==l&&(this.prevLead=l,this.lead=s,s.show(),l)){l.instance&&l.scheduleRender(),s.scheduleRender(),s.resumeFrom=l,a&&(s.resumeFrom.preserveOpacity=!0),l.snapshot&&(s.snapshot=l.snapshot,s.snapshot.latestValues=l.animationValues||l.latestValues),s.root&&s.root.isUpdating&&(s.isLayoutDirty=!0);const{crossfade:n}=s.options;n===!1&&l.hide()}}exitAnimationComplete(){this.members.forEach(s=>{const{options:a,resumingFrom:l}=s;a.onExitComplete&&a.onExitComplete(),l&&l.options.onExitComplete&&l.options.onExitComplete()})}scheduleRender(){this.members.forEach(s=>{s.instance&&s.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function HL(t,s,a){let l="";const n=t.x.translate/s.x,r=t.y.translate/s.y,i=(a==null?void 0:a.z)||0;if((n||r||i)&&(l=`translate3d(${n}px, ${r}px, ${i}px) `),(s.x!==1||s.y!==1)&&(l+=`scale(${1/s.x}, ${1/s.y}) `),a){const{transformPerspective:x,rotate:j,rotateX:g,rotateY:N,skewX:$,skewY:T}=a;x&&(l=`perspective(${x}px) ${l}`),j&&(l+=`rotate(${j}deg) `),g&&(l+=`rotateX(${g}deg) `),N&&(l+=`rotateY(${N}deg) `),$&&(l+=`skewX(${$}deg) `),T&&(l+=`skewY(${T}deg) `)}const o=t.x.scale*s.x,c=t.y.scale*s.y;return(o!==1||c!==1)&&(l+=`scale(${o}, ${c})`),l||"none"}const Nd={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},zm=typeof window<"u"&&window.MotionDebug!==void 0,gv=["","X","Y","Z"],XL={visibility:"hidden"},Lk=1e3;let KL=0;function fv(t,s,a,l){const{latestValues:n}=s;n[t]&&(a[t]=n[t],s.setStaticValue(t,0),l&&(l[t]=0))}function yE(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:s}=t.options;if(!s)return;const a=MA(s);if(window.MotionHasOptimisedAnimation(a,"transform")){const{layout:n,layoutId:r}=t.options;window.MotionCancelOptimisedAnimation(a,"transform",Qs,!(n||r))}const{parent:l}=t;l&&!l.hasCheckedOptimisedAppear&&yE(l)}function NE({attachResizeListener:t,defaultParent:s,measureScroll:a,checkIsScrollRoot:l,resetTransform:n}){return class{constructor(i={},o=s==null?void 0:s()){this.id=KL++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,zm&&(Nd.totalNodes=Nd.resolvedTargetDeltas=Nd.recalculatedProjection=0),this.nodes.forEach(JL),this.nodes.forEach(aF),this.nodes.forEach(lF),this.nodes.forEach(ZL),zm&&window.MotionDebug.record(Nd)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new $L)}addEventListener(i,o){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new rw),this.eventHandlers.get(i).add(o)}notifyListeners(i,...o){const c=this.eventHandlers.get(i);c&&c.notify(...o)}hasListeners(i){return this.eventHandlers.has(i)}mount(i,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=DL(i),this.instance=i;const{layoutId:c,layout:x,visualElement:j}=this.options;if(j&&!j.current&&j.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(x||c)&&(this.isLayoutDirty=!0),t){let g;const N=()=>this.root.updateBlockedByResize=!1;t(i,()=>{this.root.updateBlockedByResize=!0,g&&g(),g=LL(N,250),h0.hasAnimatedSinceResize&&(h0.hasAnimatedSinceResize=!1,this.nodes.forEach(Uk))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&j&&(c||x)&&this.addEventListener("didUpdate",({delta:g,hasLayoutChanged:N,hasRelativeTargetChanged:$,layout:T})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const k=this.options.transition||j.getDefaultTransition()||dF,{onLayoutAnimationStart:q,onLayoutAnimationComplete:L}=j.getProps(),R=!this.targetLayout||!jE(this.targetLayout,T)||$,U=!N&&$;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||U||N&&(R||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(g,U);const ae={...ew(k,"layout"),onPlay:q,onComplete:L};(j.shouldReduceMotion||this.options.layoutRoot)&&(ae.delay=0,ae.type=!1),this.startAnimation(ae)}else N||Uk(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=T})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Vo(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(nF),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&yE(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let j=0;j<this.path.length;j++){const g=this.path[j];g.shouldResetTransform=!0,g.updateScroll("snapshot"),g.options.layoutRoot&&g.willUpdate(!1)}const{layoutId:o,layout:c}=this.options;if(o===void 0&&!c)return;const x=this.getTransformTemplate();this.prevTransformTemplateValue=x?x(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Fk);return}this.isUpdating||this.nodes.forEach(tF),this.isUpdating=!1,this.nodes.forEach(sF),this.nodes.forEach(QL),this.nodes.forEach(YL),this.clearAllSnapshots();const o=ai.now();bl.delta=Di(0,1e3/60,o-bl.timestamp),bl.timestamp=o,bl.isProcessing=!0,iv.update.process(bl),iv.preRender.process(bl),iv.render.process(bl),bl.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,qN.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(eF),this.sharedNodes.forEach(rF)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Qs.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Qs.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Oa(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(o=!1),o){const c=l(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:c,offset:a(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!n)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!bE(this.projectionDelta),c=this.getTransformTemplate(),x=c?c(this.latestValues,""):void 0,j=x!==this.prevTransformTemplateValue;i&&(o||yd(this.latestValues)||j)&&(n(this.instance,x),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const o=this.measurePageBox();let c=this.removeElementScroll(o);return i&&(c=this.removeTransform(c)),cF(c),{animationId:this.root.animationId,measuredBox:o,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var i;const{visualElement:o}=this.options;if(!o)return Oa();const c=o.measureViewportBox();if(!(((i=this.scroll)===null||i===void 0?void 0:i.wasRoot)||this.path.some(uF))){const{scroll:j}=this.root;j&&(Zc(c.x,j.offset.x),Zc(c.y,j.offset.y))}return c}removeElementScroll(i){var o;const c=Oa();if(Vn(c,i),!((o=this.scroll)===null||o===void 0)&&o.wasRoot)return c;for(let x=0;x<this.path.length;x++){const j=this.path[x],{scroll:g,options:N}=j;j!==this.root&&g&&N.layoutScroll&&(g.wasRoot&&Vn(c,i),Zc(c.x,g.offset.x),Zc(c.y,g.offset.y))}return c}applyTransform(i,o=!1){const c=Oa();Vn(c,i);for(let x=0;x<this.path.length;x++){const j=this.path[x];!o&&j.options.layoutScroll&&j.scroll&&j!==j.root&&eu(c,{x:-j.scroll.offset.x,y:-j.scroll.offset.y}),yd(j.latestValues)&&eu(c,j.latestValues)}return yd(this.latestValues)&&eu(c,this.latestValues),c}removeTransform(i){const o=Oa();Vn(o,i);for(let c=0;c<this.path.length;c++){const x=this.path[c];if(!x.instance||!yd(x.latestValues))continue;Yj(x.latestValues)&&x.updateSnapshot();const j=Oa(),g=x.measurePageBox();Vn(j,g),Ok(o,x.latestValues,x.snapshot?x.snapshot.layoutBox:void 0,j)}return yd(this.latestValues)&&Ok(o,this.latestValues),o}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==bl.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){var o;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const x=!!this.resumingFrom||this!==c;if(!(i||x&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:g,layoutId:N}=this.options;if(!(!this.layout||!(g||N))){if(this.resolvedRelativeTargetAt=bl.timestamp,!this.targetDelta&&!this.relativeTarget){const $=this.getClosestProjectingParent();$&&$.layout&&this.animationProgress!==1?(this.relativeParent=$,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Oa(),this.relativeTargetOrigin=Oa(),ix(this.relativeTargetOrigin,this.layout.layoutBox,$.layout.layoutBox),Vn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Oa(),this.targetWithTransforms=Oa()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),pL(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Vn(this.target,this.layout.layoutBox),xE(this.target,this.targetDelta)):Vn(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const $=this.getClosestProjectingParent();$&&!!$.resumingFrom==!!this.resumingFrom&&!$.options.layoutScroll&&$.target&&this.animationProgress!==1?(this.relativeParent=$,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Oa(),this.relativeTargetOrigin=Oa(),ix(this.relativeTargetOrigin,this.target,$.target),Vn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}zm&&Nd.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Yj(this.parent.latestValues)||mE(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var i;const o=this.getLead(),c=!!this.resumingFrom||this!==o;let x=!0;if((this.isProjectionDirty||!((i=this.parent)===null||i===void 0)&&i.isProjectionDirty)&&(x=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(x=!1),this.resolvedRelativeTargetAt===bl.timestamp&&(x=!1),x)return;const{layout:j,layoutId:g}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(j||g))return;Vn(this.layoutCorrected,this.layout.layoutBox);const N=this.treeScale.x,$=this.treeScale.y;wL(this.layoutCorrected,this.treeScale,this.path,c),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=Oa());const{target:T}=o;if(!T){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(Ek(this.prevProjectionDelta.x,this.projectionDelta.x),Ek(this.prevProjectionDelta.y,this.projectionDelta.y)),rx(this.projectionDelta,this.layoutCorrected,T,this.latestValues),(this.treeScale.x!==N||this.treeScale.y!==$||!$k(this.projectionDelta.x,this.prevProjectionDelta.x)||!$k(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",T)),zm&&Nd.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){var o;if((o=this.options.visualElement)===null||o===void 0||o.scheduleRender(),i){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Jc(),this.projectionDelta=Jc(),this.projectionDeltaWithTransform=Jc()}setAnimationOrigin(i,o=!1){const c=this.snapshot,x=c?c.latestValues:{},j={...this.latestValues},g=Jc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const N=Oa(),$=c?c.source:void 0,T=this.layout?this.layout.source:void 0,k=$!==T,q=this.getStack(),L=!q||q.members.length<=1,R=!!(k&&!L&&this.options.crossfade===!0&&!this.path.some(oF));this.animationProgress=0;let U;this.mixTargetDelta=ae=>{const ie=ae/1e3;Vk(g.x,i.x,ie),Vk(g.y,i.y,ie),this.setTargetDelta(g),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(ix(N,this.layout.layoutBox,this.relativeParent.layout.layoutBox),iF(this.relativeTarget,this.relativeTargetOrigin,N,ie),U&&zL(this.relativeTarget,U)&&(this.isProjectionDirty=!1),U||(U=Oa()),Vn(U,this.relativeTarget)),k&&(this.animationValues=j,UL(j,x,this.latestValues,ie,R,L)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=ie},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Vo(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Qs.update(()=>{h0.hasAnimatedSinceResize=!0,this.currentAnimation=RL(0,Lk,{...i,onUpdate:o=>{this.mixTargetDelta(o),i.onUpdate&&i.onUpdate(o)},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Lk),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:o,target:c,layout:x,latestValues:j}=i;if(!(!o||!c||!x)){if(this!==i&&this.layout&&x&&wE(this.options.animationType,this.layout.layoutBox,x.layoutBox)){c=this.target||Oa();const g=$n(this.layout.layoutBox.x);c.x.min=i.target.x.min,c.x.max=c.x.min+g;const N=$n(this.layout.layoutBox.y);c.y.min=i.target.y.min,c.y.max=c.y.min+N}Vn(o,c),eu(o,j),rx(this.projectionDeltaWithTransform,this.layoutCorrected,o,j)}}registerSharedNode(i,o){this.sharedNodes.has(i)||this.sharedNodes.set(i,new WL),this.sharedNodes.get(i).add(o);const x=o.options.initialPromotionConfig;o.promote({transition:x?x.transition:void 0,preserveFollowOpacity:x&&x.shouldPreserveFollowOpacity?x.shouldPreserveFollowOpacity(o):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){var i;const{layoutId:o}=this.options;return o?((i=this.getStack())===null||i===void 0?void 0:i.lead)||this:this}getPrevLead(){var i;const{layoutId:o}=this.options;return o?(i=this.getStack())===null||i===void 0?void 0:i.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:o,preserveFollowOpacity:c}={}){const x=this.getStack();x&&x.promote(this,c),i&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let o=!1;const{latestValues:c}=i;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(o=!0),!o)return;const x={};c.z&&fv("z",i,x,this.animationValues);for(let j=0;j<gv.length;j++)fv(`rotate${gv[j]}`,i,x,this.animationValues),fv(`skew${gv[j]}`,i,x,this.animationValues);i.render();for(const j in x)i.setStaticValue(j,x[j]),this.animationValues&&(this.animationValues[j]=x[j]);i.scheduleRender()}getProjectionStyles(i){var o,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return XL;const x={visibility:""},j=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,x.opacity="",x.pointerEvents=x0(i==null?void 0:i.pointerEvents)||"",x.transform=j?j(this.latestValues,""):"none",x;const g=this.getLead();if(!this.projectionDelta||!this.layout||!g.target){const k={};return this.options.layoutId&&(k.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,k.pointerEvents=x0(i==null?void 0:i.pointerEvents)||""),this.hasProjected&&!yd(this.latestValues)&&(k.transform=j?j({},""):"none",this.hasProjected=!1),k}const N=g.animationValues||g.latestValues;this.applyTransformsToTarget(),x.transform=HL(this.projectionDeltaWithTransform,this.treeScale,N),j&&(x.transform=j(N,x.transform));const{x:$,y:T}=this.projectionDelta;x.transformOrigin=`${$.origin*100}% ${T.origin*100}% 0`,g.animationValues?x.opacity=g===this?(c=(o=N.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:N.opacityExit:x.opacity=g===this?N.opacity!==void 0?N.opacity:"":N.opacityExit!==void 0?N.opacityExit:0;for(const k in eg){if(N[k]===void 0)continue;const{correct:q,applyTo:L}=eg[k],R=x.transform==="none"?N[k]:q(N[k],g);if(L){const U=L.length;for(let ae=0;ae<U;ae++)x[L[ae]]=R}else x[k]=R}return this.options.layoutId&&(x.pointerEvents=g===this?x0(i==null?void 0:i.pointerEvents)||"":"none"),x}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>{var o;return(o=i.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(Fk),this.root.sharedNodes.clear()}}}function QL(t){t.updateLayout()}function YL(t){var s;const a=((s=t.resumeFrom)===null||s===void 0?void 0:s.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&a&&t.hasListeners("didUpdate")){const{layoutBox:l,measuredBox:n}=t.layout,{animationType:r}=t.options,i=a.source!==t.layout.source;r==="size"?Hn(g=>{const N=i?a.measuredBox[g]:a.layoutBox[g],$=$n(N);N.min=l[g].min,N.max=N.min+$}):wE(r,a.layoutBox,l)&&Hn(g=>{const N=i?a.measuredBox[g]:a.layoutBox[g],$=$n(l[g]);N.max=N.min+$,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[g].max=t.relativeTarget[g].min+$)});const o=Jc();rx(o,l,a.layoutBox);const c=Jc();i?rx(c,t.applyTransform(n,!0),a.measuredBox):rx(c,l,a.layoutBox);const x=!bE(o);let j=!1;if(!t.resumeFrom){const g=t.getClosestProjectingParent();if(g&&!g.resumeFrom){const{snapshot:N,layout:$}=g;if(N&&$){const T=Oa();ix(T,a.layoutBox,N.layoutBox);const k=Oa();ix(k,l,$.layoutBox),jE(T,k)||(j=!0),g.options.layoutRoot&&(t.relativeTarget=k,t.relativeTargetOrigin=T,t.relativeParent=g)}}}t.notifyListeners("didUpdate",{layout:l,snapshot:a,delta:c,layoutDelta:o,hasLayoutChanged:x,hasRelativeTargetChanged:j})}else if(t.isLead()){const{onExitComplete:l}=t.options;l&&l()}t.options.transition=void 0}function JL(t){zm&&Nd.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function ZL(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function eF(t){t.clearSnapshot()}function Fk(t){t.clearMeasurements()}function tF(t){t.isLayoutDirty=!1}function sF(t){const{visualElement:s}=t.options;s&&s.getProps().onBeforeLayoutMeasure&&s.notify("BeforeLayoutMeasure"),t.resetTransform()}function Uk(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function aF(t){t.resolveTargetDelta()}function lF(t){t.calcProjection()}function nF(t){t.resetSkewAndRotation()}function rF(t){t.removeLeadSnapshot()}function Vk(t,s,a){t.translate=ua(s.translate,0,a),t.scale=ua(s.scale,1,a),t.origin=s.origin,t.originPoint=s.originPoint}function _k(t,s,a,l){t.min=ua(s.min,a.min,l),t.max=ua(s.max,a.max,l)}function iF(t,s,a,l){_k(t.x,s.x,a.x,l),_k(t.y,s.y,a.y,l)}function oF(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const dF={duration:.45,ease:[.4,0,.1,1]},Bk=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),Gk=Bk("applewebkit/")&&!Bk("chrome/")?Math.round:Rn;function qk(t){t.min=Gk(t.min),t.max=Gk(t.max)}function cF(t){qk(t.x),qk(t.y)}function wE(t,s,a){return t==="position"||t==="preserve-aspect"&&!xL(Ik(s),Ik(a),.2)}function uF(t){var s;return t!==t.root&&((s=t.scroll)===null||s===void 0?void 0:s.wasRoot)}const mF=NE({attachResizeListener:(t,s)=>Wx(t,"resize",s),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),vv={current:void 0},kE=NE({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!vv.current){const t=new mF({});t.mount(window),t.setOptions({layoutScroll:!0}),vv.current=t}return vv.current},resetTransform:(t,s)=>{t.style.transform=s!==void 0?s:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),xF={pan:{Feature:ML},drag:{Feature:EL,ProjectionNode:kE,MeasureLayout:gE}};function zk(t,s,a){const{props:l}=t;t.animationState&&l.whileHover&&t.animationState.setActive("whileHover",a==="Start");const n="onHover"+a,r=l[n];r&&Qs.postRender(()=>r(s,hp(s)))}class pF extends Xo{mount(){const{current:s}=this.node;s&&(this.unmount=x7(s,a=>(zk(this.node,a,"Start"),l=>zk(this.node,l,"End"))))}unmount(){}}class hF extends Xo{constructor(){super(...arguments),this.isActive=!1}onFocus(){let s=!1;try{s=this.node.current.matches(":focus-visible")}catch{s=!0}!s||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=pp(Wx(this.node.current,"focus",()=>this.onFocus()),Wx(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Wk(t,s,a){const{props:l}=t;t.animationState&&l.whileTap&&t.animationState.setActive("whileTap",a==="Start");const n="onTap"+(a==="End"?"":a),r=l[n];r&&Qs.postRender(()=>r(s,hp(s)))}class gF extends Xo{mount(){const{current:s}=this.node;s&&(this.unmount=f7(s,a=>(Wk(this.node,a,"Start"),(l,{success:n})=>Wk(this.node,l,n?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Zj=new WeakMap,bv=new WeakMap,fF=t=>{const s=Zj.get(t.target);s&&s(t)},vF=t=>{t.forEach(fF)};function bF({root:t,...s}){const a=t||document;bv.has(a)||bv.set(a,{});const l=bv.get(a),n=JSON.stringify(s);return l[n]||(l[n]=new IntersectionObserver(vF,{root:t,...s})),l[n]}function jF(t,s,a){const l=bF(s);return Zj.set(t,a),l.observe(t),()=>{Zj.delete(t),l.unobserve(t)}}const yF={some:0,all:1};class NF extends Xo{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:s={}}=this.node.getProps(),{root:a,margin:l,amount:n="some",once:r}=s,i={root:a?a.current:void 0,rootMargin:l,threshold:typeof n=="number"?n:yF[n]},o=c=>{const{isIntersecting:x}=c;if(this.isInView===x||(this.isInView=x,r&&!x&&this.hasEnteredView))return;x&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",x);const{onViewportEnter:j,onViewportLeave:g}=this.node.getProps(),N=x?j:g;N&&N(c)};return jF(this.node.current,i,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:s,prevProps:a}=this.node;["amount","margin","root"].some(wF(s,a))&&this.startObserver()}unmount(){}}function wF({viewport:t={}},{viewport:s={}}={}){return a=>t[a]!==s[a]}const kF={inView:{Feature:NF},tap:{Feature:gF},focus:{Feature:hF},hover:{Feature:pF}},CF={layout:{ProjectionNode:kE,MeasureLayout:gE}},ey={current:null},CE={current:!1};function SF(){if(CE.current=!0,!!UN)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),s=()=>ey.current=t.matches;t.addListener(s),s()}else ey.current=!1}const AF=[...QA,Rl,_o],EF=t=>AF.find(KA(t)),Hk=new WeakMap;function MF(t,s,a){for(const l in s){const n=s[l],r=a[l];if($l(n))t.addValue(l,n);else if($l(r))t.addValue(l,qx(n,{owner:t}));else if(r!==n)if(t.hasValue(l)){const i=t.getValue(l);i.liveStyle===!0?i.jump(n):i.hasAnimated||i.set(n)}else{const i=t.getStaticValue(l);t.addValue(l,qx(i!==void 0?i:n,{owner:t}))}}for(const l in a)s[l]===void 0&&t.removeValue(l);return s}const Xk=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class PF{scrapeMotionValuesFromProps(s,a,l){return{}}constructor({parent:s,props:a,presenceContext:l,reducedMotionConfig:n,blockInitialAnimation:r,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=mw,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const $=ai.now();this.renderScheduledAt<$&&(this.renderScheduledAt=$,Qs.render(this.render,!1,!0))};const{latestValues:c,renderState:x,onUpdate:j}=i;this.onUpdate=j,this.latestValues=c,this.baseTarget={...c},this.initialValues=a.initial?{...c}:{},this.renderState=x,this.parent=s,this.props=a,this.presenceContext=l,this.depth=s?s.depth+1:0,this.reducedMotionConfig=n,this.options=o,this.blockInitialAnimation=!!r,this.isControllingVariants=Nf(a),this.isVariantNode=lA(a),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(s&&s.current);const{willChange:g,...N}=this.scrapeMotionValuesFromProps(a,{},this);for(const $ in N){const T=N[$];c[$]!==void 0&&$l(T)&&T.set(c[$],!1)}}mount(s){this.current=s,Hk.set(s,this),this.projection&&!this.projection.instance&&this.projection.mount(s),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((a,l)=>this.bindToMotionValue(l,a)),CE.current||SF(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:ey.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){Hk.delete(this.current),this.projection&&this.projection.unmount(),Vo(this.notifyUpdate),Vo(this.render),this.valueSubscriptions.forEach(s=>s()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const s in this.events)this.events[s].clear();for(const s in this.features){const a=this.features[s];a&&(a.unmount(),a.isMounted=!1)}this.current=null}bindToMotionValue(s,a){this.valueSubscriptions.has(s)&&this.valueSubscriptions.get(s)();const l=Kd.has(s),n=a.on("change",o=>{this.latestValues[s]=o,this.props.onUpdate&&Qs.preRender(this.notifyUpdate),l&&this.projection&&(this.projection.isTransformDirty=!0)}),r=a.on("renderRequest",this.scheduleRender);let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,s,a)),this.valueSubscriptions.set(s,()=>{n(),r(),i&&i(),a.owner&&a.stop()})}sortNodePosition(s){return!this.current||!this.sortInstanceNodePosition||this.type!==s.type?0:this.sortInstanceNodePosition(this.current,s.current)}updateFeatures(){let s="animation";for(s in ku){const a=ku[s];if(!a)continue;const{isEnabled:l,Feature:n}=a;if(!this.features[s]&&n&&l(this.props)&&(this.features[s]=new n(this)),this.features[s]){const r=this.features[s];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Oa()}getStaticValue(s){return this.latestValues[s]}setStaticValue(s,a){this.latestValues[s]=a}update(s,a){(s.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=s,this.prevPresenceContext=this.presenceContext,this.presenceContext=a;for(let l=0;l<Xk.length;l++){const n=Xk[l];this.propEventSubscriptions[n]&&(this.propEventSubscriptions[n](),delete this.propEventSubscriptions[n]);const r="on"+n,i=s[r];i&&(this.propEventSubscriptions[n]=this.on(n,i))}this.prevMotionValues=MF(this,this.scrapeMotionValuesFromProps(s,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(s){return this.props.variants?this.props.variants[s]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(s){const a=this.getClosestVariantNode();if(a)return a.variantChildren&&a.variantChildren.add(s),()=>a.variantChildren.delete(s)}addValue(s,a){const l=this.values.get(s);a!==l&&(l&&this.removeValue(s),this.bindToMotionValue(s,a),this.values.set(s,a),this.latestValues[s]=a.get())}removeValue(s){this.values.delete(s);const a=this.valueSubscriptions.get(s);a&&(a(),this.valueSubscriptions.delete(s)),delete this.latestValues[s],this.removeValueFromRenderState(s,this.renderState)}hasValue(s){return this.values.has(s)}getValue(s,a){if(this.props.values&&this.props.values[s])return this.props.values[s];let l=this.values.get(s);return l===void 0&&a!==void 0&&(l=qx(a===null?void 0:a,{owner:this}),this.addValue(s,l)),l}readValue(s,a){var l;let n=this.latestValues[s]!==void 0||!this.current?this.latestValues[s]:(l=this.getBaseTargetFromProps(this.props,s))!==null&&l!==void 0?l:this.readValueFromInstance(this.current,s,this.options);return n!=null&&(typeof n=="string"&&(HA(n)||FA(n))?n=parseFloat(n):!EF(n)&&_o.test(a)&&(n=qA(s,a)),this.setBaseTarget(s,$l(n)?n.get():n)),$l(n)?n.get():n}setBaseTarget(s,a){this.baseTarget[s]=a}getBaseTarget(s){var a;const{initial:l}=this.props;let n;if(typeof l=="string"||typeof l=="object"){const i=WN(this.props,l,(a=this.presenceContext)===null||a===void 0?void 0:a.custom);i&&(n=i[s])}if(l&&n!==void 0)return n;const r=this.getBaseTargetFromProps(this.props,s);return r!==void 0&&!$l(r)?r:this.initialValues[s]!==void 0&&n===void 0?void 0:this.baseTarget[s]}on(s,a){return this.events[s]||(this.events[s]=new rw),this.events[s].add(a)}notify(s,...a){this.events[s]&&this.events[s].notify(...a)}}class SE extends PF{constructor(){super(...arguments),this.KeyframeResolver=YA}sortInstanceNodePosition(s,a){return s.compareDocumentPosition(a)&2?1:-1}getBaseTargetFromProps(s,a){return s.style?s.style[a]:void 0}removeValueFromRenderState(s,{vars:a,style:l}){delete a[s],delete l[s]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:s}=this.props;$l(s)&&(this.childSubscription=s.on("change",a=>{this.current&&(this.current.textContent=`${a}`)}))}}function OF(t){return window.getComputedStyle(t)}class TF extends SE{constructor(){super(...arguments),this.type="html",this.renderInstance=xA}readValueFromInstance(s,a){if(Kd.has(a)){const l=uw(a);return l&&l.default||0}else{const l=OF(s),n=(cA(a)?l.getPropertyValue(a):l[a])||0;return typeof n=="string"?n.trim():n}}measureInstanceViewportBox(s,{transformPagePoint:a}){return pE(s,a)}build(s,a,l){KN(s,a,l.transformTemplate)}scrapeMotionValuesFromProps(s,a,l){return ZN(s,a,l)}}class RF extends SE{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Oa}getBaseTargetFromProps(s,a){return s[a]}readValueFromInstance(s,a){if(Kd.has(a)){const l=uw(a);return l&&l.default||0}return a=pA.has(a)?a:GN(a),s.getAttribute(a)}scrapeMotionValuesFromProps(s,a,l){return fA(s,a,l)}build(s,a,l){QN(s,a,this.isSVGTag,l.transformTemplate)}renderInstance(s,a,l,n){hA(s,a,l,n)}mount(s){this.isSVGTag=JN(s.tagName),super.mount(s)}}const DF=(t,s)=>zN(t)?new RF(s):new TF(s,{allowProjection:t!==d.Fragment}),IF=r7({...lL,...kF,...xF,...CF},DF),We=y$(IF);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $F=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),AE=(...t)=>t.filter((s,a,l)=>!!s&&s.trim()!==""&&l.indexOf(s)===a).join(" ").trim();/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var LF={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FF=d.forwardRef(({color:t="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:l,className:n="",children:r,iconNode:i,...o},c)=>d.createElement("svg",{ref:c,...LF,width:s,height:s,stroke:t,strokeWidth:l?Number(a)*24/Number(s):a,className:AE("lucide",n),...o},[...i.map(([x,j])=>d.createElement(x,j)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=(t,s)=>{const a=d.forwardRef(({className:l,...n},r)=>d.createElement(FF,{ref:r,iconNode:s,className:AE(`lucide-${$F(t)}`,l),...n}));return a.displayName=`${t}`,a};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EE=Ze("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kk=Ze("ArrowDownLeft",[["path",{d:"M17 7 7 17",key:"15tmo1"}],["path",{d:"M17 17H7V7",key:"1org7z"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bp=Ze("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=Ze("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wm=Ze("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jv=Ze("BatteryCharging",[["path",{d:"M15 7h1a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2h-2",key:"1sdynx"}],["path",{d:"M6 7H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h1",key:"1gkd3k"}],["path",{d:"m11 7-3 5h4l-3 5",key:"b4a64w"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UF=Ze("Battery",[["rect",{width:"16",height:"10",x:"2",y:"7",rx:"2",ry:"2",key:"1w10f2"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $o=Ze("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yv=Ze("BookMarked",[["path",{d:"M10 2v8l3-3 3 3V2",key:"sqw3rj"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xl=Ze("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dn=Ze("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.3V14",key:"akvzfd"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VF=Ze("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _F=Ze("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BF=Ze("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=Ze("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qd=Ze("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=Ze("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const li=Ze("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GF=Ze("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=Ze("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qF=Ze("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rg=Ze("CircleDollarSign",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 18V6",key:"zqpxq5"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fu=Ze("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ig=Ze("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g0=Ze("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zF=Ze("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gp=Ze("Command",[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3",key:"11bfej"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=Ze("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $c=Ze("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xr=Ze("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qi=Ze("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=Ze("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=Ze("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WF=Ze("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ty=Ze("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HF=Ze("FileCheck2",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m3 15 2 2 4-4",key:"1lhrkk"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XF=Ze("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=Ze("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fn=Ze("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Su=Ze("Fingerprint",[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nv=Ze("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tu=Ze("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ii=Ze("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KF=Ze("Group",[["path",{d:"M3 7V5c0-1.1.9-2 2-2h2",key:"adw53z"}],["path",{d:"M17 3h2c1.1 0 2 .9 2 2v2",key:"an4l38"}],["path",{d:"M21 17v2c0 1.1-.9 2-2 2h-2",key:"144t0e"}],["path",{d:"M7 21H5c-1.1 0-2-.9-2-2v-2",key:"rtnfgi"}],["rect",{width:"7",height:"5",x:"7",y:"7",rx:"1",key:"1eyiv7"}],["rect",{width:"7",height:"5",x:"10",y:"12",rx:"1",key:"1qlmkx"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gw=Ze("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $d=Ze("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QF=Ze("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vn=Ze("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xu=Ze("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lc=Ze("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const og=Ze("Laptop",[["path",{d:"M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9m16 0H4m16 0 1.28 2.55a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45L4 16",key:"tarvll"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=Ze("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ox=Ze("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ld=Ze("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sy=Ze("LifeBuoy",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fd=Ze("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qk=Ze("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ko=Ze("LockOpen",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=Ze("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bo=Ze("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=Ze("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hx=Ze("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ay=Ze("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ME=Ze("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ji=Ze("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f0=Ze("MessagesSquare",[["path",{d:"M14 9a2 2 0 0 1-2 2H6l-4 4V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2z",key:"p1xzt8"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v11l-4-4h-6a2 2 0 0 1-2-2v-1",key:"1cx29u"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YF=Ze("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fw=Ze("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yk=Ze("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vw=Ze("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JF=Ze("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qr=Ze("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qp=Ze("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dx=Ze("PiggyBank",[["path",{d:"M19 5c-1.5 0-2.8 1.4-3 2-3.5-1.5-11-.3-11 5 0 1.8 0 3 2 4.5V20h4v-2h3v2h4v-4c1-.5 1.7-1 2-2h2v-4h-2c0-1-.5-1.5-1-2V5z",key:"1ivx2i"}],["path",{d:"M2 9v1c0 1.1.9 2 2 2h1",key:"nm575m"}],["path",{d:"M16 11h.01",key:"xkw8gn"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zp=Ze("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=Ze("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ar=Ze("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PE=Ze("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jk=Ze("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ia=Ze("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ka=Ze("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wl=Ze("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yi=Ze("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hm=Ze("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Co=Ze("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=Ze("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zk=Ze("Siren",[["path",{d:"M7 18v-6a5 5 0 1 1 10 0v6",key:"pcx96s"}],["path",{d:"M5 21a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-1a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2z",key:"1b4s83"}],["path",{d:"M21 12h1",key:"jtio3y"}],["path",{d:"M18.5 4.5 18 5",key:"g5sp9y"}],["path",{d:"M2 12h1",key:"1uaihz"}],["path",{d:"M12 2v1",key:"11qlp1"}],["path",{d:"m4.929 4.929.707.707",key:"1i51kw"}],["path",{d:"M12 12v6",key:"3ahymv"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZF=Ze("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bw=Ze("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=Ze("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eU=Ze("Split",[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M8 3H3v5",key:"15dfkv"}],["path",{d:"M12 22v-8.3a4 4 0 0 0-1.172-2.872L3 3",key:"1qrqzj"}],["path",{d:"m15 9 6-6",key:"ko1vev"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dl=Ze("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jw=Ze("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12a2 2 0 0 1-2-2V7",key:"6c3vgh"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tU=Ze("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ly=Ze("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const su=Ze("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ni=Ze("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sl=Ze("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=Ze("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OE=Ze("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=Ze("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dg=Ze("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wv=Ze("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cx=Ze("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=Ze("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kv=Ze("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $a=Ze("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e4=Ze("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TE=Ze("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=Ze("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xx=Ze("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),Lo={green:"#03CD8C",orange:"#F77F00"};function zd(...t){return t.filter(Boolean).join(" ")}function sU(t,s,a="text/plain"){const l=new Blob([s],{type:a}),n=URL.createObjectURL(l),r=document.createElement("a");r.href=n,r.download=t,r.click(),URL.revokeObjectURL(n)}function sa({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",accent:"bg-orange-50 text-orange-800 ring-orange-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:zd("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Zo({variant:t="outline",className:s,children:a,onClick:l,href:n}){const r="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",i={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200"},o=t==="primary"?{background:Lo.green}:t==="accent"?{background:Lo.orange}:void 0;return n?e.jsx("a",{href:n,onClick:c=>{l&&(c.preventDefault(),l())},className:zd(r,i[t],s),style:o,children:a}):e.jsx("button",{type:"button",onClick:l,className:zd(r,i[t],s),style:o,children:a})}function zi({id:t,eyebrow:s,title:a,subtitle:l,right:n,children:r}){return e.jsxs("section",{id:t,className:"scroll-mt-28",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between",children:[e.jsxs("div",{children:[s?e.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:s}):null,e.jsx("h2",{className:"mt-2 text-2xl font-semibold tracking-tight text-slate-900 md:text-3xl",children:a}),l?e.jsx("p",{className:"mt-2 max-w-3xl text-sm text-slate-600 md:text-base",children:l}):null]}),n]}),e.jsx("div",{className:"mt-6",children:r})]})}function Fl({icon:t,title:s,desc:a,chips:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl bg-emerald-50 text-emerald-700",children:t}),l!=null&&l.length?e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:l.map(n=>e.jsx(sa,{label:n.label,tone:n.tone},n.label))}):null]}),e.jsx("div",{className:"mt-4 text-base font-semibold text-slate-900",children:s}),e.jsx("div",{className:"mt-2 text-sm text-slate-600",children:a})]})}function Wp({value:t,label:s}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsx("div",{className:"text-2xl font-semibold tracking-tight text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s})]})}function aU({active:t,onJump:s}){const a=[{k:"product",label:"Product"},{k:"solutions",label:"Solutions"},{k:"how",label:"How it works"},{k:"modules",label:"Modules"},{k:"security",label:"Security"},{k:"integrations",label:"Integrations"},{k:"esg",label:"ESG"},{k:"faq",label:"FAQ"}];return e.jsx("nav",{className:"hidden items-center gap-1 lg:flex",children:a.map(l=>e.jsx("button",{type:"button",onClick:()=>s(l.k),className:zd("rounded-full px-3 py-2 text-sm font-semibold ring-1 transition",t===l.k?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:t===l.k?{background:Lo.green}:void 0,children:l.label},l.k))})}function lU({items:t}){const[s,a]=d.useState(0);return e.jsx("div",{className:"space-y-2",children:t.map((l,n)=>{const r=s===n;return e.jsxs("div",{className:"overflow-hidden rounded-3xl border border-slate-200 bg-white",children:[e.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 px-5 py-4 text-left hover:bg-slate-50",onClick:()=>a(r?-1:n),children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:l.q}),e.jsx(li,{className:zd("h-5 w-5 text-slate-500 transition",r?"rotate-180":"rotate-0")})]}),e.jsx(lt,{initial:!1,children:r?e.jsx(We.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.18},children:e.jsx("div",{className:"border-t border-slate-200 px-5 py-4 text-sm text-slate-700",children:l.a})}):null})]},l.q)})})}function nU(){const t=Xd(),s=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],a=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],l=[{q:"Do employees need a separate CorporatePay app?",a:"No. Employees use the normal EVzone user apps. At checkout, CorporatePay appears as a payment option when they are linked to an organization and eligible under policy."},{q:"How do approvals work?",a:"Approvals can be auto-approved under thresholds (when allowed), or routed to multi-level approvers based on amount, module, marketplace, vendor, or risk. Decisions are fully audited."},{q:"Can we buy high-value assets that exceed monthly budgets?",a:"Yes. Use RFQ/Quote Requests to request supplier quotes, compare offers, and convert to a purchase order. CapEx vs OpEx and milestone payments can be configured."},{q:"What payment models are supported?",a:"Three models: Pay-as-you-go through the corporate wallet, Credit line with a limit, and Prepaid deposit where services stop when the balance is depleted."},{q:"Can we export to our ERP?",a:"Yes. Export CSV/JSON or connect via secure APIs and webhooks (invoice created/paid, approval completed, limit breached)."},{q:"How is EVzone Support handled?",a:"Support is embedded as a role in your console. Support sessions are visible, watermarked, and auditable. No silent actions. Optional session recording is policy-controlled."}],[n,r]=d.useState(!1),[i,o]=d.useState("product"),[c,x]=d.useState({org:"",name:"",email:"",phone:"",note:""}),[j,g]=d.useState(!1),N=T=>{r(!1),o(T);const k=document.getElementById(T);k&&k.scrollIntoView({behavior:"smooth",block:"start"})};d.useEffect(()=>{const T=["product","solutions","how","modules","security","integrations","esg","faq"],k=()=>{const q=window.scrollY,L=T.map(U=>{const ae=document.getElementById(U);if(!ae)return null;const ie=ae.getBoundingClientRect().top+window.scrollY;return{id:U,top:ie}}).filter(Boolean);let R="product";for(const U of L)q+160>=U.top&&(R=U.id);o(R)};return window.addEventListener("scroll",k,{passive:!0}),k(),()=>window.removeEventListener("scroll",k)},[]);const $=()=>{!c.org.trim()||!c.name.trim()||!/\S+@\S+\.\S+/.test(c.email)||g(!0)};return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsxs("header",{className:"sticky top-0 z-30 border-b border-slate-200 bg-white/80 backdrop-blur",children:[e.jsxs("div",{className:"mx-auto flex max-w-[1200px] items-center justify-between gap-3 px-4 py-3 md:px-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl text-white",style:{background:Lo.green},children:e.jsx(ht,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"CorporatePay"}),e.jsx("div",{className:"text-xs text-slate-500",children:"EVzone corporate admin console"})]})]}),e.jsx(aU,{active:i,onJump:N}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Zo,{variant:"primary",onClick:()=>t(is.CONSOLE.DASHBOARD),children:[e.jsx(ox,{className:"h-4 w-4"})," Launch console"]}),e.jsxs(Zo,{variant:"outline",onClick:()=>N("faq"),children:[e.jsx(Jk,{className:"h-4 w-4"})," Request demo"]}),e.jsx("button",{type:"button",className:"rounded-2xl border border-slate-200 bg-white p-2 text-slate-800 shadow-sm hover:bg-slate-50 lg:hidden",onClick:()=>r(T=>!T),"aria-label":"Open menu",children:n?e.jsx(Ye,{className:"h-5 w-5"}):e.jsx(ay,{className:"h-5 w-5"})})]})]}),e.jsx(lt,{children:n?e.jsx(We.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.18},className:"border-t border-slate-200 bg-white lg:hidden",children:e.jsx("div",{className:"mx-auto max-w-[1200px] px-4 py-3 md:px-6",children:e.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{k:"product",label:"Product"},{k:"solutions",label:"Solutions"},{k:"how",label:"How it works"},{k:"modules",label:"Modules"},{k:"security",label:"Security"},{k:"integrations",label:"Integrations"},{k:"esg",label:"ESG"},{k:"faq",label:"FAQ"}].map(T=>e.jsx("button",{type:"button",onClick:()=>N(T.k),className:zd("rounded-2xl border px-3 py-3 text-left text-sm font-semibold",i===T.k?"border-emerald-300 bg-emerald-50 text-emerald-800":"border-slate-200 bg-white text-slate-700 hover:bg-slate-50"),children:T.label},T.k))})})}):null})]}),e.jsxs("main",{children:[e.jsx("div",{className:"mx-auto max-w-[1200px] px-4 py-10 md:px-6 md:py-14",children:e.jsxs("div",{className:"grid grid-cols-1 gap-8 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-7",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(sa,{label:"Approvals-first",tone:"info"}),e.jsx(sa,{label:"Budget enforcement",tone:"good"}),e.jsx(sa,{label:"ERP-ready",tone:"neutral"}),e.jsx(sa,{label:"SSO-ready (Phase 2)",tone:"neutral"})]}),e.jsxs("h1",{className:"mt-5 text-3xl font-semibold tracking-tight text-slate-900 md:text-5xl",children:["Corporate rides, services, and purchases with",e.jsx("span",{className:"text-emerald-700",children:" serious approvals"}),"."]}),e.jsx("p",{className:"mt-4 max-w-2xl text-base text-slate-600 md:text-lg",children:"CorporatePay is the web admin console that centralizes budgets, approvals, invoicing, and policy enforcement across the EVzone Super App. Employees keep using the normal EVzone apps. CorporatePay simply governs how the company pays."}),e.jsxs("div",{className:"mt-6 flex flex-col gap-2 sm:flex-row sm:items-center",children:[e.jsxs(Zo,{variant:"primary",onClick:()=>t(is.CONSOLE.DASHBOARD),children:[e.jsx(ox,{className:"h-4 w-4"})," Enter Dashboard"]}),e.jsxs(Zo,{variant:"outline",onClick:()=>N("how"),children:[e.jsx(et,{className:"h-4 w-4"})," See how it works"]}),e.jsxs(Zo,{variant:"outline",onClick:()=>{sU("corporatepay-one-pager.txt","CorporatePay one-pager (demo).","text/plain")},children:[e.jsx(gt,{className:"h-4 w-4"})," Download one-pager"]})]}),e.jsxs("div",{className:"mt-7 grid grid-cols-2 gap-3 md:grid-cols-4",children:[e.jsx(Wp,{value:"3",label:"Payment models"}),e.jsx(Wp,{value:"Daily",label:"Invoice options"}),e.jsx(Wp,{value:"4",label:"Alert channels"}),e.jsx(Wp,{value:"Audit",label:"Every action"})]}),e.jsx("div",{className:"mt-6 rounded-3xl border border-amber-200 bg-amber-50 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-white text-amber-800 ring-1 ring-amber-200",children:e.jsx(ct,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Best for organizations without fleets"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:"Hospitals, tour companies, and corporates can run company-paid mobility and procurement without owning vehicles."})]})]})})]}),e.jsx("div",{className:"lg:col-span-5",children:e.jsxs("div",{className:"relative overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsx("div",{className:"border-b border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"grid h-9 w-9 place-items-center rounded-2xl bg-emerald-50 text-emerald-700",children:e.jsx(ox,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Admin console preview"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Budgets  Approvals  Invoices"})]})]}),e.jsx(sa,{label:"Live",tone:"good"})]})}),e.jsxs("div",{className:"bg-slate-50 p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx(em,{icon:e.jsx($a,{className:"h-4 w-4"}),title:"Wallet + Credit + Prepaid",value:"Payment models"}),e.jsx(em,{icon:e.jsx(ig,{className:"h-4 w-4"}),title:"Approval workflows",value:"Auto + multi-level"}),e.jsx(em,{icon:e.jsx(wt,{className:"h-4 w-4"}),title:"Invoices",value:"Daily/Weekly/Monthly"}),e.jsx(em,{icon:e.jsx(tu,{className:"h-4 w-4"}),title:"Webhooks",value:"Invoice/Approvals/Limits"}),e.jsx(em,{icon:e.jsx(Co,{className:"h-4 w-4"}),title:"Audit + Compliance",value:"Forensic exports"})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Go-live readiness"}),e.jsx("div",{className:"mt-1 text-lg font-semibold text-slate-900",children:"92%"})]}),e.jsx("div",{className:"h-2 w-28 overflow-hidden rounded-full bg-slate-100",children:e.jsx("div",{className:"h-full rounded-full",style:{width:"92%",background:Lo.green}})})]}),e.jsx("div",{className:"mt-3 text-xs text-slate-600",children:"Finish invoice group routing to unlock full automation."})]})]}),e.jsx("div",{className:"absolute -right-20 -top-24 h-72 w-72 rounded-full",style:{background:"rgba(3,205,140,0.18)"}}),e.jsx("div",{className:"absolute -bottom-24 -left-24 h-72 w-72 rounded-full",style:{background:"rgba(247,127,0,0.14)"}})]})})]})}),e.jsxs("div",{className:"mx-auto max-w-[1200px] px-4 pb-10 md:px-6 md:pb-14",children:[e.jsxs(zi,{id:"product",eyebrow:"Product",title:"A single corporate control plane for EVzone",subtitle:"CorporatePay centralizes financial controls, policies, and approvals across rides, services, marketplaces, and high-value procurement.",right:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(sa,{label:"Role-based",tone:"neutral"}),e.jsx(sa,{label:"Audit-ready",tone:"info"}),e.jsx(sa,{label:"Policy-driven",tone:"good"})]}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(Fl,{icon:e.jsx(ig,{className:"h-6 w-6"}),title:"Approvals that scale",desc:"Auto-approve under thresholds (where allowed) and route higher-risk actions to multi-level approvers. All decisions are auditable.",chips:[{label:"Core",tone:"neutral"},{label:"SLA timers",tone:"info"}]}),e.jsx(Fl,{icon:e.jsx($a,{className:"h-6 w-6"}),title:"Budgets and spend controls",desc:"Org, group, user, module, and marketplace budgets. Hard vs soft caps, alerts, forecasting, and emergency exceptions.",chips:[{label:"Core",tone:"neutral"},{label:"Forecasting",tone:"info"}]}),e.jsx(Fl,{icon:e.jsx(wt,{className:"h-6 w-6"}),title:"Invoicing and reconciliation",desc:"Daily, weekly, monthly invoicing. Invoice groups for AP routing. Exports for ERP reconciliation with audit trails.",chips:[{label:"Core",tone:"neutral"},{label:"ERP-ready",tone:"neutral"}]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(Fl,{icon:e.jsx(fw,{className:"h-6 w-6"}),title:"RFQ for high-value assets",desc:"Request quotes for assets that exceed monthly budgets. Compare offers, convert to purchase orders, and manage milestone payments.",chips:[{label:"Core",tone:"neutral"},{label:"CapEx",tone:"info"}]}),e.jsx(Fl,{icon:e.jsx(f0,{className:"h-6 w-6"}),title:"Multi-channel reminders",desc:"Automated notifications for due invoices, overdue status, pending approvals, and limit breaches via Email, WhatsApp, WeChat, and SMS.",chips:[{label:"Core",tone:"neutral"},{label:"Delivery logs",tone:"info"}]}),e.jsx(Fl,{icon:e.jsx(Co,{className:"h-6 w-6"}),title:"Security and compliance",desc:"Audit logs for every action, MFA policies, device trust, support mode gating, dual control, and forensic exports.",chips:[{label:"Core",tone:"neutral"},{label:"Forensics",tone:"info"}]})]})]}),e.jsx("div",{className:"mt-12",children:e.jsx(zi,{id:"solutions",eyebrow:"Solutions",title:"Built for corporates, hospitals, and tour companies",subtitle:"Use the same control plane across industries, while applying policy templates and risk controls per program.",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(Cv,{title:"Corporate",icon:e.jsx(Xl,{className:"h-5 w-5"}),bullets:["Group budgets and chargeback","Procurement approvals","Consolidated invoicing","ERP exports and mapping"]}),e.jsx(Cv,{title:"Hospital",icon:e.jsx(Co,{className:"h-5 w-5"}),bullets:["Stricter approvals and audit","24/7 exceptions","Emergency travel rules","Vendor compliance docs"]}),e.jsx(Cv,{title:"Tour company",icon:e.jsx(Ii,{className:"h-5 w-5"}),bullets:["Airport routes and geo rules","Event manifests","Visitor scheduling","Approved vendor catalogs"]})]})})}),e.jsx("div",{className:"mt-12",children:e.jsx(zi,{id:"how",eyebrow:"How it works",title:"Employees keep the normal EVzone apps",subtitle:"CorporatePay lives in your web admin console. For employees, CorporatePay appears as a payment option at checkout only when eligible under policy.",right:e.jsxs(Zo,{variant:"outline",onClick:()=>N("modules"),children:[e.jsx(et,{className:"h-4 w-4"})," See supported modules"]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-7 space-y-3",children:[e.jsx(Hp,{n:1,title:"Create your organization",desc:"Add entities, billing contacts, invoice groups, and enable modules and marketplaces."}),e.jsx(Hp,{n:2,title:"Invite employees and assign groups",desc:"Assign roles, group membership, cost centers, spend limits, and auto-approval eligibility."}),e.jsx(Hp,{n:3,title:"Define budgets and approval rules",desc:"Set org, group, user, module, and marketplace budgets. Configure approval workflows per module and marketplace."}),e.jsx(Hp,{n:4,title:"Go live",desc:"Employees see CorporatePay at checkout. Invoices run on your chosen schedule and exports are audit-ready."})]}),e.jsx("div",{className:"lg:col-span-5",children:e.jsxs("div",{className:"rounded-[28px] border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Billing models"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Choose per organization"})]}),e.jsx(sa,{label:"Core",tone:"neutral"})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx(Sv,{title:"Pay-as-you-go wallet",desc:"Company-funded wallet used at checkout.",icon:e.jsx($a,{className:"h-4 w-4"})}),e.jsx(Sv,{title:"Credit line",desc:"Company credit limit with controls.",icon:e.jsx($c,{className:"h-4 w-4"})}),e.jsx(Sv,{title:"Prepaid deposit",desc:"Spend-down balance. Services stop when depleted.",icon:e.jsx(rg,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Invoicing frequency can be daily, weekly, monthly, or custom by invoice group."})]})})]})})}),e.jsx("div",{className:"mt-12",children:e.jsxs(zi,{id:"modules",eyebrow:"Coverage",title:"Modules and marketplaces supported",subtitle:"CorporatePay can govern spending across service modules and marketplaces, with an expansion slot for future modules and marketplaces.",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-6",children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Service modules"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Enable/disable per org and pilot group"})]}),e.jsx(sa,{label:"Core",tone:"neutral"})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:s.map(T=>e.jsx(sa,{label:T,tone:T==="Other Service Module"?"neutral":"good"},T))})]})}),e.jsx("div",{className:"lg:col-span-6",children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Marketplaces"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Under E-Commerce (including MyLiveDealz)"})]}),e.jsx(sa,{label:"Core",tone:"neutral"})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:a.map(T=>e.jsx(sa,{label:T,tone:T==="MyLiveDealz"?"accent":T==="Other Marketplace"?"neutral":"good"},T))})]})})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"High-value procurement"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"RFQ flow for assets that do not fit within monthly budgets."})]}),e.jsx(sa,{label:"RFQ",tone:"info"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-4",children:[e.jsx(Xp,{n:1,title:"Create RFQ",desc:"Specs, quantities, delivery location"}),e.jsx(Xp,{n:2,title:"Get quotes",desc:"Invite vendors + Q&A thread"}),e.jsx(Xp,{n:3,title:"Compare",desc:"Table view + approvals"}),e.jsx(Xp,{n:4,title:"Convert",desc:"PO  invoice  payments"})]})]})]})}),e.jsx("div",{className:"mt-12",children:e.jsx(zi,{id:"security",eyebrow:"Security",title:"Security, audit, and support controls",subtitle:"Designed for enterprise-grade governance with auditable actions, policy enforcement, and support-mode safeguards.",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(Fl,{icon:e.jsx(ra,{className:"h-6 w-6"}),title:"MFA and device trust",desc:"Require MFA for finance and approvers. Trust devices with expiry and trigger step-up prompts for risk signals.",chips:[{label:"Core",tone:"neutral"},{label:"Conditional access",tone:"info"}]}),e.jsx(Fl,{icon:e.jsx(Co,{className:"h-6 w-6"}),title:"Dual-control for sensitive actions",desc:"Two-person approval for production key rotation, retention changes, support write actions, and forensic exports.",chips:[{label:"Premium",tone:"info"},{label:"Forensics",tone:"info"}]}),e.jsx(Fl,{icon:e.jsx($d,{className:"h-6 w-6"}),title:"Support mode gating",desc:"EVzone Support is an embedded role. Sessions are visible, watermarked, and never silent. Optional recording is policy-controlled.",chips:[{label:"Core",tone:"neutral"},{label:"Premium recording",tone:"info"}]})]})})}),e.jsx("div",{className:"mt-12",children:e.jsxs(zi,{id:"integrations",eyebrow:"Integrations",title:"ERP exports, APIs, and webhooks",subtitle:"Sync invoices and ledger data to your ERP with secure APIs, scoped keys, and operational webhooks.",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(Fl,{icon:e.jsx(wt,{className:"h-6 w-6"}),title:"CSV and JSON exports",desc:"Export transactions, invoices, and approvals. Use invoice group codes and GL mappings for clean accounting workflows.",chips:[{label:"Core",tone:"neutral"}]}),e.jsx(Fl,{icon:e.jsx(Lc,{className:"h-6 w-6"}),title:"Secure API keys and scopes",desc:"Least-privilege scopes, rotation, revocation, IP allowlists, and audit trails for all access.",chips:[{label:"Core",tone:"neutral"}]}),e.jsx(Fl,{icon:e.jsx(Ii,{className:"h-6 w-6"}),title:"Webhooks",desc:"Invoice created/paid, approval completed, and limit breached events with delivery logs and retries.",chips:[{label:"Core",tone:"neutral"},{label:"Inspector",tone:"info"}]})]}),e.jsx("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Phase 2"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"SSO (Google/Microsoft) and HRIS imports to automate user provisioning."})]}),e.jsx(sa,{label:"Phase 2",tone:"neutral"})]})})]})}),e.jsx("div",{className:"mt-12",children:e.jsxs(zi,{id:"esg",eyebrow:"Sustainability",title:"Sustainability and ESG reporting",subtitle:"Measure EV usage and charging utilization across your corporate activity, with emissions estimates and template-aligned exports.",right:e.jsx(sa,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(Fl,{icon:e.jsx(Ld,{className:"h-6 w-6"}),title:"EV usage metrics",desc:"Track EV share, charging sessions, off-peak ratio, and utilization by site or group."}),e.jsx(Fl,{icon:e.jsx(Sr,{className:"h-6 w-6"}),title:"Scorecards",desc:"Simple, explainable scorecards that your team can adapt to internal sustainability programs."}),e.jsx(Fl,{icon:e.jsx(wt,{className:"h-6 w-6"}),title:"Template exports",desc:"CSV/JSON exports aligned to your internal ESG templates, plus Print-to-PDF packs."})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-emerald-50 p-3 text-xs text-emerald-900 ring-1 ring-emerald-200",children:"Tip: ESG reporting is strongest when purpose tags and cost centers are enforced in policies."})]})}),e.jsx("div",{className:"mt-12",children:e.jsx(zi,{id:"faq",eyebrow:"FAQ",title:"Questions and demo request",subtitle:"Send your requirements and we will tailor policy templates for your organization.",right:e.jsx(sa,{label:"Fast setup",tone:"good"}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-7",children:e.jsx(lU,{items:l})}),e.jsx("div",{className:"lg:col-span-5",children:e.jsxs("div",{className:"rounded-[28px] border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Request a demo"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"We will reply with a tailored walkthrough."})]}),e.jsx(sa,{label:"Free",tone:"neutral"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3",children:[e.jsx(Kp,{label:"Organization",value:c.org,onChange:T=>x(k=>({...k,org:T})),placeholder:"Company name",required:!0}),e.jsx(Kp,{label:"Your name",value:c.name,onChange:T=>x(k=>({...k,name:T})),placeholder:"Full name",required:!0}),e.jsx(Kp,{label:"Work email",value:c.email,onChange:T=>x(k=>({...k,email:T})),placeholder:"name@company.com",required:!0}),e.jsx(Kp,{label:"Phone",value:c.phone,onChange:T=>x(k=>({...k,phone:T})),placeholder:"Optional"}),e.jsx(rU,{label:"What do you want to control?",value:c.note,onChange:T=>x(k=>({...k,note:T})),placeholder:"Example: approvals for rides, RFQ for vehicles, invoice groups for 3 departments",rows:4}),e.jsxs(Zo,{variant:"primary",onClick:$,children:[e.jsx(Jk,{className:"h-4 w-4"})," Submit request"]}),j?e.jsx("div",{className:"rounded-2xl bg-emerald-50 p-3 text-xs text-emerald-900 ring-1 ring-emerald-200",children:"Submitted. We will reach out soon."}):e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600 ring-1 ring-slate-200",children:"By submitting, you confirm you want CorporatePay onboarding. In production, this creates a ticket and onboarding checklist."})]})]})})]})})}),e.jsxs("footer",{className:"mt-12 rounded-[28px] border border-slate-200 bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-6 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl text-white",style:{background:Lo.green},children:e.jsx(ht,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"CorporatePay"}),e.jsx("div",{className:"text-xs text-slate-500",children:"EVzone Super App"})]})]}),e.jsx("div",{className:"mt-3 max-w-md text-sm text-slate-600",children:"CorporatePay is the corporate admin console that governs how organizations pay for rides, services, and purchases across EVzone."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsx(sa,{label:"Audit-ready",tone:"info"}),e.jsx(sa,{label:"Approvals-first",tone:"good"}),e.jsx(sa,{label:"ERP exports",tone:"neutral"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 sm:grid-cols-3",children:[e.jsx(Av,{title:"Product",links:["Dashboard","Approvals","Budgets","Invoices","RFQ"]}),e.jsx(Av,{title:"Security",links:["MFA","Device trust","Dual control","Forensic exports"]}),e.jsx(Av,{title:"Integrations",links:["CSV/JSON","Webhooks","API keys","Sandbox"]})]})]}),e.jsxs("div",{className:"mt-6 border-t border-slate-200 pt-4 text-xs text-slate-500",children:[" ",new Date().getFullYear()," EVzone CorporatePay. All rights reserved."]})]})]})]})]})}function em({icon:t,title:s,value:a}){return e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-3xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"grid h-9 w-9 place-items-center rounded-2xl bg-slate-50 text-slate-700",children:t}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:s}),e.jsx("div",{className:"text-xs text-slate-500",children:a})]})]}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]})}function Cv({title:t,icon:s,bullets:a}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsx("div",{className:"grid h-11 w-11 place-items-center rounded-2xl bg-slate-50 text-slate-700",children:s}),e.jsx(sa,{label:"Template",tone:"neutral"})]}),e.jsx("div",{className:"mt-4 text-base font-semibold text-slate-900",children:t}),e.jsx("ul",{className:"mt-3 space-y-2 text-sm text-slate-700",children:a.map(l=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:Lo.green}}),e.jsx("span",{children:l})]},l))})]})}function Hp({n:t,title:s,desc:a}){return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl text-white",style:{background:Lo.green},children:e.jsx("span",{className:"text-sm font-black",children:t})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:s}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a})]})]})})}function Sv({title:t,desc:s,icon:a}){return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:s})]}),e.jsx("div",{className:"grid h-9 w-9 place-items-center rounded-2xl bg-slate-50 text-slate-700",children:a})]})})}function Xp({n:t,title:s,desc:a}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsx(sa,{label:`Step ${t}`,tone:"neutral"}),e.jsx(et,{className:"h-4 w-4 text-slate-400"})]}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:s}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a})]})}function Kp({label:t,value:s,onChange:a,placeholder:l,required:n}){const r=!!n&&!s.trim();return e.jsxs("label",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-xs font-semibold text-slate-600",children:[t,n?e.jsx("span",{className:"text-rose-600",children:" *"}):null]}),r?e.jsx("div",{className:"text-xs font-semibold text-rose-600",children:"Required"}):null]}),e.jsx("input",{value:s,onChange:i=>a(i.target.value),placeholder:l,className:zd("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-rose-300 bg-white text-slate-900 focus:ring-rose-100":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function rU({label:t,value:s,onChange:a,placeholder:l,rows:n=4}){return e.jsxs("label",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),e.jsx("textarea",{value:s,onChange:r=>a(r.target.value),placeholder:l,rows:n,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"})]})}function Av({title:t,links:s}){return e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),e.jsx("ul",{className:"mt-3 space-y-2 text-sm text-slate-600",children:s.map(a=>e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-slate-900",children:a})},a))})]})}const t4={green:"#03CD8C"};function s4(...t){return t.filter(Boolean).join(" ")}function iU(){const t=Xd(),[s,a]=d.useState(""),[l,n]=d.useState(""),[r,i]=d.useState(!1),[o,c]=d.useState("Acme Group Ltd"),[x,j]=d.useState(!1),[g,N]=d.useState(!1),[$,T]=d.useState(""),k=["Acme Group Ltd","EVzone Demo Org","Kampala Holdings"],q=R=>{if(R.preventDefault(),T(""),!s||!l){T("Please enter email and password");return}N(!0),setTimeout(()=>{N(!1),t(is.CONSOLE.DASHBOARD)},1e3)},L=()=>{N(!0),setTimeout(()=>{N(!1),t(is.CONSOLE.DASHBOARD)},800)};return e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-br from-slate-50 via-white to-emerald-50 p-4",children:e.jsxs(We.div,{initial:{opacity:0,y:20,scale:.98},animate:{opacity:1,y:0,scale:1},transition:{duration:.3},className:"w-full max-w-md",children:[e.jsxs("div",{className:"overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsx("div",{className:"border-b border-slate-100 bg-gradient-to-r from-slate-50 to-white px-6 py-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white shadow-lg",style:{background:t4.green},children:e.jsx(ht,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-slate-900",children:"CorporatePay"}),e.jsx("div",{className:"text-sm text-slate-500",children:"Sign in to your account"})]})]})}),e.jsxs("form",{onSubmit:q,className:"space-y-4 p-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-xs font-semibold text-slate-600",children:"Organization"}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>j(!x),className:"flex w-full items-center justify-between rounded-xl border border-slate-200 bg-white px-3 py-2.5 text-left text-sm font-medium text-slate-900 transition hover:border-slate-300 focus:outline-none focus:ring-2 focus:ring-emerald-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xl,{className:"h-4 w-4 text-slate-400"}),e.jsx("span",{children:o})]}),e.jsx(li,{className:s4("h-4 w-4 text-slate-400 transition-transform",x&&"rotate-180")})]}),x&&e.jsx(We.div,{initial:{opacity:0,y:-8},animate:{opacity:1,y:0},className:"absolute left-0 right-0 z-10 mt-1 overflow-hidden rounded-xl border border-slate-200 bg-white shadow-lg",children:k.map(R=>e.jsxs("button",{type:"button",onClick:()=>{c(R),j(!1)},className:s4("flex w-full items-center gap-2 px-3 py-2 text-left text-sm transition hover:bg-slate-50",o===R?"bg-emerald-50 font-medium text-emerald-700":"text-slate-700"),children:[e.jsx(Xl,{className:"h-4 w-4"}),R]},R))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-xs font-semibold text-slate-600",children:"Email address"}),e.jsxs("div",{className:"relative",children:[e.jsx(Xs,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"email",value:s,onChange:R=>a(R.target.value),placeholder:"you@company.com",className:"w-full rounded-xl border border-slate-200 bg-white py-2.5 pl-10 pr-3 text-sm text-slate-900 placeholder:text-slate-400 focus:border-emerald-300 focus:outline-none focus:ring-2 focus:ring-emerald-200"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-xs font-semibold text-slate-600",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(ra,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:r?"text":"password",value:l,onChange:R=>n(R.target.value),placeholder:"",className:"w-full rounded-xl border border-slate-200 bg-white py-2.5 pl-10 pr-10 text-sm text-slate-900 placeholder:text-slate-400 focus:border-emerald-300 focus:outline-none focus:ring-2 focus:ring-emerald-200"}),e.jsx("button",{type:"button",onClick:()=>i(!r),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600",children:r?e.jsx(WF,{className:"h-4 w-4"}):e.jsx(ty,{className:"h-4 w-4"})})]})]}),$&&e.jsx("div",{className:"rounded-lg bg-rose-50 px-3 py-2 text-xs font-medium text-rose-700",children:$}),e.jsx("div",{className:"text-right",children:e.jsx("button",{type:"button",className:"text-xs font-medium text-emerald-600 hover:text-emerald-700 hover:underline",children:"Forgot password?"})}),e.jsx("button",{type:"submit",disabled:g,className:"flex w-full items-center justify-center gap-2 rounded-xl px-4 py-3 text-sm font-semibold text-white shadow-lg transition hover:opacity-95 focus:outline-none focus:ring-4 focus:ring-emerald-200 disabled:opacity-60",style:{background:t4.green},children:g?e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent"}):"Sign in"}),e.jsxs("div",{className:"relative py-2",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-slate-200"})}),e.jsx("div",{className:"relative flex justify-center",children:e.jsx("span",{className:"bg-white px-3 text-xs text-slate-500",children:"or continue with"})})]}),e.jsxs("button",{type:"button",onClick:L,disabled:g,className:"flex w-full items-center justify-center gap-2 rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm font-semibold text-slate-700 shadow-sm transition hover:bg-slate-50 focus:outline-none focus:ring-4 focus:ring-slate-100 disabled:opacity-60",children:[e.jsxs("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),e.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),e.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),e.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Continue with Google SSO"]})]}),e.jsxs("div",{className:"border-t border-slate-100 bg-slate-50 px-6 py-4 text-center text-xs text-slate-500",children:["By signing in, you agree to our"," ",e.jsx("a",{href:"#",className:"font-medium text-emerald-600 hover:underline",children:"Terms of Service"})," ","and"," ",e.jsx("a",{href:"#",className:"font-medium text-emerald-600 hover:underline",children:"Privacy Policy"})]})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("button",{type:"button",onClick:()=>t(is.HOME),className:"text-sm font-medium text-slate-500 hover:text-slate-700",children:" Back to home"})})]})})}const oU=[{path:is.HOME,element:Xt.createElement(nU)},{path:is.SIGNIN,element:Xt.createElement(iU)}],au={green:"#03CD8C",orange:"#F77F00"};function $i(...t){return t.filter(Boolean).join(" ")}function dU(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function cU(t,s,a){return Math.max(s,Math.min(a,t))}function a4(t){if(!t)return"-";const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function Va({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:$i("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Js({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:au.green}:t==="accent"?{background:au.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:$i(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Qp({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:$i("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:$i("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function ac({icon:t,label:s,value:a,onChange:l,type:n="text",placeholder:r,hint:i,required:o,disabled:c}){const x=!!o&&!a.trim();return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"text-xs font-semibold text-slate-600",children:[s,o?e.jsx("span",{className:"text-rose-600",children:" *"}):null]}),i?e.jsx("div",{className:"text-xs text-slate-500",children:i}):null]}),e.jsxs("div",{className:$i("mt-2 flex items-center gap-2 rounded-2xl border bg-white px-3 py-2.5 shadow-sm focus-within:ring-4",c?"border-slate-200 bg-slate-50 text-slate-500":x?"border-rose-300 focus-within:ring-rose-100":"border-slate-200 focus-within:ring-emerald-100"),children:[e.jsx("span",{className:"text-slate-500",children:t}),e.jsx("input",{type:n,value:a,onChange:j=>l(j.target.value),placeholder:r,disabled:c,className:$i("w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400",c&&"text-slate-500")})]}),x?e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:"Required"}):null]})}function Ev({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="720px"}){return d.useEffect(()=>{const o=c=>c.key==="Escape"&&n();return t&&window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[10vh] z-50 mx-auto w-[min(820px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function uU({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:$i("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function mU(){const t=Xd(),[s,a]=d.useState([]),l=y=>{const re=dU("toast");a(ve=>[{id:re,...y},...ve].slice(0,4)),window.setTimeout(()=>a(ve=>ve.filter(P=>P.id!==re)),3200)},[n,r]=d.useState("login"),[i,o]=d.useState("admin@acme.com"),[c,x]=d.useState(""),[j,g]=d.useState(!0),[N,$]=d.useState(!0),[T,k]=d.useState(!1),[q,L]=d.useState(!1),[R,U]=d.useState("196.43.199.81"),[ae,ie]=d.useState("Kampala, UG"),[_,W]=d.useState("Windows Chrome"),[J,we]=d.useState({location:"Kampala, UG",ts:Date.now()-26*60*60*1e3}),G=d.useMemo(()=>{let y=5;N&&(y+=35),T&&(y+=25),q&&(y+=45);const re=i.toLowerCase();return(re.includes("finance")||re.includes("account"))&&(y+=15),cU(y,0,100)},[N,T,q,i]),be=d.useMemo(()=>G>=70?{label:"High",tone:"bad"}:G>=40?{label:"Medium",tone:"warn"}:{label:"Low",tone:"good"},[G]),[Ge,Me]=d.useState(!1),[je,Ue]=d.useState(""),[Oe,he]=d.useState(""),[Y,Ie]=d.useState(null),[ce,me]=d.useState(""),[pe]=d.useState(["Acme Group Ltd","Kampala Holdings","EVzone Demo Org"]),[de,ye]=d.useState("Acme Group Ltd"),Qe=d.useMemo(()=>i.toLowerCase().includes("admin"),[i]),[Fe,ke]=d.useState(!1),[fe,Ve]=d.useState("support@evzone.com"),[ne,Te]=d.useState(""),[Ee,Re]=d.useState(!1),[ze,qe]=d.useState(""),[He,_e]=d.useState(!0),le=d.useMemo(()=>fe.trim().toLowerCase().endsWith("@evzone.com")&&ne.trim().length>=6,[fe,ne]),[z,Pe]=d.useState(()=>[{id:"S-001",device:"Windows Chrome",location:"Kampala, UG",ip:"196.43.199.81",trusted:!1,lastSeenTs:Date.now()-2*60*1e3,current:!0},{id:"S-002",device:"Android App",location:"Kampala, UG",ip:"41.190.31.12",trusted:!0,lastSeenTs:Date.now()-6*60*60*1e3,current:!1},{id:"S-003",device:"Mac Safari",location:"Wuxi, CN",ip:"103.42.111.9",trusted:!1,lastSeenTs:Date.now()-6*24*60*60*1e3,current:!1}]),[Be,xe]=d.useState(!1),[Ne,M]=d.useState(""),[H,Ae]=d.useState(""),[oe,De]=d.useState("Manager"),[$e,ge]=d.useState(""),[ue,Ke]=d.useState([]),b=["Org Admin","Manager","Accountant","Approver","Travel Coordinator","User"],v=d.useMemo(()=>{const y=i.toLowerCase();return y.includes("finance")||y.includes("account")?"Accountant":y.includes("approver")?"Approver":y.includes("travel")?"Travel Coordinator":y.includes("admin")?"Org Admin":"Manager"},[i]),u=d.useMemo(()=>{const y=v==="Accountant"||v==="Approver";return G>=40||y},[G,v]),C=()=>{if(!i.trim()||!c.trim()){l({title:"Missing details",message:"Enter your email and password to continue.",kind:"warn"});return}l({title:"Credentials verified",message:"Checking session risk...",kind:"success"});const y={email:i,role:v,isSupport:!1,needsOrgSelect:Qe};if(u){Ie(y),Me(!0);return}Q(y)},Q=y=>{if(y.needsOrgSelect){r("org");return}ye(de),r("ready"),l({title:"Signed in",message:`Role: ${y.role}`,kind:"success"})},O=()=>{if(Y){if(je.trim().length<6){l({title:"Invalid code",message:"Enter a 6-digit code.",kind:"warn"});return}if(Ee&&!Oe.trim()){l({title:"Justification required",message:"Provide a reason for support session actions.",kind:"warn"});return}Me(!1),Ue(""),l({title:"Step-up verified",message:"Security check passed. Continuing...",kind:"success"}),Q(Y),Ie(null)}},ee=()=>{ke(!0)},F=()=>{if(!le){l({title:"Not allowed",message:"Use an EVzone email and valid key.",kind:"warn"});return}const y=`SUP-${Math.floor(1e5+Math.random()*9e5)}`;qe(y),Re(!0),ke(!1),Ie({email:fe,role:"EVzone Support",isSupport:!0,needsOrgSelect:!0}),he("Troubleshooting request"),Me(!0),l({title:"Support mode requested",message:"Step-up authentication required.",kind:"info"})},D=()=>{r("ready"),l({title:"Organization selected",message:`Opening ${de}.`,kind:"success"})},m=()=>{if(!Ne.trim()||!H.trim()||!i.trim()){l({title:"Missing fields",message:"Organization, your name, and email are required.",kind:"warn"});return}const y=`TCK-${Math.floor(1e5+Math.random()*9e5)}`,re={id:y,org:Ne.trim(),requester:H.trim(),email:i.trim(),roleNeeded:oe,reason:$e.trim(),createdAt:Date.now(),status:"Submitted"};Ke(ve=>[re,...ve]),xe(!1),M(""),Ae(""),ge(""),l({title:"Request submitted",message:`Ticket created: ${y}. Org admin notified.`,kind:"success"})},A=y=>{Pe(re=>re.filter(ve=>ve.id!==y)),l({title:"Session revoked",message:`Device session ${y} revoked.`,kind:"success"})},f=()=>{Pe(y=>y.filter(re=>re.current)),l({title:"Sessions revoked",message:"All other sessions revoked.",kind:"success"})},B=()=>{Re(!1),qe(""),l({title:"Support session ended",message:"Support mode disabled.",kind:"info"})},p=d.useMemo(()=>{const y=ce.trim().toLowerCase();return y?pe.filter(re=>re.toLowerCase().includes(y)):pe},[ce,pe]),E=d.useMemo(()=>{const y=[];return y.push({label:"New device",on:N,tone:"warn"}),y.push({label:"New location",on:T,tone:"warn"}),y.push({label:"Impossible travel",on:q,tone:"bad"}),y},[N,T,q]),se=d.useMemo(()=>Ee?{label:`Support Session: ${ze}`,tone:"warn"}:{label:`Risk: ${be.label} (${G})`,tone:be.tone},[Ee,ze,be,G]);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(uU,{toasts:s,onDismiss:y=>a(re=>re.filter(ve=>ve.id!==y))}),Ee&&He?e.jsxs("div",{className:"pointer-events-none fixed inset-0 z-0 opacity-[0.08]",children:[e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"repeating-linear-gradient(-22deg, rgba(2,6,23,1) 0, rgba(2,6,23,1) 1px, transparent 1px, transparent 240px)"}}),e.jsx("div",{className:"absolute inset-0 grid place-items-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl font-black tracking-tight text-slate-900",children:"EVzone Support Session"}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:"Audited  No silent actions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-700",children:ze})]})})]}):null,Ee?e.jsx("div",{className:"sticky top-0 z-20 border-b border-amber-200 bg-amber-50",children:e.jsxs("div",{className:"mx-auto flex max-w-7xl flex-col gap-2 px-4 py-3 md:flex-row md:items-center md:justify-between md:px-6",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-white text-amber-800 ring-1 ring-amber-200",children:e.jsx(yt,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Support mode active"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-700",children:["Session ",ze,". View-only by default. Any write action requires justification and is audit logged."]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Js,{variant:"outline",className:"text-xs",onClick:()=>_e(y=>!y),children:[e.jsx(Su,{className:"h-4 w-4"})," ",He?"Hide":"Show"," watermark"]}),e.jsxs(Js,{variant:"danger",className:"text-xs",onClick:B,children:[e.jsx(bo,{className:"h-4 w-4"})," End session"]})]})]})}):null,e.jsxs("div",{className:"relative z-10 mx-auto max-w-7xl px-4 py-10 md:px-6",children:[e.jsxs("div",{className:"mb-6 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:au.green},children:e.jsx(wa,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"EVzone CorporatePay"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Login and organization selection"})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Va,{label:se.label,tone:se.tone}),e.jsxs(Js,{variant:"outline",onClick:()=>xe(!0),children:[e.jsx(ni,{className:"h-4 w-4"})," Request access"]}),e.jsxs(Js,{variant:"outline",onClick:ee,children:[e.jsx(yt,{className:"h-4 w-4"})," EVzone Support"]})]})]}),e.jsxs(lt,{mode:"wait",children:[n==="login"?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},children:e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"rounded-[28px] border border-slate-200 bg-white p-6 shadow-[0_30px_90px_rgba(2,8,23,0.10)]",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Session security"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Risk-based step-up prompts, device trust, and audit visibility."})]}),e.jsx(Va,{label:`Risk: ${be.label}`,tone:be.tone})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Risk signals"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Toggle to preview step-up prompts."})]}),e.jsx(Va,{label:`Score ${G}/100`,tone:be.tone})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-3",children:[e.jsx(Qp,{enabled:N,onChange:$,label:"New device",description:"Unseen device"}),e.jsx(Qp,{enabled:T,onChange:k,label:"New geo",description:"New region"}),e.jsx(Qp,{enabled:q,onChange:L,label:"Impossible travel",description:"Too fast"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx(lc,{icon:e.jsx(Hx,{className:"h-4 w-4"}),label:"Current location",value:ae}),e.jsx(lc,{icon:e.jsx(Ii,{className:"h-4 w-4"}),label:"IP",value:R}),e.jsx(lc,{icon:e.jsx(og,{className:"h-4 w-4"}),label:"Device",value:_})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-white p-3 text-xs text-slate-600",children:["Last sign-in: ",e.jsx("span",{className:"font-semibold text-slate-900",children:J.location}),"  ",a4(J.ts)]})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"What happens when risk is high"}),e.jsxs("ul",{className:"mt-3 space-y-2 text-sm text-slate-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-1 h-1.5 w-1.5 rounded-full",style:{background:au.green}}),"Step-up prompt (MFA code)"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-1 h-1.5 w-1.5 rounded-full",style:{background:au.orange}}),"Support sessions require justification and show a watermark"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-1 h-1.5 w-1.5 rounded-full",style:{background:au.green}}),"Active sessions can be revoked instantly"]})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Policy default: Finance and Approver roles require MFA."})]}),ue.length?e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Recent access requests"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Tickets created from this login page."})]}),e.jsx(Va,{label:`${ue.length}`,tone:"neutral"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:ue.slice(0,2).map(y=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:y.id}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[y.org,"  Role: ",y.roleNeeded]})]}),e.jsx(Va,{label:y.status,tone:y.status==="Submitted"?"info":"neutral"})]})},y.id))})]}):null]}),e.jsxs("div",{className:"rounded-[28px] border border-slate-200 bg-white p-6 shadow-[0_30px_90px_rgba(2,8,23,0.10)]",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Sign in"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Email and password. SSO is Phase 2."})]}),e.jsx(Va,{label:`Role detected: ${v}`,tone:"info"})]}),e.jsxs("div",{className:"mt-5 grid grid-cols-1 gap-4",children:[e.jsx(ac,{icon:e.jsx(Xs,{className:"h-4 w-4"}),label:"Email",required:!0,value:i,onChange:o,placeholder:"you@company.com"}),e.jsx(ac,{icon:e.jsx(ra,{className:"h-4 w-4"}),label:"Password",required:!0,value:c,onChange:x,type:"password",placeholder:""}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700",children:[e.jsx("input",{type:"checkbox",checked:j,onChange:y=>g(y.target.checked),className:"h-4 w-4 rounded border-slate-300"}),"Remember me"]}),e.jsx("button",{className:"text-sm font-semibold text-emerald-700 hover:underline",onClick:()=>l({title:"Reset password",message:"Password reset flow opened (demo).",kind:"info"}),type:"button",children:"Forgot password?"})]}),e.jsxs(Js,{variant:"primary",className:"w-full",onClick:C,children:[e.jsx(xu,{className:"h-4 w-4"})," Sign in"]}),e.jsxs("div",{className:"relative py-2",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-slate-200"})}),e.jsx("div",{className:"relative flex justify-center",children:e.jsx("span",{className:"bg-white px-3 text-xs font-semibold text-slate-500",children:"OR"})})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2",children:[e.jsxs(Js,{variant:"outline",disabled:!0,title:"Phase 2",children:[e.jsx("span",{className:"grid h-6 w-6 place-items-center rounded-xl bg-slate-100 text-slate-700",children:"G"}),"Continue with Google"]}),e.jsxs(Js,{variant:"outline",disabled:!0,title:"Phase 2",children:[e.jsx("span",{className:"grid h-6 w-6 place-items-center rounded-xl bg-slate-100 text-slate-700",children:"M"}),"Continue with Microsoft"]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"EVzone Support entry"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Role-gated sign-in with watermark and audited session."})]}),e.jsx(Va,{label:"Support",tone:"warn"})]}),e.jsxs(Js,{variant:"outline",className:"mt-3 w-full",onClick:ee,children:[e.jsx(yt,{className:"h-4 w-4"})," Sign in as EVzone Support"]}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Support mode actions are never silent and always logged."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Need access?"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Create a request ticket for your organization admin."}),e.jsxs(Js,{variant:"accent",className:"mt-3 w-full",onClick:()=>xe(!0),children:[e.jsx(ni,{className:"h-4 w-4"})," Request access"]})]}),e.jsx("div",{className:"text-xs text-slate-500",children:"If your account belongs to multiple organizations, you will pick one after sign-in."})]})]})]})},"login"):null,n==="org"?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},children:e.jsxs("div",{className:"rounded-[28px] border border-slate-200 bg-white p-6 shadow-[0_30px_90px_rgba(2,8,23,0.10)]",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Select organization"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Your account belongs to multiple organizations. Choose one to continue."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Va,{label:`Signed in as ${Ee?"EVzone Support":v}`,tone:Ee?"warn":"info"}),e.jsxs(Js,{variant:"outline",onClick:()=>{r("login"),l({title:"Signed out",message:"Returned to login.",kind:"info"})},children:[e.jsx(bo,{className:"h-4 w-4"})," Sign out"]})]})]}),e.jsxs("div",{className:"mt-5 grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Search org"}),e.jsxs("div",{className:"mt-3 flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2 shadow-sm focus-within:ring-4 focus-within:ring-emerald-100",children:[e.jsx(ka,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:ce,onChange:y=>me(y.target.value),placeholder:"Type to filter...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"})]}),e.jsx("div",{className:"mt-3 text-xs text-slate-600",children:"Support sessions display a banner and watermark after you enter the org."})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:p.map(y=>e.jsx("button",{type:"button",onClick:()=>ye(y),className:$i("rounded-3xl border p-4 text-left transition",de===y?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:$i("grid h-11 w-11 place-items-center rounded-2xl",de===y?"bg-white text-emerald-700 ring-1 ring-emerald-200":"bg-slate-100 text-slate-700"),children:e.jsx(Xl,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:y}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Admin Console access"})]})]}),de===y?e.jsx(ct,{className:"h-5 w-5 text-emerald-700"}):e.jsx(et,{className:"h-5 w-5 text-slate-400"})]})},y))}),e.jsxs("div",{className:"mt-4 flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Js,{variant:"outline",onClick:()=>r("login"),children:"Back"}),e.jsxs(Js,{variant:"primary",onClick:D,children:[e.jsx(Xl,{className:"h-4 w-4"})," Continue"]})]})]})]})]})},"org"):null,n==="ready"?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},children:e.jsxs("div",{className:"rounded-[28px] border border-slate-200 bg-white p-6 shadow-[0_30px_90px_rgba(2,8,23,0.10)]",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Welcome"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Organization: ",de]}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(Va,{label:Ee?"EVzone Support":v,tone:Ee?"warn":"info"}),e.jsx(Va,{label:`Email: ${Ee?fe:i}`,tone:"neutral"}),e.jsx(Va,{label:`Risk: ${be.label}`,tone:be.tone})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Js,{variant:"outline",onClick:f,children:[e.jsx(bo,{className:"h-4 w-4"})," Revoke other sessions"]}),e.jsxs(Js,{variant:"primary",onClick:()=>{l({title:"Continue",message:"Routing to Corporate Dashboard...",kind:"success"}),t(is.CONSOLE.DASHBOARD)},children:[e.jsx(et,{className:"h-4 w-4"})," Continue to dashboard"]})]})]}),e.jsxs("div",{className:"mt-5 grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Session badge"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Visibility and audit watermark for support sessions"})]}),e.jsx(Va,{label:Ee?"Support":"Standard",tone:Ee?"warn":"good"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:Ee?e.jsxs(e.Fragment,{children:["Support session ",e.jsx("span",{className:"font-semibold",children:ze})," is visible to organization admins. No silent actions."]}):e.jsx(e.Fragment,{children:"Standard admin session. Security events are still logged."})}),e.jsx(Qp,{enabled:Ee?He:!1,onChange:y=>_e(y),label:"Audit watermark",description:"Shown when support mode is active"})]}),e.jsxs("div",{className:"lg:col-span-2 overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 px-4 py-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Active sessions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Revoke devices and manage trust settings."})]}),e.jsx(Va,{label:`${z.length}`,tone:"neutral"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Session"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Device"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Location"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"IP"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Trusted"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Last seen"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsx("tbody",{children:z.map(y=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:y.id}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:y.device}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:y.location}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:y.ip}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Va,{label:y.trusted?"Yes":"No",tone:y.trusted?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:a4(y.lastSeenTs)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Js,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{y.current?(Pe(re=>re.map(ve=>ve.id===y.id?{...ve,trusted:!ve.trusted}:ve)),l({title:"Updated",message:"Current device trust updated.",kind:"success"})):(Pe(re=>re.map(ve=>ve.id===y.id?{...ve,trusted:!ve.trusted}:ve)),l({title:"Updated",message:"Device trust updated.",kind:"success"}))},children:[e.jsx(Su,{className:"h-4 w-4"})," ",y.trusted?"Untrust":"Trust"]}),y.current?e.jsx(Va,{label:"Current",tone:"info"}):e.jsxs(Js,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>A(y.id),children:[e.jsx(bo,{className:"h-4 w-4"})," Revoke"]})]})})]},y.id))})]})}),e.jsx("div",{className:"border-t border-slate-200 px-4 py-3 text-xs text-slate-500",children:"In production, session actions require audit logging and may require step-up authentication."})]})]}),e.jsxs("div",{className:"mt-5 flex flex-wrap items-center justify-between gap-2 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Sign out"}),e.jsxs(Js,{variant:"outline",onClick:()=>{r("login"),l({title:"Signed out",message:"Returned to login.",kind:"info"})},children:[e.jsx(bo,{className:"h-4 w-4"})," Sign out"]})]})]})},"ready"):null]})]}),e.jsxs(Ev,{open:Ge,title:"Step-up authentication",subtitle:"Risk-based prompt. Complete MFA to continue.",onClose:()=>{Me(!1),Ie(null)},footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Js,{variant:"outline",onClick:()=>{Me(!1),Ie(null),l({title:"Cancelled",message:"Step-up cancelled.",kind:"info"})},children:"Cancel"}),e.jsxs(Js,{variant:"primary",onClick:O,children:[e.jsx(tt,{className:"h-4 w-4"})," Verify"]})]}),maxW:"820px",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Risk summary"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Signals that triggered this prompt."})]}),e.jsx(Va,{label:`Risk ${G}/100`,tone:be.tone})]}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:E.map(y=>e.jsx(Va,{label:`${y.label}: ${y.on?"Yes":"No"}`,tone:y.on?y.tone:"neutral"},y.label))}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-3",children:[e.jsx(lc,{icon:e.jsx(Hx,{className:"h-4 w-4"}),label:"Location",value:ae}),e.jsx(lc,{icon:e.jsx(Ii,{className:"h-4 w-4"}),label:"IP",value:R}),e.jsx(lc,{icon:e.jsx(og,{className:"h-4 w-4"}),label:"Device",value:_})]})]}),Y!=null&&Y.isSupport?e.jsxs("div",{className:"mt-4 rounded-3xl border border-amber-200 bg-amber-50 p-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-white text-amber-800 ring-1 ring-amber-200",children:e.jsx(yt,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Support session rules"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:"No silent actions. Any write action requires justification."}),e.jsxs("div",{className:"mt-3 text-xs text-slate-600",children:["Session ID: ",ze]})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-700",children:"Justification (required)"}),e.jsx("textarea",{value:Oe,onChange:y=>he(y.target.value),placeholder:"Example: troubleshooting an invoice delivery failure",className:"mt-2 w-full rounded-2xl border border-amber-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-amber-100",rows:3})]})]}):null,e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Authenticator code"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Enter a 6-digit code from your authenticator app."}),e.jsx("input",{value:je,onChange:y=>Ue(y.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"123456",className:"mt-3 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Demo: any 6 digits are accepted."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Help"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"If you cannot access your authenticator, use backup codes (X2 page)."}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Finance and Approver roles require MFA."}),e.jsxs(Js,{variant:"outline",className:"mt-3 w-full",onClick:()=>l({title:"Help",message:"Open MFA help article (demo).",kind:"info"}),children:[e.jsx(Fu,{className:"h-4 w-4"})," MFA help"]})]})]})]}),e.jsxs(Ev,{open:Fe,title:"EVzone Support sign-in",subtitle:"Role-gated entry. Support sessions are visible and audited.",onClose:()=>ke(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Js,{variant:"outline",onClick:()=>ke(!1),children:"Cancel"}),e.jsxs(Js,{variant:"primary",disabled:!le,onClick:F,children:[e.jsx(yt,{className:"h-4 w-4"})," Continue"]})]}),maxW:"820px",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(ac,{icon:e.jsx(Xs,{className:"h-4 w-4"}),label:"EVzone email",value:fe,onChange:Ve,placeholder:"support@evzone.com",required:!0}),e.jsx(ac,{icon:e.jsx(xu,{className:"h-4 w-4"}),label:"Support key",value:ne,onChange:Te,placeholder:"Enter key",type:"password",required:!0,hint:"Demo: 6+ chars"})]}),e.jsx("div",{className:"mt-4 rounded-3xl border border-amber-200 bg-amber-50 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-white text-amber-800 ring-1 ring-amber-200",children:e.jsx(Mt,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Support safety"}),e.jsxs("ul",{className:"mt-2 space-y-1 text-xs text-slate-700",children:[e.jsx("li",{children:"1) View-only by default"}),e.jsx("li",{children:"2) Step-up authentication required"}),e.jsx("li",{children:"3) Justification required for write actions"}),e.jsx("li",{children:"4) Visible banner and watermark"})]})]})]})})]}),e.jsxs(Ev,{open:Be,title:"Request access",subtitle:"Creates a ticket for the organization admin and logs the request.",onClose:()=>xe(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Js,{variant:"outline",onClick:()=>xe(!1),children:"Cancel"}),e.jsxs(Js,{variant:"primary",onClick:m,children:[e.jsx(ni,{className:"h-4 w-4"})," Submit"]})]}),maxW:"820px",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4 text-sm text-slate-700",children:[e.jsx("span",{className:"font-semibold",children:"Email used"}),": ",i||"(enter email on login page)"]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(ac,{icon:e.jsx(Xl,{className:"h-4 w-4"}),label:"Organization",required:!0,value:Ne,onChange:M,placeholder:"Example: Acme Group Ltd"}),e.jsx(ac,{icon:e.jsx(cx,{className:"h-4 w-4"}),label:"Your name",required:!0,value:H,onChange:Ae,placeholder:"Full name"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Role needed"}),e.jsx("select",{value:oe,onChange:y=>De(y.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",children:b.map(y=>e.jsx("option",{value:y,children:y},y))}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"The org admin will approve this request."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Delivery"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(Va,{label:"Email",tone:"neutral"}),e.jsx(Va,{label:"WhatsApp",tone:"good"}),e.jsx(Va,{label:"SMS",tone:"info"})]}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"In production, delivery logs appear in Notifications Center."})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Reason"}),e.jsx("textarea",{value:$e,onChange:y=>ge(y.target.value),placeholder:"Explain why you need access",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100",rows:4}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Tip: include urgency and your responsibilities."})]})]})]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-7xl px-4 text-xs text-slate-500 md:px-6",children:"X1 Login: email/password, org selector, EVzone support entry, risk-based step-up prompts, session management, and support-mode banner + watermark."})})]})}function lc({icon:t,label:s,value:a}){return e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-600",children:t}),e.jsx("span",{className:"text-xs font-semibold text-slate-600",children:s})]}),e.jsx("span",{className:"text-xs font-semibold text-slate-900",children:a})]})})}const ux={green:"#03CD8C",orange:"#F77F00"};function Nr(...t){return t.filter(Boolean).join(" ")}function l4(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function RE(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function Yp(t){if(!t)return"-";const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function ps({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Nr("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function vs({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:ux.green}:t==="accent"?{background:ux.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Nr(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Jp({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:Nr("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:Nr("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function xU({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:Nr("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function pU({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="860px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[8vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(xU,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function hU({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Nr("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function Wi({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text"}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:i=>a(i.target.value),placeholder:l,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"})]})}function Mv(t=8){return Array.from({length:t}).map(()=>{const s=Math.random().toString(16).slice(2,6).toUpperCase(),a=Math.random().toString(16).slice(2,6).toUpperCase();return`${s}-${a}`})}function Zp(t,s){const a=new Blob([s],{type:"text/plain"}),l=URL.createObjectURL(a),n=document.createElement("a");n.href=l,n.download=t,n.click(),URL.revokeObjectURL(l)}function gU(t){const s=["id","timestamp","severity","actor","category","title","detail","status"],a=n=>{const r=String(n??"");return r.includes(",")||r.includes(`
`)||r.includes('"')?`"${r.replace(/"/g,'""')}"`:r},l=t.map(n=>[n.id,RE(n.ts),n.severity,n.actor,n.category,n.title,n.detail,n.status].map(a).join(","));return[s.join(","),...l].join(`
`)}function fU(t){return t==="Critical"?"bad":t==="Warning"?"warn":"info"}function vU(t){const s=[];if(t.ipEnabled&&(t.ipAllow.includes(t.ip)||s.push("IP not in allowlist")),t.geoEnabled&&(t.geoAllow.map(l=>l.toLowerCase()).includes(t.geo.toLowerCase())||s.push("Geo not in allowlist")),t.timeEnabled){t.timeDays.includes(t.day)||s.push("Day not allowed");const l=t.time;t.timeStart&&t.timeEnd&&(l<t.timeStart||l>t.timeEnd)&&s.push("Time outside allowed window")}return s.length?{status:"Step-up required",reasons:s}:{status:"Allowed",reasons:[]}}function bU(){const[t,s]=d.useState([]),a=y=>{const re=l4("toast");s(ve=>[{id:re,...y},...ve].slice(0,4)),window.setTimeout(()=>s(ve=>ve.filter(P=>P.id!==re)),3200)},[l,n]=d.useState("setup"),[r]=d.useState("EVZ-CPAY-2FA-9X3D-7K1P"),[i,o]=d.useState(""),[c,x]=d.useState(!1),[j,g]=d.useState([]),[N,$]=d.useState(!0),[T,k]=d.useState(30),[q,L]=d.useState({Finance:!0,Approver:!0,Admin:!0,Manager:!1,User:!1,"Travel Coordinator":!1}),[R,U]=d.useState(()=>[{id:"S-001",device:"Windows Chrome",location:"Kampala, UG",ip:"196.43.199.81",trusted:!1,lastSeenTs:Date.now()-2*60*1e3,status:"Current"},{id:"S-002",device:"Android App",location:"Kampala, UG",ip:"41.190.31.12",trusted:!0,lastSeenTs:Date.now()-6*60*60*1e3,status:"Active"},{id:"S-003",device:"Mac Safari",location:"Wuxi, CN",ip:"103.42.111.9",trusted:!1,lastSeenTs:Date.now()-6*24*60*60*1e3,status:"Signed out"}]),[ae,ie]=d.useState(!1),[_,W]=d.useState(["196.43.199.81","41.190.31.12"]),[J,we]=d.useState(""),[G,be]=d.useState(!1),[Ge,Me]=d.useState(["Kampala, UG","Entebbe, UG"]),[je,Ue]=d.useState(""),[Oe,he]=d.useState(!1),[Y,Ie]=d.useState("06:00"),[ce,me]=d.useState("22:00"),[pe,de]=d.useState(["Mon","Tue","Wed","Thu","Fri"]),[ye,Qe]=d.useState("196.43.199.81"),[Fe,ke]=d.useState("Kampala, UG"),[fe,Ve]=d.useState("Wed"),[ne,Te]=d.useState("10:30"),[Ee,Re]=d.useState(()=>[{id:"BG-001",email:"breakglass-admin@acme.com",enabled:!0,locked:!1,lastRotatedTs:Date.now()-60*24*60*60*1e3,lastUsedTs:null,notes:"Emergency-only. Dual-control recommended.",emergencyCodes:Mv(10)}]),[ze,qe]=d.useState(!1),[He,_e]=d.useState(null),[le,z]=d.useState(()=>[{id:"EVT-9001",ts:Date.now()-20*60*1e3,severity:"Warning",actor:"System",category:"Tamper",title:"MFA disable attempt blocked",detail:"A user attempted to disable MFA but policy requires MFA for Finance roles.",status:"Open"},{id:"EVT-9002",ts:Date.now()-2*60*60*1e3,severity:"Info",actor:"Org Admin",category:"Policy",title:"Updated MFA policy",detail:"Set MFA required for Approver and Admin roles.",status:"Resolved"},{id:"EVT-9003",ts:Date.now()-9*60*60*1e3,severity:"Critical",actor:"System",category:"Session",title:"Unusual login detected",detail:"Impossible travel signal. Step-up authentication required.",status:"Open"}]),[Pe,Be]=d.useState("All"),[xe,Ne]=d.useState("All"),M=y=>{const re={id:l4("EVT"),ts:Date.now(),status:y.status??"Open",...y};z(ve=>[re,...ve])},H=d.useMemo(()=>vU({ip:ye,geo:Fe,day:fe,time:ne,ipEnabled:ae,ipAllow:_,geoEnabled:G,geoAllow:Ge,timeEnabled:Oe,timeStart:Y,timeEnd:ce,timeDays:pe}),[ye,Fe,fe,ne,ae,_,G,Ge,Oe,Y,ce,pe]),Ae=d.useMemo(()=>le.filter(y=>y.status==="Open").length,[le]),oe=d.useMemo(()=>le.filter(y=>y.status==="Open"&&y.severity==="Critical").length,[le]),De=d.useMemo(()=>le.filter(y=>!(Pe!=="All"&&y.status!==Pe||xe!=="All"&&y.severity!==xe)),[le,Pe,xe]),$e=y=>{if(y==="json"){Zp("corporatepay-security-events.json",JSON.stringify(le,null,2)),a({title:"Exported",message:"Security events exported as JSON.",kind:"success"});return}const re=gU(le);Zp("corporatepay-security-events.csv",re),a({title:"Exported",message:"Security events exported as CSV.",kind:"success"})},ge=async y=>{try{await navigator.clipboard.writeText(y),a({title:"Copied",message:"Copied to clipboard.",kind:"success"})}catch{a({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},ue=()=>{if(i.trim().length<6){a({title:"Invalid code",message:"Enter a 6-digit code.",kind:"warn"});return}x(!0),M({severity:"Info",actor:"You",category:"MFA",title:"MFA enabled",detail:"Authenticator verified successfully."}),a({title:"MFA enabled",message:"Authenticator verified.",kind:"success"})},Ke=()=>{const y=Mv(10);g(y),M({severity:"Info",actor:"You",category:"MFA",title:"Backup codes generated",detail:"Generated 10 backup codes."}),a({title:"Generated",message:"Backup codes generated.",kind:"success"})},b=()=>{Zp("evzone-corporatepay-backup-codes.txt",j.join(`
`)),a({title:"Downloaded",message:"Backup codes downloaded.",kind:"success"})},v=y=>{L(re=>{const ve={...re,[y]:!re[y]};return M({severity:"Info",actor:"Org Admin",category:"Policy",title:"MFA policy updated",detail:`Role ${y}: ${ve[y]?"required":"optional"}`}),ve})},u=()=>{U(y=>y.map(re=>re.status==="Current"?re:{...re,status:"Signed out"})),M({severity:"Warning",actor:"You",category:"Session",title:"Forced sign-out",detail:"Signed out all other active sessions."}),a({title:"Signed out",message:"All other sessions were signed out.",kind:"success"})},C=y=>{U(re=>re.map(ve=>ve.id===y?{...ve,status:"Signed out"}:ve)),M({severity:"Info",actor:"You",category:"Session",title:"Session signed out",detail:`Session ${y} signed out.`}),a({title:"Signed out",message:`Session ${y} signed out.",`,kind:"success"})},Q=y=>{U(re=>re.map(ve=>ve.id===y?{...ve,trusted:!ve.trusted}:ve)),M({severity:"Info",actor:"You",category:"Device",title:"Device trust changed",detail:`Trust updated for ${y}.`}),a({title:"Updated",message:"Device trust updated.",kind:"success"})},O=()=>{const y=J.trim();if(!y){a({title:"Missing IP",message:"Enter an IP address.",kind:"warn"});return}if(_.includes(y)){a({title:"Exists",message:"IP already in allowlist.",kind:"info"});return}W(re=>[y,...re]),we(""),M({severity:"Info",actor:"Org Admin",category:"Policy",title:"IP allowlist changed",detail:`Added ${y}.`}),a({title:"Added",message:"IP added to allowlist.",kind:"success"})},ee=y=>{W(re=>re.filter(ve=>ve!==y)),M({severity:"Info",actor:"Org Admin",category:"Policy",title:"IP allowlist changed",detail:`Removed ${y}.`})},F=()=>{const y=je.trim();if(!y){a({title:"Missing geo",message:"Enter a location.",kind:"warn"});return}if(Ge.map(re=>re.toLowerCase()).includes(y.toLowerCase())){a({title:"Exists",message:"Location already in allowlist.",kind:"info"});return}Me(re=>[y,...re]),Ue(""),M({severity:"Info",actor:"Org Admin",category:"Policy",title:"Geo allowlist changed",detail:`Added ${y}.`}),a({title:"Added",message:"Location added to allowlist.",kind:"success"})},D=y=>{Me(re=>re.filter(ve=>ve!==y)),M({severity:"Info",actor:"Org Admin",category:"Policy",title:"Geo allowlist changed",detail:`Removed ${y}.`})},m=y=>{de(re=>{const P=re.includes(y)?re.filter(X=>X!==y):[...re,y];return M({severity:"Info",actor:"Org Admin",category:"Policy",title:"Time restriction changed",detail:`Allowed days updated: ${P.join(", ")}`}),P})},A=y=>{z(re=>re.map(ve=>ve.id===y?{...ve,status:"Resolved"}:ve)),a({title:"Resolved",message:`Event ${y} marked resolved.",`,kind:"success"})},f=y=>{_e(y),qe(!0)},B=y=>{Re(re=>re.map(ve=>ve.id===y?{...ve,emergencyCodes:Mv(12),lastRotatedTs:Date.now()}:ve)),M({severity:"Warning",actor:"Org Admin",category:"Break-glass",title:"Emergency codes rotated",detail:`Rotated emergency codes for ${y}.`}),a({title:"Rotated",message:"Emergency codes rotated.",kind:"success"})},p=y=>{Re(re=>re.map(ve=>ve.id===y?{...ve,enabled:!ve.enabled}:ve)),M({severity:"Warning",actor:"Org Admin",category:"Break-glass",title:"Break-glass status changed",detail:`Toggled enabled state for ${y}.`})},E=y=>{Re(re=>re.map(ve=>ve.id===y?{...ve,locked:!ve.locked}:ve)),M({severity:"Critical",actor:"Org Admin",category:"Break-glass",title:"Break-glass lock changed",detail:`Toggled lock state for ${y}.`})},se=d.useMemo(()=>({policy:`MFA required roles: ${Object.values(q).filter(Boolean).length}`,conditional:ae||G||Oe?"Conditional access on":"Conditional access off"}),[q,ae,G,Oe]);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(hU,{toasts:t,onDismiss:y=>s(re=>re.filter(ve=>ve.id!==y))}),e.jsx("div",{className:"mx-auto max-w-7xl px-4 py-10 md:px-6",children:e.jsxs("div",{className:"rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.10)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-6 py-5",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:ux.green},children:e.jsx(Su,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"MFA and Device Trust"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Secure access policies, trusted devices, and exportable security events."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(ps,{label:c?"MFA: Enabled":"MFA: Not enabled",tone:c?"good":"warn"}),e.jsx(ps,{label:N?`Trust: ${T} days`:"Trust: Off",tone:N?"info":"neutral"}),e.jsx(ps,{label:se.conditional,tone:ae||G||Oe?"warn":"neutral"}),e.jsx(ps,{label:`Open alerts: ${Ae}`,tone:Ae?"warn":"good"}),oe?e.jsx(ps,{label:`Critical: ${oe}`,tone:"bad"}):null]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(vs,{variant:"outline",onClick:()=>$e("csv"),children:[e.jsx(gt,{className:"h-4 w-4"})," Export CSV"]}),e.jsxs(vs,{variant:"outline",onClick:()=>$e("json"),children:[e.jsx(wt,{className:"h-4 w-4"})," Export JSON"]}),e.jsxs(vs,{variant:"primary",onClick:()=>a({title:"Saved",message:"Security settings saved (demo).",kind:"success"}),children:[e.jsx(tt,{className:"h-4 w-4"})," Save"]})]})]}),e.jsx("div",{className:"mt-5 flex flex-wrap gap-2",children:[{id:"setup",label:"MFA setup"},{id:"trust",label:"Device trust and sessions"},{id:"conditional",label:"Conditional access"},{id:"breakglass",label:"Break-glass"},{id:"events",label:"Tamper alerts and events"}].map(y=>e.jsx("button",{className:Nr("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",l===y.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:l===y.id?{background:ux.green}:void 0,onClick:()=>n(y.id),children:y.label},y.id))})]}),e.jsx("div",{className:"bg-slate-50 px-6 py-6",children:e.jsxs(lt,{mode:"wait",children:[l==="setup"?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs(ir,{title:"Authenticator",subtitle:"Scan QR and verify a code",right:e.jsx(ps,{label:c?"Enabled":"Setup",tone:c?"good":"warn"}),children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-700",children:"QR placeholder"}),e.jsx("div",{className:"mt-3 grid place-items-center rounded-3xl bg-white p-6 ring-1 ring-slate-200",children:e.jsx("div",{className:"grid h-40 w-40 place-items-center rounded-2xl border border-slate-200 bg-white",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"QR"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Authenticator setup"})]})})})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Secret key"}),e.jsxs("div",{className:"mt-2 flex items-center justify-between rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2",children:[e.jsx("span",{className:"font-mono text-sm font-semibold text-slate-900",children:r}),e.jsxs(vs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ge(r),children:[e.jsx(ls,{className:"h-4 w-4"})," Copy"]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Verification code"}),e.jsx("input",{value:i,onChange:y=>o(y.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"123456",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Demo: any 6 digits enable MFA."})]}),e.jsxs("div",{className:"mt-4 flex flex-col gap-2 sm:flex-row sm:justify-end",children:[e.jsxs(vs,{variant:"outline",onClick:()=>a({title:"Help",message:"MFA setup help (demo).",kind:"info"}),children:[e.jsx(Fu,{className:"h-4 w-4"})," Help"]}),e.jsxs(vs,{variant:"primary",onClick:ue,disabled:c,children:[e.jsx(tt,{className:"h-4 w-4"})," Verify"]})]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Admin policy can require MFA by role (Finance, Approver, Admin)."})]}),e.jsxs(ir,{title:"Backup codes",subtitle:"Emergency access if phone is unavailable",right:e.jsx(ps,{label:j.length?"Generated":"Not generated",tone:j.length?"good":"warn"}),children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(vs,{variant:"primary",onClick:Ke,children:[e.jsx(xu,{className:"h-4 w-4"})," Generate"]}),e.jsxs(vs,{variant:"outline",disabled:!j.length,onClick:()=>ge(j.join(`
`)),children:[e.jsx(ls,{className:"h-4 w-4"})," Copy all"]}),e.jsxs(vs,{variant:"outline",disabled:!j.length,onClick:b,children:[e.jsx(gt,{className:"h-4 w-4"})," Download"]}),e.jsxs(vs,{variant:"outline",disabled:!j.length,onClick:()=>{g([]),M({severity:"Warning",actor:"You",category:"MFA",title:"Backup codes cleared",detail:"Backup codes cleared. Generate again if needed."}),a({title:"Cleared",message:"Backup codes cleared.",kind:"warn"})},children:[e.jsx(as,{className:"h-4 w-4"})," Clear"]})]}),e.jsx("div",{className:"mt-4 grid grid-cols-1 gap-2 sm:grid-cols-2",children:j.length?j.map(y=>e.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("span",{className:"font-mono text-sm font-semibold text-slate-900",children:y}),e.jsx(ps,{label:"One-time",tone:"neutral"})]},y)):e.jsxs("div",{className:"sm:col-span-2 rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(xu,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No backup codes"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Generate and store securely."})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: backup code use should create an audit event and trigger a security alert."})]}),e.jsxs(ir,{title:"Admin MFA policies",subtitle:"Require MFA by role",right:e.jsx(ps,{label:se.policy,tone:"info"}),children:[e.jsx("div",{className:"space-y-2",children:Object.keys(q).map(y=>e.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:y}),e.jsx("button",{type:"button",className:Nr("relative h-7 w-12 rounded-full border transition",q[y]?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>v(y),"aria-label":`Toggle MFA required for ${y}`,children:e.jsx("span",{className:Nr("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",q[y]?"left-[22px]":"left-1")})})]},y))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Recommendation: keep MFA required for Finance, Approver, and Admin roles."})]})]})},"setup"):null,l==="trust"?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs(ir,{title:"Trust this device",subtitle:"Reduce repeated prompts",right:e.jsx(ps,{label:N?"Enabled":"Off",tone:N?"good":"neutral"}),children:[e.jsx(Jp,{enabled:N,onChange:y=>{$(y),M({severity:"Info",actor:"You",category:"Device",title:"Trust device toggled",detail:`Trust device ${y?"enabled":"disabled"}.`}),a({title:"Updated",message:"Trust device updated.",kind:"success"})},label:"Trust this device",description:"If enabled, step-up prompts are reduced for this device."}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Expiry"}),e.jsx("select",{value:String(T),onChange:y=>{k(Number(y.target.value)),M({severity:"Info",actor:"You",category:"Device",title:"Trust expiry changed",detail:`Trust expiry set to ${y.target.value} days.`})},disabled:!N,className:Nr("mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",!N&&"bg-slate-50 text-slate-500"),children:[7,30,90].map(y=>e.jsxs("option",{value:y,children:[y," days"]},y))}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Admin policy can cap trust duration."})]}),e.jsxs(vs,{variant:"danger",className:"mt-4 w-full",onClick:()=>{$(!1),M({severity:"Warning",actor:"You",category:"Device",title:"Trusted device revoked",detail:"Trust revoked for current device."}),a({title:"Revoked",message:"Trusted device revoked.",kind:"warn"})},children:[e.jsx(as,{className:"h-4 w-4"})," Revoke trust"]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: trust revocation should trigger tamper alerts if unusual."})]}),e.jsxs("div",{className:"lg:col-span-2 overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-2 border-b border-slate-200 px-4 py-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Login history and sessions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Review devices, revoke access, and force sign-out."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(vs,{variant:"outline",className:"text-xs",onClick:u,children:[e.jsx(bo,{className:"h-4 w-4"})," Sign out others"]}),e.jsxs(vs,{variant:"danger",className:"text-xs",onClick:()=>{U(y=>y.map(re=>({...re,status:re.status==="Current"?"Current":"Signed out"}))),M({severity:"Critical",actor:"You",category:"Session",title:"Global sign-out",detail:"All non-current sessions signed out."}),a({title:"Global sign-out",message:"All non-current sessions signed out.",kind:"warn"})},children:[e.jsx(yt,{className:"h-4 w-4"})," Force global sign-out"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Session"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Device"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Location"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"IP"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Trusted"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Last seen"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsx("tbody",{children:R.map(y=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:y.id}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:y.device}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:y.location}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:y.ip}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ps,{label:y.trusted?"Yes":"No",tone:y.trusted?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Yp(y.lastSeenTs)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ps,{label:y.status,tone:y.status==="Current"?"info":y.status==="Active"?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(vs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Q(y.id),children:[e.jsx(Su,{className:"h-4 w-4"})," ",y.trusted?"Untrust":"Trust"]}),y.status!=="Current"&&y.status!=="Signed out"?e.jsxs(vs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>C(y.id),children:[e.jsx(bo,{className:"h-4 w-4"})," Sign out"]}):null]})})]},y.id))})]})}),e.jsx("div",{className:"border-t border-slate-200 px-4 py-3 text-xs text-slate-500",children:"Forced sign-out controls should be audit logged and may require step-up auth."})]})]})},"trust"):null,l==="conditional"?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs(ir,{title:"Conditional access policies",subtitle:"IP allowlist, geo allowlist, and time restrictions",right:e.jsx(ps,{label:ae||G||Oe?"Enabled":"Off",tone:ae||G||Oe?"warn":"neutral"}),children:[e.jsx(Jp,{enabled:ae,onChange:y=>{ie(y),M({severity:"Info",actor:"Org Admin",category:"Policy",title:"IP allowlist toggled",detail:y?"Enabled":"Disabled"})},label:"IP allowlist",description:"If enabled, IPs outside allowlist trigger step-up authentication."}),e.jsx(Jp,{enabled:G,onChange:y=>{be(y),M({severity:"Info",actor:"Org Admin",category:"Policy",title:"Geo allowlist toggled",detail:y?"Enabled":"Disabled"})},label:"Geo allowlist",description:"If enabled, locations outside allowlist trigger step-up authentication."}),e.jsx(Jp,{enabled:Oe,onChange:y=>{he(y),M({severity:"Info",actor:"Org Admin",category:"Policy",title:"Time restriction toggled",detail:y?"Enabled":"Disabled"})},label:"Time restrictions",description:"If enabled, access outside allowed hours triggers step-up authentication."}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: you can switch from step-up to block for specific modules (Billing, Security) later."})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs(ir,{title:"IP allowlist",subtitle:"Manage allowed IP addresses",right:e.jsx(ps,{label:ae?"On":"Off",tone:ae?"warn":"neutral"}),children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[_.map(y=>e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-slate-50 px-3 py-2 text-xs font-semibold text-slate-700 ring-1 ring-slate-200",children:[y,e.jsx("button",{type:"button",className:"rounded-full p-1 hover:bg-slate-200",onClick:()=>ee(y),"aria-label":`Remove ${y}`,children:e.jsx(Ye,{className:"h-3.5 w-3.5"})})]},y)),_.length?null:e.jsx(ps,{label:"No IPs",tone:"warn"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-3",children:[e.jsx("div",{className:"sm:col-span-2",children:e.jsx(Wi,{label:"Add IP",value:J,onChange:we,placeholder:"196.43.199.81"})}),e.jsx("div",{className:"flex items-end",children:e.jsxs(vs,{variant:"outline",className:"w-full",onClick:O,children:[e.jsx(pt,{className:"h-4 w-4"})," Add"]})})]})]}),e.jsxs(ir,{title:"Geo allowlist",subtitle:"Manage allowed locations",right:e.jsx(ps,{label:G?"On":"Off",tone:G?"warn":"neutral"}),children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[Ge.map(y=>e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-slate-50 px-3 py-2 text-xs font-semibold text-slate-700 ring-1 ring-slate-200",children:[y,e.jsx("button",{type:"button",className:"rounded-full p-1 hover:bg-slate-200",onClick:()=>D(y),"aria-label":`Remove ${y}`,children:e.jsx(Ye,{className:"h-3.5 w-3.5"})})]},y)),Ge.length?null:e.jsx(ps,{label:"No locations",tone:"warn"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-3",children:[e.jsx("div",{className:"sm:col-span-2",children:e.jsx(Wi,{label:"Add location",value:je,onChange:Ue,placeholder:"Kampala, UG"})}),e.jsx("div",{className:"flex items-end",children:e.jsxs(vs,{variant:"outline",className:"w-full",onClick:F,children:[e.jsx(pt,{className:"h-4 w-4"})," Add"]})})]})]}),e.jsxs(ir,{title:"Time restrictions",subtitle:"Allowed days and hours",right:e.jsx(ps,{label:Oe?"On":"Off",tone:Oe?"warn":"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Wi,{label:"Start",value:Y,onChange:Ie,type:"time"}),e.jsx(Wi,{label:"End",value:ce,onChange:me,type:"time"})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Allowed days"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map(y=>{const re=pe.includes(y);return e.jsx("button",{type:"button",className:Nr("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",re?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:re?{background:ux.green}:void 0,onClick:()=>m(y),children:y},y)})})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: keep restrictions strict for Billing and Security roles."})]}),e.jsxs(ir,{title:"Policy preview",subtitle:"Evaluate the current session context",right:e.jsx(ps,{label:H.status,tone:H.status==="Allowed"?"good":"warn"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Wi,{label:"Current IP",value:ye,onChange:Qe,placeholder:"196.43.199.81"}),e.jsx(Wi,{label:"Current geo",value:Fe,onChange:ke,placeholder:"Kampala, UG"}),e.jsx(Wi,{label:"Day",value:fe,onChange:Ve,placeholder:"Wed",hint:"Mon..Sun"}),e.jsx(Wi,{label:"Time",value:ne,onChange:Te,type:"time"})]}),H.reasons.length?e.jsxs("div",{className:"mt-3 rounded-2xl border border-amber-200 bg-amber-50 p-3 text-xs text-amber-900",children:[e.jsx("div",{className:"font-semibold",children:"Reasons"}),e.jsx("ul",{className:"mt-2 space-y-1",children:H.reasons.map(y=>e.jsxs("li",{children:[" ",y]},y))})]}):e.jsx("div",{className:"mt-3 rounded-2xl border border-emerald-200 bg-emerald-50 p-3 text-xs text-emerald-900",children:"Allowed: no step-up required."})]})]})]})},"conditional"):null,l==="breakglass"?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs(ir,{title:"Break-glass overview",subtitle:"Emergency-only admin accounts",right:e.jsx(ps,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:["Break-glass is for emergencies only. Recommended controls:",e.jsxs("ul",{className:"mt-2 space-y-1",children:[e.jsx("li",{children:"1) Dual-control approval to unlock"}),e.jsx("li",{children:"2) Step-up authentication always"}),e.jsx("li",{children:"3) Rotate emergency codes after any use"})]})]}),e.jsxs(vs,{variant:"outline",className:"mt-3 w-full",onClick:()=>{M({severity:"Critical",actor:"System",category:"Tamper",title:"Tamper alert test",detail:"Simulated tamper alert triggered."}),a({title:"Tamper test",message:"Created a simulated tamper alert.",kind:"warn"})},children:[e.jsx(Mt,{className:"h-4 w-4"})," Trigger tamper test"]})]}),e.jsxs("div",{className:"lg:col-span-2 overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-sm",children:[e.jsxs("div",{className:"border-b border-slate-200 px-4 py-3",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Break-glass accounts"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"View codes, rotate, lock, and audit usage."})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Email"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Enabled"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Locked"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Last rotated"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Last used"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsx("tbody",{children:Ee.map(y=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:y.email}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ps,{label:y.enabled?"Yes":"No",tone:y.enabled?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ps,{label:y.locked?"Locked":"Open",tone:y.locked?"bad":"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Yp(y.lastRotatedTs)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:y.lastUsedTs?Yp(y.lastUsedTs):"Never"}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(vs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>f(y.id),children:[e.jsx(xu,{className:"h-4 w-4"})," View codes"]}),e.jsxs(vs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>B(y.id),children:[e.jsx(ht,{className:"h-4 w-4"})," Rotate"]}),e.jsxs(vs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>p(y.id),children:[e.jsx(yt,{className:"h-4 w-4"})," Toggle enabled"]}),e.jsxs(vs,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>E(y.id),children:[e.jsx(ra,{className:"h-4 w-4"})," ",y.locked?"Unlock":"Lock"]})]})})]},y.id))})]})}),e.jsx("div",{className:"border-t border-slate-200 px-4 py-3 text-xs text-slate-500",children:"Premium: break-glass unlock should require dual approval and create tamper alerts."})]})]})},"breakglass"):null,l==="events"?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs(ir,{title:"Tamper alerts",subtitle:"Detect and respond to unusual actions",right:e.jsx(ps,{label:`${Ae} open`,tone:Ae?"warn":"good"}),children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Tamper events include:",e.jsxs("ul",{className:"mt-2 space-y-1 text-xs text-slate-600",children:[e.jsx("li",{children:"1) MFA disable attempts"}),e.jsx("li",{children:"2) Break-glass changes"}),e.jsx("li",{children:"3) Conditional access bypass attempts"}),e.jsx("li",{children:"4) Forced sign-out anomalies"})]})]}),e.jsxs(vs,{variant:"outline",className:"mt-3 w-full",onClick:()=>{M({severity:"Critical",actor:"System",category:"Tamper",title:"Policy tamper detected",detail:"Attempt to modify allowlist without permission."}),a({title:"Tamper event",message:"Created a simulated tamper event.",kind:"warn"})},children:[e.jsx(Mt,{className:"h-4 w-4"})," Simulate tamper"]})]}),e.jsxs("div",{className:"lg:col-span-2 overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-3 border-b border-slate-200 px-4 py-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Security events"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Exportable logs for audits and incident response."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("select",{value:Pe,onChange:y=>Be(y.target.value),className:"rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none",children:["All","Open","Resolved"].map(y=>e.jsx("option",{value:y,children:y},y))}),e.jsx("select",{value:xe,onChange:y=>Ne(y.target.value),className:"rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none",children:["All","Info","Warning","Critical"].map(y=>e.jsx("option",{value:y,children:y},y))}),e.jsxs(vs,{variant:"outline",className:"text-xs",onClick:()=>$e("csv"),children:[e.jsx(gt,{className:"h-4 w-4"})," CSV"]}),e.jsxs(vs,{variant:"outline",className:"text-xs",onClick:()=>$e("json"),children:[e.jsx(wt,{className:"h-4 w-4"})," JSON"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Severity"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Category"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Title"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[De.map(y=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:RE(y.ts)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ps,{label:y.severity,tone:fU(y.severity)})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:y.category}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:y.title}),e.jsx("div",{className:"mt-0.5 text-xs text-slate-500",children:y.detail}),e.jsx("div",{className:"mt-0.5 text-xs text-slate-400",children:y.id})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:y.actor}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ps,{label:y.status,tone:y.status==="Open"?"warn":"good"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[y.status==="Open"?e.jsxs(vs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>A(y.id),children:[e.jsx(tt,{className:"h-4 w-4"})," Resolve"]}):e.jsx(ps,{label:"Resolved",tone:"good"}),e.jsxs(vs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{a({title:"Details",message:"Open event detail panel (demo).",kind:"info"})},children:[e.jsx(vn,{className:"h-4 w-4"})," Details"]})]})})]},y.id)),De.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10",children:e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(yt,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No events"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Try changing filters."})]})})})]})]})}),e.jsx("div",{className:"border-t border-slate-200 px-4 py-3 text-xs text-slate-500",children:"Events are exportable and audit-friendly. Tamper alerts should be immutable in production."})]})]})},"events"):null]})})]})}),e.jsx(pU,{open:ze,title:"Break-glass emergency codes",subtitle:"Emergency-only. Rotate after any use.",onClose:()=>qe(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(vs,{variant:"outline",onClick:()=>qe(!1),children:"Close"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(vs,{variant:"outline",onClick:()=>{const y=Ee.find(re=>re.id===He);y&&ge(y.emergencyCodes.join(`
`))},children:[e.jsx(ls,{className:"h-4 w-4"})," Copy"]}),e.jsxs(vs,{variant:"outline",onClick:()=>{const y=Ee.find(re=>re.id===He);y&&(Zp(`breakglass-${y.id}-codes.txt`,y.emergencyCodes.join(`
`)),a({title:"Downloaded",message:"Emergency codes downloaded.",kind:"success"}))},children:[e.jsx(gt,{className:"h-4 w-4"})," Download"]})]})]}),children:(()=>{const y=Ee.find(re=>re.id===He);return y?e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ps,{label:y.email,tone:"neutral"}),e.jsx(ps,{label:y.enabled?"Enabled":"Disabled",tone:y.enabled?"good":"neutral"}),e.jsx(ps,{label:y.locked?"Locked":"Open",tone:y.locked?"bad":"neutral"}),e.jsx(ps,{label:`Rotated: ${Yp(y.lastRotatedTs)}`,tone:"info"})]}),e.jsx("div",{className:"mt-4 grid grid-cols-1 gap-2 sm:grid-cols-2",children:y.emergencyCodes.map(re=>e.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("span",{className:"font-mono text-sm font-semibold text-slate-900",children:re}),e.jsx(ps,{label:"One-time",tone:"neutral"})]},re))}),e.jsx("div",{className:"mt-4 rounded-2xl border border-amber-200 bg-amber-50 p-3 text-xs text-amber-900",children:"Do not store these in plain text. Rotate after any use."})]}):null})()}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-7xl px-4 text-xs text-slate-500 md:px-6",children:"X2 MFA page: authenticator setup, backup codes, device trust expiry, role-based MFA policies, session history + forced sign-out, conditional access policies, break-glass controls, tamper alerts, and exportable security events."})})]})}function ir({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}const cg={green:"#03CD8C",orange:"#F77F00"};function Jl(...t){return t.filter(Boolean).join(" ")}function jU(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function yU(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function NU(t,s,a){return Math.max(s,Math.min(a,t))}function cl({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Jl("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Ul({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:cg.green}:t==="accent"?{background:cg.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Jl(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Pv({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:Jl("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:Jl("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function Pr({icon:t,label:s,value:a,onChange:l,type:n="text",placeholder:r,hint:i,required:o,disabled:c}){const x=!!o&&!a.trim();return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"text-xs font-semibold text-slate-600",children:[s,o?e.jsx("span",{className:"text-rose-600",children:" *"}):null]}),i?e.jsx("div",{className:"text-xs text-slate-500",children:i}):null]}),e.jsxs("div",{className:Jl("mt-2 flex items-center gap-2 rounded-2xl border bg-white px-3 py-2.5 shadow-sm focus-within:ring-4",c?"border-slate-200 bg-slate-50 text-slate-500":x?"border-rose-300 focus-within:ring-rose-100":"border-slate-200 focus-within:ring-emerald-100"),children:[e.jsx("span",{className:"text-slate-500",children:t}),e.jsx("input",{type:n,value:a,onChange:j=>l(j.target.value),placeholder:r,disabled:c,className:Jl("w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400",c&&"text-slate-500")})]}),x?e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:"Required"}):null]})}function wU({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Jl("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function tm({idx:t,active:s,done:a,label:l}){return e.jsxs("div",{className:Jl("flex items-center gap-2 rounded-full px-3 py-2 text-xs font-semibold ring-1",s?"bg-emerald-600 text-white ring-emerald-600":a?"bg-emerald-50 text-emerald-800 ring-emerald-200":"bg-white text-slate-700 ring-slate-200"),style:s?{background:cg.green}:void 0,children:[e.jsx("span",{className:Jl("grid h-6 w-6 place-items-center rounded-full",s?"bg-white/20":a?"bg-emerald-100":"bg-slate-100"),children:a?e.jsx(tt,{className:"h-4 w-4"}):e.jsx("span",{children:t})}),l]})}function ed({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function kU(t){const s=t.trim().toLowerCase().split("@");return s.length===2?s[1]:""}function CU(t,s,a){var r;const l=kU(t),n=((r=t.split("@")[0])==null?void 0:r.toLowerCase())||"";return s?a==="Finance"?{group:"Finance",role:"Accountant",reason:"HRIS department = Finance"}:a==="Procurement"?{group:"Procurement",role:"Approver",reason:"HRIS department = Procurement"}:a==="Sales"?{group:"Sales",role:"User",reason:"HRIS department = Sales"}:a==="Operations"?{group:"Operations",role:"Manager",reason:"HRIS department = Operations"}:{group:"Admin",role:"User",reason:"HRIS department default"}:l.endsWith("acme.com")?n.includes("finance")||n.includes("account")?{group:"Finance",role:"Accountant",reason:"Matched email local-part pattern"}:n.includes("proc")?{group:"Procurement",role:"Approver",reason:"Matched email local-part pattern"}:n.includes("admin")?{group:"Admin",role:"Org Admin",reason:"Admin naming convention"}:{group:"Operations",role:"User",reason:"Corporate domain default"}:{group:"Operations",role:"User",reason:"Fallback rule"}}function n4(){const[t,s]=d.useState([]),a=b=>{const v=jU("toast");s(u=>[{id:v,...b},...u].slice(0,4)),window.setTimeout(()=>s(u=>u.filter(C=>C.id!==v)),3200)},[l,n]=d.useState(1),[r,i]=d.useState("INV-CPAY-8F2K-UG"),[o,c]=d.useState("finance@acme.com"),[x,j]=d.useState("+256 700 000 000"),[g]=d.useState(Date.now()+2*24*60*60*1e3),[N,$]=d.useState(!1),[T,k]=d.useState("finance@acme.com"),[q,L]=d.useState("+256 700 000 000"),[R,U]=d.useState("existing"),[ae,ie]=d.useState("finance@acme.com"),[_,W]=d.useState(!1),[J,we]=d.useState(""),[G,be]=d.useState(""),[Ge,Me]=d.useState("finance@acme.com"),[je,Ue]=d.useState("+256 700 000 000"),[Oe,he]=d.useState(""),[Y,Ie]=d.useState(!1),[ce,me]=d.useState(""),pe=d.useMemo(()=>({organization:"Acme Group Ltd",group:"Finance",role:"Accountant",spendLimits:{daily:"UGX 3,000,000",weekly:"UGX 12,000,000",monthly:"UGX 30,000,000"},autoApproval:{eligible:!1,under:"UGX 0"},defaultCostCenter:"FIN-OPS",defaultProjectTag:"Audit-2026",enforcedModules:["Rides & Logistics","E-Commerce","EVs & Charging","Finance & Payments","Other Service Module"],enforcedMarketplaces:["MyLiveDealz","EVmart","ServiceMart","GadgetMart","Other Marketplace"]}),[]),[de,ye]=d.useState(!0),[Qe,Fe]=d.useState(!1),[ke,fe]=d.useState("Finance"),Ve=d.useMemo(()=>CU(R==="existing"?ae:Ge,Qe,ke),[R,ae,Ge,Qe,ke]),ne=d.useMemo(()=>de?{...pe,group:Ve.group,role:Ve.role}:pe,[pe,de,Ve]),[Te,Ee]=d.useState(!0),[Re,ze]=d.useState({businessOnly:!1,noPersonalUse:!1,complyPolicy:!1,dataPrivacy:!1,antiBribery:!1}),qe=d.useMemo(()=>Te?Object.values(Re).every(Boolean):!0,[Te,Re]),[He,_e]=d.useState(!1),[le,z]=d.useState(!1),[Pe,Be]=d.useState(!1),xe=d.useMemo(()=>He&&le&&Pe,[He,le,Pe]),Ne=d.useMemo(()=>yU(g),[g]),M=d.useMemo(()=>r.trim()?!o.trim()||!x.trim()?{ok:!1,reason:"Missing invite email/phone"}:N||Date.now()>g?{ok:!1,reason:"Invite expired"}:T.trim().toLowerCase()!==o.trim().toLowerCase()?{ok:!1,reason:"Email does not match invite"}:q.trim()!==x.trim()?{ok:!1,reason:"Phone does not match invite"}:{ok:!0,reason:"Valid"}:{ok:!1,reason:"Missing token"},[r,o,x,N,g,T,q]),H=()=>{if(!M.ok){a({title:"Invite invalid",message:M.reason,kind:"warn"});return}a({title:"Invite validated",message:"Proceed to link your EVzone account.",kind:"success"}),n(2)},Ae=()=>{if(!ae.trim()){a({title:"Missing identifier",message:"Enter email or phone.",kind:"warn"});return}W(!0),a({title:"OTP sent",message:"Verification code sent (demo).",kind:"success"})},oe=()=>{if(!_){a({title:"Send OTP first",message:"Click Send OTP.",kind:"warn"});return}if(J.trim().length<4){a({title:"Invalid OTP",message:"Enter the code you received.",kind:"warn"});return}const b=`EVZ-${Math.floor(1e5+Math.random()*9e5)}`;me(b),Ie(!0),a({title:"Account linked",message:`Linked to EVzone ID ${b}.`,kind:"success"}),n(3)},De=()=>{if(!G.trim()||!Ge.trim()||!je.trim()||!Oe.trim()){a({title:"Missing fields",message:"Name, email, phone and password are required.",kind:"warn"});return}const b=`EVZ-${Math.floor(1e5+Math.random()*9e5)}`;me(b),Ie(!0),a({title:"Account created",message:`EVzone account created: ${b}.`,kind:"success"}),n(3)},$e=()=>{if(!Y){a({title:"Not linked",message:"Link or create your EVzone account first.",kind:"warn"});return}if(!qe){a({title:"Checklist incomplete",message:"Complete required attestations to continue.",kind:"warn"});return}a({title:"Defaults applied",message:"Group, role, limits and tags have been applied.",kind:"success"}),n(4)},ge=()=>{if(!xe){a({title:"Complete welcome",message:"Confirm the policy highlights first.",kind:"warn"});return}a({title:"Welcome",message:"CorporatePay is active for your EVzone account.",kind:"success"}),n(5)},ue=async b=>{try{await navigator.clipboard.writeText(b),a({title:"Copied",message:b,kind:"success"})}catch{a({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},Ke=d.useMemo(()=>{const b=(l-1)/4;return Math.round(NU(b*100,0,100))},[l]);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(wU,{toasts:t,onDismiss:b=>s(v=>v.filter(u=>u.id!==b))}),e.jsx("div",{className:"mx-auto max-w-7xl px-4 py-10 md:px-6",children:e.jsxs("div",{className:"rounded-[28px] border border-slate-200 bg-white p-6 shadow-[0_30px_90px_rgba(2,8,23,0.10)]",children:[e.jsxs("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:cg.green},children:e.jsx(Fd,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Invite acceptance and EVzone account linking"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Validate invite, link/create EVzone account, apply defaults, then complete welcome wizard."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(cl,{label:`Completion: ${Ke}%`,tone:Ke>=75?"good":Ke>=40?"warn":"neutral"}),e.jsx(cl,{label:`Expires: ${Ne}`,tone:N?"bad":"warn"}),e.jsxs(Ul,{variant:"outline",className:"text-xs",onClick:()=>$(b=>!b),children:[e.jsx(Mt,{className:"h-4 w-4"})," Simulate expired"]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(cl,{label:`Org: ${ne.organization}`,tone:"neutral"}),e.jsx(cl,{label:`Role: ${ne.role}`,tone:"info"}),e.jsx(cl,{label:`Group: ${ne.group}`,tone:"neutral"})]})]}),e.jsxs("div",{className:"mt-5 flex flex-wrap gap-2",children:[e.jsx(tm,{idx:1,active:l===1,done:l>1,label:"Validate invite"}),e.jsx(tm,{idx:2,active:l===2,done:l>2,label:"Link account"}),e.jsx(tm,{idx:3,active:l===3,done:l>3,label:"Defaults and checklist"}),e.jsx(tm,{idx:4,active:l===4,done:l>4,label:"Welcome"}),e.jsx(tm,{idx:5,active:l===5,done:!1,label:"Done"})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 gap-6 lg:grid-cols-3",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs(ed,{title:"Invite summary",subtitle:"The invite must match your email and phone",right:e.jsx(cl,{label:M.ok?"Valid":"Check",tone:M.ok?"good":"warn"}),children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Token"}),e.jsxs("div",{className:"mt-1 flex items-center justify-between gap-2",children:[e.jsx("span",{className:"font-mono text-sm font-semibold text-slate-900",children:r}),e.jsxs(Ul,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ue(r),children:[e.jsx(ls,{className:"h-4 w-4"})," Copy"]})]})]}),e.jsx(Ov,{icon:e.jsx(Xs,{className:"h-4 w-4"}),label:"Invite email",value:o}),e.jsx(Ov,{icon:e.jsx(qp,{className:"h-4 w-4"}),label:"Invite phone",value:x}),e.jsx(Ov,{icon:e.jsx(ct,{className:"h-4 w-4"}),label:"Expires",value:Ne})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"If your invite expires, request a new invite from your organization admin."})]}),e.jsxs(ed,{title:"Just-in-time provisioning",subtitle:"Premium: auto role assignment based on domain/HRIS rules",right:e.jsx(cl,{label:de?"On":"Off",tone:de?"info":"neutral"}),children:[e.jsx(Pv,{enabled:de,onChange:ye,label:"Enable JIT provisioning",description:"Applies group and role from rules on acceptance."}),e.jsx(Pv,{enabled:Qe,onChange:Fe,label:"HRIS rule (Phase 2)",description:"When enabled, HR department drives role assignment."}),e.jsxs("div",{className:Jl("mt-3",!Qe&&"opacity-60"),children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"HR department"}),e.jsx("select",{value:ke,onChange:b=>fe(b.target.value),disabled:!Qe,className:Jl("mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",!Qe&&"bg-slate-50 text-slate-500"),children:["Finance","Procurement","Sales","Operations","Admin"].map(b=>e.jsx("option",{value:b,children:b},b))})]}),e.jsxs("div",{className:"mt-3 rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Matched rule"}),e.jsxs("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:[Ve.group,"  ",Ve.role]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:Ve.reason})]}),e.jsx("div",{className:"mt-3 text-xs text-slate-500",children:"JIT provisioning modifies group and role only. Spend limits remain admin-defined."})]})]}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(lt,{mode:"wait",children:[l===1?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs(ed,{title:"Validate invite",subtitle:"Token, email, and phone must match the invitation",right:e.jsx(cl,{label:M.ok?"Ready":"Needs match",tone:M.ok?"good":"warn"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Pr,{icon:e.jsx(Fd,{className:"h-4 w-4"}),label:"Invite token",value:r,onChange:i,placeholder:"INV-...",required:!0}),e.jsx(Pr,{icon:e.jsx(Xs,{className:"h-4 w-4"}),label:"Invite email",value:o,onChange:c,placeholder:"you@company.com",required:!0}),e.jsx(Pr,{icon:e.jsx(qp,{className:"h-4 w-4"}),label:"Invite phone",value:x,onChange:j,placeholder:"+256 ...",required:!0}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Expiry"}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:Ne}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Invite links expire for security."})]})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Match details"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"To simulate verification, enter the same email and phone as the invite."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Pr,{icon:e.jsx(Xs,{className:"h-4 w-4"}),label:"Your email",value:T,onChange:k,placeholder:"finance@acme.com",required:!0}),e.jsx(Pr,{icon:e.jsx(qp,{className:"h-4 w-4"}),label:"Your phone",value:q,onChange:L,placeholder:"+256 700...",required:!0})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:["Status: ",e.jsx("span",{className:"font-semibold text-slate-900",children:M.ok?"Valid":M.reason})]})]}),e.jsxs("div",{className:"mt-4 flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsxs(Ul,{variant:"outline",onClick:()=>a({title:"Resend invite",message:"Admin resend flow opened (demo).",kind:"info"}),children:[e.jsx(ni,{className:"h-4 w-4"})," Request resend"]}),e.jsxs(Ul,{variant:"primary",onClick:H,children:[e.jsx(ct,{className:"h-4 w-4"})," Validate"]})]})]})},"s1"):null,l===2?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs(ed,{title:"Link your EVzone account",subtitle:"Connect to an existing account or create a new one",right:e.jsx(cl,{label:Y?"Linked":"Not linked",tone:Y?"good":"warn"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(r4,{title:"Link existing",desc:"Use OTP to verify ownership of your EVzone account.",active:R==="existing",onClick:()=>U("existing"),icon:e.jsx(Fd,{className:"h-4 w-4"})}),e.jsx(r4,{title:"Create new",desc:"Create an EVzone account and link it to this organization.",active:R==="new",onClick:()=>U("new"),icon:e.jsx(cx,{className:"h-4 w-4"})})]}),R==="existing"?e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Verify existing account"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Enter email/phone and receive an OTP."})]}),Y?e.jsx(cl,{label:`Linked: ${ce}`,tone:"good"}):e.jsx(cl,{label:"OTP required",tone:"warn"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Pr,{icon:e.jsx(Xs,{className:"h-4 w-4"}),label:"Email or phone",value:ae,onChange:ie,placeholder:"you@company.com or +256...",required:!0}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"OTP"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx("input",{value:J,onChange:b=>we(b.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"123456",className:"w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"}),e.jsxs(Ul,{variant:"outline",className:"px-3 py-2 text-xs",onClick:Ae,children:[e.jsx(xu,{className:"h-4 w-4"})," Send"]})]}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Demo: any 4+ digits verify."})]})]}),e.jsxs("div",{className:"mt-4 flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Ul,{variant:"outline",onClick:()=>n(1),children:"Back"}),e.jsxs(Ul,{variant:"primary",onClick:oe,children:[e.jsx(ct,{className:"h-4 w-4"})," Verify and link"]})]})]}):null,R==="new"?e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Create new EVzone account"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Account will be linked to the organization on acceptance."})]}),e.jsx(cl,{label:"New",tone:"info"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Pr,{icon:e.jsx(cx,{className:"h-4 w-4"}),label:"Full name",value:G,onChange:be,placeholder:"Your name",required:!0}),e.jsx(Pr,{icon:e.jsx(Xs,{className:"h-4 w-4"}),label:"Email",value:Ge,onChange:Me,placeholder:"you@company.com",required:!0}),e.jsx(Pr,{icon:e.jsx(qp,{className:"h-4 w-4"}),label:"Phone",value:je,onChange:Ue,placeholder:"+256...",required:!0}),e.jsx(Pr,{icon:e.jsx(ra,{className:"h-4 w-4"}),label:"Password",value:Oe,onChange:he,type:"password",placeholder:"",required:!0})]}),e.jsxs("div",{className:"mt-4 flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Ul,{variant:"outline",onClick:()=>n(1),children:"Back"}),e.jsxs(Ul,{variant:"primary",onClick:De,children:[e.jsx(cx,{className:"h-4 w-4"})," Create and link"]})]})]}):null,e.jsx("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"After linking, the system applies admin defaults (group, role, limits, tags) to your CorporatePay profile."})]})},"s2"):null,l===3?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs(ed,{title:"Review defaults and accept",subtitle:"Admin-defined defaults applied on acceptance",right:e.jsx(cl,{label:"Ready",tone:Y?"good":"warn"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(nc,{icon:e.jsx(Us,{className:"h-4 w-4"}),label:"Group",value:ne.group}),e.jsx(nc,{icon:e.jsx(yt,{className:"h-4 w-4"}),label:"Role",value:ne.role}),e.jsx(nc,{icon:e.jsx($a,{className:"h-4 w-4"}),label:"Spend limits",value:`${ne.spendLimits.daily} daily  ${ne.spendLimits.monthly} monthly`}),e.jsx(nc,{icon:e.jsx(ct,{className:"h-4 w-4"}),label:"Auto-approval",value:ne.autoApproval.eligible?`Eligible under ${ne.autoApproval.under}`:"Not eligible"}),e.jsx(nc,{icon:e.jsx(ht,{className:"h-4 w-4"}),label:"Default cost center",value:ne.defaultCostCenter}),e.jsx(nc,{icon:e.jsx(ht,{className:"h-4 w-4"}),label:"Default project tag",value:ne.defaultProjectTag})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Enabled modules and marketplaces"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"These are the default CorporatePay-enabled areas for your organization."}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:ne.enforcedModules.map(b=>e.jsx(cl,{label:b,tone:"neutral"},b))}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:ne.enforcedMarketplaces.map(b=>e.jsx(cl,{label:b,tone:b==="MyLiveDealz"?"info":"neutral"},b))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:'Note: "Other Service Module" and "Other Marketplace" slots allow future expansion without redesign.'})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Acceptance checklist"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: compliance attestations can be required by policy."})]}),e.jsx(Pv,{enabled:Te,onChange:Ee,label:"Require attestations",description:"If on, all boxes must be checked"})]}),e.jsxs("div",{className:Jl("mt-4 space-y-2",!Te&&"opacity-70"),children:[e.jsx(Hi,{label:"I will use CorporatePay for business purposes only",checked:Re.businessOnly,onChange:b=>ze(v=>({...v,businessOnly:b})),disabled:!Te}),e.jsx(Hi,{label:"I will not use CorporatePay for personal spending",checked:Re.noPersonalUse,onChange:b=>ze(v=>({...v,noPersonalUse:b})),disabled:!Te}),e.jsx(Hi,{label:"I agree to follow corporate spending policies",checked:Re.complyPolicy,onChange:b=>ze(v=>({...v,complyPolicy:b})),disabled:!Te}),e.jsx(Hi,{label:"I understand data privacy and audit logging",checked:Re.dataPrivacy,onChange:b=>ze(v=>({...v,dataPrivacy:b})),disabled:!Te}),e.jsx(Hi,{label:"I will comply with anti-bribery and compliance rules",checked:Re.antiBribery,onChange:b=>ze(v=>({...v,antiBribery:b})),disabled:!Te})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:qe?"Checklist complete.":"Complete the checklist to proceed."})]}),e.jsxs("div",{className:"mt-4 flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Ul,{variant:"outline",onClick:()=>n(2),children:"Back"}),e.jsxs(Ul,{variant:"primary",onClick:$e,children:[e.jsx(ct,{className:"h-4 w-4"})," Accept invite"]})]})]})},"s3"):null,l===4?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs(ed,{title:"Welcome wizard",subtitle:"Policy highlights, do/dont rules, and what changes in the app",right:e.jsx(cl,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"CorporatePay available in the EVzone app"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"You continue using the normal EVzone apps. Only the payment method changes."}),e.jsxs("div",{className:"mt-3 rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Checkout behavior"}),e.jsxs("ul",{className:"mt-2 space-y-1 text-xs text-slate-700",children:[e.jsx("li",{children:"1) You choose a ride/service/purchase as usual."}),e.jsxs("li",{children:["2) At checkout, select ",e.jsx("span",{className:"font-semibold text-slate-900",children:"CorporatePay"}),"."]}),e.jsx("li",{children:"3) Policies and approvals may apply."}),e.jsx("li",{children:"4) Spend maps to your group and cost center automatically."})]})]}),e.jsx("div",{className:"mt-3",children:e.jsx(Hi,{label:"I understand CorporatePay appears at checkout",checked:Pe,onChange:Be})})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Policy highlights"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Key rules you should follow."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3",children:[e.jsx(i4,{kind:"do",title:"Do",items:["Use correct purpose tags (airport, client meeting, etc.)",`Stay within spend limits (${ne.spendLimits.daily} daily)`,"Use approved vendors and marketplaces"]}),e.jsx(i4,{kind:"dont",title:"Dont",items:["Use CorporatePay for personal purchases","Bypass approvals or split purchases to avoid thresholds","Buy restricted categories (example: alcohol)"]})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx(Hi,{label:"I understand the policy do/dont rules",checked:He,onChange:_e}),e.jsx(Hi,{label:"I understand approvals can be required above thresholds",checked:le,onChange:z})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: if you need an exception, request approval in-app. All actions are audited."})]})]}),e.jsxs("div",{className:"mt-4 flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Ul,{variant:"outline",onClick:()=>n(3),children:"Back"}),e.jsxs(Ul,{variant:"primary",onClick:ge,children:[e.jsx(et,{className:"h-4 w-4"})," Finish"]})]})]})},"s4"):null,l===5?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs(ed,{title:"Youre all set",subtitle:"CorporatePay is now active for your EVzone account",right:e.jsx(cl,{label:"Completed",tone:"good"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(eh,{icon:e.jsx($a,{className:"h-5 w-5"}),title:"CorporatePay enabled",desc:"CorporatePay can now be selected at checkout for eligible transactions."}),e.jsx(eh,{icon:e.jsx(yt,{className:"h-5 w-5"}),title:"Policies enforced",desc:"Some transactions will require approval depending on rules and thresholds."}),e.jsx(eh,{icon:e.jsx(Us,{className:"h-5 w-5"}),title:"Org mapping",desc:`Spend maps to group ${ne.group} and cost center ${ne.defaultCostCenter}.`}),e.jsx(eh,{icon:e.jsx(XF,{className:"h-5 w-5"}),title:"Audit ready",desc:"All approvals and changes are logged for compliance."})]}),e.jsx("div",{className:"mt-4 rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ht,{className:"mt-0.5 h-4 w-4 text-emerald-700"}),e.jsxs("div",{className:"text-xs text-slate-600",children:["EVzone ID: ",e.jsx("span",{className:"font-semibold text-slate-900",children:ce}),"  Organization: ",e.jsx("span",{className:"font-semibold text-slate-900",children:ne.organization})]})]})}),e.jsxs("div",{className:"mt-4 flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsxs(Ul,{variant:"outline",onClick:()=>a({title:"Guide",message:"Opening onboarding guide (demo).",kind:"info"}),children:[e.jsx(Fu,{className:"h-4 w-4"})," View guide"]}),e.jsxs(Ul,{variant:"primary",onClick:()=>a({title:"Dashboard",message:"Opening CorporatePay Admin Console (demo).",kind:"success"}),children:[e.jsx(et,{className:"h-4 w-4"})," Open dashboard"]})]})]})},"s5"):null]})})]}),e.jsx("div",{className:"mt-6 text-xs text-slate-500",children:"X3: validates invite token/email/phone/expiry, links or creates EVzone account, applies admin defaults (group/role/limits/auto-approval/cost center/project tags), and completes a premium welcome wizard."})]})}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-7xl px-4 text-xs text-slate-500 md:px-6",children:"X3 Invite Acceptance: includes JIT provisioning (domain/HRIS rules), compliance checklist, and welcome wizard for policy highlights."})})]})}function Ov({icon:t,label:s,value:a}){return e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-600",children:t}),e.jsx("span",{className:"text-xs font-semibold text-slate-600",children:s})]}),e.jsx("span",{className:"text-xs font-semibold text-slate-900",children:a})]})})}function r4({title:t,desc:s,icon:a,active:l,onClick:n}){return e.jsx("button",{type:"button",onClick:n,className:Jl("rounded-3xl border p-4 text-left transition",l?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-slate-900",children:[e.jsx("span",{className:"text-slate-600",children:a}),t]}),e.jsx("div",{className:"mt-2 text-sm text-slate-600",children:s})]}),l?e.jsx(ct,{className:"h-5 w-5 text-emerald-700"}):null]})})}function nc({icon:t,label:s,value:a}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-600",children:t}),e.jsx("span",{className:"text-xs font-semibold text-slate-600",children:s})]}),e.jsx(cl,{label:"Applied",tone:"good"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:a})]})}function Hi({label:t,checked:s,onChange:a,disabled:l}){return e.jsxs("label",{className:Jl("flex items-start gap-3 rounded-2xl border border-slate-200 bg-white p-3",l&&"opacity-60"),children:[e.jsx("input",{type:"checkbox",checked:s,disabled:l,onChange:n=>a(n.target.checked),className:"mt-1 h-4 w-4 rounded border-slate-300"}),e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:t})]})}function i4({kind:t,title:s,items:a}){const l=t==="do"?"border-emerald-200 bg-emerald-50":"border-rose-200 bg-rose-50",n=t==="do"?"#10B981":"#F43F5E";return e.jsxs("div",{className:Jl("rounded-3xl border p-4",l),children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:s}),e.jsx("ul",{className:"mt-2 space-y-1 text-sm text-slate-700",children:a.map(r=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:n}}),e.jsx("span",{children:r})]},r))})]})}function eh({icon:t,title:s,desc:a}){return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"grid h-9 w-9 place-items-center rounded-2xl bg-emerald-50 text-emerald-700",children:t}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:s}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a})]})]})})}const SU=[{path:is.AUTH.LOGIN,element:Xt.createElement(mU)},{path:is.AUTH.MFA,element:Xt.createElement(bU)},{path:is.AUTH.INVITE,element:Xt.createElement(n4)},{path:is.AUTH.INVITE_TOKEN,element:Xt.createElement(n4)}],ug={green:"#03CD8C",orange:"#F77F00"};function Hl(...t){return t.filter(Boolean).join(" ")}function AU(t,s,a){return Math.max(s,Math.min(a,t))}function Ps(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function o4(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function Tl({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200 dark:bg-emerald-900/40 dark:text-emerald-300 dark:ring-emerald-800",warn:"bg-amber-50 text-amber-800 ring-amber-200 dark:bg-amber-900/40 dark:text-amber-300 dark:ring-amber-800",bad:"bg-rose-50 text-rose-700 ring-rose-200 dark:bg-rose-900/40 dark:text-rose-300 dark:ring-rose-800",info:"bg-blue-50 text-blue-700 ring-blue-200 dark:bg-blue-900/40 dark:text-blue-300 dark:ring-blue-800",neutral:"bg-slate-50 text-slate-700 ring-slate-200 dark:bg-slate-800 dark:text-slate-300 dark:ring-slate-700"};return e.jsx("span",{className:Hl("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Vl({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200 dark:shadow-none",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200 dark:shadow-none",outline:"border border-slate-200 bg-white text-slate-900 shadow-sm hover:bg-slate-50 focus:ring-slate-200 dark:border-slate-700 dark:bg-slate-800 dark:text-white dark:hover:bg-slate-700",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200 dark:text-slate-300 dark:hover:bg-slate-800",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100 dark:border-rose-900 dark:bg-rose-950 dark:text-rose-300"},c=t==="primary"?{background:ug.green}:t==="accent"?{background:ug.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Hl(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function EU({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:Hl("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function th({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="900px",actions:o}){return e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 bottom-4 top-4 z-50 mx-auto flex w-[min(980px,calc(100vw-2rem))] flex-col overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)] dark:border-slate-800 dark:bg-slate-900 dark:shadow-none",style:{maxWidth:i,maxHeight:"92vh"},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex shrink-0 items-start justify-between gap-3 border-b border-slate-200 px-5 py-4 dark:border-slate-800",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600 dark:text-slate-400",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(EU,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100 dark:text-slate-400 dark:hover:bg-slate-800",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"shrink-0 border-t border-slate-200 px-5 py-4 dark:border-slate-800",children:r}):null]})]}):null})}function MU({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur dark:border-slate-800 dark:bg-slate-900/90 dark:shadow-none",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Hl("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400",a.kind==="warn"&&"bg-amber-50 text-amber-800 dark:bg-amber-900/30 dark:text-amber-400",a.kind==="error"&&"bg-rose-50 text-rose-700 dark:bg-rose-900/30 dark:text-rose-400",a.kind==="info"&&"bg-blue-50 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600 dark:text-slate-400",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100 dark:text-slate-400 dark:hover:bg-slate-800",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function d4({title:t,rows:s,total:a}){return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 dark:border-slate-800 dark:bg-slate-900",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs font-semibold text-slate-700 dark:text-slate-300",children:[e.jsx("span",{children:t}),e.jsx("span",{children:Ps(a)})]}),e.jsx("div",{className:"mt-2 flex h-2 w-full overflow-hidden rounded-full bg-slate-100 dark:bg-slate-800",children:s.map((l,n)=>{const r=["bg-emerald-500","bg-blue-500","bg-amber-500","bg-indigo-500","bg-rose-500","bg-purple-500"],i=a>0?l.value/a*100:0;return e.jsx("div",{className:Hl("h-full",r[n%r.length]),style:{width:`${i}%`},title:`${l.label}: ${Ps(l.value)}`},l.label)})}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2 text-xs text-slate-500",children:s.map((l,n)=>e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx("span",{className:Hl("h-1.5 w-1.5 rounded-full",["bg-emerald-500","bg-blue-500","bg-amber-500","bg-indigo-500","bg-rose-500","bg-purple-500"][n%6])}),l.label]},l.label))})]})}function rc({title:t,value:s,sub:a,icon:l,trend:n,variant:r}){const i={green:"border-slate-200 bg-white hover:border-emerald-200 hover:shadow-emerald-500/10 dark:border-slate-800 dark:bg-slate-900 dark:hover:border-emerald-500/30",orange:"border-slate-200 bg-white hover:border-orange-200 hover:shadow-orange-500/10 dark:border-slate-800 dark:bg-slate-900 dark:hover:border-orange-500/30",gray:"border-slate-200 bg-white hover:border-slate-300 dark:border-slate-800 dark:bg-slate-900"},o={green:"bg-emerald-50 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400",orange:"bg-orange-50 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400",gray:"bg-slate-50 text-slate-700 dark:bg-slate-800 dark:text-slate-400"},c=r||"gray";return e.jsx("div",{className:Hl("rounded-3xl border p-6 shadow-sm transition-all hover-lift dark:shadow-none",i[c]),children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-500 dark:text-slate-400",children:t}),e.jsx("div",{className:"mt-2 text-3xl font-semibold tracking-tight text-slate-900 dark:text-white",children:s}),e.jsx("div",{className:"mt-1 text-sm text-slate-600 dark:text-slate-400",children:a}),n?e.jsx("div",{className:"mt-3",children:e.jsx(Tl,{label:n.label,tone:n.tone})}):null]}),e.jsx("div",{className:Hl("grid h-12 w-12 place-items-center rounded-2xl shrink-0",o[c]),children:l})]})})}function PU({value:t,labelLeft:s,labelRight:a}){const l=AU(t,0,100);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-600",children:[e.jsx("span",{className:"font-semibold",children:s}),e.jsx("span",{className:"font-semibold",children:a})]}),e.jsx("div",{className:"mt-2 h-2 w-full overflow-hidden rounded-full bg-slate-100",children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${l}%`,background:ug.green}})})]})}function OU({data:t,height:s=240}){if(!(t!=null&&t.length))return null;const a=Math.max(...t.map(o=>o.value))||1,l=s-40,n=t.map((o,c)=>{const x=c/(t.length-1)*100,j=100-o.value/a*100;return[x,j]}),i=(o=>{if(o.length===0)return"";let c=`M ${o[0][0]},${o[0][1]}`;for(let x=0;x<o.length-1;x++){const j=o[x],g=o[x+1],N=j[0]+(g[0]-j[0])*.5,$=j[1],T=j[0]+(g[0]-j[0])*.5,k=g[1];c+=` C ${N},${$} ${T},${k} ${g[0]},${g[1]}`}return c})(n);return e.jsxs("div",{className:"rounded-2xl border border-slate-800 bg-[#0B1120] p-4 text-white shadow-sm overflow-hidden relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 z-10 relative",children:[e.jsx("h3",{className:"text-sm font-semibold text-white",children:"Trip Trends"}),e.jsxs("div",{className:"flex rounded-lg bg-slate-800 p-0.5",children:[e.jsx("span",{className:"px-2 py-1 text-[10px] font-semibold text-slate-400",children:"RIDES"}),e.jsx("span",{className:"px-2 py-1 text-[10px] font-semibold text-slate-400",children:"DELIVERY"}),e.jsx("span",{className:"px-2 py-1 text-[10px] font-semibold text-slate-900 bg-[#03CD8C] rounded shadow",children:"BOTH"})]})]}),e.jsxs("div",{className:"relative",style:{height:l},children:[[0,25,50,75,100].map(o=>e.jsx("div",{className:"absolute left-0 right-0 border-t border-dashed border-slate-700/50",style:{top:`${o}%`}},o)),e.jsx("div",{className:"absolute inset-0 flex justify-between pointer-events-none",children:t.map((o,c)=>e.jsx("div",{className:"h-full border-r border-dashed border-slate-700/50 w-px first:border-l"},c))}),e.jsxs("svg",{viewBox:"0 0 100 100",preserveAspectRatio:"none",className:"absolute inset-0 h-full w-full overflow-visible",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"chartGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"#03CD8C",stopOpacity:"0.4"}),e.jsx("stop",{offset:"100%",stopColor:"#03CD8C",stopOpacity:"0"})]})}),e.jsx("path",{d:`${i} L 100,100 L 0,100 Z`,fill:"url(#chartGradient)"}),e.jsx("path",{d:i,fill:"none",stroke:"#03CD8C",strokeWidth:"1.5",className:"drop-shadow-[0_0_6px_rgba(3,205,140,0.5)]"})]})]}),e.jsx("div",{className:"mt-2 flex justify-between text-[10px] text-slate-400 font-medium",children:t.map((o,c)=>c%2===0||c===t.length-1?e.jsx("div",{children:o.label},c):null)})]})}function c4({title:t,subtitle:s,icon:a,items:l,actionLabel:n,onAction:r}){return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 dark:border-slate-800 dark:bg-slate-900",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:a}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-900 dark:text-white",children:t}),e.jsx("div",{className:"mt-0.5 text-xs text-slate-500 dark:text-slate-500",children:s})]})]}),n?e.jsx("button",{type:"button",className:"text-xs font-semibold text-emerald-700 hover:underline",onClick:r,children:n}):null]}),e.jsx("div",{className:"mt-3 space-y-2",children:l.map(i=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 dark:border-slate-800 dark:bg-slate-950",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900 dark:text-slate-200",children:i.title}),e.jsx("div",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:i.meta})]}),i.pill?e.jsx(Tl,{label:i.pill.label,tone:i.pill.tone}):null]})},i.title))})]})}function TU(){const t=Xd(),[s,a]=d.useState([]),l=xe=>{const Ne=o4("toast");a(M=>[{id:Ne,...xe},...M].slice(0,4)),window.setTimeout(()=>a(M=>M.filter(H=>H.id!==Ne)),3200)},n=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],r=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],i=["Operations","Sales","Finance","Admin","Procurement"],[o]=d.useState("Acme Group Ltd"),[c,x]=d.useState("This month"),[j,g]=d.useState(()=>{const xe=new Date;return xe.setMonth(xe.getMonth()-1),xe.toISOString().split("T")[0]}),[N,$]=d.useState(()=>new Date().toISOString().split("T")[0]),[T,k]=d.useState(68e5),[q,L]=d.useState("All"),[R,U]=d.useState("All"),[ae,ie]=d.useState("All"),_=d.useMemo(()=>R==="All"||R==="E-Commerce",[R]),W=d.useMemo(()=>{let M=1,H=1,Ae="This month";switch(c){case"Today":M=.038,H=.038,Ae="Today";break;case"This week":M=.21,H=.21,Ae="This week";break;case"This month":M=1,H=1,Ae="This month";break;case"This year":M=8.5,H=12,Ae="This year";break;case"Custom":const se=new Date(j),y=new Date(N),re=Math.max(1,Math.ceil((y.getTime()-se.getTime())/(1e3*60*60*24)));M=re/30,H=re/30,Ae=`${re} days`;break}const oe=Math.round(325e5*.038),De=Math.round(325e5*.21),$e=Math.round(325e5*M),ge=Math.round(325e5*8.5),ue=Math.round(4e7*H),Ke=Math.round(142e5*M),b=Math.round(168e5*M),v=Math.round(15e5*M),u=T,C=82e5,Q=3,O=c==="Today"?0:c==="This week"?1:2,ee=c==="Today"?0:1,F=Math.round(4*M),D=7,m=30,A=Math.round($e/Math.max(1,D*M)*m*M),f={"E-Commerce":Math.round(168e5*M),"EVs & Charging":Math.round(42e5*M),"Rides & Logistics":Math.round(142e5*M),"School & E-Learning":Math.round(8e5*M),"Medical & Health Care":Math.round(65e4*M),"Travel & Tourism":Math.round(12e5*M),"Green Investments":Math.round(5e5*M),FaithHub:Math.round(12e4*M),"Virtual Workspace":Math.round(9e5*M),"Finance & Payments":Math.round(2e6*M),"Other Service Module":0},B={MyLiveDealz:Math.round(52e5*M),ServiceMart:Math.round(12e5*M),EVmart:Math.round(34e5*M),GadgetMart:Math.round(22e5*M),LivingMart:Math.round(13e5*M),StyleMart:Math.round(9e5*M),EduMart:Math.round(6e5*M),HealthMart:Math.round(75e4*M),PropertyMart:Math.round(4e5*M),GeneratMart:Math.round(7e5*M),ExpressMart:Math.round(6e5*M),FaithMart:Math.round(15e4*M),"Other Marketplace":0},p={Operations:Math.round(12e6*M),Sales:Math.round(98e5*M),Finance:Math.round(52e5*M),Admin:Math.round(41e5*M),Procurement:Math.round(34e5*M)},E={Operations:Math.round(15e6*H),Sales:Math.round(12e6*H),Finance:Math.round(6e6*H),Admin:Math.round(5e6*H),Procurement:Math.round(5e6*H)};return{spendToday:oe,spendWeek:De,spendMonth:$e,spendYear:ge,budgetMonth:ue,budgetRemaining:Math.max(0,ue-$e),ridesMonth:Ke,purchasesMonth:b,servicesMonth:v,walletBalance:T,creditLimit:u,creditUsed:C,prepaidRunwayDays:Q,failedPayments:O,overdueInvoices:ee,policyBreaches:F,forecastMonthEnd:A,monthDay:D,daysInMonth:m,spendByModule:f,spendByMarketplace:B,spendByGroup:p,budgetByGroup:E,periodLabel:Ae,multiplier:M}},[c,j,N,T]),[J,we]=d.useState([]),[G,be]=d.useState(()=>[{id:"AP-1821",type:"Purchase",module:"E-Commerce",marketplace:"MyLiveDealz",requester:"Mary N.",group:"Operations",amount:654e4,slaHours:6,ageMinutes:120,status:"Pending",needsAttachment:!0},{id:"RFQ-390",type:"RFQ",module:"Rides & Logistics",marketplace:"-",requester:"Ronald I.",group:"Admin",amount:285e6,slaHours:2,ageMinutes:1440,status:"Escalated",needsAttachment:!0},{id:"RD-0442",type:"Ride",module:"Rides & Logistics",marketplace:"-",requester:"John S.",group:"Sales",amount:41500,slaHours:7,ageMinutes:15,status:"Pending",needsAttachment:!1},{id:"SV-2201",type:"Service",module:"EVs & Charging",marketplace:"-",requester:"Finance Desk",group:"Finance",amount:18e5,slaHours:12,ageMinutes:180,status:"Pending",needsAttachment:!1}]),[Ge,Me]=d.useState(null),je=G.filter(xe=>xe.status!=="Escalated").length,Ue=G.filter(xe=>xe.status==="Escalated").length,[Oe,he]=d.useState(()=>{const xe={};return n.forEach(Ne=>xe[Ne]=Ne!=="Other Service Module"),xe}),Y=d.useMemo(()=>[{title:"Failed payments",meta:`${W.failedPayments} failures  Risk of hold`,pill:{label:"Critical",tone:"bad"}},{title:"Overdue invoices",meta:`${W.overdueInvoices} invoice  Grace window active`,pill:{label:"Warning",tone:"warn"}},{title:"Policy breaches",meta:`${W.policyBreaches} events  Review policy rules`,pill:{label:"Review",tone:"info"}}],[W.failedPayments,W.overdueInvoices,W.policyBreaches]),Ie=d.useMemo(()=>({rows:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],cols:["06-09","09-12","12-15","15-18","18-21","21-24"],matrix:[[6,10,8,9,14,3],[5,9,7,10,12,2],[7,11,9,12,16,4],[6,10,8,11,15,3],[8,13,10,14,18,5],[3,6,7,9,12,6],[2,4,5,7,9,4]]}),[]);d.useMemo(()=>[{title:"Unusual vendor spend",body:"Shenzhen Store spend is 3.1 higher than typical (MyLiveDealz).",severity:"warn",ctas:["Investigate","Create rule"]},{title:"User nearing cap",body:"3 users are above 80% of their monthly cap in Sales.",severity:"info",ctas:["Review users","Tighten policy"]}],[]),d.useMemo(()=>[{title:"Prefer standard rides for commute",body:`Estimated savings: ${Ps(42e4)} this month if premium is restricted for commute trips.`,tag:"Rides & Logistics"},{title:"Use preferred vendor catalog",body:`Estimated savings: ${Ps(9e5)} by routing purchases to negotiated vendors.`,tag:"E-Commerce"},{title:"Bundle EV charging credits",body:`Estimated savings: ${Ps(26e4)} by purchasing credits in bulk (EVs & Charging).`,tag:"EVs & Charging"}],[]),d.useMemo(()=>[{id:"NA-1",title:"Approve RFQ escalation",why:"RFQ-390 is escalated and past SLA.",impact:"Unblocks high-value asset procurement.",cta:"Open RFQ",tone:"warn"},{id:"NA-2",title:"Increase Operations budget or enforce hard cap",why:"Operations is projected to exceed budget by month-end.",impact:"Prevents service interruption.",cta:"Adjust budget",tone:"info"},{id:"NA-3",title:"Add Shenzhen Store to vendor rule",why:"Anomaly detected for vendor spend.",impact:"Reduces fraud risk and overspend.",cta:"Create rule",tone:"good"}],[]);const ce=W.spendMonth/Math.max(1,W.budgetMonth)*100,me=W.creditUsed/Math.max(1,W.creditLimit)*100,pe=d.useMemo(()=>i.map(Ne=>{const M=W.spendByGroup[Ne],H=Math.round(M/Math.max(1,W.monthDay)*W.daysInMonth),Ae=W.budgetByGroup[Ne],oe=H>Ae?"bad":H>Ae*.9?"warn":"good";return{group:Ne,mtd:M,forecast:H,budget:Ae,risk:oe}}),[W,i]),de=d.useMemo(()=>n.map(Ne=>{const M=W.spendByModule[Ne]||0,H=Math.round(M/Math.max(1,W.monthDay)*W.daysInMonth);return{module:Ne,mtd:M,forecast:H}}).filter(Ne=>Ne.mtd>0||Ne.module==="Other Service Module"),[W,n]),ye=d.useMemo(()=>r.map(Ne=>{const M=W.spendByMarketplace[Ne]||0,H=Math.round(M/Math.max(1,W.monthDay)*W.daysInMonth);return{marketplace:Ne,mtd:M,forecast:H}}).filter(Ne=>Ne.mtd>0||Ne.marketplace==="Other Marketplace"),[W,r]),[Qe,Fe]=d.useState(!1),[ke,fe]=d.useState(!1),[Ve,ne]=d.useState(!1),[Te,Ee]=d.useState(!1),[Re,ze]=d.useState({method:"Wallet top-up",amount:2e6,reference:""}),[qe,He]=d.useState({group:"Operations",module:"All",marketplace:"All",period:"Monthly",amount:5e6,hardCap:!0}),[_e,le]=d.useState({title:"Company vehicle purchase",module:"Rides & Logistics",marketplace:"All",estValue:285e6,neededBy:"2026-02-01",description:"Need a company vehicle. Include warranty, service plan, and delivery timeline.",attachments:!1}),z=Object.values(W.spendByModule).reduce((xe,Ne)=>xe+Ne,0),Pe=Object.values(W.spendByMarketplace).reduce((xe,Ne)=>xe+Ne,0),Be=d.useMemo(()=>{const xe=[];return q!=="All"&&xe.push(`Group: ${q}`),R!=="All"&&xe.push(`Module: ${R}`),ae!=="All"&&xe.push(`Marketplace: ${ae}`),xe.length?xe.join("  "):"All spend"},[q,R,ae,T]);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(MU,{toasts:s,onDismiss:xe=>a(Ne=>Ne.filter(M=>M.id!==xe))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)] transition-colors dark:border-slate-800 dark:bg-slate-900 dark:shadow-none",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 transition-colors md:px-6 dark:border-slate-800 dark:bg-slate-900",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:ug.green},children:e.jsx(wa,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:"CorporatePay Dashboard"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:["Organization: ",o,"  ",Be]}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(Tl,{label:`Approvals: ${je} pending`,tone:je?"warn":"good"}),Ue?e.jsx(Tl,{label:`${Ue} escalated`,tone:"bad"}):null,e.jsx(Tl,{label:`Budget used: ${Math.round(ce)}%`,tone:ce>90?"bad":ce>75?"warn":"good"}),e.jsx(Tl,{label:`Forecast: ${Ps(W.forecastMonthEnd)}`,tone:W.forecastMonthEnd>W.budgetMonth?"warn":"good"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-2 py-2 shadow-sm dark:border-slate-800 dark:bg-slate-900",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400",children:"Time"}),e.jsxs("select",{value:c,onChange:xe=>x(xe.target.value),className:"rounded-xl border border-slate-200 bg-white px-2 py-1 text-xs font-semibold text-slate-700 outline-none dark:border-slate-700 dark:bg-slate-800 dark:text-slate-200",children:[e.jsx("option",{children:"Today"}),e.jsx("option",{children:"This week"}),e.jsx("option",{children:"This month"}),e.jsx("option",{children:"This year"}),e.jsx("option",{children:"Custom"})]})]}),c==="Custom"&&e.jsxs("div",{className:"flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2 shadow-sm dark:border-slate-800 dark:bg-slate-900",children:[e.jsx(_F,{className:"h-4 w-4 text-slate-500 dark:text-slate-400"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"date",value:j,onChange:xe=>g(xe.target.value),className:"rounded-lg border border-slate-200 bg-white px-2 py-1 text-xs font-semibold text-slate-700 outline-none focus:ring-2 focus:ring-orange-200 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-200"}),e.jsx("span",{className:"text-xs text-slate-500",children:"to"}),e.jsx("input",{type:"date",value:N,onChange:xe=>$(xe.target.value),className:"rounded-lg border border-slate-200 bg-white px-2 py-1 text-xs font-semibold text-slate-700 outline-none focus:ring-2 focus:ring-orange-200 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-200"})]}),e.jsxs("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:["(",W.periodLabel,")"]})]}),e.jsxs(Vl,{variant:"primary",onClick:()=>Ee(!0),children:[e.jsx(ct,{className:"h-4 w-4"})," Approvals inbox"]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2 dark:border-slate-700 dark:bg-slate-800",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400",children:"Group"}),e.jsxs("select",{value:q,onChange:xe=>L(xe.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-2 py-2 text-sm font-semibold text-slate-900 outline-none dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100",children:[e.jsx("option",{value:"All",children:"All"}),i.map(xe=>e.jsx("option",{value:xe,children:xe},xe))]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2 dark:border-slate-700 dark:bg-slate-800",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400",children:"Service Module"}),e.jsxs("select",{value:R,onChange:xe=>{const Ne=xe.target.value;U(Ne),Ne!=="All"&&Ne!=="E-Commerce"&&ie("All")},className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-2 py-2 text-sm font-semibold text-slate-900 outline-none dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100",children:[e.jsx("option",{value:"All",children:"All"}),n.map(xe=>e.jsx("option",{value:xe,children:xe},xe))]})]}),e.jsxs("div",{className:Hl("rounded-2xl border px-3 py-2",_?"border-slate-200 bg-white dark:border-slate-700 dark:bg-slate-800":"border-slate-200 bg-slate-50 opacity-70 dark:border-slate-700 dark:bg-slate-800/50"),children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400",children:"Marketplace"}),e.jsxs("select",{value:ae,disabled:!_,onChange:xe=>ie(xe.target.value),className:Hl("mt-1 w-full rounded-xl border px-2 py-2 text-sm font-semibold outline-none",_?"border-slate-200 bg-white text-slate-900 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100":"border-slate-200 bg-slate-50 text-slate-500 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-400"),children:[e.jsx("option",{value:"All",children:"All"}),r.map(xe=>e.jsx("option",{value:xe,children:xe},xe))]}),_?null:e.jsx("div",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:"Marketplace filters apply to E-Commerce only."})]})]})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-8 transition-colors md:px-8 dark:bg-slate-950",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsx(rc,{title:"Spend today",value:Ps(W.spendToday),sub:"All modules",icon:e.jsx(rg,{className:"h-5 w-5"}),trend:{label:"+12% vs yesterday",tone:"good"},variant:"green"}),e.jsx(rc,{title:"Spend this week",value:Ps(W.spendWeek),sub:"Week-to-date",icon:e.jsx(OE,{className:"h-5 w-5"}),trend:{label:"Stable",tone:"neutral"},variant:"orange"}),e.jsx(rc,{title:"Spend this month",value:Ps(W.spendMonth),sub:`Budget: ${Ps(W.budgetMonth)}`,icon:e.jsx(Sr,{className:"h-5 w-5"}),trend:{label:`${Math.round(ce)}% used`,tone:ce>90?"bad":"warn"},variant:"gray"}),e.jsx(rc,{title:"Budget remaining",value:Ps(W.budgetRemaining),sub:"Available this month",icon:e.jsx(dx,{className:"h-5 w-5"}),trend:{label:W.budgetRemaining<2e6?"Low":"OK",tone:W.budgetRemaining<2e6?"warn":"good"},variant:"orange"}),e.jsx(rc,{title:"Approvals pending",value:String(je),sub:Ue?`${Ue} escalated`:"No escalations",icon:e.jsx(ct,{className:"h-5 w-5"}),trend:{label:Ue?"Escalation":"On track",tone:Ue?"bad":"good"},variant:"green"}),e.jsx(rc,{title:"Forecast month-end",value:Ps(W.forecastMonthEnd),sub:W.forecastMonthEnd>W.budgetMonth?"Over budget":"Within budget",icon:e.jsx(qd,{className:"h-5 w-5"}),trend:{label:W.forecastMonthEnd>W.budgetMonth?"Risk":"OK",tone:W.forecastMonthEnd>W.budgetMonth?"warn":"good"},variant:"gray"})]}),e.jsxs("div",{className:"mt-8 rounded-[32px] border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-800 dark:bg-slate-900",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"Account Health"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Wallet, credit, and service status overview"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Tl,{label:`Wallet: ${Ps(W.walletBalance)}`,tone:W.walletBalance<1e6?"bad":"good"}),e.jsx(Tl,{label:`Credit: ${Math.round(me)}% used`,tone:me>80?"warn":"neutral"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[e.jsxs("div",{className:"rounded-3xl bg-slate-50 p-5 dark:bg-slate-800/50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-emerald-100 text-emerald-600 dark:bg-emerald-900/30 dark:text-emerald-400",children:e.jsx($a,{className:"h-5 w-5"})}),e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:"Wallet Balance"})]}),e.jsx("div",{className:"text-3xl font-bold text-slate-900 dark:text-white",children:Ps(W.walletBalance)}),e.jsx("div",{className:"mt-4",children:e.jsx(Vl,{variant:"outline",className:"w-full justify-center bg-white dark:bg-slate-800",onClick:()=>Fe(!0),children:"Top up"})})]}),e.jsxs("div",{className:"rounded-3xl bg-slate-50 p-5 dark:bg-slate-800/50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400",children:e.jsx(EE,{className:"h-5 w-5"})}),e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:"Credit Usage"})]}),e.jsxs("div",{className:"text-3xl font-bold text-slate-900 dark:text-white",children:[Ps(W.creditUsed)," ",e.jsxs("span",{className:"text-sm font-normal text-slate-500",children:["/ ",Ps(W.creditLimit)]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(PU,{value:me,labelLeft:"Used",labelRight:`${Math.round(me)}%`})})]}),e.jsxs("div",{className:"rounded-3xl bg-slate-50 p-5 dark:bg-slate-800/50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-purple-100 text-purple-600 dark:bg-purple-900/30 dark:text-purple-400",children:e.jsx(wa,{className:"h-5 w-5"})}),e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:"Active Modules"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 mt-2",children:n.map(xe=>e.jsx("button",{type:"button",className:Hl("inline-flex items-center justify-center rounded-lg px-2 py-1.5 text-xs font-medium transition-colors cursor-pointer border",Oe[xe]?"bg-[#064e3b] text-emerald-100 border-[#065f46] hover:bg-[#065f46] shadow-sm":"bg-slate-100 text-slate-500 border-slate-200 hover:bg-slate-200 dark:bg-slate-800 dark:text-slate-500 dark:border-slate-700"),onClick:()=>{he(Ne=>({...Ne,[xe]:!Ne[xe]})),l({title:"Module toggle",message:`${xe} ${Oe[xe]?"disabled":"enabled"}`,kind:"info"})},children:xe},xe))})]})]})]}),e.jsxs("div",{className:"mt-8 grid grid-cols-1 gap-8 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-8",children:e.jsxs("div",{className:"rounded-[32px] border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-800 dark:bg-slate-900",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"Top Issues"}),e.jsx(Tl,{label:`${Y.length}`,tone:Y.some(xe=>xe.pill.tone==="bad")?"bad":"warn"})]}),e.jsx("div",{className:"space-y-3",children:Y.map(xe=>e.jsx("button",{onClick:()=>t("/console/notifications_activity"),className:"w-full rounded-2xl border border-slate-100 bg-slate-50 p-4 text-left transition-all hover:bg-white hover:shadow-md hover:ring-1 hover:ring-slate-200 dark:border-slate-800 dark:bg-slate-800/50 dark:hover:bg-slate-800 dark:hover:ring-slate-700",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-white",children:xe.title}),e.jsx("div",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:xe.meta})]}),e.jsx(Tl,{label:xe.pill.label,tone:xe.pill.tone})]})},xe.title))}),e.jsx(Vl,{variant:"ghost",className:"mt-4 w-full text-xs",onClick:()=>t("/console/notifications_activity"),children:"View all notifications"})]})}),e.jsxs("div",{className:"lg:col-span-8 flex flex-col gap-8",children:[e.jsxs("div",{className:"rounded-[32px] border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-800 dark:bg-slate-900",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"Peak Ride Times"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Ride volume heat distribution"})]}),e.jsxs(Vl,{variant:"outline",className:"h-8 text-xs",onClick:()=>l({title:"Updated",message:"Data refreshed",kind:"success"}),children:[e.jsx(gt,{className:"h-3 w-3 mr-2"}),"Import Data"]})]}),e.jsx("div",{className:"overflow-hidden rounded-2xl border border-slate-100 dark:border-slate-800",children:e.jsx("div",{className:"p-4 rounded-2xl border border-slate-100 dark:border-slate-800",children:e.jsx(OU,{data:Ie.cols.map((xe,Ne)=>{const M=Ie.matrix.reduce((H,Ae)=>H+Ae[Ne],0);return{label:xe,value:M}})})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(c4,{title:"Top Vendors",subtitle:"By spend volume",icon:e.jsx(jw,{className:"h-4 w-4"}),actionLabel:"View All",onAction:()=>t("/console/reporting"),items:[{title:"Shenzhen Store",meta:`UGX ${Ps(52e5)}`,pill:{label:"Anomaly",tone:"warn"}},{title:"Kampala Office Mart",meta:`UGX ${Ps(31e5)}`,pill:{label:"Preferred",tone:"good"}},{title:"City Courier",meta:`UGX ${Ps(82e4)}`,pill:{label:"OK",tone:"neutral"}}]}),e.jsx(c4,{title:"Top Routes",subtitle:"Most frequent trips",icon:e.jsx(Hx,{className:"h-4 w-4"}),actionLabel:"View All",onAction:()=>t("/console/travel"),items:[{title:"Office  Airport",meta:"36 trips  Avg UGX 82k",pill:{label:"Peak",tone:"warn"}},{title:"Office  Client HQ",meta:"29 trips  Avg UGX 41k",pill:{label:"OK",tone:"neutral"}},{title:"Office  Warehouse",meta:"18 trips  Avg UGX 35k",pill:{label:"OK",tone:"neutral"}}]})]})]}),e.jsxs("div",{className:"lg:col-span-12 rounded-[32px] border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-800 dark:bg-slate-900",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"Budget Forecast"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Projected month-end spend vs budget"})]}),e.jsx(Tl,{label:`Day ${W.monthDay} of ${W.daysInMonth}`,tone:"neutral"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-8 lg:grid-cols-3",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-100 dark:border-slate-800",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs font-semibold text-slate-600 dark:bg-slate-950 dark:text-slate-400",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-5 py-3",children:"Group"}),e.jsx("th",{className:"px-5 py-3 text-right",children:"MTD Spend"}),e.jsx("th",{className:"px-5 py-3 text-right",children:"Forecast"}),e.jsx("th",{className:"px-5 py-3 text-right",children:"Budget"}),e.jsx("th",{className:"px-5 py-3 text-center",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:pe.map(xe=>e.jsxs("tr",{className:"hover:bg-slate-50/50",children:[e.jsx("td",{className:"px-5 py-3 font-medium text-slate-900 dark:text-white",children:xe.group}),e.jsx("td",{className:"px-5 py-3 text-right text-slate-600 dark:text-slate-300",children:Ps(xe.mtd)}),e.jsx("td",{className:"px-5 py-3 text-right font-medium text-slate-900 dark:text-white",children:Ps(xe.forecast)}),e.jsx("td",{className:"px-5 py-3 text-right text-slate-500",children:Ps(xe.budget)}),e.jsx("td",{className:"px-5 py-3 text-center",children:e.jsx(Tl,{label:xe.risk==="bad"?"Over":xe.risk==="warn"?"Risk":"OK",tone:xe.risk})})]},xe.group))})]})})}),e.jsx("div",{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(d4,{title:"Service Modules",total:z,rows:de.slice(0,5).map(xe=>({label:xe.module,value:xe.mtd}))}),e.jsx(d4,{title:"Marketplaces",total:Pe,rows:ye.slice(0,5).map(xe=>({label:xe.marketplace,value:xe.mtd}))})]})})]})]}),e.jsx("div",{className:"mt-8 text-center lg:col-span-12",children:e.jsx("div",{className:"inline-block rounded-full bg-slate-100 px-4 py-2 text-xs text-slate-500 dark:bg-slate-900 dark:text-slate-400",children:"CorporatePay v2.5  Everything is up to date"})}),e.jsx("div",{className:"mt-8 lg:col-span-12",children:e.jsx("div",{className:"rounded-[32px] border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-800 dark:bg-slate-900",children:e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"Quick Actions"}),e.jsx("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Fast paths to high-impact workflows"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs(Vl,{variant:"primary",onClick:()=>Fe(!0),className:"shadow-lg shadow-emerald-500/10",children:[e.jsx($a,{className:"h-4 w-4"})," Add funds"]}),e.jsxs(Vl,{variant:"outline",onClick:()=>fe(!0),children:[e.jsx(dx,{className:"h-4 w-4"})," Issue budget"]}),e.jsxs(Vl,{variant:"outline",onClick:()=>Ee(!0),children:[e.jsx(ct,{className:"h-4 w-4"})," Approve queue"]}),e.jsxs(Vl,{variant:"outline",onClick:()=>ne(!0),children:[e.jsx(wt,{className:"h-4 w-4"})," Create RFQ"]})]})]})})})]})," "]})]})}),e.jsx(th,{open:Qe,title:"Add funds",subtitle:"Top up wallet or add prepaid deposit. (Demo)",onClose:()=>Fe(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Vl,{variant:"outline",onClick:()=>Fe(!1),children:"Cancel"}),e.jsxs(Vl,{variant:"primary",onClick:()=>{Fe(!1),k(xe=>xe+Re.amount),l({title:"Funds added",message:`${Re.method}: ${Ps(Re.amount)}`,kind:"success"})},children:[e.jsx($a,{className:"h-4 w-4"})," Confirm"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Method"}),e.jsxs("select",{value:Re.method,onChange:xe=>ze(Ne=>({...Ne,method:xe.target.value})),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:[e.jsx("option",{children:"Wallet top-up"}),e.jsx("option",{children:"Prepaid deposit"}),e.jsx("option",{children:"Credit repayment"})]}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Payment rails configured under Finance & Payments."})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Amount (UGX)"}),e.jsx("input",{type:"number",min:0,onKeyDown:xe=>(xe.key==="-"||xe.key==="e")&&xe.preventDefault(),value:Re.amount,onChange:xe=>{const Ne=Number(xe.target.value||0);Ne>=0&&ze(M=>({...M,amount:Ne}))},className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Preview: ",Ps(Re.amount)]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Reference (optional)"}),e.jsx("input",{value:Re.reference,onChange:xe=>ze(Ne=>({...Ne,reference:xe.target.value})),placeholder:"Bank/txn reference",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"})]}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Premium: large funding events can require approvals and are fully audit logged."})]})}),e.jsx(th,{open:ke,title:"Issue budget",subtitle:"Allocate budget to a group (and optionally module/marketplace).",onClose:()=>fe(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Vl,{variant:"outline",onClick:()=>fe(!1),children:"Cancel"}),e.jsxs(Vl,{variant:"primary",onClick:()=>{fe(!1),we(xe=>[{id:o4("budget"),group:qe.group,amount:Number(qe.amount),period:qe.period,timestamp:new Date},...xe]),l({title:"Budget issued",message:`${qe.group}: ${Ps(qe.amount)} (${qe.period})`,kind:"success"})},children:[e.jsx(dx,{className:"h-4 w-4"})," Issue"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Group"}),e.jsx("select",{value:qe.group,onChange:xe=>He(Ne=>({...Ne,group:xe.target.value})),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:i.map(xe=>e.jsx("option",{value:xe,children:xe},xe))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Period"}),e.jsx("select",{value:qe.period,onChange:xe=>He(Ne=>({...Ne,period:xe.target.value})),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:"Weekly,Monthly,Quarterly,Annual".split(",").map(xe=>e.jsx("option",{value:xe,children:xe},xe))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Service Module (optional)"}),e.jsxs("select",{value:qe.module,onChange:xe=>{const Ne=xe.target.value;He(M=>({...M,module:Ne,marketplace:Ne==="E-Commerce"?M.marketplace:"All"}))},className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:[e.jsx("option",{value:"All",children:"All"}),n.map(xe=>e.jsx("option",{value:xe,children:xe},xe))]})]}),e.jsxs("div",{className:Hl("",qe.module==="E-Commerce"?"":"opacity-60"),children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Marketplace (optional)"}),e.jsxs("select",{value:qe.marketplace,disabled:qe.module!=="E-Commerce"&&qe.module!=="All",onChange:xe=>He(Ne=>({...Ne,marketplace:xe.target.value})),className:Hl("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none",qe.module==="E-Commerce"||qe.module==="All"?"border-slate-200 bg-white text-slate-900":"border-slate-200 bg-slate-50 text-slate-500"),children:[e.jsx("option",{value:"All",children:"All"}),r.map(xe=>e.jsx("option",{value:xe,children:xe},xe))]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Amount (UGX)"}),e.jsx("input",{type:"number",min:0,onKeyDown:xe=>(xe.key==="-"||xe.key==="e")&&xe.preventDefault(),value:qe.amount,onChange:xe=>{const Ne=Number(xe.target.value||0);Ne>=0&&He(M=>({...M,amount:Ne}))},className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"})]}),e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Hard cap"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Block spend when budget exceeded"})]}),e.jsx("button",{type:"button",className:Hl("relative h-7 w-12 rounded-full border transition",qe.hardCap?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>He(xe=>({...xe,hardCap:!xe.hardCap})),"aria-label":"Toggle hard cap",children:e.jsx("span",{className:Hl("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",qe.hardCap?"left-[22px]":"left-1")})})]})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Premium: high budget increases can require multi-level approvals."})]})}),e.jsx(th,{open:Ve,title:"Create RFQ / Quote request",subtitle:"High-value assets and quotes with approval-aware workflow.",onClose:()=>ne(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Vl,{variant:"outline",onClick:()=>ne(!1),children:"Cancel"}),e.jsxs(Vl,{variant:"primary",onClick:()=>{ne(!1),l({title:"RFQ created",message:`${_e.title}  ${Ps(_e.estValue)}`,kind:"success"}),be(xe=>[{id:`RFQ-${Math.floor(100+Math.random()*900)}`,type:"RFQ",module:_e.module,marketplace:"-",requester:"You",group:qe.group||"Admin",amount:_e.estValue,slaHours:4,ageMinutes:1,status:"Pending",needsAttachment:!_e.attachments},...xe])},children:[e.jsx(wt,{className:"h-4 w-4"})," Create"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Title"}),e.jsx("input",{value:_e.title,onChange:xe=>le(Ne=>({...Ne,title:xe.target.value})),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Service Module"}),e.jsx("select",{value:_e.module,onChange:xe=>le(Ne=>({...Ne,module:xe.target.value})),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:n.map(xe=>e.jsx("option",{value:xe,children:xe},xe))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Needed by"}),e.jsx("input",{type:"date",value:_e.neededBy,onChange:xe=>le(Ne=>({...Ne,neededBy:xe.target.value})),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Estimated value (UGX)"}),e.jsx("input",{type:"number",value:_e.estValue,onChange:xe=>le(Ne=>({...Ne,estValue:Number(xe.target.value||0)})),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"This can be paid via milestones after quote approval."})]}),e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Attachments"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Specs, PDFs, drawings"})]}),e.jsx("input",{type:"file",multiple:!0,className:"w-full rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-sm text-slate-600 file:mr-4 file:rounded-full file:border-0 file:bg-emerald-50 file:px-4 file:py-2 file:text-sm file:font-semibold file:text-emerald-700 hover:file:bg-emerald-100",onChange:xe=>{var Ne;(Ne=xe.target.files)!=null&&Ne.length&&le(M=>({...M,attachments:!0}))}})]})}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Description"}),e.jsx("textarea",{value:_e.description,onChange:xe=>le(Ne=>({...Ne,description:xe.target.value})),rows:5,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 outline-none"})]}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: RFQs can be routed to CFO/CEO approvals and converted to PO with milestone payments."})]})}),e.jsxs(th,{open:Te,title:"Approvals inbox",subtitle:"Unified approvals: rides, purchases, services, and RFQs.",onClose:()=>Ee(!1),footer:e.jsx("div",{className:"flex justify-end",children:e.jsx(Vl,{variant:"outline",onClick:()=>Ee(!1),children:"Close"})}),maxW:"95vw",children:[e.jsxs("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white shadow-md p-4",children:[" ",e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"ID"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Type"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Module"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Marketplace"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"SLA"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Required"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[G.map(xe=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:xe.id}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:xe.type}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:xe.module}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:xe.marketplace}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:xe.group}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Ps(xe.amount)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Tl,{label:`${xe.slaHours}h`,tone:xe.status==="Escalated"?"bad":"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Tl,{label:xe.status,tone:xe.status==="Escalated"?"bad":"warn"})}),e.jsx("td",{className:"px-4 py-3",children:xe.needsAttachment?e.jsx(Tl,{label:"Attachment",tone:"warn"}):e.jsx(Tl,{label:"OK",tone:"good"})}),e.jsxs("td",{className:"px-4 py-3 relative",children:[e.jsx("button",{onClick:Ne=>{Ne.stopPropagation(),Me(Ge===xe.id?null:xe.id)},className:"p-1.5 text-slate-500 hover:bg-slate-100 rounded-full transition-colors",children:e.jsx(xs,{className:"h-4 w-4"})}),e.jsx(lt,{children:Ge===xe.id&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>Me(null)}),e.jsxs(We.div,{initial:{opacity:0,scale:.95,y:-5},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-5},className:"absolute right-8 top-1/2 -translate-y-1/2 z-20 w-32 bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden",children:[e.jsx("button",{className:"w-full text-left px-3 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-50",onClick:()=>{l({title:"Open",message:`Opening ${xe.id}...`,kind:"info"}),Me(null)},children:"Open details"}),e.jsx("button",{className:"w-full text-left px-3 py-2 text-xs font-semibold text-emerald-600 hover:bg-emerald-50",onClick:()=>{be(Ne=>Ne.filter(M=>M.id!==xe.id)),l({title:"Approved",message:`${xe.id} approved.`,kind:"success"}),Me(null)},children:"Approve"}),e.jsx("button",{className:"w-full text-left px-3 py-2 text-xs font-semibold text-rose-600 hover:bg-rose-50",onClick:()=>{be(Ne=>Ne.filter(M=>M.id!==xe.id)),l({title:"Rejected",message:`${xe.id} rejected.`,kind:"warn"}),Me(null)},children:"Reject"})]})]})})]})]},xe.id)),G.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:10,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No approvals in queue."})})]})]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: SLA timers, delegation routing, and load balancing are configured in Approval Workflow Builder (Round 4J)."})]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"A Corporate Dashboard v2: KPIs, account health, issues, heatmaps, quick actions, and premium insights with forecasts by group/module/marketplace."})})]})}const ny={green:"#03CD8C",orange:"#F77F00"};function Wl(...t){return t.filter(Boolean).join(" ")}function u4(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function m4(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function RU(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function Ws({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Wl("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function aa({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:ny.green}:t==="accent"?{background:ny.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Wl(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function DU({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:Wl("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function sm({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="920px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-0 z-50 m-auto flex w-[min(980px,calc(100vw-2rem))] flex-col overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i,maxHeight:"90vh"},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex flex-none items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(DU,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"flex-1 overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"flex-none border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function IU({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Wl("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function DE(t){return t==="Critical"?"bad":t==="Warning"?"warn":"info"}function $U(t){return{pay_fail_gateway:"Payment gateway failures",policy_breach_hours:"Outside working hours policy breaches",vendor_anomaly_shenzhen:"Shenzhen Store anomaly cluster",rfq_sla_breach:"RFQ SLA breaches",budget_near_cap_sales:"Sales nearing budget cap",invoice_overdue:"Overdue invoices"}[t]||t}function LU(t,s){const a={};for(const l of t){const n=s(l);a[n]=a[n]||[],a[n].push(l)}return a}function FU(){const[t,s]=d.useState([]),a=oe=>{const De=u4("toast");s($e=>[{id:De,...oe},...$e].slice(0,4)),window.setTimeout(()=>s($e=>$e.filter(ge=>ge.id!==De)),3200)},l=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],n=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],[r]=d.useState("Acme Group Ltd"),[i,o]=d.useState(""),[c,x]=d.useState("All"),[j,g]=d.useState("All"),[N,$]=d.useState("All"),[T,k]=d.useState("All"),[q,L]=d.useState(!0),R=d.useMemo(()=>N==="All"||N==="E-Commerce",[N]),[U,ae]=d.useState("You"),[ie,_]=d.useState(!1),[W,J]=d.useState(!0),[we,G]=d.useState(()=>{const oe=Date.now();return[{id:"EVT-1001",ts:oe-12*60*1e3,severity:"Critical",kind:"Payment",module:"Finance & Payments",marketplace:"-",title:"Failed payment attempts",body:"2 wallet top-ups failed due to gateway error. Risk of hold if unpaid invoices persist.",assignedTo:null,status:"Open",snoozeUntil:null,rootCauseKey:"pay_fail_gateway",deliveries:[{channel:"Email",status:"Delivered",detail:"Delivered to finance@acme.com"},{channel:"WhatsApp",status:"Failed",detail:"User not opted-in"},{channel:"SMS",status:"Sent",detail:"Sent to +256700..."},{channel:"WeChat",status:"Queued",detail:"Awaiting channel token"}],why:{rule:"Collections: payment failure alert",triggeredBy:"Payment gateway returned error code 502",audience:"Org Admin + Accountant",auditId:"AUD-90021"}},{id:"EVT-1002",ts:oe-2*60*60*1e3,severity:"Warning",kind:"Policy",module:"Rides & Logistics",marketplace:"-",title:"Policy breach: outside working hours",body:"4 rides requested outside allowed time window. Consider tightening policy or enabling approvals.",assignedTo:"You",status:"Open",snoozeUntil:null,rootCauseKey:"policy_breach_hours",deliveries:[{channel:"Email",status:"Delivered",detail:"Delivered to admin@acme.com"},{channel:"WhatsApp",status:"Delivered",detail:"Delivered to WhatsApp group"},{channel:"SMS",status:"Delivered",detail:"Delivered"},{channel:"WeChat",status:"Sent",detail:"Sent"}],why:{rule:"Policy engine: breach alert",triggeredBy:"Requests created outside Mon-Fri 06:00-22:00",audience:"Org Admin + Approver",auditId:"AUD-90042"}},{id:"EVT-1003",ts:oe-4*60*60*1e3,severity:"Warning",kind:"Vendor",module:"E-Commerce",marketplace:"MyLiveDealz",title:"Anomaly: Shenzhen Store spend",body:"Vendor spend is 3.1 typical in the last 24h. Review vendor rule or require approvals.",assignedTo:null,status:"Open",snoozeUntil:null,rootCauseKey:"vendor_anomaly_shenzhen",deliveries:[{channel:"Email",status:"Delivered",detail:"Delivered"},{channel:"WhatsApp",status:"Delivered",detail:"Delivered"},{channel:"WeChat",status:"Delivered",detail:"Delivered"},{channel:"SMS",status:"Delivered",detail:"Delivered"}],why:{rule:"Anomaly detection: vendor spike",triggeredBy:"Spend spike in MyLiveDealz orders",audience:"Org Admin + Accountant",auditId:"AUD-90110"}},{id:"EVT-1004",ts:oe-26*60*60*1e3,severity:"Critical",kind:"Quote",module:"Rides & Logistics",marketplace:"-",title:"RFQ escalation: past SLA",body:"RFQ-390 is escalated and past SLA. High-value asset requires action.",assignedTo:"Approver Desk",status:"Open",snoozeUntil:null,rootCauseKey:"rfq_sla_breach",deliveries:[{channel:"Email",status:"Delivered",detail:"Delivered"},{channel:"WhatsApp",status:"Delivered",detail:"Delivered"},{channel:"SMS",status:"Delivered",detail:"Delivered"},{channel:"WeChat",status:"Delivered",detail:"Delivered"}],why:{rule:"Approvals: SLA breach escalation",triggeredBy:"SLA timer reached 0",audience:"Approver + Org Admin",auditId:"AUD-90200"}},{id:"EVT-1005",ts:oe-3*24*60*60*1e3,severity:"Info",kind:"Budget",module:"Rides & Logistics",marketplace:"-",title:"Budget alert: Sales at 82%",body:"Sales group has reached 82% of monthly cap. Consider adjust or enforce.",assignedTo:"Finance Desk",status:"Open",snoozeUntil:null,rootCauseKey:"budget_near_cap_sales",deliveries:[{channel:"Email",status:"Delivered",detail:"Delivered"},{channel:"WhatsApp",status:"Sent",detail:"Sent"},{channel:"SMS",status:"Delivered",detail:"Delivered"},{channel:"WeChat",status:"Queued",detail:"Queued"}],why:{rule:"Budget monitor: threshold 80%",triggeredBy:"Spend ratio crossed 80%",audience:"Accountant + Manager",auditId:"AUD-90300"}},{id:"EVT-1006",ts:oe-6*24*60*60*1e3,severity:"Warning",kind:"Reminder",module:"Finance & Payments",marketplace:"-",title:"Invoice overdue reminder",body:"1 invoice overdue. Dunning schedule will escalate if unpaid.",assignedTo:null,status:"Open",snoozeUntil:null,rootCauseKey:"invoice_overdue",deliveries:[{channel:"Email",status:"Delivered",detail:"Delivered"},{channel:"WhatsApp",status:"Failed",detail:"Opt-out"},{channel:"SMS",status:"Delivered",detail:"Delivered"},{channel:"WeChat",status:"Sent",detail:"Sent"}],why:{rule:"Collections: overdue reminder",triggeredBy:"Invoice unpaid after due date",audience:"Accountant + Org Admin",auditId:"AUD-90410"}}]}),[be,Ge]=d.useState(()=>[{id:"DG-01",enabled:!0,frequency:"Daily",role:"Accountant",includeSev:["Warning","Critical"],includeKinds:["Payment","Reminder","Budget"],channels:["Email","WhatsApp"],timeOfDay:"08:30"},{id:"DG-02",enabled:!0,frequency:"Daily",role:"Approver",includeSev:["Warning","Critical"],includeKinds:["Approval","Quote"],channels:["Email","SMS"],timeOfDay:"09:00"},{id:"DG-03",enabled:!0,frequency:"Weekly",role:"Org Admin",includeSev:["Info","Warning","Critical"],includeKinds:["Payment","Budget","Policy","Vendor","Quote"],channels:["Email"],timeOfDay:"08:00"}]),[Me,je]=d.useState(()=>[{id:"RR-01",enabled:!0,name:"Finance alerts to Accountants",match:{kinds:["Payment","Reminder","Budget"],severities:["Warning","Critical","Info"],modules:["Finance & Payments"],marketplaces:["-"]},routeToRole:"Accountant"},{id:"RR-02",enabled:!0,name:"Approval reminders to Approvers",match:{kinds:["Approval","Quote"],severities:["Warning","Critical"],modules:["Rides & Logistics","E-Commerce"],marketplaces:["-","MyLiveDealz"]},routeToRole:"Approver"}]),[Ue,Oe]=d.useState(!1),[he,Y]=d.useState(null),[Ie,ce]=d.useState("You"),[me,pe]=d.useState(!1),[de,ye]=d.useState(null),[Qe,Fe]=d.useState(!1),[ke,fe]=d.useState(null),[Ve,ne]=d.useState(!1),[Te,Ee]=d.useState(!1),Re=d.useMemo(()=>{const oe=i.trim().toLowerCase();return we.filter(De=>{if(!q&&De.kind==="Quote"||c!=="All"&&De.severity!==c||j!=="All"&&De.kind!==j||N!=="All"&&De.module!==N)return!1;if(T!=="All"){if(R){if((De.marketplace||"-")!==T)return!1}else if(T!=="-")return!1}return!(ie&&(De.assignedTo||"")!==U||oe&&!`${De.id} ${De.title} ${De.body} ${De.kind} ${De.severity} ${De.module} ${De.marketplace||"-"}`.toLowerCase().includes(oe))})},[we,i,c,j,N,T,q,ie,U,R]),ze=d.useMemo(()=>Re.filter(oe=>oe.status==="Open").length,[Re]),qe=d.useMemo(()=>Re.filter(oe=>oe.status==="Open"&&oe.severity==="Critical").length,[Re]),He=d.useMemo(()=>{const oe=LU(Re,ge=>ge.rootCauseKey),De=Object.keys(oe),$e=ge=>{const ue=v=>v==="Critical"?3:v==="Warning"?2:1,Ke=Math.max(...ge.map(v=>ue(v.severity))),b=Math.max(...ge.map(v=>v.ts));return{maxSev:Ke,latest:b}};return De.sort((ge,ue)=>{const Ke=$e(oe[ge]),b=$e(oe[ue]);return b.maxSev!==Ke.maxSev?b.maxSev-Ke.maxSev:b.latest-Ke.latest}),De.map(ge=>({key:ge,label:$U(ge),items:oe[ge]}))},[Re]),_e=d.useMemo(()=>N==="All"||N==="E-Commerce",[N]),le=(oe,De)=>{const $e=Date.now()+De*60*1e3;G(ge=>ge.map(ue=>ue.id===oe.id?{...ue,status:"Snoozed",snoozeUntil:$e}:ue)),a({title:"Snoozed",message:`${oe.id} snoozed for ${De} minutes.`,kind:"info"})},z=oe=>{G(De=>De.map($e=>$e.id===oe.id?{...$e,status:"Resolved",snoozeUntil:null}:$e)),a({title:"Resolved",message:`${oe.id} resolved.`,kind:"success"})},Pe=(oe,De)=>{G($e=>$e.map(ge=>ge.id===oe.id?{...ge,assignedTo:De}:ge)),a({title:"Assigned",message:`${oe.id} assigned to ${De}.`,kind:"success"})},Be=oe=>{fe(oe),Fe(!0)},xe=()=>{a({title:"Digest preview",message:"Generating digest preview (demo).",kind:"info"})},Ne=()=>{a({title:"Digest sent",message:"Digest sent to configured channels (demo).",kind:"success"})},M=oe=>{Ge(De=>De.map($e=>$e.id===oe?{...$e,enabled:!$e.enabled}:$e))},H=oe=>{je(De=>De.map($e=>$e.id===oe?{...$e,enabled:!$e.enabled}:$e))},Ae=()=>{const oe={id:u4("RR"),enabled:!0,name:"Policy breaches to Approvers",match:{kinds:["Policy"],severities:["Warning","Critical"],modules:["Rides & Logistics"],marketplaces:["-"]},routeToRole:"Approver"};je(De=>[oe,...De]),a({title:"Rule added",message:"Routing rule added from template.",kind:"success"})};return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(IU,{toasts:t,onDismiss:oe=>s(De=>De.filter($e=>$e.id!==oe))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:ny.green},children:e.jsx($o,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Notifications and Activity Center"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Organization: ",r,"  Unified feed across approvals, billing, policies, budgets, vendors, and quotes."]}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(Ws,{label:`${ze} open`,tone:ze?"warn":"good"}),qe?e.jsx(Ws,{label:`${qe} critical`,tone:"bad"}):null,e.jsx(Ws,{label:W?`Clusters: ${He.length}`:`Events: ${Re.length}`,tone:"info"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(aa,{variant:"outline",onClick:()=>ne(!0),children:[e.jsx(Dn,{className:"h-4 w-4"})," Digests"]}),e.jsxs(aa,{variant:"outline",onClick:()=>Ee(!0),children:[e.jsx(p4,{})," Routing rules"]}),e.jsxs(aa,{variant:"outline",onClick:()=>a({title:"Export",message:"Exports are available in Reports and Audit (demo).",kind:"info"}),children:[e.jsx(wt,{className:"h-4 w-4"})," Export"]}),e.jsxs(aa,{variant:"primary",onClick:()=>a({title:"Refresh",message:"Feed refreshed (demo).",kind:"success"}),children:[e.jsx(Ar,{className:"h-4 w-4"})," Refresh"]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-4",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsxs("div",{className:"mt-1 flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-2 py-2",children:[e.jsx(ka,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:i,onChange:oe=>o(oe.target.value),placeholder:"Approvals, payments, policies...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"})]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Severity"}),e.jsxs("select",{value:c,onChange:oe=>x(oe.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-2 py-2 text-sm font-semibold text-slate-900 outline-none",children:[e.jsx("option",{value:"All",children:"All"}),e.jsx("option",{value:"Info",children:"Info"}),e.jsx("option",{value:"Warning",children:"Warning"}),e.jsx("option",{value:"Critical",children:"Critical"})]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Module"}),e.jsxs("select",{value:N,onChange:oe=>{const De=oe.target.value;$(De),De!=="All"&&De!=="E-Commerce"&&k("All")},className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-2 py-2 text-sm font-semibold text-slate-900 outline-none",children:[e.jsx("option",{value:"All",children:"All"}),l.map(oe=>e.jsx("option",{value:oe,children:oe},oe))]})]}),e.jsxs("div",{className:Wl("rounded-2xl border px-3 py-2",_e?"border-slate-200 bg-white":"border-slate-200 bg-slate-50 opacity-70"),children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Marketplace / Quotes"}),e.jsxs("div",{className:"mt-1 grid grid-cols-2 gap-2",children:[e.jsxs("select",{value:T,disabled:!_e,onChange:oe=>k(oe.target.value),className:Wl("w-full rounded-xl border px-2 py-2 text-sm font-semibold outline-none",_e?"border-slate-200 bg-white text-slate-900":"border-slate-200 bg-slate-50 text-slate-500"),children:[e.jsx("option",{value:"All",children:"All"}),e.jsx("option",{value:"-",children:"(No marketplace)"}),n.map(oe=>e.jsx("option",{value:oe,children:oe},oe))]}),e.jsxs("label",{className:Wl("flex items-center justify-between gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold",!q&&"opacity-80"),children:[e.jsx("span",{className:"text-slate-700",children:"Quotes"}),e.jsx("input",{type:"checkbox",checked:q,onChange:oe=>L(oe.target.checked),className:"h-4 w-4 rounded border-slate-300"})]})]}),_e?null:e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Marketplace applies to E-Commerce only."})]})]}),e.jsxs("div",{className:"mt-3 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("label",{className:"flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-700",children:[e.jsx("input",{type:"checkbox",checked:W,onChange:oe=>J(oe.target.checked),className:"h-4 w-4 rounded border-slate-300"}),"Cluster mode",e.jsx(Ws,{label:"Premium",tone:"info"})]}),e.jsxs("label",{className:"flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-700",children:[e.jsx("input",{type:"checkbox",checked:ie,onChange:oe=>_(oe.target.checked),className:"h-4 w-4 rounded border-slate-300"}),"Assigned to me"]}),e.jsxs("div",{className:Wl("rounded-2xl border border-slate-200 bg-white px-3 py-2",!ie&&"opacity-70"),children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Assignee"}),e.jsxs("select",{value:U,disabled:!ie,onChange:oe=>ae(oe.target.value),className:Wl("mt-1 w-full rounded-xl border border-slate-200 bg-white px-2 py-1 text-xs font-semibold text-slate-900 outline-none",!ie&&"bg-slate-50 text-slate-500"),children:[e.jsx("option",{children:"You"}),e.jsx("option",{children:"Finance Desk"}),e.jsx("option",{children:"Approver Desk"}),e.jsx("option",{children:"Org Admin"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(aa,{variant:"outline",onClick:()=>{o(""),x("All"),g("All"),$("All"),k("All"),L(!0),a({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(fn,{className:"h-4 w-4"})," Reset"]}),e.jsxs(aa,{variant:"outline",onClick:()=>a({title:"Bulk",message:"Bulk actions (demo).",kind:"info"}),children:[e.jsx(ht,{className:"h-4 w-4"})," Bulk actions"]})]})]})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[W?e.jsxs("div",{className:"space-y-4",children:[He.map(oe=>e.jsx(UU,{clusterKey:oe.key,label:oe.label,items:oe.items,onOpen:De=>{ye(De),pe(!0)},onAssign:De=>{Y(De),ce(De.assignedTo||"You"),Oe(!0)},onResolve:De=>z(De),onSnooze:(De,$e)=>le(De,$e),onRule:De=>Be(De)},oe.key)),He.length?null:e.jsx(x4,{title:"No events",subtitle:"No notifications match your filters."})]}):e.jsxs("div",{className:"space-y-3",children:[Re.map(oe=>e.jsx(IE,{e:oe,onWhy:()=>{ye(oe),pe(!0)},onAssign:()=>{Y(oe),ce(oe.assignedTo||"You"),Oe(!0)},onResolve:()=>z(oe),onSnooze:De=>le(oe,De),onRule:()=>Be(oe)},oe.id)),Re.length?null:e.jsx(x4,{title:"No events",subtitle:"No notifications match your filters."})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Premium controls"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Digests and routing rules improve signal-to-noise."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(aa,{variant:"outline",onClick:()=>ne(!0),children:[e.jsx(Dn,{className:"h-4 w-4"})," Configure digests"]}),e.jsxs(aa,{variant:"outline",onClick:()=>Ee(!0),children:[e.jsx(p4,{})," Configure routing"]}),e.jsxs(aa,{variant:"primary",onClick:()=>a({title:"Done",message:"Premium controls saved (demo).",kind:"success"}),children:[e.jsx(tt,{className:"h-4 w-4"})," Save"]})]})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsx("div",{className:"font-semibold",children:"Digests"}),e.jsx("div",{className:"mt-1 text-slate-600",children:"Daily/weekly summaries by role. Reduce notification fatigue."})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsx("div",{className:"font-semibold",children:"Routing rules"}),e.jsx("div",{className:"mt-1 text-slate-600",children:"Send finance alerts to Accountants, approval reminders to Approvers."})]})]})]}),e.jsx("div",{className:"mt-4 text-xs text-slate-500",children:"B Notifications v2: unified feed with filters, actions, delivery logs, audit-linked explanations, smart digests, routing rules, and logic-based clustering."})]})]})}),e.jsx(sm,{open:Ue,title:"Assign event",subtitle:"Assign an event to a person or desk (audit logged in production).",onClose:()=>Oe(!1),actions:[{label:"Assign",onClick:()=>{he&&(Pe(he,Ie),Oe(!1))}}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(aa,{variant:"outline",onClick:()=>Oe(!1),children:"Cancel"}),e.jsxs(aa,{variant:"primary",onClick:()=>{he&&(Pe(he,Ie),Oe(!1))},children:[e.jsx(Us,{className:"h-4 w-4"})," Assign"]})]}),children:he?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsx("div",{className:"font-semibold",children:"Event"}),e.jsxs("div",{className:"mt-1 text-slate-600",children:[he.id,"  ",he.title]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Assign to"}),e.jsxs("select",{value:Ie,onChange:oe=>ce(oe.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:[e.jsx("option",{children:"You"}),e.jsx("option",{children:"Finance Desk"}),e.jsx("option",{children:"Approver Desk"}),e.jsx("option",{children:"Org Admin"}),e.jsx("option",{children:"Support Desk"})]})]})]}):null}),e.jsx(sm,{open:me,title:"Why did I get this?",subtitle:"Audit-linked explanation of rules and triggers.",onClose:()=>pe(!1),actions:[{label:"Close",onClick:()=>pe(!1)}],footer:e.jsx("div",{className:"flex justify-end",children:e.jsx(aa,{variant:"outline",onClick:()=>pe(!1),children:"Close"})}),children:de?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Event"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[de.id,"  ",de.kind,"  ",de.severity]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:de.title}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:de.body})]}),e.jsx(Ws,{label:de.status,tone:de.status==="Resolved"?"good":de.status==="Snoozed"?"warn":"info"})]})}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Explanation"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(sh,{label:"Rule",value:de.why.rule}),e.jsx(sh,{label:"Triggered by",value:de.why.triggeredBy}),e.jsx(sh,{label:"Audience",value:de.why.audience}),e.jsx(sh,{label:"Audit ID",value:de.why.auditId})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-white p-3 text-xs text-slate-600",children:"Premium: This links to the immutable audit log record and policy version."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Delivery logs"}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:de.deliveries.map(oe=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:oe.channel}),e.jsx(Ws,{label:oe.status,tone:oe.status==="Failed"?"bad":oe.status==="Queued"?"warn":"good"})]}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:oe.detail})]},oe.channel))})]})]}):null}),e.jsx(sm,{open:Qe,title:"Create rule from this event",subtitle:"Generate a policy/routing rule draft based on the event.",onClose:()=>Fe(!1),actions:[{label:"Create",onClick:()=>{Fe(!1),a({title:"Rule created",message:"Rule draft created (demo).",kind:"success"})}}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(aa,{variant:"outline",onClick:()=>Fe(!1),children:"Cancel"}),e.jsxs(aa,{variant:"primary",onClick:()=>{Fe(!1),a({title:"Rule created",message:"Rule draft created (demo).",kind:"success"})},children:[e.jsx(pt,{className:"h-4 w-4"})," Create"]})]}),children:ke?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsx("div",{className:"font-semibold",children:"Event"}),e.jsxs("div",{className:"mt-1 text-slate-600",children:[ke.id,"  ",ke.title]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Suggested rule"}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"This is a safe draft. Review before saving."}),e.jsx("pre",{className:"mt-3 overflow-auto rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-800",children:JSON.stringify({if:{kind:ke.kind,severity:ke.severity,module:ke.module,marketplace:ke.marketplace||"-",rootCause:ke.rootCauseKey},then:{action:ke.kind==="Vendor"?"Require approvals for vendor":"Route to role",routeTo:ke.kind==="Payment"?"Accountant":"Approver",notify:["Email","WhatsApp"]},notes:"Generated from event. Audit logged."},null,2)})]})]}):null}),e.jsx(sm,{open:Ve,title:"Smart digests",subtitle:"Daily/weekly summaries by role and channel.",onClose:()=>ne(!1),actions:[{label:"Send now",onClick:Ne}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(aa,{variant:"outline",onClick:()=>ne(!1),children:"Close"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(aa,{variant:"outline",onClick:xe,children:[e.jsx(wt,{className:"h-4 w-4"})," Preview"]}),e.jsxs(aa,{variant:"primary",onClick:Ne,children:[e.jsx(Dn,{className:"h-4 w-4"})," Send now"]})]})]}),children:e.jsx("div",{className:"space-y-3",children:be.map(oe=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:[oe.frequency," digest"]}),e.jsx(Ws,{label:`Role: ${oe.role}`,tone:"info"}),e.jsx(Ws,{label:`Time: ${oe.timeOfDay}`,tone:"neutral"}),e.jsx(Ws,{label:oe.enabled?"Enabled":"Off",tone:oe.enabled?"good":"neutral"})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Include: ",oe.includeSev.join(", "),"  ",oe.includeKinds.join(", ")]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Channels: ",oe.channels.join(", ")]})]}),e.jsx("button",{type:"button",className:Wl("relative h-7 w-12 rounded-full transition",oe.enabled?"border-emerald-300 bg-emerald-200":"border-amber-300 bg-white"),onClick:()=>M(oe.id),"aria-label":"Toggle digest",style:{border:oe.enabled?"none":"2px solid #F77F00"},children:e.jsx("span",{className:Wl("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",oe.enabled?"left-[22px]":"left-1 ring-1 ring-slate-200")})})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: digests are generated from clustering and routing rules to reduce noise."})]},oe.id))})}),e.jsx(sm,{open:Te,title:"Routing rules",subtitle:"Send finance alerts to Accountants, approvals to Approvers, etc.",onClose:()=>Ee(!1),actions:[{label:"Save",onClick:()=>a({title:"Saved",message:"Routing rules saved (demo).",kind:"success"})}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(aa,{variant:"outline",onClick:()=>Ee(!1),children:"Close"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(aa,{variant:"outline",onClick:Ae,children:[e.jsx(pt,{className:"h-4 w-4"})," Add template"]}),e.jsxs(aa,{variant:"primary",onClick:()=>a({title:"Saved",message:"Routing rules saved (demo).",kind:"success"}),children:[e.jsx(tt,{className:"h-4 w-4"})," Save"]})]})]}),children:e.jsx("div",{className:"space-y-3",children:Me.map(oe=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:oe.name}),e.jsx(Ws,{label:`Route to ${oe.routeToRole}`,tone:"info"}),e.jsx(Ws,{label:oe.enabled?"Enabled":"Off",tone:oe.enabled?"good":"neutral"})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Kinds: ",oe.match.kinds.join(", ")]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Severities: ",oe.match.severities.join(", ")]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Modules: ",oe.match.modules.join(", ")]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Marketplaces: ",oe.match.marketplaces.join(", ")]})]}),e.jsx("button",{type:"button",className:Wl("relative h-7 w-12 rounded-full border transition",oe.enabled?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>H(oe.id),"aria-label":"Toggle routing rule",style:oe.enabled?void 0:{border:"2px solid #F77F00"},children:e.jsx("span",{className:Wl("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",oe.enabled?"left-[22px]":"left-1 ring-1 ring-slate-200")})})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:'Premium: routing decisions are logged and visible in "Why did I get this?".'})]},oe.id))})}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"B Notifications & Activity Center v2: unified feed, severity/module/marketplace filters, actions (snooze/assign/resolve/create rule), channel delivery logs, audit explanations, smart digests, routing rules, and clustering."})})]})}function x4({title:t,subtitle:s}){return e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx($o,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:s})]})}function IE({e:t,onWhy:s,onAssign:a,onResolve:l,onSnooze:n,onRule:r}){const i=DE(t.severity),o=t.status==="Snoozed";return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Ws,{label:t.severity,tone:i}),e.jsx(Ws,{label:t.kind,tone:"neutral"}),e.jsx(Ws,{label:t.module,tone:"neutral"}),t.marketplace&&t.marketplace!=="-"?e.jsx(Ws,{label:String(t.marketplace),tone:"info"}):e.jsx(Ws,{label:"No marketplace",tone:"neutral"}),e.jsx(Ws,{label:t.status,tone:t.status==="Resolved"?"good":t.status==="Snoozed"?"warn":"info"}),t.assignedTo?e.jsx(Ws,{label:`Assigned: ${t.assignedTo}`,tone:"info"}):e.jsx(Ws,{label:"Unassigned",tone:"warn"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900 truncate",children:t.title}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:t.body}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:[RU(t.ts),"  ",m4(t.ts),"  ",t.id,o&&t.snoozeUntil?e.jsxs("span",{className:"ml-2",children:[" Snoozed until ",m4(t.snoozeUntil)]}):null]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(aa,{variant:"outline",className:"text-xs",onClick:s,children:[e.jsx(Fd,{className:"h-4 w-4"})," Why?"]}),e.jsxs(aa,{variant:"outline",className:"text-xs",onClick:a,children:[e.jsx(Us,{className:"h-4 w-4"})," Assign"]}),e.jsx("div",{className:"relative",children:e.jsx(BU,{onSnooze:n})}),e.jsxs(aa,{variant:"outline",className:"text-xs",onClick:r,children:[e.jsx(ht,{className:"h-4 w-4"})," Create rule"]}),e.jsxs(aa,{variant:"primary",className:"text-xs",onClick:l,children:[e.jsx(tt,{className:"h-4 w-4"})," Resolve"]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(VU,{deliveries:t.deliveries}),e.jsx(_U,{why:t.why})]})]})}function UU({clusterKey:t,label:s,items:a,onOpen:l,onAssign:n,onResolve:r,onSnooze:i,onRule:o}){const c=a.reduce(($,T)=>{const k=q=>q==="Critical"?3:q==="Warning"?2:1;return k(T.severity)>k($)?T.severity:$},"Info"),x=DE(c),[j,g]=d.useState(!0),N=a.filter($=>$.status!=="Resolved");return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white shadow-sm",children:[e.jsxs("button",{type:"button",className:"flex w-full items-start justify-between gap-3 px-4 py-4 text-left",onClick:()=>g($=>!$),children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Ws,{label:s,tone:x}),e.jsx(Ws,{label:`${a.length} events`,tone:"neutral"}),e.jsx(Ws,{label:`${N.length} open`,tone:N.length?"warn":"good"})]}),e.jsxs("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:["Root cause: ",t]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Logic-based clustering groups similar alerts into one stack."})]}),e.jsx(li,{className:Wl("h-5 w-5 text-slate-500 transition",j?"rotate-180":"rotate-0")})]}),e.jsx(lt,{initial:!1,children:j?e.jsx(We.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.18},className:"border-t border-slate-200",children:e.jsx("div",{className:"space-y-3 p-4",children:a.map($=>e.jsx(IE,{e:$,onWhy:()=>l($),onAssign:()=>n($),onResolve:()=>r($),onSnooze:T=>i($,T),onRule:()=>o($)},$.id))})}):null})]})}function VU({deliveries:t}){return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Delivery status"}),e.jsx(Ws,{label:`${t.length} channels`,tone:"neutral"})]}),e.jsx("div",{className:"mt-3 grid grid-cols-2 gap-2",children:t.map(s=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:s.channel}),e.jsx(Ws,{label:s.status,tone:s.status==="Failed"?"bad":s.status==="Queued"?"warn":"good"})]}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:s.detail})]},s.channel))})]})}function _U({why:t}){return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Why did I get this?"}),e.jsx(Ws,{label:t.auditId,tone:"info"})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx(Tv,{label:"Rule",value:t.rule}),e.jsx(Tv,{label:"Triggered by",value:t.triggeredBy}),e.jsx(Tv,{label:"Audience",value:t.audience})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: audit ID links to immutable audit log."})]})}function Tv({label:t,value:s}){return e.jsxs("div",{className:"flex items-start justify-between gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),e.jsx("div",{className:"text-xs font-semibold text-slate-900 text-right",children:s})]})}function sh({label:t,value:s}){return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:s})]})}function BU({onSnooze:t}){const[s,a]=d.useState(!1);return e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",className:"inline-flex items-center justify-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-50",onClick:()=>a(l=>!l),children:[e.jsx(zF,{className:"h-4 w-4"})," Snooze",e.jsx(li,{className:Wl("h-4 w-4 transition",s?"rotate-180":"rotate-0")})]}),e.jsx(lt,{children:s?e.jsx(We.div,{initial:{opacity:0,y:6,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:6,scale:.98},transition:{duration:.16},className:"absolute right-0 z-10 mt-2 w-48 overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-lg",children:[30,60,240,1440].map(l=>e.jsxs("button",{type:"button",className:"flex w-full items-center justify-between px-3 py-2 text-sm font-semibold text-slate-800 hover:bg-slate-50",onClick:()=>{t(l),a(!1)},children:[e.jsx("span",{children:l===1440?"1 day":`${l} min`}),e.jsx(sl,{className:"h-4 w-4 text-slate-500"})]},l))}):null})]})}function p4(){return e.jsx("span",{className:"grid h-4 w-4 place-items-center",children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M16 3h5v5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M4 20l6.5-6.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M14 10l7-7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M16 21h5v-5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M4 4l6.5 6.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M14 14l7 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})})}const wd={green:"#03CD8C",orange:"#F77F00"};function wr(...t){return t.filter(Boolean).join(" ")}function h4(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function Xi(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function g4(t,s,a){return Math.max(s,Math.min(a,t))}function f4(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function ul({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:wr("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function _l({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:wd.green}:t==="accent"?{background:wd.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:wr(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function GU({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:wr("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function qU({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:wr("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function Rv({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="900px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[8vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(qU,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function zU({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r}){return d.useEffect(()=>{const i=o=>o.key==="Escape"&&n();return t&&window.addEventListener("keydown",i),()=>window.removeEventListener("keydown",i)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,x:16},animate:{opacity:1,x:0},exit:{opacity:0,x:16},transition:{duration:.18},className:wr("fixed z-50 overflow-hidden border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]","left-2 right-2 bottom-2 top-[14vh] rounded-[28px]","lg:left-auto lg:right-4 lg:top-4 lg:bottom-4 lg:w-[560px]"),role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-base font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"h-full min-h-0 overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function WU(){const[t,s]=d.useState([]),a=ge=>{const ue=h4("toast");s(Ke=>[{id:ue,...ge},...Ke].slice(0,4)),window.setTimeout(()=>s(Ke=>Ke.filter(b=>b.id!==ue)),3200)},l=["Org Admin","Accountant","Approver","Manager","Travel Coordinator"],n=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],r=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],i=["Users","Groups","Cost centers","Invoices","Trips","Purchases","Vendors","RFQs","Approvals"],[o,c]=d.useState(""),[x,j]=d.useState(()=>new Set(i)),[g,N]=d.useState("Org Admin"),[$,T]=d.useState(!0),[k,q]=d.useState(!1),[L,R]=d.useState(""),[U,ae]=d.useState(0),ie=d.useRef(null),_=d.useRef(null),[W,J]=d.useState(null),[we,G]=d.useState(!1),[be,Ge]=d.useState(""),[Me,je]=d.useState(null),[Ue,Oe]=d.useState(!1),[he,Y]=d.useState(""),[Ie,ce]=d.useState(!1),[me,pe]=d.useState({title:"Company vehicle purchase",module:"Rides & Logistics",marketplace:"All",estValue:285e6,neededBy:"2026-02-01",description:"Need a company vehicle. Include warranty and delivery timeline.",attachments:!0}),[de,ye]=d.useState({group:"Operations",period:"Monthly",amount:5e6,hardCap:!0}),[Qe,Fe]=d.useState({mode:"Soft pause",scope:"CorporatePay only",notifyUsers:!0}),[ke,fe]=d.useState({month:"2026-01",format:"CSV",breakdown:"Group + Module + Marketplace"}),Ve=d.useMemo(()=>{const ge=Date.now();return{users:[{id:"U-1001",name:"Mary N.",email:"mary@acme.com",group:"Operations",role:"Manager"},{id:"U-1002",name:"Finance Desk",email:"finance@acme.com",group:"Finance",role:"Accountant"},{id:"U-1003",name:"John S.",email:"john@acme.com",group:"Sales",role:"User"}],groups:[{id:"G-OPS",name:"Operations",budget:15e6,usedPct:61},{id:"G-SALES",name:"Sales",budget:12e6,usedPct:82},{id:"G-FIN",name:"Finance",budget:6e6,usedPct:68}],costCenters:[{id:"CC-OPS-001",code:"OPS-001",name:"Operations core",group:"Operations"},{id:"CC-SALES-TR",code:"SALES-TRAVEL",name:"Travel",group:"Sales"},{id:"CC-FIN-OPS",code:"FIN-OPS",name:"Finance operations",group:"Finance"}],invoices:[{id:"INV-2026-0017",status:"Overdue",amount:24e5,group:"Admin",due:ge-2*24*60*60*1e3},{id:"INV-2026-0018",status:"Sent",amount:68e5,group:"Operations",due:ge+5*24*60*60*1e3}],trips:[{id:"TR-0442",route:"Office  Airport",rider:"John S.",amount:82e3,time:ge-45*60*1e3},{id:"TR-0443",route:"Office  Client HQ",rider:"Mary N.",amount:41500,time:ge-3*60*60*1e3}],purchases:[{id:"PO-9001",marketplace:"MyLiveDealz",vendor:"Shenzhen Store",amount:24e5,group:"Admin"},{id:"PO-9002",marketplace:"EVmart",vendor:"Kampala Office Mart",amount:12e5,group:"Operations"}],vendors:[{id:"VN-01",name:"Shenzhen Store",status:"Risk",marketplace:"MyLiveDealz"},{id:"VN-02",name:"Kampala Office Mart",status:"Preferred",marketplace:"EVmart"},{id:"VN-03",name:"City Courier",status:"OK",marketplace:"ServiceMart"}],rfqs:[{id:"RFQ-390",title:"Company vehicle",estValue:285e6,status:"Escalated",module:"Rides & Logistics"},{id:"RFQ-402",title:"Bulk EV charging credits",estValue:8e6,status:"Pending",module:"EVs & Charging"}],approvals:[{id:"AP-1821",type:"Purchase",amount:654e4,status:"Pending",module:"E-Commerce"},{id:"AP-1902",type:"Budget override",amount:18e6,status:"Pending",module:"Finance & Payments"}]}},[]),ne=d.useMemo(()=>{const ge=[];return Ve.users.forEach(ue=>ge.push({scope:"Users",id:ue.id,title:ue.name,subtitle:ue.email,meta:`Group: ${ue.group}  Role: ${ue.role}`,tags:[ue.group,ue.role],raw:ue})),Ve.groups.forEach(ue=>ge.push({scope:"Groups",id:ue.id,title:ue.name,subtitle:`Budget: ${Xi(ue.budget)}`,meta:`Used: ${ue.usedPct}%`,tags:["Budget"],raw:ue})),Ve.costCenters.forEach(ue=>ge.push({scope:"Cost centers",id:ue.id,title:`${ue.code} - ${ue.name}`,subtitle:`Group: ${ue.group}`,meta:"Used in exports and chargeback",tags:[ue.group,"Cost center"],raw:ue})),Ve.invoices.forEach(ue=>ge.push({scope:"Invoices",id:ue.id,title:ue.id,subtitle:`Status: ${ue.status}`,meta:`Amount: ${Xi(ue.amount)}  Due: ${f4(ue.due)}`,tags:[ue.status,ue.group],raw:ue})),Ve.trips.forEach(ue=>ge.push({scope:"Trips",id:ue.id,title:ue.route,subtitle:`Rider: ${ue.rider}`,meta:`Amount: ${Xi(ue.amount)}  Time: ${f4(ue.time)}`,tags:["Ride"],raw:ue})),Ve.purchases.forEach(ue=>ge.push({scope:"Purchases",id:ue.id,title:ue.id,subtitle:`Marketplace: ${ue.marketplace}`,meta:`Vendor: ${ue.vendor}  Amount: ${Xi(ue.amount)}  Group: ${ue.group}`,tags:[ue.marketplace,ue.vendor,ue.group],raw:ue})),Ve.vendors.forEach(ue=>ge.push({scope:"Vendors",id:ue.id,title:ue.name,subtitle:`Marketplace: ${ue.marketplace}`,meta:`Status: ${ue.status}`,tags:[ue.status,ue.marketplace],raw:ue})),Ve.rfqs.forEach(ue=>ge.push({scope:"RFQs",id:ue.id,title:ue.title,subtitle:`Status: ${ue.status}`,meta:`Value: ${Xi(ue.estValue)}  Module: ${ue.module}`,tags:[ue.status,ue.module],raw:ue})),Ve.approvals.forEach(ue=>ge.push({scope:"Approvals",id:ue.id,title:ue.id,subtitle:`Type: ${ue.type}`,meta:`Amount: ${Xi(ue.amount)}  Module: ${ue.module}  Status: ${ue.status}`,tags:[ue.status,ue.module],raw:ue})),ge},[Ve]),Te=d.useMemo(()=>{const ge=o.trim().toLowerCase(),ue=Array.from(x),Ke=v=>ue.includes(v.scope)?ge?`${v.scope} ${v.id} ${v.title} ${v.subtitle} ${v.meta} ${(v.tags||[]).join(" ")}`.toLowerCase().includes(ge):!0:!1,b={Users:[],Groups:[],"Cost centers":[],Invoices:[],Trips:[],Purchases:[],Vendors:[],RFQs:[],Approvals:[]};return ne.filter(Ke).forEach(v=>b[v.scope].push(v)),Object.keys(b).forEach(v=>{b[v]=b[v].slice(0,8)}),b},[ne,o,x]),Ee=d.useMemo(()=>Object.values(Te).reduce((ge,ue)=>ge+ue.length,0),[Te]),[Re,ze]=d.useState(()=>[{id:"SS-001",role:"Accountant",name:"Overdue invoices",query:"overdue",scopes:["Invoices","Payments"].filter(Boolean)},{id:"SS-002",role:"Approver",name:"Pending approvals",query:"pending",scopes:["Approvals","RFQs"]},{id:"SS-003",role:"Org Admin",name:"Vendor risk",query:"risk",scopes:["Vendors","Purchases"]}]);d.useEffect(()=>{ze(ge=>ge.map(ue=>({...ue,scopes:ue.scopes.filter(Ke=>i.includes(Ke))})))},[]);const qe=d.useMemo(()=>Re.filter(ge=>ge.role===g),[Re,g]),He=()=>{const ge=o.trim()?`Search: ${o.trim()}`:"My search";Ge(ge),G(!0)},_e=()=>{const ge=be.trim();if(!ge){a({title:"Missing name",message:"Enter a name for the saved search.",kind:"warn"});return}const ue={id:h4("SS"),role:g,name:ge,query:o,scopes:Array.from(x)};ze(Ke=>[ue,...Ke]),G(!1),a({title:"Saved",message:`Saved search for ${g}.`,kind:"success"})},le=ge=>{c(ge.query),j(new Set(ge.scopes)),a({title:"Applied",message:`Applied saved search: ${ge.name}`,kind:"success"})},z=ge=>{ze(ue=>ue.filter(Ke=>Ke.id!==ge)),a({title:"Deleted",message:"Saved search removed.",kind:"info"})},Pe=ge=>{je(ge),Y(""),ce(!1),Oe(!0)},Be=d.useMemo(()=>he.trim().length>=8&&Ie,[he,Ie]),xe=()=>{if(Me){if(!Be){a({title:"Reason required",message:"Add a clear reason and confirm acknowledgement.",kind:"warn"});return}Me==="rfq"&&a({title:"RFQ created",message:`${me.title}  ${Xi(me.estValue)}`,kind:"success"}),Me==="budget"&&a({title:"Budget issued",message:`${de.group}: ${Xi(de.amount)} (${de.period})`,kind:"success"}),Me==="freeze"&&a({title:"CorporatePay frozen",message:`${Qe.mode}  Notifications: ${Qe.notifyUsers?"On":"Off"}`,kind:"warn"}),Me==="export"&&a({title:"Report exported",message:`${ke.month}  ${ke.format}`,kind:"success"}),Oe(!1)}},Ne=async()=>{const ge={action:Me,reason:he,actorRole:g,createdAt:new Date().toISOString(),draft:Me==="rfq"?me:Me==="budget"?de:Me==="freeze"?Qe:ke};try{await navigator.clipboard.writeText(JSON.stringify(ge,null,2)),a({title:"Copied",message:"Audit preview copied.",kind:"success"})}catch{a({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},M=d.useMemo(()=>[{id:"cmd_rfq",label:"Create RFQ",description:"Request a quote for high-value assets",shortcut:"A R",group:"Quick actions",run:()=>Pe("rfq")},{id:"cmd_budget",label:"Issue budget",description:"Allocate budget to a group",shortcut:"A B",group:"Quick actions",run:()=>Pe("budget")},{id:"cmd_freeze",label:"Freeze CorporatePay",description:"Pause CorporatePay at checkout",shortcut:"A F",group:"Quick actions",run:()=>Pe("freeze")},{id:"cmd_export",label:"Export month report",description:"Export spend and approvals report",shortcut:"A E",group:"Quick actions",run:()=>Pe("export")},{id:"nav_dashboard",label:"Go to Corporate Dashboard",description:"Open the dashboard",shortcut:"G D",group:"Navigate",run:()=>a({title:"Navigate",message:"Opening Corporate Dashboard (demo).",kind:"info"})},{id:"nav_approvals",label:"Go to Approvals Inbox",description:"Open approvals queue",shortcut:"G A",group:"Navigate",run:()=>a({title:"Navigate",message:"Opening Approvals Inbox (demo).",kind:"info"})},{id:"tool_save",label:"Save this search",description:"Save current query and scopes",shortcut:"S",group:"Tools",run:()=>He()}],[g,Me,he,me,de,Qe,ke,o,x]),H=d.useMemo(()=>{const ge=L.trim().toLowerCase(),ue=ge?M.filter(b=>`${b.label} ${b.description} ${b.group} ${b.shortcut}`.toLowerCase().includes(ge)):M,Ke=b=>b==="Quick actions"?0:b==="Navigate"?1:2;return[...ue].sort((b,v)=>{const u=Ke(b.group),C=Ke(v.group);return u!==C?u-C:b.label.localeCompare(v.label)})},[M,L]);d.useEffect(()=>{const ge=ue=>{var v;if((navigator.platform.toLowerCase().includes("mac")?ue.metaKey:ue.ctrlKey)&&ue.key.toLowerCase()==="k"&&(ue.preventDefault(),q(!0),R(""),ae(0),window.setTimeout(()=>{var u;return(u=ie.current)==null?void 0:u.focus()},50)),!k&&ue.key==="/"&&(ue.preventDefault(),(v=_.current)==null||v.focus()),k&&(ue.key==="ArrowDown"&&(ue.preventDefault(),ae(u=>g4(u+1,0,Math.max(0,H.length-1)))),ue.key==="ArrowUp"&&(ue.preventDefault(),ae(u=>g4(u-1,0,Math.max(0,H.length-1)))),ue.key==="Enter")){ue.preventDefault();const u=H[U];u&&(q(!1),u.run())}};return window.addEventListener("keydown",ge),()=>window.removeEventListener("keydown",ge)},[k,H,U]);const Ae=ge=>{j(ue=>{const Ke=new Set(ue);return Ke.has(ge)?Ke.delete(ge):Ke.add(ge),Ke})},oe=()=>{j(new Set(i)),a({title:"Scopes reset",message:"Searching across all entities.",kind:"info"})},De=d.useMemo(()=>i.filter(ue=>Te[ue].length>0).map(ue=>({scope:ue,items:Te[ue]})),[Te]),$e=ge=>{switch(ge){case"Users":return e.jsx(Us,{className:"h-4 w-4"});case"Groups":return e.jsx(wa,{className:"h-4 w-4"});case"Cost centers":return e.jsx(gw,{className:"h-4 w-4"});case"Invoices":return e.jsx(wt,{className:"h-4 w-4"});case"Trips":return e.jsx(Hx,{className:"h-4 w-4"});case"Purchases":return e.jsx(fw,{className:"h-4 w-4"});case"Vendors":return e.jsx(jw,{className:"h-4 w-4"});case"RFQs":return e.jsx(ni,{className:"h-4 w-4"});case"Approvals":return e.jsx(ct,{className:"h-4 w-4"});default:return e.jsx(ka,{className:"h-4 w-4"})}};return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(GU,{toasts:t,onDismiss:ge=>s(ue=>ue.filter(Ke=>Ke.id!==ge))}),e.jsx(Rv,{open:k,title:"Command Center",subtitle:"Type to search commands. Use arrow keys and Enter.",onClose:()=>q(!1),footer:e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Tip: use Ctrl+K (or Cmd+K) to open. Use / to focus search."}),e.jsx(_l,{variant:"outline",onClick:()=>q(!1),children:"Close"})]}),maxW:"760px",children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2 shadow-sm focus-within:ring-4 focus-within:ring-emerald-100",children:[e.jsx(Gp,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{ref:ie,value:L,onChange:ge=>{R(ge.target.value),ae(0)},placeholder:"Search commands or pages...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"})]}),e.jsx("div",{className:"mt-4 overflow-hidden rounded-2xl border border-slate-200 bg-white",children:e.jsx("div",{className:"max-h-[420px] overflow-auto",children:H.length?e.jsx("div",{className:"divide-y divide-slate-100",children:H.map((ge,ue)=>e.jsxs("button",{type:"button",onClick:()=>{q(!1),ge.run()},className:wr("flex w-full items-start justify-between gap-3 px-4 py-3 text-left",ue===U?"bg-emerald-50":"hover:bg-slate-50"),children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:ge.label}),e.jsx(ul,{label:ge.group,tone:ge.group==="Quick actions"?"info":"neutral"})]}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:ge.description})]}),e.jsx("div",{className:"shrink-0 rounded-xl border border-slate-200 bg-white px-2 py-1 text-xs font-semibold text-slate-700",children:ge.shortcut})]},ge.id))}):e.jsx("div",{className:"p-6 text-sm text-slate-600",children:"No commands found."})})})]})}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsx("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:wd.green},children:e.jsx(Gp,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Global Search and Command Center"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Search users, invoices, vendors, RFQs, approvals and more. Run audited admin actions."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(ul,{label:`Role: ${g}`,tone:"info"}),e.jsx(ul,{label:`Hits: ${Ee}`,tone:Ee?"good":"neutral"}),e.jsx(ul,{label:$?"Operator mode: On":"Operator mode: Off",tone:$?"warn":"neutral"}),e.jsx(ul,{label:"Ctrl+K",tone:"neutral"}),e.jsx(ul,{label:"/",tone:"neutral"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Role"}),e.jsx("select",{value:g,onChange:ge=>N(ge.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-2 py-1 text-xs font-semibold text-slate-900 outline-none",children:l.map(ge=>e.jsx("option",{value:ge,children:ge},ge))})]}),e.jsxs("button",{type:"button",className:wr("rounded-2xl border px-3 py-2 text-sm font-semibold",$?"border-amber-200 bg-amber-50 text-amber-900":"border-slate-200 bg-white text-slate-700 hover:bg-slate-50"),onClick:()=>{T(ge=>!ge),a({title:"Operator mode",message:$?"Disabled":"Enabled",kind:"info"})},children:[e.jsx(ht,{className:"h-4 w-4"})," Operator mode"]}),e.jsxs(_l,{variant:"outline",onClick:()=>{q(!0),R(""),ae(0),window.setTimeout(()=>{var ge;return(ge=ie.current)==null?void 0:ge.focus()},50)},children:[e.jsx(Gp,{className:"h-4 w-4"})," Open commands"]}),e.jsxs(_l,{variant:"primary",onClick:He,children:[e.jsx(yv,{className:"h-4 w-4"})," Save search"]})]})]})}),e.jsx("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Saved searches"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: saved searches per role."})]}),e.jsx(ul,{label:`${qe.length}`,tone:"neutral"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:qe.length?qe.map(ge=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("button",{type:"button",className:"min-w-0 text-left",onClick:()=>le(ge),children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:ge.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Query:"," ",ge.query||"(none)"]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[ge.scopes.slice(0,4).map(ue=>e.jsx(ul,{label:ue,tone:"neutral"},ue)),ge.scopes.length>4?e.jsx(ul,{label:`+${ge.scopes.length-4}`,tone:"neutral"}):null]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(_l,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>le(ge),children:"Apply"}),e.jsx(_l,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>z(ge.id),children:e.jsx(as,{className:"h-4 w-4"})})]})]})},ge.id)):e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-6 text-center",children:[e.jsx("div",{className:"mx-auto grid h-10 w-10 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(yv,{className:"h-5 w-5"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No saved searches"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Save your first search for this role."})]})})]})}),e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Search"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Users, groups, cost centers, invoices, trips, purchases, vendors, RFQs, approvals."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(_l,{variant:"outline",onClick:oe,children:[e.jsx(fn,{className:"h-4 w-4"})," ","Scopes: All"]}),e.jsxs(_l,{variant:"outline",onClick:()=>{c(""),a({title:"Cleared",message:"Search cleared.",kind:"info"})},children:[e.jsx(Ye,{className:"h-4 w-4"})," Clear"]}),e.jsxs(_l,{variant:"primary",onClick:()=>{q(!0),R(""),ae(0),window.setTimeout(()=>{var ge;return(ge=ie.current)==null?void 0:ge.focus()},50)},children:[e.jsx(Gp,{className:"h-4 w-4"})," ","Commands"]})]})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2 shadow-sm focus-within:ring-4 focus-within:ring-emerald-100",children:[e.jsx(ka,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{ref:_,value:o,onChange:ge=>c(ge.target.value),placeholder:"Search across the whole corporate account...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"}),e.jsx("span",{className:"rounded-xl border border-slate-200 bg-slate-50 px-2 py-1 text-xs font-semibold text-slate-700",children:"/"})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:i.map(ge=>{const ue=x.has(ge);return e.jsxs("button",{type:"button",onClick:()=>Ae(ge),className:wr("flex items-center gap-2 rounded-full px-3 py-2 text-xs font-semibold ring-1 transition",ue?"bg-emerald-600 text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:ue?{background:wd.green}:void 0,children:[e.jsx("span",{className:wr("text-white",!ue&&"text-slate-600"),children:$e(ge)}),ge]},ge)})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: use saved searches per role for common workflows. Use command center for actions."})]}),e.jsx("div",{className:"space-y-4",children:De.length?De.map(ge=>e.jsx(HU,{scope:ge.scope,items:ge.items,onOpen:ue=>J(ue)},ge.scope)):e.jsx(XU,{title:"No results",subtitle:"Try a different query or enable more scopes."})}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Premium: audit-friendly actions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Every destructive action requires a reason and produces an audit preview."})]}),e.jsx(ul,{label:"Always on",tone:"good"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx(Dv,{title:"Reason",value:"Why are you performing this action?"}),e.jsx(Dv,{title:"Scope",value:"Which org, group, or module is affected?"}),e.jsx(Dv,{title:"Audit",value:"Audit ID is created and visible to Admins."})]})]}),e.jsx("div",{className:"text-xs text-slate-500",children:"C Global Search v2: unified search across all entities, premium saved searches per role, operator shortcuts, and audited quick actions."})]})]})})]})}),e.jsx(zU,{open:!!W,title:W?`${W.scope}: ${W.title}`:"",subtitle:W?`${W.id}  ${W.subtitle}`:"",onClose:()=>J(null),footer:W?e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Tags:"," ",(W.tags||[]).slice(0,4).join(", ")||"-"]}),e.jsxs(_l,{variant:"primary",onClick:()=>a({title:"Open",message:`Opening ${W.id} (demo).`,kind:"info"}),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]})]}):null,children:W?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Summary"}),e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:W.meta}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(ul,{label:W.scope,tone:"info"}),e.jsx(ul,{label:W.id,tone:"neutral"})]})]}),e.jsxs(_l,{variant:"outline",onClick:()=>a({title:"Copy",message:"Copied ID (demo).",kind:"success"}),children:[e.jsx(ls,{className:"h-4 w-4"})," Copy ID"]})]})}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Raw data"}),e.jsx("pre",{className:"mt-3 max-h-[360px] overflow-auto rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-800",children:JSON.stringify(W.raw,null,2)}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"In production, this panel respects role permissions and redacts sensitive fields."})]})]}):null}),e.jsx(Rv,{open:we,title:"Save search",subtitle:"Premium: saved searches per role",onClose:()=>G(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(_l,{variant:"outline",onClick:()=>G(!1),children:"Cancel"}),e.jsxs(_l,{variant:"primary",onClick:_e,children:[e.jsx(yv,{className:"h-4 w-4"})," Save"]})]}),maxW:"780px",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Name"}),e.jsx("input",{value:be,onChange:ge=>Ge(ge.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Saved under role: ",g]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Preview"}),e.jsxs("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:["Query: ",o||"(none)"]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[Array.from(x).slice(0,6).map(ge=>e.jsx(ul,{label:ge,tone:"neutral"},ge)),x.size>6?e.jsx(ul,{label:`+${x.size-6}`,tone:"neutral"}):null]})]})]})}),e.jsx(Rv,{open:Ue,title:Me==="rfq"?"Create RFQ":Me==="budget"?"Issue budget":Me==="freeze"?"Freeze CorporatePay":Me==="export"?"Export month report":"Action",subtitle:"Audit-friendly confirmation and reason prompt",onClose:()=>Oe(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(_l,{variant:"outline",onClick:()=>Oe(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(_l,{variant:"outline",onClick:Ne,children:[e.jsx(ls,{className:"h-4 w-4"})," Copy audit preview"]}),e.jsxs(_l,{variant:Me==="freeze"?"danger":"primary",onClick:xe,disabled:!Be,children:[e.jsx(tt,{className:"h-4 w-4"})," Confirm"]})]})]}),maxW:"980px",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[Me==="rfq"?e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"RFQ details"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Iv,{label:"Title",value:me.title,onChange:ge=>pe(ue=>({...ue,title:ge})),placeholder:"RFQ title"}),e.jsx(Ki,{label:"Service Module",value:me.module,onChange:ge=>pe(ue=>({...ue,module:ge})),options:[...n]}),e.jsx(Ki,{label:"Marketplace",value:me.marketplace,onChange:ge=>pe(ue=>({...ue,marketplace:ge})),options:["All",...r]}),e.jsx(Iv,{label:"Needed by",value:me.neededBy,onChange:ge=>pe(ue=>({...ue,neededBy:ge})),placeholder:"YYYY-MM-DD"}),e.jsx(v4,{label:"Estimated value (UGX)",value:me.estValue,onChange:ge=>pe(ue=>({...ue,estValue:ge}))}),e.jsx($v,{label:"Attachments",value:me.attachments,onChange:ge=>pe(ue=>({...ue,attachments:ge}))}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Description"}),e.jsx("textarea",{value:me.description,onChange:ge=>pe(ue=>({...ue,description:ge.target.value})),rows:4,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 outline-none"})]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"RFQs are routed to approvals and can use milestone payments after quote approval."})]}):null,Me==="budget"?e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Budget details"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Ki,{label:"Group",value:de.group,onChange:ge=>ye(ue=>({...ue,group:ge})),options:["Operations","Sales","Finance","Admin","Procurement"]}),e.jsx(Ki,{label:"Period",value:de.period,onChange:ge=>ye(ue=>({...ue,period:ge})),options:["Weekly","Monthly","Quarterly","Annual"]}),e.jsx(v4,{label:"Amount (UGX)",value:de.amount,onChange:ge=>ye(ue=>({...ue,amount:ge}))}),e.jsx($v,{label:"Hard cap",value:de.hardCap,onChange:ge=>ye(ue=>({...ue,hardCap:ge}))})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: large budget changes can require approvals."})]}):null,Me==="freeze"?e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Freeze details"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Ki,{label:"Mode",value:Qe.mode,onChange:ge=>Fe(ue=>({...ue,mode:ge})),options:["Soft pause","Full stop"]}),e.jsx(Ki,{label:"Scope",value:Qe.scope,onChange:ge=>Fe(ue=>({...ue,scope:ge})),options:["CorporatePay only","All services and purchases"]}),e.jsx($v,{label:"Notify users",value:Qe.notifyUsers,onChange:ge=>Fe(ue=>({...ue,notifyUsers:ge}))})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-rose-50 p-3 text-xs text-rose-800 ring-1 ring-rose-200",children:"Freeze is a sensitive action. Consider dual approval for full stop."})]}):null,Me==="export"?e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Export details"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Iv,{label:"Month",value:ke.month,onChange:ge=>fe(ue=>({...ue,month:ge})),placeholder:"YYYY-MM"}),e.jsx(Ki,{label:"Format",value:ke.format,onChange:ge=>fe(ue=>({...ue,format:ge})),options:["CSV","PDF","JSON"]}),e.jsx(Ki,{label:"Breakdown",value:ke.breakdown,onChange:ge=>fe(ue=>({...ue,breakdown:ge})),options:["Group + Module + Marketplace","Group only","Vendor only","Approvals only"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: scheduled exports can be configured in Integrations."})]}):null,e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Reason and acknowledgement"}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Reason is required for audit logs. Keep it specific."}),e.jsx("textarea",{value:he,onChange:ge=>Y(ge.target.value),placeholder:"Example: RFQ needed for vehicle procurement; monthly budget not sufficient; CFO approval requested",rows:4,className:"mt-3 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"}),e.jsxs("label",{className:"mt-3 flex items-start gap-3 rounded-2xl border border-slate-200 bg-slate-50 p-3",children:[e.jsx("input",{type:"checkbox",checked:Ie,onChange:ge=>ce(ge.target.checked),className:"mt-1 h-4 w-4 rounded border-slate-300"}),e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"I confirm this action is authorized and will be audit logged."})]}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Minimum reason length: 8 characters."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Audit preview"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"This is the record that would be stored."})]}),e.jsx(ul,{label:"Preview",tone:"info"})]}),e.jsx("pre",{className:"mt-3 max-h-[360px] overflow-auto rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-800",children:JSON.stringify({action:Me,actorRole:g,at:new Date().toISOString(),reason:he,draft:Me==="rfq"?me:Me==="budget"?de:Me==="freeze"?Qe:ke},null,2)}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: map this to immutable audit log IDs and include policy version."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Safety tips"}),e.jsxs("ul",{className:"mt-3 space-y-2 text-sm text-slate-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:wd.green}})," ","Use group-level budgets before user caps."]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:wd.orange}})," ","For freezing, notify users to avoid disruptions."]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:wd.green}})," ","For RFQs, attach specs and required documents."]})]})]})]})]})}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"C Global Search & Command Center v2: unified search + premium saved searches per role + operator shortcuts + audited quick actions."})})]})}function HU({scope:t,items:s,onOpen:a}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-600",children:l(t)}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Top matches"})]})]}),e.jsx(ul,{label:`${s.length}`,tone:"neutral"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:s.map(n=>e.jsxs("button",{type:"button",onClick:()=>a(n),className:"w-full rounded-2xl border border-slate-200 bg-white p-3 text-left hover:bg-slate-50",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:n.title}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:n.subtitle}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:n.meta})]}),e.jsx(et,{className:"mt-1 h-5 w-5 text-slate-400"})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[(n.tags||[]).slice(0,4).map(r=>e.jsx(ul,{label:r,tone:"neutral"},r)),(n.tags||[]).length>4?e.jsx(ul,{label:`+${(n.tags||[]).length-4}`,tone:"neutral"}):null]})]},n.id))})]});function l(n){switch(n){case"Users":return e.jsx(Us,{className:"h-4 w-4"});case"Groups":return e.jsx(wa,{className:"h-4 w-4"});case"Cost centers":return e.jsx(gw,{className:"h-4 w-4"});case"Invoices":return e.jsx(wt,{className:"h-4 w-4"});case"Trips":return e.jsx(Hx,{className:"h-4 w-4"});case"Purchases":return e.jsx(fw,{className:"h-4 w-4"});case"Vendors":return e.jsx(jw,{className:"h-4 w-4"});case"RFQs":return e.jsx(ni,{className:"h-4 w-4"});case"Approvals":return e.jsx(ct,{className:"h-4 w-4"});default:return e.jsx(ka,{className:"h-4 w-4"})}}}function Dv({title:t,value:s}){return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:s})]})}function XU({title:t,subtitle:s}){return e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-10 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(ka,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:s})]})}function Iv({label:t,value:s,onChange:a,placeholder:l}){return e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),e.jsx("input",{value:s,onChange:n=>a(n.target.value),placeholder:l,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"})]})}function v4({label:t,value:s,onChange:a}){return e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),e.jsx("input",{type:"number",value:s,onChange:l=>a(Number(l.target.value||0)),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"})]})}function Ki({label:t,value:s,onChange:a,options:l}){return e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),e.jsx("select",{value:s,onChange:n=>a(n.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:l.map(n=>e.jsx("option",{value:n,children:n},n))})]})}function $v({label:t,value:s,onChange:a}){return e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:s?"On":"Off"})]}),e.jsx("button",{type:"button",className:wr("relative h-7 w-12 rounded-full border transition",s?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>a(!s),"aria-label":t,children:e.jsx("span",{className:wr("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",s?"left-[22px]":"left-1")})})]})})}const Kx={green:"#03CD8C",orange:"#F77F00"};function on(...t){return t.filter(Boolean).join(" ")}function Or(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function KU(t,s,a){return Math.max(s,Math.min(a,t))}function el({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:on("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Yt({variant:t="outline",children:s,onClick:a,className:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:Kx.green}:t==="accent"?{background:Kx.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:a,style:c,className:on(i,o[t],n&&"cursor-not-allowed opacity-60",l),children:s})}function QU({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:on("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:on("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function ys({label:t,value:s,onChange:a,placeholder:l,hint:n,required:r,type:i="text",disabled:o}){const c=!!r&&!s.trim();return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"text-xs font-semibold text-slate-600",children:[t,r?e.jsx("span",{className:"text-rose-600",children:" *"}):null]}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:i,value:s,onChange:x=>a(x.target.value),placeholder:l,disabled:o,className:on("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold shadow-sm outline-none focus:ring-4",o?"border-slate-200 bg-slate-50 text-slate-500":c?"border-rose-300 bg-white text-slate-900 focus:ring-rose-100":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")}),c?e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:"Required"}):null]})}function ah({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:i=>a(i.target.value),placeholder:l,rows:r,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"})]})}function am({label:t,value:s,onChange:a,options:l,hint:n}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:r=>a(r.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",children:l.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]})}function YU({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:on("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function lm({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="920px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[8vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(YU,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function JU({value:t}){const s=KU(t,0,100),a=76,l=10,n=(a-l)/2,r=2*Math.PI*n,i=s/100*r;return e.jsxs("div",{className:"relative grid place-items-center",children:[e.jsxs("svg",{width:a,height:a,className:"-rotate-90",children:[e.jsx("circle",{cx:a/2,cy:a/2,r:n,stroke:"#E2E8F0",strokeWidth:l,fill:"none"}),e.jsx("circle",{cx:a/2,cy:a/2,r:n,stroke:Kx.green,strokeWidth:l,fill:"none",strokeDasharray:`${i} ${r}`,strokeLinecap:"round"})]}),e.jsxs("div",{className:"absolute text-sm font-semibold text-slate-900",children:[Math.round(s),"%"]})]})}function ZU({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:on("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(vn,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function _n({title:t,subtitle:s,children:a,right:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),l]}),e.jsx("div",{className:"mt-4",children:a})]})}function Lv({title:t,subtitle:s}){return e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(wa,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:s})]})}function jn({ok:t,label:s}){return e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:s}),t?e.jsx(el,{label:"Done",tone:"good"}):e.jsx(el,{label:"Pending",tone:"warn"})]})}function eV({label:t,onRemove:s}){return e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-slate-50 px-3 py-2 text-xs font-semibold text-slate-700 ring-1 ring-slate-200",children:[t,s?e.jsx("button",{type:"button",className:"rounded-full p-1 hover:bg-slate-200",onClick:s,"aria-label":`Remove ${t}`,children:e.jsx(Ye,{className:"h-3.5 w-3.5"})}):null]})}function lh(t){const s={};return t.forEach(a=>s[a]=!0),s}function nh(t){const s={};return t.forEach(a=>s[a]=a!=="Other Marketplace"),s}function tV(){const t=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],s=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],[a,l]=d.useState([]),n=D=>{const m=Or("toast");l(A=>[{id:m,...D},...A].slice(0,4)),window.setTimeout(()=>l(A=>A.filter(f=>f.id!==m)),3200)},[r,i]=d.useState("profile"),o=[{id:"profile",label:"Company profile",subtitle:"Identity and basics"},{id:"entities",label:"Entities and branches",subtitle:"Multi-country setup"},{id:"billing",label:"Billing contacts",subtitle:"AP and finance distribution"},{id:"branding",label:"Branding and invoice",subtitle:"Logo and invoice text"},{id:"modules",label:"Modules and defaults",subtitle:"Enable modules and policy defaults"},{id:"invoiceGroups",label:"Invoice groups",subtitle:"AP codes and routing"},{id:"support",label:"EVzone support",subtitle:"Support mode toggle"},{id:"goLive",label:"Go-live",subtitle:"Readiness and publish"}],[c,x]=d.useState({displayName:"Acme Group Ltd",legalName:"Acme Group Limited",registrationNo:"80020012345678",website:"",industry:"Corporate",baseCurrency:"UGX"}),[j,g]=d.useState([{id:Or("ENT"),name:"Uganda HQ",country:"Uganda",city:"Kampala",address1:"Plot 12, Nkrumah Road",address2:"Suite 5",postal:"P.O. Box 12345",currency:"UGX",taxId:"TIN-123-456-789",vatNo:"VAT-UG-00991",isPrimary:!0},{id:Or("ENT"),name:"China Branch",country:"China",city:"Wuxi",address1:"Room 265, No. 3 Gaolang East Road",address2:"Xinwu District",postal:"214000",currency:"CNY",taxId:"CN-TAX-0001",vatNo:"CN-VAT-0001",isPrimary:!1}]),[N,$]=d.useState([{id:Or("BC"),name:"Finance Desk",role:"Finance",email:"finance@acme.com",phone:"+256 700 000 000",channels:{email:!0,whatsapp:!0,wechat:!1,sms:!0}},{id:Or("BC"),name:"Accounts Payable",role:"AP",email:"ap@acme.com",phone:"+256 701 000 000",channels:{email:!0,whatsapp:!1,wechat:!1,sms:!0}}]),T=d.useRef(null),[k,q]=d.useState(""),[L,R]=d.useState("Thank you for partnering with Acme Group Ltd."),[U,ae]=d.useState("Net 7"),[ie,_]=d.useState("Pay via bank transfer to Acme Group Ltd. Bank: Example Bank, Account: 0123456789."),[W,J]=d.useState(()=>{const D={};return t.forEach(m=>D[m]=m!=="Other Service Module"),D}),[we,G]=d.useState({allowedRegions:["Kampala","Entebbe","Wakiso"],workStart:"06:00",workEnd:"22:00",days:["Mon","Tue","Wed","Thu","Fri"],defaultTripCap:"UGX 250,000",defaultDailyCap:"UGX 1,200,000",defaultMonthlyCap:"UGX 12,000,000",autoApproveUnder:"UGX 200,000"}),[be,Ge]=d.useState(""),[Me,je]=d.useState(()=>{const D="All";return[{id:Or("IG"),name:"Main corporate",entityScope:D,apEmail:"ap@acme.com",apCode:"ACME-MAIN",ccEmails:"finance@acme.com",frequency:"Weekly",prefix:"ACME",moduleScope:lh(t),marketplaceScope:nh(s),notes:"Consolidated invoice for all enabled modules."},{id:Or("IG"),name:"Sales travel",entityScope:D,apEmail:"sales-ap@acme.com",apCode:"ACME-SALES",ccEmails:"sales@acme.com, finance@acme.com",frequency:"Monthly",prefix:"ACME-SALES",moduleScope:{...lh(t),"E-Commerce":!1,"EVs & Charging":!1,"School & E-Learning":!1,"Medical & Health Care":!1,"Travel & Tourism":!1,"Green Investments":!1,FaithHub:!1,"Virtual Workspace":!1,"Finance & Payments":!1,"Other Service Module":!1},marketplaceScope:nh(s),notes:"Rides only, charged to Sales travel cost center."}]}),[Ue,Oe]=d.useState(!0),[he,Y]=d.useState(null),[Ie,ce]=d.useState(""),[me,pe]=d.useState(!1),[de,ye]=d.useState(null),Qe=d.useMemo(()=>[{id:"corporate",name:"Corporate",desc:"General corporate spend: rides, e-commerce, services, approvals.",apply:()=>{x(D=>({...D,industry:"Corporate"})),J(D=>({...D,"Rides & Logistics":!0,"E-Commerce":!0,"Finance & Payments":!0,"EVs & Charging":!0,"Medical & Health Care":!1,"Travel & Tourism":!0,"Green Investments":!1,FaithHub:!1,"Virtual Workspace":!0})),G(D=>({...D,allowedRegions:["Kampala","Entebbe"],workStart:"06:00",workEnd:"22:00",days:["Mon","Tue","Wed","Thu","Fri"],autoApproveUnder:"UGX 200,000"}))}},{id:"hospital",name:"Hospital",desc:"Medical operations: stronger controls, 24/7 exceptions, higher audit sensitivity.",apply:()=>{x(D=>({...D,industry:"Hospital"})),J(D=>({...D,"Medical & Health Care":!0,"Rides & Logistics":!0,"E-Commerce":!0,"Finance & Payments":!0,"EVs & Charging":!1,"Travel & Tourism":!1,"Virtual Workspace":!0})),G(D=>({...D,allowedRegions:["Kampala","Entebbe"],workStart:"00:00",workEnd:"23:59",days:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],autoApproveUnder:"UGX 100,000"}))}},{id:"tour",name:"Tour Company",desc:"Travel heavy: airports and geo controls, stronger vendor rules, higher ride usage.",apply:()=>{x(D=>({...D,industry:"Tour Company"})),J(D=>({...D,"Travel & Tourism":!0,"Rides & Logistics":!0,"E-Commerce":!0,"Finance & Payments":!0,"EVs & Charging":!1,"Medical & Health Care":!1,"Virtual Workspace":!0})),G(D=>({...D,allowedRegions:["Kampala","Entebbe","Jinja"],workStart:"05:00",workEnd:"23:00",days:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],autoApproveUnder:"UGX 250,000"}))}}],[x,J,G]),[Fe,ke]=d.useState(!1),[fe,Ve]=d.useState({id:"",name:"",country:"",city:"",address1:"",address2:"",postal:"",currency:"UGX",taxId:"",vatNo:"",isPrimary:!1}),[ne,Te]=d.useState(!1),[Ee,Re]=d.useState({id:"",name:"",role:"Finance",email:"",phone:"",channels:{email:!0,whatsapp:!1,wechat:!1,sms:!0}}),[ze,qe]=d.useState(!1),[He,_e]=d.useState({id:"",name:"",entityScope:"All",apEmail:"",apCode:"",ccEmails:"",frequency:"Weekly",prefix:"",moduleScope:lh(t),marketplaceScope:nh(s),notes:""}),le=d.useMemo(()=>{const D=!!c.displayName.trim()&&!!c.legalName.trim(),m=j.length>0&&j.some(ve=>ve.isPrimary),A=N.length>0,f=!!L.trim()&&!!U.trim()&&!!ie.trim(),B=Object.values(W).some(Boolean),p=we.allowedRegions.length>0&&!!we.workStart&&!!we.workEnd,E=Me.length>0,se=typeof Ue=="boolean",y=[D,m,A,f,B,p,E,se];return{pct:y.filter(Boolean).length/y.length*100,profileOk:D,entityOk:m,billingOk:A,brandingOk:f,moduleOk:B,policyOk:p,invoiceOk:E,supportOk:se}},[c,j,N,L,U,ie,W,we,Me,Ue]),z=le.pct===100,Pe=()=>{const D={org:c,entities:j,billingContacts:N,branding:{logoUrl:!!k,invoiceFooter:L,paymentTerms:U,paymentInstructions:ie},modulesEnabled:W,policy:we,invoiceGroups:Me,supportEnabled:Ue,exportedAt:new Date().toISOString()},m=JSON.stringify(D,null,2),A=new Blob([m],{type:"application/json"}),f=URL.createObjectURL(A),B=document.createElement("a");B.href=f,B.download="corporatepay-org-setup.json",B.click(),URL.revokeObjectURL(f),n({title:"Exported",message:"Downloaded JSON config.",kind:"success"})},Be=()=>{n({title:"Saved",message:"Draft saved. Audit entry recorded (demo).",kind:"success"})},xe=()=>{if(!z){n({title:"Not ready",message:"Complete the go-live checklist first.",kind:"warn"}),i("goLive");return}n({title:"Go-live",message:"Organization setup published. CorporatePay enabled.",kind:"success"})},Ne=D=>{if(!D)return;const m=URL.createObjectURL(D);q(m),n({title:"Logo updated",message:"Logo preview refreshed.",kind:"success"})},M=()=>{Ve({id:"",name:"",country:"",city:"",address1:"",address2:"",postal:"",currency:c.baseCurrency||"UGX",taxId:"",vatNo:"",isPrimary:j.length===0}),ke(!0)},H=D=>{Ve({...D}),ke(!0)},Ae=()=>{if(!fe.name.trim()||!fe.country.trim()||!fe.city.trim()||!fe.address1.trim()){n({title:"Missing fields",message:"Name, country, city, and address line 1 are required.",kind:"warn"});return}g(D=>(fe.isPrimary&&(D=D.map(m=>({...m,isPrimary:!1}))),fe.id?D.map(m=>m.id===fe.id?fe:m):[{...fe,id:Or("ENT")},...D])),n({title:"Saved",message:"Entity saved.",kind:"success"}),ke(!1)},oe=D=>{var A;if((A=j.find(f=>f.id===D))==null?void 0:A.isPrimary){n({title:"Blocked",message:"You cannot delete the primary entity. Set another as primary first.",kind:"warn"});return}g(f=>f.filter(B=>B.id!==D)),n({title:"Deleted",message:"Entity removed.",kind:"info"})},De=()=>{Re({id:"",name:"",role:"Finance",email:"",phone:"",channels:{email:!0,whatsapp:!1,wechat:!1,sms:!0}}),Te(!0)},$e=()=>{if(!Ee.name.trim()||!Ee.email.trim()){n({title:"Missing fields",message:"Name and email are required.",kind:"warn"});return}$(D=>Ee.id?D.map(m=>m.id===Ee.id?Ee:m):[{...Ee,id:Or("BC")},...D]),n({title:"Saved",message:"Billing contact saved.",kind:"success"}),Te(!1)},ge=D=>{$(m=>m.filter(A=>A.id!==D)),n({title:"Deleted",message:"Contact removed.",kind:"info"})},ue=()=>{_e({id:"",name:"",entityScope:"All",apEmail:"",apCode:"",ccEmails:"",frequency:"Weekly",prefix:"",moduleScope:lh(t),marketplaceScope:nh(s),notes:""}),qe(!0)},Ke=D=>{_e(JSON.parse(JSON.stringify(D))),qe(!0)},b=()=>{if(!He.name.trim()||!He.apEmail.trim()||!He.apCode.trim()||!He.prefix.trim()){n({title:"Missing fields",message:"Name, AP email, AP code, and prefix are required.",kind:"warn"});return}je(D=>He.id?D.map(m=>m.id===He.id?He:m):[{...He,id:Or("IG")},...D]),n({title:"Saved",message:"Invoice group saved.",kind:"success"}),qe(!1)},v=D=>{je(m=>m.filter(A=>A.id!==D)),n({title:"Deleted",message:"Invoice group removed.",kind:"info"})},u=()=>{if(!de)return;const D=Qe.find(m=>m.id===de);D&&(D.apply(),n({title:"Template applied",message:`${D.name} template applied.",`,kind:"success"}),pe(!1))},C=D=>{ce(""),Y(D)},Q=()=>{if(!Ie.trim()){n({title:"Reason required",message:"Provide a reason for this change (audit).",kind:"warn"});return}const D=he==="enable";Oe(D),Y(null),n({title:D?"Support enabled":"Support disabled",message:"Change recorded in audit log.",kind:"success"})},O=o.findIndex(D=>D.id===r),ee=()=>{const D=o.findIndex(A=>A.id===r),m=o[Math.min(o.length-1,D+1)];i(m.id)},F=()=>{const D=o.findIndex(A=>A.id===r),m=o[Math.max(0,D-1)];i(m.id)};return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(ZU,{toasts:a,onDismiss:D=>l(m=>m.filter(A=>A.id!==D))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white",children:[e.jsxs("div",{className:"flex flex-col gap-3 px-4 py-4 md:flex-row md:items-center md:justify-between md:px-6",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:Kx.green},children:e.jsx(Xl,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Organization Profile and Program Setup"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Configure profile, billing, modules, policy defaults, invoice routing, and EVzone support."})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 rounded-3xl border border-slate-200 bg-slate-50 px-3 py-2",children:[e.jsx(JU,{value:le.pct}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Go-live readiness"}),e.jsxs("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:[Math.round(le.pct),"%"]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:z?"Ready":"Complete checklist"})]})]}),e.jsxs(Yt,{variant:"outline",onClick:Pe,children:[e.jsx(gt,{className:"h-4 w-4"})," Export JSON"]}),e.jsxs(Yt,{variant:"outline",onClick:Be,children:[e.jsx(Ia,{className:"h-4 w-4"})," Save draft"]}),e.jsxs(Yt,{variant:"primary",disabled:!z,onClick:xe,title:z?"Go live":"Complete readiness checklist",children:[e.jsx(ct,{className:"h-4 w-4"})," Go live"]})]})]}),e.jsxs("div",{className:"px-4 pb-4 md:px-6",children:[e.jsx("div",{className:"grid grid-cols-2 gap-2 md:grid-cols-4 lg:grid-cols-8",children:o.map((D,m)=>{const A=D.id===r,f=m<O;return e.jsx("button",{type:"button",onClick:()=>i(D.id),className:on("rounded-2xl border px-3 py-3 text-left transition",A?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs font-semibold text-slate-600",children:["Step ",m+1]}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:D.label}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:D.subtitle})]}),f?e.jsx(ct,{className:"h-5 w-5 text-emerald-700"}):A?e.jsx(et,{className:"h-5 w-5 text-emerald-700"}):null]})},D.id)})}),e.jsxs("div",{className:"mt-3 flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Yt,{variant:"outline",onClick:F,disabled:O===0,children:"Back"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Yt,{variant:"outline",onClick:()=>{pe(!0),ye("corporate")},children:[e.jsx(wa,{className:"h-4 w-4"})," Templates"]}),e.jsxs(Yt,{variant:"primary",onClick:ee,disabled:O===o.length-1,children:["Next",e.jsx(et,{className:"h-4 w-4"})]})]})]})]})]}),e.jsx("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(lt,{mode:"wait",children:[r==="profile"?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs(_n,{title:"Company profile",subtitle:"Identity fields used for invoices, exports, and compliance.",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(ys,{label:"Display name",required:!0,value:c.displayName,onChange:D=>x(m=>({...m,displayName:D})),placeholder:"Organization name"}),e.jsx(ys,{label:"Legal name",required:!0,value:c.legalName,onChange:D=>x(m=>({...m,legalName:D})),placeholder:"Legal registered name"}),e.jsx(ys,{label:"Registration number",value:c.registrationNo,onChange:D=>x(m=>({...m,registrationNo:D})),placeholder:"Business registration"}),e.jsx(ys,{label:"Website",value:c.website,onChange:D=>x(m=>({...m,website:D})),placeholder:"https://"}),e.jsx(am,{label:"Industry",value:c.industry,onChange:D=>x(m=>({...m,industry:D})),options:["Corporate","Hospital","Tour Company","Other"].map(D=>({value:D,label:D})),hint:"Premium templates"}),e.jsx(am,{label:"Base currency",value:c.baseCurrency,onChange:D=>x(m=>({...m,baseCurrency:D})),options:["UGX","USD","EUR","CNY","KES","TZS"].map(D=>({value:D,label:D})),hint:"Can be per entity"})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: Use the industry templates to apply best-practice defaults for Hospital, Tour Company, or Corporate."})]})},"profile"):null,r==="entities"?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs(_n,{title:"Entities and branches",subtitle:"Premium: multi-country entities under one organization. One must be primary.",right:e.jsxs(Yt,{variant:"primary",onClick:M,children:[e.jsx(pt,{className:"h-4 w-4"})," Add entity"]}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Name"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Country"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"City"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Currency"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Tax"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Primary"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[j.map(D=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:D.name}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:D.country}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:D.city}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:D.currency}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:D.taxId||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(el,{label:D.isPrimary?"Yes":"No",tone:D.isPrimary?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Yt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>H(D),children:[e.jsx(Qr,{className:"h-4 w-4"})," Edit"]}),e.jsxs(Yt,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>oe(D.id),children:[e.jsx(as,{className:"h-4 w-4"})," Delete"]})]})})]},D.id)),j.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10",children:e.jsx(Lv,{title:"No entities",subtitle:"Add at least one entity and mark it primary."})})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Best practice: invoice groups can route per entity using AP codes."})]})},"entities"):null,r==="billing"?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs(_n,{title:"Billing contacts and AP distribution",subtitle:"Used for invoice delivery, reminders, and billing escalation.",right:e.jsxs(Yt,{variant:"primary",onClick:De,children:[e.jsx(pt,{className:"h-4 w-4"})," Add contact"]}),children:[e.jsxs("div",{className:"space-y-2",children:[N.map(D=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:D.name}),e.jsx(el,{label:D.role,tone:"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[D.email,"  ",D.phone]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(el,{label:D.channels.email?"Email":"Email off",tone:D.channels.email?"good":"neutral"}),e.jsx(el,{label:D.channels.whatsapp?"WhatsApp":"WhatsApp off",tone:D.channels.whatsapp?"good":"neutral"}),e.jsx(el,{label:D.channels.wechat?"WeChat":"WeChat off",tone:D.channels.wechat?"good":"neutral"}),e.jsx(el,{label:D.channels.sms?"SMS":"SMS off",tone:D.channels.sms?"good":"neutral"})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Yt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Re(D),Te(!0)},children:[e.jsx(Qr,{className:"h-4 w-4"})," Edit"]}),e.jsxs(Yt,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>ge(D.id),children:[e.jsx(as,{className:"h-4 w-4"})," Remove"]})]})]})},D.id)),N.length?null:e.jsx(Lv,{title:"No billing contacts",subtitle:"Add at least one contact for invoice delivery."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: routing rules can send finance alerts to Accountants and approval reminders to Approvers."})]})},"billing"):null,r==="branding"?e.jsxs(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:[e.jsx(_n,{title:"Branding",subtitle:"Logo and invoice styling.",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Logo"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Displayed on invoices and PDF exports."})]}),e.jsx("input",{ref:T,type:"file",accept:"image/*",className:"hidden",onChange:D=>{var m;return Ne(((m=D.target.files)==null?void 0:m[0])||null)}}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Yt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{var D;return(D=T.current)==null?void 0:D.click()},children:[e.jsx(dg,{className:"h-4 w-4"})," Upload"]}),e.jsxs(Yt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{q(""),n({title:"Logo cleared",message:"Using placeholder.",kind:"info"})},children:[e.jsx(as,{className:"h-4 w-4"})," Clear"]})]})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Preview"}),e.jsxs("div",{className:"mt-3 flex items-center gap-3 rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center overflow-hidden rounded-2xl bg-slate-100 text-slate-700",children:k?e.jsx("img",{src:k,alt:"Logo",className:"h-full w-full object-cover"}):e.jsx(QF,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:c.displayName||"Organization"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Invoice header"})]})]}),e.jsx("div",{className:"mt-3 text-xs text-slate-600",children:"Logos are stored securely in production."})]})]}),e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsx(ah,{label:"Invoice footer",value:L,onChange:R,hint:"Shown on all invoices",rows:5})})]})}),e.jsxs(_n,{title:"Payment terms and instructions",subtitle:"What appears on invoices and statements.",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(ys,{label:"Payment terms",value:U,onChange:ae,placeholder:"Net 7",hint:"Net 7, Net 14, Due on receipt"}),e.jsx(ys,{label:"Invoice subject prefix",value:c.displayName?c.displayName.split(" ")[0].toUpperCase():"ORG",onChange:()=>{},placeholder:"ACME",disabled:!0,hint:"Derived"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(ah,{label:"Payment instructions",value:ie,onChange:_,hint:"Bank transfer, mobile money, etc",rows:5})})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: invoice templates can be customized per invoice group."})]})]},"branding"):null,r==="modules"?e.jsxs(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:[e.jsxs(_n,{title:"Module enablement",subtitle:"High-level toggles. Detailed marketplace controls are on the next page (E).",children:[e.jsx("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:t.map(D=>e.jsx(QU,{enabled:W[D],onChange:m=>J(A=>({...A,[D]:m})),label:D,description:D==="E-Commerce"?"Includes marketplaces like MyLiveDealz and marts.":"Enable CorporatePay for this service module."},D))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:'Note: "Other Service Module" is a future expansion slot. You can label it later.'})]}),e.jsxs(_n,{title:"Policy defaults",subtitle:"Regions, working hours, and default spend caps applied to new users and groups.",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Allowed regions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Used for default geo restrictions."})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(Yt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>n({title:"Tip",message:"Advanced geo-fences live in Policy Builder (I).",kind:"info"}),children:[e.jsx(vn,{className:"h-4 w-4"})," Geo-fences"]})})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[we.allowedRegions.map(D=>e.jsx(eV,{label:D,onRemove:()=>G(m=>({...m,allowedRegions:m.allowedRegions.filter(A=>A!==D)}))},D)),we.allowedRegions.length?null:e.jsx(el,{label:"No regions",tone:"warn"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx(ys,{label:"Add region",value:be,onChange:Ge,placeholder:"Example: Jinja"})}),e.jsx("div",{className:"flex items-end",children:e.jsxs(Yt,{variant:"outline",className:"w-full",onClick:()=>{const D=be.trim();if(!D){n({title:"Missing",message:"Enter a region.",kind:"warn"});return}if(we.allowedRegions.map(m=>m.toLowerCase()).includes(D.toLowerCase())){n({title:"Exists",message:"Region already listed.",kind:"info"});return}G(m=>({...m,allowedRegions:[D,...m.allowedRegions]})),Ge("")},children:[e.jsx(pt,{className:"h-4 w-4"})," Add"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs(_n,{title:"Working hours",subtitle:"Default time window for eligible transactions.",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(ys,{label:"Start",value:we.workStart,onChange:D=>G(m=>({...m,workStart:D})),type:"time"}),e.jsx(ys,{label:"End",value:we.workEnd,onChange:D=>G(m=>({...m,workEnd:D})),type:"time"})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Allowed days"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:"Mon,Tue,Wed,Thu,Fri,Sat,Sun".split(",").map(D=>{const m=we.days.includes(D);return e.jsx("button",{type:"button",className:on("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",m?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:m?{background:Kx.green}:void 0,onClick:()=>{G(A=>({...A,days:m?A.days.filter(f=>f!==D):[...A.days,D]}))},children:D},D)})})]})]}),e.jsx(_n,{title:"Default spend caps",subtitle:"Baseline limits applied to new users.",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx(ys,{label:"Default trip cap",value:we.defaultTripCap,onChange:D=>G(m=>({...m,defaultTripCap:D})),placeholder:"UGX 250,000"}),e.jsx(ys,{label:"Default daily cap",value:we.defaultDailyCap,onChange:D=>G(m=>({...m,defaultDailyCap:D})),placeholder:"UGX 1,200,000"}),e.jsx(ys,{label:"Default monthly cap",value:we.defaultMonthlyCap,onChange:D=>G(m=>({...m,defaultMonthlyCap:D})),placeholder:"UGX 12,000,000"}),e.jsx(ys,{label:"Auto-approve under",value:we.autoApproveUnder,onChange:D=>G(m=>({...m,autoApproveUnder:D})),placeholder:"UGX 200,000",hint:"Above this routes to approval chain"})]})})]})]})]},"modules"):null,r==="invoiceGroups"?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs(_n,{title:"Invoice groups",subtitle:"Enterprise billing distribution: route invoices to different AP emails and codes.",right:e.jsxs(Yt,{variant:"primary",onClick:ue,children:[e.jsx(pt,{className:"h-4 w-4"})," Add invoice group"]}),children:[e.jsxs("div",{className:"space-y-2",children:[Me.map(D=>{var m;return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:D.name}),e.jsx(el,{label:D.frequency,tone:"neutral"}),e.jsx(el,{label:D.apCode,tone:"info"}),e.jsx(el,{label:`Prefix: ${D.prefix}`,tone:"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["AP: ",D.apEmail,"  CC: ",D.ccEmails||"-"]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Entity: ",D.entityScope==="All"?"All entities":((m=j.find(A=>A.id===D.entityScope))==null?void 0:m.name)||"Entity"]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[Object.entries(D.moduleScope).filter(([,A])=>A).slice(0,6).map(([A])=>e.jsx(el,{label:A,tone:"neutral"},A)),Object.entries(D.moduleScope).filter(([,A])=>A).length>6?e.jsx(el,{label:"+more",tone:"neutral"}):null]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Yt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Ke(D),children:[e.jsx(Qr,{className:"h-4 w-4"})," Edit"]}),e.jsxs(Yt,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>v(D.id),children:[e.jsx(as,{className:"h-4 w-4"})," Delete"]})]})]}),D.notes?e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:D.notes}):null]},D.id)}),Me.length?null:e.jsx(Lv,{title:"No invoice groups",subtitle:"Create at least one invoice group for AP distribution."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Best practice: create invoice groups by department, region, or entity. Use AP codes for ERP mapping."})]})},"invoiceGroups"):null,r==="support"?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsx(_n,{title:"EVzone support access",subtitle:"Enable or disable support mode for this organization.",children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Support mode"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"When enabled, EVzone support can sign in with a role-gated account."})]}),e.jsx(el,{label:Ue?"Enabled":"Disabled",tone:Ue?"good":"neutral"})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:["Support safety:",e.jsxs("ul",{className:"mt-2 space-y-1",children:[e.jsx("li",{children:"1) View-only by default"}),e.jsx("li",{children:"2) No silent actions"}),e.jsx("li",{children:"3) Step-up authentication for write actions"}),e.jsx("li",{children:"4) Always audited and visible to org admins"})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs(Yt,{variant:"primary",disabled:Ue,onClick:()=>C("enable"),children:[e.jsx(yt,{className:"h-4 w-4"})," Enable support"]}),e.jsxs(Yt,{variant:"danger",disabled:!Ue,onClick:()=>C("disable"),children:[e.jsx(yt,{className:"h-4 w-4"})," Disable support"]})]})]})})},"support"):null,r==="goLive"?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsx(_n,{title:"Go-live readiness",subtitle:"Premium: setup wizard and readiness checklist.",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Checklist"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Complete all items to enable go-live."})]}),e.jsx(el,{label:`${Math.round(le.pct)}%`,tone:z?"good":"warn"})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx(jn,{ok:le.profileOk,label:"Company profile"}),e.jsx(jn,{ok:le.entityOk,label:"Primary entity"}),e.jsx(jn,{ok:le.billingOk,label:"Billing contacts"}),e.jsx(jn,{ok:le.brandingOk,label:"Branding and payment instructions"}),e.jsx(jn,{ok:le.moduleOk,label:"At least one module enabled"}),e.jsx(jn,{ok:le.policyOk,label:"Policy defaults"}),e.jsx(jn,{ok:le.invoiceOk,label:"Invoice groups"}),e.jsx(jn,{ok:le.supportOk,label:"Support mode set"})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Go-live actions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Publish to enable CorporatePay at checkout."}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Before go-live:",e.jsxs("ul",{className:"mt-2 space-y-1 text-xs text-slate-600",children:[e.jsx("li",{children:"1) Confirm invoice groups and AP emails"}),e.jsx("li",{children:"2) Confirm module enablement and policy defaults"}),e.jsx("li",{children:"3) Confirm support mode preference"})]})]}),e.jsxs("div",{className:"mt-3 flex flex-col gap-2",children:[e.jsxs(Yt,{variant:"outline",onClick:Pe,children:[e.jsx(gt,{className:"h-4 w-4"})," Export JSON"]}),e.jsxs(Yt,{variant:"outline",onClick:Be,children:[e.jsx(Ia,{className:"h-4 w-4"})," Save draft"]}),e.jsxs(Yt,{variant:"primary",disabled:!z,onClick:xe,children:[e.jsx(ct,{className:"h-4 w-4"})," Go live"]})]}),z?e.jsx("div",{className:"mt-3 rounded-2xl bg-emerald-50 p-3 text-xs text-emerald-900 ring-1 ring-emerald-200",children:"Ready. CorporatePay can be enabled for employees at checkout."}):e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Some items are pending. Use the wizard steps above to complete setup."})]})]})})},"goLive"):null]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Go-live readiness"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Quick view"})]}),e.jsx(el,{label:z?"Ready":"Pending",tone:z?"good":"warn"})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx(jn,{ok:le.profileOk,label:"Profile"}),e.jsx(jn,{ok:le.entityOk,label:"Entities"}),e.jsx(jn,{ok:le.billingOk,label:"Billing"}),e.jsx(jn,{ok:le.brandingOk,label:"Branding"}),e.jsx(jn,{ok:le.invoiceOk,label:"Invoice groups"})]}),e.jsxs(Yt,{variant:"outline",className:"mt-3 w-full",onClick:()=>i("goLive"),children:[e.jsx(ct,{className:"h-4 w-4"})," Open checklist"]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Template library"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: Hospital, Tour, Corporate"})]}),e.jsx(el,{label:"Premium",tone:"info"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:Qe.map(D=>e.jsx("button",{type:"button",className:"w-full rounded-3xl border border-slate-200 bg-white p-4 text-left hover:bg-slate-50",onClick:()=>{ye(D.id),pe(!0)},children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:D.name}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:D.desc})]}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]})},D.id))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Applying a template updates industry, module enablement, and policy defaults."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Help"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Setup guidance"})]}),e.jsx(el,{label:"Docs",tone:"neutral"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2",children:[e.jsxs(Yt,{variant:"outline",onClick:()=>n({title:"Help Center",message:"Opening help center (demo).",kind:"info"}),children:[e.jsx(Fu,{className:"h-4 w-4"})," Help Center"]}),e.jsxs(Yt,{variant:"outline",onClick:()=>n({title:"Support",message:"Creating a support ticket (demo).",kind:"info"}),children:[e.jsx(Xs,{className:"h-4 w-4"})," Contact support"]})]})]})]})]})}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"D Organization Profile and Program Setup v2: includes setup wizard, multi-entity branches, billing contacts, branding, module enablement, policy defaults, invoice groups, and EVzone support toggle."})})]})}),e.jsx(lm,{open:Fe,title:fe.id?"Edit entity":"New entity",subtitle:"Add a legal entity or branch. One entity must be primary.",onClose:()=>ke(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Yt,{variant:"outline",onClick:()=>ke(!1),children:"Cancel"}),e.jsxs(Yt,{variant:"primary",onClick:Ae,children:[e.jsx(Ia,{className:"h-4 w-4"})," Save"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(ys,{label:"Entity name",required:!0,value:fe.name,onChange:D=>Ve(m=>({...m,name:D})),placeholder:"Uganda HQ"}),e.jsx(am,{label:"Currency",value:fe.currency,onChange:D=>Ve(m=>({...m,currency:D})),options:["UGX","USD","EUR","CNY","KES","TZS"].map(D=>({value:D,label:D}))}),e.jsx(ys,{label:"Country",required:!0,value:fe.country,onChange:D=>Ve(m=>({...m,country:D})),placeholder:"Uganda"}),e.jsx(ys,{label:"City",required:!0,value:fe.city,onChange:D=>Ve(m=>({...m,city:D})),placeholder:"Kampala"}),e.jsx(ys,{label:"Address line 1",required:!0,value:fe.address1,onChange:D=>Ve(m=>({...m,address1:D})),placeholder:"Street, building"}),e.jsx(ys,{label:"Address line 2",value:fe.address2,onChange:D=>Ve(m=>({...m,address2:D})),placeholder:"Suite, floor"}),e.jsx(ys,{label:"Postal / P.O. Box",value:fe.postal,onChange:D=>Ve(m=>({...m,postal:D})),placeholder:"P.O. Box"}),e.jsx(ys,{label:"Tax ID",value:fe.taxId,onChange:D=>Ve(m=>({...m,taxId:D})),placeholder:"TIN..."}),e.jsx(ys,{label:"VAT number",value:fe.vatNo,onChange:D=>Ve(m=>({...m,vatNo:D})),placeholder:"VAT..."}),e.jsx("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Primary entity"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Primary is used as default for invoices."})]}),e.jsx("button",{type:"button",className:on("relative h-7 w-12 rounded-full border transition",fe.isPrimary?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>Ve(D=>({...D,isPrimary:!D.isPrimary})),"aria-label":"Toggle primary",children:e.jsx("span",{className:on("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",fe.isPrimary?"left-[22px]":"left-1")})})]})})]})}),e.jsx(lm,{open:ne,title:Ee.id?"Edit billing contact":"Add billing contact",subtitle:"Configure invoice recipients and reminder channels.",onClose:()=>Te(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Yt,{variant:"outline",onClick:()=>Te(!1),children:"Cancel"}),e.jsxs(Yt,{variant:"primary",onClick:$e,children:[e.jsx(Ia,{className:"h-4 w-4"})," Save"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(ys,{label:"Name",required:!0,value:Ee.name,onChange:D=>Re(m=>({...m,name:D})),placeholder:"Finance Desk"}),e.jsx(am,{label:"Role",value:Ee.role,onChange:D=>Re(m=>({...m,role:D})),options:["Finance","AP","CFO","Procurement","Ops","Other"].map(D=>({value:D,label:D}))}),e.jsx(ys,{label:"Email",required:!0,value:Ee.email,onChange:D=>Re(m=>({...m,email:D})),placeholder:"finance@company.com"}),e.jsx(ys,{label:"Phone",value:Ee.phone,onChange:D=>Re(m=>({...m,phone:D})),placeholder:"+256..."}),e.jsxs("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Delivery channels"}),e.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2 sm:grid-cols-4",children:[{k:"email",label:"Email"},{k:"whatsapp",label:"WhatsApp"},{k:"wechat",label:"WeChat"},{k:"sms",label:"SMS"}].map(D=>e.jsxs("label",{className:"flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-700",children:[e.jsx("input",{type:"checkbox",checked:Ee.channels[D.k],onChange:m=>Re(A=>({...A,channels:{...A.channels,[D.k]:m.target.checked}})),className:"h-4 w-4 rounded border-slate-300"}),D.label]},D.k))}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Delivery logs appear in Notifications Center (B)."})]})]})}),e.jsx(lm,{open:ze,title:He.id?"Edit invoice group":"New invoice group",subtitle:"Route invoices to AP recipients with codes and module scopes.",onClose:()=>qe(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Yt,{variant:"outline",onClick:()=>qe(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[He.id?e.jsxs(Yt,{variant:"danger",onClick:()=>{v(He.id),qe(!1)},children:[e.jsx(as,{className:"h-4 w-4"})," Delete"]}):null,e.jsxs(Yt,{variant:"primary",onClick:b,children:[e.jsx(Ia,{className:"h-4 w-4"})," Save"]})]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(ys,{label:"Group name",required:!0,value:He.name,onChange:D=>_e(m=>({...m,name:D})),placeholder:"Sales travel"}),e.jsx(am,{label:"Entity scope",value:He.entityScope,onChange:D=>_e(m=>({...m,entityScope:D})),options:[{value:"All",label:"All entities"},...j.map(D=>({value:D.id,label:D.name}))]}),e.jsx(ys,{label:"AP email",required:!0,value:He.apEmail,onChange:D=>_e(m=>({...m,apEmail:D})),placeholder:"ap@company.com"}),e.jsx(ys,{label:"AP code",required:!0,value:He.apCode,onChange:D=>_e(m=>({...m,apCode:D})),placeholder:"ACME-SALES",hint:"ERP mapping"}),e.jsx(ys,{label:"Invoice prefix",required:!0,value:He.prefix,onChange:D=>_e(m=>({...m,prefix:D})),placeholder:"ACME-SALES"}),e.jsx(ys,{label:"CC emails",value:He.ccEmails,onChange:D=>_e(m=>({...m,ccEmails:D})),placeholder:"finance@company.com",hint:"Comma separated"}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Frequency"}),e.jsx("select",{value:He.frequency,onChange:D=>_e(m=>({...m,frequency:D.target.value})),className:"mt-2 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none",children:["Daily","Weekly","Monthly","Custom"].map(D=>e.jsx("option",{value:D,children:D},D))}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Invoice cycle can be independent of budget periods."})]}),e.jsxs("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Module scope"}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Select which modules are included in this invoice group."}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-3",children:t.map(D=>e.jsxs("button",{type:"button",className:on("rounded-2xl border px-3 py-3 text-left",He.moduleScope[D]?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),onClick:()=>_e(m=>({...m,moduleScope:{...m.moduleScope,[D]:!m.moduleScope[D]}})),children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:D}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:He.moduleScope[D]?"Included":"Excluded"})]},D))}),e.jsxs("div",{className:on("mt-4",He.moduleScope["E-Commerce"]?"":"opacity-60"),children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Marketplace scope"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Applies when E-Commerce is included."}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-3",children:s.map(D=>e.jsxs("button",{type:"button",disabled:!He.moduleScope["E-Commerce"],className:on("rounded-2xl border px-3 py-3 text-left",He.marketplaceScope[D]?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50",!He.moduleScope["E-Commerce"]&&"cursor-not-allowed"),onClick:()=>{He.moduleScope["E-Commerce"]&&_e(m=>({...m,marketplaceScope:{...m.marketplaceScope,[D]:!m.marketplaceScope[D]}}))},children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:D}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:He.marketplaceScope[D]?"Included":"Excluded"})]},D))}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:'"Other Marketplace" is a future expansion slot.'})]})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(ah,{label:"Notes",value:He.notes,onChange:D=>_e(m=>({...m,notes:D})),placeholder:"Explain how this invoice group is used",rows:4})})]})}),e.jsxs(lm,{open:he!==null,title:he==="enable"?"Enable EVzone support mode":"Disable EVzone support mode",subtitle:"Provide a reason. This change is audit logged.",onClose:()=>Y(null),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Yt,{variant:"outline",onClick:()=>Y(null),children:"Cancel"}),e.jsxs(Yt,{variant:he==="disable"?"danger":"primary",onClick:Q,children:[e.jsx(yt,{className:"h-4 w-4"})," Confirm"]})]}),children:[e.jsx(ah,{label:"Reason",value:Ie,onChange:ce,placeholder:"Example: enable support for troubleshooting invoice delivery",rows:4}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Support sessions are visible to org admins and never silent."})]}),e.jsx(lm,{open:me,title:"Apply industry template",subtitle:"This updates industry, module toggles, and policy defaults.",onClose:()=>pe(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Yt,{variant:"outline",onClick:()=>pe(!1),children:"Cancel"}),e.jsxs(Yt,{variant:"primary",onClick:u,children:[e.jsx(wa,{className:"h-4 w-4"})," Apply"]})]}),children:(()=>{const D=Qe.find(m=>m.id===de);return D?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:D.name}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:D.desc})]}),e.jsx("div",{className:"rounded-3xl border border-amber-200 bg-amber-50 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-white text-amber-800 ring-1 ring-amber-200",children:e.jsx(vn,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"What changes"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:"Industry, module enablement, working hours, regions, and auto-approval threshold."}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"You can edit everything after applying."})]})]})})]}):null})()})]})}const mg={green:"#03CD8C",orange:"#F77F00"};function va(...t){return t.filter(Boolean).join(" ")}function sV(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function or(t){return JSON.parse(JSON.stringify(t))}function Kt({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:va("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Ts({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:mg.green}:t==="accent"?{background:mg.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:va(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Fv({enabled:t,onChange:s,label:a,disabled:l}){return e.jsxs("button",{type:"button",disabled:l,onClick:()=>!l&&s(!t),className:va("flex items-center justify-between gap-3 rounded-2xl border px-3 py-2 text-left text-sm font-semibold transition",t?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50",l&&"opacity-60 cursor-not-allowed"),children:[e.jsx("span",{children:a}),e.jsx("span",{className:va("relative h-6 w-10 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),children:e.jsx("span",{className:va("absolute top-0.5 h-5 w-5 rounded-full bg-white shadow-sm transition",t?"left-[18px]":"left-1")})})]})}function ic({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:va(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:va("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i,children:i},i))})]})}function rh({label:t,value:s,onChange:a,placeholder:l,hint:n,disabled:r}){return e.jsxs("div",{className:va(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{value:s,onChange:i=>a(i.target.value),placeholder:l,disabled:r,className:va("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function $E({actions:t}){const[s,a]=Xt.useState(!1),l=Xt.useRef(null);return Xt.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:va("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function b4({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="920px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[8vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx($E,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function aV({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,actions:i}){return d.useEffect(()=>{const o=c=>c.key==="Escape"&&n();return t&&window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,x:16},animate:{opacity:1,x:0},exit:{opacity:0,x:16},transition:{duration:.18},className:va("fixed z-50 overflow-hidden border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]","left-2 right-2 bottom-2 top-[14vh] rounded-[28px]","lg:left-auto lg:right-4 lg:top-4 lg:bottom-4 lg:w-[560px]"),role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-base font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i&&e.jsx($E,{actions:i}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"h-full min-h-0 overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function lV({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:va("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function td(t){return t==="High"?"bad":t==="Medium"?"warn":"good"}function LE(t){return t==="High"?90:t==="Medium"?55:20}function nV(t){const a=t.reduce((n,r)=>n+LE(r),0)/Math.max(1,t.length),l=a>=70?"High":a>=40?"Medium":"Low";return{avg:a,label:l}}function rV(t,s){const a=[...t].sort().join("|"),l=[...s].sort().join("|");return a===l}function j4(){const t=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],s=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],a={"E-Commerce":"Medium","EVs & Charging":"Medium","Rides & Logistics":"Medium","School & E-Learning":"Medium","Medical & Health Care":"High","Travel & Tourism":"Medium","Green Investments":"High",FaithHub:"Medium","Virtual Workspace":"Low","Finance & Payments":"High","Other Service Module":"Medium"},l={};t.forEach(r=>{l[r]={enabled:r!=="Other Service Module"&&r!=="Green Investments",risk:a[r],policy:r==="Finance & Payments"||r==="Medical & Health Care"?"Strict compliance":"Balanced",approval:r==="Finance & Payments"?"Finance approval":r==="Medical & Health Care"?"Manager approval":"Auto under threshold"}});const n={};return s.forEach(r=>{n[r]={enabled:r==="MyLiveDealz"||r==="EVmart"||r==="ServiceMart"||r==="GadgetMart"||r==="ExpressMart"||r==="Other Marketplace",inheritFromModule:!0,policy:"Org default",approval:"Org default"}}),{modules:l,marketplaces:n,labels:{otherModuleLabel:"Other Service Module",otherMarketplaceLabel:"Other Marketplace"},rollout:{stage:"Pilot",pilotGroups:["Operations","Finance"],plannedGoAllDate:"2026-01-14",notes:"Pilot with Operations and Finance, then expand to all groups."}}}function iV(){const t=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],s=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],a=[{id:"Operations",users:34},{id:"Sales",users:22},{id:"Finance",users:10},{id:"Admin",users:8},{id:"Procurement",users:6}],l=[{id:"U-1001",name:"Mary N.",group:"Operations",title:"Operations Manager"},{id:"U-1002",name:"Finance Desk",group:"Finance",title:"Accountant"},{id:"U-1003",name:"John S.",group:"Sales",title:"Sales Executive"},{id:"U-1004",name:"Admin Team",group:"Admin",title:"Org Admin"},{id:"U-1005",name:"Procurement Desk",group:"Procurement",title:"Approver"},{id:"U-1006",name:"Irene K.",group:"Operations",title:"Travel Coordinator"},{id:"U-1007",name:"Samuel A.",group:"Sales",title:"Manager"},{id:"U-1008",name:"Daisy O.",group:"Finance",title:"Finance Officer"}],n=["Org default","Conservative","Balanced","Flexible","Strict compliance"],r=["Org default","Auto under threshold","Manager approval","Finance approval","CFO approval","Multi-level escalation"],[i,o]=d.useState([]),c=le=>{const z=sV("toast");o(Pe=>[{id:z,...le},...Pe].slice(0,4)),window.setTimeout(()=>o(Pe=>Pe.filter(Be=>Be.id!==z)),3200)},[x,j]=d.useState("enablement"),[g,N]=d.useState(()=>j4()),[$,T]=d.useState(()=>or(j4())),[k,q]=d.useState({kind:"module",key:"E-Commerce"}),[L,R]=d.useState(!1),[U,ae]=d.useState(""),[ie,_]=d.useState(!1),[W,J]=d.useState(!1);d.useMemo(()=>a.reduce((le,z)=>le+z.users,0),[a]);const we=d.useMemo(()=>(k==null?void 0:k.kind)==="module"?k.key:null,[k]),G=d.useMemo(()=>(k==null?void 0:k.kind)==="marketplace"?k.key:null,[k]),be=le=>le==="Other Marketplace"?g.labels.otherMarketplaceLabel||"Other Marketplace":le,Ge=le=>le==="Other Service Module"?g.labels.otherModuleLabel||"Other Service Module":le,Me=g.modules["E-Commerce"].enabled,je=d.useMemo(()=>{const le=[];return t.forEach(z=>{g.modules[z].enabled&&le.push(g.modules[z].risk)}),le},[g,t]),Ue=d.useMemo(()=>nV(je),[je]),Oe=g.rollout,he=le=>Oe.stage==="All"?!0:Oe.pilotGroups.includes(le.group),Y=(le,z,Pe)=>le.modules[Pe].enabled?le.rollout.stage==="All"?!0:le.rollout.pilotGroups.includes(z.group):!1,Ie=(le,z,Pe)=>!le.modules["E-Commerce"].enabled||!le.marketplaces[Pe].enabled?!1:le.rollout.stage==="All"?!0:le.rollout.pilotGroups.includes(z.group),ce=d.useMemo(()=>{let le=0;return t.forEach(z=>{const Pe=g.modules[z],Be=$.modules[z];Pe.enabled!==Be.enabled&&(le+=1),Pe.risk!==Be.risk&&(le+=1),Pe.policy!==Be.policy&&(le+=1),Pe.approval!==Be.approval&&(le+=1)}),s.forEach(z=>{const Pe=g.marketplaces[z],Be=$.marketplaces[z];Pe.enabled!==Be.enabled&&(le+=1),Pe.inheritFromModule!==Be.inheritFromModule&&(le+=1),Pe.policy!==Be.policy&&(le+=1),Pe.approval!==Be.approval&&(le+=1)}),g.labels.otherModuleLabel!==$.labels.otherModuleLabel&&(le+=1),g.labels.otherMarketplaceLabel!==$.labels.otherMarketplaceLabel&&(le+=1),g.rollout.stage!==$.rollout.stage&&(le+=1),rV(g.rollout.pilotGroups,$.rollout.pilotGroups)||(le+=1),g.rollout.plannedGoAllDate!==$.rollout.plannedGoAllDate&&(le+=1),le},[g,$,t,s]),me=d.useMemo(()=>{const le=[];l.forEach(Be=>{const xe=[],Ne=[];t.forEach(M=>{const H=Y($,Be,M),Ae=Y(g,Be,M);!H&&Ae&&xe.push(`Module: ${Ge(M)}`),H&&!Ae&&Ne.push(`Module: ${Ge(M)}`)}),s.forEach(M=>{const H=Ie($,Be,M),Ae=Ie(g,Be,M);!H&&Ae&&xe.push(`Marketplace: ${be(M)}`),H&&!Ae&&Ne.push(`Marketplace: ${be(M)}`)}),(xe.length||Ne.length)&&le.push({user:Be,gained:xe,lost:Ne})});const z=le.reduce((Be,xe)=>Be+xe.gained.length,0),Pe=le.reduce((Be,xe)=>Be+xe.lost.length,0);return{changedUsers:le,gains:z,losses:Pe,changedCount:le.length}},[g,$,l,t,s]),pe=d.useMemo(()=>{const le=l.filter(Pe=>he(Pe)),z=l.filter(Pe=>!he(Pe));return{pilotUsers:le,nonPilot:z}},[l,he]),de=()=>{N(or($)),c({title:"Reverted",message:"Draft reverted to last published settings.",kind:"info"})},ye=()=>{c({title:"Saved",message:"Draft saved (demo).",kind:"success"})},Qe=()=>{ae(""),_(!1),R(!0)},Fe=()=>{if(U.trim().length<8||!ie){c({title:"Publish blocked",message:"Add a clear reason and confirm acknowledgement.",kind:"warn"});return}T(or(g)),R(!1),c({title:"Published",message:"Enablement settings published.",kind:"success"})},ke=async()=>{const le={draft:g,exportedAt:new Date().toISOString()},z=JSON.stringify(le,null,2);try{await navigator.clipboard.writeText(z),c({title:"Copied",message:"Config JSON copied to clipboard.",kind:"success"})}catch{c({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},fe=()=>{if(!we){c({title:"Select module",message:"Select a module first.",kind:"warn"});return}N(le=>{const z=or(le),Pe=z.modules[we];return t.forEach(Be=>{z.modules[Be].policy=Pe.policy,z.modules[Be].approval=Pe.approval}),z}),c({title:"Applied",message:"Module defaults applied to all modules.",kind:"success"})},Ve=()=>{N(le=>{const z=or(le);return s.forEach(Pe=>{z.marketplaces[Pe].inheritFromModule=!0,z.marketplaces[Pe].policy="Org default",z.marketplaces[Pe].approval="Org default"}),z}),c({title:"Applied",message:"Marketplaces set to inherit from E-Commerce defaults.",kind:"success"})},ne=!!k,Te=we?`Module: ${Ge(we)}`:G?`Marketplace: ${be(G)}`:"",Ee=we?`Risk: ${g.modules[we].risk}  Enabled: ${g.modules[we].enabled?"Yes":"No"}`:G?`Enabled: ${g.marketplaces[G].enabled?"Yes":"No"}  Inherit: ${g.marketplaces[G].inheritFromModule?"Yes":"No"}`:"",Re={"E-Commerce":["High vendor variability","Category restrictions may apply","Marketplace-specific rules"],"EVs & Charging":["Energy transactions","Station policies and credits","Operational fraud risk"],"Rides & Logistics":["High volume","Policy breaches (time/geo)","Safety and chargeback"],"School & E-Learning":["Payments and subscriptions","Youth safety policies","Refund rules"],"Medical & Health Care":["Sensitive categories","Compliance requirements","Higher audit expectations"],"Travel & Tourism":["High variability","Airport rules","Large bookings"],"Green Investments":["Regulatory sensitivity","Large amounts","Enhanced approvals"],FaithHub:["Content sensitivity","Donations/refunds","Policy controls"],"Virtual Workspace":["Low monetary risk","Mostly operational","Permissions sensitive"],"Finance & Payments":["Direct money movement","Fraud risk","Always audited"],"Other Service Module":["Unknown risk","Default to Medium","Review before enabling"]},ze=t.filter(le=>g.modules[le].enabled).length,qe=s.filter(le=>g.marketplaces[le].enabled).length;return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(lV,{toasts:i,onDismiss:le=>o(z=>z.filter(Pe=>Pe.id!==le))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:mg.green},children:e.jsx(wa,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Modules and Marketplaces Enablement"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Enable services and marketplaces. Map default policies and approval flows. Use pilot rollout before enabling for everyone."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(Kt,{label:`Modules enabled: ${ze}/${t.length}`,tone:"neutral"}),e.jsx(Kt,{label:`Marketplaces enabled: ${qe}/${s.length}`,tone:Me?"neutral":"warn"}),e.jsx(Kt,{label:`Rollout: ${g.rollout.stage}`,tone:g.rollout.stage==="Pilot"?"warn":"good"}),e.jsx(Kt,{label:`Org risk: ${Ue.label}`,tone:td(Ue.label)}),ce?e.jsx(Kt,{label:`Draft changes: ${ce}`,tone:"info"}):e.jsx(Kt,{label:"No draft changes",tone:"good"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ts,{variant:"outline",onClick:()=>J(!0),children:[e.jsx(gt,{className:"h-4 w-4"})," Export"]}),e.jsxs(Ts,{variant:"outline",onClick:de,disabled:!ce,children:[e.jsx(Ye,{className:"h-4 w-4"})," Revert"]}),e.jsxs(Ts,{variant:"outline",onClick:ye,children:[e.jsx(Ia,{className:"h-4 w-4"})," Save draft"]}),e.jsxs(Ts,{variant:"primary",onClick:Qe,disabled:!ce,children:[e.jsx(ct,{className:"h-4 w-4"})," Publish"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"enablement",label:"Enablement"},{id:"defaults",label:"Default policies and approvals"},{id:"rollout",label:"Controlled rollout"},{id:"impact",label:"Change impact"}].map(le=>e.jsx("button",{className:va("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",x===le.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:x===le.id?{background:mg.green}:void 0,onClick:()=>j(le.id),children:le.label},le.id))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[x==="enablement"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Service modules"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Enable or disable modules. Click to edit defaults."})]}),e.jsx(Kt,{label:"Core",tone:"neutral"})]}),e.jsx("div",{className:"mt-4 space-y-2",children:t.map(le=>{const z=g.modules[le],Pe=we===le,Be=Ge(le);return e.jsx("button",{type:"button",onClick:()=>q({kind:"module",key:le}),className:va("w-full rounded-3xl border p-4 text-left transition",Pe?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:Be}),e.jsx(Kt,{label:z.enabled?"Enabled":"Off",tone:z.enabled?"good":"neutral"}),e.jsx(Kt,{label:`Risk: ${z.risk}`,tone:td(z.risk)})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Policy: ",z.policy,"  Approval: ",z.approval]})]}),e.jsx(et,{className:"mt-0.5 h-4 w-4 text-slate-500"})]})},le)})}),e.jsx("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: risk profile scoring is shown per module and aggregated for the org."}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Other labels"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Optional: rename the Other slots."}),e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsx(rh,{label:"Other Service Module label",value:g.labels.otherModuleLabel,onChange:le=>N(z=>({...z,labels:{...z.labels,otherModuleLabel:le}})),placeholder:"Other Service Module"}),e.jsx(rh,{label:"Other Marketplace label",value:g.labels.otherMarketplaceLabel,onChange:le=>N(z=>({...z,labels:{...z.labels,otherMarketplaceLabel:le}})),placeholder:"Other Marketplace"})]})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Marketplaces (within E-Commerce)"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Enable or disable marketplaces. Applies when E-Commerce is enabled."})]}),e.jsx(Kt,{label:Me?"E-Commerce enabled":"E-Commerce off",tone:Me?"good":"warn"})]}),e.jsx("div",{className:va("mt-4 grid grid-cols-1 gap-2 md:grid-cols-2",!Me&&"opacity-70"),children:s.map(le=>{const z=g.marketplaces[le],Pe=G===le,Be=be(le);return e.jsx("button",{type:"button",disabled:!Me,onClick:()=>q({kind:"marketplace",key:le}),className:va("rounded-3xl border p-4 text-left transition",Pe?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50",!Me&&"cursor-not-allowed"),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:Be}),e.jsx(Kt,{label:z.enabled?"Enabled":"Off",tone:z.enabled?"good":"neutral"}),e.jsx(Kt,{label:z.inheritFromModule?"Inherit":"Override",tone:z.inheritFromModule?"neutral":"info"})]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:z.inheritFromModule?"Uses E-Commerce defaults":`Policy: ${z.policy}  Approval: ${z.approval}`})]}),e.jsx(et,{className:"mt-0.5 h-4 w-4 text-slate-500"})]})},le)})}),Me?null:e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Enable E-Commerce to use marketplace toggles."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Ts,{variant:"outline",onClick:Ve,disabled:!Me,children:[e.jsx(ht,{className:"h-4 w-4"})," Set all to inherit"]}),e.jsxs(Ts,{variant:"outline",onClick:()=>{N(le=>{const z=or(le);return s.forEach(Pe=>z.marketplaces[Pe].enabled=!0),z}),c({title:"Enabled",message:"All marketplaces enabled (demo).",kind:"success"})},disabled:!Me,children:[e.jsx(pt,{className:"h-4 w-4"})," Enable all"]}),e.jsxs(Ts,{variant:"outline",onClick:()=>{N(le=>{const z=or(le);return s.forEach(Pe=>z.marketplaces[Pe].enabled=!1),z.marketplaces["Other Marketplace"].enabled=!0,z}),c({title:"Disabled",message:"All marketplaces disabled (except Other).",kind:"info"})},disabled:!Me,children:[e.jsx(Ye,{className:"h-4 w-4"})," Disable all"]})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Module risk profile scoring"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"High sensitivity modules should have stricter policies and approvals."})]}),e.jsx(Kt,{label:`Org risk: ${Ue.label}`,tone:td(Ue.label)})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx(He,{title:"Enabled modules",value:`${ze}`,icon:e.jsx(wa,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(He,{title:"Avg risk score",value:`${Math.round(Ue.avg)}/100`,icon:e.jsx(Mt,{className:"h-5 w-5"}),tone:td(Ue.label)}),e.jsx(He,{title:"Stage",value:g.rollout.stage,icon:e.jsx(Us,{className:"h-5 w-5"}),tone:g.rollout.stage==="Pilot"?"warn":"good"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: risk score influences recommended approval flows and alert routing."})]})]})]}):null,x==="defaults"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Bulk tools"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Apply defaults quickly."})]}),e.jsx(Kt,{label:"Premium",tone:"info"})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs(Ts,{variant:"outline",className:"w-full",onClick:fe,children:[e.jsx(ht,{className:"h-4 w-4"})," Apply selected module defaults to all"]}),e.jsxs(Ts,{variant:"outline",className:"w-full",onClick:Ve,disabled:!Me,children:[e.jsx(ht,{className:"h-4 w-4"})," Set all marketplaces to inherit"]}),e.jsxs(Ts,{variant:"outline",className:"w-full",onClick:()=>{N(le=>{const z=or(le);return t.forEach(Pe=>{z.modules[Pe].policy="Balanced",z.modules[Pe].approval="Auto under threshold"}),z.modules["Finance & Payments"].policy="Strict compliance",z.modules["Finance & Payments"].approval="Finance approval",z}),c({title:"Template",message:"Balanced defaults applied (demo).",kind:"success"})},children:[e.jsx(wa,{className:"h-4 w-4"})," Apply Balanced template"]})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Defaults are used when users do not have group or user overrides."})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Per-module defaults"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Default policy template and approval flow mapping."})]}),e.jsx(Kt,{label:"Core",tone:"neutral"})]}),e.jsx("div",{className:"mt-4 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Module"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Enabled"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Risk"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Default policy"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Default approval"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Edit"})]})}),e.jsx("tbody",{children:t.map(le=>{const z=g.modules[le];return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Ge(le)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Kt,{label:z.enabled?"Yes":"No",tone:z.enabled?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Kt,{label:z.risk,tone:td(z.risk)})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:z.policy}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:z.approval}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Ts,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>q({kind:"module",key:le}),children:"Edit"})})]},le)})})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Best practice: Finance & Payments and Medical & Health Care should use strict compliance defaults."})]}),e.jsxs("div",{className:va("rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",!Me&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Per-marketplace overrides"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"If not inheriting, set marketplace-specific policy and approvals."})]}),e.jsx(Kt,{label:Me?"E-Commerce on":"E-Commerce off",tone:Me?"good":"warn"})]}),e.jsx("div",{className:"mt-4 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Marketplace"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Enabled"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Inherit"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Policy"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Approval"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Edit"})]})}),e.jsx("tbody",{children:s.map(le=>{const z=g.marketplaces[le];return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:be(le)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Kt,{label:z.enabled?"Yes":"No",tone:z.enabled?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Kt,{label:z.inheritFromModule?"Yes":"No",tone:z.inheritFromModule?"neutral":"info"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:z.inheritFromModule?"(inherits)":z.policy}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:z.inheritFromModule?"(inherits)":z.approval}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Ts,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>q({kind:"marketplace",key:le}),disabled:!Me,children:"Edit"})})]},le)})})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: set MyLiveDealz to stricter approvals if you allow high-value deals."})]})]})]}):null,x==="rollout"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Controlled rollout"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Pilot group first, then expand to all."})]}),e.jsx(Kt,{label:"Premium",tone:"info"})]}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsx(ic,{label:"Stage",value:g.rollout.stage,onChange:le=>N(z=>({...z,rollout:{...z.rollout,stage:le}})),options:["Pilot","All"],hint:"Pilot limits access"}),e.jsx(rh,{label:"Planned go-all date",value:g.rollout.plannedGoAllDate,onChange:le=>N(z=>({...z,rollout:{...z.rollout,plannedGoAllDate:le}})),placeholder:"YYYY-MM-DD",hint:"Roadmap"}),e.jsx(rh,{label:"Notes",value:g.rollout.notes,onChange:le=>N(z=>({...z,rollout:{...z.rollout,notes:le}})),placeholder:"Explain rollout plan"}),e.jsxs("div",{className:va("rounded-3xl border border-slate-200 bg-white p-4",g.rollout.stage==="All"&&"opacity-70"),children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Pilot groups"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Select groups to receive access during pilot stage."}),e.jsx("div",{className:"mt-3 space-y-2",children:a.map(le=>{const z=g.rollout.pilotGroups.includes(le.id);return e.jsxs("button",{type:"button",disabled:g.rollout.stage==="All",onClick:()=>{g.rollout.stage!=="All"&&N(Pe=>{const Be=or(Pe),xe=new Set(Be.rollout.pilotGroups);return xe.has(le.id)?xe.delete(le.id):xe.add(le.id),Be.rollout.pilotGroups=Array.from(xe),Be})},className:va("flex w-full items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm font-semibold",z?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50",g.rollout.stage==="All"&&"cursor-not-allowed"),children:[e.jsx("span",{children:le.id}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Kt,{label:`${le.users} users`,tone:"neutral"}),e.jsx(Kt,{label:z?"Pilot":"Off",tone:z?"good":"neutral"})]})]},le.id)})})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ts,{variant:"primary",onClick:()=>{N(le=>({...le,rollout:{...le.rollout,stage:"All"}})),c({title:"Expanded",message:"Rollout expanded to all groups (draft).",kind:"success"})},children:[e.jsx(Us,{className:"h-4 w-4"})," Expand to all"]}),e.jsxs(Ts,{variant:"outline",onClick:()=>{N(le=>({...le,rollout:{...le.rollout,stage:"Pilot"}})),c({title:"Pilot",message:"Returned to pilot stage (draft).",kind:"info"})},children:[e.jsx(et,{className:"h-4 w-4"})," Pilot stage"]})]}),e.jsx("div",{className:"mt-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: pilot rollout is recommended for high-risk modules like Finance & Payments."})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Pilot preview"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Who has access now under draft rollout settings."})]}),e.jsx(Kt,{label:`Pilot users: ${pe.pilotUsers.length}`,tone:g.rollout.stage==="Pilot"?"warn":"neutral"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Allowed groups"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:(g.rollout.stage==="All"?a.map(le=>le.id):g.rollout.pilotGroups).map(le=>e.jsx(Kt,{label:le,tone:"neutral"},le))})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Pilot coverage"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:g.rollout.stage==="All"?"100%":`${Math.round(pe.pilotUsers.length/Math.max(1,l.length)*100)}%`}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Sample users list, full list in production"})]})]}),e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"User"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Rollout access"})]})}),e.jsx("tbody",{children:l.map(le=>{const z=he(le);return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:le.name}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:le.group}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Kt,{label:g.rollout.stage==="All"?"Allowed":z?"Pilot":"Not yet",tone:g.rollout.stage==="All"?"good":z?"warn":"neutral"})})]},le.id)})})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Controlled rollout does not remove individual permissions. It limits availability until pilot is complete."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Recommended rollout strategy"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Based on enabled modules risk."})]}),e.jsx(Kt,{label:`Org risk: ${Ue.label}`,tone:td(Ue.label)})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Suggested:",e.jsxs("ul",{className:"mt-2 space-y-1 text-xs text-slate-600",children:[e.jsx("li",{children:"1) Pilot Finance & Payments with Finance group only"}),e.jsx("li",{children:"2) Pilot MyLiveDealz purchases with Procurement approvals"}),e.jsx("li",{children:"3) Expand to all when approval SLAs stabilize"})]})]})]})]})]}):null,x==="impact"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Change impact preview"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Compares draft against last published configuration."})]}),e.jsx(Kt,{label:ce?"Draft has changes":"No changes",tone:ce?"warn":"good"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3",children:[e.jsx(_e,{title:"Users affected",value:`${me.changedCount}`,tone:me.changedCount?"warn":"good",icon:e.jsx(Us,{className:"h-5 w-5"})}),e.jsx(_e,{title:"Access gains",value:`${me.gains}`,tone:me.gains?"good":"neutral",icon:e.jsx(ht,{className:"h-5 w-5"})}),e.jsx(_e,{title:"Access losses",value:`${me.losses}`,tone:me.losses?"warn":"neutral",icon:e.jsx(ra,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: publish changes after reviewing impact. Use pilot rollout to reduce disruption."}),e.jsxs(Ts,{variant:"primary",className:"mt-4 w-full",disabled:!ce,onClick:Qe,children:[e.jsx(ct,{className:"h-4 w-4"})," Publish changes"]}),e.jsxs(Ts,{variant:"outline",className:"mt-2 w-full",disabled:!ce,onClick:de,children:[e.jsx(Ye,{className:"h-4 w-4"})," Revert"]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Users impacted"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Sample list (demo). In production, this lists all users."})]}),e.jsx(Kt,{label:`${me.changedUsers.length}`,tone:me.changedUsers.length?"warn":"good"})]}),me.changedUsers.length?e.jsx("div",{className:"mt-4 space-y-3",children:me.changedUsers.map(le=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:le.user.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[le.user.title,"  Group: ",le.user.group,"  ",le.user.id]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[le.gained.length?e.jsx(Kt,{label:`Gains: ${le.gained.length}`,tone:"good"}):null,le.lost.length?e.jsx(Kt,{label:`Losses: ${le.lost.length}`,tone:"warn"}):null]})]}),le.gained.length?e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Gained access"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[le.gained.slice(0,8).map(z=>e.jsx(Kt,{label:z,tone:"good"},z)),le.gained.length>8?e.jsx(Kt,{label:`+${le.gained.length-8}`,tone:"good"}):null]})]}):null,le.lost.length?e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Lost access"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[le.lost.slice(0,8).map(z=>e.jsx(Kt,{label:z,tone:"warn"},z)),le.lost.length>8?e.jsx(Kt,{label:`+${le.lost.length-8}`,tone:"warn"}):null]})]}):null,e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: impact preview can include historical spend risk scoring for each user."})]},le.user.id))}):e.jsxs("div",{className:"mt-4 rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(tt,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No impact"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Draft matches last published configuration."})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"What changes in the apps"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Employees use normal EVzone apps. CorporatePay appears at checkout based on enablement."})]}),e.jsx(Kt,{label:"Explanation",tone:"info"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:e.jsxs("ul",{className:"space-y-1 text-xs text-slate-600",children:[e.jsx("li",{children:"1) If a module is disabled, CorporatePay is not available for that module at checkout."}),e.jsx("li",{children:"2) For E-Commerce, marketplaces must be enabled for CorporatePay to appear on those purchases."}),e.jsx("li",{children:"3) Controlled rollout limits access to pilot groups until expanded."})]})})]})]})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"E Modules & Marketplaces Enablement v2: module toggles, marketplace toggles, per-module and per-marketplace defaults, risk scoring, controlled rollout, and impact preview."})})]})}),e.jsxs(aV,{open:ne,title:Te,subtitle:Ee,onClose:()=>q(null),footer:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Edit is draft-only until published."}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Ts,{variant:"outline",onClick:()=>q(null),children:"Close"}),e.jsxs(Ts,{variant:"primary",onClick:ye,children:[e.jsx(Ia,{className:"h-4 w-4"})," Save"]})]})]}),children:[we?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Enablement"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Toggle availability for this module at checkout."})]}),e.jsx(Kt,{label:g.modules[we].enabled?"Enabled":"Off",tone:g.modules[we].enabled?"good":"neutral"})]}),e.jsx("div",{className:"mt-3",children:e.jsx(Fv,{enabled:g.modules[we].enabled,onChange:le=>N(z=>({...z,modules:{...z.modules,[we]:{...z.modules[we],enabled:le}}})),label:g.modules[we].enabled?"Disable module":"Enable module"})}),we==="E-Commerce"&&!g.modules[we].enabled?e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Disabling E-Commerce disables all marketplace purchases via CorporatePay."}):null]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Risk profile"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: scoring guides defaults and rollout strategy."})]}),e.jsx(Kt,{label:`Score ${LE(g.modules[we].risk)}/100`,tone:td(g.modules[we].risk)})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx(ic,{label:"Risk rating",value:g.modules[we].risk,onChange:le=>N(z=>({...z,modules:{...z.modules,[we]:{...z.modules[we],risk:le}}})),options:["Low","Medium","High"],hint:"Override if needed"}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Signals:",e.jsx("ul",{className:"mt-2 space-y-1 text-xs text-slate-600",children:Re[we].map(le=>e.jsxs("li",{children:[" ",le]},le))})]})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Default mappings"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Applied unless overridden by group/user policies."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4",children:[e.jsx(ic,{label:"Default policy template",value:g.modules[we].policy,onChange:le=>N(z=>({...z,modules:{...z.modules,[we]:{...z.modules[we],policy:le}}})),options:n}),e.jsx(ic,{label:"Default approval flow",value:g.modules[we].approval,onChange:le=>N(z=>({...z,modules:{...z.modules,[we]:{...z.modules[we],approval:le}}})),options:r})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Recommendation: high risk modules should use Finance approval or Multi-level escalation."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Quick apply"}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Ts,{variant:"outline",onClick:fe,children:[e.jsx(ht,{className:"h-4 w-4"})," Apply to all modules"]}),e.jsxs(Ts,{variant:"outline",onClick:()=>{N(le=>{const z=or(le);return z.modules[we].policy="Strict compliance",z.modules[we].approval="Multi-level escalation",z}),c({title:"Applied",message:"Strict defaults set for this module.",kind:"success"})},children:[e.jsx(yt,{className:"h-4 w-4"})," Strict preset"]})]})]})]}):null,G?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Enablement"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Availability for this marketplace at checkout."})]}),e.jsx(Kt,{label:g.marketplaces[G].enabled?"Enabled":"Off",tone:g.marketplaces[G].enabled?"good":"neutral"})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx(Fv,{enabled:g.marketplaces[G].enabled,onChange:le=>N(z=>({...z,marketplaces:{...z.marketplaces,[G]:{...z.marketplaces[G],enabled:le}}})),label:g.marketplaces[G].enabled?"Disable marketplace":"Enable marketplace",disabled:!g.modules["E-Commerce"].enabled}),e.jsx(Fv,{enabled:g.marketplaces[G].inheritFromModule,onChange:le=>N(z=>({...z,marketplaces:{...z.marketplaces,[G]:{...z.marketplaces[G],inheritFromModule:le}}})),label:g.marketplaces[G].inheritFromModule?"Inheriting from E-Commerce":"Override defaults",disabled:!g.modules["E-Commerce"].enabled})]}),g.modules["E-Commerce"].enabled?null:e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Enable E-Commerce module first."})]}),e.jsx("div",{className:va(g.marketplaces[G].inheritFromModule?"opacity-70":""),children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Marketplace defaults"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Only applies when overrides are enabled."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4",children:[e.jsx(ic,{label:"Policy template",value:g.marketplaces[G].policy,onChange:le=>N(z=>({...z,marketplaces:{...z.marketplaces,[G]:{...z.marketplaces[G],policy:le}}})),options:n,disabled:g.marketplaces[G].inheritFromModule}),e.jsx(ic,{label:"Approval flow",value:g.marketplaces[G].approval,onChange:le=>N(z=>({...z,marketplaces:{...z.marketplaces,[G]:{...z.marketplaces[G],approval:le}}})),options:r,disabled:g.marketplaces[G].inheritFromModule})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: use stricter approvals for marketplaces that allow high-value assets or services."})]})}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Shortcuts"}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Ts,{variant:"outline",onClick:Ve,children:[e.jsx(ht,{className:"h-4 w-4"})," Set all to inherit"]}),e.jsxs(Ts,{variant:"outline",onClick:()=>{N(le=>{const z=or(le);return z.marketplaces[G].inheritFromModule=!1,z.marketplaces[G].policy="Strict compliance",z.marketplaces[G].approval="Multi-level escalation",z}),c({title:"Applied",message:"Strict marketplace overrides set.",kind:"success"})},disabled:!g.modules["E-Commerce"].enabled,children:[e.jsx(yt,{className:"h-4 w-4"})," Strict override"]})]})]})]}):null]}),e.jsxs(b4,{open:L,title:"Publish enablement changes",subtitle:"Provide a reason. This will be audit logged in production.",onClose:()=>R(!1),actions:[{label:"Publish",onClick:Fe,disabled:U.trim().length<8||!ie}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Ts,{variant:"outline",onClick:()=>R(!1),children:"Cancel"}),e.jsxs(Ts,{variant:"primary",onClick:Fe,disabled:U.trim().length<8||!ie,children:[e.jsx(ct,{className:"h-4 w-4"})," Publish"]})]}),children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Draft changes: ",e.jsx("span",{className:"font-semibold text-slate-900",children:ce}),"  Users impacted: ",e.jsx("span",{className:"font-semibold text-slate-900",children:me.changedCount})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Reason"}),e.jsx("textarea",{value:U,onChange:le=>ae(le.target.value),placeholder:"Example: enable MyLiveDealz for pilot groups; keep Finance & Payments strict; approvals routed to Finance Desk",rows:4,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"}),e.jsxs("label",{className:"mt-3 flex items-start gap-3 rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("input",{type:"checkbox",checked:ie,onChange:le=>_(le.target.checked),className:"mt-1 h-4 w-4 rounded border-slate-300"}),e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"I confirm this change is authorized and should be logged."})]}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Minimum reason length: 8 characters."})]})]}),e.jsxs(b4,{open:W,title:"Export configuration",subtitle:"Copy JSON to clipboard (demo).",onClose:()=>J(!1),actions:[{label:"Copy JSON",onClick:ke}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Ts,{variant:"outline",onClick:()=>J(!1),children:"Close"}),e.jsxs(Ts,{variant:"primary",onClick:ke,children:[e.jsx(ls,{className:"h-4 w-4"})," Copy JSON"]})]}),children:[e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-700",children:"This export includes modules, marketplaces, labels, and rollout settings."}),e.jsx("pre",{className:"mt-3 max-h-[360px] overflow-auto rounded-2xl border border-slate-200 bg-white p-3 text-xs text-slate-800",children:JSON.stringify(g,null,2)})]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"E Modules & Marketplaces Enablement v2: enablement, default mappings, risk scoring, controlled rollout, and change impact preview."})})]});function He({title:le,value:z,icon:Pe,tone:Be}){const xe=Be==="bad"?"bg-rose-50 text-rose-700":Be==="warn"?"bg-amber-50 text-amber-800":Be==="good"?"bg-emerald-50 text-emerald-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:le}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:z})]}),e.jsx("div",{className:va("grid h-10 w-10 place-items-center rounded-2xl",xe),children:Pe})]})})}function _e({title:le,value:z,icon:Pe,tone:Be}){const xe=Be==="bad"?"bg-rose-50 text-rose-700":Be==="warn"?"bg-amber-50 text-amber-800":Be==="good"?"bg-emerald-50 text-emerald-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:le}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:z})]}),e.jsx("div",{className:va("grid h-10 w-10 place-items-center rounded-2xl",xe),children:Pe})]})})}}const kd={green:"#03CD8C",orange:"#F77F00"};function Zl(...t){return t.filter(Boolean).join(" ")}function FE({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null);return d.useEffect(()=>{function n(r){l.current&&!l.current.contains(r.target)&&a(!1)}return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"flex h-8 w-8 items-center justify-center rounded-full text-slate-500 hover:bg-slate-100",children:e.jsx(xs,{className:"h-4 w-4"})}),s&&e.jsx("div",{className:"absolute right-0 top-full z-50 mt-1 w-48 origin-top-right overflow-hidden rounded-2xl border border-slate-100 bg-white p-1 shadow-lg ring-1 ring-slate-200",children:t.map((n,r)=>e.jsx("button",{onClick:()=>{n.onClick(),a(!1)},className:Zl("flex w-full items-center px-3 py-2 text-sm font-medium transition-colors hover:bg-slate-50",n.variant==="danger"?"text-rose-600":"text-slate-700"),children:n.label},r))})]})}function oV(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function dV(t,s,a){return Math.max(s,Math.min(a,t))}function nl(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function Uv(t){if(!t)return"-";const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function y4(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function _s({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Zl("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]||a.neutral),children:t})}function ds({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:kd.green}:t==="accent"?{background:kd.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Zl(i,o[t]||o.outline,n&&"cursor-not-allowed opacity-60",s),children:a})}function ih({enabled:t,onChange:s,label:a,description:l,disabled:n}){return e.jsxs("div",{className:Zl("flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",n&&"opacity-60"),children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",disabled:n,className:Zl("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white",n&&"cursor-not-allowed"),onClick:()=>!n&&s(!t),"aria-label":a,children:e.jsx("span",{className:Zl("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function oh({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",required:i,disabled:o}){const c=!!i&&!String(s||"").trim();return e.jsxs("div",{className:Zl(o&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"text-xs font-semibold text-slate-600",children:[t,i?e.jsx("span",{className:"text-rose-600",children:" *"}):null]}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,disabled:o,onChange:x=>a(x.target.value),placeholder:l,className:Zl("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold shadow-sm outline-none focus:ring-4",o?"border-slate-200 bg-slate-50 text-slate-500":c?"border-rose-300 bg-white text-slate-900 focus:ring-rose-100":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")}),c?e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:"Required"}):null]})}function Qi({label:t,value:s,onChange:a,hint:l,disabled:n}){return e.jsxs("div",{className:Zl(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",min:0,onKeyDown:r=>(r.key==="-"||r.key==="e")&&r.preventDefault(),value:s,disabled:n,onChange:r=>{const i=Number(r.target.value||0);i>=0&&a(i)},className:Zl("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold shadow-sm outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function N4({label:t,value:s,onChange:a,placeholder:l,rows:n=4,hint:r}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),r?e.jsx("div",{className:"text-xs text-slate-500",children:r}):null]}),e.jsx("textarea",{value:s,onChange:i=>a(i.target.value),placeholder:l,rows:n,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"})]})}function sd({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:Zl(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,disabled:r,onChange:i=>a(i.target.value),className:Zl("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function nm({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="900px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 bottom-4 top-4 z-50 mx-auto flex w-[min(980px,calc(100vw-2rem))] flex-col overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i,maxHeight:"92vh"},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex shrink-0 items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-1",children:[o?e.jsx(FE,{actions:o}):null,e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"shrink-0 border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function cV({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,actions:i}){return d.useEffect(()=>{const o=c=>c.key==="Escape"&&n();return t&&window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,x:16},animate:{opacity:1,x:0},exit:{opacity:0,x:16},transition:{duration:.18},className:Zl("fixed z-50 flex flex-col overflow-hidden border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]","bottom-2 left-2 right-2 top-2 rounded-[28px]","lg:bottom-4 lg:left-auto lg:right-4 lg:top-4 lg:w-[560px]"),style:{maxHeight:"calc(100vh - 32px)"},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex shrink-0 items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-base font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-1",children:[i?e.jsx(FE,{actions:i}):null,e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"shrink-0 border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function uV({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Zl("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function mV(t){return t>=70?{label:"High",tone:"bad"}:t>=40?{label:"Medium",tone:"warn"}:{label:"Low",tone:"good"}}function rm(t){const s=Number(t.policyBreaches||0),a=Number(t.anomalySignals||0),l=Number(t.spendMonth||0),n=Math.max(1,Number(t.limitMonth||1)),r=l/n;let i=8;i+=s*10,i+=a*15,i+=r>1?35:r>.85?20:r>.6?10:0,t.role==="Approver"&&(t.daysSinceApprovalAction||0)>=14&&(i+=25),t.status==="Suspended"&&(i+=10),i=dV(i,0,100);const o=mV(i);return{score:i,...o}}function w4(t){const s=Number(t.spendMonth||0),a=Math.max(1,Number(t.limitMonth||1)),l=s/a;return l>=.9?{title:"Consider raising monthly cap",body:"User consistently near cap. If legitimate, raise cap or enforce approvals above threshold.",tone:"warn",suggestedLimit:Math.round(a*1.25)}:l<=.2&&s>0?{title:"Consider lowering monthly cap",body:"Low utilization. You can tighten cap or move budget to higher-need users.",tone:"info",suggestedLimit:Math.round(a*.7)}:{title:"Limits look reasonable",body:"No recommendation based on current patterns.",tone:"good",suggestedLimit:null}}function dh(t){const s=t.split(/\r?\n/).map(n=>n.trim()).filter(Boolean);if(s.length<2)return{headers:[],rows:[]};const a=s[0].split(",").map(n=>n.trim()),l=s.slice(1).map(n=>{const r=n.split(",").map(o=>o.trim()),i={};return a.forEach((o,c)=>i[o]=r[c]||""),i});return{headers:a,rows:l}}function xV(){var Q;const t=["Org Admin","Manager","Accountant","Approver","Travel Coordinator","User"],s=["Operations","Sales","Finance","Admin","Procurement"],a=[{id:"FIN-OPS",group:"Finance",name:"Finance ops"},{id:"OPS-CORE",group:"Operations",name:"Operations core"},{id:"SALES-TRAVEL",group:"Sales",name:"Sales travel"},{id:"ADMIN-CORE",group:"Admin",name:"Admin core"},{id:"PROC-001",group:"Procurement",name:"Procurement"}],[l,n]=d.useState([]),r=O=>{const ee=oV("toast");n(F=>[{id:ee,...O},...F].slice(0,4)),window.setTimeout(()=>n(F=>F.filter(D=>D.id!==ee)),3200)},[i,o]=d.useState("All"),[c,x]=d.useState(""),[j,g]=d.useState("All"),[N,$]=d.useState("All"),[T,k]=d.useState("All"),[q,L]=d.useState(null),[R,U]=d.useState(()=>{const O=Date.now();return[{id:"U-1001",name:"Mary N.",email:"mary@acme.com",phone:"+256 700 111 111",status:"Active",role:"Manager",group:"Operations",costCenter:"OPS-CORE",autoApproval:!1,autoApproveUnder:0,limitDay:12e5,limitWeek:48e5,limitMonth:12e6,spendDay:18e4,spendWeek:132e4,spendMonth:94e5,policyBreaches:1,anomalySignals:0,daysSinceApprovalAction:999,lastActiveAt:O-2*60*60*1e3,createdAt:O-38*24*60*60*1e3,audit:[{ts:O-38*24*60*60*1e3,actor:"Org Admin",action:"Created",detail:"User created and activated"}]},{id:"U-1002",name:"Finance Desk",email:"finance@acme.com",phone:"+256 700 222 222",status:"Active",role:"Accountant",group:"Finance",costCenter:"FIN-OPS",autoApproval:!1,autoApproveUnder:0,limitDay:25e5,limitWeek:12e6,limitMonth:3e7,spendDay:42e4,spendWeek:22e5,spendMonth:82e5,policyBreaches:0,anomalySignals:0,daysSinceApprovalAction:2,lastActiveAt:O-45*60*1e3,createdAt:O-60*24*60*60*1e3,audit:[{ts:O-60*24*60*60*1e3,actor:"Org Admin",action:"Created",detail:"Finance role created"}]},{id:"U-1003",name:"John S.",email:"john@acme.com",phone:"+256 700 333 333",status:"Active",role:"User",group:"Sales",costCenter:"SALES-TRAVEL",autoApproval:!0,autoApproveUnder:2e5,limitDay:8e5,limitWeek:42e5,limitMonth:12e6,spendDay:92e3,spendWeek:76e4,spendMonth:118e5,policyBreaches:2,anomalySignals:1,daysSinceApprovalAction:999,lastActiveAt:O-15*60*1e3,createdAt:O-22*24*60*60*1e3,audit:[{ts:O-22*24*60*60*1e3,actor:"Org Admin",action:"Created",detail:"User invited and activated"},{ts:O-6*24*60*60*1e3,actor:"System",action:"Policy breach",detail:"Ride request outside hours"}]},{id:"U-1004",name:"Approver Desk",email:"approver@acme.com",phone:"+256 700 444 444",status:"Active",role:"Approver",group:"Procurement",costCenter:"PROC-001",autoApproval:!1,autoApproveUnder:0,limitDay:5e6,limitWeek:2e7,limitMonth:5e7,spendDay:0,spendWeek:0,spendMonth:0,policyBreaches:0,anomalySignals:0,daysSinceApprovalAction:21,lastActiveAt:O-22*24*60*60*1e3,createdAt:O-120*24*60*60*1e3,audit:[{ts:O-120*24*60*60*1e3,actor:"Org Admin",action:"Created",detail:"Approver role created"},{ts:O-21*24*60*60*1e3,actor:"Approver Desk",action:"Approved",detail:"Approved PO-9002"}]},{id:"U-1005",name:"New Hire",email:"newhire@acme.com",phone:"+256 700 555 555",status:"Invited",role:"User",group:"Operations",costCenter:"OPS-CORE",autoApproval:!1,autoApproveUnder:0,limitDay:6e5,limitWeek:3e6,limitMonth:8e6,spendDay:0,spendWeek:0,spendMonth:0,policyBreaches:0,anomalySignals:0,daysSinceApprovalAction:999,lastActiveAt:null,createdAt:O-2*24*60*60*1e3,audit:[{ts:O-2*24*60*60*1e3,actor:"Org Admin",action:"Invited",detail:"Invite sent"}]},{id:"U-1006",name:"Former Staff",email:"former@acme.com",phone:"+256 700 666 666",status:"Offboarded",role:"User",group:"Admin",costCenter:"ADMIN-CORE",autoApproval:!1,autoApproveUnder:0,limitDay:0,limitWeek:0,limitMonth:0,spendDay:0,spendWeek:0,spendMonth:0,policyBreaches:0,anomalySignals:0,daysSinceApprovalAction:999,lastActiveAt:O-200*24*60*60*1e3,createdAt:O-420*24*60*60*1e3,audit:[{ts:O-18*24*60*60*1e3,actor:"Org Admin",action:"Offboarded",detail:"CorporatePay revoked immediately"}]}]}),ae=d.useMemo(()=>R.filter(O=>O.role==="Approver"&&O.status==="Active").map(O=>({user:O,risk:rm(O)})).filter(O=>O.user.daysSinceApprovalAction>=14),[R]),ie=d.useMemo(()=>{const O=c.trim().toLowerCase();return R.filter(ee=>i==="All"?!0:ee.status===i).filter(ee=>j==="All"?!0:ee.group===j).filter(ee=>N==="All"?!0:ee.role===N).filter(ee=>T==="All"?!0:rm(ee).label===T).filter(ee=>O?`${ee.id} ${ee.name} ${ee.email} ${ee.phone} ${ee.status} ${ee.role} ${ee.group} ${ee.costCenter}`.toLowerCase().includes(O):!0).map(ee=>({user:ee,risk:rm(ee)}))},[R,i,c,j,N,T]),_=d.useMemo(()=>{const O={All:R.length,Invited:0,Active:0,Suspended:0,Offboarded:0};return R.forEach(ee=>{O[ee.status]=(O[ee.status]||0)+1}),O},[R]),W=d.useMemo(()=>[...R].filter(O=>O.status==="Active").sort((O,ee)=>(ee.spendMonth||0)-(O.spendMonth||0)).slice(0,5).map(O=>({user:O,suggestion:w4(O),risk:rm(O)})),[R]),[J,we]=d.useState(!1),[G,be]=d.useState({name:"",email:"",phone:"",role:"User",group:"Operations",costCenter:"OPS-CORE",autoApproval:!1,autoApproveUnder:0,limitDay:6e5,limitWeek:3e6,limitMonth:8e6,sendInviteNow:!0}),Ge=()=>{be({name:"",email:"",phone:"",role:"User",group:"Operations",costCenter:"OPS-CORE",autoApproval:!1,autoApproveUnder:0,limitDay:6e5,limitWeek:3e6,limitMonth:8e6,sendInviteNow:!0}),we(!0)},Me=()=>{if(!G.name.trim()||!G.email.trim()){r({title:"Missing fields",message:"Name and email are required.",kind:"warn"});return}const O=Date.now(),ee=`U-${Math.floor(1e3+Math.random()*9e3)}`,F=G.sendInviteNow?"Invited":"Active",D=[{ts:O,actor:"Org Admin",action:G.sendInviteNow?"Invited":"Created",detail:`Role ${G.role}, Group ${G.group}, Cost center ${G.costCenter}`}];U(m=>[{id:ee,name:G.name,email:G.email,phone:G.phone,status:F,role:G.role,group:G.group,costCenter:G.costCenter,autoApproval:G.autoApproval,autoApproveUnder:G.autoApproval?G.autoApproveUnder:0,limitDay:G.limitDay,limitWeek:G.limitWeek,limitMonth:G.limitMonth,spendDay:0,spendWeek:0,spendMonth:0,policyBreaches:0,anomalySignals:0,daysSinceApprovalAction:999,lastActiveAt:null,createdAt:O,audit:D},...m]),we(!1),r({title:"User created",message:`${ee}  ${F}`,kind:"success"})},je=d.useRef(null),[Ue,Oe]=d.useState(!1),[he,Y]=d.useState(""),[Ie,ce]=d.useState({headers:[],rows:[]}),me=d.useMemo(()=>["name,email,phone,role,group,costCenter","Jane Doe,jane@acme.com,+256700000001,User,Operations,OPS-CORE","Mark P.,mark@acme.com,+256700000002,Approver,Procurement,PROC-001"].join(`
`),[]),pe=()=>{Y(me),ce(dh(me)),Oe(!0)},de=async O=>{if(!O)return;const ee=await O.text();Y(ee),ce(dh(ee))},ye=()=>{const O=new Blob([me],{type:"text/csv"}),ee=URL.createObjectURL(O),F=document.createElement("a");F.href=ee,F.download="corporatepay-users-template.csv",F.click(),URL.revokeObjectURL(ee)},Qe=()=>{if(!Ie.rows.length){r({title:"No rows",message:"Upload or paste a CSV with at least one row.",kind:"warn"});return}const O=Date.now(),ee=Ie.rows.slice(0,50).map(F=>{const D=`U-${Math.floor(1e3+Math.random()*9e3)}`,m=(F.role||"User").trim(),A=(F.group||"Operations").trim(),f=(F.costCenter||"OPS-CORE").trim();return{id:D,name:(F.name||"Unnamed").trim(),email:(F.email||"").trim(),phone:(F.phone||"").trim(),status:"Invited",role:t.includes(m)?m:"User",group:s.includes(A)?A:"Operations",costCenter:f,autoApproval:!1,autoApproveUnder:0,limitDay:6e5,limitWeek:3e6,limitMonth:8e6,spendDay:0,spendWeek:0,spendMonth:0,policyBreaches:0,anomalySignals:0,daysSinceApprovalAction:999,lastActiveAt:null,createdAt:O,audit:[{ts:O,actor:"Org Admin",action:"Bulk invited",detail:"Imported via CSV"}]}});U(F=>[...ee,...F]),Oe(!1),r({title:"Bulk import",message:`Created ${ee.length} invited users.`,kind:"success"})},[Fe,ke]=d.useState(!1),[fe,Ve]=d.useState(null),ne=fe?rm(fe):null,[Te,Ee]=d.useState(!1),[Re,ze]=d.useState(""),[qe,He]=d.useState(!0),[_e,le]=d.useState(!1),[z,Pe]=d.useState(null),[Be,xe]=d.useState("Finance Desk"),[Ne,M]=d.useState("2026-01-21"),[H,Ae]=d.useState("Approver inactivity coverage"),oe=O=>Ve(O),De=(O,ee)=>{U(F=>F.map(D=>D.id===O?{...D,audit:[{ts:Date.now(),...ee},...D.audit||[]]}:D))},$e=O=>{if(O.status!=="Active"){r({title:"Not active",message:"Only active users can be suspended.",kind:"warn"});return}U(ee=>ee.map(F=>F.id===O.id?{...F,status:"Suspended"}:F)),De(O.id,{actor:"Org Admin",action:"Suspended",detail:"CorporatePay blocked at checkout"}),r({title:"Suspended",message:`${O.name} suspended.`,kind:"info"})},ge=O=>{if(O.status!=="Suspended"){r({title:"Not suspended",message:"User is not suspended.",kind:"warn"});return}U(ee=>ee.map(F=>F.id===O.id?{...F,status:"Active"}:F)),De(O.id,{actor:"Org Admin",action:"Reactivated",detail:"CorporatePay restored"}),r({title:"Reactivated",message:`${O.name} active again.`,kind:"success"})},ue=O=>{if(O.status!=="Invited"){r({title:"Not invited",message:"User is not in invited status.",kind:"warn"});return}De(O.id,{actor:"System",action:"Invite resent",detail:"Invite resent to email/SMS"}),r({title:"Invite resent",message:`Invite resent to ${O.email}.`,kind:"success"})},Ke=O=>{ze(""),He(!0),Ee(!0)},b=()=>{if(fe){if(Re.trim().length<8){r({title:"Reason required",message:"Provide a clear offboarding reason.",kind:"warn"});return}U(O=>O.map(ee=>ee.id!==fe.id?ee:{...ee,status:"Offboarded",limitDay:0,limitWeek:0,limitMonth:0,autoApproval:!1,autoApproveUnder:0})),De(fe.id,{actor:"Org Admin",action:"Offboarded",detail:`${qe?"CorporatePay revoked immediately":"CorporatePay revoked"}  Reason: ${Re}`}),Ee(!1),Ve(O=>O&&{...O,status:"Offboarded"}),r({title:"Offboarded",message:`${fe.name} offboarded.`,kind:"success"})}},v=O=>{Pe(O),xe("Finance Desk"),M("2026-01-21"),Ae("Approver inactivity coverage"),le(!0)},u=()=>{if(z){if(!H.trim()){r({title:"Reason required",message:"Provide a reason for delegation.",kind:"warn"});return}De(z.id,{actor:"Org Admin",action:"Delegation set",detail:`Delegated approvals to ${Be} until ${Ne}. Reason: ${H}`}),le(!1),r({title:"Delegation set",message:`${z.name} delegated to ${Be}.`,kind:"success"})}},C=["All","Invited","Active","Suspended","Offboarded"];return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(uV,{toasts:l,onDismiss:O=>n(ee=>ee.filter(F=>F.id!==O))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:kd.green},children:e.jsx(Us,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Users and Invitations"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Manage access, limits, and risk. Offboarding revokes CorporatePay instantly and preserves audit history."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(_s,{label:`Total: ${_.All}`,tone:"neutral"}),e.jsx(_s,{label:`Active: ${_.Active}`,tone:_.Active?"good":"neutral"}),e.jsx(_s,{label:`Invited: ${_.Invited}`,tone:_.Invited?"info":"neutral"}),e.jsx(_s,{label:`Suspended: ${_.Suspended}`,tone:_.Suspended?"warn":"neutral"}),e.jsx(_s,{label:`Offboarded: ${_.Offboarded}`,tone:(_.Offboarded,"neutral")})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ds,{variant:"outline",onClick:pe,children:[e.jsx(g0,{className:"h-4 w-4"})," Bulk import"]}),e.jsxs(ds,{variant:"outline",onClick:()=>ke(!0),children:[e.jsx(Xl,{className:"h-4 w-4"})," HRIS import"]}),e.jsxs(ds,{variant:"primary",onClick:Ge,children:[e.jsx(wv,{className:"h-4 w-4"})," Add user"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:C.map(O=>e.jsxs("button",{type:"button",onClick:()=>o(O),className:Zl("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",i===O?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:i===O?{background:kd.green}:void 0,children:[O," ",O==="All"?`(${_.All})`:`(${_[O]||0})`]},O))}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-4",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsxs("div",{className:"mt-1 flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-2 py-2",children:[e.jsx(ka,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:c,onChange:O=>x(O.target.value),placeholder:"Name, email, ID, group...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"})]})]}),e.jsx(sd,{label:"Group",value:j,onChange:g,options:[{value:"All",label:"All"},...s.map(O=>({value:O,label:O}))]}),e.jsx(sd,{label:"Role",value:N,onChange:$,options:[{value:"All",label:"All"},...t.map(O=>({value:O,label:O}))]}),e.jsx(sd,{label:"Risk",value:T,onChange:k,options:[{value:"All",label:"All"},{value:"Low",label:"Low"},{value:"Medium",label:"Medium"},{value:"High",label:"High"}],hint:"Premium"})]})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 mb-6",children:[ae.length?e.jsxs("div",{className:"rounded-3xl border border-amber-200 bg-amber-50 p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Delegation needed"}),e.jsx("div",{className:"mt-1 text-xs text-slate-700",children:"Approver inactivity detected. Set a delegate to avoid approval bottlenecks."})]}),e.jsx(_s,{label:"Premium",tone:"info"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:ae.slice(0,2).map(O=>e.jsx("div",{className:"rounded-2xl border border-amber-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:O.user.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Inactive approvals: ",O.user.daysSinceApprovalAction," days  Risk: ",O.risk.label]})]}),e.jsxs(ds,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>v(O.user),children:[e.jsx(et,{className:"h-4 w-4"})," Set delegate"]})]})},O.user.id))}),e.jsx("div",{className:"mt-3 text-xs text-slate-700",children:"This creates an audit log entry and routes approvals to a delegate."})]}):e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Approvals health"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"No inactive approvers detected in this demo."})]}),e.jsx(_s,{label:"OK",tone:"good"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: delegation prompts appear when an approver is inactive or SLA breaches spike."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Top spenders"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium insights and limit suggestions"})]}),e.jsx(_s,{label:"Premium",tone:"info"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:W.map(O=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("button",{className:"min-w-0 text-left",onClick:()=>oe(O.user),children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:O.user.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[O.user.group,"  ",O.user.role]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-700",children:["Spend: ",e.jsx("span",{className:"font-semibold text-slate-900",children:nl(O.user.spendMonth)})," / ",nl(O.user.limitMonth)]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsx(_s,{label:O.risk.label,tone:O.risk.tone}),e.jsx(_s,{label:O.suggestion.title,tone:O.suggestion.tone})]})]}),O.suggestion.suggestedLimit?e.jsxs("div",{className:"mt-2 flex flex-wrap items-center justify-between gap-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsxs("div",{children:["Suggested monthly cap: ",e.jsx("span",{className:"font-semibold text-slate-900",children:nl(O.suggestion.suggestedLimit)})]}),e.jsxs(ds,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{U(ee=>ee.map(F=>F.id===O.user.id?{...F,limitMonth:O.suggestion.suggestedLimit}:F)),De(O.user.id,{actor:"Org Admin",action:"Limit adjusted",detail:`Monthly cap set to ${nl(O.suggestion.suggestedLimit)}`}),r({title:"Applied",message:"Limit suggestion applied (demo).",kind:"success"})},children:[e.jsx(ht,{className:"h-4 w-4"})," Apply"]})]}):e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:O.suggestion.body})]},O.user.id))})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Onboarding tools"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"CSV bulk import and HRIS (Phase 2)"})]}),e.jsx(_s,{label:"Core",tone:"neutral"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2",children:[e.jsxs(ds,{variant:"outline",onClick:pe,children:[e.jsx(g0,{className:"h-4 w-4"})," Bulk import CSV"]}),e.jsxs(ds,{variant:"outline",onClick:()=>ke(!0),children:[e.jsx(Xl,{className:"h-4 w-4"})," HRIS import (Phase 2)"]})]})]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-3 border-b border-slate-200 px-4 py-3 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Users"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Click a row to open details and audit history."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ds,{variant:"outline",className:"text-xs",onClick:()=>{x(""),g("All"),$("All"),k("All"),r({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(Ye,{className:"h-4 w-4"})," Reset filters"]}),e.jsxs(ds,{variant:"primary",className:"text-xs",onClick:Ge,children:[e.jsx(wv,{className:"h-4 w-4"})," Add user"]})]})]}),e.jsx("div",{className:"hidden md:block",children:e.jsxs("table",{className:"w-full text-left text-sm table-fixed",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold w-[18%]",children:"User"}),e.jsx("th",{className:"px-4 py-3 font-semibold w-[10%]",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold w-[10%]",children:"Role"}),e.jsx("th",{className:"px-4 py-3 font-semibold w-[10%]",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold w-[10%]",children:"Risk"}),e.jsx("th",{className:"px-4 py-3 font-semibold w-[16%]",children:"Spend MTD"}),e.jsx("th",{className:"px-4 py-3 font-semibold w-[10%]",children:"Auto-approve"}),e.jsx("th",{className:"px-4 py-3 font-semibold w-[10%]",children:"Last active"}),e.jsx("th",{className:"px-4 py-3 font-semibold w-[6%]",children:"Actions"})]})}),e.jsxs("tbody",{children:[ie.map(({user:O,risk:ee})=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("button",{className:"text-left truncate max-w-full",onClick:()=>oe(O),children:[e.jsx("div",{className:"font-semibold text-slate-900 truncate",children:O.name}),e.jsx("div",{className:"mt-1 text-xs text-slate-500 truncate",children:O.email})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(_s,{label:O.status,tone:O.status==="Active"?"good":O.status==="Invited"?"info":O.status==="Suspended"?"warn":"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700 truncate",children:O.role}),e.jsx("td",{className:"px-4 py-3 text-slate-700 truncate",children:O.group}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(_s,{label:`${ee.label}`,tone:ee.tone})}),e.jsxs("td",{className:"px-4 py-3 text-slate-700 text-xs",children:[nl(O.spendMonth)," / ",nl(O.limitMonth)]}),e.jsx("td",{className:"px-4 py-3",children:O.autoApproval?e.jsx(_s,{label:"Yes",tone:"info"}):e.jsx(_s,{label:"No",tone:"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700 text-xs",children:O.lastActiveAt?Uv(O.lastActiveAt):"-"}),e.jsxs("td",{className:"px-4 py-3 relative",children:[e.jsx("button",{onClick:F=>{F.stopPropagation(),L(q===O.id?null:O.id)},className:"p-1.5 text-slate-500 hover:bg-slate-100 rounded-full transition-colors",children:e.jsx(xs,{className:"h-4 w-4"})}),e.jsx(lt,{children:q===O.id&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>L(null)}),e.jsxs(We.div,{initial:{opacity:0,scale:.95,y:-5},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-5},className:"absolute right-8 top-1/2 -translate-y-1/2 z-20 w-36 bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden",children:[e.jsxs("button",{className:"w-full text-left px-3 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-50 flex items-center gap-2",onClick:()=>{oe(O),L(null)},children:[e.jsx(et,{className:"h-3 w-3"})," Open details"]}),O.status==="Invited"&&e.jsxs("button",{className:"w-full text-left px-3 py-2 text-xs font-semibold text-blue-600 hover:bg-blue-50 flex items-center gap-2",onClick:()=>{ue(O),L(null)},children:[e.jsx(Xs,{className:"h-3 w-3"})," Resend invite"]}),O.status==="Active"&&e.jsxs("button",{className:"w-full text-left px-3 py-2 text-xs font-semibold text-amber-600 hover:bg-amber-50 flex items-center gap-2",onClick:()=>{$e(O),L(null)},children:[e.jsx(yt,{className:"h-3 w-3"})," Suspend"]}),O.status==="Suspended"&&e.jsxs("button",{className:"w-full text-left px-3 py-2 text-xs font-semibold text-emerald-600 hover:bg-emerald-50 flex items-center gap-2",onClick:()=>{ge(O),L(null)},children:[e.jsx(tt,{className:"h-3 w-3"})," Reactivate"]})]})]})})]})]},O.id)),ie.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-4 py-12",children:e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(Us,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No users found"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Try adjusting filters or search."})]})})})]})]})}),e.jsxs("div",{className:"space-y-3 p-4 md:hidden",children:[ie.map(({user:O,risk:ee})=>e.jsxs("button",{type:"button",onClick:()=>oe(O),className:"w-full rounded-3xl border border-slate-200 bg-white p-4 text-left",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:O.name}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:O.email}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(_s,{label:O.status,tone:O.status==="Active"?"good":O.status==="Invited"?"info":O.status==="Suspended"?"warn":"neutral"}),e.jsx(_s,{label:O.group,tone:"neutral"}),e.jsx(_s,{label:O.role,tone:"neutral"}),e.jsx(_s,{label:`${ee.label} (${ee.score})`,tone:ee.tone})]})]}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Spend: ",nl(O.spendMonth)," / ",nl(O.limitMonth)]})]},O.id)),ie.length?null:e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(Us,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No users found"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Try adjusting filters or add a user."})]})]}),e.jsx("div",{className:"border-t border-slate-200 px-4 py-3 text-xs text-slate-500",children:"Premium: risk scoring is explainable and based on policy breaches, anomalies, utilization, and approver inactivity."})]})}),e.jsx("div",{className:"mt-4 text-xs text-slate-500",children:"F Users & Invitations v2: add users with role/group/cost center, auto-approval eligibility, spend limits, bulk CSV import, HRIS (phase 2), offboarding workflow, risk scoring, top spenders insights, and delegation prompts."})]})]})}),e.jsx(nm,{open:J,title:"Add user",subtitle:"Create a user, set role, group, cost center, spend limits, and auto-approval eligibility.",onClose:()=>we(!1),actions:[{label:"Cancel",onClick:()=>we(!1),variant:"outline"},{label:"Preview invite",onClick:()=>r({title:"Preview",message:"Preview invite message (demo).",kind:"info"}),variant:"outline"},{label:"Create",onClick:Me,variant:"default"}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(ds,{variant:"outline",onClick:()=>we(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ds,{variant:"outline",onClick:()=>r({title:"Preview",message:"Preview invite message (demo).",kind:"info"}),children:[e.jsx(Xs,{className:"h-4 w-4"})," Preview invite"]}),e.jsxs(ds,{variant:"primary",onClick:Me,children:[e.jsx(wv,{className:"h-4 w-4"})," Create"]})]})]}),maxW:"980px",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Identity"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(oh,{label:"Full name",required:!0,value:G.name,onChange:O=>be(ee=>({...ee,name:O})),placeholder:"Full name"}),e.jsx(oh,{label:"Email",required:!0,value:G.email,onChange:O=>be(ee=>({...ee,email:O})),placeholder:"name@company.com"}),e.jsx(oh,{label:"Phone",value:G.phone,onChange:O=>be(ee=>({...ee,phone:O})),placeholder:"+256..."}),e.jsx(sd,{label:"Role",value:G.role,onChange:O=>be(ee=>({...ee,role:O})),options:t.map(O=>({value:O,label:O}))}),e.jsx(sd,{label:"Group",value:G.group,onChange:O=>{var F;const ee=((F=a.find(D=>D.group===O))==null?void 0:F.id)||"OPS-CORE";be(D=>({...D,group:O,costCenter:ee}))},options:s.map(O=>({value:O,label:O}))}),e.jsx(sd,{label:"Cost center",value:G.costCenter,onChange:O=>be(ee=>({...ee,costCenter:O})),options:a.filter(O=>O.group===G.group).map(O=>({value:O.id,label:`${O.id} - ${O.name}`}))})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Spend limits"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Daily, weekly, monthly caps for CorporatePay."})]}),e.jsx(_s,{label:"Core",tone:"neutral"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(Qi,{label:"Daily cap (UGX)",value:G.limitDay,onChange:O=>be(ee=>({...ee,limitDay:O})),hint:nl(G.limitDay)}),e.jsx(Qi,{label:"Weekly cap (UGX)",value:G.limitWeek,onChange:O=>be(ee=>({...ee,limitWeek:O})),hint:nl(G.limitWeek)}),e.jsx(Qi,{label:"Monthly cap (UGX)",value:G.limitMonth,onChange:O=>be(ee=>({...ee,limitMonth:O})),hint:nl(G.limitMonth)})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: limits can be suggested automatically based on peer usage."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Auto-approval eligibility"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Set by the admin creating this user."})]}),e.jsx(_s,{label:"Core",tone:"neutral"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(ih,{enabled:G.autoApproval,onChange:O=>be(ee=>({...ee,autoApproval:O})),label:"Allow auto-approval",description:"If on, transactions under the threshold can auto-approve."}),e.jsx(Qi,{label:"Auto-approve under (UGX)",value:G.autoApproveUnder,onChange:O=>be(ee=>({...ee,autoApproveUnder:O})),hint:"Requires allow toggle",disabled:!G.autoApproval})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Best practice: auto-approval should be disabled for high-risk roles or high-value marketplaces."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Invite"}),e.jsxs("div",{className:"mt-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Create as:",e.jsxs("ul",{className:"mt-2 space-y-1 text-xs text-slate-600",children:[e.jsx("li",{children:"1) Invited (recommended) or"}),e.jsx("li",{children:"2) Active immediately (for admins)"})]})]}),e.jsx(ih,{enabled:G.sendInviteNow,onChange:O=>be(ee=>({...ee,sendInviteNow:O})),label:G.sendInviteNow?"Send invite now":"Activate immediately",description:"Invite acceptance happens on X3."}),e.jsx("div",{className:"mt-3 text-xs text-slate-500",children:"In production, invite delivery logs appear in Notifications Center."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Audit preview"}),e.jsx("pre",{className:"mt-3 max-h-[260px] overflow-auto rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-800",children:JSON.stringify({action:"Create user",actor:"Org Admin",role:G.role,group:G.group,costCenter:G.costCenter,limits:{daily:G.limitDay,weekly:G.limitWeek,monthly:G.limitMonth},autoApproval:G.autoApproval?{eligible:!0,under:G.autoApproveUnder}:{eligible:!1},status:G.sendInviteNow?"Invited":"Active"},null,2)}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"This would be stored in the audit log (immutable in production)."})]})]})]})}),e.jsx(nm,{open:Ue,title:"Bulk import users",subtitle:"Upload a CSV or paste contents. Users are created as Invited by default.",onClose:()=>Oe(!1),actions:[{label:"Cancel",onClick:()=>Oe(!1),variant:"outline"},{label:"Download template",onClick:ye,variant:"outline"},{label:"Import",onClick:Qe,variant:"default"}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(ds,{variant:"outline",onClick:()=>Oe(!1),children:"Close"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ds,{variant:"outline",onClick:ye,children:[e.jsx(gt,{className:"h-4 w-4"})," Download template"]}),e.jsxs(ds,{variant:"primary",onClick:Qe,children:[e.jsx(g0,{className:"h-4 w-4"})," Import"]})]})]}),maxW:"980px",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"CSV"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Header: name,email,phone,role,group,costCenter"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{ref:je,type:"file",accept:".csv,text/csv",className:"hidden",onChange:O=>{var ee;return de(((ee=O.target.files)==null?void 0:ee[0])||null)}}),e.jsxs(ds,{variant:"outline",onClick:()=>{var O;return(O=je.current)==null?void 0:O.click()},children:[e.jsx(pt,{className:"h-4 w-4"})," Upload"]}),e.jsxs(ds,{variant:"outline",onClick:()=>{ce(dh(he)),r({title:"Parsed",message:"Preview refreshed.",kind:"success"})},children:[e.jsx(tt,{className:"h-4 w-4"})," Parse"]})]})]}),e.jsx("textarea",{value:he,onChange:O=>{Y(O.target.value),ce(dh(O.target.value))},rows:10,className:"mt-3 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Preview"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Showing up to 10 rows"}),e.jsx("div",{className:"mt-3 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsx("tr",{children:(Ie.headers.length?Ie.headers:["name","email","phone","role","group","costCenter"]).map(O=>e.jsx("th",{className:"px-4 py-3 font-semibold",children:O},O))})}),e.jsxs("tbody",{children:[Ie.rows.slice(0,10).map((O,ee)=>e.jsx("tr",{className:"border-t border-slate-100",children:(Ie.headers.length?Ie.headers:["name","email","phone","role","group","costCenter"]).map(F=>e.jsx("td",{className:"px-4 py-3 text-slate-700",children:O[F]||""},F))},ee)),Ie.rows.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No rows parsed."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Imported users are created as Invited by default. Admin can set initial limits later."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Bulk import rules"}),e.jsxs("ul",{className:"mt-2 space-y-2 text-sm text-slate-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:kd.green}})," Max 50 users per import (demo)"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:kd.orange}})," Invalid roles default to User"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:kd.green}})," All actions are audit logged"]})]})]}),e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-amber-50 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-white text-amber-800 ring-1 ring-amber-200",children:e.jsx(Mt,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"HRIS import (Phase 2)"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:"Workday/BambooHR/Microsoft Entra sync can be added later."})]})]})})]})]})}),e.jsx(nm,{open:Fe,title:"HRIS import",subtitle:"Phase 2: sync users and groups from HRIS.",onClose:()=>ke(!1),actions:[{label:"Close",onClick:()=>ke(!1),variant:"outline"}],footer:e.jsx("div",{className:"flex justify-end",children:e.jsx(ds,{variant:"outline",onClick:()=>ke(!1),children:"Close"})}),maxW:"860px",children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Connect HRIS"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Planned: SSO + HRIS to provision users automatically."})]}),e.jsx(_s,{label:"Phase 2",tone:"info"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs(ds,{variant:"outline",onClick:()=>r({title:"Workday",message:"Connector coming in Phase 2.",kind:"info"}),children:[e.jsx(Xl,{className:"h-4 w-4"})," Workday"]}),e.jsxs(ds,{variant:"outline",onClick:()=>r({title:"BambooHR",message:"Connector coming in Phase 2.",kind:"info"}),children:[e.jsx(Xl,{className:"h-4 w-4"})," BambooHR"]}),e.jsxs(ds,{variant:"outline",onClick:()=>r({title:"Entra",message:"Connector coming in Phase 2.",kind:"info"}),children:[e.jsx(yt,{className:"h-4 w-4"})," Microsoft Entra"]}),e.jsxs(ds,{variant:"outline",onClick:()=>r({title:"CSV sync",message:"Scheduled CSV sync (Phase 2).",kind:"info"}),children:[e.jsx(wt,{className:"h-4 w-4"})," Scheduled CSV sync"]})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: HRIS rules can auto-assign group, role, and default limits (see X3 JIT provisioning)."})]})}),e.jsx(cV,{open:!!fe,title:fe?fe.name:"",subtitle:fe?`${fe.email}  ${fe.id}`:"",onClose:()=>{Ve(null),Ee(!1)},actions:fe?[...fe.status==="Invited"?[{label:"Resend invite",onClick:()=>ue(fe),variant:"outline"}]:[],...fe.status==="Active"?[{label:"Suspend",onClick:()=>$e(fe),variant:"outline"}]:[],...fe.status==="Suspended"?[{label:"Reactivate",onClick:()=>ge(fe),variant:"outline"}]:[],...fe.status!=="Offboarded"?[{label:"Offboard",onClick:()=>Ke(),variant:"danger"}]:[]]:[],footer:fe?e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Status: ",fe.status,"  Group: ",fe.group]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[fe.status==="Invited"?e.jsxs(ds,{variant:"outline",onClick:()=>ue(fe),children:[e.jsx(Xs,{className:"h-4 w-4"})," Resend invite"]}):null,fe.status==="Active"?e.jsxs(ds,{variant:"outline",onClick:()=>$e(fe),children:[e.jsx(yt,{className:"h-4 w-4"})," Suspend"]}):null,fe.status==="Suspended"?e.jsxs(ds,{variant:"outline",onClick:()=>ge(fe),children:[e.jsx(tt,{className:"h-4 w-4"})," Reactivate"]}):null,fe.status!=="Offboarded"?e.jsxs(ds,{variant:"danger",onClick:()=>Ke(),children:[e.jsx(as,{className:"h-4 w-4"})," Offboard"]}):null]})]}):null,children:fe?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Overview"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"User settings and risk"})]}),ne?e.jsx(_s,{label:`Risk: ${ne.label} (${ne.score})`,tone:ne.tone}):null]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(ch,{label:"Role",value:fe.role}),e.jsx(ch,{label:"Group",value:fe.group}),e.jsx(ch,{label:"Cost center",value:fe.costCenter}),e.jsx(ch,{label:"Last active",value:fe.lastActiveAt?`${y4(fe.lastActiveAt)} (${Uv(fe.lastActiveAt)})`:"-"})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Spend month-to-date: ",e.jsx("span",{className:"font-semibold text-slate-900",children:nl(fe.spendMonth)})," / ",nl(fe.limitMonth)]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Limits"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx(Qi,{label:"Daily cap",value:fe.limitDay,onChange:O=>{U(ee=>ee.map(F=>F.id===fe.id?{...F,limitDay:O}:F)),Ve(ee=>ee?{...ee,limitDay:O}:null)},hint:nl(fe.limitDay),disabled:fe.status==="Offboarded"}),e.jsx(Qi,{label:"Weekly cap",value:fe.limitWeek,onChange:O=>{U(ee=>ee.map(F=>F.id===fe.id?{...F,limitWeek:O}:F)),Ve(ee=>ee?{...ee,limitWeek:O}:null)},hint:nl(fe.limitWeek),disabled:fe.status==="Offboarded"}),e.jsx(Qi,{label:"Monthly cap",value:fe.limitMonth,onChange:O=>{U(ee=>ee.map(F=>F.id===fe.id?{...F,limitMonth:O}:F)),Ve(ee=>ee?{...ee,limitMonth:O}:null)},hint:nl(fe.limitMonth),disabled:fe.status==="Offboarded"})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(ds,{variant:"outline",onClick:()=>{De(fe.id,{actor:"Org Admin",action:"Limits updated",detail:"Updated spend limits"}),r({title:"Saved",message:"Limits saved (demo).",kind:"success"})},children:[e.jsx(Ia,{className:"h-4 w-4"})," Save limits"]}),e.jsxs(ds,{variant:"outline",onClick:()=>{const O=w4(fe);if(!O.suggestedLimit){r({title:"No suggestion",message:"No limit change recommended.",kind:"info"});return}U(ee=>ee.map(F=>F.id===fe.id?{...F,limitMonth:O.suggestedLimit}:F)),Ve(ee=>ee?{...ee,limitMonth:O.suggestedLimit}:null),De(fe.id,{actor:"System",action:"Suggestion applied",detail:`Monthly cap set to ${nl(O.suggestedLimit)}`}),r({title:"Applied",message:"Suggestion applied.",kind:"success"})},children:[e.jsx(ht,{className:"h-4 w-4"})," Apply suggestion"]})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Auto-approval"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Set by admin. Use carefully."})]}),e.jsx(_s,{label:fe.autoApproval?"Enabled":"Off",tone:fe.autoApproval?"info":"neutral"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(ih,{enabled:!!fe.autoApproval,onChange:O=>{U(ee=>ee.map(F=>F.id===fe.id?{...F,autoApproval:O,autoApproveUnder:O?F.autoApproveUnder:0}:F)),Ve(ee=>ee?{...ee,autoApproval:O,autoApproveUnder:O?ee.autoApproveUnder:0}:null)},label:"Allow auto-approval",description:"Auto-approve under threshold",disabled:fe.status==="Offboarded"}),e.jsx(Qi,{label:"Auto-approve under",value:fe.autoApproveUnder,onChange:O=>{U(ee=>ee.map(F=>F.id===fe.id?{...F,autoApproveUnder:O}:F)),Ve(ee=>ee?{...ee,autoApproveUnder:O}:null)},hint:nl(fe.autoApproveUnder),disabled:!fe.autoApproval||fe.status==="Offboarded"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Auto-approval should be disabled for high-risk users or when anomalies occur."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Audit log"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"All changes are recorded (immutable in production)."}),e.jsxs("div",{className:"mt-3 space-y-2",children:[(fe.audit||[]).slice(0,10).map((O,ee)=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:O.action}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[O.actor,"  ",y4(O.ts)]}),e.jsx("div",{className:"mt-1 text-xs text-slate-700",children:O.detail})]}),e.jsx(_s,{label:Uv(O.ts),tone:"neutral"})]})},ee)),(Q=fe.audit)!=null&&Q.length?null:e.jsx("div",{className:"text-sm text-slate-600",children:"No audit entries."})]})]})]}):null}),e.jsx(nm,{open:Te,title:"Offboard user",subtitle:"Revokes CorporatePay instantly and preserves audit history.",onClose:()=>Ee(!1),actions:[{label:"Cancel",onClick:()=>Ee(!1),variant:"outline"},{label:"Confirm offboard",onClick:b,variant:"danger"}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(ds,{variant:"outline",onClick:()=>Ee(!1),children:"Cancel"}),e.jsxs(ds,{variant:"danger",onClick:b,children:[e.jsx(as,{className:"h-4 w-4"})," Confirm offboard"]})]}),maxW:"860px",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Offboarding immediately blocks CorporatePay at checkout for this user."}),e.jsx(ih,{enabled:qe,onChange:He,label:"Revoke CorporatePay immediately",description:"Recommended"}),e.jsx(N4,{label:"Reason",value:Re,onChange:ze,placeholder:"Example: employee left the company; access revoked",rows:4,hint:"Minimum 8 characters"}),e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Audit logs remain visible to admins. Offboarded users can be reinstated by re-inviting."})]})}),e.jsx(nm,{open:_e,title:"Set approver delegation",subtitle:"Route approvals to a delegate when the approver is inactive.",onClose:()=>le(!1),actions:[{label:"Cancel",onClick:()=>le(!1),variant:"outline"},{label:"Save delegation",onClick:u,variant:"default"}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(ds,{variant:"outline",onClick:()=>le(!1),children:"Cancel"}),e.jsxs(ds,{variant:"primary",onClick:u,children:[e.jsx(ct,{className:"h-4 w-4"})," Save delegation"]})]}),maxW:"920px",children:e.jsxs("div",{className:"space-y-4",children:[z?e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Approver: ",e.jsx("span",{className:"font-semibold text-slate-900",children:z.name}),"  ",z.id]}):null,e.jsx(sd,{label:"Delegate to",value:Be,onChange:xe,options:["Finance Desk","Org Admin","Procurement Desk"].map(O=>({value:O,label:O}))}),e.jsx(oh,{label:"Delegation until",value:Ne,onChange:M,placeholder:"YYYY-MM-DD",hint:"Date"}),e.jsx(N4,{label:"Reason",value:H,onChange:Ae,placeholder:"Reason",rows:3}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: delegation rules integrate with Approval Workflow Builder (J) and Approvals Inbox (K)."})]})}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"F Users & Invitations v2: users list, add user, bulk import, HRIS placeholder, offboarding workflow, risk scoring, top spenders insights, and delegation prompts."})})]})}function ch({label:t,value:s}){return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:s})]})}const yr={green:"#03CD8C",orange:"#F77F00"};function rn(...t){return t.filter(Boolean).join(" ")}function uh(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function pV(t,s,a){return Math.max(s,Math.min(a,t))}function rl(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function mh(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function Wt({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:rn("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function ts({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:yr.green}:t==="accent"?{background:yr.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:rn(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function hV({actions:t=[]}){const[s,a]=d.useState(!1);return t.length?e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>a(!s),className:"grid h-8 w-8 place-items-center rounded-full text-slate-500 hover:bg-slate-100",children:e.jsx(xs,{className:"h-5 w-5"})}),s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-50",onClick:()=>a(!1)}),e.jsx("div",{className:"absolute right-0 top-full z-50 mt-1 w-48 overflow-hidden rounded-xl border border-slate-200 bg-white shadow-xl",children:t.map((l,n)=>e.jsx("button",{onClick:()=>{l.onClick(),a(!1)},className:rn("block w-full px-4 py-2.5 text-left text-sm font-medium hover:bg-slate-50",l.variant==="danger"?"text-rose-600":"text-slate-700"),children:l.label},n))})]}):null]}):null}function im({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,actions:i,maxW:o="920px"}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[8vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:o},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(hV,{actions:i}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function gV({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:rn("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="warn"||a.kind==="error"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function k4({values:t}){var o;const l=Math.max(1,...t),n=Math.min(...t),r=Math.max(1,l-n),i=t.map((c,x)=>{const j=x/Math.max(1,t.length-1)*132+4,g=38-(c-n)/r*32;return`${j.toFixed(1)},${g.toFixed(1)}`}).join(" ");return e.jsxs("svg",{width:140,height:44,className:"overflow-visible",children:[e.jsx("polyline",{points:i,fill:"none",stroke:yr.green,strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("circle",{cx:136,cy:Number(((o=i.split(" ").pop())==null?void 0:o.split(",")[1])||44/2),r:3.5,fill:yr.orange})]})}function Vv({label:t,value:s,total:a,hint:l}){const n=pV(s/Math.max(1,a)*100,0,100);return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-700",children:t}),e.jsx("div",{className:"text-xs font-semibold text-slate-900",children:l??`${Math.round(n)}%`})]}),e.jsx("div",{className:"mt-2 h-2 w-full overflow-hidden rounded-full bg-slate-100",children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${n}%`,background:yr.green}})})]})}function oc(t){return Math.round(t.reduce((s,a)=>s+Number(a.percent||0),0))}function om(t,s,a){return Math.round(t/Math.max(1,s)*a)}function dc(t,s){return t>s?{label:"Over",tone:"bad"}:t>s*.9?{label:"At risk",tone:"warn"}:{label:"OK",tone:"good"}}function fV(t,s){return s<=0?t>0?100:0:(t-s)/s*100}function _v(t){const s=Object.keys(t.weeklyBreakdown),a=t.weeklySeries[t.weeklySeries.length-1]||0,l=t.weeklySeries[t.weeklySeries.length-2]||0,n=fV(a,l);let r="Rides",i=-1/0;for(const g of s){const N=t.weeklyBreakdown[g],$=N[N.length-1]||0,T=N[N.length-2]||0,k=$-T;k>i&&(i=k,r=g)}const o={Rides:"Ride volume and airport routes",Purchases:"Marketplace purchases and vendor activity",Services:"Service bookings and add-ons",RFQs:"High-value RFQs and procurement cycles"},c=n>=0?"up":"down",x=Math.abs(n),j=Math.round(x);return{title:`Week over week is ${c} ${j}%`,body:`Main driver: ${r}. ${o[String(r)]}.`,tone:n>15?"warn":n<-15?"good":"neutral"}}function vV(){var D;const[a,l]=d.useState([]),n=m=>{const A=uh("toast");l(f=>[{id:A,...m},...f].slice(0,4)),window.setTimeout(()=>l(f=>f.filter(B=>B.id!==A)),3200)},[r,i]=d.useState("Groups"),[o,c]=d.useState(()=>{const m=Date.now(),A=(f,B,p,E,se,y,re,ve,P,X,S)=>({id:f,budgetMonth:B,spendMTD:p,hardCap:E,priority:se,manager:y,updatedAt:m-Math.floor(Math.random()*6)*24*60*60*1e3,weeklySeries:re,weeklyBreakdown:{Rides:ve,Purchases:P,Services:X,RFQs:S}});return[A("Operations",15e6,12e6,!0,1,"Mary N.",[36e5,39e5,41e5,44e5,52e5,56e5],[18e5,19e5,2e6,22e5,24e5,26e5],[12e5,13e5,14e5,15e5,17e5,19e5],[25e4,26e4,3e5,31e4,35e4,42e4],[35e4,44e4,4e5,39e4,45e4,51e4]),A("Sales",12e6,98e5,!0,2,"Samuel A.",[22e5,25e5,27e5,3e6,36e5,41e5],[12e5,13e5,14e5,15e5,17e5,19e5],[8e5,9e5,95e4,11e5,14e5,16e5],[14e4,15e4,16e4,18e4,26e4,28e4],[6e4,7e4,9e4,11e4,24e4,32e4]),A("Finance",6e6,52e5,!0,3,"Finance Desk",[11e5,12e5,125e4,13e5,15e5,165e4],[24e4,26e4,28e4,3e5,36e4,38e4],[52e4,54e4,56e4,59e4,62e4,74e4],[12e4,14e4,15e4,16e4,18e4,2e5],[22e4,26e4,26e4,25e4,34e4,37e4]),A("Admin",5e6,41e5,!1,4,"Admin Team",[9e5,95e4,98e4,102e4,11e5,118e4],[19e4,2e5,21e4,22e4,24e4,28e4],[42e4,45e4,46e4,47e4,52e4,56e4],[12e4,14e4,14e4,15e4,16e4,17e4],[17e4,16e4,17e4,18e4,18e4,17e4]),A("Procurement",5e6,34e5,!1,5,"Procurement Desk",[72e4,76e4,79e4,82e4,88e4,92e4],[1e5,12e4,13e4,14e4,15e4,16e4],[32e4,34e4,35e4,36e4,38e4,4e5],[8e4,9e4,11e4,12e4,14e4,15e4],[22e4,21e4,2e5,2e5,21e4,21e4])]}),[x,j]=d.useState(()=>{const m=Date.now();return[{id:"CC-OPS-CORE",code:"OPS-CORE",name:"Operations core",group:"Operations",active:!0,defaultTags:["Event: FieldOps"],invoiceGroup:"ACME-MAIN",updatedAt:m-12*24*60*60*1e3},{id:"CC-OPS-DEL",code:"OPS-DELIVERY",name:"Courier and delivery",group:"Operations",active:!0,defaultTags:["Campaign: QuickShip"],invoiceGroup:"ACME-MAIN",updatedAt:m-7*24*60*60*1e3},{id:"CC-SALES-TR",code:"SALES-TRAVEL",name:"Sales travel",group:"Sales",active:!0,defaultTags:["Client: ABC"],invoiceGroup:"ACME-SALES",updatedAt:m-20*24*60*60*1e3},{id:"CC-FIN-OPS",code:"FIN-OPS",name:"Finance ops",group:"Finance",active:!0,defaultTags:["Project: Audit-2026"],invoiceGroup:"ACME-MAIN",updatedAt:m-16*24*60*60*1e3},{id:"CC-ADMIN-CORE",code:"ADMIN-CORE",name:"Admin core",group:"Admin",active:!0,defaultTags:["Event: Conference"],invoiceGroup:"ACME-MAIN",updatedAt:m-35*24*60*60*1e3},{id:"CC-PROC-001",code:"PROC-001",name:"Procurement",group:"Procurement",active:!0,defaultTags:["Campaign: VendorOnboarding"],invoiceGroup:"ACME-MAIN",updatedAt:m-10*24*60*60*1e3}]}),[g,N]=d.useState(()=>{const m=Date.now();return[{id:"T-CL-ABC",type:"Client",key:"ABC",label:"Client ABC Ltd",active:!0,updatedAt:m-30*24*60*60*1e3},{id:"T-EV-EXPO",type:"Event",key:"Expo2026",label:"Expo 2026",active:!0,updatedAt:m-4*24*60*60*1e3},{id:"T-CM-Q1",type:"Campaign",key:"Q1Launch",label:"Q1 Launch",active:!0,updatedAt:m-8*24*60*60*1e3},{id:"T-PJ-AUD",type:"Project",key:"Audit-2026",label:"Audit 2026",active:!0,updatedAt:m-18*24*60*60*1e3},{id:"T-OT-OPS",type:"Other",key:"FieldOps",label:"Field operations",active:!0,updatedAt:m-12*24*60*60*1e3}]}),[$,T]=d.useState(()=>{const m=Date.now();return[{id:"CB-001",name:"Client ABC meetings",enabled:!0,priority:1,match:{type:"Client",key:"ABC"},splits:[{costCenterId:"CC-SALES-TR",percent:70},{costCenterId:"CC-OPS-CORE",percent:30}],notes:"Split customer-facing travel between Sales and Operations.",updatedAt:m-9*24*60*60*1e3},{id:"CB-002",name:"Expo 2026 event",enabled:!0,priority:2,match:{type:"Event",key:"Expo2026"},splits:[{costCenterId:"CC-ADMIN-CORE",percent:100}],notes:"All event spend billed to Admin core.",updatedAt:m-3*24*60*60*1e3},{id:"CB-003",name:"Q1 launch campaign",enabled:!0,priority:3,match:{type:"Campaign",key:"Q1Launch"},splits:[{costCenterId:"CC-SALES-TR",percent:50},{costCenterId:"CC-ADMIN-CORE",percent:50}],notes:"Marketing-style campaign split between Sales and Admin.",updatedAt:m-6*24*60*60*1e3}]}),[k,q]=d.useState(""),[L,R]=d.useState(""),[U,ae]=d.useState(""),[ie,_]=d.useState(""),[W,J]=d.useState(!1),[we,G]=d.useState(null),[be,Ge]=d.useState(!1),[Me,je]=d.useState(null),[Ue,Oe]=d.useState(!1),[he,Y]=d.useState(null),[Ie,ce]=d.useState(!1),[me,pe]=d.useState(null),[de,ye]=d.useState(!1),[Qe,Fe]=d.useState(25e5),[ke,fe]=d.useState("Client"),[Ve,ne]=d.useState("ABC"),[Te,Ee]=d.useState("Operations"),[Re,ze]=d.useState(10),qe=d.useMemo(()=>{const m={};return o.forEach(A=>m[A.id]=A),m},[o]),He=d.useMemo(()=>o.reduce((m,A)=>m+A.budgetMonth,0),[o]),_e=d.useMemo(()=>o.reduce((m,A)=>m+A.spendMTD,0),[o]),le=d.useMemo(()=>o.reduce((m,A)=>m+om(A.spendMTD,7,30),0),[o]),z=d.useMemo(()=>dc(le,He),[le,He]),Pe=d.useMemo(()=>{const m=k.trim().toLowerCase(),A=[...o].sort((f,B)=>f.priority-B.priority);return m?A.filter(f=>`${f.id} ${f.manager}`.toLowerCase().includes(m)):A},[o,k]),Be=d.useMemo(()=>{const m=L.trim().toLowerCase();return m?x.filter(A=>`${A.code} ${A.name} ${A.group} ${A.invoiceGroup}`.toLowerCase().includes(m)):x},[x,L]),xe=d.useMemo(()=>{const m=U.trim().toLowerCase();return m?g.filter(A=>`${A.type} ${A.key} ${A.label}`.toLowerCase().includes(m)):g},[g,U]),Ne=d.useMemo(()=>{const m=ie.trim().toLowerCase(),A=[...$].sort((f,B)=>f.priority-B.priority);return m?A.filter(f=>`${f.name} ${f.match.type} ${f.match.key} ${f.id}`.toLowerCase().includes(m)):A},[$,ie]),M=(m,A)=>{const f=[...o].sort((ve,P)=>ve.priority-P.priority),B=f.findIndex(ve=>ve.id===m),p=B+A;if(B<0||p<0||p>=f.length)return;const E=f[B],se=f[p],y=Date.now(),re=f.map(ve=>ve.id===E.id?{...ve,priority:se.priority,updatedAt:y}:ve.id===se.id?{...ve,priority:E.priority,updatedAt:y}:ve);c(re),n({title:"Priority updated",message:"Enforcement priority updated.",kind:"success"})},H=m=>{if(m)G(JSON.parse(JSON.stringify(m)));else{const A=Math.max(...o.map(B=>B.priority)),f=Date.now();G({id:"Operations",budgetMonth:0,spendMTD:0,hardCap:!0,priority:A+1,manager:"",updatedAt:f,weeklySeries:[0,0,0,0,0,0],weeklyBreakdown:{Rides:[0,0,0,0,0,0],Purchases:[0,0,0,0,0,0],Services:[0,0,0,0,0,0],RFQs:[0,0,0,0,0,0]}})}J(!0)},Ae=()=>{if(!we)return;if(!we.manager.trim()){n({title:"Missing manager",message:"Add a manager name.",kind:"warn"});return}const m=Date.now();if(!o.some(f=>f.id===we.id)){n({title:"Demo limitation",message:"This demo edits existing groups. New groups can be added in production.",kind:"info"}),J(!1);return}c(f=>f.map(B=>B.id===we.id?{...we,updatedAt:m}:B)),J(!1),n({title:"Saved",message:"Group updated.",kind:"success"})},oe=m=>{if(m)je(JSON.parse(JSON.stringify(m)));else{const A=Date.now();je({id:"",code:"",name:"",group:"Operations",active:!0,defaultTags:[],invoiceGroup:"ACME-MAIN",updatedAt:A})}Ge(!0)},De=()=>{if(!Me)return;if(!Me.code.trim()||!Me.name.trim()){n({title:"Missing fields",message:"Cost center code and name are required.",kind:"warn"});return}const m=Date.now();Me.id?j(A=>A.map(f=>f.id===Me.id?{...Me,updatedAt:m}:f)):j(A=>[{...Me,id:uh("CC"),updatedAt:m},...A]),Ge(!1),n({title:"Saved",message:"Cost center saved.",kind:"success"})},$e=m=>{j(A=>A.filter(f=>f.id!==m)),n({title:"Deleted",message:"Cost center removed.",kind:"info"})},ge=m=>{if(m)Y(JSON.parse(JSON.stringify(m)));else{const A=Date.now();Y({id:"",type:"Client",key:"",label:"",active:!0,updatedAt:A})}Oe(!0)},ue=()=>{if(!he)return;if(!he.key.trim()||!he.label.trim()){n({title:"Missing fields",message:"Tag key and label are required.",kind:"warn"});return}const m=Date.now();he.id?N(A=>A.map(f=>f.id===he.id?{...he,updatedAt:m}:f)):N(A=>[{...he,id:uh("T"),updatedAt:m},...A]),Oe(!1),n({title:"Saved",message:"Tag saved.",kind:"success"})},Ke=m=>{N(A=>A.filter(f=>f.id!==m)),n({title:"Deleted",message:"Tag removed.",kind:"info"})},b=m=>{if(m)pe(JSON.parse(JSON.stringify(m)));else{const A=Date.now();pe({id:"",name:"",enabled:!0,priority:Math.max(1,...$.map(f=>f.priority))+1,match:{type:"Client",key:""},splits:[{costCenterId:"CC-OPS-CORE",percent:100}],notes:"",updatedAt:A})}ce(!0)},v=()=>{if(!me)return;if(!me.name.trim()||!me.match.key.trim()){n({title:"Missing fields",message:"Rule name and match tag key are required.",kind:"warn"});return}const m=oc(me.splits);if(m!==100){n({title:"Split must equal 100%",message:`Current sum is ${m}%.`,kind:"warn"});return}const A=Date.now();me.id?T(f=>f.map(B=>B.id===me.id?{...me,updatedAt:A}:B)):T(f=>[{...me,id:uh("CB"),updatedAt:A},...f]),ce(!1),n({title:"Saved",message:"Chargeback rule saved.",kind:"success"})},u=m=>{T(A=>A.filter(f=>f.id!==m)),n({title:"Deleted",message:"Chargeback rule removed.",kind:"info"})},C=d.useMemo(()=>$.filter(f=>f.enabled).filter(f=>f.match.type===ke&&f.match.key.toLowerCase()===Ve.toLowerCase()).sort((f,B)=>f.priority-B.priority),[$,ke,Ve]),Q=C[0]||null,O=d.useMemo(()=>Q?Q.splits.map(m=>({costCenter:x.find(f=>f.id===m.costCenterId)||null,percent:m.percent,amount:Math.round(Qe*m.percent/100)})):[],[Q,x,Qe]),ee=d.useMemo(()=>{const m=qe[Te],A=om(m.spendMTD,7,30),f=Math.round(m.budgetMonth*(1-Re/100)),B=Math.max(0,A-f),p=dc(A,m.budgetMonth),E=dc(A,f);return{g:m,forecast:A,newBudget:f,potentialSavings:B,tone:p,newTone:E}},[qe,Te,Re]),F=async()=>{const m={groups:o,costCenters:x,tags:g,chargebackRules:$,exportedAt:new Date().toISOString()},A=JSON.stringify(m,null,2);try{await navigator.clipboard.writeText(A),n({title:"Copied",message:"Config JSON copied to clipboard.",kind:"success"})}catch{n({title:"Copy failed",message:"Copy manually.",kind:"warn"})}};return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(gV,{toasts:a,onDismiss:m=>l(A=>A.filter(f=>f.id!==m))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:yr.green},children:e.jsx(wa,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Groups and Cost Centers"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Budgets, cost centers, project tags, enforcement priority, and chargeback rules."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(Wt,{label:`Groups: ${o.length}`,tone:"neutral"}),e.jsx(Wt,{label:`Cost centers: ${x.length}`,tone:"neutral"}),e.jsx(Wt,{label:`Tags: ${g.length}`,tone:"neutral"}),e.jsx(Wt,{label:`Budget: ${rl(He)}`,tone:"neutral"}),e.jsx(Wt,{label:`Spend MTD: ${rl(_e)}`,tone:"info"}),e.jsx(Wt,{label:`Forecast: ${rl(le)}`,tone:z.tone}),e.jsx(Wt,{label:`Org status: ${z.label}`,tone:z.tone})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ts,{variant:"outline",onClick:()=>ye(!0),children:[e.jsx(ht,{className:"h-4 w-4"})," Simulate chargeback"]}),e.jsxs(ts,{variant:"outline",onClick:F,children:[e.jsx(gt,{className:"h-4 w-4"})," Export JSON"]}),r==="Groups"?e.jsxs(ts,{variant:"primary",onClick:()=>H(o[0]),children:[e.jsx(yi,{className:"h-4 w-4"})," Edit group"]}):r==="Cost centers"?e.jsxs(ts,{variant:"primary",onClick:()=>oe(),children:[e.jsx(pt,{className:"h-4 w-4"})," Add cost center"]}):r==="Chargeback"?e.jsxs(ts,{variant:"primary",onClick:()=>b(),children:[e.jsx(pt,{className:"h-4 w-4"})," Add rule"]}):e.jsxs(ts,{variant:"primary",onClick:()=>n({title:"Saved",message:"Forecast settings saved (demo).",kind:"success"}),children:[e.jsx(Ia,{className:"h-4 w-4"})," Save"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:["Groups","Cost centers","Chargeback","Forecast"].map(m=>e.jsx("button",{className:rn("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",r===m?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:r===m?{background:yr.green}:void 0,onClick:()=>i(m),children:m},m))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[e.jsxs(lt,{mode:"wait",children:[r==="Groups"?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Budget forecasting"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: month-end forecast per group"})]}),e.jsx(Wt,{label:"Premium",tone:"info"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:Pe.slice(0,5).map(m=>{const A=om(m.spendMTD,7,30),f=dc(A,m.budgetMonth);return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:m.id}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Forecast: ",rl(A)," / Budget: ",rl(m.budgetMonth)]})]}),e.jsx(Wt,{label:f.label,tone:f.tone})]}),e.jsx("div",{className:"mt-2",children:e.jsx(Vv,{label:"Forecast vs budget",value:A,total:Math.max(1,m.budgetMonth),hint:`${Math.round(A/Math.max(1,m.budgetMonth)*100)}%`})})]},m.id)})})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"What changed?"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: trend explanations"})]}),e.jsx(Wt,{label:"Premium",tone:"info"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:Pe.slice(0,4).map(m=>{const A=_v(m);return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:m.id}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:A.title})]}),e.jsx(Wt,{label:"Trend",tone:A.tone})]}),e.jsx("div",{className:"mt-2 text-xs text-slate-700",children:A.body}),e.jsx("div",{className:"mt-2",children:e.jsx(k4,{values:m.weeklySeries})})]},m.id)})})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Groups and budgets"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Groups are departments. Each group has a budget and enforcement priority."})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"w-[260px]",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsx("input",{value:k,onChange:m=>q(m.target.value),placeholder:"Operations, Sales...",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"})]})})]}),e.jsx("div",{className:"mt-4 rounded-2xl border border-slate-200 bg-white",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Priority"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Manager"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Budget"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Spend MTD"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Forecast"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Cap"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Updated"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Actions"})]})}),e.jsx("tbody",{children:Pe.map(m=>{const A=om(m.spendMTD,7,30),f=dc(A,m.budgetMonth);return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Wt,{label:`#${m.priority}`,tone:"neutral"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("button",{className:"rounded-xl border border-slate-200 bg-white px-2 py-1 text-xs font-semibold text-slate-700 hover:bg-slate-50",onClick:()=>M(m.id,-1),children:""}),e.jsx("button",{className:"mt-1 rounded-xl border border-slate-200 bg-white px-2 py-1 text-xs font-semibold text-slate-700 hover:bg-slate-50",onClick:()=>M(m.id,1),children:""})]})]})}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900 whitespace-nowrap",children:m.id}),e.jsx("td",{className:"px-4 py-3 text-slate-700 whitespace-nowrap",children:m.manager}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900 whitespace-nowrap",children:rl(m.budgetMonth)}),e.jsx("td",{className:"px-4 py-3 text-slate-700 whitespace-nowrap",children:rl(m.spendMTD)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-slate-900 whitespace-nowrap",children:rl(A)}),e.jsx(Wt,{label:f.label,tone:f.tone})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Wt,{label:m.hardCap?"Hard":"Soft",tone:m.hardCap?"warn":"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-600 whitespace-nowrap",children:mh(m.updatedAt)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ts,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>H(m),children:[e.jsx(yi,{className:"h-4 w-4"})," Edit"]}),e.jsxs(ts,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Ee(m.id),i("Forecast"),n({title:"Scenario",message:"Opened scenario planner.",kind:"info"})},children:[e.jsx(qd,{className:"h-4 w-4"})," Scenario"]})]})})]},m.id)})})]})})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Enforcement priority decides which group budget applies first when rules overlap (chargeback or multi-tag mapping)."})]})]})},"groups"):null,r==="Cost centers"?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Project tags"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Client, event, campaign, project"})]}),e.jsxs(ts,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>ge(),children:[e.jsx(pt,{className:"h-4 w-4"})," Add"]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsx("input",{value:U,onChange:m=>ae(m.target.value),placeholder:"Client ABC, Expo2026...",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"})]}),e.jsxs("div",{className:"mt-3 space-y-2 max-h-[400px] overflow-y-auto",children:[xe.slice(0,8).map(m=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:m.label}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[m.type,": ",m.key]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(Wt,{label:m.active?"Active":"Inactive",tone:m.active?"good":"neutral"}),e.jsx(Wt,{label:mh(m.updatedAt),tone:"neutral"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(ts,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ge(m),children:e.jsx(yi,{className:"h-4 w-4"})}),e.jsx(ts,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>Ke(m.id),children:e.jsx(as,{className:"h-4 w-4"})})]})]})},m.id)),xe.length?null:e.jsx("div",{className:"text-sm text-slate-600",children:"No tags found."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tags are used in chargeback rules and for reporting."})]}),e.jsx("div",{className:"rounded-3xl border border-amber-200 bg-amber-50 p-4 shadow-sm h-fit",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-white text-amber-800 ring-1 ring-amber-200",children:e.jsx(ht,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Premium note"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:"Chargeback rules can split billing by tag and route to invoice groups automatically."})]})]})})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Cost centers"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Cost centers connect spending to invoices, AP codes, and chargeback rules."})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("div",{className:"w-[260px]",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsx("input",{value:L,onChange:m=>R(m.target.value),placeholder:"OPS-CORE, SALES-TRAVEL...",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"})]}),e.jsxs(ts,{variant:"primary",onClick:()=>oe(),children:[e.jsx(pt,{className:"h-4 w-4"})," Add"]})]})]}),e.jsx("div",{className:"mt-4 rounded-2xl border border-slate-200 bg-white",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Code"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Name"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Invoice group"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Default tags"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Updated"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Actions"})]})}),e.jsx("tbody",{children:Be.map(m=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900 whitespace-nowrap",children:m.code}),e.jsx("td",{className:"px-4 py-3 text-slate-700 whitespace-nowrap",children:m.name}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Wt,{label:m.group,tone:"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700 whitespace-nowrap",children:m.invoiceGroup}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[(m.defaultTags||[]).slice(0,3).map(A=>e.jsx(Wt,{label:A,tone:"neutral"},A)),(m.defaultTags||[]).length>3?e.jsx(Wt,{label:`+${(m.defaultTags||[]).length-3}`,tone:"neutral"}):null]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Wt,{label:m.active?"Active":"Inactive",tone:m.active?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-600 whitespace-nowrap",children:mh(m.updatedAt)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ts,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>oe(m),children:[e.jsx(yi,{className:"h-4 w-4"})," Edit"]}),e.jsxs(ts,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>$e(m.id),children:[e.jsx(as,{className:"h-4 w-4"})," Delete"]})]})})]},m.id))})]})})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Chargeback rules can split billing across cost centers using tag mapping."})]})]})},"cc"):null,r==="Chargeback"?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Simulation"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Test a transaction against chargeback rules."})]}),e.jsx(Wt,{label:"Premium",tone:"info"})]}),e.jsxs(ts,{variant:"primary",className:"mt-3 w-full",onClick:()=>ye(!0),children:[e.jsx(ht,{className:"h-4 w-4"})," Open simulator"]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Tip: if multiple rules match, the lowest priority number wins."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Chargeback best practices"}),e.jsxs("ul",{className:"mt-3 space-y-2 text-sm text-slate-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:yr.green}})," Keep rules simple and tag-driven."]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:yr.orange}})," Use priority to avoid ambiguity."]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:yr.green}})," Ensure splits always sum to 100%."]})]})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Chargeback rules"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Split billing by tag mapping. Rules are evaluated by priority."})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("div",{className:"w-[260px]",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsx("input",{value:ie,onChange:m=>_(m.target.value),placeholder:"Client ABC, Expo...",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"})]}),e.jsxs(ts,{variant:"primary",onClick:()=>b(),children:[e.jsx(pt,{className:"h-4 w-4"})," Add"]})]})]}),e.jsx("div",{className:"mt-4 rounded-2xl border border-slate-200 bg-white",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Priority"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Rule"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Match"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Split"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Updated"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Actions"})]})}),e.jsx("tbody",{children:Ne.map(m=>{const A=oc(m.splits);return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx(Wt,{label:`#${m.priority}`,tone:"neutral"})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900 whitespace-nowrap",children:m.name}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:m.id})]}),e.jsxs("td",{className:"px-4 py-3 text-slate-700 whitespace-nowrap",children:[m.match.type,": ",m.match.key]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(Wt,{label:`${A}%`,tone:A===100?"good":"warn"}),m.splits.slice(0,2).map((f,B)=>{const p=x.find(E=>E.id===f.costCenterId);return e.jsx(Wt,{label:`${(p==null?void 0:p.code)||"CC"}: ${f.percent}%`,tone:"neutral"},B)}),m.splits.length>2?e.jsx(Wt,{label:`+${m.splits.length-2}`,tone:"neutral"}):null]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Wt,{label:m.enabled?"Enabled":"Off",tone:m.enabled?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-600 whitespace-nowrap",children:mh(m.updatedAt)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ts,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>b(m),children:[e.jsx(yi,{className:"h-4 w-4"})," Edit"]}),e.jsx(ts,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{T(f=>f.map(B=>B.id===m.id?{...B,enabled:!B.enabled,updatedAt:Date.now()}:B)),n({title:"Updated",message:`Rule ${m.enabled?"disabled":"enabled"}.`,kind:"success"})},children:m.enabled?"Disable":"Enable"}),e.jsxs(ts,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>u(m.id),children:[e.jsx(as,{className:"h-4 w-4"})," Delete"]})]})})]},m.id)})})]})})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Chargeback enforcement is applied at invoicing time. Splits can also be shown live during checkout (Premium)."})]})]})},"chargeback"):null,r==="Forecast"?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Scenario planner"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"If we lower cap by X%, savings estimate"})]}),e.jsx(Wt,{label:"Premium",tone:"info"})]}),e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Group"}),e.jsx("select",{value:Te,onChange:m=>Ee(m.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",children:o.slice().sort((m,A)=>m.priority-A.priority).map(m=>e.jsx("option",{value:m.id,children:m.id},m.id))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Lower cap by"}),e.jsx(Wt,{label:`${Re}%`,tone:"neutral"})]}),e.jsx("input",{type:"range",min:0,max:40,step:5,value:Re,onChange:m=>ze(Number(m.target.value)),className:"mt-2 w-full"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"This estimates savings as forecast minus new cap (if forecast exceeds cap)."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Current"}),e.jsxs("div",{className:"mt-2 grid grid-cols-1 gap-2",children:[e.jsx(Vv,{label:"Budget",value:ee.g.budgetMonth,total:ee.g.budgetMonth,hint:rl(ee.g.budgetMonth)}),e.jsx(Vv,{label:"Forecast",value:ee.forecast,total:Math.max(1,ee.g.budgetMonth),hint:rl(ee.forecast)})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsx(Wt,{label:`Status: ${ee.tone.label}`,tone:ee.tone.tone}),e.jsx(Wt,{label:`Hard cap: ${ee.g.hardCap?"Yes":"No"}`,tone:ee.g.hardCap?"warn":"neutral"})]})]}),e.jsxs("div",{className:"rounded-3xl border border-emerald-200 bg-emerald-50 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-emerald-900",children:"Scenario"}),e.jsxs("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:["New cap: ",rl(ee.newBudget)]}),e.jsxs("div",{className:"mt-1 text-sm text-slate-700",children:["Potential savings: ",e.jsx("span",{className:"font-semibold text-slate-900",children:rl(ee.potentialSavings)})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsx(Wt,{label:`New status: ${ee.newTone.label}`,tone:ee.newTone.tone}),e.jsxs(ts,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{c(m=>m.map(A=>A.id===Te?{...A,budgetMonth:ee.newBudget,updatedAt:Date.now()}:A)),n({title:"Applied",message:"Scenario cap applied to group budget (demo).",kind:"success"})},children:[e.jsx(ht,{className:"h-4 w-4"})," Apply"]})]})]}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Note: lowering caps can reduce spend but may also block legitimate operations. Consider approvals instead of hard blocks."})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm h-fit",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"What changed"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: driver explanations per group"}),e.jsx("div",{className:"mt-3 space-y-2",children:o.slice().sort((m,A)=>m.priority-A.priority).slice(0,3).map(m=>{const A=_v(m);return e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:m.id}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:A.body})]}),e.jsx(Wt,{label:"Driver",tone:A.tone})]})},m.id)})})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Budget forecasting per group"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: forecast to month-end using MTD spend."})]}),e.jsx(Wt,{label:"Day 7/30",tone:"neutral"})]}),e.jsx("div",{className:"mt-4 rounded-2xl border border-slate-200 bg-white",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Budget"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Spend MTD"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Forecast"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Trend"})]})}),e.jsx("tbody",{children:o.slice().sort((m,A)=>m.priority-A.priority).map(m=>{const A=om(m.spendMTD,7,30),f=dc(A,m.budgetMonth),B=_v(m);return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900 whitespace-nowrap",children:m.id}),e.jsx("td",{className:"px-4 py-3 text-slate-700 whitespace-nowrap",children:rl(m.budgetMonth)}),e.jsx("td",{className:"px-4 py-3 text-slate-700 whitespace-nowrap",children:rl(m.spendMTD)}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900 whitespace-nowrap",children:rl(A)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Wt,{label:f.label,tone:f.tone})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"text-xs text-slate-600",children:B.title}),e.jsx(k4,{values:m.weeklySeries})]})})]},m.id)})})]})})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Forecasting is a simple extrapolation in this demo. In production, it uses historical patterns per group and seasonality."})]})]})},"forecast"):null]}),e.jsx("div",{className:"mt-4 text-xs text-slate-500",children:"G Groups & Cost Centers v2: groups and budgets, enforcement priority, cost centers, project tags, chargeback rules, forecasting, trend explanations, and scenario planner."})]})]})}),e.jsx(im,{open:W,title:"Edit group",subtitle:"Update group budget, enforcement priority, and manager details.",onClose:()=>J(!1),actions:[{label:"Save",onClick:Ae}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(ts,{variant:"outline",onClick:()=>J(!1),children:"Cancel"}),e.jsxs(ts,{variant:"primary",onClick:Ae,children:[e.jsx(Ia,{className:"h-4 w-4"})," Save"]})]}),children:we?e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Group"}),e.jsx("select",{value:we.id,onChange:m=>G(A=>A&&{...A,id:m.target.value}),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:["Operations","Sales","Finance","Admin","Procurement"].map(m=>e.jsx("option",{value:m,children:m},m))}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Demo: editing existing groups only."})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Manager"}),e.jsx("input",{value:we.manager,onChange:m=>G(A=>A&&{...A,manager:m.target.value}),placeholder:"Manager name",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Monthly budget (UGX)"}),e.jsx("input",{type:"number",value:we.budgetMonth,onChange:m=>G(A=>A&&{...A,budgetMonth:Number(m.target.value||0)}),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Preview: ",rl(we.budgetMonth)]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Enforcement priority"}),e.jsx("input",{type:"number",value:we.priority,onChange:m=>G(A=>A&&{...A,priority:Number(m.target.value||1)}),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Lower number means higher priority."})]}),e.jsxs("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Hard cap"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Block spend when the group budget is exceeded."})]}),e.jsx("button",{type:"button",className:rn("relative h-7 w-12 rounded-full border transition",we.hardCap?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>G(m=>m&&{...m,hardCap:!m.hardCap}),"aria-label":"Toggle hard cap",children:e.jsx("span",{className:rn("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",we.hardCap?"left-[22px]":"left-1")})})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-white p-3 text-xs text-slate-600",children:"Premium: use scenario planner to estimate savings before applying hard caps."})]})]}):null}),e.jsx(im,{open:be,title:Me!=null&&Me.id?"Edit cost center":"Add cost center",subtitle:"Cost centers map spend to invoices, tags, and chargeback rules.",onClose:()=>Ge(!1),actions:[{label:"Save",onClick:De},...Me!=null&&Me.id?[{label:"Delete",onClick:()=>{$e(Me.id),Ge(!1)},variant:"danger"}]:[]],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(ts,{variant:"outline",onClick:()=>Ge(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[Me!=null&&Me.id?e.jsxs(ts,{variant:"danger",onClick:()=>{$e(Me.id),Ge(!1)},children:[e.jsx(as,{className:"h-4 w-4"})," Delete"]}):null,e.jsxs(ts,{variant:"primary",onClick:De,children:[e.jsx(Ia,{className:"h-4 w-4"})," Save"]})]})]}),maxW:"980px",children:Me?e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Code"}),e.jsx("input",{value:Me.code,onChange:m=>je(A=>A&&{...A,code:m.target.value}),placeholder:"OPS-CORE",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Name"}),e.jsx("input",{value:Me.name,onChange:m=>je(A=>A&&{...A,name:m.target.value}),placeholder:"Operations core",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Group"}),e.jsx("select",{value:Me.group,onChange:m=>je(A=>A&&{...A,group:m.target.value}),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:["Operations","Sales","Finance","Admin","Procurement"].map(m=>e.jsx("option",{value:m,children:m},m))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Invoice group"}),e.jsx("select",{value:Me.invoiceGroup,onChange:m=>je(A=>A&&{...A,invoiceGroup:m.target.value}),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:["ACME-MAIN","ACME-SALES","ACME-FIN"].map(m=>e.jsx("option",{value:m,children:m},m))})]}),e.jsx("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Active"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Inactive cost centers are not used for new chargeback splits."})]}),e.jsx("button",{type:"button",className:rn("relative h-7 w-12 rounded-full border transition",Me.active?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>je(m=>m&&{...m,active:!m.active}),"aria-label":"Toggle active",children:e.jsx("span",{className:rn("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",Me.active?"left-[22px]":"left-1")})})]})}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Default tags"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[(Me.defaultTags||[]).map(m=>e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-slate-50 px-3 py-2 text-xs font-semibold text-slate-700 ring-1 ring-slate-200",children:[m,e.jsx("button",{type:"button",className:"rounded-full p-1 hover:bg-slate-200",onClick:()=>je(A=>A&&{...A,defaultTags:(A.defaultTags||[]).filter(f=>f!==m)}),children:e.jsx(Ye,{className:"h-3.5 w-3.5"})})]},m)),(D=Me.defaultTags)!=null&&D.length?null:e.jsx(Wt,{label:"No default tags",tone:"neutral"})]}),e.jsxs("div",{className:"mt-3 rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Add from tag library"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:g.filter(m=>m.active).slice(0,8).map(m=>{const A=`${m.type}: ${m.key}`,f=(Me.defaultTags||[]).includes(A);return e.jsx("button",{type:"button",className:rn("rounded-full px-3 py-2 text-xs font-semibold ring-1 transition",f?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:f?{background:yr.green}:void 0,onClick:()=>{je(B=>{if(!B)return B;const p=new Set(B.defaultTags||[]);return p.has(A)?p.delete(A):p.add(A),{...B,defaultTags:Array.from(p)}})},children:A},m.id)})})]}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Default tags are applied when users forget to tag a transaction."})]})]}):null}),e.jsx(im,{open:Ue,title:he!=null&&he.id?"Edit tag":"Add tag",subtitle:"Tags power reporting, budgets, and chargeback rules.",onClose:()=>Oe(!1),actions:[{label:"Save",onClick:ue},...he!=null&&he.id?[{label:"Delete",onClick:()=>{Ke(he.id),Oe(!1)},variant:"danger"}]:[]],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(ts,{variant:"outline",onClick:()=>Oe(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[he!=null&&he.id?e.jsxs(ts,{variant:"danger",onClick:()=>{Ke(he.id),Oe(!1)},children:[e.jsx(as,{className:"h-4 w-4"})," Delete"]}):null,e.jsxs(ts,{variant:"primary",onClick:ue,children:[e.jsx(Ia,{className:"h-4 w-4"})," Save"]})]})]}),maxW:"860px",children:he?e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Type"}),e.jsx("select",{value:he.type,onChange:m=>Y(A=>A&&{...A,type:m.target.value}),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:["Client","Event","Campaign","Project","Other"].map(m=>e.jsx("option",{value:m,children:m},m))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Key"}),e.jsx("input",{value:he.key,onChange:m=>Y(A=>A&&{...A,key:m.target.value}),placeholder:"ABC",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Used in chargeback match rules."})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Label"}),e.jsx("input",{value:he.label,onChange:m=>Y(A=>A&&{...A,label:m.target.value}),placeholder:"Client ABC Ltd",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"})]}),e.jsx("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Active"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Inactive tags do not appear in dropdowns."})]}),e.jsx("button",{type:"button",className:rn("relative h-7 w-12 rounded-full border transition",he.active?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>Y(m=>m&&{...m,active:!m.active}),"aria-label":"Toggle active",children:e.jsx("span",{className:rn("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",he.active?"left-[22px]":"left-1")})})]})})]}):null}),e.jsx(im,{open:Ie,title:me!=null&&me.id?"Edit chargeback rule":"Add chargeback rule",subtitle:"Split billing by tag mapping. Splits must sum to 100%.",onClose:()=>ce(!1),actions:[{label:"Save",onClick:v},...me!=null&&me.id?[{label:"Delete",onClick:()=>{u(me.id),ce(!1)},variant:"danger"}]:[]],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(ts,{variant:"outline",onClick:()=>ce(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[me!=null&&me.id?e.jsxs(ts,{variant:"danger",onClick:()=>{u(me.id),ce(!1)},children:[e.jsx(as,{className:"h-4 w-4"})," Delete"]}):null,e.jsxs(ts,{variant:"primary",onClick:v,children:[e.jsx(Ia,{className:"h-4 w-4"})," Save"]})]})]}),maxW:"980px",children:me?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Name"}),e.jsx("input",{value:me.name,onChange:m=>pe(A=>A&&{...A,name:m.target.value}),placeholder:"Client ABC meetings",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Priority"}),e.jsx("input",{type:"number",value:me.priority,onChange:m=>pe(A=>A&&{...A,priority:Number(m.target.value||1)}),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Lower number means higher priority."})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Match type"}),e.jsx("select",{value:me.match.type,onChange:m=>pe(A=>A&&{...A,match:{...A.match,type:m.target.value}}),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:["Client","Event","Campaign","Project","Other"].map(m=>e.jsx("option",{value:m,children:m},m))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Match key"}),e.jsx("input",{value:me.match.key,onChange:m=>pe(A=>A&&{...A,match:{...A.match,key:m.target.value}}),placeholder:"ABC",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Split billing"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Percent must sum to 100%."})]}),e.jsx(Wt,{label:`Sum: ${oc(me.splits)}%`,tone:oc(me.splits)===100?"good":"warn"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:me.splits.map((m,A)=>{const f=x.find(B=>B.id===m.costCenterId);return e.jsxs("div",{className:"grid grid-cols-1 gap-3 rounded-2xl border border-slate-200 bg-white p-3 md:grid-cols-12",children:[e.jsxs("div",{className:"md:col-span-7",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Cost center"}),e.jsx("select",{value:m.costCenterId,onChange:B=>{const p=B.target.value;pe(E=>{if(!E)return E;const se={...E};return se.splits=se.splits.map((y,re)=>re===A?{...y,costCenterId:p}:y),se})},className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none",children:x.map(B=>e.jsxs("option",{value:B.id,children:[B.code," - ",B.name]},B.id))}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Group: ",f==null?void 0:f.group,"  Invoice group: ",f==null?void 0:f.invoiceGroup]})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Percent"}),e.jsx("input",{type:"number",value:m.percent,onChange:B=>{const p=Number(B.target.value||0);pe(E=>{if(!E)return E;const se={...E};return se.splits=se.splits.map((y,re)=>re===A?{...y,percent:p}:y),se})},className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none"})]}),e.jsx("div",{className:"md:col-span-2 flex items-end justify-end",children:e.jsx(ts,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>{pe(B=>{var E;if(!B)return B;const p={...B};return p.splits=p.splits.filter((se,y)=>y!==A),p.splits.length||(p.splits=[{costCenterId:((E=x[0])==null?void 0:E.id)||"",percent:100}]),p})},children:e.jsx(as,{className:"h-4 w-4"})})})]},A)})}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(ts,{variant:"outline",onClick:()=>{pe(m=>{var A;return m&&{...m,splits:[...m.splits,{costCenterId:((A=x[0])==null?void 0:A.id)||"",percent:0}]}})},children:[e.jsx(pt,{className:"h-4 w-4"})," Add split"]}),e.jsxs(ts,{variant:"outline",onClick:()=>{pe(m=>{if(!m)return m;const A=m.splits.reduce((p,E)=>p+Number(E.percent||0),0);if(!A)return m;const f={...m};f.splits=f.splits.map(p=>({...p,percent:Math.round(p.percent/A*100)}));const B=100-oc(f.splits);return f.splits[0]={...f.splits[0],percent:f.splits[0].percent+B},f}),n({title:"Normalized",message:"Split normalized to 100%.",kind:"success"})},children:[e.jsx(ht,{className:"h-4 w-4"})," Normalize to 100%"]}),e.jsxs(ts,{variant:"outline",onClick:()=>ye(!0),children:[e.jsx(ht,{className:"h-4 w-4"})," Test"]})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Notes"}),e.jsx("textarea",{value:me.notes,onChange:m=>pe(A=>A&&{...A,notes:m.target.value}),rows:4,placeholder:"Explain how this rule is used",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 outline-none"}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Best practice: keep a short business reason for every chargeback rule."})]}),e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Enabled"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Disable without deleting to preserve history."})]}),e.jsx("button",{type:"button",className:rn("relative h-7 w-12 rounded-full border transition",me.enabled?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>pe(m=>m&&{...m,enabled:!m.enabled}),"aria-label":"Toggle enabled",children:e.jsx("span",{className:rn("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",me.enabled?"left-[22px]":"left-1")})})]})})]}):null}),e.jsx(im,{open:de,title:"Chargeback simulator",subtitle:"Test a tagged transaction and see how it splits across cost centers.",onClose:()=>ye(!1),footer:e.jsx("div",{className:"flex justify-end",children:e.jsx(ts,{variant:"outline",onClick:()=>ye(!1),children:"Close"})}),maxW:"980px",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"space-y-4 lg:col-span-1",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Transaction"}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Amount (UGX)"}),e.jsx("input",{type:"number",value:Qe,onChange:m=>Fe(Number(m.target.value||0)),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Preview: ",rl(Qe)]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Tag type"}),e.jsx("select",{value:ke,onChange:m=>fe(m.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:["Client","Event","Campaign","Project","Other"].map(m=>e.jsx("option",{value:m,children:m},m))})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Tag key"}),e.jsxs("select",{value:Ve,onChange:m=>ne(m.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:[g.filter(m=>m.type===ke&&m.active).map(m=>e.jsxs("option",{value:m.key,children:[m.key," - ",m.label]},m.id)),g.filter(m=>m.type===ke&&m.active).length===0?e.jsx("option",{value:Ve,children:Ve}):null]}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Rules match on type and key."})]})]}),e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-amber-50 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-white text-amber-800 ring-1 ring-amber-200",children:e.jsx(ht,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"How this works"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:"The simulator selects the highest priority matching rule and applies the split."})]})]})})]}),e.jsxs("div",{className:"space-y-4 lg:col-span-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Matched rule"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"If none match, the transaction uses the users default cost center (not shown in this demo)."})]}),Q?e.jsx(Wt,{label:`#${Q.priority}`,tone:"neutral"}):e.jsx(Wt,{label:"No match",tone:"warn"})]}),Q?e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsx("div",{className:"font-semibold",children:Q.name}),e.jsxs("div",{className:"mt-1 text-slate-600",children:["Match: ",Q.match.type,": ",Q.match.key]}),e.jsxs("div",{className:"mt-1 text-slate-600",children:["Rule ID: ",Q.id]})]}):e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"No enabled chargeback rule matches this tag. Create a rule or change the tag."}),C.length>1?e.jsxs("div",{className:"mt-3 rounded-2xl border border-slate-200 bg-white p-3 text-xs text-slate-600",children:["Multiple matches found. Using highest priority rule.",e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:C.slice(0,6).map(m=>e.jsx(Wt,{label:`#${m.priority} ${m.name}`,tone:"neutral"},m.id))})]}):null]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Split result"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Amounts per cost center (and their invoice group)."})]}),e.jsx(Wt,{label:Q?`${oc(Q.splits)}%`:"-",tone:Q?"good":"neutral"})]}),Q?e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Cost center"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Invoice group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Percent"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"})]})}),e.jsx("tbody",{children:O.map((m,A)=>{var f,B,p;return e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:((f=m.costCenter)==null?void 0:f.code)||"Unknown"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Wt,{label:((B=m.costCenter)==null?void 0:B.group)||"-",tone:"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:((p=m.costCenter)==null?void 0:p.invoiceGroup)||"-"}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[m.percent,"%"]}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:rl(m.amount)})]},A)})})]})}):e.jsx("div",{className:"mt-3 text-sm text-slate-600",children:"No split to show."}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: split preview can be displayed at checkout before purchase confirmation."})]})]})]})}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"G Groups & Cost Centers v2 includes groups, budgets, enforcement priority, cost centers, tags, chargeback rules, forecasting, trend explanations, and scenario planning."})})]})}const Cd={green:"#03CD8C",orange:"#F77F00"};function hn(...t){return t.filter(Boolean).join(" ")}function xh(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function C4(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function bV(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function jV(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function ry(t){return JSON.parse(JSON.stringify(t))}function Qt({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:hn("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function cs({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:Cd.green}:t==="accent"?{background:Cd.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:hn(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Aa({enabled:t,onChange:s,label:a,description:l,disabled:n}){return e.jsxs("div",{className:hn("flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",n&&"opacity-60"),children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",disabled:n,className:hn("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white",n&&"cursor-not-allowed"),onClick:()=>!n&&s(!t),"aria-label":a,children:e.jsx("span",{className:hn("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function di({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",required:i,disabled:o}){const c=!!i&&!s.trim();return e.jsxs("div",{className:hn(o&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"text-xs font-semibold text-slate-600",children:[t,i?e.jsx("span",{className:"text-rose-600",children:" *"}):null]}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,disabled:o,onChange:x=>a(x.target.value),placeholder:l,className:hn("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold shadow-sm outline-none focus:ring-4",o?"border-slate-200 bg-slate-50 text-slate-500":c?"border-rose-300 bg-white text-slate-900 focus:ring-rose-100":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")}),c?e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:"Required"}):null]})}function Tr({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:hn(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,disabled:r,onChange:i=>a(i.target.value),className:hn("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function yV({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700 disabled:opacity-50",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:hn("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function dm({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="920px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[8vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(yV,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function NV({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:hn("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="warn"||a.kind==="error"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function wV(t,s){const a={};t.forEach(n=>a[n]=!1);const l={};return s.forEach(n=>l[n]=!1),{modules:a,marketplaces:l,areas:{dashboard:!0,users:!1,groups:!1,orgSetup:!1,policies:!1,approvals:!1,billing:!1,invoices:!1,integrations:!1,reports:!1,security:!1},actions:{createRFQ:!1,issueBudget:!1,approveSpend:!1,exportReports:!1,toggleSupportMode:!1,adjustInvoice:"none",changeCreditLimit:"none"}}}function cc(t,s){const a=ry(t);return s.modules&&(a.modules={...a.modules,...s.modules}),s.marketplaces&&(a.marketplaces={...a.marketplaces,...s.marketplaces}),s.areas&&(a.areas={...a.areas,...s.areas}),s.actions&&(a.actions={...a.actions,...s.actions}),a}function kV(t,s,a,l){const n=[];return a.forEach(r=>{t.modules[r]!==s.modules[r]&&n.push(`Module ${r}: ${t.modules[r]?"On":"Off"}  ${s.modules[r]?"On":"Off"}`)}),l.forEach(r=>{t.marketplaces[r]!==s.marketplaces[r]&&n.push(`Marketplace ${r}: ${t.marketplaces[r]?"On":"Off"}  ${s.marketplaces[r]?"On":"Off"}`)}),Object.keys(t.areas).forEach(r=>{t.areas[r]!==s.areas[r]&&n.push(`Area ${r}: ${t.areas[r]?"On":"Off"}  ${s.areas[r]?"On":"Off"}`)}),Object.keys(t.actions).forEach(r=>{t.actions[r]!==s.actions[r]&&n.push(`Action ${r}: ${String(t.actions[r])}  ${String(s.actions[r])}`)}),n}function ci(t,s,a){const l={};s.forEach(o=>l[o]=!0);const n={};a.forEach(o=>n[o]=!0);const r={};a.forEach(o=>r[o]=!1);const i={dashboard:!0,users:!0,groups:!0,orgSetup:!0,policies:!0,approvals:!0,billing:!0,invoices:!0,integrations:!0,reports:!0,security:!0};switch(t){case"admin_full":return{name:"Admin full access",description:"Full access across modules, billing, integrations, and security.",permsPatch:{modules:l,marketplaces:n,areas:i,actions:{createRFQ:!0,issueBudget:!0,approveSpend:!0,exportReports:!0,toggleSupportMode:!0,adjustInvoice:"approve",changeCreditLimit:"approve"}},scopePatch:{orgAdminScope:!0,evzoneSupportScope:!1,noSilentActions:!0}};case"manager_ops":return{name:"Manager (operations)",description:"Operational access, approvals, and reporting. No sensitive finance adjustments.",permsPatch:{modules:{...Object.fromEntries(s.map(o=>[o,!1])),"Rides & Logistics":!0,"Travel & Tourism":!0,"Virtual Workspace":!0,"E-Commerce":!0},marketplaces:{...r,MyLiveDealz:!0,ServiceMart:!0,EVmart:!0,ExpressMart:!0},areas:{dashboard:!0,users:!1,groups:!1,orgSetup:!1,policies:!0,approvals:!0,billing:!1,invoices:!1,integrations:!1,reports:!0,security:!1},actions:{createRFQ:!0,issueBudget:!0,approveSpend:!0,exportReports:!0,toggleSupportMode:!1,adjustInvoice:"none",changeCreditLimit:"none"}}};case"accountant_strict":return{name:"Accountant (strict)",description:"Billing, invoices, and reports. Finance adjustments require dual-control.",permsPatch:{modules:{...Object.fromEntries(s.map(o=>[o,!1])),"Finance & Payments":!0,"E-Commerce":!0,"Rides & Logistics":!0,"EVs & Charging":!0},marketplaces:{...r,MyLiveDealz:!0,ServiceMart:!0,EVmart:!0},areas:{dashboard:!0,users:!1,groups:!0,orgSetup:!1,policies:!1,approvals:!0,billing:!0,invoices:!0,integrations:!0,reports:!0,security:!1},actions:{createRFQ:!1,issueBudget:!1,approveSpend:!1,exportReports:!0,toggleSupportMode:!1,adjustInvoice:"request",changeCreditLimit:"request"}}};case"approver_min":return{name:"Approver minimal",description:"Approvals inbox only plus limited reporting.",permsPatch:{modules:{...Object.fromEntries(s.map(o=>[o,!1])),"Rides & Logistics":!0,"E-Commerce":!0,"Finance & Payments":!0},marketplaces:{...r,MyLiveDealz:!0,ServiceMart:!0},areas:{dashboard:!0,users:!1,groups:!1,orgSetup:!1,policies:!1,approvals:!0,billing:!1,invoices:!1,integrations:!1,reports:!0,security:!1},actions:{createRFQ:!1,issueBudget:!1,approveSpend:!0,exportReports:!1,toggleSupportMode:!1,adjustInvoice:"none",changeCreditLimit:"none"}}};case"travel_coordinator":return{name:"Travel coordinator",description:"Book and manage rides, create RFQs for travel services, limited purchases.",permsPatch:{modules:{...Object.fromEntries(s.map(o=>[o,!1])),"Rides & Logistics":!0,"Travel & Tourism":!0,"E-Commerce":!0},marketplaces:{...r,ServiceMart:!0,ExpressMart:!0},areas:{dashboard:!0,users:!1,groups:!1,orgSetup:!1,policies:!1,approvals:!0,billing:!1,invoices:!1,integrations:!1,reports:!1,security:!1},actions:{createRFQ:!0,issueBudget:!1,approveSpend:!1,exportReports:!1,toggleSupportMode:!1,adjustInvoice:"none",changeCreditLimit:"none"}}};case"support_view_only":return{name:"Support view-only",description:"EVzone support can view. No silent actions. Write actions must be requested and visible.",permsPatch:{modules:l,marketplaces:n,areas:{dashboard:!0,users:!0,groups:!0,orgSetup:!0,policies:!0,approvals:!0,billing:!0,invoices:!0,integrations:!0,reports:!0,security:!0},actions:{createRFQ:!1,issueBudget:!1,approveSpend:!1,exportReports:!0,toggleSupportMode:!1,adjustInvoice:"request",changeCreditLimit:"request"}},scopePatch:{orgAdminScope:!1,evzoneSupportScope:!0,noSilentActions:!0}};case"hospital_compliance":return{name:"Hospital compliance pack",description:"Stricter access for health care related spend. More approvals required.",permsPatch:{modules:{...Object.fromEntries(s.map(o=>[o,!1])),"Medical & Health Care":!0,"Rides & Logistics":!0,"Finance & Payments":!0,"Virtual Workspace":!0,"E-Commerce":!0},marketplaces:{...r,HealthMart:!0,ServiceMart:!0,MyLiveDealz:!0},areas:{dashboard:!0,users:!0,groups:!0,orgSetup:!0,policies:!0,approvals:!0,billing:!0,invoices:!0,integrations:!1,reports:!0,security:!0},actions:{createRFQ:!0,issueBudget:!0,approveSpend:!0,exportReports:!0,toggleSupportMode:!1,adjustInvoice:"request",changeCreditLimit:"request"}}};default:return{name:"Template",description:"",permsPatch:{}}}}function Bv(t){return t.scope.evzoneSupportScope&&t.scope.noSilentActions}function CV(t,s){const a=t.perms.actions[s];return typeof a=="boolean"?a:a!=="none"}function S4(t,s){return!!t.perms.areas[s]}function Gv(t,s){return!!t.perms.modules[s]}function qv(t,s){return!!t.perms.marketplaces[s]}function ph(t,s,a){return t.filter(l=>l.active&&l.perms.actions[s]===a)}function SV(){var ve,P,X,S;const t=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],s=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],a=["Admin","Manager","Accountant","User","Approver","Travel Coordinator","EVzone Support"],[l,n]=d.useState([]),r=w=>{const h=xh("toast");n(K=>[{id:h,...w},...K].slice(0,4)),window.setTimeout(()=>n(K=>K.filter(V=>V.id!==h)),3200)},[i,o]=d.useState("Roles"),[c,x]=d.useState(!0),[j,g]=d.useState(null),[N,$]=d.useState(""),T=d.useMemo(()=>wV(t,s),[t,s]),k=d.useMemo(()=>{const w=Date.now(),h=(K,V,Ce,I,te,Se)=>({id:xh("role"),name:K,type:V,base:Se,description:Ce,active:!0,scope:te,perms:cc(T,I),updatedAt:w-Math.floor(Math.random()*14)*24*60*60*1e3});return[h("Admin","System","Org admin role with broad access.",ci("admin_full",t,s).permsPatch,{orgAdminScope:!0,evzoneSupportScope:!1,noSilentActions:!0},"Admin"),h("Manager","System","Manager role for operational oversight.",ci("manager_ops",t,s).permsPatch,{orgAdminScope:!1,evzoneSupportScope:!1,noSilentActions:!0},"Manager"),h("Accountant","System","Finance role for billing and reporting.",ci("accountant_strict",t,s).permsPatch,{orgAdminScope:!1,evzoneSupportScope:!1,noSilentActions:!0},"Accountant"),h("Approver","System","Approver role for approvals and escalations.",ci("approver_min",t,s).permsPatch,{orgAdminScope:!1,evzoneSupportScope:!1,noSilentActions:!0},"Approver"),h("Travel Coordinator","System","Books travel and coordinates rides.",ci("travel_coordinator",t,s).permsPatch,{orgAdminScope:!1,evzoneSupportScope:!1,noSilentActions:!0},"Travel Coordinator"),h("User","System","Standard user. Uses EVzone apps, CorporatePay appears at checkout.",{modules:{"Rides & Logistics":!0,"E-Commerce":!0,"Finance & Payments":!0},marketplaces:{MyLiveDealz:!0,ServiceMart:!0},areas:{dashboard:!0,approvals:!1,reports:!1},actions:{createRFQ:!1,issueBudget:!1,approveSpend:!1,exportReports:!1,toggleSupportMode:!1,adjustInvoice:"none",changeCreditLimit:"none"}},{orgAdminScope:!1,evzoneSupportScope:!1,noSilentActions:!0},"User"),h("EVzone Support","System","Support-only role. No silent actions.",ci("support_view_only",t,s).permsPatch,{orgAdminScope:!1,evzoneSupportScope:!0,noSilentActions:!0},"EVzone Support"),h("Senior Accountant","Custom","Custom role. Can approve invoice adjustments under dual-control.",{areas:{dashboard:!0,invoices:!0,billing:!0,reports:!0,approvals:!0},actions:{exportReports:!0,adjustInvoice:"approve",changeCreditLimit:"request"},modules:{"Finance & Payments":!0,"E-Commerce":!0},marketplaces:{MyLiveDealz:!0,EVmart:!0}},{orgAdminScope:!1,evzoneSupportScope:!1,noSilentActions:!0},"Accountant"),h("Procurement Approver","Custom","Approver focused on RFQs and purchases.",{areas:{dashboard:!0,approvals:!0,reports:!0},actions:{approveSpend:!0,createRFQ:!0},modules:{"E-Commerce":!0,"Rides & Logistics":!0},marketplaces:{MyLiveDealz:!0,ServiceMart:!0}},{orgAdminScope:!1,evzoneSupportScope:!1,noSilentActions:!0},"Approver")]},[T,t,s]),[q,L]=d.useState(k),[R,U]=d.useState(""),[ae,ie]=d.useState(((ve=k[0])==null?void 0:ve.id)||""),_=d.useMemo(()=>q.find(w=>w.id===ae)||null,[q,ae]),W=d.useMemo(()=>[{id:"admin_full",name:"Admin full access",description:"Full access across modules and security."},{id:"manager_ops",name:"Manager operations",description:"Operational access with approvals and reporting."},{id:"accountant_strict",name:"Accountant strict",description:"Billing and invoices. Sensitive actions require dual-control."},{id:"approver_min",name:"Approver minimal",description:"Approvals focused."},{id:"travel_coordinator",name:"Travel coordinator",description:"Rides and travel programs."},{id:"support_view_only",name:"Support view-only",description:"Support-only. No silent actions."},{id:"hospital_compliance",name:"Hospital compliance pack",description:"More approvals for sensitive categories."}],[]),[J,we]=d.useState("manager_ops"),[G,be]=d.useState(!1),[Ge,Me]=d.useState([]),[je,Ue]=d.useState(((P=k[0])==null?void 0:P.id)||""),Oe=d.useMemo(()=>q.find(w=>w.id===je)||null,[q,je]),[he,Y]=d.useState("E-Commerce"),[Ie,ce]=d.useState("MyLiveDealz"),[me,pe]=d.useState(()=>({enabled:!0,requireReason:!0,creditChange:{enabled:!0,thresholdUGX:5e6,requireTwoApprovers:!0,requesterRoles:["Accountant","Admin"],approverRoles:["Admin","Senior Accountant"]},invoiceAdjust:{enabled:!0,thresholdUGX:1e6,requireTwoApprovers:!0,requesterRoles:["Accountant","Admin"],approverRoles:["Admin","Senior Accountant"]}})),[de,ye]=d.useState(()=>{const w=Date.now();return[{id:"DL-001",enabled:!0,fromRole:"Approver",delegateRole:"Procurement Approver",startDate:"2026-01-07",endDate:"2026-01-21",appliesTo:{approvals:!0,rfqs:!0,invoices:!1},reason:"Out-of-office coverage for procurement approvals.",createdAt:w-4*24*60*60*1e3}]}),[Qe,Fe]=d.useState(!1),[ke,fe]=d.useState(null),[Ve,ne]=d.useState(!1),[Te,Ee]=d.useState(null),[Re,ze]=d.useState(!1),[qe,He]=d.useState(""),[_e,le]=d.useState(""),[z,Pe]=d.useState(!1),[Be,xe]=d.useState(!1),[Ne,M]=d.useState(""),[H,Ae]=d.useState(null),oe=w=>{He(w.title),le(""),Pe(!1),xe(!!w.secondRequired),M(w.defaultSecondRole||""),Ae(()=>w.action),ze(!0)},De=()=>{if(_e.trim().length<8||!z){r({title:"Reason required",message:"Provide a clear reason and confirm acknowledgement.",kind:"warn"});return}if(Be&&!Ne){r({title:"Second approver required",message:"Select a second approver role.",kind:"warn"});return}H==null||H(),ze(!1)},$e=d.useMemo(()=>{const w=R.trim().toLowerCase();return q.filter(h=>w?`${h.name} ${h.type} ${h.base||""}`.toLowerCase().includes(w):!0).sort((h,K)=>{const V=h.type==="System"?0:1,Ce=K.type==="System"?0:1;return V!==Ce?V-Ce:h.name.localeCompare(K.name)})},[q,R]),ge=d.useMemo(()=>q.map(w=>w.name),[q]),ue=()=>{if(!_)return;const w=ci(J,t,s),h=cc(_.perms,w.permsPatch),K=kV(_.perms,h,t,s);Me(K),be(!0)},Ke=()=>{if(!_)return;const w=ci(J,t,s),h=cc(_.perms,w.permsPatch),K=w.scopePatch?{..._.scope,...w.scopePatch}:_.scope;oe({title:`Apply template: ${w.name}`,secondRequired:!1,action:()=>{L(V=>V.map(Ce=>Ce.id===_.id?{...Ce,perms:h,scope:K,updatedAt:Date.now()}:Ce)),r({title:"Template applied",message:w.name,kind:"success"})}}),be(!1)},b=()=>{const w=Date.now(),h={id:xh("role"),name:"",type:"Custom",base:"User",description:"",active:!0,scope:{orgAdminScope:!1,evzoneSupportScope:!1,noSilentActions:!0},perms:cc(T,{areas:{dashboard:!0},modules:{"Rides & Logistics":!0,"E-Commerce":!0},marketplaces:{ServiceMart:!0}}),updatedAt:w};Ee(h),ne(!0)},v=w=>{Ee(ry(w)),ne(!0)},u=()=>{if(!Te)return;const w=Te.name.trim();if(!w){r({title:"Missing name",message:"Role name is required.",kind:"warn"});return}if(Te.type==="Custom"&&ge.some(h=>h.toLowerCase()===w.toLowerCase()&&ae!==Te.id)){r({title:"Name exists",message:"Choose a unique role name.",kind:"warn"});return}oe({title:ge.includes(Te.name)?"Update role":"Create role",action:()=>{L(h=>h.some(V=>V.id===Te.id)?h.map(V=>V.id===Te.id?{...Te,updatedAt:Date.now()}:V):[{...Te,updatedAt:Date.now()},...h]),ie(Te.id),r({title:"Saved",message:"Role saved.",kind:"success"})}}),ne(!1)},C=w=>{if(w.type!=="Custom"){r({title:"Blocked",message:"System roles cannot be deleted.",kind:"warn"});return}oe({title:"Delete role",action:()=>{var h;L(K=>K.filter(V=>V.id!==w.id)),ae===w.id&&ie(((h=q.find(K=>K.type==="System"))==null?void 0:h.id)||""),r({title:"Deleted",message:"Role removed.",kind:"info"})}})},Q=w=>{fe(w?ry(w):{id:xh("DL"),enabled:!0,fromRole:"Approver",delegateRole:"Manager",startDate:"2026-01-07",endDate:"2026-01-14",appliesTo:{approvals:!0,rfqs:!0,invoices:!1},reason:"Coverage",createdAt:Date.now()}),Fe(!0)},O=()=>{if(ke){if(!ke.reason.trim()){r({title:"Reason required",message:"Add a reason for delegation.",kind:"warn"});return}oe({title:"Save delegation",action:()=>{ye(w=>w.some(K=>K.id===ke.id)?w.map(K=>K.id===ke.id?{...ke}:K):[{...ke},...w]),r({title:"Saved",message:"Delegation saved.",kind:"success"})}}),Fe(!1)}},ee=w=>{oe({title:"Delete delegation",action:()=>{ye(h=>h.filter(K=>K.id!==w)),r({title:"Deleted",message:"Delegation removed.",kind:"info"})}})},F=w=>{$(""),g(w)},D=()=>{if(N.trim().length<8){r({title:"Reason required",message:"Provide a clear reason for support mode change.",kind:"warn"});return}oe({title:j==="enable"?"Enable support mode":"Disable support mode",action:()=>{x(j==="enable"),r({title:j==="enable"?"Support enabled":"Support disabled",message:"Audit log updated.",kind:"success"})}}),g(null)},m=d.useMemo(()=>Oe?[{key:"dashboard",label:"Dashboard"},{key:"users",label:"Users"},{key:"groups",label:"Groups"},{key:"orgSetup",label:"Org setup"},{key:"policies",label:"Policy builder"},{key:"approvals",label:"Approvals"},{key:"billing",label:"Billing"},{key:"invoices",label:"Invoices"},{key:"integrations",label:"Integrations"},{key:"reports",label:"Reports"},{key:"security",label:"Security"}]:[],[Oe]),A=d.useMemo(()=>[{key:"createRFQ",label:"Create RFQ"},{key:"issueBudget",label:"Issue budget"},{key:"approveSpend",label:"Approve spend"},{key:"exportReports",label:"Export reports"},{key:"adjustInvoice",label:"Adjust invoice"},{key:"changeCreditLimit",label:"Change credit limit"}],[]),f=w=>{if(!Oe)return;if(Oe.name==="EVzone Support"&&!c){r({title:"Blocked",message:"Support mode is disabled for this organization.",kind:"warn"});return}if(w!=="exportReports"&&w!=="toggleSupportMode"){if(!Gv(Oe,he)){r({title:"Blocked",message:`Module disabled for role: ${he}`,kind:"warn"});return}if(he==="E-Commerce"&&!qv(Oe,Ie)){r({title:"Blocked",message:`Marketplace disabled for role: ${Ie}`,kind:"warn"});return}}if(Bv(Oe)&&w!=="exportReports"){if(w==="adjustInvoice"||w==="changeCreditLimit"){if(Oe.perms.actions[w]==="none"){r({title:"Blocked",message:"Support cannot perform this action. Only request is allowed.",kind:"warn"});return}oe({title:`Support request: ${w}`,secondRequired:!1,action:()=>{r({title:"Ticket created",message:"Support request logged and visible to org admins.",kind:"success"})}});return}r({title:"Blocked",message:"Support cannot perform write actions. Create a ticket instead.",kind:"warn"});return}if(!CV(Oe,w)){r({title:"Denied",message:"Role lacks permission for this action.",kind:"warn"});return}if((w==="adjustInvoice"||w==="changeCreditLimit")&&me.enabled&&me.requireReason){const K=w==="adjustInvoice"?me.invoiceAdjust:me.creditChange,V=Oe.perms.actions[w],Ce=K.enabled&&K.requireTwoApprovers&&V==="approve",I=q.filter(te=>te.active).filter(te=>te.perms.actions[w]==="approve").map(te=>te.name).filter(te=>te!==Oe.name);oe({title:`Confirm ${w}`,secondRequired:Ce,defaultSecondRole:I[0]||"",action:()=>{r({title:"Submitted",message:Ce?"Dual-control: second approval required.":"Action submitted.",kind:"success"})}});return}r({title:"Allowed",message:"Action allowed (demo).",kind:"success"})},B=w=>{_&&L(h=>h.map(K=>K.id===_.id?{...K,...w,updatedAt:Date.now()}:K))},p=w=>{_&&B({perms:cc(_.perms,w)})},E=w=>{_&&B({scope:{..._.scope,...w}})},se=d.useMemo(()=>q.some(w=>w.name==="EVzone Support"),[q]),y=d.useMemo(()=>{if(!_)return null;const w=t.filter(Ce=>_.perms.modules[Ce]).length,h=s.filter(Ce=>_.perms.marketplaces[Ce]).length,K=Object.values(_.perms.areas).filter(Boolean).length,V=Object.entries(_.perms.actions).filter(([,Ce])=>typeof Ce=="boolean"?Ce:Ce!=="none").length;return{enabledModules:w,enabledMk:h,enabledAreas:K,actions:V}},[_,t,s]),re=d.useMemo(()=>q.find(h=>h.name==="Approver")?{title:"Approver inactivity detected",body:"An approver has been inactive. Consider enabling out-of-office delegation to avoid SLA breaches."}:null,[q]);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(NV,{toasts:l,onDismiss:w=>n(h=>h.filter(K=>K.id!==w))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:Cd.green},children:e.jsx(yt,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Roles, Permissions and Admin Governance"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"System roles, custom roles, two-admin model, delegation, templates, simulations, and dual-control."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(Qt,{label:`Roles: ${q.length}`,tone:"neutral"}),e.jsx(Qt,{label:`Support mode: ${c?"Enabled":"Disabled"}`,tone:c?"good":"warn"}),e.jsx(Qt,{label:`Dual-control: ${me.enabled?"On":"Off"}`,tone:me.enabled?"info":"neutral"}),e.jsx(Qt,{label:"No silent actions",tone:"neutral"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(cs,{variant:"outline",onClick:()=>o("Simulation"),children:[e.jsx(ty,{className:"h-4 w-4"})," View as role"]}),e.jsxs(cs,{variant:"outline",onClick:b,children:[e.jsx(pt,{className:"h-4 w-4"})," New custom role"]}),e.jsxs(cs,{variant:"primary",onClick:()=>r({title:"Saved",message:"Governance settings saved (demo).",kind:"success"}),children:[e.jsx(Ia,{className:"h-4 w-4"})," Save"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:["Roles","Delegation","Dual-control","Simulation"].map(w=>e.jsx("button",{className:hn("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",i===w?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:i===w?{background:Cd.green}:void 0,onClick:()=>o(w),children:w},w))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[i==="Roles"?e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Roles"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"System and custom roles"})]}),e.jsx(Qt,{label:"Core",tone:"neutral"})]}),e.jsxs("div",{className:"mt-3 flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[e.jsx(ka,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:R,onChange:w=>U(w.target.value),placeholder:"Search roles",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:$e.map(w=>{const h=w.id===ae;return e.jsx("button",{type:"button",onClick:()=>ie(w.id),className:hn("w-full rounded-3xl border p-4 text-left transition",h?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:w.name}),e.jsx(Qt,{label:w.type,tone:w.type==="System"?"neutral":"info"}),w.active?null:e.jsx(Qt,{label:"Disabled",tone:"warn"}),w.scope.evzoneSupportScope?e.jsx(Qt,{label:"Support",tone:"info"}):null]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[w.base?`Base: ${w.base}`:"Custom","  Updated ",jV(w.updatedAt)]})]}),e.jsx(et,{className:"mt-0.5 h-5 w-5 text-slate-400"})]})},w.id)})}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2",children:[e.jsxs(cs,{variant:"outline",onClick:b,children:[e.jsx(pt,{className:"h-4 w-4"})," Create custom role"]}),e.jsxs(cs,{variant:"outline",onClick:()=>{_&&v(_)},disabled:!_||_.type!=="Custom",children:[e.jsx(Ia,{className:"h-4 w-4"})," Edit selected role"]}),e.jsxs(cs,{variant:"danger",onClick:()=>_&&C(_),disabled:!_||_.type!=="Custom",children:[e.jsx(as,{className:"h-4 w-4"})," Delete selected role"]})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Two-admin model"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Org admins vs EVzone support scope"})]}),e.jsx(Qt,{label:"Core",tone:"neutral"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Support mode must be enabled for EVzone support to sign in. Support is support-only and has no silent actions."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2",children:[e.jsxs(cs,{variant:c?"danger":"primary",onClick:()=>F(c?"disable":"enable"),children:[e.jsx(yt,{className:"h-4 w-4"})," ",c?"Disable support mode":"Enable support mode"]}),se?null:e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"EVzone Support role is missing. Add it as a system role in production."})]})]}),re?e.jsxs("div",{className:"rounded-3xl border border-amber-200 bg-amber-50 p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Governance alert"}),e.jsx("div",{className:"mt-1 text-xs text-slate-700",children:re.title})]}),e.jsx(Qt,{label:"Premium",tone:"info"})]}),e.jsx("div",{className:"mt-3 text-sm text-slate-700",children:re.body}),e.jsxs(cs,{variant:"outline",className:"mt-3 w-full",onClick:()=>o("Delegation"),children:[e.jsx(et,{className:"h-4 w-4"})," Open delegation"]})]}):null]}),e.jsx("div",{className:"space-y-4",children:_?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-base font-semibold text-slate-900",children:_.name}),e.jsx(Qt,{label:_.type,tone:_.type==="System"?"neutral":"info"}),_.scope.evzoneSupportScope?e.jsx(Qt,{label:"EVzone Support scope",tone:"info"}):null,_.scope.orgAdminScope?e.jsx(Qt,{label:"Org admin scope",tone:"neutral"}):null,_.scope.noSilentActions?e.jsx(Qt,{label:"No silent actions",tone:"neutral"}):null]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Updated ",bV(_.updatedAt)]}),e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:_.description||"-"}),y?e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsx(Qt,{label:`Modules: ${y.enabledModules}`,tone:"neutral"}),e.jsx(Qt,{label:`Marketplaces: ${y.enabledMk}`,tone:"neutral"}),e.jsx(Qt,{label:`Areas: ${y.enabledAreas}`,tone:"neutral"}),e.jsx(Qt,{label:`Actions: ${y.actions}`,tone:"neutral"})]}):null]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(cs,{variant:"outline",onClick:()=>B({active:!_.active}),children:_.active?"Disable role":"Enable role"}),e.jsxs(cs,{variant:"outline",onClick:ue,children:[e.jsx(wa,{className:"h-4 w-4"})," Apply template"]}),e.jsxs(cs,{variant:"primary",onClick:()=>r({title:"Saved",message:"Role permissions saved (demo).",kind:"success"}),children:[e.jsx(Ia,{className:"h-4 w-4"})," Save"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Scopes"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Two-admin model and safety"})]}),e.jsx(Qt,{label:"Core",tone:"neutral"})]}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsx(Aa,{enabled:_.scope.orgAdminScope,onChange:w=>E({orgAdminScope:w}),label:"Org admin scope",description:"Allows organization-wide configuration actions.",disabled:_.type==="System"&&_.name==="EVzone Support"}),e.jsx(Aa,{enabled:_.scope.evzoneSupportScope,onChange:w=>E({evzoneSupportScope:w}),label:"EVzone support scope",description:"Support-only access. Must not be used by regular org admins.",disabled:_.type==="System"&&_.name!=="EVzone Support"}),e.jsx(Aa,{enabled:_.scope.noSilentActions,onChange:w=>E({noSilentActions:w}),label:"No silent actions",description:"Write actions require visible confirmation and audit."}),Bv(_)?e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Support scope with no silent actions: support can view and create requests, but cannot silently change billing."}):null]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Policy-driven templates"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: apply a permission preset"})]}),e.jsx(Qt,{label:"Premium",tone:"info"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3",children:[e.jsx(Tr,{label:"Template",value:J,onChange:w=>we(w),options:W.map(w=>({value:w.id,label:w.name})),hint:"Preview available"}),e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:(X=W.find(w=>w.id===J))==null?void 0:X.description}),e.jsxs(cs,{variant:"outline",onClick:ue,children:[e.jsx(ty,{className:"h-4 w-4"})," Preview and apply"]})]})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Permissions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Service Modules, Marketplaces, areas, and actions"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(cs,{variant:"outline",onClick:()=>{const w={};t.forEach(h=>w[h]=!0),p({modules:w}),r({title:"Updated",message:"All modules enabled (draft).",kind:"success"})},children:[e.jsx(pt,{className:"h-4 w-4"})," Enable all modules"]}),e.jsxs(cs,{variant:"outline",onClick:()=>{const w={};t.forEach(h=>w[h]=!1),p({modules:w}),r({title:"Updated",message:"All modules disabled (draft).",kind:"info"})},children:[e.jsx(Ye,{className:"h-4 w-4"})," Disable all modules"]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 lg:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Service Modules"}),e.jsx("div",{className:"mt-2 grid grid-cols-1 gap-2 sm:grid-cols-2",children:t.map(w=>e.jsx(Aa,{enabled:_.perms.modules[w],onChange:h=>p({modules:{[w]:h}}),label:w},w))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Marketplaces (E-Commerce)"}),e.jsx(Qt,{label:_.perms.modules["E-Commerce"]?"E-Commerce enabled":"E-Commerce off",tone:_.perms.modules["E-Commerce"]?"good":"warn"})]}),e.jsx("div",{className:hn("mt-2 grid grid-cols-1 gap-2 sm:grid-cols-2",!_.perms.modules["E-Commerce"]&&"opacity-60"),children:s.map(w=>e.jsx(Aa,{enabled:_.perms.marketplaces[w],onChange:h=>p({marketplaces:{[w]:h}}),label:w,disabled:!_.perms.modules["E-Commerce"]},w))}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Marketplace permissions apply only if E-Commerce module is enabled."})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 lg:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Areas"}),e.jsx("div",{className:"mt-2 grid grid-cols-1 gap-2 sm:grid-cols-2",children:Object.keys(_.perms.areas).map(w=>e.jsx(Aa,{enabled:_.perms.areas[w],onChange:h=>p({areas:{[w]:h}}),label:w},w))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Actions"}),e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsx(Aa,{enabled:_.perms.actions.createRFQ,onChange:w=>p({actions:{createRFQ:w}}),label:"Create RFQ"}),e.jsx(Aa,{enabled:_.perms.actions.issueBudget,onChange:w=>p({actions:{issueBudget:w}}),label:"Issue budget"}),e.jsx(Aa,{enabled:_.perms.actions.approveSpend,onChange:w=>p({actions:{approveSpend:w}}),label:"Approve spend"}),e.jsx(Aa,{enabled:_.perms.actions.exportReports,onChange:w=>p({actions:{exportReports:w}}),label:"Export reports"}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Sensitive actions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Premium: dual-control (4-eyes) may apply."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(Tr,{label:"Adjust invoice",value:_.perms.actions.adjustInvoice,onChange:w=>p({actions:{adjustInvoice:w}}),options:[{value:"none",label:"No access"},{value:"request",label:"Request"},{value:"approve",label:"Approve"}],hint:"Dual-control"}),e.jsx(Tr,{label:"Change credit limit",value:_.perms.actions.changeCreditLimit,onChange:w=>p({actions:{changeCreditLimit:w}}),options:[{value:"none",label:"No access"},{value:"request",label:"Request"},{value:"approve",label:"Approve"}],hint:"Dual-control"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Best practice: set these to Request for most roles, and use dual-control to approve."})]})]})]})]})]}),e.jsx("div",{className:"text-xs text-slate-500",children:"Premium: use Simulation tab to see exactly what this role can access."})]}):e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-10 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(yt,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No role selected"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Select a role from the left."})]})})]}):null,i==="Delegation"?e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Approval delegation and out-of-office"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Route approvals when approvers are unavailable."})]}),e.jsx(Qt,{label:"Core",tone:"neutral"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Delegation can apply to approvals, RFQs, and invoice approvals."}),e.jsxs(cs,{variant:"primary",className:"mt-3 w-full",onClick:()=>Q(),children:[e.jsx(pt,{className:"h-4 w-4"})," New delegation"]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: show prompts when approver goes inactive, or when SLAs breach."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Suggested policies"}),e.jsxs("ul",{className:"mt-3 space-y-2 text-sm text-slate-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:Cd.green}})," Require reason for every delegation."]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:Cd.orange}})," Avoid delegating to EVzone Support."]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:Cd.green}})," Use end dates and review regularly."]})]})]})]}),e.jsx("div",{children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-4 py-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Delegations"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Active and scheduled delegations"})]}),e.jsxs(cs,{variant:"outline",onClick:()=>Q(),children:[e.jsx(pt,{className:"h-4 w-4"})," Add"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"From"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Delegate"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Dates"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Applies to"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsx("tbody",{children:de.map(w=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:w.fromRole}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:w.delegateRole}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[w.startDate," to ",w.endDate]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[w.appliesTo.approvals?e.jsx(Qt,{label:"Approvals",tone:"neutral"}):null,w.appliesTo.rfqs?e.jsx(Qt,{label:"RFQs",tone:"neutral"}):null,w.appliesTo.invoices?e.jsx(Qt,{label:"Invoices",tone:"neutral"}):null]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Qt,{label:w.enabled?"Enabled":"Off",tone:w.enabled?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(cs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Q(w),children:"Edit"}),e.jsx(cs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{ye(h=>h.map(K=>K.id===w.id?{...K,enabled:!K.enabled}:K)),r({title:"Updated",message:`Delegation ${w.enabled?"disabled":"enabled"}.`,kind:"success"})},children:w.enabled?"Disable":"Enable"}),e.jsx(cs,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>ee(w.id),children:e.jsx(as,{className:"h-4 w-4"})})]})})]},w.id))})]})}),e.jsx("div",{className:"border-t border-slate-200 px-4 py-3 text-xs text-slate-500",children:"Premium: delegations can be linked to Approval Workflow Builder SLAs."})]})})]}):null,i==="Dual-control"?e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Dual-control (4-eyes)"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: protect sensitive actions"})]}),e.jsx(Qt,{label:"Premium",tone:"info"})]}),e.jsx(Aa,{enabled:me.enabled,onChange:w=>pe(h=>({...h,enabled:w})),label:"Enable dual-control",description:"Apply to invoice adjustments and credit limit changes."}),e.jsx(Aa,{enabled:me.requireReason,onChange:w=>pe(h=>({...h,requireReason:w})),label:"Require reason",description:"Always prompt for a reason in audit logs.",disabled:!me.enabled}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Best practice: enable dual-control for credit changes and invoice adjustments."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Who can approve?"}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Roles with Approve level for sensitive actions"}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Credit limit approvers"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[ph(q,"changeCreditLimit","approve").map(w=>e.jsx(Qt,{label:w.name,tone:"neutral"},w.id)),ph(q,"changeCreditLimit","approve").length?null:e.jsx(Qt,{label:"None",tone:"warn"})]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Invoice adjust approvers"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[ph(q,"adjustInvoice","approve").map(w=>e.jsx(Qt,{label:w.name,tone:"neutral"},w.id)),ph(q,"adjustInvoice","approve").length?null:e.jsx(Qt,{label:"None",tone:"warn"})]})]})]}),e.jsx("div",{className:"mt-3 text-xs text-slate-500",children:"Tune these in Roles tab under Sensitive actions."})]})]}),e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Credit limit changes"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Configure thresholds and who can request and approve."})]}),e.jsx(Qt,{label:me.creditChange.enabled?"Enabled":"Off",tone:me.creditChange.enabled?"good":"neutral"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Aa,{enabled:me.creditChange.enabled,onChange:w=>pe(h=>({...h,creditChange:{...h.creditChange,enabled:w}})),label:"Enable",description:"Enforce dual-control for credit changes",disabled:!me.enabled}),e.jsx(Aa,{enabled:me.creditChange.requireTwoApprovers,onChange:w=>pe(h=>({...h,creditChange:{...h.creditChange,requireTwoApprovers:w}})),label:"Require 2 approvers",description:"4-eyes for approve-level actions",disabled:!me.enabled||!me.creditChange.enabled}),e.jsx(di,{label:"Threshold (UGX)",value:String(me.creditChange.thresholdUGX),onChange:w=>pe(h=>({...h,creditChange:{...h.creditChange,thresholdUGX:Number(w||0)}})),type:"number",hint:`Example: ${C4(me.creditChange.thresholdUGX)}`,disabled:!me.enabled||!me.creditChange.enabled}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Notes"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"In production, requests above threshold require dual approval and are audit logged."})]})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Invoice adjustments"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Protect invoice edits, credits, and line item corrections."})]}),e.jsx(Qt,{label:me.invoiceAdjust.enabled?"Enabled":"Off",tone:me.invoiceAdjust.enabled?"good":"neutral"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Aa,{enabled:me.invoiceAdjust.enabled,onChange:w=>pe(h=>({...h,invoiceAdjust:{...h.invoiceAdjust,enabled:w}})),label:"Enable",description:"Enforce dual-control for invoice adjustments",disabled:!me.enabled}),e.jsx(Aa,{enabled:me.invoiceAdjust.requireTwoApprovers,onChange:w=>pe(h=>({...h,invoiceAdjust:{...h.invoiceAdjust,requireTwoApprovers:w}})),label:"Require 2 approvers",description:"4-eyes for approve-level actions",disabled:!me.enabled||!me.invoiceAdjust.enabled}),e.jsx(di,{label:"Threshold (UGX)",value:String(me.invoiceAdjust.thresholdUGX),onChange:w=>pe(h=>({...h,invoiceAdjust:{...h.invoiceAdjust,thresholdUGX:Number(w||0)}})),type:"number",hint:`Example: ${C4(me.invoiceAdjust.thresholdUGX)}`,disabled:!me.enabled||!me.invoiceAdjust.enabled}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Notes"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Use invoice group policies to restrict who can request edits."})]})]})]}),e.jsx("div",{className:"rounded-3xl border border-amber-200 bg-amber-50 p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-white text-amber-800 ring-1 ring-amber-200",children:e.jsx(Mt,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Dual-control guidance"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:"Grant Approve level only to a small set of roles. Most roles should Request only."})]})]})})]})]}):null,i==="Simulation"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"View as role"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: permission simulation"})]}),e.jsx(Qt,{label:"Premium",tone:"info"})]}),e.jsx(Tr,{label:"Role",value:je,onChange:w=>Ue(w),options:q.map(w=>({value:w.id,label:`${w.name} (${w.type})`}))}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3",children:[e.jsx(Tr,{label:"Module context",value:he,onChange:w=>Y(w),options:t.map(w=>({value:w,label:w}))}),e.jsx(Tr,{label:"Marketplace context",value:Ie,onChange:w=>ce(w),options:s.map(w=>({value:w,label:w})),disabled:he!=="E-Commerce",hint:he!=="E-Commerce"?"Applies to E-Commerce":void 0})]}),(Oe==null?void 0:Oe.name)==="EVzone Support"?e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Support role is gated by Support mode. No silent actions. Sensitive actions are requests."}):null,e.jsxs("div",{className:"mt-3 rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-700",children:["Support mode: ",e.jsx("span",{className:"font-semibold text-slate-900",children:c?"Enabled":"Disabled"}),e.jsx("div",{className:"mt-2",children:e.jsxs(cs,{variant:c?"danger":"primary",className:"w-full",onClick:()=>F(c?"disable":"enable"),children:[e.jsx(yt,{className:"h-4 w-4"})," ",c?"Disable support":"Enable support"]})})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Try actions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Attempt actions under current role and context."}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2",children:A.map(w=>e.jsxs(cs,{variant:"outline",onClick:()=>f(w.key),children:[e.jsx(et,{className:"h-4 w-4"})," ",w.label]},w.key))}),e.jsx("div",{className:"mt-3 text-xs text-slate-500",children:"Sensitive actions may require audit reason and a second approver."})]})]}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Access preview"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Pages and modules visible to this role."})]}),e.jsx(Qt,{label:"Simulation",tone:"info"})]}),Oe?e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 lg:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Pages"}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2",children:m.map(w=>e.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:w.label}),e.jsx(Qt,{label:S4(Oe,w.key)?"Allowed":"Hidden",tone:S4(Oe,w.key)?"good":"neutral"})]},String(w.key)))})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Modules"}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2",children:t.map(w=>e.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:w}),e.jsx(Qt,{label:Gv(Oe,w)?"On":"Off",tone:Gv(Oe,w)?"good":"neutral"})]},w))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"For E-Commerce, marketplace toggles further restrict access."})]})]}):e.jsx("div",{className:"mt-4 text-sm text-slate-600",children:"Select a role."}),Oe&&he==="E-Commerce"?e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Marketplaces"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Marketplace access for this role"})]}),e.jsx(Qt,{label:"E-Commerce",tone:"neutral"})]}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2 sm:grid-cols-2",children:s.map(w=>e.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:w}),e.jsx(Qt,{label:qv(Oe,w)?"On":"Off",tone:qv(Oe,w)?"good":"neutral"})]},w))})]}):null,Oe&&Bv(Oe)?e.jsx("div",{className:"mt-4 rounded-3xl border border-amber-200 bg-amber-50 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-white text-amber-800 ring-1 ring-amber-200",children:e.jsx(Mt,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Support safety"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:"Support can never perform silent actions. All requests create visible tickets and audit logs."})]})]})}):null]})})]}):null]}),e.jsx("div",{className:"mt-4 text-xs text-slate-500",children:"H Roles, Permissions & Admin Governance v2: system roles, custom roles, module and marketplace permissions, two-admin model, delegation, permission simulation, templates, and dual-control."})]})}),e.jsxs(dm,{open:G,title:"Template preview",subtitle:"See what changes before applying.",onClose:()=>be(!1),actions:[{label:"Apply",onClick:Ke}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(cs,{variant:"outline",onClick:()=>be(!1),children:"Cancel"}),e.jsxs(cs,{variant:"primary",onClick:Ke,children:[e.jsx(wa,{className:"h-4 w-4"})," Apply"]})]}),maxW:"980px",children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Template: ",e.jsx("span",{className:"font-semibold text-slate-900",children:(S=W.find(w=>w.id===J))==null?void 0:S.name})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Changes"}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Showing up to 60 items"}),e.jsxs("div",{className:"mt-3 space-y-2",children:[Ge.slice(0,60).map((w,h)=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 text-sm text-slate-700",children:w},h)),Ge.length?null:e.jsx("div",{className:"rounded-2xl bg-emerald-50 p-3 text-sm text-emerald-900 ring-1 ring-emerald-200",children:"No changes detected."})]})]})]}),e.jsx(dm,{open:Ve,title:(Te==null?void 0:Te.type)==="Custom"?ge.includes((Te==null?void 0:Te.name)||"")?"Edit custom role":"Create custom role":"Role",subtitle:"Custom roles can be scoped by modules, marketplaces, areas, and actions.",onClose:()=>ne(!1),actions:[{label:"Save",onClick:u}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(cs,{variant:"outline",onClick:()=>ne(!1),children:"Cancel"}),e.jsxs(cs,{variant:"primary",onClick:u,children:[e.jsx(Ia,{className:"h-4 w-4"})," Save"]})]}),maxW:"980px",children:Te?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(di,{label:"Role name",required:!0,value:Te.name,onChange:w=>Ee(h=>h&&{...h,name:w}),placeholder:"Role name"}),e.jsx(Tr,{label:"Base",value:Te.base||"User",onChange:w=>Ee(h=>h&&{...h,base:w}),options:a.filter(w=>w!=="EVzone Support").map(w=>({value:w,label:w})),hint:"Starter"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(di,{label:"Description",value:Te.description,onChange:w=>Ee(h=>h&&{...h,description:w}),placeholder:"Description"})})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Quick setup"}),e.jsx("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:["manager_ops","accountant_strict","approver_min","travel_coordinator","hospital_compliance"].map(w=>{var h;return e.jsxs(cs,{variant:"outline",onClick:()=>{const K=ci(w,t,s);Ee(V=>V&&{...V,perms:cc(V.perms,K.permsPatch),scope:K.scopePatch?{...V.scope,...K.scopePatch}:V.scope}),r({title:"Template applied",message:K.name,kind:"success"})},children:[e.jsx(ht,{className:"h-4 w-4"})," ",((h=W.find(K=>K.id===w))==null?void 0:h.name)||w]},w)})}),e.jsx("div",{className:"mt-3 text-xs text-slate-600",children:"You can adjust details after applying."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Safety scope"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(Aa,{enabled:Te.scope.orgAdminScope,onChange:w=>Ee(h=>h&&{...h,scope:{...h.scope,orgAdminScope:w}}),label:"Org admin scope"}),e.jsx(Aa,{enabled:Te.scope.noSilentActions,onChange:w=>Ee(h=>h&&{...h,scope:{...h.scope,noSilentActions:w}}),label:"No silent actions"}),e.jsx(Aa,{enabled:Te.scope.evzoneSupportScope,onChange:w=>Ee(h=>h&&{...h,scope:{...h.scope,evzoneSupportScope:w}}),label:"EVzone support scope",description:"Use only for support accounts"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Avoid giving both Org admin scope and EVzone support scope to the same role."})]})]}):null}),e.jsx(dm,{open:Qe,title:ke!=null&&ke.id?"Delegation":"New delegation",subtitle:"Approval delegation and out-of-office coverage.",onClose:()=>Fe(!1),actions:[{label:"Save",onClick:O}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(cs,{variant:"outline",onClick:()=>Fe(!1),children:"Cancel"}),e.jsxs(cs,{variant:"primary",onClick:O,children:[e.jsx(Ia,{className:"h-4 w-4"})," Save"]})]}),maxW:"980px",children:ke?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Tr,{label:"From role",value:ke.fromRole,onChange:w=>fe(h=>h&&{...h,fromRole:w}),options:q.map(w=>({value:w.name,label:w.name}))}),e.jsx(Tr,{label:"Delegate role",value:ke.delegateRole,onChange:w=>fe(h=>h&&{...h,delegateRole:w}),options:q.map(w=>({value:w.name,label:w.name}))}),e.jsx(di,{label:"Start date",value:ke.startDate,onChange:w=>fe(h=>h&&{...h,startDate:w}),type:"date"}),e.jsx(di,{label:"End date",value:ke.endDate,onChange:w=>fe(h=>h&&{...h,endDate:w}),type:"date"})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Applies to"}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-3",children:[{k:"approvals",label:"Approvals"},{k:"rfqs",label:"RFQs"},{k:"invoices",label:"Invoices"}].map(w=>e.jsx(Aa,{enabled:ke.appliesTo[w.k],onChange:h=>fe(K=>K&&{...K,appliesTo:{...K.appliesTo,[w.k]:h}}),label:w.label},w.k))})]}),e.jsx(di,{label:"Reason",value:ke.reason,onChange:w=>fe(h=>h&&{...h,reason:w}),placeholder:"Reason",required:!0}),e.jsx(Aa,{enabled:ke.enabled,onChange:w=>fe(h=>h&&{...h,enabled:w}),label:ke.enabled?"Enabled":"Off",description:"Disable without deleting to preserve history"}),e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: this can be connected to out-of-office status in user profiles."})]}):null}),e.jsxs(dm,{open:j!==null,title:j==="enable"?"Enable support mode":"Disable support mode",subtitle:"This change is audited and visible to org admins.",onClose:()=>g(null),actions:[{label:"Confirm",onClick:D,variant:j==="enable"?"default":"danger"}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(cs,{variant:"outline",onClick:()=>g(null),children:"Cancel"}),e.jsxs(cs,{variant:j==="enable"?"primary":"danger",onClick:D,children:[e.jsx(yt,{className:"h-4 w-4"})," Confirm"]})]}),maxW:"860px",children:[e.jsx(di,{label:"Reason",value:N,onChange:$,placeholder:"Example: allow EVzone to troubleshoot invoice delivery",required:!0,hint:"Minimum 8 characters"}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Support sessions are always audited. No silent actions."})]}),e.jsx(dm,{open:Re,title:qe||"Confirm action",subtitle:"Audit-friendly confirmation and reason prompt.",onClose:()=>ze(!1),actions:[{label:"Confirm",onClick:De,disabled:_e.trim().length<8||!z||Be&&!Ne}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(cs,{variant:"outline",onClick:()=>ze(!1),children:"Cancel"}),e.jsxs(cs,{variant:"primary",onClick:De,disabled:_e.trim().length<8||!z||Be&&!Ne,children:[e.jsx(ct,{className:"h-4 w-4"})," Confirm"]})]}),maxW:"980px",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(di,{label:"Reason",value:_e,onChange:le,placeholder:"Explain why you are making this change",required:!0,hint:"Minimum 8 characters"}),Be?e.jsx(Tr,{label:"Second approver role",value:Ne,onChange:M,options:q.filter(w=>w.active).map(w=>({value:w.name,label:w.name})),hint:"Dual-control"}):null,e.jsxs("label",{className:"flex items-start gap-3 rounded-2xl border border-slate-200 bg-slate-50 p-3",children:[e.jsx("input",{type:"checkbox",checked:z,onChange:w=>Pe(w.target.checked),className:"mt-1 h-4 w-4 rounded border-slate-300"}),e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"I confirm this action is authorized and will be audit logged."})]}),e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 text-xs text-slate-600",children:"Premium: audit log includes policy versions, role, IP, device, and support watermark."})]})}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"H Roles, Permissions & Admin Governance v2: roles, permissions, templates, simulations, delegation, two-admin model, and dual-control."})})]})}const ho={green:"#03CD8C",orange:"#F77F00"};function bs(...t){return t.filter(Boolean).join(" ")}function AV(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function la(t){return JSON.parse(JSON.stringify(t))}function mx(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function ea({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:bs("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Qa({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:ho.green}:t==="accent"?{background:ho.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:bs(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Bn({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:bs(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:bs("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold shadow-sm outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function zv({label:t,value:s,onChange:a,hint:l,disabled:n}){return e.jsxs("div",{className:bs(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",value:s,onChange:r=>a(Number(r.target.value||0)),disabled:n,className:bs("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold shadow-sm outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function A4({enabled:t,onChange:s,label:a,description:l,disabled:n}){return e.jsxs("div",{className:bs("flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",n&&"opacity-70"),children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",disabled:n,className:bs("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white",n&&"cursor-not-allowed"),onClick:()=>!n&&s(!t),"aria-label":a,children:e.jsx("span",{className:bs("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function cm({label:t,onRemove:s,tone:a="neutral"}){const l={neutral:"bg-slate-50 text-slate-700 ring-slate-200",good:"bg-emerald-50 text-emerald-800 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200"};return e.jsxs("span",{className:bs("inline-flex items-center gap-2 rounded-full px-3 py-2 text-xs font-semibold ring-1",l[a]),children:[t,s?e.jsx("button",{type:"button",className:"rounded-full p-1 hover:bg-black/5",onClick:s,"aria-label":`Remove ${t}`,children:e.jsx(Ye,{className:"h-3.5 w-3.5"})}):null]})}function ui({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function Rr({enabled:t,onToggle:s}){return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ea,{label:t?"Override":"Inherited",tone:t?"warn":"neutral"}),e.jsx("button",{type:"button",className:bs("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":"Toggle override",children:e.jsx("span",{className:bs("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function EV({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:bs("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function um(t,s,a){const l=la(t),n=r=>{r&&(r.rides&&Object.keys(r.rides).forEach(i=>{l.rides[i]=la(r.rides[i])}),r.purchases&&Object.keys(r.purchases).forEach(i=>{l.purchases[i]=la(r.purchases[i])}))};return n(s),n(a),l}function iy(t,s,a){return!!(t!=null&&t[s])&&Object.prototype.hasOwnProperty.call(t[s],a)}function Wv(t,s,a,l){const n=la(t||{});return n[s]=n[s]||{},n[s][a]=la(l),n}function MV(t,s,a){const l=la(t||{});return l[s]&&Object.prototype.hasOwnProperty.call(l[s],a)&&delete l[s][a],l}function PV(t,s,a,l,n){return a&&iy(a,l,n)?"User":s&&iy(s,l,n)?"Group":(t&&Object.prototype.hasOwnProperty.call(t[l],n),"Org")}function OV(t){const s=[];t.rides.categories.premium&&s.push({title:"Premium rides are enabled",body:"Consider requiring approvals for premium rides or restricting premium to Managers to reduce cost.",tone:"info"}),t.rides.purpose.required||s.push({title:"Purpose tags are not required",body:"Enable purpose tags to improve reconciliation and chargeback reporting.",tone:"info"}),t.rides.geofences.length===0&&s.push({title:"No geofences configured",body:"Add allowed cities, office zones, and airports to prevent unauthorized trips.",tone:"warn"}),Object.entries(t.purchases.allowedModules).filter(([,r])=>r).map(([r])=>r).length===0&&s.push({title:"No service modules allowed",body:"Enable at least one module for purchases/services to use CorporatePay.",tone:"warn"});const l=t.purchases.allowedModules["E-Commerce"],n=Object.entries(t.purchases.allowedMarketplaces).filter(([,r])=>r).map(([r])=>r);return l&&n.length===0&&s.push({title:"E-Commerce is allowed but no marketplaces are allowed",body:"Enable MyLiveDealz and the marts you want to allow, or disable E-Commerce in purchase policy.",tone:"warn"}),l&&t.purchases.vendorAllow.length===0&&s.push({title:"No vendor allowlist",body:"Add preferred vendors to an allowlist for better control and negotiated pricing.",tone:"info"}),t.purchases.maxBasket>5e6&&s.push({title:"High max basket size",body:"Consider lowering max basket size or routing baskets above threshold to approvals.",tone:"warn"}),t.purchases.attachments.required&&t.purchases.attachments.threshold<=0&&s.push({title:"Attachments required but threshold is not set",body:"Set a threshold amount above which attachments are required.",tone:"warn"}),s.length===0&&s.push({title:"Policy looks strong",body:"No critical recommendations right now. Use the simulator to test edge cases.",tone:"good"}),s}function Hv(t,s){const a=(c,x)=>({status:"Allowed",reason:c,nextStep:x}),l=(c,x)=>({status:"Blocked",reason:c,nextStep:x}),n=(c,x)=>({status:"Requires approval",reason:c,nextStep:x});if(s.type==="Ride"){if(!t.rides.categories[s.rideCategory])return l("Ride category is not allowed by policy.","Choose an allowed category or request an exception.");if(t.rides.geofences.length){const N=t.rides.geofences.map(k=>k.name.toLowerCase()),$=N.includes(String(s.origin).toLowerCase()),T=N.includes(String(s.destination).toLowerCase());if(!$||!T)return l("Origin or destination is outside allowed geofences.","Update geofences or use personal payment.")}const c=t.rides.time.days||[];if(c.length&&!c.includes(s.day))return n("Ride is outside allowed days.","Route to manager approval or reschedule.");const x=s.time,j=t.rides.time.start,g=t.rides.time.end;return j&&g&&(x<j||x>g)?n("Ride is outside allowed working hours.","Route to approval or reschedule."):t.rides.purpose.required&&!String(s.purpose||"").trim()?l("Purpose tag is required.","Select a purpose tag and try again."):a("Ride meets policy requirements.","Proceed to checkout.")}if(s.type==="Purchase"){if(!t.purchases.allowedModules[s.module])return l("Service module is not allowed.","Choose an allowed module or use personal payment.");if(s.module==="E-Commerce"){if(s.marketplace==="-")return l("Marketplace is required for E-Commerce purchases.","Select a marketplace.");if(!t.purchases.allowedMarketplaces[s.marketplace])return l("Marketplace is not allowed.","Choose an allowed marketplace or request an exception.")}const c=String(s.vendor||"").trim();if(!c)return l("Vendor is required.","Select a vendor.");if(t.purchases.vendorDeny.map(g=>g.toLowerCase()).includes(c.toLowerCase()))return l("Vendor is denied by policy.","Choose an approved vendor.");if(t.purchases.vendorAllow.length>0&&!t.purchases.vendorAllow.map(N=>N.toLowerCase()).includes(c.toLowerCase()))return l("Vendor is not in allowlist.","Choose an allowlisted vendor or request vendor approval.");const x=String(s.category||"").trim();if(x&&t.purchases.categoriesDeny.map(g=>g.toLowerCase()).includes(x.toLowerCase()))return l("Category is restricted.","Remove restricted items or request exception.");const j=Number(s.total||0);return t.purchases.attachments.required&&j>=t.purchases.attachments.threshold&&!s.attachmentsProvided?l("Attachments are required above threshold.","Attach required documents then retry."):j>t.purchases.maxBasket?n("Basket total exceeds max basket size.","Route to approvals or reduce basket size."):a("Purchase meets policy requirements.","Proceed to checkout.")}if(!t.purchases.allowedModules[s.module])return l("Service module is not allowed.","Choose an allowed module or use personal payment.");const r=String(s.vendor||"").trim();if(!r)return l("Vendor is required.","Select a vendor.");if(t.purchases.vendorDeny.map(c=>c.toLowerCase()).includes(r.toLowerCase()))return l("Vendor is denied by policy.","Choose an approved vendor.");if(t.purchases.vendorAllow.length>0&&!t.purchases.vendorAllow.map(x=>x.toLowerCase()).includes(r.toLowerCase()))return l("Vendor is not in allowlist.","Choose an allowlisted vendor or request vendor approval.");const i=String(s.category||"").trim();if(i&&t.purchases.categoriesDeny.map(c=>c.toLowerCase()).includes(i.toLowerCase()))return l("Category is restricted.","Remove restricted items or request exception.");const o=Number(s.total||0);return t.purchases.attachments.required&&o>=t.purchases.attachments.threshold&&!s.attachmentsProvided?l("Attachments are required above threshold.","Attach required documents then retry."):o>t.purchases.maxBasket?n("Amount exceeds max basket size.","Route to approvals or reduce scope."):a("Service booking meets policy requirements.","Proceed to booking.")}function TV(){const[t,s]=d.useState([]),a=V=>{const Ce=AV("toast");s(I=>[{id:Ce,...V},...I].slice(0,4)),window.setTimeout(()=>s(I=>I.filter(te=>te.id!==Ce)),3200)},l=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],n=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],r=[{id:"Operations",name:"Operations"},{id:"Sales",name:"Sales"},{id:"Finance",name:"Finance"},{id:"Admin",name:"Admin"},{id:"Procurement",name:"Procurement"}],i=[{id:"U-1001",name:"Mary N.",email:"mary@acme.com",groupId:"Operations"},{id:"U-1002",name:"Finance Desk",email:"finance@acme.com",groupId:"Finance"},{id:"U-1003",name:"John S.",email:"john@acme.com",groupId:"Sales"},{id:"U-1004",name:"Admin Team",email:"admin@acme.com",groupId:"Admin"},{id:"U-1005",name:"Procurement Desk",email:"procurement@acme.com",groupId:"Procurement"}],[o,c]=d.useState("builder"),[x,j]=d.useState("Org"),[g,N]=d.useState("Operations"),[$,T]=d.useState(i[0].id);d.useEffect(()=>{if(x==="User"){const V=i.find(Ce=>Ce.id===$);V&&N(V.groupId)}},[x,$,i]);const[k,q]=d.useState(()=>{const V={};l.forEach(I=>V[I]=I!=="Green Investments");const Ce={};return n.forEach(I=>Ce[I]=I!=="Other Marketplace"),{rides:{categories:{standard:!0,premium:!0},geofences:[{type:"City",name:"Kampala"},{type:"Airport",name:"Entebbe Airport"},{type:"Office Zone",name:"HQ"}],time:{start:"06:00",end:"22:00",days:["Mon","Tue","Wed","Thu","Fri"]},purpose:{required:!0,tags:["Airport","Client meeting","Office commute","Site visit"]}},purchases:{allowedModules:V,allowedMarketplaces:Ce,vendorAllow:["Kampala Office Mart","Shenzhen Store","City Courier"],vendorDeny:["Unknown Vendor"],categoriesDeny:["Alcohol"],maxBasket:5e6,attachments:{required:!0,threshold:2e6}}}}),[L,R]=d.useState(()=>({Sales:{rides:{categories:{standard:!0,premium:!1}}}})),[U,ae]=d.useState(()=>({"U-1002":{purchases:{maxBasket:12e6,attachments:{required:!0,threshold:5e6}}}})),ie=d.useRef({orgPolicy:la(k),groupOverrides:la(L),userOverrides:la(U),publishedAt:new Date().toISOString()});d.useEffect(()=>{ie.current={orgPolicy:la(k),groupOverrides:la(L),userOverrides:la(U),publishedAt:ie.current.publishedAt||new Date().toISOString(),note:ie.current.note}},[]);const _=d.useMemo(()=>r.find(V=>V.id===g)||r[0],[r,g]),W=d.useMemo(()=>i.find(V=>V.id===$)||i[0],[i,$]),J=d.useMemo(()=>(x==="Group"||x==="User")&&L[g]||null,[x,g,L]),we=d.useMemo(()=>x==="User"&&U[$]||null,[x,$,U]),G=d.useMemo(()=>um(k,J,we),[k,J,we]),be=x!=="Org",Ge=d.useMemo(()=>x==="Org"?"Organization policy":x==="Group"?`Group override: ${_.name}`:`User override: ${W.name}`,[x,_,W]),Me=d.useMemo(()=>x==="Org"?null:x==="Group"?L[g]||{}:U[$]||{},[x,L,g,U,$]),je=(V,Ce)=>x==="Org"?!0:iy(Me||{},V,Ce),Ue=(V,Ce,I)=>{if(x==="Org")return;const te=(Se,Xe)=>{Xe(mt=>{const ot=la(mt),Nt=ot[Se]||{};if(I){const nt=G[V][Ce];ot[Se]=Wv(Nt,V,Ce,nt)}else ot[Se]=MV(Nt,V,Ce);return ot})};x==="Group"?te(g,R):x==="User"&&te($,ae)},Oe=(V,Ce,I)=>{if(x==="Org"){q(V==="rides"?te=>({...te,rides:{...te.rides,[Ce]:la(I)}}):te=>({...te,purchases:{...te.purchases,[Ce]:la(I)}}));return}je(V,Ce)&&(x==="Group"&&R(te=>({...te,[g]:Wv(te[g],V,Ce,I)})),x==="User"&&ae(te=>({...te,[$]:Wv(te[$],V,Ce,I)})))},he=d.useRef(""),Y=()=>{ie.current={orgPolicy:la(k),groupOverrides:la(L),userOverrides:la(U),publishedAt:new Date().toISOString(),note:he.current},he.current="",a({title:"Published",message:"Policy published. Impact compares against last published.",kind:"success"})},Ie=()=>{const V=ie.current;q(la(V.orgPolicy)),R(la(V.groupOverrides)),ae(la(V.userOverrides)),a({title:"Reverted",message:"Reverted to last published version.",kind:"info"})},[ce,me]=d.useState("City"),[pe,de]=d.useState(""),[ye,Qe]=d.useState(""),[Fe,ke]=d.useState(""),[fe,Ve]=d.useState("allow"),[ne,Te]=d.useState(""),[Ee,Re]=d.useState(i[0].id),ze=d.useMemo(()=>i.find(V=>V.id===Ee)||i[0],[i,Ee]),qe=d.useMemo(()=>L[ze.groupId]||null,[L,ze]),He=d.useMemo(()=>U[ze.id]||null,[U,ze]),_e=d.useMemo(()=>um(k,qe,He),[k,qe,He]),[le,z]=d.useState("Ride"),[Pe,Be]=d.useState("standard"),[xe,Ne]=d.useState("Mon"),[M,H]=d.useState("09:00"),[Ae,oe]=d.useState("Kampala"),[De,$e]=d.useState("HQ"),[ge,ue]=d.useState("Client meeting"),[Ke,b]=d.useState("E-Commerce"),[v,u]=d.useState("MyLiveDealz"),[C,Q]=d.useState("Kampala Office Mart"),[O,ee]=d.useState("Office supplies"),[F,D]=d.useState(12e5),[m,A]=d.useState(!1),f=d.useMemo(()=>le==="Ride"?{type:"Ride",rideCategory:Pe,day:xe,time:M,origin:Ae,destination:De,purpose:ge}:le==="Purchase"?{type:"Purchase",module:Ke,marketplace:Ke==="E-Commerce"?v:"-",vendor:C,category:O,total:F,attachmentsProvided:m}:{type:"Service",module:Ke,vendor:C,category:O,total:F,attachmentsProvided:m},[le,Pe,xe,M,Ae,De,ge,Ke,v,C,O,F,m]),B=d.useMemo(()=>Hv(_e,f),[_e,f]),p=d.useMemo(()=>OV(G),[G]),E=d.useMemo(()=>{const V=ie.current,Ce=x==="Org"?i:x==="Group"?i.filter(ot=>ot.groupId===g):i.filter(ot=>ot.id===$),I=[["rides","categories"],["rides","geofences"],["rides","time"],["rides","purpose"],["purchases","allowedModules"],["purchases","allowedMarketplaces"],["purchases","vendorAllow"],["purchases","vendorDeny"],["purchases","categoriesDeny"],["purchases","maxBasket"],["purchases","attachments"]],te=[],Se=[{type:"Ride",rideCategory:"premium",day:"Tue",time:"20:00",origin:"Kampala",destination:"HQ",purpose:"Client meeting"},{type:"Ride",rideCategory:"standard",day:"Sun",time:"09:00",origin:"Kampala",destination:"HQ",purpose:"Office commute"},{type:"Purchase",module:"E-Commerce",marketplace:"MyLiveDealz",vendor:"Shenzhen Store",category:"Office supplies",total:8e6,attachmentsProvided:!0},{type:"Purchase",module:"E-Commerce",marketplace:"ServiceMart",vendor:"Unknown Vendor",category:"Alcohol",total:2e5,attachmentsProvided:!1},{type:"Service",module:"EVs & Charging",vendor:"City Courier",category:"Service",total:25e5,attachmentsProvided:!1}],Xe=[];Ce.forEach(ot=>{const Nt=um(V.orgPolicy,V.groupOverrides[ot.groupId]||null,V.userOverrides[ot.id]||null),nt=um(k,L[ot.groupId]||null,U[ot.id]||null),Vs=I.map(([Ca,Tt])=>{const Sa=JSON.stringify(Nt[Ca][Tt]),Ut=JSON.stringify(nt[Ca][Tt]);return Sa!==Ut?`${Ca}.${Tt}`:null}).filter(Boolean);Vs.length&&te.push({user:ot,changed:Vs});let As=0;Se.forEach(Ca=>{const Tt=Hv(Nt,Ca).status,Sa=Hv(nt,Ca).status;Tt!==Sa&&(As+=1)}),Xe.push({user:ot,changedDecisions:As})});const mt=Xe.reduce((ot,Nt)=>ot+Nt.changedDecisions,0);return{totalAffected:Ce.length,changedUsers:te.length,totalChangedDecisions:mt,diffs:te,behavior:Xe,publishedAt:V.publishedAt,note:V.note||""}},[x,g,$,i,k,L,U]),[se,y]=d.useState(i[0].id),re=d.useMemo(()=>i.find(V=>V.id===se)||i[0],[i,se]),ve=d.useMemo(()=>L[re.groupId]||null,[L,re]),P=d.useMemo(()=>U[re.id]||null,[U,re]),X=d.useMemo(()=>um(k,ve,P),[k,ve,P]),S=[["rides","categories"],["rides","geofences"],["rides","time"],["rides","purpose"],["purchases","allowedModules"],["purchases","allowedMarketplaces"],["purchases","vendorAllow"],["purchases","vendorDeny"],["purchases","categoriesDeny"],["purchases","maxBasket"],["purchases","attachments"]],w=Object.entries(G.purchases.allowedModules).filter(([,V])=>V).map(([V])=>V),h=Object.entries(G.purchases.allowedMarketplaces).filter(([,V])=>V).map(([V])=>V);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(EV,{toasts:t,onDismiss:V=>s(Ce=>Ce.filter(I=>I.id!==V))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white",children:[e.jsxs("div",{className:"flex flex-col gap-3 px-4 py-4 md:flex-row md:items-start md:justify-between md:px-6",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:ho.green},children:e.jsx(yt,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Policy Builder (Rides, Services and Purchases)"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Inheritance: Org  Group  User. Simulator, recommendations, and impact preview included."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(ea,{label:Ge,tone:x==="Org"?"info":"warn"}),e.jsx(ea,{label:`Allowed modules: ${w.length}`,tone:"neutral"}),e.jsx(ea,{label:`Allowed marketplaces: ${h.length}`,tone:"neutral"}),e.jsx(ea,{label:`Published: ${new Date(ie.current.publishedAt).toLocaleDateString()}`,tone:"neutral"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Qa,{variant:"outline",onClick:Ie,children:[e.jsx(as,{className:"h-4 w-4"})," Revert"]}),e.jsxs(Qa,{variant:"outline",onClick:()=>a({title:"Saved",message:"Draft saved (demo).",kind:"success"}),children:[e.jsx(tt,{className:"h-4 w-4"})," Save draft"]}),e.jsxs(Qa,{variant:"primary",onClick:Y,children:[e.jsx(ct,{className:"h-4 w-4"})," Publish"]})]})]}),e.jsx("div",{className:"px-4 pb-4 md:px-6",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:[{id:"builder",label:"Builder"},{id:"inheritance",label:"Inheritance"},{id:"simulator",label:"Simulator"},{id:"recommendations",label:"Recommendations"},{id:"impact",label:"Impact"}].map(V=>e.jsx("button",{className:bs("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",o===V.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:o===V.id?{background:ho.green}:void 0,onClick:()=>c(V.id),children:V.label},V.id))})})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[o==="builder"?e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm h-fit",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Policy scope"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Edit org policy or apply group/user overrides."})]}),e.jsx(ea,{label:x,tone:x==="Org"?"info":"warn"})]}),e.jsx("div",{className:"mt-4 grid grid-cols-3 gap-2 rounded-2xl bg-white p-1 ring-1 ring-slate-200",children:["Org","Group","User"].map(V=>e.jsx("button",{className:bs("rounded-xl px-3 py-2 text-sm font-semibold",x===V?"text-white":"text-slate-700 hover:bg-slate-50"),style:x===V?{background:ho.green}:void 0,onClick:()=>j(V),children:V},V))}),x!=="Org"?e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Group"}),e.jsx("select",{value:g,disabled:x==="User",onChange:V=>N(V.target.value),className:bs("mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",x==="User"&&"bg-slate-50 text-slate-500"),children:r.map(V=>e.jsx("option",{value:V.id,children:V.name},V.id))}),x==="User"?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Group is derived from selected user."}):null]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"User"}),e.jsx("select",{value:$,disabled:x!=="User",onChange:V=>T(V.target.value),className:bs("mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",x!=="User"&&"bg-slate-50 text-slate-500"),children:i.map(V=>e.jsxs("option",{value:V.id,children:[V.name," (",V.email,")"]},V.id))}),x!=="User"?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Switch to User scope to override user policy."}):null]}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsx("div",{className:"font-semibold",children:"Inheritance"}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"User overrides override Group overrides override Org policy."})]})]}):e.jsx("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Organization policy is the default for all users unless overridden."}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Publish note (optional)"}),e.jsx("textarea",{defaultValue:"",onChange:V=>he.current=V.target.value,placeholder:"Example: restrict premium rides for Sales; require attachments above 2M.",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100",rows:3})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Tip: enable overrides only where needed. Keep most rules at Org or Group for consistency."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(ui,{title:"Rides and Logistics policy",subtitle:"Categories, geofences, time windows, and purpose tags.",right:e.jsx(ea,{label:Ge,tone:x==="Org"?"info":"warn"}),children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Allowed ride categories"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Standard and Premium."})]}),be?e.jsx(Rr,{enabled:je("rides","categories"),onToggle:V=>Ue("rides","categories",V)}):null]}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:[{key:"standard",label:"Standard"},{key:"premium",label:"Premium"}].map(V=>{const Ce=G.rides.categories[V.key],I=be&&!je("rides","categories");return e.jsx("button",{type:"button",disabled:I,className:bs("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",Ce?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50",I&&"opacity-60 cursor-not-allowed"),style:Ce?{background:ho.green}:void 0,onClick:()=>{const te=la(G.rides.categories);te[V.key]=!te[V.key],Oe("rides","categories",te)},children:V.label},V.key)})}),be&&!je("rides","categories")?e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Enable override to edit."}):null]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Geofences"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Allowed cities, office zones, and airports."})]}),be?e.jsx(Rr,{enabled:je("rides","geofences"),onToggle:V=>Ue("rides","geofences",V)}):null]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[G.rides.geofences.map((V,Ce)=>{const I=be&&!je("rides","geofences");return e.jsx(cm,{label:`${V.type}: ${V.name}`,tone:V.type==="Airport"?"info":V.type==="Office Zone"?"good":"neutral",onRemove:I?void 0:()=>{const te=G.rides.geofences.filter((Se,Xe)=>Xe!==Ce);Oe("rides","geofences",te)}},`${V.type}-${V.name}-${Ce}`)}),G.rides.geofences.length?null:e.jsx(ea,{label:"No geofences",tone:"warn"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Type"}),e.jsx("select",{value:ce,disabled:be&&!je("rides","geofences"),onChange:V=>me(V.target.value),className:bs("mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",be&&!je("rides","geofences")&&"bg-slate-50 text-slate-500"),children:["City","Office Zone","Airport"].map(V=>e.jsx("option",{value:V,children:V},V))})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Bn,{label:"Name",value:pe,onChange:de,placeholder:"Example: Kampala",disabled:be&&!je("rides","geofences")})})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Qa,{variant:"outline",onClick:()=>{if(be&&!je("rides","geofences"))return;const Ce=pe.trim();if(!Ce){a({title:"Missing name",message:"Enter a geofence name.",kind:"warn"});return}Oe("rides","geofences",[...G.rides.geofences,{type:ce,name:Ce}]),de("")},children:[e.jsx(pt,{className:"h-4 w-4"})," Add"]}),e.jsxs(Qa,{variant:"ghost",onClick:()=>{be&&!je("rides","geofences")||(Oe("rides","geofences",[{type:"City",name:"Kampala"},{type:"City",name:"Entebbe"},{type:"Airport",name:"Entebbe Airport"},{type:"Office Zone",name:"HQ"}]),a({title:"Presets",message:"Geofences presets applied.",kind:"info"}))},children:[e.jsx(ht,{className:"h-4 w-4"})," Presets"]})]}),be&&!je("rides","geofences")?e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Enable override to edit."}):null]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Time windows"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Working hours and allowed days."})]}),be?e.jsx(Rr,{enabled:je("rides","time"),onToggle:V=>Ue("rides","time",V)}):null]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Bn,{label:"Start",value:G.rides.time.start,onChange:V=>Oe("rides","time",{...G.rides.time,start:V}),type:"time",disabled:be&&!je("rides","time")}),e.jsx(Bn,{label:"End",value:G.rides.time.end,onChange:V=>Oe("rides","time",{...G.rides.time,end:V}),type:"time",disabled:be&&!je("rides","time")})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Allowed days"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:"Mon,Tue,Wed,Thu,Fri,Sat,Sun".split(",").map(V=>{const Ce=G.rides.time.days.includes(V),I=be&&!je("rides","time");return e.jsx("button",{type:"button",disabled:I,className:bs("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",Ce?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50",I&&"opacity-60 cursor-not-allowed"),style:Ce?{background:ho.green}:void 0,onClick:()=>{const te=Ce?G.rides.time.days.filter(Se=>Se!==V):[...G.rides.time.days,V];Oe("rides","time",{...G.rides.time,days:te})},children:V},V)})}),be&&!je("rides","time")?e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Enable override to edit."}):null]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Purpose tags"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Require purpose and define allowed tags."})]}),be?e.jsx(Rr,{enabled:je("rides","purpose"),onToggle:V=>Ue("rides","purpose",V)}):null]}),e.jsx("div",{className:"mt-3",children:e.jsx(A4,{enabled:G.rides.purpose.required,disabled:be&&!je("rides","purpose"),onChange:V=>Oe("rides","purpose",{...G.rides.purpose,required:V}),label:"Require purpose at checkout",description:"Improves reconciliation and chargeback attribution."})}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Allowed purposes"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[G.rides.purpose.tags.map((V,Ce)=>e.jsx(cm,{label:V,onRemove:be&&!je("rides","purpose")?void 0:()=>{const I=G.rides.purpose.tags.filter((te,Se)=>Se!==Ce);Oe("rides","purpose",{...G.rides.purpose,tags:I})}},`${V}-${Ce}`)),G.rides.purpose.tags.length?null:e.jsx(ea,{label:"No purposes",tone:"warn"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx(Bn,{label:"Add purpose",value:ye,onChange:Qe,placeholder:"Example: Airport",disabled:be&&!je("rides","purpose")})}),e.jsx("div",{className:"flex items-end",children:e.jsxs(Qa,{variant:"outline",className:"w-full",onClick:()=>{if(be&&!je("rides","purpose"))return;const Ce=ye.trim();if(!Ce){a({title:"Missing purpose",message:"Enter a purpose tag.",kind:"warn"});return}Oe("rides","purpose",{...G.rides.purpose,tags:[...G.rides.purpose.tags,Ce]}),Qe("")},children:[e.jsx(pt,{className:"h-4 w-4"})," Add"]})})]}),be&&!je("rides","purpose")?e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Enable override to edit."}):null]})]})]})}),e.jsx(ui,{title:"Purchases and Services policy",subtitle:"Cross-module controls: modules, marketplaces, vendors, categories, basket size, and attachments.",right:e.jsx(ea,{label:Ge,tone:x==="Org"?"info":"warn"}),children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Allowed Service Modules"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Where CorporatePay can be used for purchases and services."})]}),be?e.jsx(Rr,{enabled:je("purchases","allowedModules"),onToggle:V=>Ue("purchases","allowedModules",V)}):null]}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2 md:grid-cols-2",children:l.map(V=>{const Ce=G.purchases.allowedModules[V],I=be&&!je("purchases","allowedModules");return e.jsx("button",{type:"button",disabled:I,className:bs("rounded-3xl border p-4 text-left transition",Ce?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50",I&&"opacity-60 cursor-not-allowed"),onClick:()=>{const te=la(G.purchases.allowedModules);te[V]=!te[V],Oe("purchases","allowedModules",te)},children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:V}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:Ce?"Allowed":"Not allowed"})]}),e.jsx(ea,{label:Ce?"On":"Off",tone:Ce?"good":"neutral"})]})},V)})}),be&&!je("purchases","allowedModules")?e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Enable override to edit."}):null]}),e.jsxs("div",{className:bs("rounded-3xl border border-slate-200 bg-white p-4",!G.purchases.allowedModules["E-Commerce"]&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Allowed Marketplaces (E-Commerce)"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"MyLiveDealz and marts, plus Other Marketplace."})]}),be?e.jsx(Rr,{enabled:je("purchases","allowedMarketplaces"),onToggle:V=>Ue("purchases","allowedMarketplaces",V)}):null]}),G.purchases.allowedModules["E-Commerce"]?e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2 md:grid-cols-2",children:n.map(V=>{const Ce=G.purchases.allowedMarketplaces[V],I=be&&!je("purchases","allowedMarketplaces");return e.jsx("button",{type:"button",disabled:I,className:bs("rounded-3xl border p-4 text-left transition",Ce?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50",I&&"opacity-60 cursor-not-allowed"),onClick:()=>{const te=la(G.purchases.allowedMarketplaces);te[V]=!te[V],Oe("purchases","allowedMarketplaces",te)},children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:V}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:Ce?"Allowed":"Not allowed"})]}),e.jsx(ea,{label:Ce?"On":"Off",tone:Ce?"good":"neutral"})]})},V)})}):e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Enable E-Commerce in Allowed Service Modules to use marketplace controls."}),be&&!je("purchases","allowedMarketplaces")?e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Enable override to edit."}):null]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Vendor allowlist and denylist"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Allow preferred vendors and block risky ones."})]}),be?e.jsx(Rr,{enabled:je("purchases","vendorAllow")||je("purchases","vendorDeny"),onToggle:V=>{Ue("purchases","vendorAllow",V),Ue("purchases","vendorDeny",V)}}):null]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Allowlist"}),e.jsx(ea,{label:G.purchases.vendorAllow.length?`${G.purchases.vendorAllow.length}`:"None",tone:G.purchases.vendorAllow.length?"good":"neutral"})]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:G.purchases.vendorAllow.map((V,Ce)=>{const I=be&&!(je("purchases","vendorAllow")||je("purchases","vendorDeny"));return e.jsx(cm,{label:V,tone:"good",onRemove:I?void 0:()=>{const te=G.purchases.vendorAllow.filter((Se,Xe)=>Xe!==Ce);Oe("purchases","vendorAllow",te)}},`${V}-${Ce}`)})})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Denylist"}),e.jsx(ea,{label:G.purchases.vendorDeny.length?`${G.purchases.vendorDeny.length}`:"None",tone:G.purchases.vendorDeny.length?"warn":"neutral"})]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:G.purchases.vendorDeny.map((V,Ce)=>{const I=be&&!(je("purchases","vendorAllow")||je("purchases","vendorDeny"));return e.jsx(cm,{label:V,tone:"warn",onRemove:I?void 0:()=>{const te=G.purchases.vendorDeny.filter((Se,Xe)=>Xe!==Ce);Oe("purchases","vendorDeny",te)}},`${V}-${Ce}`)})})]})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Add mode"}),e.jsxs("select",{value:fe,onChange:V=>Ve(V.target.value),disabled:be&&!(je("purchases","vendorAllow")||je("purchases","vendorDeny")),className:bs("mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",be&&!(je("purchases","vendorAllow")||je("purchases","vendorDeny"))&&"bg-slate-50 text-slate-500"),children:[e.jsx("option",{value:"allow",children:"Allowlist"}),e.jsx("option",{value:"deny",children:"Denylist"})]})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Bn,{label:"Vendor name",value:Fe,onChange:ke,placeholder:"Example: Shenzhen Store",disabled:be&&!(je("purchases","vendorAllow")||je("purchases","vendorDeny"))})})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Qa,{variant:"outline",onClick:()=>{if(be&&!(je("purchases","vendorAllow")||je("purchases","vendorDeny")))return;const Ce=Fe.trim();if(!Ce){a({title:"Missing vendor",message:"Enter a vendor name.",kind:"warn"});return}fe==="allow"?Oe("purchases","vendorAllow",[...G.purchases.vendorAllow,Ce]):Oe("purchases","vendorDeny",[...G.purchases.vendorDeny,Ce]),ke("")},children:[e.jsx(pt,{className:"h-4 w-4"})," Add vendor"]}),e.jsxs(Qa,{variant:"ghost",onClick:()=>{be&&!(je("purchases","vendorAllow")||je("purchases","vendorDeny"))||(Oe("purchases","vendorAllow",["Kampala Office Mart","Shenzhen Store","City Courier"]),a({title:"Presets",message:"Preferred vendors applied.",kind:"info"}))},children:[e.jsx(ht,{className:"h-4 w-4"})," Preferred presets"]})]}),be&&!(je("purchases","vendorAllow")||je("purchases","vendorDeny"))?e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Enable override to edit."}):null]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Category restrictions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Block categories like Alcohol."})]}),be?e.jsx(Rr,{enabled:je("purchases","categoriesDeny"),onToggle:V=>Ue("purchases","categoriesDeny",V)}):null]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[G.purchases.categoriesDeny.map((V,Ce)=>e.jsx(cm,{label:V,tone:"warn",onRemove:be&&!je("purchases","categoriesDeny")?void 0:()=>{const I=G.purchases.categoriesDeny.filter((te,Se)=>Se!==Ce);Oe("purchases","categoriesDeny",I)}},`${V}-${Ce}`)),G.purchases.categoriesDeny.length?null:e.jsx(ea,{label:"No restrictions",tone:"neutral"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx(Bn,{label:"Add restricted category",value:ne,onChange:Te,placeholder:"Example: Alcohol",disabled:be&&!je("purchases","categoriesDeny")})}),e.jsx("div",{className:"flex items-end",children:e.jsxs(Qa,{variant:"outline",className:"w-full",onClick:()=>{if(be&&!je("purchases","categoriesDeny"))return;const Ce=ne.trim();if(!Ce){a({title:"Missing category",message:"Enter a category.",kind:"warn"});return}Oe("purchases","categoriesDeny",[...G.purchases.categoriesDeny,Ce]),Te("")},children:[e.jsx(pt,{className:"h-4 w-4"})," Add"]})})]}),be&&!je("purchases","categoriesDeny")?e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Enable override to edit."}):null]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Max basket size"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Amounts above this require approval."})]}),be?e.jsx(Rr,{enabled:je("purchases","maxBasket"),onToggle:V=>Ue("purchases","maxBasket",V)}):null]}),e.jsxs("div",{className:"mt-3",children:[e.jsx(zv,{label:"Max basket (UGX)",value:G.purchases.maxBasket,onChange:V=>Oe("purchases","maxBasket",V),hint:`Current: ${mx(G.purchases.maxBasket)}`,disabled:be&&!je("purchases","maxBasket")}),be&&!je("purchases","maxBasket")?e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Enable override to edit."}):null]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Attachments requirement"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Require attachments above threshold."})]}),be?e.jsx(Rr,{enabled:je("purchases","attachments"),onToggle:V=>Ue("purchases","attachments",V)}):null]}),e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsx(A4,{enabled:G.purchases.attachments.required,onChange:V=>Oe("purchases","attachments",{...G.purchases.attachments,required:V}),label:"Require attachments",description:"Applies to purchases and services above threshold",disabled:be&&!je("purchases","attachments")}),e.jsx(zv,{label:"Threshold amount (UGX)",value:G.purchases.attachments.threshold,onChange:V=>Oe("purchases","attachments",{...G.purchases.attachments,threshold:V}),hint:"If total  threshold, attachments are required",disabled:be&&!je("purchases","attachments")}),be&&!je("purchases","attachments")?e.jsx("div",{className:"text-xs text-slate-500",children:"Enable override to edit."}):null]})]})]}),e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Use the Simulator tab to test edge cases: denied vendors, restricted categories, and missing attachments."})]})})]})]}):null,o==="inheritance"?e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Pick a user to inspect"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Shows effective values and source (Org/Group/User)."}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"User"}),e.jsx("select",{value:se,onChange:V=>y(V.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",children:i.map(V=>e.jsxs("option",{value:V.id,children:[V.name," (",V.email,")"]},V.id))}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Group: ",re.groupId]})]}),e.jsxs("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Chain: Org  Group (",re.groupId,")  User"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(ui,{title:"Inheritance summary",subtitle:"Source of each effective field",right:e.jsx(ea,{label:"Explainable",tone:"info"}),children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Field"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Effective"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Source"})]})}),e.jsx("tbody",{children:S.map(([V,Ce])=>{const I=PV(k,ve,P,V,Ce),te=X[V][Ce],Se=RV(Ce,te);return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3 font-semibold text-slate-900",children:[V,".",Ce]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Se}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ea,{label:I,tone:I==="Org"?"neutral":I==="Group"?"warn":"info"})})]},`${V}.${Ce}`)})})]})})}),e.jsx(ui,{title:"Effective policy JSON",subtitle:"Computed policy used for enforcement",right:e.jsxs(Qa,{variant:"outline",onClick:()=>a({title:"Export",message:"Export policy (demo).",kind:"info"}),children:[e.jsx(wt,{className:"h-4 w-4"})," Export"]}),children:e.jsx("pre",{className:"max-h-[360px] overflow-auto rounded-2xl border border-slate-200 bg-white p-3 text-xs text-slate-800",children:JSON.stringify(X,null,2)})})]})]}):null,o==="simulator"?e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Simulation context"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Choose a user to simulate with their effective policy."}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"User"}),e.jsx("select",{value:Ee,onChange:V=>Re(V.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",children:i.map(V=>e.jsxs("option",{value:V.id,children:[V.name," (",V.email,")"]},V.id))}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Group: ",ze.groupId]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Type"}),e.jsx("div",{className:"mt-2 grid grid-cols-3 gap-2 rounded-2xl bg-white p-1 ring-1 ring-slate-200",children:["Ride","Purchase","Service"].map(V=>e.jsx("button",{className:bs("rounded-xl px-3 py-2 text-sm font-semibold",le===V?"text-white":"text-slate-700 hover:bg-slate-50"),style:le===V?{background:ho.green}:void 0,onClick:()=>z(V),children:V},V))})]}),e.jsxs("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Simulator rules:",e.jsxs("ul",{className:"mt-2 space-y-1 text-xs text-slate-600",children:[e.jsx("li",{children:"1) Denied vendor or restricted category is blocked"}),e.jsx("li",{children:"2) Missing attachments above threshold is blocked"}),e.jsx("li",{children:"3) Over max basket requires approval"}),e.jsx("li",{children:"4) Outside working hours may require approval"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(ui,{title:"Scenario inputs",subtitle:"Set inputs and run the simulator",right:e.jsxs(Qa,{variant:"primary",onClick:()=>a({title:"Simulated",message:`Result: ${B.status}`,kind:B.status==="Allowed"?"success":B.status==="Blocked"?"warn":"info"}),children:[e.jsx(zp,{className:"h-4 w-4"})," Run"]}),children:[le==="Ride"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Ride category"}),e.jsxs("select",{value:Pe,onChange:V=>Be(V.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",children:[e.jsx("option",{value:"standard",children:"Standard"}),e.jsx("option",{value:"premium",children:"Premium"})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Day"}),e.jsx("select",{value:xe,onChange:V=>Ne(V.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",children:"Mon,Tue,Wed,Thu,Fri,Sat,Sun".split(",").map(V=>e.jsx("option",{value:V,children:V},V))})]}),e.jsx(Bn,{label:"Time",value:M,onChange:H,type:"time"}),e.jsx(Bn,{label:"Origin",value:Ae,onChange:oe,placeholder:"Kampala",hint:"Match geofence names"}),e.jsx(Bn,{label:"Destination",value:De,onChange:$e,placeholder:"HQ",hint:"Match geofence names"}),e.jsx(Bn,{label:"Purpose",value:ge,onChange:ue,placeholder:"Client meeting",hint:"Required if policy requires"})]}):null,le!=="Ride"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Service module"}),e.jsx("select",{value:Ke,onChange:V=>{const Ce=V.target.value;b(Ce),Ce!=="E-Commerce"&&u("MyLiveDealz")},className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",children:l.map(V=>e.jsx("option",{value:V,children:V},V))})]}),e.jsxs("div",{className:bs(Ke!=="E-Commerce"&&"opacity-70"),children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Marketplace"}),e.jsx("select",{value:v,onChange:V=>u(V.target.value),disabled:Ke!=="E-Commerce",className:bs("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none",Ke==="E-Commerce"?"border-slate-200 bg-white text-slate-900 focus:ring-4 focus:ring-emerald-100":"border-slate-200 bg-slate-50 text-slate-500"),children:n.map(V=>e.jsx("option",{value:V,children:V},V))})]}),e.jsx(Bn,{label:"Vendor",value:C,onChange:Q,placeholder:"Kampala Office Mart"}),e.jsx(Bn,{label:"Category",value:O,onChange:ee,placeholder:"Office supplies",hint:"Restricted categories are blocked"}),e.jsx(zv,{label:"Total amount (UGX)",value:F,onChange:D,hint:`Max basket: ${mx(_e.purchases.maxBasket)}`}),e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 md:col-span-2",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Attachments provided"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Required above ",mx(_e.purchases.attachments.threshold)," when enabled."]})]}),e.jsx("button",{type:"button",className:bs("relative h-7 w-12 rounded-full border transition",m?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>A(V=>!V),"aria-label":"Toggle attachments",children:e.jsx("span",{className:bs("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",m?"left-[22px]":"left-1")})})]})})]}):null]}),e.jsxs(ui,{title:"Simulation result",subtitle:"Decision, reason, and next step",right:e.jsx(ea,{label:B.status,tone:B.status==="Allowed"?"good":B.status==="Blocked"?"bad":"warn"}),children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Reason"}),e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:B.reason}),e.jsx("div",{className:"mt-4 text-sm font-semibold text-slate-900",children:"Next step"}),e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:B.nextStep})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Simulator is a preview tool. Real enforcement uses policy engine and approvals workflow."})]}),e.jsx(ui,{title:"Effective policy snapshot",subtitle:"Policy used for this simulation",right:e.jsxs(Qa,{variant:"outline",onClick:()=>c("inheritance"),children:[e.jsx(wa,{className:"h-4 w-4"})," Inheritance"]}),children:e.jsx("pre",{className:"max-h-[320px] overflow-auto rounded-2xl border border-slate-200 bg-white p-3 text-xs text-slate-800",children:JSON.stringify(_e,null,2)})})]})]}):null,o==="recommendations"?e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Recommendations"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Generated from current effective policy for the selected scope."}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Apply changes in Builder and validate in Simulator."}),e.jsxs(Qa,{variant:"primary",className:"mt-4 w-full",onClick:()=>c("builder"),children:[e.jsx(yt,{className:"h-4 w-4"})," Open builder"]})]}),e.jsx("div",{className:"space-y-3",children:p.map((V,Ce)=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:V.title}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:V.body})]}),e.jsx(ea,{label:V.tone==="good"?"OK":V.tone==="warn"?"Warning":"Info",tone:V.tone})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Qa,{variant:"outline",className:"text-xs",onClick:()=>c("builder"),children:[e.jsx(et,{className:"h-4 w-4"})," Adjust policy"]}),e.jsxs(Qa,{variant:"outline",className:"text-xs",onClick:()=>c("simulator"),children:[e.jsx(zp,{className:"h-4 w-4"})," Test"]}),e.jsxs(Qa,{variant:"outline",className:"text-xs",onClick:()=>c("impact"),children:[e.jsx(wt,{className:"h-4 w-4"})," Preview impact"]})]})]},Ce))})]}):null,o==="impact"?e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Impact preview"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Compares current draft against last published version."}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3",children:[e.jsx(K,{title:"Affected users",value:String(E.totalAffected),icon:e.jsx(Us,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(K,{title:"Users with changes",value:String(E.changedUsers),icon:e.jsx(ht,{className:"h-5 w-5"}),tone:E.changedUsers?"warn":"good"}),e.jsx(K,{title:"Changed decisions",value:String(E.totalChangedDecisions),icon:e.jsx(zp,{className:"h-5 w-5"}),tone:E.totalChangedDecisions?"warn":"good"})]}),e.jsxs("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Published at: ",new Date(E.publishedAt).toLocaleString(),E.note?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Last note: ",E.note]}):null]}),e.jsxs(Qa,{variant:"primary",className:"mt-4 w-full",onClick:Y,children:[e.jsx(ct,{className:"h-4 w-4"})," Publish"]}),e.jsxs(Qa,{variant:"outline",className:"mt-2 w-full",onClick:Ie,children:[e.jsx(as,{className:"h-4 w-4"})," Revert"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(ui,{title:"Changed users",subtitle:"Who is affected and which fields changed",right:e.jsx(ea,{label:`${E.changedUsers} users`,tone:E.changedUsers?"warn":"good"}),children:E.diffs.length?e.jsx("div",{className:"space-y-2",children:E.diffs.map(V=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:V.user.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[V.user.email,"  Group: ",V.user.groupId]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[V.changed.slice(0,8).map(Ce=>e.jsx(ea,{label:Ce,tone:"neutral"},Ce)),V.changed.length>8?e.jsx(ea,{label:`+${V.changed.length-8}`,tone:"neutral"}):null]})]}),e.jsxs(Qa,{variant:"outline",className:"text-xs",onClick:()=>{Re(V.user.id),c("simulator")},children:[e.jsx(zp,{className:"h-4 w-4"})," Simulate"]})]})},V.user.id))}):e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(tt,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No impact"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Your draft matches the last published version for this scope."})]})}),e.jsxs(ui,{title:"Behavior preview",subtitle:"How many simulated decisions changed",right:e.jsx(ea,{label:`${E.totalChangedDecisions} changed`,tone:E.totalChangedDecisions?"warn":"good"}),children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"User"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Changed decisions"})]})}),e.jsx("tbody",{children:E.behavior.map(V=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:V.user.name}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:V.user.groupId}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ea,{label:String(V.changedDecisions),tone:V.changedDecisions?"warn":"good"})})]},V.user.id))})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"This preview uses a small test set. For production, run impact analysis on real historical transactions."})]})]})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"I Policy Builder v2: inheritance (Org  Group  User), rides and purchase/service policies, required attachments above threshold, simulator, recommendations, and change impact preview."})})]})})]});function K({title:V,value:Ce,icon:I,tone:te}){const Se=te==="bad"?"bg-rose-50 text-rose-700":te==="warn"?"bg-amber-50 text-amber-800":te==="good"?"bg-emerald-50 text-emerald-700":te==="info"?"bg-blue-50 text-blue-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:V}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:Ce})]}),e.jsx("div",{className:bs("grid h-10 w-10 place-items-center rounded-2xl",Se),children:I})]})})}}function RV(t,s){try{return t==="maxBasket"?mx(s):t==="attachments"?`${s.required?"Required":"Optional"} ( ${mx(s.threshold)})`:t==="vendorAllow"||t==="vendorDeny"||t==="categoriesDeny"?Array.isArray(s)?`${s.length} items`:"-":t==="geofences"?Array.isArray(s)?`${s.length} fences`:"-":t==="categories"?JSON.stringify(s):t==="allowedModules"||t==="allowedMarketplaces"?`${Object.keys(s||{}).filter(l=>s[l]).length} enabled`:t==="time"?`${s.start}-${s.end} (${(s.days||[]).length} days)`:t==="purpose"?`${s.required?"Required":"Optional"} (${(s.tags||[]).length} tags)`:JSON.stringify(s)}catch{return String(s)}}const xx={green:"#03CD8C",orange:"#F77F00"};function ja(...t){return t.filter(Boolean).join(" ")}function An(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function E4(t,s,a){return Math.max(s,Math.min(a,t))}function uc(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function mm(t){return JSON.parse(JSON.stringify(t))}function rs({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:ja("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Rs({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:xx.green}:t==="accent"?{background:xx.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:ja(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Yi({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4 transition-colors hover:border-slate-300",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:ja("relative h-7 w-12 rounded-full border transition-all duration-200 ease-in-out",t?"border-emerald-500 bg-emerald-500 shadow-[0_0_0_3px_rgba(3,205,140,0.2)]":"border-slate-300 bg-slate-100"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:ja("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition-all duration-200",t?"left-[22px]":"left-1")})})]})}function mc({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:ja(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:ja("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function Dr({label:t,value:s,onChange:a,hint:l,disabled:n}){return e.jsxs("div",{className:ja(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",min:0,onKeyDown:r=>(r.key==="-"||r.key==="e")&&r.preventDefault(),value:s,onChange:r=>{const i=Number(r.target.value||0);i>=0&&a(i)},disabled:n,className:ja("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function _a({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:ja(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:ja("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i,children:i},i))})]})}function DV({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function Bl({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function UE({actions:t}){const[s,a]=d.useState(!1);return e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 focus:bg-slate-100 focus:outline-none",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>a(!1)}),e.jsx("div",{className:"absolute right-0 top-full z-40 mt-1 w-48 overflow-hidden rounded-xl border border-slate-200 bg-white shadow-xl ring-1 ring-slate-200",children:t.map((l,n)=>e.jsx("button",{onClick:()=>{l.onClick(),a(!1)},className:ja("block w-full px-4 py-2.5 text-left text-sm font-medium transition hover:bg-slate-50",l.variant==="danger"?"text-rose-700 hover:bg-rose-50":"text-slate-700"),children:l.label},n))})]})]})}function hh({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="920px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 bottom-4 top-4 z-50 mx-auto flex w-[min(980px,calc(100vw-2rem))] flex-col overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i,maxHeight:"92vh"},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex shrink-0 items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-1",children:[o?e.jsx(UE,{actions:o}):null,e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"shrink-0 border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function IV({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,actions:i}){return d.useEffect(()=>{const o=c=>c.key==="Escape"&&n();return t&&window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,x:16},animate:{opacity:1,x:0},exit:{opacity:0,x:16},transition:{duration:.18},className:ja("fixed z-50 flex flex-col overflow-hidden border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]","bottom-2 left-2 right-2 top-2 rounded-[28px]","lg:bottom-4 lg:left-auto lg:right-4 lg:top-4 lg:w-[560px]"),style:{maxHeight:"calc(100vh - 32px)"},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex shrink-0 items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-base font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-1",children:[i?e.jsx(UE,{actions:i}):null,e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"shrink-0 border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function $V({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:ja("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function LV(t){return t==="CFO"||t==="Org Admin"?"warn":t==="Finance"||t==="Accountant"?"info":t==="EVzone Support"?"bad":"neutral"}function FV(t){return t==="Email"?e.jsx(Xs,{className:"h-4 w-4"}):t==="WhatsApp"?e.jsx(ME,{className:"h-4 w-4"}):t==="WeChat"?e.jsx(Ii,{className:"h-4 w-4"}):e.jsx(bw,{className:"h-4 w-4"})}function M4(t,s){if(t.assignment==="Specific user"&&t.specificUser)return t.specificUser;const a=s.filter(i=>i.role===t.role);if(!a.length)return"(No approver pool)";if(t.assignment==="First available"){const i=a.find(o=>!o.ooo);return i?i.name:a[0].name}if(t.assignment==="Least load"){const i=[...a].sort((c,x)=>c.load-x.load);return(i.find(c=>!c.ooo)||i[0]).name}const l=Math.abs(UV(t.id))%a.length,n=a[(l+0)%a.length];return(n.ooo&&a.find(i=>!i.ooo)||n).name}function UV(t){let s=0;for(let a=0;a<t.length;a++)s=(s<<5)-s+t.charCodeAt(a);return s|0}function VV(t,s,a){if(!t.enabled)return{status:"Blocked",reasons:["Flow is disabled"],stages:[]};const l=[];if(t.scopeType==="Module"&&t.module&&t.module!==s.module)return{status:"Blocked",reasons:["Scenario module does not match flow scope"],stages:[]};if(t.scopeType==="Marketplace"){if(t.module!=="E-Commerce")return{status:"Blocked",reasons:["Marketplace flow must be under E-Commerce"],stages:[]};if((s.marketplace||"-")==="-")return{status:"Blocked",reasons:["Scenario has no marketplace"],stages:[]};if(t.marketplace&&t.marketplace!==s.marketplace)return{status:"Blocked",reasons:["Scenario marketplace does not match flow scope"],stages:[]}}if(t.scopeType,s.amountUGX>=t.rule.requireAttachmentsOverUGX&&!s.attachmentsProvided)return{status:"Blocked",reasons:["Attachments required above threshold"],stages:[]};if(s.amountUGX>=t.rule.requireCommentOverUGX&&!s.commentProvided)return{status:"Blocked",reasons:["Comment required above threshold"],stages:[]};if(t.rule.autoApprove.enabled&&s.amountUGX<=t.rule.autoApprove.thresholdUGX){if(!t.rule.autoApprove.eligibleOnly||s.userAutoApprovalEligible)return l.push("Auto-approved under threshold"),t.rule.autoApprove.eligibleOnly&&l.push("Auto-approval eligibility satisfied"),{status:"Auto-approved",reasons:l,stages:[]};l.push("Auto-approve blocked: user not eligible")}if(s.amountUGX<=t.rule.requireApprovalOverUGX)return l.push("Under approval trigger. Allowed without approval."),{status:"Auto-approved",reasons:l,stages:[]};const n=[...t.stages].filter(i=>s.amountUGX>=i.minAmountUGX).sort((i,o)=>i.minAmountUGX-o.minAmountUGX);if(!n.length)return l.push("No stages configured for this amount"),{status:"Requires approval",reasons:l,stages:[]};const r=n.map((i,o)=>{const c=M4(i,a),x=s.oooRoles.includes(i.role);let j=c,g=i.escalation.enabled?i.escalation.target==="Next stage"?o<n.length-1?n[o+1].role:"Org Admin":i.escalation.target:"(none)";if(x&&i.delegation.enabled)if(i.delegation.mode==="Delegate user"&&i.delegation.delegateUser)j=i.delegation.delegateUser,g="(delegate)";else if(i.delegation.mode==="Role pool"){const T=i.delegation.delegateRole||i.role,k={...i,role:T,assignment:"Least load"};j=M4(k,a),g="(role pool)"}else i.delegation.mode==="Skip to next stage"&&(j="(skipped)",g="Next stage");const N=Math.max(0,i.slaHours-s.elapsedHours),$=s.elapsedHours>i.slaHours;return{stage:i,assignedTo:j,slaDueInHours:N,breached:$,escalationTo:String(g)}});return r.some(i=>i.assignedTo==="(skipped)")&&l.push("Out-of-office delegation skipped one or more stages"),{status:"Requires approval",reasons:l,stages:r}}function zs(t){return{id:An("STG"),name:t.name,minAmountUGX:t.minAmountUGX??0,role:t.role??"Manager",assignment:t.assignment??"Least load",specificUser:t.specificUser,slaHours:t.slaHours??8,escalation:t.escalation??{enabled:!0,afterHours:8,target:"Next stage"},delegation:t.delegation??{enabled:!0,mode:"Role pool",delegateRole:t.role??"Manager"}}}function v0(){const t=[];return t.push({id:An("FLOW"),name:"Rides & Logistics approvals",enabled:!0,scopeType:"Module",module:"Rides & Logistics",rule:{autoApprove:{enabled:!0,thresholdUGX:2e5,eligibleOnly:!0},requireApprovalOverUGX:2e5,requireAttachmentsOverUGX:2e6,requireCommentOverUGX:8e5},stages:[zs({name:"Manager approval",minAmountUGX:2e5,role:"Manager",slaHours:6,assignment:"First available"}),zs({name:"Finance approval",minAmountUGX:1e6,role:"Finance",slaHours:8,assignment:"Least load"}),zs({name:"CFO approval",minAmountUGX:5e6,role:"CFO",slaHours:12,assignment:"Least load"})],defaults:{policyTemplate:"Balanced",approvalFlowKind:"Multi-level escalation"},sla:{breachAlertsEnabled:!0,breachNotifyChannels:["Email","WhatsApp"],remindBeforeMinutes:30},loadBalancing:{enabled:!0,strategy:"Least load"},meta:{industryTemplate:"Corporate",notes:"Default ride approvals. Tighten for premium rides in Policy Builder."}}),t.push({id:An("FLOW"),name:"EVs & Charging approvals",enabled:!0,scopeType:"Module",module:"EVs & Charging",rule:{autoApprove:{enabled:!0,thresholdUGX:3e5,eligibleOnly:!0},requireApprovalOverUGX:3e5,requireAttachmentsOverUGX:3e6,requireCommentOverUGX:1e6},stages:[zs({name:"Manager approval",minAmountUGX:3e5,role:"Manager",slaHours:8,assignment:"Least load"}),zs({name:"Finance approval",minAmountUGX:2e6,role:"Finance",slaHours:12,assignment:"Least load"})],defaults:{policyTemplate:"Balanced",approvalFlowKind:"Manager approval"},sla:{breachAlertsEnabled:!0,breachNotifyChannels:["Email"],remindBeforeMinutes:45},loadBalancing:{enabled:!0,strategy:"Least load"},meta:{industryTemplate:"Corporate",notes:"Credits and station services. Consider stricter policy for refunds."}}),t.push({id:An("FLOW"),name:"Medical & Health Care approvals",enabled:!0,scopeType:"Module",module:"Medical & Health Care",rule:{autoApprove:{enabled:!0,thresholdUGX:1e5,eligibleOnly:!0},requireApprovalOverUGX:1e5,requireAttachmentsOverUGX:5e5,requireCommentOverUGX:25e4},stages:[zs({name:"Manager approval",minAmountUGX:1e5,role:"Manager",slaHours:4,assignment:"First available"}),zs({name:"Finance approval",minAmountUGX:8e5,role:"Finance",slaHours:8,assignment:"Least load"})],defaults:{policyTemplate:"Strict compliance",approvalFlowKind:"Multi-level escalation"},sla:{breachAlertsEnabled:!0,breachNotifyChannels:["Email","SMS"],remindBeforeMinutes:20},loadBalancing:{enabled:!0,strategy:"First available"},meta:{industryTemplate:"Hospital",notes:"Higher sensitivity. Keep attachments and comments strict."}}),t.push({id:An("FLOW"),name:"Travel & Tourism approvals",enabled:!0,scopeType:"Module",module:"Travel & Tourism",rule:{autoApprove:{enabled:!0,thresholdUGX:25e4,eligibleOnly:!0},requireApprovalOverUGX:25e4,requireAttachmentsOverUGX:2e6,requireCommentOverUGX:8e5},stages:[zs({name:"Manager approval",minAmountUGX:25e4,role:"Manager",slaHours:8,assignment:"Least load"}),zs({name:"Finance approval",minAmountUGX:2e6,role:"Finance",slaHours:12,assignment:"Least load"})],defaults:{policyTemplate:"Balanced",approvalFlowKind:"Manager approval"},sla:{breachAlertsEnabled:!0,breachNotifyChannels:["Email","WhatsApp"],remindBeforeMinutes:30},loadBalancing:{enabled:!0,strategy:"Least load"},meta:{industryTemplate:"Tour Company",notes:"Airport and hotel bookings. Consider vendor allowlist."}}),t.push({id:An("FLOW"),name:"Finance & Payments approvals",enabled:!0,scopeType:"Module",module:"Finance & Payments",rule:{autoApprove:{enabled:!1,thresholdUGX:0,eligibleOnly:!0},requireApprovalOverUGX:0,requireAttachmentsOverUGX:0,requireCommentOverUGX:0},stages:[zs({name:"Finance approval",minAmountUGX:0,role:"Finance",slaHours:6,assignment:"Least load"}),zs({name:"CFO approval",minAmountUGX:1e7,role:"CFO",slaHours:12,assignment:"Least load"})],defaults:{policyTemplate:"Strict compliance",approvalFlowKind:"Finance approval"},sla:{breachAlertsEnabled:!0,breachNotifyChannels:["Email","SMS"],remindBeforeMinutes:15},loadBalancing:{enabled:!0,strategy:"Least load"},meta:{industryTemplate:"Corporate",notes:"Direct money movement. Always audited."}}),t.push({id:An("FLOW"),name:"E-Commerce default approvals",enabled:!0,scopeType:"Module",module:"E-Commerce",rule:{autoApprove:{enabled:!0,thresholdUGX:15e4,eligibleOnly:!0},requireApprovalOverUGX:15e4,requireAttachmentsOverUGX:3e6,requireCommentOverUGX:9e5},stages:[zs({name:"Procurement approval",minAmountUGX:15e4,role:"Procurement",slaHours:10,assignment:"Least load"}),zs({name:"Finance approval",minAmountUGX:2e6,role:"Finance",slaHours:12,assignment:"Least load"}),zs({name:"CFO approval",minAmountUGX:12e6,role:"CFO",slaHours:24,assignment:"Least load"})],defaults:{policyTemplate:"Balanced",approvalFlowKind:"Multi-level escalation"},sla:{breachAlertsEnabled:!0,breachNotifyChannels:["Email"],remindBeforeMinutes:45},loadBalancing:{enabled:!0,strategy:"Least load"},meta:{industryTemplate:"Corporate",notes:"Marketplace specifics can override, e.g., MyLiveDealz."}}),t.push({id:An("FLOW"),name:"MyLiveDealz approvals (override)",enabled:!0,scopeType:"Marketplace",module:"E-Commerce",marketplace:"MyLiveDealz",rule:{autoApprove:{enabled:!0,thresholdUGX:1e5,eligibleOnly:!0},requireApprovalOverUGX:1e5,requireAttachmentsOverUGX:1e6,requireCommentOverUGX:5e5},stages:[zs({name:"Procurement approval",minAmountUGX:1e5,role:"Procurement",slaHours:8,assignment:"Least load"}),zs({name:"Finance approval",minAmountUGX:15e5,role:"Finance",slaHours:10,assignment:"Least load"}),zs({name:"CFO approval",minAmountUGX:5e6,role:"CFO",slaHours:16,assignment:"Least load"})],defaults:{policyTemplate:"Conservative",approvalFlowKind:"Multi-level escalation"},sla:{breachAlertsEnabled:!0,breachNotifyChannels:["Email","WhatsApp"],remindBeforeMinutes:30},loadBalancing:{enabled:!0,strategy:"Least load"},meta:{industryTemplate:"Corporate",notes:"Deal pages can have high-value assets. Keep stricter approvals."}}),t.push({id:An("FLOW"),name:"RFQ / High-value assets approvals",enabled:!0,scopeType:"RFQ",rule:{autoApprove:{enabled:!1,thresholdUGX:0,eligibleOnly:!0},requireApprovalOverUGX:0,requireAttachmentsOverUGX:0,requireCommentOverUGX:0},stages:[zs({name:"Manager approval",minAmountUGX:0,role:"Manager",slaHours:6,assignment:"First available"}),zs({name:"Finance approval",minAmountUGX:0,role:"Finance",slaHours:8,assignment:"Least load"}),zs({name:"CFO approval",minAmountUGX:0,role:"CFO",slaHours:12,assignment:"Least load"})],defaults:{policyTemplate:"Strict compliance",approvalFlowKind:"Multi-level escalation"},sla:{breachAlertsEnabled:!0,breachNotifyChannels:["Email","SMS"],remindBeforeMinutes:20},loadBalancing:{enabled:!0,strategy:"Least load"},meta:{industryTemplate:"Corporate",notes:"RFQs always require approvals and are tracked by SLA."}}),t}function P4(t){const a=v0().map(l=>({...l,id:An("FLOW"),meta:{...l.meta,industryTemplate:t}}));return t==="Hospital"&&a.forEach(l=>{l.module==="Medical & Health Care"&&(l.rule.autoApprove.thresholdUGX=8e4,l.rule.requireAttachmentsOverUGX=3e5,l.sla.remindBeforeMinutes=15,l.sla.breachNotifyChannels=["Email","SMS","WhatsApp"],l.stages.forEach(n=>n.slaHours=Math.max(2,Math.min(8,n.slaHours-2)))),l.module==="Finance & Payments"&&(l.sla.remindBeforeMinutes=10,l.sla.breachNotifyChannels=["Email","SMS"])}),t==="Tour Company"&&a.forEach(l=>{l.module==="Travel & Tourism"&&(l.rule.autoApprove.thresholdUGX=3e5,l.rule.requireCommentOverUGX=5e5,l.sla.breachNotifyChannels=["Email","WhatsApp"])}),a}function _V(){var D,m,A,f,B;const t=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],s=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],a=["Org default","Conservative","Balanced","Flexible","Strict compliance"],l=["Org default","Auto under threshold","Manager approval","Finance approval","CFO approval","Multi-level escalation"],n=["Manager","Approver","Procurement","Accountant","Finance","CFO","Org Admin","Travel Coordinator","EVzone Support","Custom"],r=["Round robin","Least load","First available","Specific user"],i=["Next stage","Org Admin","CFO","Finance Desk","Approver Desk"],o=["Delegate user","Role pool","Skip to next stage"],c=["Email","WhatsApp","WeChat","SMS"],[x,j]=d.useState([]),g=p=>{const E=An("toast");j(se=>[{id:E,...p},...se].slice(0,4)),window.setTimeout(()=>j(se=>se.filter(y=>y.id!==E)),3200)},[N,$]=d.useState("builder"),[T,k]=d.useState(()=>v0()),[q,L]=d.useState(()=>mm(v0())),[R,U]=d.useState(""),[ae,ie]=d.useState("All"),[_,W]=d.useState(()=>{var p;return((p=v0()[0])==null?void 0:p.id)||""}),J=d.useMemo(()=>T.find(p=>p.id===_)||null,[T,_]),[we,G]=d.useState(()=>[{id:"AP-1",name:"Ops Manager",role:"Manager",load:2,ooo:!1},{id:"AP-2",name:"Sales Manager",role:"Manager",load:5,ooo:!1},{id:"AP-3",name:"Procurement Desk",role:"Procurement",load:7,ooo:!1},{id:"AP-4",name:"Approver Desk",role:"Approver",load:4,ooo:!1},{id:"AP-5",name:"Finance Desk",role:"Finance",load:6,ooo:!1},{id:"AP-6",name:"Accountant",role:"Accountant",load:3,ooo:!1},{id:"AP-7",name:"CFO",role:"CFO",load:1,ooo:!1},{id:"AP-8",name:"Org Admin",role:"Org Admin",load:2,ooo:!1}]),[be,Ge]=d.useState({amountUGX:65e4,module:"Rides & Logistics",marketplace:"-",userAutoApprovalEligible:!0,attachmentsProvided:!0,commentProvided:!0,elapsedHours:0,oooRoles:[]}),[Me,je]=d.useState(!1),[Ue,Oe]=d.useState(""),[he,Y]=d.useState(!1),[Ie,ce]=d.useState(!1),[me,pe]=d.useState(!1),[de,ye]=d.useState("Module"),[Qe,Fe]=d.useState("New approval flow"),[ke,fe]=d.useState("Rides & Logistics"),[Ve,ne]=d.useState("MyLiveDealz"),[Te,Ee]=d.useState(!1),[Re,ze]=d.useState("Corporate"),[qe,He]=d.useState("append"),[_e,le]=d.useState(!1),[z,Pe]=d.useState(null),Be=d.useMemo(()=>{const p=JSON.stringify(T),E=JSON.stringify(q);return p===E?0:1},[T,q]),xe=d.useMemo(()=>{const p=R.trim().toLowerCase();return T.filter(E=>ae==="All"?!0:E.scopeType===ae).filter(E=>p?`${E.name} ${E.scopeType} ${E.module||""} ${E.marketplace||""} ${E.defaults.policyTemplate} ${E.defaults.approvalFlowKind}`.toLowerCase().includes(p):!0).sort((E,se)=>E.name.localeCompare(se.name))},[T,R,ae]);d.useEffect(()=>{var p;_&&(T.some(E=>E.id===_)||W(((p=T[0])==null?void 0:p.id)||""))},[T,_]);const Ne=d.useMemo(()=>{if(!J)return null;const p={...be};return J.scopeType==="Marketplace"&&(p.module="E-Commerce",p.marketplace=J.marketplace||"MyLiveDealz"),J.scopeType==="Module"&&J.module&&(p.module=J.module,p.marketplace=J.module==="E-Commerce"?p.marketplace==="-"?"MyLiveDealz":p.marketplace:"-"),J.scopeType==="RFQ"&&(p.module="Rides & Logistics",p.marketplace="-"),VV(J,p,we)},[J,be,we]),M=p=>{Pe(p),le(!0)},H=d.useMemo(()=>!J||!z?null:J.stages.find(p=>p.id===z)||null,[J,z]),Ae=p=>{J&&k(E=>E.map(se=>se.id===J.id?p(se):se))},oe=()=>{if(!J)return;const p=zs({name:"New stage",minAmountUGX:J.rule.requireApprovalOverUGX,role:"Manager",slaHours:8});Ae(E=>({...E,stages:[...E.stages,p]})),g({title:"Stage added",message:`Added ${p.name}.`,kind:"success"})},De=(p,E)=>{if(!J)return;const se=J.stages.findIndex(y=>y.id===p);se<0||Ae(y=>{const re=[...y.stages],[ve]=re.splice(se,1);return re.splice(E,0,ve),{...y,stages:re}})},$e=p=>{J&&(Ae(E=>({...E,stages:E.stages.filter(se=>se.id!==p)})),g({title:"Stage removed",message:`Removed stage ${p}.`,kind:"info"}))},ge=()=>{if(!J)return;const p=mm(J);p.id=An("FLOW"),p.name=`${J.name} (Copy)`,p.meta.notes=`${J.meta.notes}
Cloned from ${J.id}`,k(E=>[p,...E]),W(p.id),ce(!1),g({title:"Cloned",message:"Flow cloned.",kind:"success"})},ue=()=>{J&&(k(p=>p.filter(E=>E.id!==J.id)),g({title:"Deleted",message:"Flow deleted.",kind:"info"}))},Ke=()=>{const p={id:An("FLOW"),name:Qe.trim()||"New approval flow",enabled:!0,scopeType:de,module:de==="Module"?ke:de==="Marketplace"?"E-Commerce":void 0,marketplace:de==="Marketplace"?Ve:void 0,rule:{autoApprove:{enabled:!0,thresholdUGX:2e5,eligibleOnly:!0},requireApprovalOverUGX:2e5,requireAttachmentsOverUGX:2e6,requireCommentOverUGX:8e5},stages:[zs({name:"Manager approval",minAmountUGX:2e5,role:"Manager",slaHours:8,assignment:"Least load"})],defaults:{policyTemplate:"Balanced",approvalFlowKind:"Manager approval"},sla:{breachAlertsEnabled:!0,breachNotifyChannels:["Email"],remindBeforeMinutes:30},loadBalancing:{enabled:!0,strategy:"Least load"},meta:{notes:"",industryTemplate:de==="RFQ"?"Corporate":void 0}};de==="RFQ"&&(p.rule.autoApprove.enabled=!1,p.rule.requireApprovalOverUGX=0,p.rule.requireAttachmentsOverUGX=0,p.rule.requireCommentOverUGX=0,p.stages=[zs({name:"Manager approval",minAmountUGX:0,role:"Manager",slaHours:6,assignment:"First available"}),zs({name:"Finance approval",minAmountUGX:0,role:"Finance",slaHours:8,assignment:"Least load"}),zs({name:"CFO approval",minAmountUGX:0,role:"CFO",slaHours:12,assignment:"Least load"})],p.defaults={policyTemplate:"Strict compliance",approvalFlowKind:"Multi-level escalation"}),k(E=>[p,...E]),W(p.id),pe(!1),g({title:"Created",message:"New flow created.",kind:"success"})},b=()=>{Oe(""),Y(!1),je(!0)},v=()=>{if(!he||Ue.trim().length<8){g({title:"Publish blocked",message:"Add a reason and confirm acknowledgement.",kind:"warn"});return}L(mm(T)),je(!1),g({title:"Published",message:"Approval workflows published.",kind:"success"})},u=()=>{g({title:"Saved",message:"Draft saved (demo).",kind:"success"})},C=()=>{k(mm(q)),g({title:"Reverted",message:"Reverted to last published.",kind:"info"})},Q=()=>{var E,se;const p=P4(Re);qe==="replace"?(k(p),W(((E=p[0])==null?void 0:E.id)||"")):(k(y=>[...p,...y]),W(((se=p[0])==null?void 0:se.id)||_)),Ee(!1),g({title:"Template applied",message:`${Re} template applied (${qe}).`,kind:"success"})},O=d.useMemo(()=>{const p=T.flatMap(P=>P.stages.map(X=>{const w=(X.role==="CFO"?9:X.role==="Finance"?6:X.role==="Procurement"?5:3)+X.minAmountUGX/1e7*2,h=X.role==="Procurement"?.14:.08,K=Math.min(.4,Math.max(.02,(w-X.slaHours)/Math.max(1,X.slaHours)));return{flowId:P.id,flowName:P.name,stageId:X.id,stageName:X.name,role:X.role,avgHours:Number(w.toFixed(1)),slaHours:X.slaHours,breachRate:Number(E4(K,0,1).toFixed(2)),reworkRate:Number(h.toFixed(2))}})),E=p.reduce((P,X)=>P+X.avgHours,0)/Math.max(1,p.length),se=p.reduce((P,X)=>P+X.breachRate,0)/Math.max(1,p.length),y=p.reduce((P,X)=>P+X.reworkRate,0)/Math.max(1,p.length),re=[...p].sort((P,X)=>X.avgHours-P.avgHours)[0],ve=n.map(P=>{const X=p.filter(w=>w.role===P);if(!X.length)return null;const S=X.reduce((w,h)=>w+h.avgHours,0)/X.length;return{role:P,avgHours:Number(S.toFixed(1)),count:X.length}}).filter(Boolean);return ve.sort((P,X)=>X.avgHours-P.avgHours),{samples:p,overall:{avgHours:Number(E.toFixed(1)),breachRate:Number(se.toFixed(2)),reworkRate:Number(y.toFixed(2))},bottleneck:re,byRole:ve}},[T]),ee=p=>p.scopeType==="RFQ"?"RFQ":p.scopeType==="Marketplace"?`E-Commerce  ${p.marketplace}`:p.module||"Module";return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx($V,{toasts:x,onDismiss:p=>j(E=>E.filter(se=>se.id!==p))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:xx.green},children:e.jsx(ct,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Approval Workflow Builder"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Rules, multi-level approvals, SLAs, delegation, load balancing, and templates."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(rs,{label:`Flows: ${T.length}`,tone:"neutral"}),e.jsx(rs,{label:`Draft: ${Be?"Changed":"Clean"}`,tone:Be?"warn":"good"}),e.jsx(rs,{label:`SLA alerts: ${T.filter(p=>p.sla.breachAlertsEnabled).length}`,tone:"info"}),e.jsx(rs,{label:"Premium",tone:"info"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Rs,{variant:"outline",onClick:()=>Ee(!0),children:[e.jsx(ht,{className:"h-4 w-4"})," Templates"]}),e.jsxs(Rs,{variant:"outline",onClick:()=>pe(!0),children:[e.jsx(pt,{className:"h-4 w-4"})," New flow"]}),e.jsxs(Rs,{variant:"outline",onClick:C,disabled:!Be,children:[e.jsx(Ye,{className:"h-4 w-4"})," Revert"]}),e.jsxs(Rs,{variant:"outline",onClick:u,children:[e.jsx(Ia,{className:"h-4 w-4"})," Save"]}),e.jsxs(Rs,{variant:"primary",onClick:b,disabled:!Be,children:[e.jsx(ct,{className:"h-4 w-4"})," Publish"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"builder",label:"Builder"},{id:"templates",label:"Templates"},{id:"analytics",label:"Analytics"}].map(p=>e.jsx("button",{className:ja("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",N===p.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:N===p.id?{background:xx.green}:void 0,onClick:()=>$(p.id),children:p.label},p.id))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[N==="builder"?e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Bl,{title:"Flows",subtitle:"Search and select a flow to edit.",right:e.jsx(rs,{label:`${xe.length}`,tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3 lg:grid-cols-1",children:[e.jsx(mc,{label:"Search",value:R,onChange:U,placeholder:"MyLiveDealz, Finance, RFQ..."}),e.jsx(_a,{label:"Scope",value:ae,onChange:p=>ie(p),options:["All","Module","Marketplace","RFQ"]}),e.jsxs(Rs,{variant:"outline",onClick:()=>{U(""),ie("All"),g({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(wl,{className:"h-4 w-4"})," Reset"]})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[xe.map(p=>{const E=p.id===_;return e.jsx("button",{type:"button",onClick:()=>W(p.id),className:ja("w-full rounded-3xl border p-4 text-left transition",E?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:p.name}),e.jsx(rs,{label:p.enabled?"Enabled":"Off",tone:p.enabled?"good":"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[ee(p),"  ",p.stages.length," stage(s)"]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(rs,{label:p.defaults.policyTemplate,tone:"neutral"}),e.jsx(rs,{label:p.defaults.approvalFlowKind,tone:"info"}),p.sla.breachAlertsEnabled?e.jsx(rs,{label:"SLA alerts",tone:"warn"}):e.jsx(rs,{label:"No SLA",tone:"neutral"})]})]}),e.jsx(et,{className:"mt-1 h-5 w-5 text-slate-400"})]})},p.id)}),xe.length?null:e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(wa,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No flows"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Create a new flow or change filters."})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:e.jsxs(Rs,{variant:"outline",className:"w-full",onClick:()=>pe(!0),children:[e.jsx(pt,{className:"h-4 w-4"})," New flow"]})})]}),e.jsxs(Bl,{title:"Approver load",subtitle:"Premium: preview load balancing inputs.",children:[e.jsx("div",{className:"space-y-2",children:we.map(p=>e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:p.name}),e.jsxs("div",{className:"mt-0.5 text-xs text-slate-500",children:["Role: ",p.role]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(rs,{label:`Load: ${p.load}`,tone:p.load>=6?"warn":"neutral"}),e.jsx("button",{type:"button",className:ja("relative h-7 w-12 rounded-full border transition",p.ooo?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>G(E=>E.map(se=>se.id===p.id?{...se,ooo:!se.ooo}:se)),"aria-label":"Toggle out of office",children:e.jsx("span",{className:ja("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",p.ooo?"left-[22px]":"left-1")})})]})]},p.id))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Toggle OOO to test delegation handling in the simulator."})]})]}),e.jsx("div",{className:"space-y-4",children:J?e.jsxs(e.Fragment,{children:[e.jsxs(Bl,{title:"Flow settings",subtitle:"Rule engine: if amount > X then approval required.",right:e.jsx(rs,{label:J.scopeType,tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(mc,{label:"Flow name",value:J.name,onChange:p=>Ae(E=>({...E,name:p})),placeholder:"Approval flow name"}),e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Enabled"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Enable at checkout"})]}),e.jsx("button",{type:"button",className:ja("relative h-7 w-12 rounded-full border transition",J.enabled?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>Ae(p=>({...p,enabled:!p.enabled})),"aria-label":"Toggle enabled",children:e.jsx("span",{className:ja("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",J.enabled?"left-[22px]":"left-1")})})]})}),e.jsx(_a,{label:"Policy template",value:J.defaults.policyTemplate,onChange:p=>Ae(E=>({...E,defaults:{...E.defaults,policyTemplate:p}})),options:a,hint:"Maps to Policy Builder"}),e.jsx(_a,{label:"Default approval flow kind",value:J.defaults.approvalFlowKind,onChange:p=>Ae(E=>({...E,defaults:{...E.defaults,approvalFlowKind:p}})),options:l,hint:"Classifies this flow"}),e.jsxs("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Scope"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Different flows per module and per marketplace, plus RFQ."})]}),e.jsx(rs,{label:ee(J),tone:"neutral"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(_a,{label:"Scope type",value:J.scopeType,onChange:p=>{const E=p;Ae(se=>{const y=mm(se);return y.scopeType=E,E==="Module"&&(y.module=y.module||"Rides & Logistics",y.marketplace=void 0),E==="Marketplace"&&(y.module="E-Commerce",y.marketplace=y.marketplace||"MyLiveDealz"),E==="RFQ"&&(y.module=void 0,y.marketplace=void 0,y.rule.autoApprove.enabled=!1,y.rule.requireApprovalOverUGX=0,y.rule.requireAttachmentsOverUGX=0,y.rule.requireCommentOverUGX=0),y})},options:["Module","Marketplace","RFQ"]}),e.jsx(_a,{label:"Module",value:J.scopeType==="Marketplace"?"E-Commerce":J.module||"Rides & Logistics",onChange:p=>Ae(E=>({...E,module:p})),options:t,disabled:J.scopeType==="RFQ"||J.scopeType==="Marketplace",hint:J.scopeType==="Marketplace"?"Fixed: E-Commerce":""}),e.jsx(_a,{label:"Marketplace",value:J.marketplace||"MyLiveDealz",onChange:p=>Ae(E=>({...E,marketplace:p})),options:s,disabled:J.scopeType!=="Marketplace",hint:J.scopeType==="Marketplace"?"E-Commerce only":""}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Industry tag"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(rs,{label:J.meta.industryTemplate||"(none)",tone:"neutral"}),e.jsx(rs,{label:"Cloneable",tone:"info"})]})]})]})]})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:[e.jsxs(Rs,{variant:"outline",onClick:()=>ce(!0),children:[e.jsx(ls,{className:"h-4 w-4"})," Clone"]}),e.jsxs(Rs,{variant:"danger",onClick:ue,children:[e.jsx(Ye,{className:"h-4 w-4"})," Delete"]})]})]}),e.jsxs(Bl,{title:"Rule engine",subtitle:"Auto-approve under threshold (if eligible). Above threshold routes to multi-level approvals.",right:e.jsx(rs,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Yi,{enabled:J.rule.autoApprove.enabled,onChange:p=>Ae(E=>({...E,rule:{...E.rule,autoApprove:{...E.rule.autoApprove,enabled:p}}})),label:"Enable auto-approve",description:"Uses eligibility flag and threshold."}),e.jsx(Yi,{enabled:J.rule.autoApprove.eligibleOnly,onChange:p=>Ae(E=>({...E,rule:{...E.rule,autoApprove:{...E.rule.autoApprove,eligibleOnly:p}}})),label:"Eligibility required",description:"Only auto-approve for eligible users."}),e.jsx(Dr,{label:"Auto-approve threshold (UGX)",value:J.rule.autoApprove.thresholdUGX,onChange:p=>Ae(E=>({...E,rule:{...E.rule,autoApprove:{...E.rule.autoApprove,thresholdUGX:p}}})),hint:`Preview: ${uc(J.rule.autoApprove.thresholdUGX)}`,disabled:!J.rule.autoApprove.enabled}),e.jsx(Dr,{label:"Approval required when amount is over (UGX)",value:J.rule.requireApprovalOverUGX,onChange:p=>Ae(E=>({...E,rule:{...E.rule,requireApprovalOverUGX:p}})),hint:`Rule: if amount > ${uc(J.rule.requireApprovalOverUGX)} then approvals`}),e.jsx(Dr,{label:"Require comment above (UGX)",value:J.rule.requireCommentOverUGX,onChange:p=>Ae(E=>({...E,rule:{...E.rule,requireCommentOverUGX:p}})),hint:"Adds accountability"}),e.jsx(Dr,{label:"Require attachments above (UGX)",value:J.rule.requireAttachmentsOverUGX,onChange:p=>Ae(E=>({...E,rule:{...E.rule,requireAttachmentsOverUGX:p}})),hint:"Specs, invoices, PDFs"})]}),e.jsxs("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Effective rule:",e.jsxs("ul",{className:"mt-2 space-y-1 text-xs text-slate-600",children:[e.jsx("li",{children:"1) If amount  auto-approve threshold and eligible, approve automatically"}),e.jsx("li",{children:"2) If amount > approval trigger, route to approval stages"}),e.jsx("li",{children:"3) Above comment/attachment thresholds, enforce requirements"})]})]})]}),e.jsxs(Bl,{title:"Approval stages",subtitle:"Multi-level approvals with escalation paths and delegation handling.",right:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(rs,{label:`${J.stages.length} stages`,tone:"neutral"}),e.jsxs(Rs,{variant:"outline",onClick:oe,children:[e.jsx(pt,{className:"h-4 w-4"})," Add stage"]})]}),children:[e.jsxs("div",{className:"space-y-3",children:[J.stages.map((p,E)=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:p.name}),e.jsx(rs,{label:`Min: ${uc(p.minAmountUGX)}`,tone:"neutral"}),e.jsx(rs,{label:p.role,tone:LV(p.role)}),e.jsx(rs,{label:`SLA: ${p.slaHours}h`,tone:p.slaHours<=4?"warn":"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Assignment: ",p.assignment,p.assignment==="Specific user"&&p.specificUser?` (${p.specificUser})`:""]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Escalation: ",p.escalation.enabled?`${p.escalation.target} after ${p.escalation.afterHours}h`:"Off"]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Delegation: ",p.delegation.enabled?`${p.delegation.mode}`:"Off"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Rs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>M(p.id),children:[e.jsx(wl,{className:"h-4 w-4"})," Edit"]}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:E,onChange:se=>De(p.id,Number(se.target.value)),className:"appearance-none rounded-2xl border border-slate-200 bg-white py-2 pl-3 pr-8 text-xs font-semibold text-slate-700 outline-none hover:bg-slate-50 focus:ring-2 focus:ring-emerald-100",children:J.stages.map((se,y)=>e.jsxs("option",{value:y,children:["Step ",y+1]},y))}),e.jsx(li,{className:"absolute right-2 top-1/2 h-3 w-3 -translate-y-1/2 text-slate-400 pointer-events-none"})]}),e.jsx(Rs,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>$e(p.id),children:e.jsx(Ye,{className:"h-4 w-4"})})]})]})},p.id)),J.stages.length?null:e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(wa,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No stages"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Add a stage to enforce approvals."})]})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: load balancing strategies distribute approvals and reduce bottlenecks."})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"SLA & Breach Management"}),e.jsxs("div",{className:"mt-2 flex flex-col gap-4",children:[e.jsx(DV,{title:"SLA configuration",subtitle:"Breach thresholds and reminders",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Yi,{label:"Breach alerts",description:"Notify when approval SLA is breached",enabled:J.sla.breachAlertsEnabled,onChange:p=>Ae(E=>({...E,sla:{...E.sla,breachAlertsEnabled:p}}))}),e.jsx(Dr,{label:"Remind before (minutes)",value:J.sla.remindBeforeMinutes,onChange:p=>Ae(E=>({...E,sla:{...E.sla,remindBeforeMinutes:p}})),hint:"Send early reminder to approver"})]})}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"Alert and breaching channels"}),e.jsx("div",{className:"mt-1 text-sm text-slate-500",children:"Configure how and where breach notifications are sent."})]}),e.jsx(rs,{label:`${J.sla.breachNotifyChannels.length} active`,tone:"warn"})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-500",children:"Channels"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.map(p=>{const E=J.sla.breachNotifyChannels.includes(p);return e.jsxs("button",{onClick:()=>{Ae(se=>{const y=E?se.sla.breachNotifyChannels.filter(re=>re!==p):[...se.sla.breachNotifyChannels,p];return{...se,sla:{...se.sla,breachNotifyChannels:y}}})},className:ja("flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-medium transition-all duration-200 border",E?"bg-emerald-50 border-emerald-200 text-emerald-700 shadow-sm":"bg-white border-slate-200 text-slate-600 hover:border-slate-300 hover:bg-slate-50"),children:[FV(p),p,E&&e.jsx(tt,{className:"h-3.5 w-3.5 ml-1"})]},p)})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-500",children:"Escalation Preview"}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-4 text-xs text-slate-600 leading-relaxed border border-slate-100",children:["When an approval breaches the SLA limit (current: ",e.jsxs("strong",{children:[((D=J.stages[0])==null?void 0:D.slaHours)||8,"h"]}),"), a notification will be sent via ",e.jsx("strong",{children:J.sla.breachNotifyChannels.join(", ")||"no channels"}),". Depending on stage settings, the request may auto-escalate to the next approver or Admin."]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Rs,{variant:"outline",className:"w-full text-xs h-9",children:[e.jsx($o,{className:"h-3.5 w-3.5 mr-2"})," Send test alert"]}),e.jsxs(Rs,{variant:"outline",className:"w-full text-xs h-9",children:[e.jsx(yi,{className:"h-3.5 w-3.5 mr-2"})," Configure template"]})]})]})]})]})]})]})]}):e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-10 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(ct,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"Select a flow"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Choose a flow on the left to edit rules and stages."})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Bl,{title:"Simulator",subtitle:"Premium: test scenarios and preview decisions.",right:Ne?e.jsx(rs,{label:Ne.status,tone:Ne.status==="Auto-approved"?"good":Ne.status==="Blocked"?"bad":"warn"}):null,children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx(Dr,{label:"Amount (UGX)",value:be.amountUGX,onChange:p=>Ge(E=>({...E,amountUGX:p})),hint:`Preview: ${uc(be.amountUGX)}`}),e.jsx(_a,{label:"Service Module",value:be.module,onChange:p=>Ge(E=>({...E,module:p})),options:t,disabled:!!J&&(J.scopeType==="Marketplace"||J.scopeType==="RFQ"),hint:(J==null?void 0:J.scopeType)==="Marketplace"?"Driven by flow":(J==null?void 0:J.scopeType)==="RFQ"?"Driven by RFQ":""}),e.jsx(_a,{label:"Marketplace",value:be.marketplace==="-"?"MyLiveDealz":be.marketplace,onChange:p=>Ge(E=>({...E,marketplace:p})),options:s,disabled:be.module!=="E-Commerce"||(J==null?void 0:J.scopeType)==="RFQ",hint:be.module!=="E-Commerce"?"Applies to E-Commerce only":""}),e.jsx(Yi,{enabled:be.userAutoApprovalEligible,onChange:p=>Ge(E=>({...E,userAutoApprovalEligible:p})),label:"User is auto-approval eligible",description:"Set by org admin when creating the user."}),e.jsx(Yi,{enabled:be.attachmentsProvided,onChange:p=>Ge(E=>({...E,attachmentsProvided:p})),label:"Attachments provided",description:"Required above configured threshold."}),e.jsx(Yi,{enabled:be.commentProvided,onChange:p=>Ge(E=>({...E,commentProvided:p})),label:"Comment provided",description:"Required above configured threshold."}),e.jsx(Dr,{label:"Elapsed time (hours)",value:be.elapsedHours,onChange:p=>Ge(E=>({...E,elapsedHours:p})),hint:"Used to show SLA breach previews"}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Out-of-office simulation"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Delegation handling routes tasks if approver is OOO."}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2",children:["Manager","Procurement","Finance","CFO"].map(p=>{const E=be.oooRoles.includes(p);return e.jsxs("button",{type:"button",className:ja("flex items-center justify-between rounded-2xl border px-3 py-2 text-sm font-semibold",E?"border-amber-300 bg-amber-50":"border-slate-200 bg-white hover:bg-slate-50"),onClick:()=>{Ge(se=>{const y=new Set(se.oooRoles);return y.has(p)?y.delete(p):y.add(p),{...se,oooRoles:Array.from(y)}})},children:[e.jsx("span",{children:p}),e.jsx(rs,{label:E?"OOO":"OK",tone:E?"warn":"good"})]},p)})})]})]}),Ne?e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Decision"}),e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:Ne.status}),Ne.reasons.length?e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsx("div",{className:"font-semibold",children:"Reasons"}),e.jsx("ul",{className:"mt-2 space-y-1 text-xs text-slate-600",children:Ne.reasons.map((p,E)=>e.jsxs("li",{children:[" ",p]},E))})]}):null,Ne.stages.length?e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Approval path"}),e.jsx("div",{className:"mt-2 space-y-2",children:Ne.stages.map(p=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:p.stage.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Role: ",p.stage.role,"  Assigned: ",p.assignedTo]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["SLA: ",p.stage.slaHours,"h  Due in: ",Math.round(p.slaDueInHours*10)/10,"h"]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsx(rs,{label:p.breached?"Breached":"OK",tone:p.breached?"bad":"good"}),e.jsx(rs,{label:`Escalate: ${p.escalationTo}`,tone:"neutral"})]})]})},p.stage.id))}),J!=null&&J.sla.breachAlertsEnabled?e.jsxs("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:["SLA breach alerts enabled. Channels: ",J.sla.breachNotifyChannels.join(", ")]}):null]}):null]}):null]}),e.jsx(Bl,{title:"Approval templates",subtitle:"Premium: industry templates and cloning.",children:e.jsx("div",{className:"grid grid-cols-1 gap-2",children:[{id:"Corporate",desc:"Balanced enterprise approvals."},{id:"Hospital",desc:"Strict compliance, faster SLAs."},{id:"Tour Company",desc:"Travel heavy defaults."}].map(p=>e.jsx("button",{type:"button",className:"rounded-3xl border border-slate-200 bg-white p-4 text-left hover:bg-slate-50",onClick:()=>{ze(p.id),He("append"),Ee(!0)},children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:p.id}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:p.desc})]}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]})},p.id))})})]})]}):null,N==="templates"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsx(Bl,{title:"Template library",subtitle:"Premium: apply a template set and then customize.",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(_a,{label:"Industry",value:Re,onChange:p=>ze(p),options:["Corporate","Hospital","Tour Company"]}),e.jsx(_a,{label:"Apply mode",value:qe,onChange:p=>He(p),options:["append","replace"],hint:"Append adds new flows; replace overwrites all."}),e.jsxs(Rs,{variant:"primary",className:"w-full",onClick:()=>Ee(!0),children:[e.jsx(ht,{className:"h-4 w-4"})," Apply template"]}),e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Templates include per-module and per-marketplace flows, plus RFQ."})]})}),e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsx(Bl,{title:"Preview",subtitle:"What gets added by the selected template.",children:P4(Re).map(p=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:p.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Scope: ",ee(p),"  Stages: ",p.stages.length]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(rs,{label:p.defaults.policyTemplate,tone:"neutral"}),e.jsx(rs,{label:p.defaults.approvalFlowKind,tone:"info"}),e.jsx(rs,{label:`SLA alerts: ${p.sla.breachAlertsEnabled?"On":"Off"}`,tone:p.sla.breachAlertsEnabled?"warn":"neutral"})]})]}),e.jsx(rs,{label:Re,tone:"info"})]})},p.id))}),e.jsxs(Bl,{title:"Cloning",subtitle:"Premium: clone a flow to create a variant for a different module or marketplace.",children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Recommended use:",e.jsxs("ul",{className:"mt-2 space-y-1 text-xs text-slate-600",children:[e.jsx("li",{children:"1) Clone E-Commerce default into EVmart override"}),e.jsx("li",{children:"2) Tighten thresholds and add extra stage (Finance or CFO)"}),e.jsx("li",{children:"3) Publish and preview impact"})]})]}),e.jsxs(Rs,{variant:"outline",className:"mt-3",onClick:()=>ce(!0),disabled:!J,children:[e.jsx(ls,{className:"h-4 w-4"})," Clone selected flow"]})]})]})]}):null,N==="analytics"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs(Bl,{title:"Approval analytics",subtitle:"Premium: cycle time, bottlenecks, and rework rate.",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx(F,{title:"Average cycle time",value:`${O.overall.avgHours}h`,icon:e.jsx(OE,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(F,{title:"SLA breach rate",value:`${Math.round(O.overall.breachRate*100)}%`,icon:e.jsx(sl,{className:"h-5 w-5"}),tone:O.overall.breachRate>.25?"warn":"good"}),e.jsx(F,{title:"Rework rate",value:`${Math.round(O.overall.reworkRate*100)}%`,icon:e.jsx(Mt,{className:"h-5 w-5"}),tone:O.overall.reworkRate>.12?"warn":"neutral"})]}),e.jsxs("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Bottleneck stage:",e.jsx("div",{className:"mt-2 font-semibold text-slate-900",children:(m=O.bottleneck)==null?void 0:m.stageName}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Role: ",(A=O.bottleneck)==null?void 0:A.role,"  Avg: ",(f=O.bottleneck)==null?void 0:f.avgHours,"h  SLA: ",(B=O.bottleneck)==null?void 0:B.slaHours,"h"]})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: analytics should use real historical approvals. This demo uses synthetic data."})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsx(Bl,{title:"Bottlenecks by role",subtitle:"Average stage time by approver role.",children:e.jsx("div",{className:"space-y-2",children:O.byRole.slice(0,10).map(p=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:p.role}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Stages: ",p.count]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(rs,{label:`Avg ${p.avgHours}h`,tone:p.avgHours>=8?"warn":"neutral"}),e.jsx("div",{className:"h-2 w-40 overflow-hidden rounded-full bg-slate-100",children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${E4(p.avgHours/12*100,0,100)}%`,background:xx.green}})})]})]})},p.role))})}),e.jsxs(Bl,{title:"Flow health",subtitle:"Identify risky flows and tighten defaults.",children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Flow"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Scope"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Stages"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Auto-approve"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"SLA alerts"})]})}),e.jsx("tbody",{children:T.map(p=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:p.name}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:ee(p)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(rs,{label:`${p.stages.length}`,tone:"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(rs,{label:p.rule.autoApprove.enabled?"On":"Off",tone:p.rule.autoApprove.enabled?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(rs,{label:p.sla.breachAlertsEnabled?"On":"Off",tone:p.sla.breachAlertsEnabled?"warn":"neutral"})})]},p.id))})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Use templates and cloning to improve bottlenecks and reduce rework."})]})]})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"J Approval Workflow Builder v2: rule engine, multi-level approvals, per-module and per-marketplace flows, auto-approve eligibility, attachments/comments thresholds, delegation, SLA alerts, load balancing, analytics, templates and cloning."})})]})}),e.jsx(IV,{open:_e,title:H?`Edit stage: ${H.name}`:"Edit stage",subtitle:H?`${H.role}  Min ${uc(H.minAmountUGX)}  SLA ${H.slaHours}h`:"",onClose:()=>le(!1),actions:[{label:"Save changes",onClick:u,variant:"default"},{label:"Close",onClick:()=>le(!1)}],footer:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Changes are draft-only until published."}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Rs,{variant:"outline",onClick:()=>le(!1),children:"Close"}),e.jsxs(Rs,{variant:"primary",onClick:u,children:[e.jsx(Ia,{className:"h-4 w-4"})," Save"]})]})]}),children:J&&H?e.jsxs("div",{className:"space-y-4",children:[e.jsx(mc,{label:"Stage name",value:H.name,onChange:p=>Ae(E=>({...E,stages:E.stages.map(se=>se.id===H.id?{...se,name:p}:se)})),placeholder:"Manager approval"}),e.jsx(Dr,{label:"Minimum amount (UGX)",value:H.minAmountUGX,onChange:p=>Ae(E=>({...E,stages:E.stages.map(se=>se.id===H.id?{...se,minAmountUGX:p}:se)})),hint:`Stage applies when amount  ${uc(H.minAmountUGX)}`}),e.jsx(_a,{label:"Approver role",value:H.role,onChange:p=>Ae(E=>({...E,stages:E.stages.map(se=>se.id===H.id?{...se,role:p}:se)})),options:n,hint:"Role pool"}),e.jsx(_a,{label:"Assignment strategy",value:H.assignment,onChange:p=>Ae(E=>({...E,stages:E.stages.map(se=>se.id===H.id?{...se,assignment:p}:se)})),options:r,hint:"Premium load balancing"}),e.jsx(mc,{label:"Specific user",value:H.specificUser||"",onChange:p=>Ae(E=>({...E,stages:E.stages.map(se=>se.id===H.id?{...se,specificUser:p}:se)})),placeholder:"Name",disabled:H.assignment!=="Specific user",hint:"Used only when strategy is Specific user"}),e.jsx(Dr,{label:"SLA (hours)",value:H.slaHours,onChange:p=>Ae(E=>({...E,stages:E.stages.map(se=>se.id===H.id?{...se,slaHours:p}:se)})),hint:"Premium: SLA timers and breach alerts"}),e.jsxs(Bl,{title:"Escalation",subtitle:"Escalate when SLA is breached.",children:[e.jsx(Yi,{enabled:H.escalation.enabled,onChange:p=>Ae(E=>({...E,stages:E.stages.map(se=>se.id===H.id?{...se,escalation:{...se.escalation,enabled:p}}:se)})),label:"Enable escalation",description:"Escalates after the configured time"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(Dr,{label:"Escalate after (hours)",value:H.escalation.afterHours,onChange:p=>Ae(E=>({...E,stages:E.stages.map(se=>se.id===H.id?{...se,escalation:{...se.escalation,afterHours:p}}:se)})),disabled:!H.escalation.enabled}),e.jsx(_a,{label:"Escalation target",value:H.escalation.target,onChange:p=>Ae(E=>({...E,stages:E.stages.map(se=>se.id===H.id?{...se,escalation:{...se.escalation,target:p}}:se)})),options:i,disabled:!H.escalation.enabled})]})]}),e.jsxs(Bl,{title:"Delegation",subtitle:"Out-of-office routing.",children:[e.jsx(Yi,{enabled:H.delegation.enabled,onChange:p=>Ae(E=>({...E,stages:E.stages.map(se=>se.id===H.id?{...se,delegation:{...se.delegation,enabled:p}}:se)})),label:"Enable delegation",description:"Routes tasks when approver is OOO"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(_a,{label:"Delegation mode",value:H.delegation.mode,onChange:p=>Ae(E=>({...E,stages:E.stages.map(se=>se.id===H.id?{...se,delegation:{...se.delegation,mode:p}}:se)})),options:o,disabled:!H.delegation.enabled}),e.jsx(_a,{label:"Delegate role",value:H.delegation.delegateRole||H.role,onChange:p=>Ae(E=>({...E,stages:E.stages.map(se=>se.id===H.id?{...se,delegation:{...se.delegation,delegateRole:p}}:se)})),options:n,disabled:!H.delegation.enabled||H.delegation.mode!=="Role pool"}),e.jsx(mc,{label:"Delegate user",value:H.delegation.delegateUser||"",onChange:p=>Ae(E=>({...E,stages:E.stages.map(se=>se.id===H.id?{...se,delegation:{...se.delegation,delegateUser:p}}:se)})),placeholder:"Name",disabled:!H.delegation.enabled||H.delegation.mode!=="Delegate user"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Delegation behavior is previewed in the Simulator panel."})]})]}):null}),e.jsx(hh,{open:me,title:"New approval flow",subtitle:"Create a per-module, per-marketplace, or RFQ flow.",onClose:()=>pe(!1),actions:[{label:"Create",onClick:Ke,variant:"default"},{label:"Cancel",onClick:()=>pe(!1)}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Rs,{variant:"outline",onClick:()=>pe(!1),children:"Cancel"}),e.jsxs(Rs,{variant:"primary",onClick:Ke,children:[e.jsx(pt,{className:"h-4 w-4"})," Create"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(mc,{label:"Name",value:Qe,onChange:Fe,placeholder:"New flow"}),e.jsx(_a,{label:"Scope type",value:de,onChange:p=>ye(p),options:["Module","Marketplace","RFQ"]}),e.jsx(_a,{label:"Module",value:ke,onChange:p=>fe(p),options:t,disabled:de!=="Module"}),e.jsx(_a,{label:"Marketplace",value:Ve,onChange:p=>ne(p),options:s,disabled:de!=="Marketplace"}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Marketplace flows are always under E-Commerce."})]})}),e.jsx(hh,{open:Ie,title:"Clone flow",subtitle:"Premium: clone and then tweak thresholds, stages, or scope.",onClose:()=>ce(!1),actions:[{label:"Clone",onClick:ge,variant:"default"},{label:"Cancel",onClick:()=>ce(!1)}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Rs,{variant:"outline",onClick:()=>ce(!1),children:"Cancel"}),e.jsxs(Rs,{variant:"primary",onClick:ge,disabled:!J,children:[e.jsx(ls,{className:"h-4 w-4"})," Clone"]})]}),children:J?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Selected: ",e.jsx("span",{className:"font-semibold text-slate-900",children:J.name}),e.jsxs("div",{className:"mt-1 text-slate-600",children:["Scope: ",ee(J),"  Stages: ",J.stages.length]})]}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Cloning is best for marketplace overrides and custom high-value approval paths."})]}):null}),e.jsxs(hh,{open:Te,title:"Apply template",subtitle:"Premium: industry templates with cloning support.",onClose:()=>Ee(!1),actions:[{label:"Apply",onClick:Q,variant:"default"},{label:"Cancel",onClick:()=>Ee(!1)}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Rs,{variant:"outline",onClick:()=>Ee(!1),children:"Cancel"}),e.jsxs(Rs,{variant:"primary",onClick:Q,children:[e.jsx(ht,{className:"h-4 w-4"})," Apply"]})]}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(_a,{label:"Industry",value:Re,onChange:p=>ze(p),options:["Corporate","Hospital","Tour Company"]}),e.jsx(_a,{label:"Apply mode",value:qe,onChange:p=>He(p),options:["append","replace"],hint:"Append adds; replace overwrites."})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Templates generate flows per service module, marketplaces under E-Commerce, and RFQ."})]}),e.jsxs(hh,{open:Me,title:"Publish approval workflows",subtitle:"Provide a reason. This would be audit logged in production.",onClose:()=>je(!1),actions:[{label:"Publish",onClick:v,variant:"default"},{label:"Cancel",onClick:()=>je(!1)}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Rs,{variant:"outline",onClick:()=>je(!1),children:"Cancel"}),e.jsxs(Rs,{variant:"primary",onClick:v,disabled:!he||Ue.trim().length<8,children:[e.jsx(ct,{className:"h-4 w-4"})," Publish"]})]}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Draft contains changes compared to published configuration."}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Reason"}),e.jsx("textarea",{value:Ue,onChange:p=>Oe(p.target.value),placeholder:"Example: enable stricter MyLiveDealz approvals; add CFO stage for high-value purchases; keep pilot rollout",rows:4,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"}),e.jsxs("label",{className:"mt-3 flex items-start gap-3 rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("input",{type:"checkbox",checked:he,onChange:p=>Y(p.target.checked),className:"mt-1 h-4 w-4 rounded border-slate-300"}),e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"I confirm this change is authorized and should be logged."})]}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Minimum reason length: 8 characters."})]})]})]});function F({title:p,value:E,icon:se,tone:y}){const re=y==="bad"?"bg-rose-50 text-rose-700":y==="warn"?"bg-amber-50 text-amber-800":y==="good"?"bg-emerald-50 text-emerald-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:p}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:E})]}),e.jsx("div",{className:ja("grid h-10 w-10 place-items-center rounded-2xl",re),children:se})]})})}}const oy={green:"#03CD8C",orange:"#F77F00"};function BV({actions:t}){const[s,a]=d.useState(!1),l=Xt.useRef(null);return d.useEffect(()=>{function n(r){l.current&&!l.current.contains(r.target)&&a(!1)}return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"flex h-8 w-8 items-center justify-center rounded-full text-slate-500 hover:bg-slate-100",children:e.jsx(xs,{className:"h-4 w-4"})}),s&&e.jsx("div",{className:"absolute right-0 top-full z-50 mt-1 w-48 origin-top-right overflow-hidden rounded-2xl border border-slate-100 bg-white p-1 shadow-lg ring-1 ring-slate-200",children:t.map((n,r)=>e.jsx("button",{onClick:()=>{n.onClick(),a(!1)},className:ri("flex w-full items-center px-3 py-2 text-sm font-medium transition-colors hover:bg-slate-50",n.variant==="danger"?"text-rose-600":"text-slate-700"),children:n.label},r))})]})}function ri(...t){return t.filter(Boolean).join(" ")}function gh(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function px(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function b0(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function GV(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function dy(t){const s=Math.round((t-Date.now())/6e4),a=Math.abs(s),l=Math.floor(a/60),n=a%60,r=l?`${l}h ${n}m`:`${n}m`;return s>=0?`Due in ${r}`:`Overdue by ${r}`}function hx(t){return Date.now()>t}function VE(t,s=120){const a=t-Date.now();return a>0&&a<=s*60*1e3}function lu(t){return t==="High"?"bad":t==="Medium"?"warn":"good"}function cy(t){return t==="Approved"?"good":t==="Rejected"||t==="Breached"||t==="Escalated"?"bad":"warn"}function $s({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:ri("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function ia({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:oy.green}:t==="accent"?{background:oy.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:ri(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function ad({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100 disabled:bg-slate-50 disabled:text-slate-500",children:l.map(i=>e.jsx("option",{value:i,children:i},i))})]})}function fh({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:i=>a(i.target.value),placeholder:l,rows:r,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"})]})}function xm({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="920px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[8vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-1",children:[o?e.jsx(BV,{actions:o}):null,e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function qV({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:ri("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function O4(t,s){const a={};for(const l of t){const n=s(l);a[n]=a[n]||[],a[n].push(l)}return a}function zV(t){const s=[];return t.length?(t.filter(c=>c.status==="Pending"||c.status==="Breached"||c.status==="Escalated"||c.status==="Needs info").length!==t.length&&s.push("Only open items can be bulk approved"),Array.from(new Set(t.map(c=>c.vendor))).length!==1&&s.push("Bulk approve requires the same vendor"),t.every(c=>c.risk==="Low")||s.push("Bulk approve requires low risk items"),t.some(c=>c.requiresAttachment&&!c.hasAttachment)&&s.push("All items must have required attachments"),t.reduce((c,x)=>c+x.amountUGX,0)>3e6&&s.push("Bulk approve total is above safeguard cap (UGX 3,000,000)"),{ok:s.length===0,reasons:s}):{ok:!1,reasons:["Select at least one item"]}}function WV(){var se;const t=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],s=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],a=["Operations","Sales","Finance","Admin","Procurement"],[l,n]=d.useState([]),r=y=>{const re=gh("toast");n(ve=>[{id:re,...y},...ve].slice(0,4)),window.setTimeout(()=>n(ve=>ve.filter(P=>P.id!==re)),3200)},i=Date.now(),[o,c]=d.useState(()=>[{id:"AP-1821",tx:"Purchase",module:"E-Commerce",marketplace:"MyLiveDealz",group:"Operations",requester:"Mary N.",vendor:"Shenzhen Store",amountUGX:654e3,createdAt:i-2*60*60*1e3,slaDueAt:i+2*60*60*1e3,status:"Pending",risk:"High",assignedTo:"Procurement Desk",patternKey:"vendor_anomaly_shenzhen",requiresAttachment:!0,hasAttachment:!0,requiresComment:!0,hasComment:!0,history:[{at:i-2*60*60*1e3,by:"System",action:"Created"}]},{id:"RFQ-390",tx:"RFQ",module:"Rides & Logistics",marketplace:"-",group:"Admin",requester:"Ronald I.",vendor:"Vehicle Supplier",amountUGX:285e6,createdAt:i-26*60*60*1e3,slaDueAt:i-2*60*60*1e3,status:"Escalated",risk:"High",assignedTo:"CFO",patternKey:"rfq_high_value",requiresAttachment:!0,hasAttachment:!0,requiresComment:!0,hasComment:!0,history:[{at:i-26*60*60*1e3,by:"System",action:"Created"},{at:i-18*60*60*1e3,by:"Manager",action:"Approved",why:"Needed"},{at:i-9*60*60*1e3,by:"Finance Desk",action:"Approved",why:"Budget check"}]},{id:"RD-0442",tx:"Ride",module:"Rides & Logistics",marketplace:"-",group:"Sales",requester:"John S.",vendor:"EVzone Rides",amountUGX:41500,createdAt:i-35*60*1e3,slaDueAt:i+3*60*60*1e3,status:"Pending",risk:"Low",assignedTo:"Approver Desk",patternKey:"commute_repeat",requiresAttachment:!1,hasAttachment:!1,requiresComment:!1,hasComment:!1,history:[{at:i-35*60*1e3,by:"System",action:"Created"}]},{id:"SV-2201",tx:"Service",module:"EVs & Charging",marketplace:"-",group:"Finance",requester:"Finance Desk",vendor:"EVzone Charging",amountUGX:18e5,createdAt:i-4*60*60*1e3,slaDueAt:i+1*60*60*1e3,status:"Pending",risk:"Medium",assignedTo:"Finance Desk",patternKey:"charging_credits",requiresAttachment:!0,hasAttachment:!1,requiresComment:!0,hasComment:!0,history:[{at:i-4*60*60*1e3,by:"System",action:"Created"}]},{id:"PO-9002",tx:"Purchase",module:"E-Commerce",marketplace:"EVmart",group:"Operations",requester:"Irene K.",vendor:"Kampala Office Mart",amountUGX:12e4,createdAt:i-90*60*1e3,slaDueAt:i+4*60*60*1e3,status:"Pending",risk:"Low",assignedTo:"Procurement Desk",patternKey:"low_risk_vendor",requiresAttachment:!1,hasAttachment:!1,requiresComment:!1,hasComment:!1,history:[{at:i-90*60*1e3,by:"System",action:"Created"}]},{id:"PO-9003",tx:"Purchase",module:"E-Commerce",marketplace:"EVmart",group:"Operations",requester:"Irene K.",vendor:"Kampala Office Mart",amountUGX:98e3,createdAt:i-120*60*1e3,slaDueAt:i+4*60*60*1e3,status:"Pending",risk:"Low",assignedTo:"Procurement Desk",patternKey:"low_risk_vendor",requiresAttachment:!1,hasAttachment:!1,requiresComment:!1,hasComment:!1,history:[{at:i-120*60*1e3,by:"System",action:"Created"}]},{id:"EX-0011",tx:"Exception",module:"Finance & Payments",marketplace:"-",group:"Finance",requester:"Daisy O.",vendor:"CorporatePay",amountUGX:0,createdAt:i-7*60*60*1e3,slaDueAt:i-20*60*1e3,status:"Breached",risk:"High",assignedTo:"Org Admin",patternKey:"policy_exception",requiresAttachment:!0,hasAttachment:!0,requiresComment:!0,hasComment:!0,history:[{at:i-7*60*60*1e3,by:"System",action:"Created"}]}]),[x,j]=d.useState(()=>[{id:"AUD-001",at:i-9*60*60*1e3,by:"Finance Desk",action:"Approve",itemId:"RFQ-390",why:"Budget confirmed"}]),[g]=d.useState(()=>[{id:"APR-01",name:"Approver Desk",role:"Approver Desk",load:4,ooo:!1},{id:"APR-02",name:"Procurement Desk",role:"Procurement Desk",load:6,ooo:!1},{id:"APR-03",name:"Finance Desk",role:"Finance Desk",load:7,ooo:!1},{id:"APR-04",name:"CFO",role:"CFO",load:1,ooo:!1},{id:"APR-05",name:"Org Admin",role:"Org Admin",load:2,ooo:!1}]),[N,$]=d.useState(""),[T,k]=d.useState("All"),[q,L]=d.useState("All"),[R,U]=d.useState("All"),[ae,ie]=d.useState("All"),[_,W]=d.useState("All"),[J,we]=d.useState("None"),[G,be]=d.useState("sla"),[Ge,Me]=d.useState("asc"),[je,Ue]=d.useState(new Set),[Oe,he]=d.useState(!1),[Y,Ie]=d.useState(""),[ce,me]=d.useState(!1),[pe,de]=d.useState(!1),[ye,Qe]=d.useState("Approve"),[Fe,ke]=d.useState([]),[fe,Ve]=d.useState(""),[ne,Te]=d.useState(!1),[Ee,Re]=d.useState(null),[ze,qe]=d.useState("Supporting document added"),[He,_e]=d.useState(!1),[le,z]=d.useState(null),[Pe,Be]=d.useState(((se=g[0])==null?void 0:se.name)||"Approver Desk"),[xe,Ne]=d.useState("Reassign to avoid SLA breach"),[M,H]=d.useState(!1),[Ae,oe]=d.useState(null),De=d.useMemo(()=>ae==="All"||ae==="E-Commerce",[ae]),$e=d.useMemo(()=>{const y=N.trim().toLowerCase();return o.filter(re=>{if(T!=="All"&&re.status!==T||q!=="All"&&re.risk!==q||R!=="All"&&re.group!==R||ae!=="All"&&re.module!==ae)return!1;if(_!=="All"){if(De){if(String(re.marketplace)!==String(_))return!1}else if(_!=="-")return!1}return!(y&&!`${re.id} ${re.tx} ${re.module} ${re.marketplace} ${re.group} ${re.requester} ${re.vendor} ${re.status} ${re.risk}`.toLowerCase().includes(y))}).sort((re,ve)=>{const P=Ge==="asc"?1:-1;return G==="sla"?P*(re.slaDueAt-ve.slaDueAt):G==="amount"?P*(re.amountUGX-ve.amountUGX):G==="group"?P*re.group.localeCompare(ve.group):G==="module"?P*re.module.localeCompare(ve.module):G==="marketplace"?P*String(re.marketplace).localeCompare(String(ve.marketplace)):0})},[o,N,T,q,R,ae,_,G,Ge,De]),ge=d.useMemo(()=>{if(J==="None")return null;const re=O4($e,P=>J==="Vendor"?P.vendor:J==="Requester"?P.requester:P.patternKey),ve=Object.keys(re);return ve.sort((P,X)=>re[X].length-re[P].length),ve.map(P=>({key:P,items:re[P]}))},[$e,J]),ue=d.useMemo(()=>$e.filter(y=>["Pending","Escalated","Breached","Needs info"].includes(y.status)).length,[$e]),Ke=d.useMemo(()=>$e.filter(y=>y.status==="Escalated").length,[$e]),b=d.useMemo(()=>$e.filter(y=>y.status==="Breached"||hx(y.slaDueAt)).length,[$e]),v=d.useMemo(()=>$e.filter(y=>VE(y.slaDueAt)&&!hx(y.slaDueAt)).length,[$e]),u=d.useMemo(()=>o.filter(y=>je.has(y.id)),[o,je]),C=d.useMemo(()=>zV(u),[u]),Q=()=>Ue(new Set),O=y=>{Ue(re=>{const ve=new Set(re);return ve.has(y)?ve.delete(y):ve.add(y),ve})},ee=()=>{Ue(y=>{const re=new Set(y);return $e.forEach(ve=>re.add(ve.id)),re})},F=()=>{Ue(y=>{const re=new Set(y);return $e.forEach(ve=>re.delete(ve.id)),re})},D=(y,re)=>{Qe(y),ke(re),Ve(""),de(!0)},m=()=>{const y=fe.trim();if(y.length<8){r({title:"Reason required",message:"Add a clear comment or reason (min 8 chars).",kind:"warn"});return}const re=Fe,ve=Date.now();c(X=>X.map(S=>{if(!re.includes(S.id)||ye==="Approve"&&S.requiresAttachment&&!S.hasAttachment)return S;const w=ye==="Approve"?"Approved":ye==="Reject"?"Rejected":"Changes requested";return{...S,status:w,hasComment:S.hasComment||!!y,history:[...S.history,{at:ve,by:"You",action:w,why:y}]}})),j(X=>[...re.map(S=>({id:gh("AUD"),at:ve,by:"You",action:ye,itemId:S,why:y})),...X]);const P=o.filter(X=>re.includes(X.id)&&ye==="Approve"&&X.requiresAttachment&&!X.hasAttachment);P.length?r({title:"Some items blocked",message:`Attachment required for ${P.length} item(s). Add attachment and try again.`,kind:"warn"}):r({title:"Done",message:`${ye} completed for ${re.length} item(s).`,kind:ye==="Approve"?"success":"info"}),de(!1),ke([]),Ve(""),Q()},A=()=>{if(!Ee)return;const y=Date.now();c(re=>re.map(ve=>ve.id===Ee?{...ve,hasAttachment:!0,history:[...ve.history,{at:y,by:"You",action:"Attachment added",why:ze}]}:ve)),j(re=>[{id:gh("AUD"),at:y,by:"You",action:"Attachment added",itemId:Ee,why:ze},...re]),r({title:"Attachment added",message:`${Ee} updated.",`,kind:"success"}),Te(!1),Re(null)},f=y=>{var re;z(y),Be(((re=g[0])==null?void 0:re.name)||"Approver Desk"),Ne("Reassign to avoid SLA breach"),_e(!0)},B=()=>{if(!le)return;const y=xe.trim();if(y.length<8){r({title:"Reason required",message:"Add a clear reason (min 8 chars).",kind:"warn"});return}const re=Date.now();c(ve=>ve.map(P=>P.id===le?{...P,assignedTo:Pe,status:P.status==="Breached"?"Escalated":P.status,history:[...P.history,{at:re,by:"You",action:`Delegated to ${Pe}`,why:y}]}:P)),j(ve=>[{id:gh("AUD"),at:re,by:"You",action:"Delegate",itemId:le,why:y},...ve]),r({title:"Delegated",message:`${le} delegated to ${Pe}.`,kind:"success"}),_e(!1),z(null)},p=d.useMemo(()=>{const y=o.filter(P=>["Pending","Needs info"].includes(P.status)),re=O4(y,P=>`${P.vendor}||${P.risk}`);return Object.keys(re).map(P=>{const X=re[P],[S,w]=P.split("||"),h=X.reduce((K,V)=>K+V.amountUGX,0);return{vendor:S,risk:w,count:X.length,total:h,ids:X.map(K=>K.id)}}).filter(P=>P.count>=2).sort((P,X)=>X.count-P.count).slice(0,3)},[o]),E=d.useMemo(()=>o.filter(re=>re.status==="Escalated"||re.status==="Breached"||hx(re.slaDueAt)).sort((re,ve)=>re.slaDueAt-ve.slaDueAt).slice(0,6),[o]);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(qV,{toasts:l,onDismiss:y=>n(re=>re.filter(ve=>ve.id!==y))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:oy.green},children:e.jsx(ig,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Approvals Inbox"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Unified approvals for rides, services, purchases, RFQs, quotes and exceptions."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx($s,{label:`Open: ${ue}`,tone:ue?"warn":"good"}),v?e.jsx($s,{label:`Due soon: ${v}`,tone:"warn"}):e.jsx($s,{label:"No due soon",tone:"good"}),Ke?e.jsx($s,{label:`Escalated: ${Ke}`,tone:"bad"}):e.jsx($s,{label:"No escalations",tone:"good"}),b?e.jsx($s,{label:`Breached: ${b}`,tone:"bad"}):e.jsx($s,{label:"No breaches",tone:"good"}),je.size?e.jsx($s,{label:`Selected: ${je.size}`,tone:"info"}):null]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ia,{variant:"outline",onClick:()=>{r({title:"Audit",message:"Open an item audit from the table.",kind:"info"})},children:[e.jsx(wt,{className:"h-4 w-4"})," Audit"]}),e.jsxs(ia,{variant:"outline",onClick:()=>{r({title:"Refresh",message:"Inbox refreshed (demo).",kind:"success"})},children:[e.jsx(sl,{className:"h-4 w-4"})," Refresh"]}),e.jsxs(ia,{variant:"primary",disabled:!je.size,onClick:()=>{Ie(""),me(!1),he(!0)},children:[e.jsx(ht,{className:"h-4 w-4"})," Bulk actions"]})]})]}),e.jsxs("div",{className:"mt-4 flex flex-col gap-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-4 lg:grid-cols-6",children:[e.jsxs("div",{className:"md:col-span-2 rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsxs("div",{className:"mt-1 flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-2 py-2",children:[e.jsx(ka,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:N,onChange:y=>$(y.target.value),placeholder:"ID, requester, vendor...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"})]})]}),e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2",children:e.jsx(ad,{label:"Status",value:T,onChange:y=>k(y),options:["All","Pending","Needs info","Escalated","Breached","Approved","Rejected","Changes requested"]})}),e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2",children:e.jsx(ad,{label:"Risk",value:q,onChange:y=>L(y),options:["All","Low","Medium","High"]})}),e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2",children:e.jsx(ad,{label:"Group",value:R,onChange:y=>U(y),options:["All",...a]})}),e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2",children:e.jsx(ad,{label:"Module",value:ae,onChange:y=>{ie(y),y!=="All"&&y!=="E-Commerce"&&W("All")},options:["All",...t]})})]}),e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:ri("min-w-[140px] rounded-2xl border px-3 py-2",De?"border-slate-200 bg-white":"border-slate-200 bg-slate-50 opacity-70"),children:e.jsx(ad,{label:"Marketplace",value:String(_),onChange:y=>W(y),options:["All","-",...s],disabled:!De})}),e.jsx("div",{className:"min-w-[180px] rounded-2xl border border-slate-200 bg-white px-3 py-2",children:e.jsx(ad,{label:"Sort by",value:`${G}:${Ge}`,onChange:y=>{const[re,ve]=y.split(":");be(re),Me(ve)},options:["sla:asc","sla:desc","amount:asc","amount:desc","group:asc","group:desc","module:asc","module:desc","marketplace:asc","marketplace:desc"]})}),e.jsx("div",{className:"hidden h-8 w-px bg-slate-200 md:block"}),e.jsxs(ia,{variant:"outline",onClick:()=>{$(""),k("All"),L("All"),U("All"),ie("All"),W("All"),we("None"),be("sla"),Me("asc"),r({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(fn,{className:"h-4 w-4"})," Reset"]}),e.jsxs(ia,{variant:"outline",onClick:je.size?F:ee,children:[e.jsx(Us,{className:"h-4 w-4"})," ",je.size?"Deselect visible":"Select visible"]}),je.size?e.jsxs(ia,{variant:"outline",onClick:Q,children:[e.jsx(Ye,{className:"h-4 w-4"})," Clear selection"]}):null]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-2 rounded-2xl border border-slate-200 bg-white p-1",children:[e.jsx("button",{onClick:()=>we("None"),className:ri("rounded-xl px-3 py-1.5 text-xs font-semibold transition-colors",J==="None"?"bg-slate-100 text-slate-900":"text-slate-500 hover:bg-slate-50"),children:"List"}),e.jsx("button",{onClick:()=>we("Vendor"),className:ri("rounded-xl px-3 py-1.5 text-xs font-semibold transition-colors",J!=="None"?"bg-emerald-50 text-emerald-700 ring-1 ring-emerald-200":"text-slate-500 hover:bg-slate-50"),children:"Smart Grouping"})]})})]}),e.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[e.jsxs("div",{className:"rounded-3xl border border-rose-100 bg-white p-5 shadow-sm ring-4 ring-rose-50/50",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Escalation Panel"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Items requiring immediate attention."})]}),e.jsx("div",{className:"grid h-8 w-8 place-items-center rounded-full bg-rose-50 text-rose-600",children:e.jsx(Mt,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{className:"rounded-2xl border border-rose-100 bg-rose-50/50 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-semibold text-rose-700",children:"Breached SLA"}),e.jsx("span",{className:"text-xs font-bold text-rose-800",children:"3"})]}),e.jsx("div",{className:"mt-2 h-1.5 w-full rounded-full bg-rose-100",children:e.jsx("div",{className:"h-full w-3/4 rounded-full bg-rose-500"})})]}),e.jsxs("div",{className:"rounded-2xl border border-amber-100 bg-amber-50/50 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-semibold text-amber-700",children:"High Risk"}),e.jsx("span",{className:"text-xs font-bold text-amber-800",children:"5"})]}),e.jsx("div",{className:"mt-2 h-1.5 w-full rounded-full bg-amber-100",children:e.jsx("div",{className:"h-full w-1/2 rounded-full bg-amber-500"})})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(ia,{variant:"outline",className:"w-full text-xs",onClick:()=>{L("High"),k("Breached"),r({title:"Filtered",message:"Showing high priority items.",kind:"warn"})},children:"View critical items"})})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"My Performance"}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-emerald-600",children:"12m"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Avg. response"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-slate-900",children:"85%"}),e.jsx("div",{className:"text-xs text-slate-500",children:"SLA adherence"})]})]})]})]})]})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[e.jsxs("div",{className:"flex flex-col-reverse gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[p.length?e.jsxs("div",{className:"rounded-3xl border border-indigo-100 bg-white p-5 shadow-sm ring-4 ring-indigo-50/50",children:[e.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-indigo-50 text-indigo-600",children:e.jsx(ht,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Smart grouping suggestions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"We found repeated patterns for bulk approval."})]})]}),e.jsx($s,{label:`${p.length} suggestion(s)`,tone:"info"})]}),e.jsx("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-3",children:p.map(y=>e.jsxs("div",{className:"group relative rounded-2xl border border-slate-200 bg-slate-50/50 p-4 transition-all hover:bg-white hover:shadow-md hover:ring-1 hover:ring-indigo-200",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:y.vendor}),e.jsxs("div",{className:"mt-0.5 text-xs text-slate-500",children:[y.count," items  ",px(y.total)]})]}),e.jsx($s,{label:y.risk,tone:lu(y.risk)})]}),e.jsx("div",{className:"mt-4 flex gap-2 opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx(ia,{variant:"primary",className:"h-8 w-full text-xs",disabled:y.risk!=="Low",onClick:()=>{Ue(new Set(y.ids)),Ie(""),me(!1),he(!0)},children:"Bulk Approve"})}),e.jsxs("div",{className:"absolute bottom-4 right-4 text-xs font-semibold text-slate-400 group-hover:opacity-0",children:["Review ",y.count]})]},`${y.vendor}-${y.risk}`))})]}):null,J==="None"?e.jsx(_E,{items:$e,selected:je,onToggle:O,onOpenAudit:y=>{oe(y),H(!0)},onAddAttachment:y=>{Re(y),qe("Supporting document added"),Te(!0)},onDelegate:f,onAction:(y,re)=>D(y,[re])}):e.jsx(KV,{groups:ge||[],selected:je,onToggle:O,onOpenAudit:y=>{oe(y),H(!0)},onAddAttachment:y=>{Re(y),qe("Supporting document added"),Te(!0)},onDelegate:f,onAction:(y,re)=>D(y,[re])})]}),e.jsx("div",{className:"",children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Escalation panel"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Breached or escalated items. Delegate now to avoid further breaches."})]}),e.jsx($s,{label:"Premium",tone:"info"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:E.length?E.map(y=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:y.id}),e.jsx($s,{label:y.status,tone:cy(y.status)}),e.jsx($s,{label:y.risk,tone:lu(y.risk)})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[y.module,y.module==="E-Commerce"?`  ${y.marketplace}`:""]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[y.requester,"  ",y.vendor]}),e.jsx("div",{className:"mt-2 text-xs font-semibold text-slate-700",children:dy(y.slaDueAt)})]}),e.jsx(Mt,{className:"h-5 w-5 text-rose-700"})]}),e.jsxs("div",{className:"mt-3 flex flex-col gap-2",children:[e.jsxs(ia,{variant:"outline",onClick:()=>{oe(y.id),H(!0)},children:[e.jsx(wt,{className:"h-4 w-4"})," View audit"]}),e.jsxs(ia,{variant:"primary",onClick:()=>f(y.id),children:[e.jsx(Us,{className:"h-4 w-4"})," Delegate now"]})]})]},y.id)):e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(yt,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No escalations"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"You are on track."})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Tip: tighten SLAs and enable load balancing in Approval Workflow Builder (J)."})]})})]}),je.size?e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Selection actions"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["You selected ",je.size," item(s). Bulk approve is restricted by safeguards."]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ia,{variant:"outline",onClick:()=>D("Request changes",u.map(y=>y.id)),children:[e.jsx(vn,{className:"h-4 w-4"})," Request changes"]}),e.jsxs(ia,{variant:"outline",onClick:()=>D("Reject",u.map(y=>y.id)),children:[e.jsx(Ye,{className:"h-4 w-4"})," Reject"]}),e.jsxs(ia,{variant:"primary",disabled:!C.ok,onClick:()=>{Ie(""),me(!1),he(!0)},children:[e.jsx(ht,{className:"h-4 w-4"})," Bulk approve"]})]})]}),C.ok?e.jsx("div",{className:"mt-3 rounded-2xl border border-emerald-200 bg-emerald-50 p-3 text-xs text-emerald-900",children:"Eligible for bulk approve: same vendor, low risk, required attachments present, and total under cap."}):e.jsxs("div",{className:"mt-3 rounded-2xl border border-amber-200 bg-amber-50 p-3 text-xs text-amber-900",children:[e.jsx("div",{className:"font-semibold",children:"Bulk approve safeguards"}),e.jsx("ul",{className:"mt-2 space-y-1",children:C.reasons.map(y=>e.jsxs("li",{children:[" ",y]},y))})]})]}):null,e.jsx("div",{className:"mt-4 text-xs text-slate-500",children:"K Approvals Inbox v2: unified queue, sorting, actions with comments, attachment enforcement, audit trail, premium bulk approve safeguards, smart grouping, and escalation delegation."})]})]})}),e.jsxs(xm,{open:pe,title:`${ye}`,subtitle:`Applies to ${Fe.length} item(s). Comment is required.`,onClose:()=>de(!1),actions:[{label:"Confirm",onClick:m,variant:ye==="Reject"?"danger":"default"},{label:"Cancel",onClick:()=>de(!1)}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(ia,{variant:"outline",onClick:()=>de(!1),children:"Cancel"}),e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:e.jsxs(ia,{variant:ye==="Approve"?"primary":ye==="Reject"?"danger":"outline",onClick:m,children:[e.jsx(tt,{className:"h-4 w-4"})," Confirm"]})})]}),children:[e.jsx(fh,{label:"Comment and reason",value:fe,onChange:Ve,placeholder:"Example: approvals aligned with policy and budget. Proceed.",hint:"Minimum 8 characters",rows:4}),e.jsx("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Attachment enforcement: Approve is blocked if required attachment is missing."}),e.jsx("div",{className:"mt-3 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"ID"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Risk"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Attachment"})]})}),e.jsx("tbody",{children:o.filter(y=>Fe.includes(y.id)).map(y=>e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:y.id}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:px(y.amountUGX)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:y.vendor}),e.jsx("td",{className:"px-4 py-3",children:e.jsx($s,{label:y.risk,tone:lu(y.risk)})}),e.jsx("td",{className:"px-4 py-3",children:y.requiresAttachment?e.jsx($s,{label:y.hasAttachment?"Present":"Missing",tone:y.hasAttachment?"good":"bad"}):e.jsx($s,{label:"Not required",tone:"neutral"})})]},y.id))})]})})]}),e.jsxs(xm,{open:Oe,title:"Bulk approve",subtitle:"Premium safeguards apply. Same vendor and low risk only.",onClose:()=>he(!1),actions:[{label:"Confirm bulk approve",onClick:()=>{D("Approve",u.map(y=>y.id)),he(!1),Ve(Y)},variant:"default"},{label:"Cancel",onClick:()=>he(!1)}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(ia,{variant:"outline",onClick:()=>he(!1),children:"Cancel"}),e.jsxs(ia,{variant:"primary",disabled:!C.ok||!ce||Y.trim().length<8,onClick:()=>{D("Approve",u.map(y=>y.id)),he(!1),Ve(Y)},children:[e.jsx(ht,{className:"h-4 w-4"})," Confirm bulk approve"]})]}),children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-700",children:["Selected: ",u.length," item(s)  Total: ",px(u.reduce((y,re)=>y+re.amountUGX,0))]}),C.ok?e.jsx("div",{className:"mt-3 rounded-2xl border border-emerald-200 bg-emerald-50 p-3 text-xs text-emerald-900",children:"Safeguards satisfied. Bulk approve is allowed."}):e.jsxs("div",{className:"mt-3 rounded-2xl border border-amber-200 bg-amber-50 p-3 text-xs text-amber-900",children:[e.jsx("div",{className:"font-semibold",children:"Safeguards not satisfied"}),e.jsx("ul",{className:"mt-2 space-y-1",children:C.reasons.map(y=>e.jsxs("li",{children:[" ",y]},y))})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(fh,{label:"Reason",value:Y,onChange:Ie,placeholder:"Example: low-risk recurring purchases from same vendor.",hint:"Minimum 8 characters",rows:3}),e.jsxs("label",{className:"mt-3 flex items-start gap-3 rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("input",{type:"checkbox",checked:ce,onChange:y=>me(y.target.checked),className:"mt-1 h-4 w-4 rounded border-slate-300"}),e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"I confirm these approvals are authorized and will be audit logged."})]})]})]}),e.jsxs(xm,{open:ne,title:"Add attachment",subtitle:"Required attachment enforcement blocks approval without this.",onClose:()=>Te(!1),actions:[{label:"Mark attached",onClick:A,variant:"default"},{label:"Cancel",onClick:()=>Te(!1)}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(ia,{variant:"outline",onClick:()=>Te(!1),children:"Cancel"}),e.jsxs(ia,{variant:"primary",onClick:A,children:[e.jsx(vw,{className:"h-4 w-4"})," Mark attached"]})]}),children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Item: ",e.jsx("span",{className:"font-semibold text-slate-900",children:Ee})]}),e.jsx(fh,{label:"Attachment note",value:ze,onChange:qe,placeholder:"Example: invoice PDF uploaded",rows:3}),e.jsx("div",{className:"mt-3 rounded-2xl border border-slate-200 bg-white p-3 text-xs text-slate-600",children:"Demo: this marks the item as having required attachment. In production, files are uploaded and scanned."})]}),e.jsxs(xm,{open:He,title:"Delegate now",subtitle:"Premium: reassign escalated items to prevent SLA breaches.",onClose:()=>_e(!1),actions:[{label:"Delegate",onClick:B,variant:"default"},{label:"Cancel",onClick:()=>_e(!1)}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(ia,{variant:"outline",onClick:()=>_e(!1),children:"Cancel"}),e.jsxs(ia,{variant:"primary",onClick:B,children:[e.jsx(Us,{className:"h-4 w-4"})," Delegate"]})]}),children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Item: ",e.jsx("span",{className:"font-semibold text-slate-900",children:le})]}),e.jsx(ad,{label:"Delegate to",value:Pe,onChange:Be,options:g.map(y=>`${y.name}`),hint:"Pick an approver desk"}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2",children:g.map(y=>e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:y.name}),e.jsxs("div",{className:"mt-0.5 text-xs text-slate-500",children:["Role: ",y.role,"  Load: ",y.load,y.ooo?"  OOO":""]})]}),e.jsx($s,{label:y.load>=6?"Busy":"OK",tone:y.load>=6?"warn":"good"})]},y.id))}),e.jsx("div",{className:"mt-3",children:e.jsx(fh,{label:"Reason",value:xe,onChange:Ne,placeholder:"Example: CFO out of office, delegate to Org Admin",hint:"Minimum 8 characters",rows:3})})]}),e.jsx(xm,{open:M,title:"Audit trail",subtitle:"Who, when, and why.",onClose:()=>H(!1),actions:[{label:"Close",onClick:()=>H(!1)}],footer:e.jsx("div",{className:"flex justify-end",children:e.jsx(ia,{variant:"outline",onClick:()=>H(!1),children:"Close"})}),children:(()=>{const y=Ae,re=o.find(P=>P.id===y);if(!y||!re)return e.jsx("div",{className:"text-sm text-slate-600",children:"Select an item to view audit."});const ve=x.filter(P=>P.itemId===y);return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:re.id}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[re.tx,"  ",re.module,re.module==="E-Commerce"?`  ${re.marketplace}`:""]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx($s,{label:re.status,tone:cy(re.status)}),e.jsx($s,{label:`Risk: ${re.risk}`,tone:lu(re.risk)}),e.jsx($s,{label:`Assigned: ${re.assignedTo}`,tone:"info"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Created"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:b0(re.createdAt)}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:dy(re.slaDueAt)})]})]})}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Item history"}),e.jsx("div",{className:"mt-3 space-y-2",children:re.history.slice().sort((P,X)=>X.at-P.at).map((P,X)=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:P.action}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["By ",P.by,"  ",b0(P.at)," (",GV(P.at),")"]}),P.why?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Why: ",P.why]}):null]}),e.jsx($s,{label:"History",tone:"neutral"})]})},X))})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Audit entries"}),e.jsx("div",{className:"mt-3 space-y-2",children:ve.length?ve.slice().sort((P,X)=>X.at-P.at).map(P=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:P.action}),e.jsx($s,{label:P.by,tone:"info"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[b0(P.at),"  ",P.id]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Why: ",P.why]})]}),e.jsxs(ia,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>navigator.clipboard.writeText(P.id),children:[e.jsx(ls,{className:"h-4 w-4"})," Copy ID"]})]})},P.id)):e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(wt,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No audit entries"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Actions create audit entries."})]})})]})]})})()}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"K Approvals Inbox v2. Core: unified queue, sorting, actions with comments, attachment enforcement, and audit trail. Premium: bulk approve safeguards, smart grouping, and escalation delegation."})})]})}function _E({items:t,selected:s,onToggle:a,onOpenAudit:l,onAddAttachment:n,onDelegate:r,onAction:i}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white shadow-sm overflow-visible",children:[e.jsxs("div",{className:"border-b border-slate-200 px-4 py-3",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Queue"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Approve, reject, request changes, attach docs, and view audit."})]}),e.jsx("div",{className:"hidden overflow-visible md:block",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold w-10",children:e.jsx("span",{className:"sr-only",children:"Select"})}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Details"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Requester/Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"SLA"}),e.jsx("th",{className:"px-4 py-3 font-semibold text-right",children:"Actions"})]})}),e.jsx("tbody",{children:t.map(o=>{const c=hx(o.slaDueAt),x=VE(o.slaDueAt),j=o.requiresAttachment&&!o.hasAttachment;return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60 group",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"checkbox",checked:s.has(o.id),onChange:()=>a(o.id),className:"h-4 w-4 rounded border-slate-300 accent-emerald-500"})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:o.tx}),e.jsxs("div",{className:"text-xs text-slate-500",children:[o.module,"  ",o.marketplace]}),e.jsx("div",{className:"text-xs text-slate-400",children:o.group})]}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"text-slate-900",children:o.requester}),e.jsx("div",{className:"text-xs text-slate-500",children:o.vendor})]}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:px(o.amountUGX)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-col gap-1 items-start",children:[e.jsx($s,{label:o.status,tone:cy(o.status)}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:ri("h-1.5 w-1.5 rounded-full",lu(o.risk)==="bad"?"bg-rose-500":lu(o.risk)==="warn"?"bg-amber-500":"bg-emerald-500")}),e.jsxs("span",{className:"text-xs text-slate-500",children:[o.risk," Risk"]})]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-col gap-1 items-start",children:[e.jsx($s,{label:dy(o.slaDueAt),tone:c?"bad":x?"warn":"info"}),e.jsx("div",{className:"text-xs text-slate-500",children:b0(o.slaDueAt)})]})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx(HV,{item:o,onOpenAudit:l,onAddAttachment:n,onDelegate:r,onAction:i,approveBlocked:j})})]},o.id)})})]})})]})}function HV({item:t,onOpenAudit:s,onAddAttachment:a,onDelegate:l,onAction:n,approveBlocked:r}){const[i,o]=Xt.useState(!1),c=Xt.useRef(null);return Xt.useEffect(()=>{function x(j){c.current&&!c.current.contains(j.target)&&o(!1)}return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]),e.jsxs("div",{className:"relative inline-block text-left",ref:c,children:[e.jsx("button",{onClick:()=>o(!i),className:"flex h-8 w-8 items-center justify-center rounded-full text-slate-400 hover:bg-slate-100 hover:text-slate-600",children:e.jsx(xs,{className:"h-4 w-4"})}),i&&e.jsxs("div",{className:"absolute right-0 top-9 z-10 mt-1 w-48 origin-top-right rounded-xl border border-slate-100 bg-white p-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",children:[e.jsx("div",{className:"px-3 py-2 text-xs font-semibold text-slate-400 uppercase tracking-wider border-b border-slate-50 mb-1",children:"Actions"}),e.jsxs("button",{onClick:()=>{n("Approve",t.id),o(!1)},disabled:r,className:ri("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-xs font-medium transition-colors mb-1",r?"cursor-not-allowed opacity-50 text-slate-400":"text-emerald-700 hover:bg-emerald-50"),children:[e.jsx(qF,{className:"h-4 w-4"})," Approve"]}),e.jsxs("button",{onClick:()=>{n("Reject",t.id),o(!1)},className:"flex w-full items-center gap-2 rounded-lg px-3 py-2 text-xs font-medium text-rose-700 hover:bg-rose-50 transition-colors mb-1",children:[e.jsx(XV,{className:"h-4 w-4"})," Reject"]}),e.jsxs("button",{onClick:()=>{n("Request changes",t.id),o(!1)},className:"flex w-full items-center gap-2 rounded-lg px-3 py-2 text-xs font-medium text-amber-700 hover:bg-amber-50 transition-colors",children:[e.jsx(JF,{className:"h-4 w-4"})," Request Changes"]}),e.jsx("div",{className:"my-1 border-t border-slate-100"}),e.jsxs("button",{onClick:()=>{s(t.id),o(!1)},className:"flex w-full items-center gap-2 rounded-lg px-3 py-2 text-xs font-medium text-slate-600 hover:bg-slate-50 transition-colors",children:[e.jsx(wt,{className:"h-4 w-4"})," View Audit"]}),t.requiresAttachment&&e.jsxs("button",{onClick:()=>{a(t.id),o(!1)},className:"flex w-full items-center gap-2 rounded-lg px-3 py-2 text-xs font-medium text-slate-600 hover:bg-slate-50 transition-colors",children:[e.jsx(vw,{className:"h-4 w-4"})," ",t.hasAttachment?"View Attachment":"Add Attachment"]}),(t.status==="Escalated"||t.status==="Breached"||hx(t.slaDueAt))&&e.jsxs("button",{onClick:()=>{l(t.id),o(!1)},className:"flex w-full items-center gap-2 rounded-lg px-3 py-2 text-xs font-medium text-slate-600 hover:bg-slate-50 transition-colors",children:[e.jsx(Us,{className:"h-4 w-4"})," Delegate"]})]})]})}function XV(t){return e.jsx(Ye,{...t})}function KV({groups:t,selected:s,onToggle:a,onOpenAudit:l,onAddAttachment:n,onDelegate:r,onAction:i}){return e.jsxs("div",{className:"space-y-3",children:[t.map(o=>e.jsx(QV,{title:o.key,count:o.items.length,total:o.items.reduce((c,x)=>c+x.amountUGX,0),children:e.jsx(_E,{items:o.items,selected:s,onToggle:a,onOpenAudit:l,onAddAttachment:n,onDelegate:r,onAction:i})},o.key)),t.length?null:e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(KF,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No groups"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Nothing matches your filters."})]})]})}function QV({title:t,count:s,total:a,children:l}){const[n,r]=d.useState(!0);return e.jsxs("div",{className:"overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-sm",children:[e.jsxs("button",{type:"button",className:"flex w-full items-start justify-between gap-3 px-4 py-4 text-left",onClick:()=>r(i=>!i),children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),e.jsx($s,{label:`${s} item(s)`,tone:"neutral"}),e.jsx($s,{label:`Total ${px(a)}`,tone:"info"})]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Smart grouping stack"})]}),e.jsx(li,{className:ri("h-5 w-5 text-slate-500 transition",n?"rotate-180":"rotate-0")})]}),e.jsx(lt,{initial:!1,children:n?e.jsx(We.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.18},className:"border-t border-slate-200",children:e.jsx("div",{className:"p-4",children:l})}):null})]})}const Qx={green:"#03CD8C",orange:"#F77F00"};function al(...t){return t.filter(Boolean).join(" ")}function xc(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function YV(t,s,a){return Math.max(s,Math.min(a,t))}function hs(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function Xv(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function vh(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function dr(t,s){return s<=0?0:Math.round(t/s*100)}function T4(t){return t==="Critical"?"bad":t==="Warning"?"warn":"info"}function R4(t){return t==="Hard"?"warn":"neutral"}function Ds({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:al("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function us({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:Qx.green}:t==="accent"?{background:Qx.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:al(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function JV({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:al("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:al("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function D4({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:al(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:al("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function bh({label:t,value:s,onChange:a,hint:l,disabled:n}){return e.jsxs("div",{className:al(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",value:s,onChange:r=>a(Number(r.target.value||0)),disabled:n,className:al("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function Gl({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:al(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:al("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i,children:i},i))})]})}function Kv({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:i=>a(i.target.value),placeholder:l,rows:r,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"})]})}function ZV({actions:t}){const[s,a]=d.useState(!1);return e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 focus:bg-slate-100 focus:outline-none",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>a(!1)}),e.jsx("div",{className:"absolute right-0 top-full z-40 mt-1 w-48 overflow-hidden rounded-xl border border-slate-200 bg-white shadow-xl ring-1 ring-slate-200",children:t.map((l,n)=>e.jsx("button",{onClick:()=>{l.onClick(),a(!1)},className:al("block w-full px-4 py-2.5 text-left text-sm font-medium transition hover:bg-slate-50",l.variant==="danger"?"text-rose-700 hover:bg-rose-50":"text-slate-700"),children:l.label},n))})]})]})}function jh({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="920px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[8vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-1",children:[o?e.jsx(ZV,{actions:o}):null,e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function e_({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:al("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function pc({title:t,value:s,sub:a,icon:l,tone:n="neutral"}){const r=n==="good"?"bg-emerald-50 text-emerald-700":n==="warn"?"bg-amber-50 text-amber-800":n==="bad"?"bg-rose-50 text-rose-700":n==="info"?"bg-blue-50 text-blue-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:t}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:s}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a})]}),e.jsx("div",{className:al("grid h-10 w-10 place-items-center rounded-2xl",r),children:l})]})})}function pm({valuePct:t,labelLeft:s,labelRight:a}){const l=YV(t,0,140);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-600",children:[e.jsx("span",{className:"font-semibold",children:s}),e.jsx("span",{className:"font-semibold",children:a})]}),e.jsx("div",{className:"mt-2 h-2 w-full overflow-hidden rounded-full bg-slate-100",children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${Math.min(100,l)}%`,background:Qx.green}})}),l>100?e.jsxs("div",{className:"mt-2 text-xs font-semibold text-rose-700",children:["Over by ",Math.round((l-100)*10)/10,"%"]}):null]})}function I4(t,s){return s<=0?1/0:t/s}function t_(){const t=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],s=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],a=["Operations","Sales","Finance","Admin","Procurement"],l=[{id:"U-1001",name:"Mary N.",group:"Operations",role:"Manager",autoApprovalEligible:!0},{id:"U-1002",name:"John S.",group:"Sales",role:"Employee",autoApprovalEligible:!1},{id:"U-1003",name:"Irene K.",group:"Operations",role:"Travel Coordinator",autoApprovalEligible:!0},{id:"U-1004",name:"Daisy O.",group:"Finance",role:"Accountant",autoApprovalEligible:!0},{id:"U-1005",name:"Procurement Desk",group:"Procurement",role:"Approver",autoApprovalEligible:!0}],[n,r]=d.useState([]),i=b=>{const v=xc("toast");r(u=>[{id:v,...b},...u].slice(0,4)),window.setTimeout(()=>r(u=>u.filter(C=>C.id!==v)),3200)},o=8,c=30,[x,j]=d.useState(()=>{const b=Date.now();return[{id:"B-ORG",scope:"Org",period:"Monthly",capType:"Hard",amountUGX:4e7,usedUGX:325e5,updatedAt:b-2*24*60*60*1e3,updatedBy:"Org Admin",notes:"Primary monthly budget"},{id:"B-G-OPS",scope:"Group",period:"Monthly",capType:"Soft",amountUGX:15e6,usedUGX:12e6,group:"Operations",updatedAt:b-24*60*60*1e3,updatedBy:"Org Admin",notes:"Operations monthly allocation"},{id:"B-G-SALES",scope:"Group",period:"Monthly",capType:"Soft",amountUGX:12e6,usedUGX:98e5,group:"Sales",updatedAt:b-24*60*60*1e3,updatedBy:"Org Admin"},{id:"B-G-FIN",scope:"Group",period:"Monthly",capType:"Hard",amountUGX:6e6,usedUGX:52e5,group:"Finance",updatedAt:b-48*60*60*1e3,updatedBy:"Org Admin"},{id:"B-MOD-RIDES",scope:"Module",period:"Monthly",capType:"Soft",amountUGX:16e6,usedUGX:142e5,module:"Rides & Logistics",updatedAt:b-3*24*60*60*1e3,updatedBy:"Finance Desk",notes:"Soft cap, above routes to approvals"},{id:"B-MKT-MYLIVE",scope:"Marketplace",period:"Monthly",capType:"Hard",amountUGX:6e6,usedUGX:52e5,module:"E-Commerce",marketplace:"MyLiveDealz",updatedAt:b-3*24*60*60*1e3,updatedBy:"Procurement Desk",notes:"High risk marketplace hard cap"}]}),[g,N]=d.useState(()=>{const b=Date.now();return[{id:"UC-1001",userId:"U-1001",period:"Monthly",capType:"Soft",amountUGX:3e6,usedUGX:21e5,updatedAt:b-3*24*60*60*1e3,updatedBy:"Org Admin"},{id:"UC-1002",userId:"U-1002",period:"Monthly",capType:"Hard",amountUGX:12e5,usedUGX:9e5,updatedAt:b-3*24*60*60*1e3,updatedBy:"Org Admin"},{id:"UC-1003",userId:"U-1003",period:"Monthly",capType:"Soft",amountUGX:2e6,usedUGX:14e5,updatedAt:b-3*24*60*60*1e3,updatedBy:"Org Admin"}]}),[$,T]=d.useState(()=>{const b=Date.now();return[{id:"AL-01",ts:b-50*60*1e3,severity:"Warning",title:"Sales group at 82%",message:"Sales group is above 80% of monthly cap. Consider enforce or adjust.",relatedIds:["B-G-SALES"]},{id:"AL-02",ts:b-20*60*1e3,severity:"Critical",title:"Finance group nearing hard cap",message:"Finance group hard cap is close. Remaining is under UGX 1,000,000.",relatedIds:["B-G-FIN"]}]}),[k,q]=d.useState(()=>{const b=Date.now();return[{id:"H-01",ts:b-3*24*60*60*1e3,actor:"Org Admin",type:"Budget updated",details:"Updated org monthly budget to UGX 40,000,000"},{id:"H-02",ts:b-2*24*60*60*1e3,actor:"Org Admin",type:"Budget updated",details:"Updated Operations budget to UGX 15,000,000"},{id:"H-03",ts:b-9*60*60*1e3,actor:"System",type:"Spend applied",details:"Applied spend UGX 82,000 to Rides & Logistics for John S."}]}),[L,R]=d.useState(()=>[{id:"EXC-01",createdAt:Date.now()-18*60*60*1e3,createdBy:"Finance Desk",status:"Pending",targetType:"Group",targetId:"B-G-FIN",extraAmountUGX:15e5,reason:"Urgent month-end reconciliations and payouts",attachmentsProvided:!0,approver:"Org Admin"}]),[U,ae]=d.useState("budgets"),[ie,_]=d.useState(!1),[W,J]=d.useState(()=>({id:"",scope:"Group",period:"Monthly",capType:"Soft",amountUGX:1e6,usedUGX:0,group:"Operations",updatedAt:Date.now(),updatedBy:"You",notes:""})),[we,G]=d.useState(!1),[be,Ge]=d.useState(()=>{const b=Date.now();return{id:"",userId:l[0].id,period:"Monthly",capType:"Soft",amountUGX:5e5,usedUGX:0,updatedAt:b,updatedBy:"You"}}),[Me,je]=d.useState(!1),[Ue,Oe]=d.useState(()=>({userId:l[1].id,module:"Rides & Logistics",marketplace:"-",amountUGX:85e3,vendor:"EVzone Rides",risk:"Low",note:"Client meeting ride"})),[he,Y]=d.useState(!1),[Ie,ce]=d.useState(()=>({id:"",createdAt:Date.now(),createdBy:"You",status:"Pending",targetType:"Group",targetId:"B-G-FIN",extraAmountUGX:1e6,reason:"",attachmentsProvided:!0,approver:"Org Admin"})),me=d.useMemo(()=>x.find(b=>b.scope==="Org")||null,[x]),pe=(me==null?void 0:me.usedUGX)||x.filter(b=>b.scope==="Org").reduce((b,v)=>b+v.usedUGX,0),de=(me==null?void 0:me.amountUGX)||x.filter(b=>b.scope==="Org").reduce((b,v)=>b+v.amountUGX,0),ye=Math.max(0,de-pe),Qe=d.useMemo(()=>pe/o,[pe]),Fe=d.useMemo(()=>I4(ye,Qe),[ye,Qe]),ke=d.useMemo(()=>Math.round(pe/o*c),[pe]),fe=d.useMemo(()=>$.slice().sort((b,v)=>v.ts-b.ts),[$]),Ve=d.useMemo(()=>({Operations:[118e5,124e5,131e5],Sales:[82e5,91e5,99e5],Finance:[43e5,51e5,56e5],Admin:[31e5,37e5,39e5],Procurement:[24e5,29e5,32e5]}),[]),ne=d.useMemo(()=>a.map(v=>{const u=Ve[v],C=u.reduce((ee,F)=>ee+F,0)/u.length,Q=Math.max(...u),O=Math.round(Math.max(C,Q)*1.15);return{group:v,avg:Math.round(C),p90:Q,suggested:O}}),[a,Ve]),Te=d.useMemo(()=>x.filter(v=>v.scope==="Group"&&v.period==="Monthly").map(v=>{const u=v.usedUGX/o,C=Math.round(u*c),Q=Math.max(0,v.amountUGX-v.usedUGX),O=I4(Q,u);return{...v,forecast:C,burnPerDay:u,runway:O}}),[x]),Ee=d.useMemo(()=>x.filter(v=>v.scope==="Module"&&v.period==="Monthly").map(v=>{const u=v.usedUGX/o,C=Math.round(u*c);return{...v,forecast:C,burnPerDay:u}}),[x]),Re=d.useMemo(()=>x.filter(v=>v.scope==="Marketplace"&&v.period==="Monthly").map(v=>{const u=v.usedUGX/o,C=Math.round(u*c);return{...v,forecast:C,burnPerDay:u}}),[x]),ze=b=>{q(v=>[{id:xc("H"),...b},...v])},qe=b=>{T(v=>[{id:xc("AL"),...b},...v].slice(0,40))},He=()=>{const b={budgets:x,userCaps:g,alerts:$,history:k,exceptions:L,exportedAt:new Date().toISOString()},v=JSON.stringify(b,null,2),u=new Blob([v],{type:"application/json"}),C=URL.createObjectURL(u),Q=document.createElement("a");Q.href=C,Q.download="corporatepay-budgets-controls.json",Q.click(),URL.revokeObjectURL(C),i({title:"Exported",message:"Downloaded JSON config.",kind:"success"})},_e=async()=>{const b={budgets:x,userCaps:g,alerts:$,history:k,exceptions:L};try{await navigator.clipboard.writeText(JSON.stringify(b,null,2)),i({title:"Copied",message:"Copied JSON to clipboard.",kind:"success"})}catch{i({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},le=()=>{const b=Date.now();J({id:"",scope:"Group",period:"Monthly",capType:"Soft",amountUGX:1e6,usedUGX:0,group:"Operations",updatedAt:b,updatedBy:"You",notes:""}),_(!0)},z=b=>{J(JSON.parse(JSON.stringify(b))),_(!0)},Pe=()=>{if(W.amountUGX<=0){i({title:"Invalid amount",message:"Budget amount must be greater than zero.",kind:"warn"});return}if(W.scope==="Marketplace"&&W.module!=="E-Commerce"){i({title:"Invalid scope",message:"Marketplace budgets must be under E-Commerce.",kind:"warn"});return}const b=Date.now(),v=!W.id,u=v?xc("B"):W.id;j(C=>{const Q=C.slice(),O=Q.findIndex(F=>F.id===u),ee={...W,id:u,updatedAt:b,updatedBy:"You"};return O>=0?Q[O]=ee:Q.unshift(ee),Q}),ze({ts:b,actor:"You",type:v?"Budget created":"Budget updated",details:`${v?"Created":"Updated"} ${W.scope} budget (${u}) to ${hs(W.amountUGX)} (${W.capType})`}),i({title:"Saved",message:"Budget saved.",kind:"success"}),_(!1)},Be=b=>{j(v=>v.filter(u=>u.id!==b)),ze({ts:Date.now(),actor:"You",type:"Budget updated",details:`Deleted budget ${b}`}),i({title:"Deleted",message:`Budget ${b} removed.",`,kind:"info"})},xe=()=>{const b=Date.now();Ge({id:"",userId:l[0].id,period:"Monthly",capType:"Soft",amountUGX:5e5,usedUGX:0,updatedAt:b,updatedBy:"You"}),G(!0)},Ne=b=>{Ge(JSON.parse(JSON.stringify(b))),G(!0)},M=()=>{if(be.amountUGX<=0){i({title:"Invalid amount",message:"Cap amount must be greater than zero.",kind:"warn"});return}const b=Date.now(),v=!be.id,u=v?xc("UC"):be.id;N(C=>{const Q=C.slice(),O=Q.findIndex(F=>F.id===u),ee={...be,id:u,updatedAt:b,updatedBy:"You"};return O>=0?Q[O]=ee:Q.unshift(ee),Q}),ze({ts:b,actor:"You",type:"User cap updated",details:`${v?"Created":"Updated"} user cap (${u}) to ${hs(be.amountUGX)} (${be.capType})`}),i({title:"Saved",message:"User cap saved.",kind:"success"}),G(!1)},H=(b,v)=>{ce({id:"",createdAt:Date.now(),createdBy:"You",status:"Pending",targetType:b||"Group",targetId:v||"B-G-FIN",extraAmountUGX:1e6,reason:"",attachmentsProvided:!0,approver:"Org Admin"}),Y(!0)},Ae=()=>{if(Ie.reason.trim().length<10){i({title:"Reason required",message:"Provide a clear reason (min 10 chars).",kind:"warn"});return}const b=Date.now(),v={...Ie,id:xc("EXC"),createdAt:b,createdBy:"You",status:"Pending"};R(u=>[v,...u]),ze({ts:b,actor:"You",type:"Exception requested",details:`Requested emergency exception ${v.id} (+${hs(v.extraAmountUGX)}) for ${v.targetType} ${v.targetId}`}),qe({ts:b,severity:"Warning",title:"Emergency exception requested",message:`${v.id} pending approval.`,relatedIds:[v.targetId]}),i({title:"Requested",message:"Emergency exception submitted.",kind:"success"}),Y(!1)},oe=(b,v)=>{const u=Date.now();if(R(C=>C.map(Q=>Q.id===b?{...Q,status:v,decisionNote:v==="Approved"?"Approved":"Rejected",approver:"Org Admin"}:Q)),ze({ts:u,actor:"Org Admin",type:v==="Approved"?"Exception approved":"Exception rejected",details:`${v} emergency exception ${b}`}),v==="Approved"){const C=L.find(Q=>Q.id===b);C&&(C.targetType==="User"?N(Q=>Q.map(O=>O.userId===C.targetId?{...O,amountUGX:O.amountUGX+C.extraAmountUGX,updatedAt:u,updatedBy:"Org Admin"}:O)):j(Q=>Q.map(O=>O.id===C.targetId?{...O,amountUGX:O.amountUGX+C.extraAmountUGX,updatedAt:u,updatedBy:"Org Admin",notes:`${O.notes||""} (Exception ${b})`}:O))),qe({ts:u,severity:"Info",title:"Emergency exception approved",message:`${b} approved and applied to limits.",`,relatedIds:[b]}),i({title:"Approved",message:"Exception applied to limits.",kind:"success"})}else qe({ts:u,severity:"Info",title:"Emergency exception rejected",message:`${b} rejected.",`,relatedIds:[b]}),i({title:"Rejected",message:"Exception rejected.",kind:"info"})},De=()=>{Oe({userId:l[1].id,module:"Rides & Logistics",marketplace:"-",amountUGX:85e3,vendor:"EVzone Rides",risk:"Low",note:"Client meeting ride"}),je(!0)},$e=b=>l.find(v=>v.id===b)||l[0],ge=()=>{const b=Date.now(),v=$e(Ue.userId);ze({ts:b,actor:"System",type:"Spend attempted",details:`Spend attempt ${hs(Ue.amountUGX)} by ${v.name} in ${Ue.module}${Ue.module==="E-Commerce"?` (${Ue.marketplace})`:""}`});const u=[],C=x.find(m=>m.scope==="Org"&&m.period==="Monthly");C&&u.push(C);const Q=x.find(m=>m.scope==="Group"&&m.group===v.group&&m.period==="Monthly");Q&&u.push(Q);const O=x.find(m=>m.scope==="Module"&&m.module===Ue.module&&m.period==="Monthly");if(O&&u.push(O),Ue.module==="E-Commerce"&&Ue.marketplace!=="-"){const m=x.find(A=>A.scope==="Marketplace"&&A.marketplace===Ue.marketplace&&A.period==="Monthly");m&&u.push(m)}const ee=g.find(m=>m.userId===v.id&&m.period==="Monthly")||null,F=[];for(const m of u)m.capType==="Hard"&&m.usedUGX+Ue.amountUGX>m.amountUGX&&F.push({label:`${m.scope} budget ${m.id}`,id:m.id});if(ee&&ee.capType==="Hard"&&ee.usedUGX+Ue.amountUGX>ee.amountUGX&&F.push({label:`User cap ${ee.id}`,id:ee.id}),F.length){ze({ts:b,actor:"System",type:"Hard cap blocked",details:`Blocked by: ${F.map(m=>m.label).join(", ")}`}),qe({ts:b,severity:"Critical",title:"Hard cap blocked",message:'Spend blocked by hard cap. Consider emergency exception if urgent.",',relatedIds:F.map(m=>m.id)}),i({title:"Blocked",message:"Hard cap blocked this spend.",kind:"warn"}),je(!1);return}j(m=>m.map(A=>{if(!u.find(p=>p.id===A.id))return A;const B=A.usedUGX+Ue.amountUGX;return{...A,usedUGX:B}})),ee&&N(m=>m.map(A=>A.id===ee.id?{...A,usedUGX:A.usedUGX+Ue.amountUGX}:A));const D=(m,A,f,B,p)=>{const E=dr(f-Ue.amountUGX,B),se=dr(f,B);se>=100&&E<100?qe({ts:b,severity:p==="Hard"?"Critical":"Warning",title:`${m} reached 100%`,message:`${A} reached its limit.",`,relatedIds:[A]}):se>=80&&E<80&&qe({ts:b,severity:"Warning",title:`${m} at 80%`,message:`${A} is above 80% of its cap.",`,relatedIds:[A]})};for(const m of u){const A=x.find(B=>B.id===m.id),f=((A==null?void 0:A.usedUGX)||m.usedUGX)+Ue.amountUGX;D(`${m.scope}`,m.id,f,m.amountUGX,m.capType),m.capType==="Soft"&&f>m.amountUGX&&qe({ts:b,severity:"Warning",title:"Soft cap exceeded",message:`${m.id} exceeded soft cap. Routed to approvals in production.",`,relatedIds:[m.id]})}if(ee){const m=ee.usedUGX+Ue.amountUGX;D("User cap",ee.id,m,ee.amountUGX,ee.capType),ee.capType==="Soft"&&m>ee.amountUGX&&qe({ts:b,severity:"Warning",title:"User soft cap exceeded",message:`${v.name} exceeded their soft cap. Consider adjust or enforce.",`,relatedIds:[ee.id]})}ze({ts:b,actor:"System",type:"Spend applied",details:`Applied spend ${hs(Ue.amountUGX)} by ${v.name}.`}),i({title:"Applied",message:"Spend applied and budgets updated.",kind:"success"}),je(!1)},ue=de>0?pe/de*100:0;return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(e_,{toasts:n,onDismiss:b=>r(v=>v.filter(u=>u.id!==b))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:Qx.green},children:e.jsx(dx,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Budgets, Spend Limits and Controls"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Org budgets, group budgets, user caps, alerts, forecasting, and emergency exceptions."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(Ds,{label:`Period: Monthly (Day ${o}/${c})`,tone:"neutral"}),e.jsx(Ds,{label:`Org used: ${Math.round(ue)}%`,tone:ue>=90?"warn":"good"}),e.jsx(Ds,{label:`Alerts: ${$.length}`,tone:$.some(b=>b.severity==="Critical")?"bad":"info"}),e.jsx(Ds,{label:"Premium forecasting",tone:"info"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(us,{variant:"outline",onClick:_e,children:[e.jsx(ls,{className:"h-4 w-4"})," Copy JSON"]}),e.jsxs(us,{variant:"outline",onClick:He,children:[e.jsx(gt,{className:"h-4 w-4"})," Export"]}),e.jsxs(us,{variant:"outline",onClick:De,children:[e.jsx($a,{className:"h-4 w-4"})," Simulate spend"]}),e.jsxs(us,{variant:"primary",onClick:le,children:[e.jsx(pt,{className:"h-4 w-4"})," New budget"]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-6",children:[e.jsx(pc,{title:"Org budget",value:hs(de),sub:"Monthly",icon:e.jsx(dx,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(pc,{title:"Spent",value:hs(pe),sub:`MTD (Day ${o})`,icon:e.jsx(Sr,{className:"h-5 w-5"}),tone:ue>=90?"warn":"good"}),e.jsx(pc,{title:"Remaining",value:hs(ye),sub:"Available this period",icon:e.jsx($a,{className:"h-5 w-5"}),tone:ye<=2e6?"warn":"neutral"}),e.jsx(pc,{title:"Runway",value:Fe===1/0?"":`${Math.max(0,Math.round(Fe))} days`,sub:"At current burn",icon:e.jsx(sl,{className:"h-5 w-5"}),tone:Fe!==1/0&&Fe<=5?"warn":"neutral"}),e.jsx(pc,{title:"Forecast",value:hs(ke),sub:ke>de?"Over budget risk":"Within budget",icon:e.jsx(qd,{className:"h-5 w-5"}),tone:ke>de?"warn":"good"}),e.jsx(pc,{title:"Exceptions",value:`${L.filter(b=>b.status==="Pending").length} pending`,sub:"Emergency workflow",icon:e.jsx(yt,{className:"h-5 w-5"}),tone:L.some(b=>b.status==="Pending")?"info":"neutral"})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx(pm,{valuePct:ue,labelLeft:"Org usage",labelRight:`${Math.round(ue)}%`}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Hard cap blocks spend. Soft cap allows spend but triggers alerts and routes to approvals in production."})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"budgets",label:"Budgets"},{id:"caps",label:"User caps"},{id:"history",label:"Allocation history"},{id:"forecast",label:"Forecasting"},{id:"exceptions",label:"Emergency exceptions"}].map(b=>e.jsx("button",{className:al("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",U===b.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:U===b.id?{background:Qx.green}:void 0,onClick:()=>ae(b.id),children:b.label},b.id))})]}),e.jsx("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Alerts"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Real-time cap breach alerts and policy reminders."})]}),e.jsx(Ds,{label:"Live",tone:"info"})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[fe.slice(0,6).map(b=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Ds,{label:b.severity,tone:T4(b.severity)}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:b.title})]}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:b.message}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:[vh(b.ts),"  ",Xv(b.ts)]})]}),e.jsx(Mt,{className:al("h-5 w-5",b.severity==="Critical"?"text-rose-700":b.severity==="Warning"?"text-amber-700":"text-blue-700")})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(us,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>i({title:"Rule",message:"Create rule from this alert (see J).",kind:"info"}),children:[e.jsx(ht,{className:"h-4 w-4"})," Create rule"]}),e.jsxs(us,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>H("Org","B-ORG"),children:[e.jsx(yt,{className:"h-4 w-4"})," Exception"]})]})]},b.id)),fe.length?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No alerts."})]})]}),e.jsxs("div",{className:"space-y-4",children:[U==="budgets"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Budgets"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Org, group, module, and marketplace budgets."})]}),e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:e.jsxs(us,{variant:"outline",onClick:le,children:[e.jsx(pt,{className:"h-4 w-4"})," Add budget"]})})]}),e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Scope"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Target"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Period"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Cap type"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Used"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Limit"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Usage"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[x.slice().sort((b,v)=>b.scope==="Org"?-1:v.scope==="Org"?1:b.scope.localeCompare(v.scope)).map(b=>{const v=dr(b.usedUGX,b.amountUGX),u=b.usedUGX>b.amountUGX,C=v>=80,Q=b.scope==="Org"?"Organization":b.scope==="Group"?b.group:b.scope==="Module"?b.module:`${b.marketplace}`;return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx(Ds,{label:b.scope,tone:"neutral"})}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Q||"-"}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:b.period}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Ds,{label:b.capType,tone:R4(b.capType)})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:hs(b.usedUGX)}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:hs(b.amountUGX)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(Ds,{label:`${v}%`,tone:u?"bad":C?"warn":"good"}),e.jsxs("div",{className:"text-xs text-slate-500",children:["Updated ",vh(b.updatedAt)]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(us,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>z(b),children:"Edit"}),e.jsxs(us,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>H(b.scope==="Org"?"Org":b.scope==="Group"?"Group":b.scope==="Module"?"Module":"Marketplace",b.id),children:[e.jsx(yt,{className:"h-4 w-4"})," Exception"]}),e.jsx(us,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>Be(b.id),children:e.jsx(Ye,{className:"h-4 w-4"})})]})})]},b.id)}),x.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No budgets configured."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Core: hard cap vs soft cap, budget periods, allocation history, real-time alerts. Premium: forecasting and suggested caps."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Premium: suggested caps"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Based on historical spend. Apply to group budgets."})]}),e.jsx(Ds,{label:"Premium",tone:"info"})]}),e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Avg"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Max"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Suggested"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Apply"})]})}),e.jsx("tbody",{children:ne.map(b=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:b.group}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:hs(b.avg)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:hs(b.p90)}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:hs(b.suggested)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(us,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{const v=Date.now();j(u=>u.map(C=>C.scope==="Group"&&C.group===b.group?{...C,amountUGX:b.suggested,updatedAt:v,updatedBy:"You",notes:`${C.notes||""} (Suggested caps applied)`}:C)),ze({ts:v,actor:"You",type:"Budget updated",details:`Applied suggested cap for ${b.group} to ${hs(b.suggested)}`}),i({title:"Applied",message:`Updated ${b.group} budget.",`,kind:"success"})},children:"Apply"})})]},b.group))})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Suggested caps are guidance. Keep stricter controls for high-risk modules and marketplaces."})]})]}):null,U==="caps"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"User caps"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"User spend caps by period. Hard cap blocks, soft cap warns."})]}),e.jsxs(us,{variant:"primary",onClick:xe,children:[e.jsx(pt,{className:"h-4 w-4"})," Add cap"]})]}),e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"User"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Eligible"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Cap type"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Used"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Limit"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Usage"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[g.map(b=>{const v=l.find(O=>O.id===b.userId),u=dr(b.usedUGX,b.amountUGX),C=u>=80,Q=b.usedUGX>b.amountUGX;return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:(v==null?void 0:v.name)||b.userId}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(v==null?void 0:v.group)||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Ds,{label:v!=null&&v.autoApprovalEligible?"Yes":"No",tone:v!=null&&v.autoApprovalEligible?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Ds,{label:b.capType,tone:R4(b.capType)})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:hs(b.usedUGX)}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:hs(b.amountUGX)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Ds,{label:`${u}%`,tone:Q?"bad":C?"warn":"good"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(us,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Ne(b),children:"Edit"}),e.jsxs(us,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>H("User",b.userId),children:[e.jsx(yt,{className:"h-4 w-4"})," Exception"]})]})})]},b.id)}),g.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No user caps configured."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: suggested caps can be computed per user based on their historical spend."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Real-time alerts"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Alerts are generated when crossing 80% or 100% thresholds, and on hard cap blocks."})]}),e.jsxs(us,{variant:"outline",onClick:De,children:[e.jsx($a,{className:"h-4 w-4"})," Simulate spend"]})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[fe.slice(0,8).map(b=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Ds,{label:b.severity,tone:T4(b.severity)}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:b.title})]}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:b.message}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:[Xv(b.ts)," (",vh(b.ts),")"]}),b.relatedIds.length?e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:b.relatedIds.slice(0,4).map(v=>e.jsx(Ds,{label:v,tone:"neutral"},v))}):null]}),e.jsx(Mt,{className:al("h-5 w-5",b.severity==="Critical"?"text-rose-700":b.severity==="Warning"?"text-amber-700":"text-blue-700")})]})},b.id)),fe.length?null:e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(Ke,{})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No alerts"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Alerts will appear here."})]})]})]})]}):null,U==="history"?e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Budget allocation history"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Changes are logged with who, when, and what happened."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(us,{variant:"outline",onClick:_e,children:[e.jsx(ls,{className:"h-4 w-4"})," Copy JSON"]}),e.jsxs(us,{variant:"outline",onClick:He,children:[e.jsx(gt,{className:"h-4 w-4"})," Export"]})]})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[k.slice(0,30).map(b=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Ds,{label:b.type,tone:b.type.includes("Hard cap")?"bad":b.type.includes("Exception")?"info":"neutral"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:b.actor})]}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:b.details}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:[Xv(b.ts)," (",vh(b.ts),")  ",b.id]})]}),e.jsx(wt,{className:"h-5 w-5 text-slate-600"})]})},b.id)),k.length?null:e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(wt,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No history"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Changes will be recorded here."})]})]})]}):null,U==="forecast"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Forecasting and runway"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: forecast to month-end by group, module, and marketplace."})]}),e.jsx(Ds,{label:"Premium",tone:"info"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Org forecast"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Simple burn-rate projection."}),e.jsx("div",{className:"mt-3",children:e.jsx(pm,{valuePct:dr(ke,de),labelLeft:`Forecast ${hs(ke)}`,labelRight:`Budget ${hs(de)}`})}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:["Burn per day: ",hs(Math.round(Qe))]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Runway by group"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"How long until budgets run out."}),e.jsx("div",{className:"mt-3 space-y-2",children:Te.map(b=>{const v=Math.max(0,b.amountUGX-b.usedUGX),u=b.runway===1/0?1/0:Math.max(0,Math.round(b.runway));return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:b.group}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Remaining: ",hs(v),"  Burn/day: ",hs(Math.round(b.burnPerDay))]})]}),e.jsx(Ds,{label:u===1/0?"":`${u}d`,tone:u!==1/0&&u<=5?"warn":"neutral"})]}),e.jsx("div",{className:"mt-2",children:e.jsx(pm,{valuePct:dr(b.usedUGX,b.amountUGX),labelLeft:"Used",labelRight:`${dr(b.usedUGX,b.amountUGX)}%`})})]},b.id)})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Forecast by module"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Module budgets and projected spend."})]}),e.jsx(Ds,{label:"Premium",tone:"info"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:Ee.length?Ee.map(b=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:b.module}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Forecast: ",hs(b.forecast),"  Budget: ",hs(b.amountUGX)]})]}),e.jsx(Ds,{label:b.forecast>b.amountUGX?"Risk":"OK",tone:b.forecast>b.amountUGX?"warn":"good"})]}),e.jsx("div",{className:"mt-2",children:e.jsx(pm,{valuePct:dr(b.forecast,b.amountUGX),labelLeft:"Forecast",labelRight:`${dr(b.forecast,b.amountUGX)}%`})})]},b.id)):e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No module budgets configured."})})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Forecast by marketplace"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"E-Commerce marketplace budgets and projected spend."})]}),e.jsx(Ds,{label:"Premium",tone:"info"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:Re.length?Re.map(b=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:b.marketplace}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Forecast: ",hs(b.forecast),"  Budget: ",hs(b.amountUGX)]})]}),e.jsx(Ds,{label:b.forecast>b.amountUGX?"Risk":"OK",tone:b.forecast>b.amountUGX?"warn":"good"})]}),e.jsx("div",{className:"mt-2",children:e.jsx(pm,{valuePct:dr(b.forecast,b.amountUGX),labelLeft:"Forecast",labelRight:`${dr(b.forecast,b.amountUGX)}%`})})]},b.id)):e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No marketplace budgets configured."})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Tip: keep MyLiveDealz stricter due to high-value deals."})]})]})]}):null,U==="exceptions"?e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Emergency exception workflow"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: allow temporary limit increases with approvals."})]}),e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:e.jsxs(us,{variant:"outline",onClick:()=>H(),children:[e.jsx(pt,{className:"h-4 w-4"})," New exception"]})})]}),e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"ID"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Target"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Extra"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Reason"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Attachments"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[L.map(b=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:b.id}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Ds,{label:b.status,tone:b.status==="Approved"?"good":b.status==="Rejected"?"bad":"warn"})}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[b.targetType,"  ",b.targetId]}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:hs(b.extraAmountUGX)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:b.reason}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Ds,{label:b.attachmentsProvided?"Yes":"No",tone:b.attachmentsProvided?"good":"warn"})}),e.jsx("td",{className:"px-4 py-3",children:b.status==="Pending"?e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(us,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>oe(b.id,"Approved"),children:[e.jsx(tt,{className:"h-4 w-4"})," Approve"]}),e.jsxs(us,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>oe(b.id,"Rejected"),children:[e.jsx(Ye,{className:"h-4 w-4"})," Reject"]})]}):e.jsx(Ds,{label:`By ${b.approver}`,tone:"neutral"})})]},b.id)),L.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No exceptions."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Emergency exceptions should be rare and always audit logged."})]}):null]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Quick actions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Budget and control tools."})]}),e.jsx(Ds,{label:"Admin",tone:"neutral"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(us,{variant:"outline",onClick:le,children:[e.jsx(pt,{className:"h-4 w-4"})," Create budget"]}),e.jsxs(us,{variant:"outline",onClick:xe,children:[e.jsx(cx,{className:"h-4 w-4"})," Set user cap"]}),e.jsxs(us,{variant:"outline",onClick:De,children:[e.jsx($a,{className:"h-4 w-4"})," Simulate spend"]}),e.jsxs(us,{variant:"outline",onClick:()=>H(),children:[e.jsx(yt,{className:"h-4 w-4"})," Emergency exception"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: emergency exceptions require approvals and are audit logged."})]})]})}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"L Budgets, Spend Limits and Controls v2. Core: org budget, group budgets, user caps, hard vs soft caps, budget periods, real-time alerts, and allocation history. Premium: forecasting and runway, suggested caps, and emergency exceptions with approvals."})})]})}),e.jsx(jh,{open:ie,title:W.id?"Edit budget":"New budget",subtitle:"Org, group, module, or marketplace budgets.",onClose:()=>_(!1),actions:[...W.id?[{label:"Delete",onClick:()=>{Be(W.id),_(!1)},variant:"danger"}]:[],{label:"Save",onClick:Pe}],footer:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(us,{variant:"ghost",onClick:()=>_(!1),children:"Cancel"}),e.jsx(us,{variant:"primary",onClick:Pe,children:W.id?"Save budget":"Add budget"})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Gl,{label:"Scope",value:W.scope,onChange:b=>{const v=b;J(u=>{const C={...u,scope:v};return v==="Org"&&(delete C.group,delete C.module,delete C.marketplace),v==="Group"&&(C.group=C.group||"Operations",delete C.module,delete C.marketplace),v==="Module"&&(C.module=C.module||"Rides & Logistics",delete C.group,delete C.marketplace),v==="Marketplace"&&(C.module="E-Commerce",C.marketplace=C.marketplace||"MyLiveDealz",delete C.group),C})},options:["Org","Group","Module","Marketplace"]}),e.jsx(Gl,{label:"Period",value:W.period,onChange:b=>J(v=>({...v,period:b})),options:["Weekly","Monthly","Quarterly"]}),e.jsx(Gl,{label:"Cap type",value:W.capType,onChange:b=>J(v=>({...v,capType:b})),options:["Hard","Soft"],hint:"Hard blocks spend"}),e.jsx(bh,{label:"Amount (UGX)",value:W.amountUGX,onChange:b=>J(v=>({...v,amountUGX:Math.max(0,b)})),hint:hs(W.amountUGX)}),e.jsx("div",{className:al("",W.scope==="Group"?"":"opacity-70"),children:e.jsx(Gl,{label:"Group",value:W.group||"Operations",onChange:b=>J(v=>({...v,group:b})),options:["Operations","Sales","Finance","Admin","Procurement"],disabled:W.scope!=="Group"})}),e.jsx("div",{className:al("",W.scope==="Module"?"":"opacity-70"),children:e.jsx(Gl,{label:"Module",value:W.module||"Rides & Logistics",onChange:b=>J(v=>({...v,module:b})),options:t,disabled:W.scope!=="Module"&&W.scope!=="Marketplace",hint:W.scope==="Marketplace"?"Fixed to E-Commerce":void 0})}),e.jsx("div",{className:al("md:col-span-2",W.scope==="Marketplace"?"":"opacity-70"),children:e.jsx(Gl,{label:"Marketplace",value:W.marketplace||"MyLiveDealz",onChange:b=>J(v=>({...v,marketplace:b})),options:s,disabled:W.scope!=="Marketplace",hint:"E-Commerce only"})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Kv,{label:"Notes",value:W.notes||"",onChange:b=>J(v=>({...v,notes:b})),placeholder:"Explain why this budget exists",rows:3})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Best practice: keep high-risk marketplaces on hard cap or require approvals above soft cap."})]})}),e.jsx(jh,{open:we,title:be.id?"Edit user cap":"New user cap",subtitle:"User caps are enforced alongside budgets.",onClose:()=>G(!1),actions:[{label:"Save",onClick:M}],footer:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(us,{variant:"ghost",onClick:()=>G(!1),children:"Cancel"}),e.jsx(us,{variant:"primary",onClick:M,children:"Save cap"})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Gl,{label:"User",value:be.userId,onChange:b=>Ge(v=>({...v,userId:b})),options:l.map(b=>b.id),hint:"Select user ID"}),e.jsx(Gl,{label:"Period",value:be.period,onChange:b=>Ge(v=>({...v,period:b})),options:["Weekly","Monthly","Quarterly"]}),e.jsx(Gl,{label:"Cap type",value:be.capType,onChange:b=>Ge(v=>({...v,capType:b})),options:["Hard","Soft"],hint:"Hard blocks spend"}),e.jsx(bh,{label:"Cap amount (UGX)",value:be.amountUGX,onChange:b=>Ge(v=>({...v,amountUGX:Math.max(0,b)})),hint:hs(be.amountUGX)}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: use suggested caps from historical spend for consistent enforcement."})]})}),e.jsx(jh,{open:Me,title:"Simulate spend",subtitle:"Creates alerts on breach and updates used amounts. Hard caps block.",onClose:()=>je(!1),actions:[{label:"Emergency exception",onClick:()=>H("Org","B-ORG")},{label:"Apply",onClick:ge}],footer:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(us,{variant:"ghost",onClick:()=>je(!1),children:"Cancel"}),e.jsx(us,{variant:"primary",onClick:ge,children:"Apply"})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Gl,{label:"User",value:Ue.userId,onChange:b=>{const v=l.find(u=>u.id===b)||l[0];Oe(u=>({...u,userId:b,module:u.module,marketplace:u.module==="E-Commerce"?u.marketplace==="-"?"MyLiveDealz":u.marketplace:"-"})),i({title:"User",message:`${v.name} selected.",`,kind:"info"})},options:l.map(b=>b.id),hint:"User ID"}),e.jsx(bh,{label:"Amount (UGX)",value:Ue.amountUGX,onChange:b=>Oe(v=>({...v,amountUGX:Math.max(0,b)})),hint:hs(Ue.amountUGX)}),e.jsx(Gl,{label:"Service Module",value:Ue.module,onChange:b=>{const v=b;Oe(u=>({...u,module:v,marketplace:v==="E-Commerce"?u.marketplace==="-"?"MyLiveDealz":u.marketplace:"-"}))},options:t}),e.jsx(Gl,{label:"Marketplace",value:String(Ue.marketplace==="-"?"MyLiveDealz":Ue.marketplace),onChange:b=>Oe(v=>({...v,marketplace:b})),options:s,disabled:Ue.module!=="E-Commerce",hint:Ue.module!=="E-Commerce"?"E-Commerce only":void 0}),e.jsx(Gl,{label:"Risk",value:Ue.risk,onChange:b=>Oe(v=>({...v,risk:b})),options:["Low","Medium","High"],hint:"Premium safeguards"}),e.jsx(D4,{label:"Vendor",value:Ue.vendor,onChange:b=>Oe(v=>({...v,vendor:b})),placeholder:"Vendor name"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Kv,{label:"Note",value:Ue.note,onChange:b=>Oe(v=>({...v,note:b})),placeholder:"Reason for spend",rows:3})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Spend hits org budget, group budget, optional module and marketplace budgets, plus the user cap."})]})}),e.jsx(jh,{open:he,title:"Emergency exception request",subtitle:"Premium: temporary limit increase requires approval.",onClose:()=>Y(!1),actions:[{label:"Submit",onClick:Ae}],footer:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(us,{variant:"ghost",onClick:()=>Y(!1),children:"Cancel"}),e.jsx(us,{variant:"primary",onClick:Ae,children:"Submit"})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Gl,{label:"Target type",value:Ie.targetType,onChange:b=>ce(v=>({...v,targetType:b})),options:["Org","Group","User","Module","Marketplace"]}),e.jsx(D4,{label:"Target ID",value:Ie.targetId,onChange:b=>ce(v=>({...v,targetId:b})),placeholder:"Budget ID or User ID",hint:"Example: B-ORG or B-G-FIN or U-1002"}),e.jsx(bh,{label:"Extra amount (UGX)",value:Ie.extraAmountUGX,onChange:b=>ce(v=>({...v,extraAmountUGX:Math.max(0,b)})),hint:hs(Ie.extraAmountUGX)}),e.jsx(Gl,{label:"Approver",value:Ie.approver,onChange:b=>ce(v=>({...v,approver:b})),options:["Org Admin","Finance Desk","CFO"]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Kv,{label:"Reason",value:Ie.reason,onChange:b=>ce(v=>({...v,reason:b})),placeholder:"Example: urgent purchase required for operations, request approval to exceed cap",hint:"Minimum 10 characters",rows:4})}),e.jsx(JV,{enabled:Ie.attachmentsProvided,onChange:b=>ce(v=>({...v,attachmentsProvided:b})),label:"Attachments provided",description:"Required for high value exceptions"}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"In production, this request routes to Approval Workflow Builder (J) and appears in Approvals Inbox (K)."})]})})]});function Ke(){return e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"text-slate-700",children:[e.jsx("path",{d:"M15 17H9",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),e.jsx("path",{d:"M18 8a6 6 0 10-12 0c0 7-3 7-3 7h18s-3 0-3-7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}}const Yx={green:"#03CD8C",orange:"#F77F00"};function Wa(...t){return t.filter(Boolean).join(" ")}function hm(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function uy(t,s,a){return Math.max(s,Math.min(a,t))}function Lt(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function yh(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function $4(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function Bt({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Wa("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function It({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:Yx.green}:t==="accent"?{background:Yx.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Wa(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Ji({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:Wa("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:Wa("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function Nh({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:Wa(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:Wa("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function Ya({label:t,value:s,onChange:a,hint:l,disabled:n}){return e.jsxs("div",{className:Wa(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",value:s,onChange:r=>a(Number(r.target.value||0)),disabled:n,className:Wa("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function hl({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:Wa(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:Wa("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i,children:i},i))})]})}function L4({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:i=>a(i.target.value),placeholder:l,rows:r,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"})]})}function s_({actions:t}){const[s,a]=d.useState(!1);return e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 focus:bg-slate-100 focus:outline-none",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>a(!1)}),e.jsx("div",{className:"absolute right-0 top-full z-40 mt-1 w-48 overflow-hidden rounded-xl border border-slate-200 bg-white shadow-xl ring-1 ring-slate-200",children:t.map((l,n)=>e.jsx("button",{onClick:()=>{l.onClick(),a(!1)},className:Wa("block w-full px-4 py-2.5 text-left text-sm font-medium transition hover:bg-slate-50",l.variant==="danger"?"text-rose-700 hover:bg-rose-50":"text-slate-700"),children:l.label},n))})]})]})}function Qv({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="920px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[8vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-1",children:[o?e.jsx(s_,{actions:o}):null,e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function a_({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Wa("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function Ea({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function F4({pct:t,labelLeft:s,labelRight:a}){const l=uy(t,0,150);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-600",children:[e.jsx("span",{className:"font-semibold",children:s}),e.jsx("span",{className:"font-semibold",children:a})]}),e.jsx("div",{className:"mt-2 h-2 w-full overflow-hidden rounded-full bg-slate-100",children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${Math.min(100,l)}%`,background:Yx.green}})}),l>100?e.jsxs("div",{className:"mt-2 text-xs font-semibold text-rose-700",children:["Over by ",Math.round((l-100)*10)/10,"%"]}):null]})}function U4(t){return t==="High"?"bad":t==="Medium"?"warn":"good"}function Yv(t){return t==="Hard stop"?"bad":t==="Soft stop"?"warn":"good"}function l_(t){return t==="Approved"?"good":t==="Rejected"?"bad":"warn"}function Zi(t){return Math.max(0,t.balanceUGX-t.heldUGX)}function n_(){const t=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],s=["Operations","Sales","Finance","Admin","Procurement"],a=["OPS-001","SALES-TRAVEL","FIN-OPS","ADMIN-CORE","PROC-001"],[l,n]=d.useState([]),r=P=>{const X=hm("toast");n(S=>[{id:X,...P},...S].slice(0,4)),window.setTimeout(()=>n(S=>S.filter(w=>w.id!==X)),3200)},[i,o]=d.useState("overview"),[c,x]=d.useState("Wallet"),[j,g]=d.useState({Wallet:!0,Credit:!0,Prepaid:!0}),[N,$]=d.useState(()=>{const P=Date.now();return[{id:"W-ORG",name:"Main Corporate Wallet",type:"Org",currency:"UGX",balanceUGX:92e5,heldUGX:7e5,status:"Active",updatedAt:P-2*60*60*1e3},{id:"W-OPS",name:"Operations Wallet",type:"Group",group:"Operations",currency:"UGX",balanceUGX:32e5,heldUGX:0,status:"Active",updatedAt:P-5*60*60*1e3},{id:"W-SALES",name:"Sales Wallet",type:"Group",group:"Sales",currency:"UGX",balanceUGX:18e5,heldUGX:12e4,status:"Active",updatedAt:P-8*60*60*1e3},{id:"W-CC-TRAVEL",name:"Sales Travel Cost Center",type:"Cost center",costCenter:"SALES-TRAVEL",currency:"UGX",balanceUGX:6e5,heldUGX:0,status:"Active",updatedAt:P-1*24*60*60*1e3}]}),[T,k]=d.useState("W-ORG"),[q,L]=d.useState(()=>({enabled:!0,limitUGX:15e6,usedUGX:42e5,repaymentTerms:{cycle:"Monthly",graceDays:7,metadata:"Interest: 0% promo, late fee: per agreement"},delinquent:!1})),[R,U]=d.useState(()=>({enabled:!0,balanceUGX:54e5,reservedUGX:35e4,stopWhenDepleted:!0})),[ae,ie]=d.useState(5e6),[_,W]=d.useState(!1),[J,we]=d.useState(()=>({enabled:!0,invoiceGraceDays:7,invoiceOverdueDays:0})),[G,be]=d.useState(()=>{const P=Date.now();return[{id:"FR-1001",createdAt:P-6*60*60*1e3,createdBy:"Finance Desk",kind:"Add funds",method:"Bank transfer",walletId:"W-ORG",amountUGX:85e5,risk:"Medium",reason:"Top up for month start operations",status:"Pending"},{id:"FR-1002",createdAt:P-30*60*60*1e3,createdBy:"Procurement Desk",kind:"Prepaid deposit",method:"Bank transfer",amountUGX:5e6,risk:"Low",reason:"Prepaid deposit for Q1",status:"Approved",approvedBy:"Org Admin",decisionNote:"Approved"}]}),[Ge,Me]=d.useState(()=>[{id:"ATU-01",enabled:!0,walletId:"W-ORG",thresholdUGX:15e5,topUpAmountUGX:2e6,maxPerDayUGX:4e6,requireApprovalOverUGX:5e6,method:"Bank transfer",notes:"Protect availability for core services."}]),[je,Ue]=d.useState(()=>{const P=Date.now();return[{id:"LG-001",at:P-2*60*60*1e3,type:"Hold placed",walletId:"W-ORG",amountUGX:7e5,note:"Hold for pending RFQ milestone"},{id:"LG-002",at:P-5*60*60*1e3,type:"Spend",walletId:"W-SALES",amountUGX:82e3,note:"Ride to client meeting"},{id:"LG-003",at:P-10*60*60*1e3,type:"Credit draw",amountUGX:12e5,note:"Marketplace purchase covered by credit"},{id:"LG-004",at:P-2*24*60*60*1e3,type:"Prepaid deposit",amountUGX:5e6,note:"Deposit funded"}]}),[Oe,he]=d.useState(()=>{const P=Date.now();return[{id:"RE-01",createdAt:P-70*60*1e3,severity:"Warning",title:"Unusual funding frequency",details:"3 funding attempts within 30 minutes. Review source accounts.",walletId:"W-ORG",status:"Open"},{id:"RE-02",createdAt:P-14*60*60*1e3,severity:"Critical",title:"Potential fraud trigger",details:"Large funding request above threshold requires approval.",walletId:"W-ORG",status:"Open"}]}),[Y,Ie]=d.useState(!1),[ce,me]=d.useState(()=>({id:"",name:"",type:"Group",group:"Operations",costCenter:"OPS-001",currency:"UGX",balanceUGX:0,heldUGX:0,status:"Active",updatedAt:Date.now()})),[pe,de]=d.useState(!1),[ye,Qe]=d.useState(()=>({kind:"Add funds",fromWalletId:"W-ORG",toWalletId:"W-ORG",amountUGX:5e5,method:"Bank transfer",reason:"",risk:"Low"})),[Fe,ke]=d.useState(!1),[fe,Ve]=d.useState(()=>({id:"",enabled:!0,walletId:"W-ORG",thresholdUGX:15e5,topUpAmountUGX:2e6,maxPerDayUGX:4e6,requireApprovalOverUGX:5e6,method:"Bank transfer",notes:""})),[ne,Te]=d.useState(""),[Ee,Re]=d.useState("All"),[ze,qe]=d.useState("All"),[He,_e]=d.useState(""),[le,z]=d.useState("All"),Pe=d.useMemo(()=>N.find(P=>P.id===T)||N[0],[N,T]),Be=d.useMemo(()=>N.reduce((P,X)=>P+X.balanceUGX,0),[N]),xe=d.useMemo(()=>N.reduce((P,X)=>P+Zi(X),0),[N]),Ne=Math.max(0,q.limitUGX-q.usedUGX),M=Math.max(0,R.balanceUGX-R.reservedUGX),H=d.useMemo(()=>{const P=[];if(!J.enabled)return{enabled:!1,invoiceOverdueDays:J.invoiceOverdueDays,invoiceGraceDays:J.invoiceGraceDays,agreementCompliant:!0,status:"Active",reasons:[]};_&&P.push("CorporatePay is frozen by admin risk control"),J.invoiceOverdueDays>J.invoiceGraceDays&&P.push(`Invoice overdue beyond grace (${J.invoiceOverdueDays}d > ${J.invoiceGraceDays}d)`);const X=j.Wallet&&Pe&&Pe.status==="Active"&&Zi(Pe)>0,S=j.Credit&&q.enabled&&!q.delinquent&&Ne>0,w=j.Prepaid&&R.enabled&&M>0;c==="Wallet"&&(!Pe||Pe.status!=="Active")&&P.push("Primary wallet is not active"),c==="Wallet"&&Pe&&Zi(Pe)<=0&&P.push("Primary wallet is depleted"),c==="Credit"&&q.enabled&&(q.delinquent||Ne<=0)&&P.push(q.delinquent?"Credit line is delinquent":"Credit limit reached"),c==="Prepaid"&&R.enabled&&M<=0&&R.stopWhenDepleted&&P.push("Prepaid deposit depleted");const h=P.length===0,K=_||J.invoiceOverdueDays>J.invoiceGraceDays||c==="Prepaid"&&R.stopWhenDepleted&&!w||c==="Wallet"&&!X||c==="Credit"&&!S,V=X||S||w,Ce=c==="Wallet"?X:c==="Credit"?S:w;return K&&!V?{enabled:!0,invoiceOverdueDays:J.invoiceOverdueDays,invoiceGraceDays:J.invoiceGraceDays,agreementCompliant:!1,status:"Hard stop",reasons:P}:!Ce&&V?(P.push("Default payment method unavailable, fallback available"),{enabled:!0,invoiceOverdueDays:J.invoiceOverdueDays,invoiceGraceDays:J.invoiceGraceDays,agreementCompliant:!1,status:"Soft stop",reasons:P}):K?{enabled:!0,invoiceOverdueDays:J.invoiceOverdueDays,invoiceGraceDays:J.invoiceGraceDays,agreementCompliant:!1,status:"Hard stop",reasons:P}:{enabled:!0,invoiceOverdueDays:J.invoiceOverdueDays,invoiceGraceDays:J.invoiceGraceDays,agreementCompliant:h,status:"Active",reasons:P}},[J,_,j,c,Pe,q,Ne,R,M]),Ae=d.useMemo(()=>{const P=t.map(X=>({module:X,enabled:!0,reason:""}));return H.enabled?H.status==="Hard stop"?P.map(X=>({...X,enabled:!1,reason:H.reasons[0]||"Hard stop"})):H.status==="Soft stop"?P.map(X=>({...X,enabled:!0,reason:"Fallback payment may apply"})):P:P},[t,H]),oe=d.useMemo(()=>G.filter(P=>P.status==="Pending").length,[G]),De=d.useMemo(()=>{const P=He.trim().toLowerCase();return G.filter(X=>le==="All"?!0:X.status===le).filter(X=>P?`${X.id} ${X.kind} ${X.method} ${X.createdBy} ${X.reason} ${X.status} ${X.walletId||""}`.toLowerCase().includes(P):!0).sort((X,S)=>S.createdAt-X.createdAt)},[G,He,le]),$e=d.useMemo(()=>{const P=ne.trim().toLowerCase();return je.filter(X=>Ee==="All"?!0:X.type===Ee).filter(X=>ze==="All"?!0:(X.walletId||"")===ze).filter(X=>P?`${X.id} ${X.type} ${X.note} ${X.walletId||""}`.toLowerCase().includes(P):!0).sort((X,S)=>S.at-X.at)},[je,ne,Ee,ze]),ge=()=>{me({id:"",name:"",type:"Group",group:"Operations",costCenter:"OPS-001",currency:"UGX",balanceUGX:0,heldUGX:0,status:"Active",updatedAt:Date.now()}),Ie(!0)},ue=()=>{if(!ce.name.trim()){r({title:"Missing name",message:"Wallet name is required.",kind:"warn"});return}const P=Date.now(),X=ce.id||hm("W"),S={...ce,id:X,updatedAt:P};$(w=>{const h=w.findIndex(K=>K.id===X);if(h>=0){const K=w.slice();return K[h]=S,K}return[S,...w]}),r({title:"Saved",message:"Wallet saved.",kind:"success"}),Ie(!1),T||k(X)},Ke=P=>{if(P==="W-ORG"){r({title:"Blocked",message:"You cannot delete the main org wallet in this demo.",kind:"warn"});return}$(X=>X.filter(S=>S.id!==P)),T===P&&k("W-ORG"),r({title:"Deleted",message:"Wallet removed.",kind:"info"})},b=P=>{var S;const X=T||((S=N[0])==null?void 0:S.id)||"W-ORG";Qe(w=>({...w,kind:P,fromWalletId:X,toWalletId:X,amountUGX:P==="Repay credit"?5e5:P==="Prepaid deposit"?2e6:5e5,method:P==="Transfer"?"Internal transfer":"Bank transfer",reason:"",risk:"Low"})),de(!0)},v=P=>{const X={id:hm("FR"),createdAt:Date.now(),status:P.status||"Pending",...P};return be(S=>[X,...S]),X},u=P=>{Ue(X=>[{id:hm("LG"),at:Date.now(),...P},...X])},C=()=>{const P=ye.reason.trim();if(P.length<8){r({title:"Reason required",message:"Add a clear reason (min 8 chars).",kind:"warn"});return}if(ye.amountUGX<=0){r({title:"Invalid amount",message:"Amount must be greater than zero.",kind:"warn"});return}const X=ye.amountUGX,S=Date.now(),w=X>=ae&&(ye.kind==="Add funds"||ye.kind==="Prepaid deposit");if(ye.kind==="Add funds"){const h=v({createdBy:"You",kind:"Add funds",method:ye.method,walletId:ye.toWalletId,amountUGX:X,risk:ye.risk,reason:P,status:w?"Pending":"Approved",approvedBy:w?void 0:"Auto",decisionNote:w?void 0:"Auto-approved under threshold"});w?(u({type:"Wallet funding",walletId:ye.toWalletId,amountUGX:0,note:`Funding request ${h.id} pending approval`}),r({title:"Request created",message:`${h.id} pending approval.",`,kind:"info"})):($(K=>K.map(V=>V.id===ye.toWalletId?{...V,balanceUGX:V.balanceUGX+X,updatedAt:S}:V)),u({type:"Wallet funding",walletId:ye.toWalletId,amountUGX:X,note:`Funding (${ye.method}): ${P}`}),r({title:"Funded",message:`Added ${Lt(X)} to wallet.",`,kind:"success"})),de(!1);return}if(ye.kind==="Transfer"){if(ye.fromWalletId===ye.toWalletId){r({title:"Invalid transfer",message:"Choose different wallets.",kind:"warn"});return}const h=N.find(V=>V.id===ye.fromWalletId),K=N.find(V=>V.id===ye.toWalletId);if(!h||!K){r({title:"Wallet not found",message:"Select valid wallets.",kind:"warn"});return}if(h.status!=="Active"){r({title:"Blocked",message:"Source wallet is frozen.",kind:"warn"});return}if(Zi(h)<X){r({title:"Insufficient",message:"Not enough available balance in source wallet.",kind:"warn"});return}$(V=>V.map(Ce=>Ce.id===h.id?{...Ce,balanceUGX:Ce.balanceUGX-X,updatedAt:S}:Ce.id===K.id?{...Ce,balanceUGX:Ce.balanceUGX+X,updatedAt:S}:Ce)),u({type:"Wallet transfer",walletId:h.id,amountUGX:-X,note:`Transfer to ${K.name}: ${P}`}),u({type:"Wallet transfer",walletId:K.id,amountUGX:X,note:`Transfer from ${h.name}: ${P}`}),r({title:"Transferred",message:`Moved ${Lt(X)}.",`,kind:"success"}),de(!1);return}if(ye.kind==="Repay credit"){const h=v({createdBy:"You",kind:"Repay credit",method:ye.method,amountUGX:X,risk:ye.risk,reason:P,status:X>=ae?"Pending":"Approved",approvedBy:X>=ae?void 0:"Auto",decisionNote:X>=ae?void 0:"Auto-approved under threshold"});h.status==="Approved"?(L(K=>({...K,usedUGX:Math.max(0,K.usedUGX-X),delinquent:!1})),u({type:"Credit repayment",amountUGX:X,note:`Credit repayment (${ye.method}): ${P}`}),r({title:"Repaid",message:`Repaid ${Lt(X)}.",`,kind:"success"})):r({title:"Request created",message:`${h.id} pending approval.",`,kind:"info"}),de(!1);return}if(ye.kind==="Prepaid deposit"){const h=v({createdBy:"You",kind:"Prepaid deposit",method:ye.method,amountUGX:X,risk:ye.risk,reason:P,status:w?"Pending":"Approved",approvedBy:w?void 0:"Auto",decisionNote:w?void 0:"Auto-approved under threshold"});w?r({title:"Request created",message:`${h.id} pending approval.",`,kind:"info"}):(U(K=>({...K,balanceUGX:K.balanceUGX+X})),u({type:"Prepaid deposit",amountUGX:X,note:`Prepaid deposit (${ye.method}): ${P}`}),r({title:"Deposited",message:`Added ${Lt(X)} to prepaid.",`,kind:"success"})),de(!1);return}},Q=P=>{const X=Date.now(),S=G.find(w=>w.id===P);!S||S.status!=="Pending"||(be(w=>w.map(h=>h.id===P?{...h,status:"Approved",approvedBy:"You",decisionNote:"Approved"}:h)),S.kind==="Add funds"&&S.walletId&&($(w=>w.map(h=>h.id===S.walletId?{...h,balanceUGX:h.balanceUGX+S.amountUGX,updatedAt:X}:h)),u({type:"Wallet funding",walletId:S.walletId,amountUGX:S.amountUGX,note:`Approved funding ${P}`})),S.kind==="Prepaid deposit"&&(U(w=>({...w,balanceUGX:w.balanceUGX+S.amountUGX})),u({type:"Prepaid deposit",amountUGX:S.amountUGX,note:`Approved prepaid deposit ${P}`})),S.kind==="Repay credit"&&(L(w=>({...w,usedUGX:Math.max(0,w.usedUGX-S.amountUGX),delinquent:!1})),u({type:"Credit repayment",amountUGX:S.amountUGX,note:`Approved credit repayment ${P}`})),r({title:"Approved",message:`${P} approved.",`,kind:"success"}))},O=P=>{const X=G.find(S=>S.id===P);!X||X.status!=="Pending"||(be(S=>S.map(w=>w.id===P?{...w,status:"Rejected",approvedBy:"You",decisionNote:"Rejected"}:w)),r({title:"Rejected",message:`${P} rejected.",`,kind:"info"}))},ee=P=>{const X=Date.now();$(S=>S.map(w=>{if(w.id!==P)return w;const h=w.status==="Active"?"Frozen":"Active";return u({type:h==="Frozen"?"Freeze":"Unfreeze",walletId:P,amountUGX:0,note:`${h} by admin`}),{...w,status:h,updatedAt:X}})),r({title:"Updated",message:"Wallet status updated.",kind:"info"})},F=()=>{const P=Date.now(),X=[];Ge.forEach(S=>{if(!S.enabled)return;const w=N.find(Ce=>Ce.id===S.walletId);if(!w)return;const h=Zi(w);if(h>=S.thresholdUGX)return;const K=S.topUpAmountUGX>=S.requireApprovalOverUGX,V=v({createdBy:"System",kind:"Add funds",method:S.method,walletId:S.walletId,amountUGX:S.topUpAmountUGX,risk:"Low",reason:`Auto top-up rule ${S.id} triggered (avail ${Lt(h)} < ${Lt(S.thresholdUGX)})`,status:K?"Pending":"Approved",approvedBy:K?void 0:"Auto",decisionNote:K?void 0:"Auto-approved by rule"});K?u({type:"Wallet funding",walletId:S.walletId,amountUGX:0,note:`Auto top-up request ${V.id} pending approval`}):($(Ce=>Ce.map(I=>I.id===S.walletId?{...I,balanceUGX:I.balanceUGX+S.topUpAmountUGX,updatedAt:P}:I)),u({type:"Wallet funding",walletId:S.walletId,amountUGX:S.topUpAmountUGX,note:`Auto top-up applied (${S.id})`})),X.push(S.id)}),X.length?r({title:"Auto top-up",message:`Triggered ${X.length} rule(s).\`,`,kind:"success"}):r({title:"No triggers",message:"No auto top-up rules triggered.",kind:"info"})},D=()=>{if(!fe.walletId){r({title:"Missing wallet",message:"Select a wallet.",kind:"warn"});return}if(fe.thresholdUGX<=0||fe.topUpAmountUGX<=0){r({title:"Invalid values",message:"Threshold and top-up amount must be greater than zero.",kind:"warn"});return}const P=fe.id||hm("ATU"),X={...fe,id:P};Me(S=>{const w=S.findIndex(h=>h.id===P);if(w>=0){const h=S.slice();return h[w]=X,h}return[X,...S]}),r({title:"Saved",message:"Auto top-up rule saved.",kind:"success"}),ke(!1)},m=P=>{he(X=>X.map(S=>S.id===P?{...S,status:"Resolved"}:S)),r({title:"Resolved",message:"Risk event resolved.",kind:"success"})},A=()=>{const P={allowedPayments:j,defaultPayment:c,primaryWalletId:T,wallets:N,credit:q,prepaid:R,enforcementCfg:J,riskFreezeCorporatePay:_,largeFundingThresholdUGX:ae,requests:G,autoTopUps:Ge,riskEvents:Oe,ledger:je,exportedAt:new Date().toISOString()},X=JSON.stringify(P,null,2),S=new Blob([X],{type:"application/json"}),w=URL.createObjectURL(S),h=document.createElement("a");h.href=w,h.download="corporatepay-wallet-credit-prepaid.json",h.click(),URL.revokeObjectURL(w),r({title:"Exported",message:"Downloaded JSON config.",kind:"success"})},f=async()=>{const P={wallets:N,credit:q,prepaid:R,requests:G,autoTopUps:Ge,enforcementCfg:J,riskEvents:Oe,ledger:je};try{await navigator.clipboard.writeText(JSON.stringify(P,null,2)),r({title:"Copied",message:"Copied JSON to clipboard.",kind:"success"})}catch{r({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},B=P=>{me(JSON.parse(JSON.stringify(P))),Ie(!0)},p=d.useMemo(()=>N.slice().sort((P,X)=>P.id===T?-1:X.id===T?1:P.name.localeCompare(X.name)),[N,T]),E=d.useMemo(()=>N.map(P=>P.id),[N]),se=Yv(H.status);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(a_,{toasts:l,onDismiss:P=>n(X=>X.filter(S=>S.id!==P))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:Yx.green},children:e.jsx($a,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Corporate Wallet, Credit Line and Prepaid Funding"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Three payment models, multi-wallets, funding approvals, auto top-up rules, and enforcement."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(Bt,{label:`Default: ${c}`,tone:"info"}),e.jsx(Bt,{label:`Pending requests: ${oe}`,tone:oe?"warn":"good"}),e.jsx(Bt,{label:`Enforcement: ${H.status}`,tone:se}),_?e.jsx(Bt,{label:"Frozen",tone:"bad"}):e.jsx(Bt,{label:"Not frozen",tone:"good"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(It,{variant:"outline",onClick:f,children:[e.jsx(ls,{className:"h-4 w-4"})," Copy JSON"]}),e.jsxs(It,{variant:"outline",onClick:A,children:[e.jsx(gt,{className:"h-4 w-4"})," Export"]}),e.jsxs(It,{variant:"outline",onClick:()=>b("Add funds"),children:[e.jsx(pt,{className:"h-4 w-4"})," Add funds"]}),e.jsxs(It,{variant:"primary",onClick:ge,children:[e.jsx(pt,{className:"h-4 w-4"})," New wallet"]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-5",children:[e.jsx(y,{title:"Wallet total",value:Lt(Be),sub:`${Lt(xe)} available`,icon:e.jsx($a,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(y,{title:"Credit utilization",value:`${Math.round(q.usedUGX/Math.max(1,q.limitUGX)*100)}%`,sub:`${Lt(Ne)} available`,icon:e.jsx($c,{className:"h-5 w-5"}),tone:q.delinquent?"bad":"neutral"}),e.jsx(y,{title:"Prepaid",value:Lt(R.balanceUGX),sub:`${Lt(M)} available`,icon:e.jsx(Wm,{className:"h-5 w-5"}),tone:M<=0?"warn":"neutral"}),e.jsx(y,{title:"Large funding threshold",value:Lt(ae),sub:"Requires approval",icon:e.jsx(yt,{className:"h-5 w-5"}),tone:"info"}),e.jsx(y,{title:"Open risk events",value:`${Oe.filter(P=>P.status==="Open").length}`,sub:"Fraud triggers and reviews",icon:e.jsx(Hm,{className:"h-5 w-5"}),tone:Oe.some(P=>P.status==="Open"&&P.severity==="Critical")?"bad":"warn"})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"overview",label:"Overview"},{id:"wallets",label:"Wallets"},{id:"credit",label:"Credit line"},{id:"prepaid",label:"Prepaid"},{id:"funding",label:"Funding and approvals"},{id:"autotopup",label:"Auto top-up"},{id:"risk",label:"Risk and enforcement"},{id:"ledger",label:"Ledger"}].map(P=>e.jsx("button",{className:Wa("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",i===P.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:i===P.id?{background:Yx.green}:void 0,onClick:()=>o(P.id),children:P.label},P.id))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[i==="overview"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-7 space-y-4",children:[e.jsxs(Ea,{title:"Payment models",subtitle:"Employees use normal EVzone apps. CorporatePay appears at checkout based on these settings.",right:e.jsx(Bt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(re,{icon:e.jsx($a,{className:"h-5 w-5"}),title:"Pay as you go",subtitle:"Corporate Wallet",on:j.Wallet,onToggle:()=>g(P=>({...P,Wallet:!P.Wallet})),selected:c==="Wallet",onSelect:()=>x("Wallet"),bullets:["Uses wallet balance","Supports sub-wallets","Stops when depleted (if no fallback)"]}),e.jsx(re,{icon:e.jsx($c,{className:"h-5 w-5"}),title:"Credit line",subtitle:"Limit-based spend",on:j.Credit,onToggle:()=>g(P=>({...P,Credit:!P.Credit})),selected:c==="Credit",onSelect:()=>x("Credit"),bullets:["Limit and utilization","Repayment terms metadata","Stops if delinquent or limit reached"]}),e.jsx(re,{icon:e.jsx(Wm,{className:"h-5 w-5"}),title:"Prepaid deposit",subtitle:"Spend down",on:j.Prepaid,onToggle:()=>g(P=>({...P,Prepaid:!P.Prepaid})),selected:c==="Prepaid",onSelect:()=>x("Prepaid"),bullets:["Spend down balance","Stops when depleted","Good for strict cost control"]})]}),e.jsx("div",{className:"mt-4 rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-700",children:"Best practice: keep more than one model enabled so CorporatePay can fall back when a balance is low."})]}),e.jsxs(Ea,{title:"Account health",subtitle:"Balances, availability, and service stop enforcement.",right:e.jsx(Bt,{label:H.status,tone:Yv(H.status)}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Primary wallet"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Used by default for pay-as-you-go."})]}),e.jsx(Bt,{label:(Pe==null?void 0:Pe.status)||"-",tone:(Pe==null?void 0:Pe.status)==="Frozen"?"bad":"good"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2",children:[e.jsx(hl,{label:"Primary wallet",value:T,onChange:k,options:E,hint:"Org Admin"}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Balance: ",e.jsx("span",{className:"font-semibold text-slate-900",children:Lt((Pe==null?void 0:Pe.balanceUGX)||0)}),e.jsx("br",{}),"Held: ",e.jsx("span",{className:"font-semibold text-slate-900",children:Lt((Pe==null?void 0:Pe.heldUGX)||0)}),e.jsx("br",{}),"Available: ",e.jsx("span",{className:"font-semibold text-slate-900",children:Lt(Pe?Zi(Pe):0)})]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(It,{variant:"outline",onClick:()=>b("Transfer"),children:[e.jsx(Bp,{className:"h-4 w-4"})," Transfer"]}),e.jsxs(It,{variant:"outline",onClick:()=>b("Add funds"),children:[e.jsx(pt,{className:"h-4 w-4"})," Add funds"]}),e.jsxs(It,{variant:"outline",onClick:()=>ee(T),children:[(Pe==null?void 0:Pe.status)==="Frozen"?e.jsx(ko,{className:"h-4 w-4"}):e.jsx(ra,{className:"h-4 w-4"})," ",(Pe==null?void 0:Pe.status)==="Frozen"?"Unfreeze":"Freeze"]})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Enforcement"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Policy-backed auto stop when agreements are not complied with."})]}),e.jsx(Bt,{label:H.enabled?"Enabled":"Off",tone:H.enabled?"info":"neutral"})]}),e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsx(Ji,{enabled:J.enabled,onChange:P=>we(X=>({...X,enabled:P})),label:"Enable enforcement",description:"When on, the system can stop services based on compliance."}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(Ya,{label:"Invoice overdue days",value:J.invoiceOverdueDays,onChange:P=>we(X=>({...X,invoiceOverdueDays:Math.max(0,P)})),hint:"Simulated",disabled:!J.enabled}),e.jsx(Ya,{label:"Grace days",value:J.invoiceGraceDays,onChange:P=>we(X=>({...X,invoiceGraceDays:Math.max(0,P)})),hint:"Policy",disabled:!J.enabled})]}),e.jsxs("div",{className:Wa("rounded-2xl p-3 text-xs ring-1",H.status==="Hard stop"?"bg-rose-50 text-rose-800 ring-rose-200":H.status==="Soft stop"?"bg-amber-50 text-amber-900 ring-amber-200":"bg-emerald-50 text-emerald-900 ring-emerald-200"),children:[e.jsxs("div",{className:"font-semibold",children:["Status: ",H.status]}),H.reasons.length?e.jsx("ul",{className:"mt-2 space-y-1",children:H.reasons.slice(0,5).map((P,X)=>e.jsxs("li",{children:[" ",P]},X))}):e.jsx("div",{className:"mt-2",children:"No issues detected."})]})]})]})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Service availability"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"When hard stopped, CorporatePay disappears at checkout and services stop."})]}),e.jsx(Bt,{label:H.status,tone:Yv(H.status)})]}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2 md:grid-cols-2",children:Ae.slice(0,8).map(P=>e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:P.module}),e.jsxs("div",{className:"mt-0.5 text-xs text-slate-500",children:[P.enabled?"Enabled":"Disabled",P.reason?`  ${P.reason}`:""]})]}),e.jsx(Bt,{label:P.enabled?"On":"Off",tone:P.enabled?"good":"bad"})]},P.module))})]})]})]}),e.jsxs("div",{className:"lg:col-span-5 space-y-4",children:[e.jsxs(Ea,{title:"Funding actions",subtitle:"Add funds, deposit prepaid, repay credit, or transfer between sub-wallets.",right:e.jsx(Bt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(ve,{icon:e.jsx(pt,{className:"h-5 w-5"}),title:"Add funds",subtitle:"Top up wallet",onClick:()=>b("Add funds")}),e.jsx(ve,{icon:e.jsx(Bp,{className:"h-5 w-5"}),title:"Transfer",subtitle:"Org to group or cost center",onClick:()=>b("Transfer")}),e.jsx(ve,{icon:e.jsx(Wm,{className:"h-5 w-5"}),title:"Prepaid deposit",subtitle:"Spend down account",onClick:()=>b("Prepaid deposit")}),e.jsx(ve,{icon:e.jsx($c,{className:"h-5 w-5"}),title:"Repay credit",subtitle:"Reduce utilization",onClick:()=>b("Repay credit")})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:["Premium: large funding events can require approvals. Threshold: ",Lt(ae),"."]})]}),e.jsx(Ea,{title:"Pending approvals",subtitle:"Funding requests and limit changes that require review.",right:e.jsx(Bt,{label:`${oe} pending`,tone:oe?"warn":"good"}),children:e.jsxs("div",{className:"space-y-2",children:[De.filter(P=>P.status==="Pending").slice(0,6).map(P=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:P.id}),e.jsx(Bt,{label:P.kind,tone:"neutral"}),e.jsx(Bt,{label:P.risk,tone:U4(P.risk)})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[yh(P.createdAt),"  By ",P.createdBy]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:Lt(P.amountUGX)}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Method: ",P.method,P.walletId?`  Wallet: ${P.walletId}`:""]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Reason: ",P.reason]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(It,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>Q(P.id),children:[e.jsx(tt,{className:"h-4 w-4"})," Approve"]}),e.jsxs(It,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>O(P.id),children:[e.jsx(Ye,{className:"h-4 w-4"})," Reject"]})]})]})},P.id)),oe?null:e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(ct,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No pending requests"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"All funding requests have been processed."})]})]})}),e.jsxs(Ea,{title:"Premium: auto top-up",subtitle:"Threshold-based funding rules to keep services available.",right:e.jsx(Bt,{label:`${Ge.filter(P=>P.enabled).length} enabled`,tone:"info"}),children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(It,{variant:"outline",onClick:()=>{Ve({id:"",enabled:!0,walletId:T,thresholdUGX:15e5,topUpAmountUGX:2e6,maxPerDayUGX:4e6,requireApprovalOverUGX:5e6,method:"Bank transfer",notes:""}),ke(!0)},children:[e.jsx(pt,{className:"h-4 w-4"})," New rule"]}),e.jsxs(It,{variant:"primary",onClick:F,children:[e.jsx(Ar,{className:"h-4 w-4"})," Run simulation"]})]}),e.jsx("div",{className:"mt-3 space-y-2",children:Ge.slice(0,3).map(P=>{const X=N.find(h=>h.id===P.walletId),w=(X?Zi(X):0)<P.thresholdUGX;return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:P.id}),e.jsx(Bt,{label:P.enabled?"On":"Off",tone:P.enabled?"good":"neutral"}),e.jsx(Bt,{label:w?"Would trigger":"OK",tone:w?"warn":"good"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Wallet: ",(X==null?void 0:X.name)||P.walletId]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Threshold: ",Lt(P.thresholdUGX),"  Top-up: ",Lt(P.topUpAmountUGX),"  Max/day: ",Lt(P.maxPerDayUGX)]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Approval required over: ",Lt(P.requireApprovalOverUGX),"  Method: ",P.method]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(It,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Ve(P),ke(!0)},children:"Edit"}),e.jsxs(It,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Me(h=>h.map(K=>K.id===P.id?{...K,enabled:!K.enabled}:K)),children:[P.enabled?e.jsx(ra,{className:"h-4 w-4"}):e.jsx(ko,{className:"h-4 w-4"})," ",P.enabled?"Disable":"Enable"]})]})]}),P.notes?e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:P.notes}):null]},P.id)})})]})]})]}):null,i==="wallets"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Ea,{title:"Wallet settings",subtitle:"Funding thresholds and risk controls.",right:e.jsx(Bt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Ya,{label:"Large funding threshold (UGX)",value:ae,onChange:P=>ie(Math.max(0,P)),hint:"Above this requires approval"}),e.jsx(Ji,{enabled:_,onChange:W,label:"Freeze CorporatePay",description:"Risk control that blocks CorporatePay at checkout."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: fraud triggers can automatically freeze wallets and require step-up approval."})]}),e.jsxs(Ea,{title:"Multi-wallets",subtitle:"Premium: wallets per group and cost center. Allocate funds and enforce spend boundaries.",right:e.jsx(Bt,{label:`${N.length} wallets`,tone:"info"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Primary"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Wallet"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Type"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Target"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Balance"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Held"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Available"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsx("tbody",{children:p.map(P=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"radio",name:"primaryWallet",checked:T===P.id,onChange:()=>k(P.id),className:"h-4 w-4"})}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:P.name}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:P.type}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:P.type==="Group"?P.group:P.type==="Cost center"?P.costCenter:"Organization"}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Lt(P.balanceUGX)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Lt(P.heldUGX)}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Lt(Zi(P))}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Bt,{label:P.status,tone:P.status==="Frozen"?"bad":"good"})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(It,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>B(P),children:"Edit"}),e.jsxs(It,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ee(P.id),children:[P.status==="Frozen"?e.jsx(ko,{className:"h-4 w-4"}):e.jsx(ra,{className:"h-4 w-4"})," ",P.status==="Frozen"?"Unfreeze":"Freeze"]}),e.jsxs(It,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Qe(X=>({...X,kind:"Transfer",fromWalletId:T,toWalletId:P.id})),de(!0)},children:[e.jsx(Bp,{className:"h-4 w-4"})," Allocate"]}),e.jsx(It,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>Ke(P.id),children:e.jsx(Ye,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Updated ",$4(P.updatedAt)]})]})]},P.id))})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: cost center wallets help chargeback and improve reporting."})]})]}):null,i==="credit"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs(Ea,{title:"Credit line",subtitle:"Limit-based spend with repayment terms metadata.",right:e.jsx(Bt,{label:q.enabled?"Enabled":"Off",tone:q.enabled?"good":"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Ji,{enabled:q.enabled,onChange:P=>L(X=>({...X,enabled:P})),label:"Enable credit",description:"When enabled, credit can be used when allowed by policy."}),e.jsx(Ji,{enabled:q.delinquent,onChange:P=>L(X=>({...X,delinquent:P})),label:"Delinquent",description:"Simulate repayment delinquency (stops credit)."}),e.jsx(Ya,{label:"Credit limit (UGX)",value:q.limitUGX,onChange:P=>L(X=>({...X,limitUGX:Math.max(0,P)})),hint:Lt(q.limitUGX)}),e.jsx(Ya,{label:"Used (UGX)",value:q.usedUGX,onChange:P=>L(X=>({...X,usedUGX:uy(P,0,X.limitUGX)})),hint:Lt(q.usedUGX)})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx(F4,{pct:q.usedUGX/Math.max(1,q.limitUGX)*100,labelLeft:`Used ${Lt(q.usedUGX)}`,labelRight:`Limit ${Lt(q.limitUGX)}`}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Available: ",Lt(Ne)]})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Repayment terms"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Metadata for enterprise agreements."})]}),e.jsx(Bt,{label:q.repaymentTerms.cycle,tone:"neutral"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(hl,{label:"Cycle",value:q.repaymentTerms.cycle,onChange:P=>L(X=>({...X,repaymentTerms:{...X.repaymentTerms,cycle:P}})),options:["Weekly","Monthly"]}),e.jsx(Ya,{label:"Grace days",value:q.repaymentTerms.graceDays,onChange:P=>L(X=>({...X,repaymentTerms:{...X.repaymentTerms,graceDays:Math.max(0,P)}}))}),e.jsx(Nh,{label:"Terms metadata",value:q.repaymentTerms.metadata,onChange:P=>L(X=>({...X,repaymentTerms:{...X.repaymentTerms,metadata:P}})),placeholder:"Interest, fees, notes"})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(It,{variant:"outline",onClick:()=>b("Repay credit"),children:[e.jsx(Kk,{className:"h-4 w-4"})," Repay"]}),e.jsxs(It,{variant:"outline",onClick:()=>{const P=v({createdBy:"You",kind:"Limit increase",method:"Bank transfer",amountUGX:0,risk:"Medium",reason:"Request limit increase review",status:"Pending"});r({title:"Requested",message:`${P.id} limit review pending.",`,kind:"info"})},children:[e.jsx(pt,{className:"h-4 w-4"})," Request limit review"]})]})]})]})}),e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(Ea,{title:"Credit controls",subtitle:"Premium: risk controls and approval for large draws.",right:e.jsx(Bt,{label:"Premium",tone:"info"}),children:[e.jsx(Ya,{label:"Large funding threshold",value:ae,onChange:P=>ie(Math.max(0,P)),hint:"Shared setting"}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Large repayment events can require approvals. Delinquency triggers auto stop."})]})})]}):null,i==="prepaid"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs(Ea,{title:"Prepaid deposit",subtitle:"Spend down account. When depleted, services can stop automatically.",right:e.jsx(Bt,{label:R.enabled?"Enabled":"Off",tone:R.enabled?"good":"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Ji,{enabled:R.enabled,onChange:P=>U(X=>({...X,enabled:P})),label:"Enable prepaid",description:"Allow prepaid to be used as CorporatePay method."}),e.jsx(Ji,{enabled:R.stopWhenDepleted,onChange:P=>U(X=>({...X,stopWhenDepleted:P})),label:"Stop when depleted",description:"If on, prepaid depletion triggers a stop for prepaid payment model."}),e.jsx(Ya,{label:"Balance (UGX)",value:R.balanceUGX,onChange:P=>U(X=>({...X,balanceUGX:Math.max(0,P)})),hint:Lt(R.balanceUGX)}),e.jsx(Ya,{label:"Reserved (UGX)",value:R.reservedUGX,onChange:P=>U(X=>({...X,reservedUGX:uy(P,0,X.balanceUGX)})),hint:"Pending commitments"})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx(F4,{pct:M/Math.max(1,R.balanceUGX)*100,labelLeft:`Available ${Lt(M)}`,labelRight:`Total ${Lt(R.balanceUGX)}`}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Reserved: ",Lt(R.reservedUGX)]})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:[e.jsxs(It,{variant:"primary",onClick:()=>b("Prepaid deposit"),children:[e.jsx(pt,{className:"h-4 w-4"})," Add deposit"]}),e.jsxs(It,{variant:"outline",onClick:()=>{const P=Math.min(M,15e4);U(X=>({...X,balanceUGX:Math.max(0,X.balanceUGX-P)})),u({type:"Prepaid spend",amountUGX:-P,note:"Prepaid spend simulation"}),r({title:"Spent",message:`Prepaid spend ${Lt(P)}.",`,kind:"success"})},children:[e.jsx(Kk,{className:"h-4 w-4"})," Simulate spend"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"When prepaid is the default payment model, depletion can stop services immediately (if enabled)."})]})}),e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(Ea,{title:"Prepaid controls",subtitle:"Premium: approvals for large deposits and risk holds.",right:e.jsx(Bt,{label:"Premium",tone:"info"}),children:[e.jsx(Ya,{label:"Large deposit threshold",value:ae,onChange:P=>ie(Math.max(0,P)),hint:"Shared setting"}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Large deposits route to approvals. Risk holds can be placed at wallet level."})]})})]}):null,i==="funding"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs(Ea,{title:"Funding requests",subtitle:"Approvals for large events and sensitive operations.",right:e.jsx(Bt,{label:`${oe} pending`,tone:oe?"warn":"good"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(Nh,{label:"Search",value:He,onChange:_e,placeholder:"FR-1001, add funds..."}),e.jsx(hl,{label:"Status",value:le,onChange:P=>z(P),options:["All","Pending","Approved","Rejected"]})]}),e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"ID"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Kind"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Method"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Wallet"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Risk"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[De.map(P=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:P.id}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:P.kind}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Lt(P.amountUGX)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:P.method}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:P.walletId||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Bt,{label:P.risk,tone:U4(P.risk)})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Bt,{label:P.status,tone:l_(P.status)})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[P.status==="Pending"?e.jsxs(e.Fragment,{children:[e.jsxs(It,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>Q(P.id),children:[e.jsx(tt,{className:"h-4 w-4"})," Approve"]}),e.jsxs(It,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>O(P.id),children:[e.jsx(Ye,{className:"h-4 w-4"})," Reject"]})]}):e.jsx(Bt,{label:P.approvedBy?`By ${P.approvedBy}`:"Done",tone:"neutral"}),e.jsxs(It,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>r({title:"Details",message:`Reason: ${P.reason}`,kind:"info"}),children:[e.jsx(wt,{className:"h-4 w-4"})," Details"]})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:[yh(P.createdAt),"  ",P.createdBy]})]})]},P.id)),De.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No requests found."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: large funding events require approvals and show in Approvals Inbox (K)."})]})}),e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(Ea,{title:"Funding actions",subtitle:"Create requests or apply immediately under threshold.",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs(It,{variant:"outline",onClick:()=>b("Add funds"),children:[e.jsx(pt,{className:"h-4 w-4"})," Add funds"]}),e.jsxs(It,{variant:"outline",onClick:()=>b("Prepaid deposit"),children:[e.jsx(Wm,{className:"h-4 w-4"})," Prepaid deposit"]}),e.jsxs(It,{variant:"outline",onClick:()=>b("Repay credit"),children:[e.jsx($c,{className:"h-4 w-4"})," Repay credit"]}),e.jsxs(It,{variant:"outline",onClick:()=>b("Transfer"),children:[e.jsx(Bp,{className:"h-4 w-4"})," Transfer"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Funding rules: approvals are triggered by threshold and risk settings."})]})})]}):null,i==="autotopup"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs(Ea,{title:"Auto top-up rules",subtitle:"Premium: threshold-based top ups with max per day safeguards.",right:e.jsx(Bt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(It,{variant:"primary",onClick:()=>{Ve({id:"",enabled:!0,walletId:T,thresholdUGX:15e5,topUpAmountUGX:2e6,maxPerDayUGX:4e6,requireApprovalOverUGX:5e6,method:"Bank transfer",notes:""}),ke(!0)},children:[e.jsx(pt,{className:"h-4 w-4"})," New rule"]}),e.jsxs(It,{variant:"outline",onClick:F,children:[e.jsx(Ar,{className:"h-4 w-4"})," Run simulation"]})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[Ge.map(P=>{var X;return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:P.id}),e.jsx(Bt,{label:P.enabled?"On":"Off",tone:P.enabled?"good":"neutral"}),e.jsx(Bt,{label:P.method,tone:"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Wallet: ",((X=N.find(S=>S.id===P.walletId))==null?void 0:X.name)||P.walletId]}),e.jsxs("div",{className:"mt-2 grid grid-cols-1 gap-2 sm:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Trigger"}),e.jsxs("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:["Below ",Lt(P.thresholdUGX)]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Top-up"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:Lt(P.topUpAmountUGX)})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Max per day"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:Lt(P.maxPerDayUGX)})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Approval over"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:Lt(P.requireApprovalOverUGX)})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(It,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Ve(P),ke(!0)},children:"Edit"}),e.jsxs(It,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Me(S=>S.map(w=>w.id===P.id?{...w,enabled:!w.enabled}:w)),children:[P.enabled?e.jsx(ra,{className:"h-4 w-4"}):e.jsx(ko,{className:"h-4 w-4"})," ",P.enabled?"Disable":"Enable"]})]})]}),P.notes?e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:P.notes}):null]},P.id)}),Ge.length?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No rules configured."})]})]})}),e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsx(Ea,{title:"Notes",subtitle:"How auto top-up behaves.",children:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"1) If wallet available balance drops below threshold, a top-up is created"}),e.jsx("li",{children:"2) If top-up amount is above approval threshold, request goes to approvals"}),e.jsx("li",{children:"3) Max per day is a safeguard, enforced by policy in production"})]})})})})]}):null,i==="risk"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-7 space-y-4",children:[e.jsxs(Ea,{title:"Risk controls",subtitle:"Premium: freeze, holds, fraud triggers, and approvals for large events.",right:e.jsx(Bt,{label:"Premium",tone:"info"}),children:[e.jsx(Ji,{enabled:_,onChange:W,label:"Freeze CorporatePay",description:"Stops CorporatePay at checkout. No silent actions and always audited."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Ya,{label:"Large funding approval threshold",value:ae,onChange:P=>ie(Math.max(0,P)),hint:"Shared across funding"}),e.jsx(Ya,{label:"Invoice overdue days (simulate)",value:J.invoiceOverdueDays,onChange:P=>we(X=>({...X,invoiceOverdueDays:Math.max(0,P)})),hint:"Impacts enforcement",disabled:!J.enabled})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Fraud triggers examples: unusual funding frequency, repeated failed repayments, high value RFQ holds."})]}),e.jsx(Ea,{title:"Risk events",subtitle:"Investigate and resolve.",right:e.jsx(Bt,{label:`${Oe.filter(P=>P.status==="Open").length} open`,tone:"warn"}),children:e.jsxs("div",{className:"space-y-2",children:[Oe.slice().sort((P,X)=>P.status===X.status?X.createdAt-P.createdAt:P.status==="Open"?-1:1).map(P=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Bt,{label:P.severity,tone:P.severity==="Critical"?"bad":P.severity==="Warning"?"warn":"info"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:P.title}),e.jsx(Bt,{label:P.status,tone:P.status==="Open"?"warn":"good"})]}),e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:P.details}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:[yh(P.createdAt),"  ",$4(P.createdAt),P.walletId?`  Wallet ${P.walletId}`:""]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[P.status==="Open"?e.jsxs(It,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>m(P.id),children:[e.jsx(tt,{className:"h-4 w-4"})," Resolve"]}):e.jsx(Bt,{label:"Resolved",tone:"good"}),e.jsxs(It,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>r({title:"Audit",message:"In production, this opens a full audit view.",kind:"info"}),children:[e.jsx(wt,{className:"h-4 w-4"})," Audit"]})]})]})},P.id)),Oe.length?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No risk events."})]})})]}),e.jsxs("div",{className:"lg:col-span-5 space-y-4",children:[e.jsxs(Ea,{title:"Enforcement summary",subtitle:"Auto stop when agreements are not complied with.",children:[e.jsxs("div",{className:Wa("rounded-3xl border p-4",H.status==="Hard stop"?"border-rose-200 bg-rose-50":H.status==="Soft stop"?"border-amber-200 bg-amber-50":"border-emerald-200 bg-emerald-50"),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:["Status: ",H.status]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-700",children:["Enforcement ",H.enabled?"enabled":"disabled","  Invoice grace ",J.invoiceGraceDays," day(s)"]})]}),e.jsx(Bt,{label:H.enabled?"On":"Off",tone:H.enabled?"info":"neutral"})]}),H.reasons.length?e.jsxs("div",{className:"mt-3 rounded-2xl bg-white/60 p-3 text-xs text-slate-700",children:[e.jsx("div",{className:"font-semibold",children:"Reasons"}),e.jsx("ul",{className:"mt-2 space-y-1",children:H.reasons.slice(0,8).map((P,X)=>e.jsxs("li",{children:[" ",P]},X))})]}):e.jsx("div",{className:"mt-3 text-xs text-slate-700",children:"No enforcement issues detected."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Policy-backed enforcement is recommended for corporate compliance and predictable spend."})]}),e.jsx(Ea,{title:"Quick tests",subtitle:"Simulate agreement issues and observe enforcement changes.",children:e.jsxs("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2",children:[e.jsxs(It,{variant:"outline",onClick:()=>{we(P=>({...P,invoiceOverdueDays:P.invoiceGraceDays+3})),r({title:"Simulated",message:"Invoice overdue beyond grace.",kind:"warn"})},children:[e.jsx(Dn,{className:"h-4 w-4"})," Simulate overdue"]}),e.jsxs(It,{variant:"outline",onClick:()=>{we(P=>({...P,invoiceOverdueDays:0})),r({title:"Reset",message:"Invoice overdue cleared.",kind:"info"})},children:[e.jsx(Ar,{className:"h-4 w-4"})," Clear overdue"]}),e.jsxs(It,{variant:"outline",onClick:()=>{$(P=>P.map(X=>X.id===T?{...X,balanceUGX:0,heldUGX:0}:X)),r({title:"Simulated",message:"Primary wallet depleted.",kind:"warn"})},children:[e.jsx($a,{className:"h-4 w-4"})," Deplete wallet"]}),e.jsxs(It,{variant:"outline",onClick:()=>{L(P=>({...P,delinquent:!0})),r({title:"Simulated",message:"Credit marked delinquent.",kind:"warn"})},children:[e.jsx($c,{className:"h-4 w-4"})," Delinquent credit"]})]})})]})]}):null,i==="ledger"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs(Ea,{title:"Ledger",subtitle:"All wallet, credit and prepaid movements.",right:e.jsx(Bt,{label:`${je.length} entries`,tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx(Nh,{label:"Search",value:ne,onChange:Te,placeholder:"LG-001, hold, funding..."}),e.jsx(hl,{label:"Type",value:Ee,onChange:P=>Re(P),options:["All",...Array.from(new Set(je.map(P=>P.type)))]}),e.jsx(hl,{label:"Wallet",value:ze,onChange:qe,options:["All",...E],hint:"Optional"})]}),e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"ID"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Type"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Wallet"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Note"})]})}),e.jsxs("tbody",{children:[$e.map(P=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:P.id}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:yh(P.at)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Bt,{label:P.type,tone:"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:P.walletId||"-"}),e.jsx("td",{className:Wa("px-4 py-3 font-semibold",P.amountUGX<0?"text-rose-700":"text-slate-900"),children:P.amountUGX<0?`-${Lt(Math.abs(P.amountUGX))}`:Lt(P.amountUGX)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:P.note})]},P.id)),$e.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No ledger entries."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: ledger exports can be pushed to ERP via secure API."})]})}),e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(Ea,{title:"Export",subtitle:"Export transactions for accounting.",right:e.jsx(Bt,{label:"ERP-ready",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs(It,{variant:"outline",onClick:A,children:[e.jsx(gt,{className:"h-4 w-4"})," Export JSON"]}),e.jsxs(It,{variant:"outline",onClick:()=>{r({title:"Export",message:"CSV/PDF export would be generated in production.",kind:"info"})},children:[e.jsx(wt,{className:"h-4 w-4"})," Export CSV/PDF"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Best practice: use invoice group AP codes for ERP mapping."})]})})]}):null,null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"M Corporate Wallet, Credit Line and Prepaid Funding v2: three payment models, funding actions, credit metadata, prepaid stop, approvals, auto top-up, multi-wallets, risk controls, and enforcement."})})]})}),e.jsx(Qv,{open:Y,title:ce.id?"Edit wallet":"Create wallet",subtitle:"Premium: multi-wallets per group and cost center.",onClose:()=>Ie(!1),actions:[...ce.id?[{label:"Delete",onClick:()=>{Ke(ce.id),Ie(!1)},variant:"danger"}]:[],{label:"Save",onClick:ue}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(It,{variant:"outline",onClick:()=>Ie(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[ce.id?e.jsxs(It,{variant:"danger",onClick:()=>{Ke(ce.id),Ie(!1)},children:[e.jsx(Ye,{className:"h-4 w-4"})," Delete"]}):null,e.jsxs(It,{variant:"primary",onClick:ue,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Nh,{label:"Name",value:ce.name,onChange:P=>me(X=>({...X,name:P})),placeholder:"Wallet name"}),e.jsx(hl,{label:"Type",value:ce.type,onChange:P=>{const X=P;me(S=>({...S,type:X,group:X==="Group"?S.group||"Operations":void 0,costCenter:X==="Cost center"?S.costCenter||"OPS-001":void 0}))},options:["Org","Group","Cost center"]}),e.jsx(hl,{label:"Group",value:ce.group||"Operations",onChange:P=>me(X=>({...X,group:P})),options:s,disabled:ce.type!=="Group"}),e.jsx(hl,{label:"Cost center",value:ce.costCenter||"OPS-001",onChange:P=>me(X=>({...X,costCenter:P})),options:a,disabled:ce.type!=="Cost center"}),e.jsx(Ya,{label:"Balance (UGX)",value:ce.balanceUGX,onChange:P=>me(X=>({...X,balanceUGX:Math.max(0,P)})),hint:Lt(ce.balanceUGX)}),e.jsx(Ya,{label:"Held (UGX)",value:ce.heldUGX,onChange:P=>me(X=>({...X,heldUGX:Math.max(0,P)})),hint:"Holds reserve funds"}),e.jsx(hl,{label:"Status",value:ce.status,onChange:P=>me(X=>({...X,status:P})),options:["Active","Frozen"]}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"In production, cost center wallets map to chargeback and ERP exports."})]})}),e.jsx(Qv,{open:pe,title:ye.kind,subtitle:"Funding actions with approvals for large events.",onClose:()=>de(!1),actions:[{label:"Submit",onClick:C}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(It,{variant:"outline",onClick:()=>de(!1),children:"Cancel"}),e.jsxs(It,{variant:"primary",onClick:C,children:[e.jsx(tt,{className:"h-4 w-4"})," Submit"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(hl,{label:"Action",value:ye.kind,onChange:P=>Qe(X=>({...X,kind:P})),options:["Add funds","Transfer","Repay credit","Prepaid deposit"]}),e.jsx(hl,{label:"Method",value:ye.method,onChange:P=>Qe(X=>({...X,method:P})),options:["Bank transfer","Mobile money","Card","Internal transfer"],hint:ye.kind==="Transfer"?"Internal transfer":"Funding method",disabled:ye.kind==="Transfer"}),ye.kind==="Transfer"?e.jsxs(e.Fragment,{children:[e.jsx(hl,{label:"From wallet",value:ye.fromWalletId,onChange:P=>Qe(X=>({...X,fromWalletId:P})),options:E}),e.jsx(hl,{label:"To wallet",value:ye.toWalletId,onChange:P=>Qe(X=>({...X,toWalletId:P})),options:E})]}):ye.kind==="Add funds"?e.jsx(hl,{label:"Wallet",value:ye.toWalletId,onChange:P=>Qe(X=>({...X,toWalletId:P})),options:E}):null,e.jsx(Ya,{label:"Amount (UGX)",value:ye.amountUGX,onChange:P=>Qe(X=>({...X,amountUGX:Math.max(0,P)})),hint:Lt(ye.amountUGX)}),e.jsx(hl,{label:"Risk",value:ye.risk,onChange:P=>Qe(X=>({...X,risk:P})),options:["Low","Medium","High"],hint:"Premium safeguards"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(L4,{label:"Reason",value:ye.reason,onChange:P=>Qe(X=>({...X,reason:P})),placeholder:"Example: month-start top up for operations",hint:"Minimum 8 characters",rows:4})}),e.jsxs("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:["Approval required if amount is above ",Lt(ae)," or if risk controls demand it."]})]})}),e.jsx(Qv,{open:Fe,title:fe.id?"Edit auto top-up":"New auto top-up",subtitle:"Premium: threshold-based top up rule with max per day.",onClose:()=>ke(!1),actions:[{label:"Save",onClick:D}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(It,{variant:"outline",onClick:()=>ke(!1),children:"Cancel"}),e.jsxs(It,{variant:"primary",onClick:D,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Ji,{enabled:fe.enabled,onChange:P=>Ve(X=>({...X,enabled:P})),label:"Enabled",description:"If off, rule will not trigger."}),e.jsx(hl,{label:"Wallet",value:fe.walletId,onChange:P=>Ve(X=>({...X,walletId:P})),options:E}),e.jsx(Ya,{label:"Trigger threshold (UGX)",value:fe.thresholdUGX,onChange:P=>Ve(X=>({...X,thresholdUGX:Math.max(0,P)})),hint:Lt(fe.thresholdUGX)}),e.jsx(Ya,{label:"Top-up amount (UGX)",value:fe.topUpAmountUGX,onChange:P=>Ve(X=>({...X,topUpAmountUGX:Math.max(0,P)})),hint:Lt(fe.topUpAmountUGX)}),e.jsx(Ya,{label:"Max per day (UGX)",value:fe.maxPerDayUGX,onChange:P=>Ve(X=>({...X,maxPerDayUGX:Math.max(0,P)})),hint:Lt(fe.maxPerDayUGX)}),e.jsx(Ya,{label:"Approval required over (UGX)",value:fe.requireApprovalOverUGX,onChange:P=>Ve(X=>({...X,requireApprovalOverUGX:Math.max(0,P)})),hint:"Creates funding request"}),e.jsx(hl,{label:"Method",value:fe.method,onChange:P=>Ve(X=>({...X,method:P})),options:["Bank transfer","Mobile money","Card"]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(L4,{label:"Notes",value:fe.notes,onChange:P=>Ve(X=>({...X,notes:P})),placeholder:"Explain rule intent",rows:3})})]})})]});function y({title:P,value:X,sub:S,icon:w,tone:h}){const K=h==="good"?"bg-emerald-50 text-emerald-700":h==="warn"?"bg-amber-50 text-amber-800":h==="bad"?"bg-rose-50 text-rose-700":h==="info"?"bg-blue-50 text-blue-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:P}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:X}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:S})]}),e.jsx("div",{className:Wa("grid h-10 w-10 place-items-center rounded-2xl",K),children:w})]})})}function re({icon:P,title:X,subtitle:S,on:w,onToggle:h,selected:K,onSelect:V,bullets:Ce}){return e.jsxs("div",{className:Wa("rounded-3xl border bg-white p-4",K?"border-emerald-300 ring-4 ring-emerald-100":"border-slate-200"),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-slate-50 text-slate-700 ring-1 ring-slate-200",children:P}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:X}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:S})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsx(Bt,{label:w?"Enabled":"Off",tone:w?"good":"neutral"}),e.jsx("button",{type:"button",className:Wa("relative h-7 w-12 rounded-full border transition",w?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:h,"aria-label":"Toggle",children:e.jsx("span",{className:Wa("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",w?"left-[22px]":"left-1")})})]})]}),e.jsx("ul",{className:"mt-3 space-y-1 text-xs text-slate-600",children:Ce.map(I=>e.jsxs("li",{children:[" ",I]},I))}),e.jsx("div",{className:"mt-4",children:e.jsxs(It,{variant:K?"primary":"outline",className:"w-full",onClick:V,disabled:!w,title:w?"":"Enable this model first",children:[e.jsx(ct,{className:"h-4 w-4"})," Set as default"]})})]})}function ve({icon:P,title:X,subtitle:S,onClick:w}){return e.jsx("button",{type:"button",onClick:w,className:"rounded-3xl border border-slate-200 bg-white p-4 text-left hover:bg-slate-50",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-emerald-50 text-emerald-700 ring-1 ring-emerald-200",children:P}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:X}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:S})]})]}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]})})}}const vr={green:"#03CD8C",orange:"#F77F00"};function Cl(...t){return t.filter(Boolean).join(" ")}function ld(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function Jv(t,s,a){return Math.max(s,Math.min(a,t))}function Ni(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function Sd(t){return t.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"2-digit"})}function j0(t,s){const a=new Date(t);return a.setDate(a.getDate()+s),a}function BE(t){const[s,a]=t.split("-").map(l=>Number(l));return new Date(s,(a||1)-1,1,10,0,0,0)}function GE(t){const s=BE(t),a=new Date(s);return a.setMonth(a.getMonth()+1),a.setDate(0),a}function r_(t){return GE(t).getDate()}function i_(t,s){const a=r_(s);return t==="Daily"?a:t==="Weekly"?Math.max(1,Math.round(a/7)):t==="Monthly"?1:2}function V4(t,s){const a=BE(s);return t==="Monthly"?a:t==="Weekly"?j0(a,6):t==="Daily"?j0(a,0):j0(a,14)}function _4(t,s){return s.mode==="DueOnReceipt"?t:s.mode==="EOM"?GE(`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`):j0(t,Math.max(0,s.netDays))}function qE(t,s){if(!t.vatEnabled||t.vatRatePct<=0)return{vat:0,subtotal:s};const a=t.vatRatePct/100;if(t.vatInclusive){const r=s-s/(1+a),i=s-r;return{vat:r,subtotal:i}}return{vat:s*a,subtotal:s}}function ta({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Cl("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Zt({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:vr.green}:t==="accent"?{background:vr.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Cl(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function nd({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:Cl("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:Cl("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function Ja({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:Cl(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:Cl("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function eo({label:t,value:s,onChange:a,hint:l,disabled:n}){return e.jsxs("div",{className:Cl(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",value:s,onChange:r=>a(Number(r.target.value||0)),disabled:n,className:Cl("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function Ir({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:Cl(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:Cl("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i,children:i},i))})]})}function hc({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4,disabled:i}){return e.jsxs("div",{className:Cl(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:o=>a(o.target.value),placeholder:l,rows:r,disabled:i,className:Cl("mt-2 w-full rounded-2xl border p-3 text-sm font-semibold shadow-sm outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function o_({actions:t}){const[s,a]=d.useState(!1);return e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 focus:bg-slate-100 focus:outline-none",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>a(!1)}),e.jsx("div",{className:"absolute right-0 top-full z-40 mt-1 w-48 overflow-hidden rounded-xl border border-slate-200 bg-white shadow-xl ring-1 ring-slate-200",children:t.map((l,n)=>e.jsx("button",{onClick:()=>{l.onClick(),a(!1)},className:Cl("block w-full px-4 py-2.5 text-left text-sm font-medium transition hover:bg-slate-50",l.variant==="danger"?"text-rose-700 hover:bg-rose-50":"text-slate-700"),children:l.label},n))})]})]})}function wh({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="920px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[8vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-1",children:[o?e.jsx(o_,{actions:o}):null,e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function d_({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Cl("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(vn,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function to({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function c_({entity:t,template:s,invoiceNo:a,issueDate:l,dueDate:n,terms:r,lines:i}){const o=d.useMemo(()=>{let x=0,j=0;for(const N of i){const $=qE(t,N.amountUGX);x+=$.subtotal,j+=$.vat}const g=(t.vatEnabled&&!t.vatInclusive,x+j);return{subtotal:x,vat:j,total:g}},[t,i]),c=d.useMemo(()=>r.mode==="DueOnReceipt"?"Due on receipt":r.mode==="EOM"?"Due end of month":`Net ${r.netDays}`,[r]);return e.jsxs("div",{className:"overflow-hidden rounded-[24px] border border-slate-200 bg-white",children:[e.jsxs("div",{className:"px-5 py-4",style:{background:"linear-gradient(135deg, rgba(3,205,140,0.12), rgba(255,255,255,0))"},children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Cl("grid h-11 w-11 place-items-center rounded-2xl text-white",s.showLogo?"":"opacity-70"),style:{background:s.accent||vr.green},children:e.jsx(wt,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:s.brandName||"CorporatePay"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Invoice"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Invoice No"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:a})]})]}),s.headerNote?e.jsx("div",{className:"mt-3 rounded-2xl bg-white/70 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:s.headerNote}):null]}),e.jsxs("div",{className:"px-5 py-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"From"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:t.legalName}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:[t.address1,t.address2?`, ${t.address2}`:"",e.jsx("br",{}),t.city,", ",t.country,e.jsx("br",{}),"Tax ID: ",t.taxId||"-","  VAT: ",t.vatNo||"-"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Dates"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Issue: ",e.jsx("span",{className:"font-semibold text-slate-900",children:Sd(l)})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Due: ",e.jsx("span",{className:"font-semibold text-slate-900",children:Sd(n)})]}),e.jsx("div",{className:"mt-2",children:e.jsx(ta,{label:c,tone:"info"})})]})]}),e.jsx("div",{className:"mt-4 overflow-hidden rounded-2xl border border-slate-200",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Description"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Module"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"})]})}),e.jsxs("tbody",{children:[i.slice(0,6).map(x=>e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:x.description}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[x.module,x.marketplace?`  ${x.marketplace}`:""]}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Ni(x.amountUGX)})]},x.id)),i.length>6?e.jsx("tr",{className:"border-t border-slate-100",children:e.jsxs("td",{className:"px-4 py-3 text-xs text-slate-600",colSpan:3,children:["+ ",i.length-6," more line(s)"]})}):null]})]})}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Payment instructions"}),e.jsx("div",{className:"mt-1 text-slate-700",children:s.paymentInstructions||"-"})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-600",children:[e.jsx("span",{className:"font-semibold",children:"Subtotal"}),e.jsx("span",{className:"font-semibold text-slate-900",children:Ni(o.subtotal)})]}),s.showVatLine?e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs text-slate-600",children:[e.jsx("span",{className:"font-semibold",children:"VAT"}),e.jsx("span",{className:"font-semibold text-slate-900",children:Ni(o.vat)})]}):null,e.jsxs("div",{className:"mt-2 flex items-center justify-between text-sm text-slate-900",children:[e.jsx("span",{className:"font-semibold",children:"Total"}),e.jsx("span",{className:"font-semibold",children:Ni(o.total)})]})]})]}),s.footerText?e.jsx("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:s.footerText}):null]})]})}function u_(){const[t,s]=d.useState([]),a=v=>{const u=ld("toast");s(C=>[{id:u,...v},...C].slice(0,4)),window.setTimeout(()=>s(C=>C.filter(Q=>Q.id!==u)),3200)},[l,n]=d.useState("invoiceGroups"),[r,i]=d.useState({mode:"Net",netDays:7,earlyDiscountPct:0,earlyDiscountDays:0,lateFeeText:"Late fees apply as per agreement."}),[o,c]=d.useState(()=>[{id:"ENT-UG",name:"Uganda HQ",legalName:"Acme Group Limited (Uganda)",country:"Uganda",city:"Kampala",address1:"Plot 12, Nkrumah Road",address2:"Suite 5",currency:"UGX",taxId:"TIN-123-456-789",vatNo:"VAT-UG-00991",vatEnabled:!0,vatRatePct:18,vatInclusive:!1,billingEmail:"ap-ug@acme.com",phone:"+256 700 000 000",isPrimary:!0},{id:"ENT-CN",name:"China Branch",legalName:"Acme Group Co., Ltd. (China)",country:"China",city:"Wuxi",address1:"Room 265, No. 3 Gaolang East Road",address2:"Xinwu District",currency:"CNY",taxId:"CN-TAX-0001",vatNo:"CN-VAT-0001",vatEnabled:!0,vatRatePct:13,vatInclusive:!1,billingEmail:"ap-cn@acme.com",phone:"+86 177 0000 0000",isPrimary:!1}]),[x,j]=d.useState(()=>[{id:"TPL-01",name:"Default modern",brandName:"EVzone CorporatePay",accent:vr.green,showLogo:!0,headerNote:"Thank you for your business.",footerText:"This invoice is generated electronically and is valid without signature.",paymentInstructions:"Pay via bank transfer. Reference the invoice number.",showVatLine:!0,layout:"Modern"},{id:"TPL-02",name:"Finance classic",brandName:"EVzone CorporatePay",accent:vr.orange,showLogo:!0,headerNote:"Accounts Payable: please include cost code on remittance advice.",footerText:"Payment terms apply as agreed.",paymentInstructions:"Bank transfer only. Contact finance for details.",showVatLine:!0,layout:"Classic"}]),[g,N]=d.useState(()=>{const v=Date.now();return[{id:"IG-MAIN-UG",name:"Main corporate",entityId:"ENT-UG",frequency:"Weekly",customRule:"",apTo:"ap@acme.com",apCc:"finance@acme.com",costCode:"ACME-MAIN",templateId:"TPL-01",prefix:"ACME",nextSequence:1042,paymentTermsOverrideEnabled:!1,status:"Active",lastInvoicedAt:v-7*24*60*60*1e3,nextInvoiceAt:v+2*24*60*60*1e3,notes:"Primary stream for Uganda HQ."},{id:"IG-SALES-TRAVEL",name:"Sales travel",entityId:"ENT-UG",frequency:"Monthly",customRule:"",apTo:"sales-ap@acme.com",apCc:"finance@acme.com",costCode:"ACME-SALES",templateId:"TPL-02",prefix:"ACME-SALES",nextSequence:88,paymentTermsOverrideEnabled:!0,paymentTermsOverride:{mode:"Net",netDays:14,earlyDiscountPct:0,earlyDiscountDays:0,lateFeeText:"Late fees apply."},status:"Active",lastInvoicedAt:v-28*24*60*60*1e3,nextInvoiceAt:v+3*24*60*60*1e3,notes:"Sales commutes and client rides."},{id:"IG-CN-PROC",name:"China procurement",entityId:"ENT-CN",frequency:"Weekly",customRule:"",apTo:"ap-cn@acme.com",apCc:"finance@acme.com",costCode:"CN-PROC",templateId:"TPL-01",prefix:"ACME-CN",nextSequence:221,paymentTermsOverrideEnabled:!1,status:"Active",lastInvoicedAt:v-8*24*60*60*1e3,nextInvoiceAt:v+1*24*60*60*1e3,notes:"Separate legal entity stream."}]}),$=d.useMemo(()=>{const v=(u,C,Q,O,ee)=>({id:u,description:C,module:Q,marketplace:ee,amountUGX:O});return{"IG-MAIN-UG":[v("L1","Corporate rides","Rides & Logistics",82e5),v("L2","EV charging credits","EVs & Charging",41e5),v("L3","EVmart purchases","E-Commerce",24e5,"EVmart"),v("L4","MyLiveDealz deals","E-Commerce",31e5,"MyLiveDealz")],"IG-SALES-TRAVEL":[v("L1","Sales travel rides","Rides & Logistics",52e5)],"IG-CN-PROC":[v("L1","GadgetMart procurement","E-Commerce",6e6,"GadgetMart"),v("L2","ExpressMart logistics","E-Commerce",11e5,"ExpressMart")]}},[]),[T,k]=d.useState(()=>{const v=new Date,u=new Date(v);return u.setMonth(u.getMonth()+1),`${u.getFullYear()}-${String(u.getMonth()+1).padStart(2,"0")}`}),[q,L]=d.useState(!0),[R,U]=d.useState(()=>JSON.parse(JSON.stringify($))),[ae,ie]=d.useState(!1),[_,W]=d.useState(()=>({id:"",name:"",legalName:"",country:"",city:"",address1:"",address2:"",currency:"UGX",taxId:"",vatNo:"",vatEnabled:!0,vatRatePct:18,vatInclusive:!1,billingEmail:"",phone:"",isPrimary:!1})),[J,we]=d.useState(!1),[G,be]=d.useState(()=>({id:"",name:"",brandName:"EVzone CorporatePay",accent:vr.green,showLogo:!0,headerNote:"",footerText:"",paymentInstructions:"",showVatLine:!0,layout:"Modern"})),[Ge,Me]=d.useState(!1),[je,Ue]=d.useState(()=>({id:"",name:"",entityId:"ENT-UG",frequency:"Monthly",customRule:"",apTo:"",apCc:"",costCode:"",templateId:"TPL-01",prefix:"INV",nextSequence:1,paymentTermsOverrideEnabled:!1,paymentTermsOverride:void 0,status:"Active",notes:""})),[Oe,he]=d.useState(()=>{var v;return((v=g[0])==null?void 0:v.id)||""}),[Y,Ie]=d.useState(!1),[ce,me]=d.useState({...r}),pe=d.useMemo(()=>{const v={};return o.forEach(u=>v[u.id]=u),v},[o]),de=d.useMemo(()=>{const v={};return x.forEach(u=>v[u.id]=u),v},[x]),ye=d.useMemo(()=>{const v={};return g.forEach(u=>v[u.id]=u),v},[g]),Qe=d.useMemo(()=>{const v=g.filter(u=>u.status==="Active"&&u.nextInvoiceAt).map(u=>u.nextInvoiceAt).sort((u,C)=>u-C);return v.length?new Date(v[0]):null},[g]),Fe=d.useMemo(()=>g.filter(v=>v.status==="Active").map(v=>{const u=pe[v.entityId],C=R[v.id]||[],Q=i_(v.frequency,T);let O=0,ee=0;for(const ve of C){const P=qE(u,ve.amountUGX);O+=P.subtotal,ee+=P.vat}const F=V4(v.frequency,T),D=v.paymentTermsOverrideEnabled&&v.paymentTermsOverride?v.paymentTermsOverride:r,m=_4(F,D),A=O,f=q?ee:0,B=A+f,p=Math.round(A/Math.max(1,Q)),E=Math.round(f/Math.max(1,Q)),se=p+E,y=v.nextSequence,re=`${v.prefix}-${T.replace("-","")}-${String(y).padStart(4,"0")}`;return{invoiceGroupId:v.id,entityId:v.entityId,month:T,cyclesInMonth:Q,monthSubtotal:A,monthVat:f,monthTotal:B,perCycleSubtotal:p,perCycleVat:E,perCycleTotal:se,invoiceNoPreview:re,issueDate:F,dueDate:m,lineItems:C}}).sort((v,u)=>v.entityId.localeCompare(u.entityId)||v.invoiceGroupId.localeCompare(u.invoiceGroupId)),[g,pe,R,T,q,r]),ke=d.useMemo(()=>Fe.reduce((v,u)=>v+u.monthTotal,0),[Fe]),fe=()=>{const v={entities:o,templates:x,invoiceGroups:g,paymentTerms:r,simulation:{month:T,includeVat:q,linesByGroup:R},exportedAt:new Date().toISOString()},u=JSON.stringify(v,null,2),C=new Blob([u],{type:"application/json"}),Q=URL.createObjectURL(C),O=document.createElement("a");O.href=Q,O.download="corporatepay-billing-setup.json",O.click(),URL.revokeObjectURL(Q),a({title:"Exported",message:"Downloaded billing configuration.",kind:"success"})},Ve=()=>a({title:"Saved",message:"Billing setup saved (demo).",kind:"success"}),ne=()=>{W({id:"",name:"",legalName:"",country:"",city:"",address1:"",address2:"",currency:"UGX",taxId:"",vatNo:"",vatEnabled:!0,vatRatePct:18,vatInclusive:!1,billingEmail:"",phone:"",isPrimary:!1}),ie(!0)},Te=v=>{W(JSON.parse(JSON.stringify(v))),ie(!0)},Ee=()=>{if(!_.name.trim()||!_.legalName.trim()||!_.country.trim()){a({title:"Missing fields",message:"Entity name, legal name, and country are required.",kind:"warn"});return}const v=_.id||ld("ENT");c(u=>{let C=u.slice();_.isPrimary&&(C=C.map(ee=>({...ee,isPrimary:!1})));const Q=C.findIndex(ee=>ee.id===v),O={..._,id:v};return Q>=0?C[Q]=O:C.unshift(O),C}),a({title:"Saved",message:"Entity saved.",kind:"success"}),ie(!1)},Re=v=>{const u=o.find(Q=>Q.id===v);if(u!=null&&u.isPrimary){a({title:"Blocked",message:"You cannot delete the primary entity.",kind:"warn"});return}if(g.some(Q=>Q.entityId===v)){a({title:"Blocked",message:"Entity is used by an invoice group.",kind:"warn"});return}c(Q=>Q.filter(O=>O.id!==v)),a({title:"Deleted",message:"Entity deleted.",kind:"info"})},ze=()=>{be({id:"",name:"",brandName:"EVzone CorporatePay",accent:vr.green,showLogo:!0,headerNote:"",footerText:"",paymentInstructions:"Pay via bank transfer. Reference the invoice number.",showVatLine:!0,layout:"Modern"}),we(!0)},qe=v=>{be(JSON.parse(JSON.stringify(v))),we(!0)},He=()=>{if(!G.name.trim()){a({title:"Missing name",message:"Template name is required.",kind:"warn"});return}const v=G.id||ld("TPL"),u={...G,id:v};j(C=>{const Q=C.slice(),O=Q.findIndex(ee=>ee.id===v);return O>=0?Q[O]=u:Q.unshift(u),Q}),a({title:"Saved",message:"Template saved.",kind:"success"}),we(!1)},_e=v=>{if(g.some(C=>C.templateId===v)){a({title:"Blocked",message:"Template is used by an invoice group.",kind:"warn"});return}j(C=>C.filter(Q=>Q.id!==v)),a({title:"Deleted",message:"Template deleted.",kind:"info"})},le=v=>{const u=x.find(Q=>Q.id===v);if(!u)return;const C={...JSON.parse(JSON.stringify(u)),id:ld("TPL"),name:`${u.name} (Copy)`};j(Q=>[C,...Q]),a({title:"Duplicated",message:"Template duplicated.",kind:"success"})},z=()=>{var v,u,C;Ue({id:"",name:"",entityId:((v=o.find(Q=>Q.isPrimary))==null?void 0:v.id)||((u=o[0])==null?void 0:u.id)||"",frequency:"Monthly",customRule:"",apTo:"",apCc:"",costCode:"",templateId:((C=x[0])==null?void 0:C.id)||"",prefix:"INV",nextSequence:1,paymentTermsOverrideEnabled:!1,paymentTermsOverride:void 0,status:"Active",notes:""}),Me(!0)},Pe=v=>{Ue(JSON.parse(JSON.stringify(v))),Me(!0)},Be=()=>{if(!je.name.trim()||!je.apTo.trim()||!je.costCode.trim()){a({title:"Missing fields",message:"Group name, AP recipient, and cost code are required.",kind:"warn"});return}const v=je.id||ld("IG"),u={...je,id:v};u.paymentTermsOverrideEnabled&&!u.paymentTermsOverride&&(u.paymentTermsOverride={...r}),N(C=>{const Q=C.slice(),O=Q.findIndex(ee=>ee.id===v);return O>=0?Q[O]=u:Q.unshift(u),Q}),a({title:"Saved",message:"Invoice group saved.",kind:"success"}),Me(!1)},xe=v=>{N(u=>u.filter(C=>C.id!==v)),a({title:"Deleted",message:"Invoice group deleted.",kind:"info"})},Ne=v=>{const u=g.find(Q=>Q.id===v);if(!u)return;const C={...JSON.parse(JSON.stringify(u)),id:ld("IG"),name:`${u.name} (Copy)`,nextSequence:1};N(Q=>[C,...Q]),a({title:"Cloned",message:"Invoice group cloned.",kind:"success"})},M=v=>{N(u=>u.map(C=>C.id===v?{...C,status:C.status==="Active"?"Paused":"Active"}:C)),a({title:"Updated",message:"Invoice group status updated.",kind:"info"})},H=()=>{const v=ye[je.id||""],u=je.paymentTermsOverride||((v==null?void 0:v.paymentTermsOverride)??r);me({...u}),Ie(!0)},Ae=()=>{Ue(v=>({...v,paymentTermsOverride:{...ce},paymentTermsOverrideEnabled:!0})),Ie(!1),a({title:"Applied",message:"Payment terms override applied to group draft.",kind:"success"})},oe=(v,u,C)=>{U(Q=>{const O={...Q},ee=(O[v]||[]).map(F=>F.id===u?{...F,...C}:F);return O[v]=ee,O})},De=v=>{U(u=>{const C={...u},Q=C[v]?C[v].slice():[];return Q.push({id:ld("LI"),description:"New line",module:"Rides & Logistics",marketplace:"",amountUGX:0}),C[v]=Q,C})},$e=(v,u)=>{U(C=>{const Q={...C};return Q[v]=(Q[v]||[]).filter(O=>O.id!==u),Q})},ge=async()=>{try{await navigator.clipboard.writeText(JSON.stringify(Fe,null,2)),a({title:"Copied",message:"Simulation JSON copied to clipboard.",kind:"success"})}catch{a({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},ue=d.useMemo(()=>{const v=g.find(A=>A.id===Oe)||g[0];if(!v)return null;const u=pe[v.entityId]||o[0],C=de[v.templateId]||x[0],Q=Fe.find(A=>A.invoiceGroupId===v.id),O=(Q==null?void 0:Q.invoiceNoPreview)||`${v.prefix}-${T.replace("-","")}-${String(v.nextSequence).padStart(4,"0")}`,ee=(Q==null?void 0:Q.issueDate)||V4(v.frequency,T),F=(Q==null?void 0:Q.dueDate)||_4(ee,v.paymentTermsOverrideEnabled&&v.paymentTermsOverride?v.paymentTermsOverride:r),D=(Q==null?void 0:Q.lineItems)||R[v.id]||[],m=v.paymentTermsOverrideEnabled&&v.paymentTermsOverride?v.paymentTermsOverride:r;return{entity:u,template:C,invoiceNo:O,issueDate:ee,dueDate:F,terms:m,lines:D}},[Oe,g,pe,de,o,x,Fe,T,R,r]),Ke=d.useMemo(()=>r.mode==="DueOnReceipt"?"Due on receipt":r.mode==="EOM"?"Due end of month":`Net ${r.netDays}`,[r]),b=d.useMemo(()=>o.map(v=>v.id),[o]);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(d_,{toasts:t,onDismiss:v=>s(u=>u.filter(C=>C.id!==v))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:vr.green},children:e.jsx(wt,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Billing Setup and Invoice Groups"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Invoice schedules, invoice groups, multi-entity tax settings, branded templates, and invoice simulations."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(ta,{label:`Entities: ${o.length}`,tone:"neutral"}),e.jsx(ta,{label:`Invoice groups: ${g.length}`,tone:"neutral"}),e.jsx(ta,{label:`Terms: ${Ke}`,tone:"info"}),Qe?e.jsx(ta,{label:`Next invoice: ${Sd(Qe)}`,tone:"neutral"}):e.jsx(ta,{label:"No upcoming invoices",tone:"warn"}),e.jsx(ta,{label:`Next month estimate: ${Ni(ke)}`,tone:ke>0?"good":"neutral"}),e.jsx(ta,{label:"Premium simulations",tone:"info"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Zt,{variant:"outline",onClick:fe,children:[e.jsx(gt,{className:"h-4 w-4"})," Export JSON"]}),e.jsxs(Zt,{variant:"outline",onClick:Ve,children:[e.jsx(Ia,{className:"h-4 w-4"})," Save"]}),e.jsxs(Zt,{variant:"outline",onClick:ge,children:[e.jsx(ls,{className:"h-4 w-4"})," Copy simulation"]}),e.jsxs(Zt,{variant:"outline",onClick:ze,children:[e.jsx(Yk,{className:"h-4 w-4"})," New template"]}),e.jsxs(Zt,{variant:"primary",onClick:z,children:[e.jsx(pt,{className:"h-4 w-4"})," New invoice group"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"invoiceGroups",label:"Invoice groups"},{id:"entities",label:"Entities and tax"},{id:"templates",label:"Templates"},{id:"simulation",label:"Billing simulation"},{id:"terms",label:"Payment terms"}].map(v=>e.jsx("button",{className:Cl("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",l===v.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:l===v.id?{background:vr.green}:void 0,onClick:()=>n(v.id),children:v.label},v.id))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs(lt,{mode:"wait",children:[l==="invoiceGroups"?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs(to,{title:"Invoice groups",subtitle:"Different AP recipients, cost codes, templates, and frequencies. Each group is tied to a legal entity stream.",right:e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:e.jsxs(Zt,{variant:"outline",onClick:z,children:[e.jsx(pt,{className:"h-4 w-4"})," Add"]})}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Entity"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Frequency"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"AP recipients"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Cost code"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Template"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Next invoice"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[g.map(v=>{const u=pe[v.entityId],C=de[v.templateId];return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:v.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[v.prefix,"  Seq ",v.nextSequence]})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:u?u.name:v.entityId}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx(ta,{label:v.frequency,tone:"neutral"}),v.frequency==="Custom"&&v.customRule?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:v.customRule}):null]}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[e.jsxs("div",{className:"text-xs",children:["To: ",e.jsx("span",{className:"font-semibold",children:v.apTo})]}),v.apCc?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["CC: ",v.apCc]}):null]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:v.costCode}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:C?C.name:v.templateId}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ta,{label:v.status,tone:v.status==="Active"?"good":"warn"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:v.nextInvoiceAt?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:Sd(new Date(v.nextInvoiceAt))}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Last: ",v.lastInvoicedAt?Sd(new Date(v.lastInvoicedAt)):"-"]})]}):e.jsx("div",{className:"text-xs text-slate-500",children:"-"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Zt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{he(v.id),a({title:"Preview",message:"Invoice preview updated.",kind:"info"})},children:[e.jsx(wt,{className:"h-4 w-4"})," Preview"]}),e.jsxs(Zt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Pe(v),children:[e.jsx(Qr,{className:"h-4 w-4"})," Edit"]}),e.jsxs(Zt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Ne(v.id),children:[e.jsx(wa,{className:"h-4 w-4"})," Clone"]}),e.jsx(Zt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>M(v.id),children:v.status==="Active"?"Pause":"Activate"}),e.jsx(Zt,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>xe(v.id),children:e.jsx(as,{className:"h-4 w-4"})})]})})]},v.id)}),g.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No invoice groups configured."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: each legal entity can have separate invoice streams. Use different invoice groups tied to each entity."})]})},"invoiceGroups"):null,l==="entities"?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs(to,{title:"Entities and tax, VAT",subtitle:"Tax and VAT settings are per entity or branch.",right:e.jsxs(Zt,{variant:"primary",onClick:ne,children:[e.jsx(pt,{className:"h-4 w-4"})," Add entity"]}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Entity"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Country"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Currency"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Tax ID"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"VAT"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Billing contact"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Primary"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsx("tbody",{children:o.map(v=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:v.name}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:v.legalName})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:v.country}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:v.currency}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:v.taxId||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ta,{label:v.vatEnabled?"VAT on":"VAT off",tone:v.vatEnabled?"good":"neutral"}),v.vatEnabled?e.jsx(ta,{label:`${v.vatRatePct}%`,tone:"info"}):null,v.vatEnabled?e.jsx(ta,{label:v.vatInclusive?"Inclusive":"Exclusive",tone:"neutral"}):null]})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:v.billingEmail||"-"}),e.jsx("td",{className:"px-4 py-3",children:v.isPrimary?e.jsx(ta,{label:"Primary",tone:"good"}):e.jsx(ta,{label:"No",tone:"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Zt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Te(v),children:[e.jsx(Qr,{className:"h-4 w-4"})," Edit"]}),e.jsx(Zt,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>Re(v.id),children:e.jsx(as,{className:"h-4 w-4"})})]})})]},v.id))})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: VAT inclusive means VAT is included in item amounts. VAT exclusive adds VAT on top."})]})},"entities"):null,l==="templates"?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs(to,{title:"Invoice templates",subtitle:"Premium: branded templates per invoice group.",right:e.jsxs(Zt,{variant:"primary",onClick:ze,children:[e.jsx(pt,{className:"h-4 w-4"})," New"]}),children:[e.jsx("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:x.map(v=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:v.name}),e.jsx(ta,{label:v.layout,tone:"neutral"}),e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-slate-50 px-3 py-2 text-xs font-semibold text-slate-700 ring-1 ring-slate-200",children:[e.jsx("span",{className:"h-2.5 w-2.5 rounded-full",style:{background:v.accent}}),"Accent"]})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Brand: ",v.brandName]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(ta,{label:v.showVatLine?"VAT line":"No VAT line",tone:v.showVatLine?"info":"neutral"}),e.jsx(ta,{label:v.showLogo?"Logo":"No logo",tone:v.showLogo?"good":"neutral"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(Zt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>qe(v),children:[e.jsx(Qr,{className:"h-4 w-4"})," Edit"]}),e.jsxs(Zt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>le(v.id),children:[e.jsx(wa,{className:"h-4 w-4"})," Duplicate"]}),e.jsx(Zt,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>_e(v.id),children:e.jsx(as,{className:"h-4 w-4"})})]})]}),v.headerNote?e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:v.headerNote}):null]},v.id))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: assign templates per invoice group for separate branded streams."})]})},"templates"):null,l==="simulation"?e.jsx(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs(to,{title:"Billing simulation",subtitle:"Premium: what would next month invoice look like by invoice group and entity.",right:e.jsx(ta,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx(Ja,{label:"Simulation month",value:T,onChange:k,placeholder:"YYYY-MM",hint:"Example: 2026-02"}),e.jsx(nd,{enabled:q,onChange:L,label:"Include VAT",description:"Uses entity VAT settings"}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Estimate"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:Ni(ke)}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"All entities combined"})]})]}),e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Entity"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Invoice group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Frequency"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Cycles"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Month total"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Per-cycle estimate"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Invoice preview"})]})}),e.jsx("tbody",{children:Fe.map(v=>{const u=ye[v.invoiceGroupId],C=pe[v.entityId];return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(C==null?void 0:C.name)||v.entityId}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:(u==null?void 0:u.name)||v.invoiceGroupId}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Cost code: ",(u==null?void 0:u.costCode)||"-"]})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(u==null?void 0:u.frequency)||"-"}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:v.cyclesInMonth}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:Ni(v.monthTotal)}),q?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["VAT: ",Ni(v.monthVat)]}):e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"VAT not included"})]}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:Ni(v.perCycleTotal)}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Issue: ",Sd(v.issueDate),"  Due: ",Sd(v.dueDate)]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Zt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>he(v.invoiceGroupId),children:[e.jsx(wt,{className:"h-4 w-4"})," Preview"]}),e.jsxs(Zt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{De(v.invoiceGroupId),a({title:"Added",message:"Line item added.",kind:"success"})},children:[e.jsx(pt,{className:"h-4 w-4"})," Line"]})]})})]},`${v.invoiceGroupId}-${v.entityId}`)})})]})}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Edit line items"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Adjust forecast inputs. Totals update automatically."})]}),e.jsx(ta,{label:Oe||"Select a group",tone:"info"})]}),Oe?e.jsx("div",{className:"mt-3 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Description"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Module"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Marketplace"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[(R[Oe]||[]).map(v=>e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{value:v.description,onChange:u=>oe(Oe,v.id,{description:u.target.value}),className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{value:v.module,onChange:u=>oe(Oe,v.id,{module:u.target.value}),className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{value:v.marketplace||"",onChange:u=>oe(Oe,v.id,{marketplace:u.target.value}),placeholder:"Optional",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"number",value:v.amountUGX,onChange:u=>oe(Oe,v.id,{amountUGX:Number(u.target.value||0)}),className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Zt,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>$e(Oe,v.id),children:e.jsx(as,{className:"h-4 w-4"})})})]},v.id)),(R[Oe]||[]).length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No line items. Add one above."})})]})]})}):e.jsx("div",{className:"mt-3 rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"Select an invoice group to edit its simulation inputs."})]})]})},"simulation"):null,l==="terms"?e.jsxs(We.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:[e.jsxs(to,{title:"Payment terms",subtitle:"Global default terms. Invoice groups can override if needed.",right:e.jsx(ta,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Ir,{label:"Mode",value:r.mode,onChange:v=>i(u=>({...u,mode:v})),options:["Net","DueOnReceipt","EOM"],hint:"Due date rule"}),e.jsx(eo,{label:"Net days",value:r.netDays,onChange:v=>i(u=>({...u,netDays:Math.max(0,v)})),disabled:r.mode!=="Net",hint:r.mode!=="Net"?"Not used":"Applies to all groups"}),e.jsx(eo,{label:"Early discount percent",value:r.earlyDiscountPct,onChange:v=>i(u=>({...u,earlyDiscountPct:Jv(v,0,100)})),hint:"Optional"}),e.jsx(eo,{label:"Early discount days",value:r.earlyDiscountDays,onChange:v=>i(u=>({...u,earlyDiscountDays:Math.max(0,v)})),disabled:r.earlyDiscountPct<=0,hint:"Optional"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(hc,{label:"Late fee text",value:r.lateFeeText,onChange:v=>i(u=>({...u,lateFeeText:v})),placeholder:"Late fees apply...",rows:3})})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: invoice groups can have different terms if required by a specific AP desk."})]}),e.jsx(to,{title:"Group overrides",subtitle:"View and edit overrides by invoice group.",right:e.jsx(ta,{label:"Premium",tone:"info"}),children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Invoice group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Override"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Terms"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Action"})]})}),e.jsx("tbody",{children:g.map(v=>{const u=v.paymentTermsOverrideEnabled&&v.paymentTermsOverride?v.paymentTermsOverride:r,C=u.mode==="DueOnReceipt"?"Due on receipt":u.mode==="EOM"?"EOM":`Net ${u.netDays}`;return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:v.name}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ta,{label:v.paymentTermsOverrideEnabled?"Yes":"No",tone:v.paymentTermsOverrideEnabled?"info":"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:C}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(Zt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Ue(JSON.parse(JSON.stringify(v))),me({...v.paymentTermsOverride||r}),Ie(!0),Me(!0),a({title:"Edit",message:"Edit group and apply override.",kind:"info"})},children:[e.jsx(Qr,{className:"h-4 w-4"})," Edit"]})})]},v.id)})})]})})})]},"terms"):null]})}),e.jsxs("div",{className:"lg:col-span-5 space-y-4",children:[e.jsxs(to,{title:"Invoice preview",subtitle:"Branded template preview for the selected invoice group.",right:e.jsx(ta,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx(Ir,{label:"Preview invoice group",value:Oe,onChange:he,options:g.map(v=>v.id),hint:"Choose a group"}),ue?e.jsx(c_,{entity:ue.entity,template:ue.template,invoiceNo:ue.invoiceNo,issueDate:ue.issueDate,dueDate:ue.dueDate,terms:ue.terms,lines:ue.lines}):e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No preview available."})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Zt,{variant:"outline",onClick:()=>a({title:"PDF",message:"In production, this exports PDF.",kind:"info"}),children:[e.jsx(wt,{className:"h-4 w-4"})," Export PDF"]}),e.jsxs(Zt,{variant:"outline",onClick:()=>a({title:"Send",message:"In production, this sends to AP recipients.",kind:"info"}),children:[e.jsx(Xs,{className:"h-4 w-4"})," Send test"]}),e.jsxs(Zt,{variant:"outline",onClick:()=>a({title:"Numbering",message:"Invoice number preview is based on prefix and sequence.",kind:"info"}),children:[e.jsx(gw,{className:"h-4 w-4"})," Numbering"]})]})]}),e.jsxs(to,{title:"Premium billing simulation",subtitle:"How next month could look per entity and invoice group.",right:e.jsx(ht,{className:"h-5 w-5 text-emerald-700"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"1) Uses VAT settings per entity"}),e.jsx("li",{children:"2) Uses frequency to estimate cycles per month"}),e.jsx("li",{children:"3) Uses payment terms to compute due date"}),e.jsx("li",{children:"4) Uses template and invoice group prefix for number preview"})]})}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Zt,{variant:"primary",onClick:()=>n("simulation"),children:[e.jsx(Dn,{className:"h-4 w-4"})," Open simulation"]}),e.jsxs(Zt,{variant:"outline",onClick:()=>n("templates"),children:[e.jsx(Yk,{className:"h-4 w-4"})," Edit templates"]})]})]})]})]}),e.jsx("div",{className:"mt-4 text-xs text-slate-500",children:"N Billing Setup and Invoice Groups v2: invoice frequency, invoice groups, entity tax and VAT, payment terms, branded templates, multi-entity invoice streams, and next month billing simulations."})]})]})}),e.jsx(wh,{open:ae,title:_.id?"Edit entity":"New entity",subtitle:"Tax and VAT settings are configured per entity or branch.",onClose:()=>ie(!1),actions:[{label:"Save",onClick:Ee}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Zt,{variant:"outline",onClick:()=>ie(!1),children:"Cancel"}),e.jsxs(Zt,{variant:"primary",onClick:Ee,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Ja,{label:"Entity name",value:_.name,onChange:v=>W(u=>({...u,name:v})),placeholder:"Uganda HQ"}),e.jsx(Ja,{label:"Legal name",value:_.legalName,onChange:v=>W(u=>({...u,legalName:v})),placeholder:"Legal registered name"}),e.jsx(Ja,{label:"Country",value:_.country,onChange:v=>W(u=>({...u,country:v})),placeholder:"Uganda"}),e.jsx(Ja,{label:"City",value:_.city,onChange:v=>W(u=>({...u,city:v})),placeholder:"Kampala"}),e.jsx(Ja,{label:"Address line 1",value:_.address1,onChange:v=>W(u=>({...u,address1:v})),placeholder:"Street, building"}),e.jsx(Ja,{label:"Address line 2",value:_.address2,onChange:v=>W(u=>({...u,address2:v})),placeholder:"Suite, floor"}),e.jsx(Ir,{label:"Currency",value:_.currency,onChange:v=>W(u=>({...u,currency:v})),options:["UGX","USD","EUR","CNY"]}),e.jsx(Ja,{label:"Billing email",value:_.billingEmail,onChange:v=>W(u=>({...u,billingEmail:v})),placeholder:"ap@company.com"}),e.jsx(Ja,{label:"Phone",value:_.phone,onChange:v=>W(u=>({...u,phone:v})),placeholder:"+256..."}),e.jsx(Ja,{label:"Tax ID",value:_.taxId,onChange:v=>W(u=>({...u,taxId:v})),placeholder:"TIN..."}),e.jsx(Ja,{label:"VAT number",value:_.vatNo,onChange:v=>W(u=>({...u,vatNo:v})),placeholder:"VAT..."}),e.jsx(nd,{enabled:_.vatEnabled,onChange:v=>W(u=>({...u,vatEnabled:v})),label:"VAT enabled",description:"If off, VAT line can be hidden"}),e.jsx(eo,{label:"VAT rate percent",value:_.vatRatePct,onChange:v=>W(u=>({...u,vatRatePct:Jv(v,0,100)})),disabled:!_.vatEnabled}),e.jsx(nd,{enabled:_.vatInclusive,onChange:v=>W(u=>({...u,vatInclusive:v})),label:"VAT inclusive",description:"If on, VAT is included in amounts"}),e.jsx(nd,{enabled:_.isPrimary,onChange:v=>W(u=>({...u,isPrimary:v})),label:"Primary entity",description:"Used for defaults"})]})}),e.jsx(wh,{open:J,title:G.id?"Edit template":"New template",subtitle:"Premium: branded invoice templates per invoice group.",onClose:()=>we(!1),actions:[{label:"Save",onClick:He}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Zt,{variant:"outline",onClick:()=>we(!1),children:"Cancel"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(Zt,{variant:"primary",onClick:He,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Ja,{label:"Template name",value:G.name,onChange:v=>be(u=>({...u,name:v})),placeholder:"Default modern"}),e.jsx(Ja,{label:"Brand name",value:G.brandName,onChange:v=>be(u=>({...u,brandName:v})),placeholder:"EVzone CorporatePay"}),e.jsx(Ir,{label:"Layout",value:G.layout,onChange:v=>be(u=>({...u,layout:v})),options:["Modern","Classic"]}),e.jsx(Ir,{label:"Accent color",value:G.accent,onChange:v=>be(u=>({...u,accent:v})),options:[vr.green,vr.orange,"#2563EB","#0F172A","#7C3AED"],hint:"Pick a preset"}),e.jsx(nd,{enabled:G.showLogo,onChange:v=>be(u=>({...u,showLogo:v})),label:"Show logo"}),e.jsx(nd,{enabled:G.showVatLine,onChange:v=>be(u=>({...u,showVatLine:v})),label:"Show VAT line"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(hc,{label:"Header note",value:G.headerNote,onChange:v=>be(u=>({...u,headerNote:v})),placeholder:"Optional note",rows:3})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(hc,{label:"Payment instructions",value:G.paymentInstructions,onChange:v=>be(u=>({...u,paymentInstructions:v})),placeholder:"How to pay",rows:3})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(hc,{label:"Footer text",value:G.footerText,onChange:v=>be(u=>({...u,footerText:v})),placeholder:"Footer",rows:3})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: set different templates for different AP recipients using invoice groups."})]})}),e.jsx(wh,{open:Ge,title:je.id?"Edit invoice group":"New invoice group",subtitle:"Frequency, AP recipients, cost codes, templates, and per-group terms.",onClose:()=>Me(!1),actions:[...je.id?[{label:"Delete",onClick:()=>{xe(je.id),Me(!1)},variant:"danger"}]:[],{label:"Save",onClick:Be}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Zt,{variant:"outline",onClick:()=>Me(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[je.id?e.jsxs(Zt,{variant:"danger",onClick:()=>{xe(je.id),Me(!1)},children:[e.jsx(as,{className:"h-4 w-4"})," Delete"]}):null,e.jsxs(Zt,{variant:"primary",onClick:Be,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Ja,{label:"Group name",value:je.name,onChange:v=>Ue(u=>({...u,name:v})),placeholder:"Main corporate"}),e.jsx(Ir,{label:"Entity stream",value:je.entityId,onChange:v=>Ue(u=>({...u,entityId:v})),options:b,hint:"Separate streams per entity"}),e.jsx(Ir,{label:"Frequency",value:je.frequency,onChange:v=>Ue(u=>({...u,frequency:v})),options:["Daily","Weekly","Monthly","Custom"]}),e.jsx(Ja,{label:"Custom rule",value:je.customRule,onChange:v=>Ue(u=>({...u,customRule:v})),placeholder:"Example: Every 15 days",disabled:je.frequency!=="Custom",hint:je.frequency!=="Custom"?"Not used":"Describe schedule"}),e.jsx(Ja,{label:"AP to",value:je.apTo,onChange:v=>Ue(u=>({...u,apTo:v})),placeholder:"ap@company.com"}),e.jsx(Ja,{label:"AP cc",value:je.apCc,onChange:v=>Ue(u=>({...u,apCc:v})),placeholder:"finance@company.com",hint:"Optional"}),e.jsx(Ja,{label:"Cost code",value:je.costCode,onChange:v=>Ue(u=>({...u,costCode:v})),placeholder:"ACME-MAIN"}),e.jsx(Ir,{label:"Template",value:je.templateId,onChange:v=>Ue(u=>({...u,templateId:v})),options:x.map(v=>v.id),hint:"Branded per group"}),e.jsx(Ja,{label:"Invoice prefix",value:je.prefix,onChange:v=>Ue(u=>({...u,prefix:v})),placeholder:"ACME"}),e.jsx(eo,{label:"Next sequence",value:je.nextSequence,onChange:v=>Ue(u=>({...u,nextSequence:Math.max(1,v)})),hint:"Controls numbering"}),e.jsx(Ir,{label:"Status",value:je.status,onChange:v=>Ue(u=>({...u,status:v})),options:["Active","Paused"]}),e.jsx(nd,{enabled:je.paymentTermsOverrideEnabled,onChange:v=>Ue(u=>({...u,paymentTermsOverrideEnabled:v,paymentTermsOverride:v?u.paymentTermsOverride||{...r}:void 0})),label:"Override payment terms",description:"Different terms for this AP desk"}),e.jsx("div",{className:Cl("md:col-span-2",!je.paymentTermsOverrideEnabled&&"opacity-60"),children:e.jsxs(Zt,{variant:"outline",className:"w-full",disabled:!je.paymentTermsOverrideEnabled,onClick:H,children:[e.jsx(Dn,{className:"h-4 w-4"})," Edit override terms"]})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(hc,{label:"Notes",value:je.notes,onChange:v=>Ue(u=>({...u,notes:v})),placeholder:"Optional notes",rows:3})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: invoice groups allow different templates and AP recipients per entity, enabling separate invoice streams."})]})}),e.jsx(wh,{open:Y,title:"Payment terms override",subtitle:"This override is applied to the invoice group draft.",onClose:()=>Ie(!1),actions:[{label:"Apply",onClick:Ae}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Zt,{variant:"outline",onClick:()=>Ie(!1),children:"Cancel"}),e.jsxs(Zt,{variant:"primary",onClick:Ae,children:[e.jsx(ct,{className:"h-4 w-4"})," Apply"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Ir,{label:"Mode",value:ce.mode,onChange:v=>me(u=>({...u,mode:v})),options:["Net","DueOnReceipt","EOM"]}),e.jsx(eo,{label:"Net days",value:ce.netDays,onChange:v=>me(u=>({...u,netDays:Math.max(0,v)})),disabled:ce.mode!=="Net"}),e.jsx(eo,{label:"Early discount percent",value:ce.earlyDiscountPct,onChange:v=>me(u=>({...u,earlyDiscountPct:Jv(v,0,100)}))}),e.jsx(eo,{label:"Early discount days",value:ce.earlyDiscountDays,onChange:v=>me(u=>({...u,earlyDiscountDays:Math.max(0,v)})),disabled:ce.earlyDiscountPct<=0}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(hc,{label:"Late fee text",value:ce.lateFeeText,onChange:v=>me(u=>({...u,lateFeeText:v})),rows:3})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"This is a premium feature used when an invoice group requires special terms."})]})}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"N Billing Setup and Invoice Groups v2. Core: invoice frequency, invoice groups, tax and VAT per entity, and payment terms. Premium: multi-entity invoice streams, branded templates per group, and next month billing simulation."})})]})}const xg={green:"#03CD8C",orange:"#F77F00"};function ii(...t){return t.filter(Boolean).join(" ")}function rd(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function m_(t){return Math.round(t).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function Gt(t,s){const a=Math.round(Number(t||0));try{return new Intl.NumberFormat(void 0,{style:"currency",currency:s,maximumFractionDigits:0}).format(a)}catch{return`${s} ${m_(a)}`}}function yn(t){return new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"2-digit"})}function id(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function so(t){return t==="Paid"||t==="Approved"||t==="Resolved"?"good":t==="Overdue"||t==="Rejected"?"bad":t==="Draft"||t==="Pending"||t==="In review"?"warn":"neutral"}function B4(t,s){if(s==="Overdue")return"bad";if(s==="Sent"){const a=(t-Date.now())/6e4;return a<=0?"bad":a<=60*48?"warn":"info"}return"neutral"}function $t({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:ii("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function qt({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:xg.green}:t==="accent"?{background:xg.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:ii(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function od({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text"}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:i=>a(i.target.value),placeholder:l,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"})]})}function $r({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:ii(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:ii("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function gm({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:i=>a(i.target.value),placeholder:l,rows:r,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"})]})}function Ba({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function zE({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:ii("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function gc({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="960px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:12,scale:.985},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:12,scale:.985},transition:{duration:.18},className:"fixed inset-x-0 top-[7vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(zE,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[72vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function x_({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,actions:i}){return d.useEffect(()=>{const o=c=>c.key==="Escape"&&n();return t&&window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,x:18},animate:{opacity:1,x:0},exit:{opacity:0,x:18},transition:{duration:.18},className:ii("fixed z-50 overflow-hidden border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]","left-2 right-2 bottom-2 top-[10vh] rounded-[28px]","lg:left-auto lg:right-4 lg:top-4 lg:bottom-4 lg:w-[640px]"),role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-base font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i&&e.jsx(zE,{actions:i}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"h-full min-h-0 overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function p_({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:ii("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function kh(t,s,a="text/plain"){const l=new Blob([s],{type:a}),n=URL.createObjectURL(l),r=document.createElement("a");r.href=n,r.download=t,r.click(),URL.revokeObjectURL(n)}function Ch(t,s){const a=r=>{const i=String(r??"");return/[",\n]/.test(i)?`"${i.replace(/"/g,'""')}"`:i},l=s.map(r=>a(r.label)).join(","),n=t.map(r=>s.map(i=>a(r[i.key])).join(",")).join(`
`);return`${l}
${n}`}function fm(t,s,a){const l={};for(const r of t){const i=s(r);l[i]=(l[i]||0)+a(r)}return Object.keys(l).map(r=>({key:r,value:l[r]})).sort((r,i)=>i.value-r.value)}function h_(t,s,a,l){const n=(g,N)=>N==="Service module"?g.serviceModule||"-":N==="Marketplace"?g.marketplace||"-":N==="Vendor"?g.vendor||"-":N==="Group"?g.group||"-":N==="Cost center"?g.costCenter||"-":N==="Project tag"?g.projectTag||"-":N==="Invoice status"?g.invoiceStatus:N==="Invoice group"?g.invoiceGroupId:N==="Entity"?g.entityId:"-",r=Array.from(new Set(t.map(g=>n(g,s)))).sort(),i=a==="None"?["All"]:Array.from(new Set(t.map(g=>n(g,a)))).sort(),o={},c={},x={};let j=0;for(const g of t){const N=n(g,s),$=a==="None"?"All":n(g,a),T=l==="Count"?1:g.amount;o[N]=o[N]||{},o[N][$]=(o[N][$]||0)+T,c[N]=(c[N]||0)+T,x[$]=(x[$]||0)+T,j+=T}return{rowKeys:r,colKeys:i,matrix:o,rowTotals:c,colTotals:x,grand:j}}function g_(){var yw,Nw,ww;const[t]=d.useState(()=>[{id:"ENT-UG",name:"Uganda HQ",legalName:"Acme Group Limited (Uganda)",country:"Uganda",city:"Kampala",address:"Plot 12, Nkrumah Road, Suite 5",currency:"UGX",taxId:"TIN-123-456-789",vatNo:"VAT-UG-00991",vatEnabled:!0,vatRatePct:18,billingEmail:"ap-ug@acme.com"},{id:"ENT-CN",name:"China Branch",legalName:"Acme Group Co., Ltd. (China)",country:"China",city:"Wuxi",address:"Room 265, No. 3 Gaolang East Road, Xinwu District",currency:"CNY",taxId:"CN-TAX-0001",vatNo:"CN-VAT-0001",vatEnabled:!0,vatRatePct:13,billingEmail:"ap-cn@acme.com"}]),[s]=d.useState(()=>[{id:"IG-MAIN-UG",name:"Main corporate",entityId:"ENT-UG",apTo:"ap@acme.com",apCc:"finance@acme.com",costCode:"ACME-MAIN",templateName:"Default modern",prefix:"ACME"},{id:"IG-SALES-TRAVEL",name:"Sales travel",entityId:"ENT-UG",apTo:"sales-ap@acme.com",apCc:"finance@acme.com",costCode:"ACME-SALES",templateName:"Finance classic",prefix:"ACME-SALES"},{id:"IG-CN-PROC",name:"China procurement",entityId:"ENT-CN",apTo:"ap-cn@acme.com",apCc:"finance@acme.com",costCode:"CN-PROC",templateName:"Default modern",prefix:"ACME-CN"}]),a=d.useMemo(()=>Object.fromEntries(t.map(Z=>[Z.id,Z])),[t]),l=d.useMemo(()=>Object.fromEntries(s.map(Z=>[Z.id,Z])),[s]),[n,r]=d.useState([]),i=Z=>{const Le=rd("toast");r(Je=>[{id:Le,...Z},...Je].slice(0,4)),window.setTimeout(()=>r(Je=>Je.filter(it=>it.id!==Le)),3200)},o=Date.now(),c=24*60*60*1e3,[x,j]=d.useState(()=>[{id:"INV-0001",invoiceNo:"ACME-202601-1042",entityId:"ENT-UG",invoiceGroupId:"IG-MAIN-UG",issueDate:o-7*c,dueDate:o+1*c,status:"Sent",currency:"UGX",subtotal:14e6,vat:252e4,total:1652e4,paidAmount:0,balance:1652e4,createdAt:o-8*c,sentAt:o-7*c,notes:"Weekly corporate spend"},{id:"INV-0002",invoiceNo:"ACME-SALES-202512-0088",entityId:"ENT-UG",invoiceGroupId:"IG-SALES-TRAVEL",issueDate:o-38*c,dueDate:o-24*c,status:"Overdue",currency:"UGX",subtotal:52e5,vat:936e3,total:6136e3,paidAmount:0,balance:6136e3,createdAt:o-39*c,sentAt:o-38*c,notes:"Monthly travel rides"},{id:"INV-0003",invoiceNo:"ACME-202512-1038",entityId:"ENT-UG",invoiceGroupId:"IG-MAIN-UG",issueDate:o-22*c,dueDate:o-15*c,status:"Paid",currency:"UGX",subtotal:122e5,vat:2196e3,total:14396e3,paidAmount:14396e3,balance:0,createdAt:o-23*c,sentAt:o-22*c,paidAt:o-16*c,notes:"Weekly corporate spend"},{id:"INV-0004",invoiceNo:"ACME-CN-202512-0221",entityId:"ENT-CN",invoiceGroupId:"IG-CN-PROC",issueDate:o-14*c,dueDate:o-7*c,status:"Paid",currency:"CNY",subtotal:68e3,vat:8840,total:76840,paidAmount:76840,balance:0,createdAt:o-15*c,sentAt:o-14*c,paidAt:o-7*c,notes:"Procurement stream"},{id:"INV-0005",invoiceNo:"ACME-202601-1043",entityId:"ENT-UG",invoiceGroupId:"IG-MAIN-UG",issueDate:o-1*c,dueDate:o+6*c,status:"Draft",currency:"UGX",subtotal:91e5,vat:1638e3,total:10748e3,paidAmount:0,balance:10748e3,createdAt:o-1*c,notes:"Draft awaiting review"}]),[g,N]=d.useState(()=>[{id:"LI-1001",invoiceId:"INV-0001",description:"Corporate rides",serviceModule:"Rides & Logistics",marketplace:"",vendor:"EVzone Rides",group:"Operations",costCenter:"OPS-001",projectTag:"Office commute",amount:82e5},{id:"LI-1002",invoiceId:"INV-0001",description:"EV charging credits",serviceModule:"EVs & Charging",marketplace:"",vendor:"EVzone Charging",group:"Operations",costCenter:"OPS-001",projectTag:"Fleet charging",amount:41e5},{id:"LI-1003",invoiceId:"INV-0001",description:"EVmart purchases",serviceModule:"E-Commerce",marketplace:"EVmart",vendor:"Kampala Office Mart",group:"Procurement",costCenter:"PROC-001",projectTag:"Office supplies",amount:24e5},{id:"LI-1004",invoiceId:"INV-0001",description:"MyLiveDealz deals",serviceModule:"E-Commerce",marketplace:"MyLiveDealz",vendor:"Shenzhen Store",group:"Procurement",costCenter:"PROC-001",projectTag:"High value",amount:31e5},{id:"LI-2001",invoiceId:"INV-0002",description:"Sales travel rides",serviceModule:"Rides & Logistics",marketplace:"",vendor:"EVzone Rides",group:"Sales",costCenter:"SALES-TRAVEL",projectTag:"Client meetings",amount:52e5},{id:"LI-3001",invoiceId:"INV-0003",description:"Corporate rides",serviceModule:"Rides & Logistics",marketplace:"",vendor:"EVzone Rides",group:"Operations",costCenter:"OPS-001",projectTag:"Office commute",amount:71e5},{id:"LI-3002",invoiceId:"INV-0003",description:"ServiceMart services",serviceModule:"E-Commerce",marketplace:"ServiceMart",vendor:"ServicePro",group:"Admin",costCenter:"ADMIN-CORE",projectTag:"Facilities",amount:23e5},{id:"LI-3003",invoiceId:"INV-0003",description:"Charging credits",serviceModule:"EVs & Charging",marketplace:"",vendor:"EVzone Charging",group:"Operations",costCenter:"OPS-001",projectTag:"Fleet charging",amount:28e5},{id:"LI-4001",invoiceId:"INV-0004",description:"GadgetMart procurement",serviceModule:"E-Commerce",marketplace:"GadgetMart",vendor:"Shenzhen Tech",group:"Procurement",costCenter:"PROC-001",projectTag:"Devices",amount:6e4},{id:"LI-4002",invoiceId:"INV-0004",description:"ExpressMart logistics",serviceModule:"E-Commerce",marketplace:"ExpressMart",vendor:"Express CN",group:"Procurement",costCenter:"PROC-001",projectTag:"Shipping",amount:8e3},{id:"LI-5001",invoiceId:"INV-0005",description:"Corporate rides",serviceModule:"Rides & Logistics",marketplace:"",vendor:"EVzone Rides",group:"Operations",costCenter:"OPS-001",projectTag:"Office commute",amount:48e5},{id:"LI-5002",invoiceId:"INV-0005",description:"MyLiveDealz deals",serviceModule:"E-Commerce",marketplace:"MyLiveDealz",vendor:"Shenzhen Store",group:"Procurement",costCenter:"PROC-001",projectTag:"High value",amount:23e5},{id:"LI-5003",invoiceId:"INV-0005",description:"Facilities services",serviceModule:"E-Commerce",marketplace:"ServiceMart",vendor:"ServicePro",group:"Admin",costCenter:"ADMIN-CORE",projectTag:"Facilities",amount:2e6}]),[$,T]=d.useState(()=>{const Z=(Je,it,Ct,ns,js,At)=>({id:rd("EVT"),lineItemId:Je,ts:o-Math.round(Math.random()*10)*c,kind:it,reference:Ct,serviceModule:(At==null?void 0:At.serviceModule)||"Rides & Logistics",marketplace:At==null?void 0:At.marketplace,vendor:(At==null?void 0:At.vendor)||"EVzone",group:(At==null?void 0:At.group)||"Operations",costCenter:(At==null?void 0:At.costCenter)||"OPS-001",projectTag:(At==null?void 0:At.projectTag)||"General",amount:ns,details:js,...At}),Le=[];return Le.push(Z("LI-1001","Trip","TRP-84001",165e3,"Airport pickup",{vendor:"EVzone Rides",group:"Operations",costCenter:"OPS-001",projectTag:"Office commute"})),Le.push(Z("LI-1001","Trip","TRP-84002",98e3,"City commute",{vendor:"EVzone Rides",group:"Operations",costCenter:"OPS-001",projectTag:"Office commute"})),Le.push(Z("LI-1001","Trip","TRP-84003",12e4,"Client meeting",{vendor:"EVzone Rides",group:"Operations",costCenter:"OPS-001",projectTag:"Office commute"})),Le.push(Z("LI-1004","Order","ORD-MLD-4401",9e5,"Deal order",{serviceModule:"E-Commerce",marketplace:"MyLiveDealz",vendor:"Shenzhen Store",group:"Procurement",costCenter:"PROC-001",projectTag:"High value"})),Le.push(Z("LI-1004","Order","ORD-MLD-4402",11e5,"Deal order",{serviceModule:"E-Commerce",marketplace:"MyLiveDealz",vendor:"Shenzhen Store",group:"Procurement",costCenter:"PROC-001",projectTag:"High value"})),Le.push(Z("LI-2001","Trip","TRP-99001",85e3,"Client site",{vendor:"EVzone Rides",group:"Sales",costCenter:"SALES-TRAVEL",projectTag:"Client meetings"})),Le.push(Z("LI-2001","Trip","TRP-99002",132e3,"Airport drop",{vendor:"EVzone Rides",group:"Sales",costCenter:"SALES-TRAVEL",projectTag:"Client meetings"})),Le.push(Z("LI-4001","Order","ORD-GAD-1001",24e3,"Device purchase",{serviceModule:"E-Commerce",marketplace:"GadgetMart",vendor:"Shenzhen Tech",group:"Procurement",costCenter:"PROC-001",projectTag:"Devices"})),Le.push(Z("LI-4001","Order","ORD-GAD-1002",36e3,"Device purchase",{serviceModule:"E-Commerce",marketplace:"GadgetMart",vendor:"Shenzhen Tech",group:"Procurement",costCenter:"PROC-001",projectTag:"Devices"})),Le}),[k,q]=d.useState(()=>[{id:"CN-001",invoiceId:"INV-0001",createdAt:o-2*c,createdBy:"Finance Desk",amount:2e5,reason:"Service cancellation credit",status:"Pending"},{id:"CN-002",invoiceId:"INV-0002",createdAt:o-12*c,createdBy:"Finance Desk",amount:15e4,reason:"Duplicate trip adjustment",status:"Approved",approvalReason:"Approved for accuracy",decidedBy:"Org Admin",decidedAt:o-11*c}]),[L,R]=d.useState(()=>[{id:"DSP-010",invoiceId:"INV-0001",createdAt:o-18*60*60*1e3,createdBy:"Procurement Desk",status:"In review",category:"Wrong amount",description:"MyLiveDealz line seems higher than expected. Please reconcile raw events.",messages:[{at:o-18*60*60*1e3,by:"Procurement Desk",message:"Please verify ORD-MLD counts."},{at:o-16*60*60*1e3,by:"Finance Desk",message:"Reviewing events and vendor confirmations."}],evidence:[{id:"EV-01",name:"Vendor quote.pdf",note:"Initial quote",uploadedBy:"Procurement Desk",uploadedAt:o-18*60*60*1e3}]}]),[U,ae]=d.useState("invoices"),[ie,_]=d.useState(""),[W,J]=d.useState("All"),[we,G]=d.useState("All"),[be,Ge]=d.useState("All"),[Me,je]=d.useState(!1),[Ue,Oe]=d.useState(null),[he,Y]=d.useState(!1),[Ie,ce]=d.useState(null),[me,pe]=d.useState(!1),[de,ye]=d.useState({invoiceId:"INV-0001",amount:1e5,reason:"",attachmentNote:""}),[Qe,Fe]=d.useState(!1),[ke,fe]=d.useState(null),[Ve,ne]=d.useState(""),[Te,Ee]=d.useState(!1),[Re,ze]=d.useState(!1),[qe,He]=d.useState({invoiceId:"INV-0001",category:"Wrong amount",description:"",evidenceName:"",evidenceNote:""}),[_e,le]=d.useState(!1),[z,Pe]=d.useState(null),[Be,xe]=d.useState(""),[Ne,M]=d.useState(""),[H,Ae]=d.useState(""),[oe,De]=d.useState("Service module"),[$e,ge]=d.useState("Invoice status"),[ue,Ke]=d.useState("Amount"),[b,v]=d.useState(!1),[u,C]=d.useState(null),Q=Z=>x.find(Le=>Le.id===Z)||null,O=d.useMemo(()=>x.map(Z=>Z.balance>0&&Z.status!=="Draft"&&Date.now()>Z.dueDate&&Z.status!=="Overdue"?{...Z,status:"Overdue"}:Z),[x]),ee=d.useMemo(()=>{const Z=ie.trim().toLowerCase();return O.filter(Le=>W==="All"?!0:Le.status===W).filter(Le=>we==="All"?!0:Le.entityId===we).filter(Le=>be==="All"?!0:Le.invoiceGroupId===be).filter(Le=>{if(!Z)return!0;const Je=a[Le.entityId],it=l[Le.invoiceGroupId];return`${Le.invoiceNo} ${Le.id} ${Le.status} ${(Je==null?void 0:Je.name)||""} ${(it==null?void 0:it.name)||""} ${(it==null?void 0:it.costCode)||""}`.toLowerCase().includes(Z)}).sort((Le,Je)=>Je.issueDate-Le.issueDate)},[O,ie,W,we,be,a,l]),F=d.useMemo(()=>{const Z={};for(const Le of L)Le.status==="Resolved"||Le.status==="Rejected"||(Z[Le.invoiceId]=(Z[Le.invoiceId]||0)+1);return Z},[L]),D=d.useMemo(()=>{const Z=ee.reduce((js,At)=>js+At.total,0),Le=ee.reduce((js,At)=>js+At.balance,0),Je=ee.filter(js=>js.status==="Overdue").length,it=ee.filter(js=>js.status==="Paid").length,Ct=ee.filter(js=>js.status==="Sent").length,ns=ee.filter(js=>js.status==="Draft").length;return{total:Z,balance:Le,overdue:Je,paid:it,sent:Ct,draft:ns}},[ee]),m=d.useMemo(()=>Ue?Q(Ue):null,[Ue,O]),A=d.useMemo(()=>m?g.filter(Z=>Z.invoiceId===m.id).slice().sort((Z,Le)=>Le.amount-Z.amount):[],[m,g]),f=d.useMemo(()=>m?k.filter(Z=>Z.invoiceId===m.id).slice().sort((Z,Le)=>Le.createdAt-Z.createdAt):[],[m,k]),B=d.useMemo(()=>m?L.filter(Z=>Z.invoiceId===m.id).slice().sort((Z,Le)=>Le.createdAt-Z.createdAt):[],[m,L]),p=[{value:"serviceModule",label:"Service module"},{value:"marketplace",label:"Marketplace"},{value:"vendor",label:"Vendor"},{value:"group",label:"Group"},{value:"costCenter",label:"Cost center"},{value:"projectTag",label:"Project tag"}],[E,se]=d.useState("serviceModule"),y=d.useMemo(()=>fm(A,Le=>{const Je=Le[E];return Je&&String(Je).trim()||"-"},Le=>Le.amount),[A,E]),re=d.useMemo(()=>Ie&&g.find(Z=>Z.id===Ie)||null,[Ie,g]),ve=d.useMemo(()=>Ie?$.filter(Z=>Z.lineItemId===Ie).slice().sort((Z,Le)=>Le.ts-Z.ts):[],[$,Ie]),P=d.useMemo(()=>{if(!re||!ve.length)return null;const Z=ve.reduce((it,Ct)=>it+Ct.amount,0),Le=fm(ve,it=>it.kind,it=>it.amount),Je=fm(ve,it=>it.vendor,it=>it.amount);return{total:Z,byKind:Le,byVendor:Je}},[re,ve]),X=d.useMemo(()=>{const Z=Object.fromEntries(O.map(Le=>[Le.id,Le]));return g.map(Le=>{const Je=Z[Le.invoiceId];return Je?{...Le,marketplace:Le.marketplace||"-",invoiceNo:Je.invoiceNo,invoiceStatus:Je.status,entityId:Je.entityId,invoiceGroupId:Je.invoiceGroupId,issueDate:Je.issueDate,dueDate:Je.dueDate,currency:Je.currency}:null}).filter(Boolean)},[g,O]),S=d.useMemo(()=>{const Z=new Set(ee.map(Le=>Le.id));return X.filter(Le=>Z.has(Le.invoiceId))},[X,ee]),w=d.useMemo(()=>h_(S,oe,$e,ue),[S,oe,$e,ue]),h=[{value:"Service module",label:"Service module"},{value:"Marketplace",label:"Marketplace"},{value:"Vendor",label:"Vendor"},{value:"Group",label:"Group"},{value:"Cost center",label:"Cost center"},{value:"Project tag",label:"Project tag"},{value:"Invoice status",label:"Invoice status"},{value:"Invoice group",label:"Invoice group"},{value:"Entity",label:"Entity"}],[K,V]=d.useState(()=>{const Z=new Date;return`${Z.getFullYear()}-${String(Z.getMonth()+1).padStart(2,"0")}`}),Ce=d.useMemo(()=>{const[Z,Le]=K.split("-").map(At=>Number(At)),Je=new Date(Z,(Le||1)-1,1).getTime(),it=new Date(Z,Le||1,0,23,59,59,999).getTime(),Ct=O.filter(At=>At.issueDate>=Je&&At.issueDate<=it),ns=Object.fromEntries(t.map(At=>[At.id,{entity:At,invoices:[]}]));Ct.forEach(At=>{var Bi;return(Bi=ns[At.entityId])==null?void 0:Bi.invoices.push(At)});const js=[];return Object.keys(ns).forEach(At=>{const Bi=ns[At].entity,Vu=ns[At].invoices,JE=Vu.reduce((_u,Bu)=>_u+Bu.total,0),ZE=Vu.reduce((_u,Bu)=>_u+Bu.paidAmount,0),eM=Vu.reduce((_u,Bu)=>_u+Bu.balance,0);Vu.length&&js.push({entityId:At,entityName:Bi.name,invoiceCount:Vu.length,issued:JE,paid:ZE,balance:eM})}),js.sort((At,Bi)=>Bi.issued-At.issued),js},[K,O,t]),I=d.useMemo(()=>k.slice().sort((Z,Le)=>Le.createdAt-Z.createdAt),[k]),te=d.useMemo(()=>L.slice().sort((Z,Le)=>Z.status!==Le.status?Z.status==="Open"||Z.status==="In review"?-1:1:Le.createdAt-Z.createdAt),[L]),Se=Z=>{Oe(Z),je(!0)},Xe=()=>{const Z=ee.map(Je=>{var it,Ct;return{invoiceNo:Je.invoiceNo,entity:((it=a[Je.entityId])==null?void 0:it.name)||Je.entityId,invoiceGroup:((Ct=l[Je.invoiceGroupId])==null?void 0:Ct.name)||Je.invoiceGroupId,issueDate:yn(Je.issueDate),dueDate:yn(Je.dueDate),status:Je.status,total:Gt(Je.total,Je.currency),paid:Gt(Je.paidAmount,Je.currency),balance:Gt(Je.balance,Je.currency)}}),Le=Ch(Z,[{key:"invoiceNo",label:"Invoice No"},{key:"entity",label:"Entity"},{key:"invoiceGroup",label:"Invoice Group"},{key:"issueDate",label:"Issue Date"},{key:"dueDate",label:"Due Date"},{key:"status",label:"Status"},{key:"total",label:"Total"},{key:"paid",label:"Paid"},{key:"balance",label:"Balance"}]);kh("invoices.csv",Le,"text/csv"),i({title:"Exported",message:"Invoice list CSV downloaded.",kind:"success"})},mt=Z=>{const Le=Q(Z);if(!Le)return;const it=g.filter(ns=>ns.invoiceId===Z).map(ns=>({invoiceNo:Le.invoiceNo,description:ns.description,serviceModule:ns.serviceModule,marketplace:ns.marketplace||"-",vendor:ns.vendor,group:ns.group,costCenter:ns.costCenter,projectTag:ns.projectTag,amount:Gt(ns.amount,Le.currency)})),Ct=Ch(it,[{key:"invoiceNo",label:"Invoice No"},{key:"description",label:"Description"},{key:"serviceModule",label:"Service Module"},{key:"marketplace",label:"Marketplace"},{key:"vendor",label:"Vendor"},{key:"group",label:"Group"},{key:"costCenter",label:"Cost Center"},{key:"projectTag",label:"Project Tag"},{key:"amount",label:"Amount"}]);kh(`invoice-${Le.invoiceNo}-lines.csv`,Ct,"text/csv"),i({title:"Exported",message:"Invoice line items CSV downloaded.",kind:"success"})},ot=Z=>{const Le=Q(Z);if(!Le)return;const Je=a[Le.entityId],it=l[Le.invoiceGroupId],Ct=g.filter(At=>At.invoiceId===Z),ns=`
      <html>
        <head>
          <title>${Le.invoiceNo}</title>
          <style>
            body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial; padding: 24px; }
            .row { display:flex; justify-content:space-between; gap:12px; }
            .muted { color:#64748b; font-size:12px; }
            .title { font-size:18px; font-weight:700; }
            table { width:100%; border-collapse:collapse; margin-top:16px; }
            th, td { border: 1px solid #e2e8f0; padding: 10px; font-size:12px; }
            th { background:#f8fafc; text-align:left; }
            .totals { margin-top: 16px; width: 320px; margin-left:auto; }
            .totals .row { padding: 6px 0; }
          </style>
        </head>
        <body>
          <div class="row">
            <div>
              <div class="title">Invoice</div>
              <div class="muted">${Le.invoiceNo}</div>
              <div class="muted">Entity: ${(Je==null?void 0:Je.legalName)||(Je==null?void 0:Je.name)||Le.entityId}</div>
              <div class="muted">Invoice group: ${(it==null?void 0:it.name)||Le.invoiceGroupId}  Cost code: ${(it==null?void 0:it.costCode)||"-"}</div>
            </div>
            <div style="text-align:right">
              <div class="muted">Issue: ${yn(Le.issueDate)}</div>
              <div class="muted">Due: ${yn(Le.dueDate)}</div>
              <div class="muted">Status: ${Le.status}</div>
            </div>
          </div>

          <table>
            <thead>
              <tr>
                <th>Description</th>
                <th>Module</th>
                <th>Marketplace</th>
                <th>Vendor</th>
                <th>Group</th>
                <th>Cost center</th>
                <th>Project tag</th>
                <th>Amount</th>
              </tr>
            </thead>
            <tbody>
              ${Ct.map(At=>`
                <tr>
                  <td>${At.description}</td>
                  <td>${At.serviceModule}</td>
                  <td>${At.marketplace||"-"}</td>
                  <td>${At.vendor}</td>
                  <td>${At.group}</td>
                  <td>${At.costCenter}</td>
                  <td>${At.projectTag}</td>
                  <td style="text-align:right">${Gt(At.amount,Le.currency)}</td>
                </tr>`).join("")}
            </tbody>
          </table>

          <div class="totals">
            <div class="row"><div>Subtotal</div><div><b>${Gt(Le.subtotal,Le.currency)}</b></div></div>
            <div class="row"><div>VAT</div><div><b>${Gt(Le.vat,Le.currency)}</b></div></div>
            <div class="row"><div>Total</div><div><b>${Gt(Le.total,Le.currency)}</b></div></div>
            <div class="row"><div>Paid</div><div><b>${Gt(Le.paidAmount,Le.currency)}</b></div></div>
            <div class="row"><div>Balance</div><div><b>${Gt(Le.balance,Le.currency)}</b></div></div>
          </div>

          <div class="muted" style="margin-top:20px">Generated by EVzone CorporatePay</div>
        </body>
      </html>
    `,js=window.open("","_blank");if(!js){i({title:"Popup blocked",message:"Allow popups to print/export PDF.",kind:"warn"});return}js.document.open(),js.document.write(ns),js.document.close(),js.focus(),js.print(),i({title:"Print ready",message:"Use Print to PDF to save.",kind:"info"})},Nt=Z=>{ye({invoiceId:Z,amount:1e5,reason:"",attachmentNote:""}),pe(!0)},nt=()=>{if(!de.invoiceId)return;if(de.amount<=0){i({title:"Invalid",message:"Credit amount must be greater than zero.",kind:"warn"});return}if(de.reason.trim().length<8){i({title:"Reason required",message:"Provide a clear reason (min 8 chars).",kind:"warn"});return}const Z=Q(de.invoiceId);if(!Z)return;const Le={id:rd("CN"),invoiceId:de.invoiceId,createdAt:Date.now(),createdBy:"You",amount:de.amount,reason:de.reason.trim(),status:"Pending"};q(Je=>[Le,...Je]),pe(!1),i({title:"Submitted",message:"Credit note submitted for approval.",kind:"success"}),de.attachmentNote.trim()&&T(Je=>{var it,Ct;return[{id:rd("EVT"),lineItemId:((it=g.find(ns=>ns.invoiceId===Z.id))==null?void 0:it.id)||"",ts:Date.now(),kind:"Service",reference:`CN-EVID-${Le.id}`,serviceModule:"Finance & Payments",marketplace:"-",vendor:"CorporatePay",group:"Finance",costCenter:((Ct=l[Z.invoiceGroupId])==null?void 0:Ct.costCode)||"-",projectTag:"Credit note",amount:0,details:`Evidence note: ${de.attachmentNote.trim()}`},...Je]})},Vs=Z=>{fe(Z),ne(""),Ee(!1),Fe(!0)},As=Z=>{if(!ke)return;if(Ve.trim().length<8||!Te){i({title:"Blocked",message:"Add a reason and confirm acknowledgement.",kind:"warn"});return}const Le=ke,Je=Date.now();if(q(it=>it.map(Ct=>Ct.id===Le?{...Ct,status:Z,approvalReason:Ve.trim(),decidedBy:"You",decidedAt:Je}:Ct)),Z==="Approved"){const it=k.find(Ct=>Ct.id===Le);it&&j(Ct=>Ct.map(ns=>{if(ns.id!==it.invoiceId)return ns;const js=Math.max(0,ns.total-it.amount),At=Math.max(0,ns.balance-it.amount),Bi=At<=0?"Paid":ns.status;return{...ns,total:js,balance:At,status:Bi}})),i({title:"Approved",message:"Credit note approved and applied to invoice.",kind:"success"})}else i({title:"Rejected",message:"Credit note rejected.",kind:"info"});Fe(!1),fe(null)},Ca=Z=>{He({invoiceId:Z,category:"Wrong amount",description:"",evidenceName:"",evidenceNote:""}),ze(!0)},Tt=()=>{if(qe.description.trim().length<12){i({title:"More details needed",message:"Describe the issue (min 12 chars).",kind:"warn"});return}const Z=rd("DSP"),Le=Date.now(),Je=qe.evidenceName.trim()?[{id:rd("EV"),name:qe.evidenceName.trim(),note:qe.evidenceNote.trim()||"Evidence attached",uploadedBy:"You",uploadedAt:Le}]:[],it={id:Z,invoiceId:qe.invoiceId,createdAt:Le,createdBy:"You",status:"Open",category:qe.category,description:qe.description.trim(),messages:[{at:Le,by:"You",message:qe.description.trim()}],evidence:Je};R(Ct=>[it,...Ct]),ze(!1),i({title:"Created",message:"Dispute ticket created.",kind:"success"})},Sa=Z=>{Pe(Z),le(!0),xe(""),M(""),Ae("")},Ut=d.useMemo(()=>z&&L.find(Z=>Z.id===z)||null,[z,L]),Uu=()=>{if(!z||!Be.trim())return;const Z=Date.now();R(Le=>Le.map(Je=>Je.id===z?{...Je,status:Je.status==="Open"?"In review":Je.status,messages:[...Je.messages,{at:Z,by:"You",message:Be.trim()}]}:Je)),xe(""),i({title:"Sent",message:"Message added.",kind:"success"})},Ko=()=>{if(!z||!Ne.trim()){i({title:"Missing",message:"Evidence name is required.",kind:"warn"});return}const Z=Date.now();R(Le=>Le.map(Je=>Je.id===z?{...Je,status:Je.status==="Open"?"In review":Je.status,evidence:[...Je.evidence,{id:rd("EV"),name:Ne.trim(),note:H.trim()||"Evidence attached",uploadedBy:"You",uploadedAt:Z}]}:Je)),M(""),Ae(""),i({title:"Uploaded",message:"Evidence added.",kind:"success"})},Sl=Z=>{z&&(R(Le=>Le.map(Je=>Je.id===z?{...Je,status:Z}:Je)),i({title:"Updated",message:`Ticket set to ${Z}.",`,kind:"info"}))},Qd=Z=>{ce(Z),Y(!0)},Qo=()=>{const Z=[];w.rowKeys.forEach(it=>{const Ct={row:it};w.colKeys.forEach(ns=>{var js;Ct[ns]=((js=w.matrix[it])==null?void 0:js[ns])||0}),Ct.Total=w.rowTotals[it]||0,Z.push(Ct)});const Le=[{key:"row",label:oe},...w.colKeys.map(it=>({key:it,label:it})),{key:"Total",label:"Total"}],Je=Ch(Z,Le);kh("invoice-explorer-pivot.csv",Je,"text/csv"),i({title:"Exported",message:"Pivot CSV downloaded.",kind:"success"})},Sf=d.useMemo(()=>{if(!u)return[];const{rowKey:Z,colKey:Le}=u,Je=(it,Ct)=>Ct==="Service module"?it.serviceModule||"-":Ct==="Marketplace"?it.marketplace||"-":Ct==="Vendor"?it.vendor||"-":Ct==="Group"?it.group||"-":Ct==="Cost center"?it.costCenter||"-":Ct==="Project tag"?it.projectTag||"-":Ct==="Invoice status"?it.invoiceStatus:Ct==="Invoice group"?it.invoiceGroupId:Ct==="Entity"?it.entityId:"-";return S.filter(it=>Je(it,oe)===Z).filter(it=>$e==="None"?!0:Je(it,$e)===Le)},[u,S,oe,$e]);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(p_,{toasts:n,onDismiss:Z=>r(Le=>Le.filter(Je=>Je.id!==Z))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:xg.green},children:e.jsx(wt,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Invoices and Statements"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Invoices, line items, exports, credit notes and disputes. Premium explorer and charge drilldowns."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx($t,{label:`Total: ${Gt(D.total,"UGX")}`,tone:"neutral"}),e.jsx($t,{label:`Balance: ${Gt(D.balance,"UGX")}`,tone:D.balance>0?"warn":"good"}),e.jsx($t,{label:`Overdue: ${D.overdue}`,tone:D.overdue?"bad":"good"}),e.jsx($t,{label:`Paid: ${D.paid}`,tone:"good"}),e.jsx($t,{label:`Sent: ${D.sent}`,tone:"info"}),e.jsx($t,{label:`Draft: ${D.draft}`,tone:"neutral"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[U==="invoices"?e.jsxs(e.Fragment,{children:[e.jsxs(qt,{variant:"outline",onClick:Xe,children:[e.jsx(gt,{className:"h-4 w-4"})," Export CSV"]}),e.jsxs(qt,{variant:"outline",onClick:()=>{if(!ee.length){i({title:"Nothing to export",message:"No invoices in current filter.",kind:"info"});return}ot(ee[0].id)},title:"Print first invoice in list (demo)",children:[e.jsx(wt,{className:"h-4 w-4"})," Export PDF"]})]}):null,U==="explorer"?e.jsxs(qt,{variant:"outline",onClick:Qo,children:[e.jsx(gt,{className:"h-4 w-4"})," Export pivot CSV"]}):null,e.jsxs(qt,{variant:"primary",onClick:()=>{ae("invoices"),i({title:"Tip",message:"Open an invoice to export PDF or raise a dispute.",kind:"info"})},children:[e.jsx(ht,{className:"h-4 w-4"})," Quick actions"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"invoices",label:"Invoices"},{id:"explorer",label:"Invoice explorer"},{id:"statements",label:"Statements"},{id:"creditNotes",label:"Credit notes"},{id:"disputes",label:"Disputes"}].map(Z=>e.jsx("button",{className:ii("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",U===Z.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:U===Z.id?{background:xg.green}:void 0,onClick:()=>ae(Z.id),children:Z.label},Z.id))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[U==="invoices"?e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Ba,{title:"Filters",subtitle:"Search and narrow invoice list.",right:e.jsx($t,{label:"Core",tone:"neutral"}),children:[e.jsx(od,{label:"Search",value:ie,onChange:_,placeholder:"Invoice no, entity, cost code..."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx($r,{label:"Status",value:W,onChange:Z=>J(Z),options:[{value:"All",label:"All"},{value:"Draft",label:"Draft"},{value:"Sent",label:"Sent"},{value:"Paid",label:"Paid"},{value:"Overdue",label:"Overdue"}]}),e.jsx($r,{label:"Entity",value:we,onChange:Z=>G(Z),options:[{value:"All",label:"All"},...t.map(Z=>({value:Z.id,label:Z.name}))]}),e.jsx("div",{className:"sm:col-span-2",children:e.jsx($r,{label:"Invoice group",value:be,onChange:Z=>Ge(Z),options:[{value:"All",label:"All"},...s.map(Z=>({value:Z.id,label:Z.name}))]})})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:[e.jsxs(qt,{variant:"outline",onClick:()=>{_(""),J("All"),G("All"),Ge("All"),i({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(fn,{className:"h-4 w-4"})," Reset"]}),e.jsxs(qt,{variant:"outline",onClick:()=>ae("explorer"),children:[e.jsx(wa,{className:"h-4 w-4"})," Explorer"]})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: invoice explorer supports pivot-like analysis and drilldown to line items."})]}),e.jsx(Ba,{title:"Quick insights",subtitle:"Top contributors in current filter.",right:e.jsx($t,{label:"Premium",tone:"info"}),children:(()=>{const Z=new Set(ee.map(Ct=>Ct.id)),Le=g.filter(Ct=>Z.has(Ct.invoiceId)),Je=fm(Le,Ct=>Ct.vendor,Ct=>Ct.amount)[0],it=fm(Le,Ct=>Ct.serviceModule,Ct=>Ct.amount)[0];return e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Top vendor"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:(Je==null?void 0:Je.key)||"-"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:Je?Gt(Je.value,"UGX"):"-"})]}),e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-emerald-50 text-emerald-700 ring-1 ring-emerald-200",children:e.jsx(Sr,{className:"h-5 w-5"})})]})}),e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Top module"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:(it==null?void 0:it.key)||"-"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:it?Gt(it.value,"UGX"):"-"})]}),e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-slate-50 text-slate-700 ring-1 ring-slate-200",children:e.jsx(wa,{className:"h-5 w-5"})})]})}),e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: open an invoice to see vendor and project tag breakdown."})]})})()})]}),e.jsx("div",{className:"lg:col-span-8",children:e.jsxs(Ba,{title:"Invoice list",subtitle:"Statuses: draft, sent, paid, overdue. Click an invoice to open details.",right:e.jsx($t,{label:`${ee.length} invoice(s)`,tone:"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Invoice"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Entity"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Issue"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Due"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Total"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Balance"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[ee.map(Z=>{const Le=a[Z.entityId],Je=l[Z.invoiceGroupId],it=!!F[Z.id],Ct=B4(Z.dueDate,Z.status);return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:Z.invoiceNo}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[Z.id,"  ",(Je==null?void 0:Je.costCode)||"-"]}),it?e.jsx("div",{className:"mt-2",children:e.jsx($t,{label:`${F[Z.id]} dispute`,tone:"warn"})}):null]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(Le==null?void 0:Le.name)||Z.entityId}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(Je==null?void 0:Je.name)||Z.invoiceGroupId}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:yn(Z.issueDate)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx($t,{label:yn(Z.dueDate),tone:Ct}),e.jsx("div",{className:"text-xs text-slate-500",children:id(Z.dueDate)})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx($t,{label:Z.status,tone:so(Z.status)})}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Gt(Z.total,Z.currency)}),e.jsx("td",{className:ii("px-4 py-3 font-semibold",Z.balance>0?"text-slate-900":"text-emerald-700"),children:Gt(Z.balance,Z.currency)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(qt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>Se(Z.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]}),e.jsxs(qt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ot(Z.id),children:[e.jsx(wt,{className:"h-4 w-4"})," PDF"]}),e.jsxs(qt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Nt(Z.id),children:[e.jsx(yt,{className:"h-4 w-4"})," Credit"]}),e.jsxs(qt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Ca(Z.id),children:[e.jsx(ji,{className:"h-4 w-4"})," Dispute"]})]})})]},Z.id)}),ee.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-4 py-12 text-center text-sm text-slate-600",children:"No invoices match your filters."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Core exports: CSV is available. PDF export uses print to PDF."})]})})]}):null,U==="explorer"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(Ba,{title:"Interactive invoice explorer",subtitle:"Premium: pivot-like analysis across line items.",right:e.jsx($t,{label:"Premium",tone:"info"}),children:[e.jsx($r,{label:"Row dimension",value:oe,onChange:Z=>De(Z),options:h.map(Z=>({value:Z.value,label:Z.label}))}),e.jsx("div",{className:"mt-3",children:e.jsx($r,{label:"Column dimension",value:$e,onChange:Z=>ge(Z),options:[{value:"None",label:"None"},...h.map(Z=>({value:Z.value,label:Z.label}))]})}),e.jsx("div",{className:"mt-3",children:e.jsx($r,{label:"Metric",value:ue,onChange:Z=>Ke(Z),options:[{value:"Amount",label:"Amount"},{value:"Count",label:"Count"}],hint:"Amount sums line items"})}),e.jsx("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Click a cell to drill down and view the underlying line items."}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:[e.jsxs(qt,{variant:"outline",onClick:()=>ae("invoices"),children:[e.jsx(et,{className:"h-4 w-4"})," Back to invoices"]}),e.jsxs(qt,{variant:"outline",onClick:Qo,children:[e.jsx(gt,{className:"h-4 w-4"})," CSV"]})]})]}),e.jsx(Ba,{title:"Scope",subtitle:"Explorer uses invoice filters from Invoices tab.",right:e.jsx($t,{label:`${S.length} line(s)`,tone:"neutral"}),children:e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"To change scope, go to Invoices tab and adjust entity, status, or invoice group."})})]}),e.jsx("div",{className:"lg:col-span-8",children:e.jsxs(Ba,{title:"Pivot table",subtitle:"Totals are computed in real time.",right:e.jsx($t,{label:ue==="Amount"?Gt(w.grand,"UGX"):`${w.grand} events`,tone:"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:oe}),w.colKeys.map(Z=>e.jsx("th",{className:"px-4 py-3 font-semibold",children:Z},Z)),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Total"})]})}),e.jsxs("tbody",{children:[w.rowKeys.map(Z=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Z}),w.colKeys.map(Le=>{var it;const Je=((it=w.matrix[Z])==null?void 0:it[Le])||0;return e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{type:"button",className:"rounded-xl px-3 py-2 text-sm font-semibold text-slate-900 hover:bg-slate-100",onClick:()=>{C({rowKey:Z,colKey:Le}),v(!0)},children:ue==="Amount"?Gt(Je,"UGX"):Je})},Le)}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:ue==="Amount"?Gt(w.rowTotals[Z]||0,"UGX"):w.rowTotals[Z]||0})]},Z)),w.rowKeys.length?e.jsxs("tr",{className:"border-t border-slate-200 bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:"Total"}),w.colKeys.map(Z=>e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:ue==="Amount"?Gt(w.colTotals[Z]||0,"UGX"):w.colTotals[Z]||0},Z)),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:ue==="Amount"?Gt(w.grand,"UGX"):w.grand})]}):e.jsx("tr",{children:e.jsx("td",{colSpan:w.colKeys.length+2,className:"px-4 py-12 text-center text-sm text-slate-600",children:"No data in current scope."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: drilldown supports explain charge linking to raw events."})]})})]}):null,U==="statements"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(Ba,{title:"Statement period",subtitle:"Monthly statement summary.",right:e.jsx($t,{label:"Core",tone:"neutral"}),children:[e.jsx(od,{label:"Month",value:K,onChange:V,placeholder:"YYYY-MM",hint:"Example: 2026-01"}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(qt,{variant:"outline",onClick:()=>{const Z=Ch(Ce.map(Le=>({entity:Le.entityName,invoices:Le.invoiceCount,issued:Gt(Le.issued,a[Le.entityId].currency),paid:Gt(Le.paid,a[Le.entityId].currency),balance:Gt(Le.balance,a[Le.entityId].currency)})),[{key:"entity",label:"Entity"},{key:"invoices",label:"Invoice Count"},{key:"issued",label:"Issued"},{key:"paid",label:"Paid"},{key:"balance",label:"Balance"}]);kh(`statement-${K}.csv`,Z,"text/csv"),i({title:"Exported",message:"Statement CSV downloaded.",kind:"success"})},children:[e.jsx(gt,{className:"h-4 w-4"})," Export CSV"]}),e.jsxs(qt,{variant:"outline",onClick:()=>{const Z=`
                            <html><head><title>Statement ${K}</title>
                            <style>body{font-family: ui-sans-serif, system-ui; padding:24px;} table{width:100%; border-collapse:collapse; margin-top:16px;} th,td{border:1px solid #e2e8f0; padding:10px; font-size:12px;} th{background:#f8fafc; text-align:left;}</style>
                            </head><body>
                            <h2>Statement ${K}</h2>
                            <table><thead><tr><th>Entity</th><th>Invoice count</th><th>Issued</th><th>Paid</th><th>Balance</th></tr></thead><tbody>
                            ${Ce.map(Je=>{const it=a[Je.entityId].currency;return`<tr><td>${Je.entityName}</td><td>${Je.invoiceCount}</td><td>${Gt(Je.issued,it)}</td><td>${Gt(Je.paid,it)}</td><td>${Gt(Je.balance,it)}</td></tr>`}).join("")}
                            </tbody></table>
                            <div style="margin-top:16px; color:#64748b; font-size:12px">Generated by EVzone CorporatePay</div>
                            </body></html>
                          `,Le=window.open("","_blank");if(!Le){i({title:"Popup blocked",message:"Allow popups to print/export PDF.",kind:"warn"});return}Le.document.open(),Le.document.write(Z),Le.document.close(),Le.focus(),Le.print(),i({title:"Print ready",message:"Use Print to PDF to save.",kind:"info"})},children:[e.jsx(wt,{className:"h-4 w-4"})," Export PDF"]})]})]}),e.jsx(Ba,{title:"What is included",subtitle:"Statements are based on invoice issue date.",right:e.jsx($t,{label:"Info",tone:"info"}),children:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"1) Issued totals are the sum of invoice totals"}),e.jsx("li",{children:"2) Paid totals are the sum of paid amounts"}),e.jsx("li",{children:"3) Balance totals are remaining amounts"})]})})})]}),e.jsx("div",{className:"lg:col-span-8",children:e.jsxs(Ba,{title:"Statement summary",subtitle:"Per entity totals for the selected month.",right:e.jsx($t,{label:`${Ce.length} entity`,tone:"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Entity"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Invoices"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Issued"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Paid"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Balance"})]})}),e.jsxs("tbody",{children:[Ce.map(Z=>{const Le=a[Z.entityId].currency;return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Z.entityName}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Z.invoiceCount}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Gt(Z.issued,Le)}),e.jsx("td",{className:"px-4 py-3 font-semibold text-emerald-700",children:Gt(Z.paid,Le)}),e.jsx("td",{className:ii("px-4 py-3 font-semibold",Z.balance>0?"text-slate-900":"text-emerald-700"),children:Gt(Z.balance,Le)})]},Z.entityId)}),Ce.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-12 text-center text-sm text-slate-600",children:"No invoices issued in this month."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Statements support multi-entity organizations and separate invoice streams."})]})})]}):null,U==="creditNotes"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(Ba,{title:"Create adjustment",subtitle:"Credit notes are approval-gated.",right:e.jsx($t,{label:"Core",tone:"neutral"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Credit notes reduce invoice balance and total once approved."}),e.jsxs(qt,{variant:"primary",onClick:()=>{var Z,Le;return Nt(((Z=ee[0])==null?void 0:Z.id)||((Le=x[0])==null?void 0:Le.id)||"INV-0001")},children:[e.jsx(pt,{className:"h-4 w-4"})," New credit note"]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: approvals are tracked in audit logs and can be routed by rules."})]}),e.jsx(Ba,{title:"Pending approvals",subtitle:"Approve or reject.",right:e.jsx($t,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"space-y-2",children:[I.filter(Z=>Z.status==="Pending").map(Z=>{const Le=Q(Z.invoiceId);return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:Z.id}),e.jsx($t,{label:Z.status,tone:so(Z.status)})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Invoice: ",(Le==null?void 0:Le.invoiceNo)||Z.invoiceId]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:Gt(Z.amount,(Le==null?void 0:Le.currency)||"UGX")}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Reason: ",Z.reason]})]}),e.jsxs(qt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>Vs(Z.id),children:[e.jsx(yt,{className:"h-4 w-4"})," Review"]})]})},Z.id)}),I.some(Z=>Z.status==="Pending")?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No pending credit notes."})]})})]}),e.jsx("div",{className:"lg:col-span-8",children:e.jsx(Ba,{title:"All credit notes",subtitle:"Adjustments and approvals history.",right:e.jsx($t,{label:`${I.length}`,tone:"neutral"}),children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"ID"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Invoice"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Reason"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Created"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Decision"})]})}),e.jsxs("tbody",{children:[I.map(Z=>{const Le=Q(Z.invoiceId);return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Z.id}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(Le==null?void 0:Le.invoiceNo)||Z.invoiceId}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Gt(Z.amount,(Le==null?void 0:Le.currency)||"UGX")}),e.jsx("td",{className:"px-4 py-3",children:e.jsx($t,{label:Z.status,tone:so(Z.status)})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Z.reason}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:yn(Z.createdAt)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Z.status!=="Pending"?e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs text-slate-500",children:["By ",Z.decidedBy||"-","  ",Z.decidedAt?yn(Z.decidedAt):"-"]}),Z.approvalReason?e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Why: ",Z.approvalReason]}):null]}):e.jsx($t,{label:"Pending",tone:"warn"})})]},Z.id)}),I.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-12 text-center text-sm text-slate-600",children:"No credit notes."})})]})]})})})})]}):null,U==="disputes"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(Ba,{title:"Create dispute",subtitle:"Ticketing with evidence attachments.",right:e.jsx($t,{label:"Premium",tone:"info"}),children:[e.jsxs(qt,{variant:"primary",onClick:()=>{var Z,Le;return Ca(((Z=ee[0])==null?void 0:Z.id)||((Le=x[0])==null?void 0:Le.id)||"INV-0001")},children:[e.jsx(pt,{className:"h-4 w-4"})," New ticket"]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Disputes are linked to invoices and track messages, evidence, and resolution."})]}),e.jsx(Ba,{title:"Statuses",subtitle:"Resolve or reject after review.",right:e.jsx($t,{label:"Core",tone:"neutral"}),children:e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: disputes can pause payment enforcement until resolved."})})]}),e.jsx("div",{className:"lg:col-span-8",children:e.jsxs(Ba,{title:"Tickets",subtitle:"Open, in review, resolved.",right:e.jsx($t,{label:`${te.length}`,tone:"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Ticket"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Invoice"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Category"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Evidence"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Updated"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[te.map(Z=>{const Le=Q(Z.invoiceId),Je=Z.messages[Z.messages.length-1];return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:Z.id}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["By ",Z.createdBy]})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(Le==null?void 0:Le.invoiceNo)||Z.invoiceId}),e.jsx("td",{className:"px-4 py-3",children:e.jsx($t,{label:Z.status,tone:so(Z.status)})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Z.category}),e.jsx("td",{className:"px-4 py-3",children:e.jsx($t,{label:`${Z.evidence.length}`,tone:Z.evidence.length?"info":"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:id(Je?Je.at:Z.createdAt)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(qt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Sa(Z.id),children:[e.jsx(ji,{className:"h-4 w-4"})," Open"]}),Z.status!=="Resolved"?e.jsxs(qt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Pe(Z.id),le(!0),Sl("Resolved")},children:[e.jsx(tt,{className:"h-4 w-4"})," Resolve"]}):null]})})]},Z.id)}),te.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-12 text-center text-sm text-slate-600",children:"No dispute tickets."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Ticket detail includes evidence attachments and message thread."})]})})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"O Invoices and Statements v2. Core: invoice list, statuses, line item breakdown, export CSV/PDF, credit notes with approvals. Premium: pivot explorer, explain charge drilldown, dispute workflow."})})]})}),e.jsx(x_,{open:Me,title:m?m.invoiceNo:"Invoice",subtitle:m?`${((yw=a[m.entityId])==null?void 0:yw.name)||m.entityId}  ${((Nw=l[m.invoiceGroupId])==null?void 0:Nw.name)||m.invoiceGroupId}`:"",onClose:()=>je(!1),actions:[{label:"Lines CSV",onClick:()=>m&&mt(m.id)},{label:"PDF",onClick:()=>m&&ot(m.id)},{label:"Credit",onClick:()=>m&&Nt(m.id)},{label:"Dispute",onClick:()=>m&&Ca(m.id)}],footer:m?e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Exports and disputes are audit logged in production."}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(qt,{variant:"outline",onClick:()=>mt(m.id),children:[e.jsx(gt,{className:"h-4 w-4"})," Lines CSV"]}),e.jsxs(qt,{variant:"outline",onClick:()=>ot(m.id),children:[e.jsx(wt,{className:"h-4 w-4"})," PDF"]}),e.jsxs(qt,{variant:"outline",onClick:()=>Nt(m.id),children:[e.jsx(yt,{className:"h-4 w-4"})," Credit"]}),e.jsxs(qt,{variant:"primary",onClick:()=>Ca(m.id),children:[e.jsx(ji,{className:"h-4 w-4"})," Dispute"]})]})]}):null,children:m?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx($t,{label:m.status,tone:so(m.status)}),e.jsx($t,{label:`Issue ${yn(m.issueDate)}`,tone:"neutral"}),e.jsx($t,{label:`Due ${yn(m.dueDate)}`,tone:B4(m.dueDate,m.status)}),F[m.id]?e.jsx($t,{label:`${F[m.id]} dispute`,tone:"warn"}):null]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Notes: ",m.notes||"-"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Total"}),e.jsx("div",{className:"mt-1 text-lg font-semibold text-slate-900",children:Gt(m.total,m.currency)}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Balance: ",Gt(m.balance,m.currency)]})]})]})}),e.jsx(Ba,{title:"Line items",subtitle:"Breakdown by module, marketplace, vendor, group, cost center, and project tag.",right:e.jsx($r,{label:"Group by",value:E,onChange:se,options:p,hint:"Breakdown"}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Key"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"})]})}),e.jsxs("tbody",{children:[y.slice(0,10).map(Z=>e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Z.key}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Gt(Z.value,m.currency)})]},Z.key)),y.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:2,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No line items."})})]})]})}),e.jsx("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Description"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Explain"})]})}),e.jsxs("tbody",{children:[A.slice(0,10).map(Z=>e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:Z.description}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[Z.serviceModule,Z.marketplace?`  ${Z.marketplace}`:"","  ",Z.vendor]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[Z.group,"  ",Z.costCenter,"  ",Z.projectTag]})]}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Gt(Z.amount,m.currency)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(qt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Qd(Z.id),children:[e.jsx(ht,{className:"h-4 w-4"})," Explain"]})})]},Z.id)),A.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No line items."})})]})]})})]})}),e.jsx(Ba,{title:"Adjustments",subtitle:"Credit notes are approval-gated.",right:e.jsx($t,{label:`${f.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[f.map(Z=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:Z.id}),e.jsx($t,{label:Z.status,tone:so(Z.status)})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[yn(Z.createdAt),"  ",Z.createdBy]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:Gt(Z.amount,m.currency)}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Reason: ",Z.reason]}),Z.status!=="Pending"&&Z.approvalReason?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Decision: ",Z.approvalReason]}):null]}),Z.status==="Pending"?e.jsxs(qt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>Vs(Z.id),children:[e.jsx(yt,{className:"h-4 w-4"})," Review"]}):e.jsx($t,{label:"Final",tone:"neutral"})]})},Z.id)),f.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No adjustments."})]})}),e.jsx(Ba,{title:"Disputes",subtitle:"Ticketing and evidence attachments.",right:e.jsx($t,{label:`${B.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[B.map(Z=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:Z.id}),e.jsx($t,{label:Z.status,tone:so(Z.status)}),e.jsx($t,{label:Z.category,tone:"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",id(Z.createdAt),"  By ",Z.createdBy]}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:Z.description}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Evidence: ",Z.evidence.length,"  Messages: ",Z.messages.length]})]}),e.jsxs(qt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Sa(Z.id),children:[e.jsx(ji,{className:"h-4 w-4"})," Open"]})]})},Z.id)),B.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No disputes for this invoice."})]})})]}):e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"Select an invoice."})}),e.jsx(gc,{open:he,title:"Explain charge",subtitle:"Premium: drill down from line item to raw events.",onClose:()=>Y(!1),actions:[{label:"Export raw",onClick:()=>i({title:"Export",message:"In production, raw events export to CSV.",kind:"info"})}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(qt,{variant:"outline",onClick:()=>Y(!1),children:"Close"}),e.jsxs(qt,{variant:"outline",onClick:()=>i({title:"Export",message:"In production, raw events export to CSV.",kind:"info"}),children:[e.jsx(gt,{className:"h-4 w-4"})," Export raw"]})]}),children:re?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:re.description}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[re.serviceModule,re.marketplace?`  ${re.marketplace}`:"","  ",re.vendor]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[re.group,"  ",re.costCenter,"  ",re.projectTag]})]}),e.jsx($t,{label:re.id,tone:"neutral"})]})}),P?e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Summary"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Based on ",ve.length," raw event(s)."]})]}),e.jsx($t,{label:Gt(P.total,"UGX"),tone:"info"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"By type"}),e.jsx("div",{className:"mt-2 space-y-1",children:P.byKind.map(Z=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"font-semibold text-slate-700",children:Z.key}),e.jsx("span",{className:"font-semibold text-slate-900",children:Gt(Z.value,"UGX")})]},Z.key))})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"By vendor"}),e.jsx("div",{className:"mt-2 space-y-1",children:P.byVendor.map(Z=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"font-semibold text-slate-700",children:Z.key}),e.jsx("span",{className:"font-semibold text-slate-900",children:Gt(Z.value,"UGX")})]},Z.key))})]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Explain charge: each raw event is linked to a trip, order, charging session, or service record."})]}):e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No raw events available for this line in demo."}),e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Type"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Reference"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Module"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Details"})]})}),e.jsxs("tbody",{children:[ve.map(Z=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:yn(Z.ts)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx($t,{label:Z.kind,tone:"neutral"})}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Z.reference}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[Z.serviceModule,Z.marketplace?`  ${Z.marketplace}`:""]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Z.vendor}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Gt(Z.amount,"UGX")}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Z.details})]},Z.id)),ve.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No raw events."})})]})]})})]}):null}),e.jsx(gc,{open:me,title:"Create credit note",subtitle:"Core: adjustments are approval-gated.",onClose:()=>pe(!1),actions:[{label:"Submit",onClick:nt}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(qt,{variant:"outline",onClick:()=>pe(!1),children:"Cancel"}),e.jsxs(qt,{variant:"primary",onClick:nt,children:[e.jsx(ct,{className:"h-4 w-4"})," Submit"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx($r,{label:"Invoice",value:de.invoiceId,onChange:Z=>ye(Le=>({...Le,invoiceId:Z})),options:O.map(Z=>({value:Z.id,label:Z.invoiceNo})),hint:"Select invoice"}),e.jsx(od,{label:"Amount",value:String(de.amount),onChange:Z=>ye(Le=>({...Le,amount:Math.max(0,Number(Z||0))})),type:"number",hint:"UGX"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(gm,{label:"Reason",value:de.reason,onChange:Z=>ye(Le=>({...Le,reason:Z})),placeholder:"Example: duplicate line, service cancellation, pricing correction",hint:"Minimum 8 characters",rows:4})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(gm,{label:"Evidence note",value:de.attachmentNote,onChange:Z=>ye(Le=>({...Le,attachmentNote:Z})),placeholder:"Optional: reference document or evidence",hint:"Optional",rows:3})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"This credit note will appear in the approval queue. Approving applies it to the invoice totals."})]})}),e.jsx(gc,{open:Qe,title:"Credit note approval",subtitle:"Approval-gated adjustments require a reason.",onClose:()=>Fe(!1),actions:[{label:"Reject",onClick:()=>As("Rejected"),variant:"danger"},{label:"Approve",onClick:()=>As("Approved")}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(qt,{variant:"outline",onClick:()=>Fe(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(qt,{variant:"outline",onClick:()=>As("Rejected"),children:[e.jsx(Ye,{className:"h-4 w-4"})," Reject"]}),e.jsxs(qt,{variant:"primary",onClick:()=>As("Approved"),children:[e.jsx(tt,{className:"h-4 w-4"})," Approve"]})]})]}),children:(()=>{const Z=k.find(Je=>Je.id===ke);if(!Z)return e.jsx("div",{className:"text-sm text-slate-600",children:"Select a credit note."});const Le=Q(Z.invoiceId);return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Credit:"})," ",Z.id]}),e.jsxs("div",{className:"mt-1",children:[e.jsx("span",{className:"font-semibold",children:"Invoice:"})," ",(Le==null?void 0:Le.invoiceNo)||Z.invoiceId]}),e.jsxs("div",{className:"mt-1",children:[e.jsx("span",{className:"font-semibold",children:"Amount:"})," ",Gt(Z.amount,(Le==null?void 0:Le.currency)||"UGX")]}),e.jsxs("div",{className:"mt-1",children:[e.jsx("span",{className:"font-semibold",children:"Reason:"})," ",Z.reason]})]}),e.jsx(gm,{label:"Decision reason",value:Ve,onChange:ne,placeholder:"Example: verified raw events and vendor confirmation",hint:"Minimum 8 characters",rows:3}),e.jsxs("label",{className:"flex items-start gap-3 rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("input",{type:"checkbox",checked:Te,onChange:Je=>Ee(Je.target.checked),className:"mt-1 h-4 w-4 rounded border-slate-300"}),e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"I confirm this decision is authorized and will be audit logged."})]})]})})()}),e.jsx(gc,{open:Re,title:"Create dispute ticket",subtitle:"Premium: ticketing with evidence attachments.",onClose:()=>ze(!1),actions:[{label:"Create",onClick:Tt}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(qt,{variant:"outline",onClick:()=>ze(!1),children:"Cancel"}),e.jsxs(qt,{variant:"primary",onClick:Tt,children:[e.jsx(ct,{className:"h-4 w-4"})," Create"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx($r,{label:"Invoice",value:qe.invoiceId,onChange:Z=>He(Le=>({...Le,invoiceId:Z})),options:O.map(Z=>({value:Z.id,label:Z.invoiceNo}))}),e.jsx($r,{label:"Category",value:qe.category,onChange:Z=>He(Le=>({...Le,category:Z})),options:[{value:"Wrong amount",label:"Wrong amount"},{value:"Duplicate",label:"Duplicate"},{value:"Missing service",label:"Missing service"},{value:"VAT/tax",label:"VAT/tax"},{value:"Other",label:"Other"}]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(gm,{label:"Description",value:qe.description,onChange:Z=>He(Le=>({...Le,description:Z})),placeholder:"Describe the dispute and what you expect to change.",hint:"Minimum 12 characters",rows:4})}),e.jsx(od,{label:"Evidence name",value:qe.evidenceName,onChange:Z=>He(Le=>({...Le,evidenceName:Z})),placeholder:"Example: screenshot.png",hint:"Optional"}),e.jsx(od,{label:"Evidence note",value:qe.evidenceNote,onChange:Z=>He(Le=>({...Le,evidenceNote:Z})),placeholder:"What this evidence shows",hint:"Optional"}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Evidence is stored securely in production. This demo stores metadata only."})]})}),e.jsx(gc,{open:_e,title:Ut?`Ticket ${Ut.id}`:"Ticket",subtitle:Ut?`${Ut.status}  Invoice ${((ww=Q(Ut.invoiceId))==null?void 0:ww.invoiceNo)||Ut.invoiceId}`:"",onClose:()=>le(!1),actions:[{label:"In review",onClick:()=>Sl("In review")},{label:"Reject",onClick:()=>Sl("Rejected"),variant:"danger"},{label:"Resolve",onClick:()=>Sl("Resolved")}],footer:Ut?e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(qt,{variant:"outline",onClick:()=>le(!1),children:"Close"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(qt,{variant:"outline",onClick:()=>Sl("In review"),children:[e.jsx(vn,{className:"h-4 w-4"})," In review"]}),e.jsxs(qt,{variant:"outline",onClick:()=>Sl("Rejected"),children:[e.jsx(Ye,{className:"h-4 w-4"})," Reject"]}),e.jsxs(qt,{variant:"primary",onClick:()=>Sl("Resolved"),children:[e.jsx(tt,{className:"h-4 w-4"})," Resolve"]})]})]}):null,children:Ut?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsx("div",{className:"flex items-start justify-between gap-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx($t,{label:Ut.status,tone:so(Ut.status)}),e.jsx($t,{label:Ut.category,tone:"neutral"}),e.jsx($t,{label:`Evidence ${Ut.evidence.length}`,tone:Ut.evidence.length?"info":"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:Ut.description}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Created ",id(Ut.createdAt),"  By ",Ut.createdBy]})]})})}),e.jsxs(Ba,{title:"Messages",subtitle:"Conversation thread",right:e.jsx($t,{label:`${Ut.messages.length}`,tone:"neutral"}),children:[e.jsx("div",{className:"space-y-2",children:Ut.messages.slice().sort((Z,Le)=>Z.at-Le.at).map((Z,Le)=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:Z.by}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:Z.message}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[yn(Z.at),"  ",id(Z.at)]})]}),e.jsx(ji,{className:"h-5 w-5 text-slate-400"})]})},Le))}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3",children:[e.jsx(gm,{label:"Add message",value:Be,onChange:xe,placeholder:"Write a message",rows:3}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(qt,{variant:"primary",onClick:Uu,disabled:!Be.trim(),children:[e.jsx(tt,{className:"h-4 w-4"})," Send"]})})]})]}),e.jsxs(Ba,{title:"Evidence",subtitle:"Attachments metadata",right:e.jsx($t,{label:`${Ut.evidence.length}`,tone:"neutral"}),children:[e.jsxs("div",{className:"space-y-2",children:[Ut.evidence.map(Z=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:Z.name}),e.jsx($t,{label:Z.id,tone:"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Uploaded ",id(Z.uploadedAt),"  ",Z.uploadedBy]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Note: ",Z.note]})]}),e.jsx(vw,{className:"h-5 w-5 text-slate-400"})]})},Z.id)),Ut.evidence.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No evidence attached."})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(od,{label:"Evidence name",value:Ne,onChange:M,placeholder:"file.png"}),e.jsx(od,{label:"Evidence note",value:H,onChange:Ae,placeholder:"What it shows"}),e.jsx("div",{className:"md:col-span-2 flex justify-end",children:e.jsxs(qt,{variant:"primary",onClick:Ko,children:[e.jsx(pt,{className:"h-4 w-4"})," Add evidence"]})})]})]})]}):e.jsx("div",{className:"text-sm text-slate-600",children:"Select a ticket."})}),e.jsx(gc,{open:b,title:"Explorer drilldown",subtitle:"Premium: items behind the pivot cell.",onClose:()=>v(!1),actions:[{label:"Close",onClick:()=>v(!1)}],footer:e.jsx("div",{className:"flex justify-end",children:e.jsx(qt,{variant:"outline",onClick:()=>v(!1),children:"Close"})}),children:u?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Row: ",e.jsx("span",{className:"font-semibold",children:u.rowKey}),$e!=="None"?e.jsxs(e.Fragment,{children:[e.jsx("br",{}),"Column: ",e.jsx("span",{className:"font-semibold",children:u.colKey})]}):null,e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Items: ",Sf.length]})]}),e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Invoice"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Line"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Explain"})]})}),e.jsxs("tbody",{children:[Sf.slice(0,50).map(Z=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("button",{className:"text-left",onClick:()=>{Se(Z.invoiceId),v(!1)},children:[e.jsx("div",{className:"font-semibold text-slate-900",children:Z.invoiceNo}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:Z.invoiceStatus})]})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Z.description}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Z.vendor}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Gt(Z.amount,"UGX")}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(qt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Qd(Z.id),v(!1)},children:[e.jsx(ht,{className:"h-4 w-4"})," Explain"]})})]},`${Z.invoiceId}-${Z.id}`)),Sf.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No rows."})})]})]})}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: drilldown can link to the full raw events for each line item."})]}):null})]})}const pg={green:"#03CD8C",orange:"#F77F00"};function Ls(...t){return t.filter(Boolean).join(" ")}function Sh(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function fc(t,s,a){return Math.max(s,Math.min(a,t))}function vc(t){return new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"2-digit"})}function Zv(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function G4(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function vm(t,s){const a=Math.round(Number(t||0));try{return new Intl.NumberFormat(void 0,{style:"currency",currency:s,maximumFractionDigits:0}).format(a)}catch{return`${s} ${a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}}function f_(t){let s=2166136261;for(let a=0;a<t.length;a++)s^=t.charCodeAt(a),s=Math.imul(s,16777619);return(s>>>0)%1e3/1e3}function xt({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Ls("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Ft({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:pg.green}:t==="accent"?{background:pg.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Ls(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function bm({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:Ls("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:Ls("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function eb({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:Ls(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:Ls("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function bc({label:t,value:s,onChange:a,hint:l,disabled:n}){return e.jsxs("div",{className:Ls(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",value:s,onChange:r=>a(Number(r.target.value||0)),disabled:n,className:Ls("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function cr({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:Ls(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:Ls("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function tb({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4,disabled:i}){return e.jsxs("div",{className:Ls(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:o=>a(o.target.value),placeholder:l,rows:r,disabled:i,className:Ls("mt-2 w-full rounded-2xl border p-3 text-sm font-semibold shadow-sm outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function v_({actions:t}){const[s,a]=d.useState(!1);return e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 focus:bg-slate-100 focus:outline-none",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>a(!1)}),e.jsx("div",{className:"absolute right-0 top-full z-40 mt-1 w-48 overflow-hidden rounded-xl border border-slate-200 bg-white shadow-xl ring-1 ring-slate-200",children:t.map((l,n)=>e.jsx("button",{onClick:()=>{l.onClick(),a(!1)},className:Ls("block w-full px-4 py-2.5 text-left text-sm font-medium transition hover:bg-slate-50",l.variant==="danger"?"text-rose-700 hover:bg-rose-50":"text-slate-700"),children:l.label},n))})]})]})}function Ah({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="920px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[8vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-1",children:[o?e.jsx(v_,{actions:o}):null,e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function b_({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r}){return d.useEffect(()=>{const i=o=>o.key==="Escape"&&n();return t&&window.addEventListener("keydown",i),()=>window.removeEventListener("keydown",i)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,x:16},animate:{opacity:1,x:0},exit:{opacity:0,x:16},transition:{duration:.18},className:Ls("fixed z-50 overflow-hidden border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]","left-2 right-2 bottom-2 top-[12vh] rounded-[28px]","lg:left-auto lg:right-4 lg:top-4 lg:bottom-4 lg:w-[680px]"),role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-base font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"h-full min-h-0 overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function j_({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Ls("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function jc(t){return t==="Email"?e.jsx(Xs,{className:"h-4 w-4"}):t==="WhatsApp"?e.jsx(ME,{className:"h-4 w-4"}):t==="WeChat"?e.jsx(Ii,{className:"h-4 w-4"}):e.jsx(bw,{className:"h-4 w-4"})}function Es({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function yc({title:t,value:s,sub:a,icon:l,tone:n}){const r=n==="good"?"bg-emerald-50 text-emerald-700":n==="warn"?"bg-amber-50 text-amber-800":n==="bad"?"bg-rose-50 text-rose-700":n==="info"?"bg-blue-50 text-blue-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:t}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:s}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a})]}),e.jsx("div",{className:Ls("grid h-10 w-10 place-items-center rounded-2xl",r),children:l})]})})}function sb(t){return t==="Paid"||t==="Resolved"?"good":t==="Overdue"||t==="Rejected"?"bad":t==="Draft"||t==="Open"||t==="In review"||t==="Pending"?"warn":t==="Sent"?"info":"neutral"}function Nc(t){return t==="Full stopped"?"bad":t==="Soft paused"?"warn":"good"}function y_(t){return t==="High"?"bad":t==="Medium"?"warn":"good"}function N_(t){return t<45?"High":t<75?"Medium":"Low"}function w_(t){const{maxOverdueDays:s,overdueBalanceBase:a,openDisputes:l,failedDeliveries:n,pendingFinalNotices:r}=t;let i=100;return i-=fc(s*3.2,0,55),i-=fc(Math.log10(1+a)*9.5,0,22),i-=fc(l*6,0,20),i-=fc(n*2,0,10),i-=fc(r*8,0,16),Math.round(fc(i,0,100))}function q4(t,s,a){const r=t.filter(c=>c.balance>0&&c.status!=="Draft").map(c=>({inv:c,days:Math.max(0,Math.floor((a-c.dueDate)/864e5))})).filter(c=>c.days>0),i=r.length?Math.max(...r.map(c=>c.days)):0,o=r.length;return s.enabled?s.freezeAllServices?{mode:"Full stopped",reason:"Risk freeze enabled",maxOverdueDays:i,overdueCount:o}:i>=s.fullStopAfterOverdueDays&&o>0?{mode:"Full stopped",reason:`Overdue exceeded full stop threshold (${s.fullStopAfterOverdueDays} days)`,maxOverdueDays:i,overdueCount:o}:i>=s.softPauseAfterOverdueDays&&o>0?{mode:"Soft paused",reason:`Overdue exceeded soft pause threshold (${s.softPauseAfterOverdueDays} days)`,maxOverdueDays:i,overdueCount:o}:{mode:"Active",reason:"No enforcement triggers",maxOverdueDays:i,overdueCount:o}:{mode:"Active",reason:"Enforcement disabled",maxOverdueDays:i,overdueCount:o}}function jm(t,s){return t==="Finance"?s.filter(a=>a.role==="Finance"||a.role==="AP"):t==="CFO"?s.filter(a=>a.role==="CFO"):s.filter(a=>a.role==="EVzone Support")}function k_(){var re,ve,P,X;const t=["Email","WhatsApp","WeChat","SMS"],[s,a]=d.useState(()=>Date.now()),[l,n]=d.useState([]),r=S=>{const w=Sh("toast");n(h=>[{id:w,...S},...h].slice(0,4)),window.setTimeout(()=>n(h=>h.filter(K=>K.id!==w)),3200)},[i,o]=d.useState("overview"),[c]=d.useState(()=>[{id:"ENT-UG",name:"Uganda HQ",currency:"UGX",vatEnabled:!0,vatRatePct:18},{id:"ENT-CN",name:"China Branch",currency:"CNY",vatEnabled:!0,vatRatePct:13}]),[x]=d.useState(()=>[{id:"IG-MAIN-UG",name:"Main corporate",entityId:"ENT-UG",apCode:"ACME-MAIN"},{id:"IG-SALES-TRAVEL",name:"Sales travel",entityId:"ENT-UG",apCode:"ACME-SALES"},{id:"IG-CN-PROC",name:"China procurement",entityId:"ENT-CN",apCode:"CN-PROC"}]),j=d.useMemo(()=>Object.fromEntries(c.map(S=>[S.id,S])),[c]),g=d.useMemo(()=>Object.fromEntries(x.map(S=>[S.id,S])),[x]),[N,$]=d.useState(()=>[{id:"C-AP",name:"Accounts Payable",role:"AP",email:"ap@acme.com",phone:"+256 701 000 000",channels:{Email:!0,WhatsApp:!1,WeChat:!1,SMS:!0}},{id:"C-FIN",name:"Finance Desk",role:"Finance",email:"finance@acme.com",phone:"+256 700 000 000",channels:{Email:!0,WhatsApp:!0,WeChat:!0,SMS:!0}},{id:"C-CFO",name:"CFO",role:"CFO",email:"cfo@acme.com",phone:"+256 702 000 000",channels:{Email:!0,WhatsApp:!0,WeChat:!1,SMS:!0}},{id:"C-EVZ",name:"EVzone Support",role:"EVzone Support",email:"support@evzone.com",phone:"+256 703 000 000",channels:{Email:!0,WhatsApp:!0,WeChat:!1,SMS:!0}}]),T=24*60*60*1e3,[k,q]=d.useState(()=>[{id:"INV-0001",invoiceNo:"ACME-202601-1042",entityId:"ENT-UG",invoiceGroupId:"IG-MAIN-UG",issueDate:s-9*T,dueDate:s+1*T,status:"Sent",total:1652e4,paidAmount:0,balance:1652e4,openDisputes:1,lastReminderAt:s-16*60*60*1e3},{id:"INV-0002",invoiceNo:"ACME-SALES-202512-0088",entityId:"ENT-UG",invoiceGroupId:"IG-SALES-TRAVEL",issueDate:s-42*T,dueDate:s-24*T,status:"Overdue",total:6136e3,paidAmount:0,balance:6136e3,openDisputes:0,lastReminderAt:s-2*T},{id:"INV-0003",invoiceNo:"ACME-202512-1038",entityId:"ENT-UG",invoiceGroupId:"IG-MAIN-UG",issueDate:s-23*T,dueDate:s-16*T,status:"Paid",total:14396e3,paidAmount:14396e3,balance:0,openDisputes:0,lastReminderAt:void 0},{id:"INV-0004",invoiceNo:"ACME-CN-202512-0221",entityId:"ENT-CN",invoiceGroupId:"IG-CN-PROC",issueDate:s-15*T,dueDate:s-7*T,status:"Paid",total:76840,paidAmount:76840,balance:0,openDisputes:0},{id:"INV-0005",invoiceNo:"ACME-202601-1043",entityId:"ENT-UG",invoiceGroupId:"IG-MAIN-UG",issueDate:s-2*T,dueDate:s+6*T,status:"Draft",total:10748e3,paidAmount:0,balance:10748e3,openDisputes:0}]),[L,R]=d.useState(()=>[{id:"TPL-UPCOMING",name:"Upcoming due reminder",subject:"Upcoming invoice due: {invoiceNo}",body:"Hello {contactName}. Your invoice {invoiceNo} is due on {dueDate}. Amount due: {balance}. Please arrange payment to avoid service interruption.",enabledChannels:{Email:!0,WhatsApp:!0,WeChat:!0,SMS:!0}},{id:"TPL-OVERDUE",name:"Overdue notice",subject:"Overdue invoice: {invoiceNo}",body:"Hello {contactName}. Invoice {invoiceNo} is overdue. Balance: {balance}. Please pay immediately. Continued delinquency may pause services.",enabledChannels:{Email:!0,WhatsApp:!0,WeChat:!0,SMS:!0}},{id:"TPL-FINAL",name:"Final notice",subject:"Final notice: {invoiceNo}",body:"Hello {contactName}. Final notice for invoice {invoiceNo}. Balance: {balance}. Services may stop if payment is not received.",enabledChannels:{Email:!0,WhatsApp:!0,WeChat:!0,SMS:!0}}]),[U,ae]=d.useState(()=>[{id:"STG-1",name:"Upcoming due",trigger:"Upcoming due",offsetDaysFromDue:-2,templateId:"TPL-UPCOMING",channels:{Email:!0,WhatsApp:!0,WeChat:!1,SMS:!1},escalation:"Finance",action:"None",enabled:!0},{id:"STG-2",name:"Overdue reminder",trigger:"Overdue",offsetDaysFromDue:1,templateId:"TPL-OVERDUE",channels:{Email:!0,WhatsApp:!0,WeChat:!1,SMS:!0},escalation:"Finance",action:"Soft pause",enabled:!0},{id:"STG-3",name:"Final notice",trigger:"Final notice",offsetDaysFromDue:7,templateId:"TPL-FINAL",channels:{Email:!0,WhatsApp:!0,WeChat:!0,SMS:!0},escalation:"CFO",action:"Full stop",enabled:!0},{id:"STG-4",name:"Escalate to EVzone support",trigger:"Final notice",offsetDaysFromDue:14,templateId:"TPL-FINAL",channels:{Email:!0,WhatsApp:!0,WeChat:!1,SMS:!0},escalation:"EVzone Support",action:"Full stop",enabled:!0}]),[ie,_]=d.useState(()=>[]),[W,J]=d.useState(()=>({enabled:!0,softPauseAfterOverdueDays:3,fullStopAfterOverdueDays:10,finalNoticeAfterOverdueDays:7,autoReactivateAfterPayment:!0,freezeAllServices:!1,scope:"CorporatePay only"})),[we,G]=d.useState(()=>({firstResponseHours:4,resolutionHours:72})),[be,Ge]=d.useState(()=>[{id:"DSP-010",invoiceId:"INV-0001",status:"In review",createdAt:s-20*60*60*1e3,lastUpdatedAt:s-2*60*60*1e3,firstResponseAt:s-18*60*60*1e3},{id:"DSP-011",invoiceId:"INV-0002",status:"Open",createdAt:s-9*60*60*1e3,lastUpdatedAt:s-9*60*60*1e3}]),[Me,je]=d.useState(!1),[Ue,Oe]=d.useState(()=>({id:"",name:"",trigger:"Overdue",offsetDaysFromDue:1,templateId:"TPL-OVERDUE",channels:{Email:!0,WhatsApp:!0,WeChat:!1,SMS:!0},escalation:"Finance",action:"Soft pause",enabled:!0})),[he,Y]=d.useState(!1),[Ie,ce]=d.useState(()=>({id:"",name:"",subject:"",body:"",enabledChannels:{Email:!0,WhatsApp:!0,WeChat:!0,SMS:!0}})),[me,pe]=d.useState(!1),[de,ye]=d.useState(null),[Qe,Fe]=d.useState(!1),[ke,fe]=d.useState({invoiceId:"INV-0001",stageId:"STG-2",note:"Manual reminder"}),[Ve,ne]=d.useState(!1),[Te,Ee]=d.useState(""),[Re,ze]=d.useState("All"),[qe,He]=d.useState("All"),[_e,le]=d.useState(()=>[{level:"Finance",notify:["Email","WhatsApp","SMS"]},{level:"CFO",notify:["Email","WhatsApp","SMS"]},{level:"EVzone Support",notify:["Email","WhatsApp"]}]),z=d.useMemo(()=>de&&k.find(S=>S.id===de)||null,[de,k]),Pe=d.useMemo(()=>k.filter(S=>S.balance>0&&S.status!=="Draft"),[k]),Be=d.useMemo(()=>k.filter(S=>S.balance>0&&S.status!=="Draft").map(S=>({inv:S,overdueDays:Math.max(0,Math.floor((s-S.dueDate)/T))})).filter(S=>S.overdueDays>0).sort((S,w)=>w.overdueDays-S.overdueDays),[k,s]),xe=d.useMemo(()=>k.filter(w=>w.balance>0&&w.status!=="Draft").map(w=>({inv:w,daysToDue:Math.ceil((w.dueDate-s)/T)})).filter(w=>w.daysToDue>=0&&w.daysToDue<=3).sort((w,h)=>w.daysToDue-h.daysToDue),[k,s]),Ne=d.useMemo(()=>{var w;const S={};for(const h of k){const K=((w=j[h.entityId])==null?void 0:w.currency)||"UGX";S[K]=S[K]||{currency:K,total:0,balance:0,overdueBalance:0},S[K].total+=h.total,S[K].balance+=h.balance;const V=Math.max(0,Math.floor((s-h.dueDate)/T));h.balance>0&&h.status!=="Draft"&&V>0&&(S[K].overdueBalance+=h.balance)}return Object.values(S).sort((h,K)=>K.balance-h.balance)},[k,j,s]),M=d.useMemo(()=>q4(k,W,s),[k,W,s]),H=d.useMemo(()=>Be.filter(S=>S.overdueDays>=W.finalNoticeAfterOverdueDays).map(S=>S.inv.id),[Be,W.finalNoticeAfterOverdueDays]),Ae=d.useMemo(()=>{const S={Email:{delivered:0,failed:0,queued:0},WhatsApp:{delivered:0,failed:0,queued:0},WeChat:{delivered:0,failed:0,queued:0},SMS:{delivered:0,failed:0,queued:0}};for(const w of ie)w.status==="Delivered"&&(S[w.channel].delivered+=1),w.status==="Failed"&&(S[w.channel].failed+=1),w.status==="Queued"&&(S[w.channel].queued+=1);return S},[ie]),oe=d.useMemo(()=>{const S=be.filter(I=>I.status==="Open"||I.status==="In review"),w=be.filter(I=>I.status==="Resolved"||I.status==="Rejected"),h=S.filter(I=>{const te=(s-I.createdAt)/36e5;return I.firstResponseAt?!1:te>we.firstResponseHours}),K=S.filter(I=>(s-I.createdAt)/36e5>we.resolutionHours),V=S.length?Math.round((S.length-h.length)/S.length*100):100,Ce=S.length?Math.round((S.length-K.length)/S.length*100):100;return{openCount:S.length,resolvedCount:w.length,firstRespBreaches:h,resolutionBreaches:K,complianceFirst:V,complianceResolution:Ce}},[be,we,s]),De=d.useMemo(()=>ie.filter(S=>S.status==="Failed").length,[ie]),$e=d.useMemo(()=>{const S=Ne.find(w=>w.currency==="UGX");return(S==null?void 0:S.overdueBalance)||0},[Ne]),ge=d.useMemo(()=>{const S=M.maxOverdueDays,w=be.filter(K=>K.status==="Open"||K.status==="In review").length,h=H.length;return w_({maxOverdueDays:S,overdueBalanceBase:$e,openDisputes:w,failedDeliveries:De,pendingFinalNotices:h})},[M.maxOverdueDays,be,H.length,$e,De]),ue=d.useMemo(()=>N_(ge),[ge]),Ke=d.useMemo(()=>{const S=Te.trim().toLowerCase();return ie.filter(w=>Re==="All"?!0:w.channel===Re).filter(w=>qe==="All"?!0:w.status===qe).filter(w=>{if(!S)return!0;const h=k.find(Ce=>Ce.id===w.invoiceId),K=U.find(Ce=>Ce.id===w.stageId);return`${w.id} ${w.status} ${w.channel} ${w.to} ${(h==null?void 0:h.invoiceNo)||w.invoiceId} ${(K==null?void 0:K.name)||w.stageId}`.toLowerCase().includes(S)}).slice().sort((w,h)=>h.createdAt-w.createdAt)},[ie,Te,Re,qe,k,U]),b=S=>{ye(S),pe(!0)},v=S=>{q(w=>w.map(h=>h.id!==S?h:{...h,status:"Paid",paidAmount:h.total,balance:0})),r({title:"Payment recorded",message:"Invoice marked paid. Reactivation rules will apply.",kind:"success"}),W.autoReactivateAfterPayment&&W.freezeAllServices&&r({title:"Still frozen",message:"Risk freeze is enabled. Turn it off to reactivate services.",kind:"warn"})},u=S=>ie.some(h=>h.invoiceId===S.invoiceId&&h.stageId===S.stageId&&h.channel===S.channel)?!1:(_(h=>[{id:Sh("DLV"),...S},...h]),!0),C=(S,w,h)=>{const K=k.find(Xe=>Xe.id===S),V=U.find(Xe=>Xe.id===w);if(!K||!V)return;if(!V.enabled){r({title:"Stage disabled",message:"Enable the stage to send.",kind:"warn"});return}const Ce=L.find(Xe=>Xe.id===V.templateId);if(!Ce){r({title:"Template missing",message:"Select a template for this stage.",kind:"warn"});return}const I=jm(V.escalation,N);if(!I.length){r({title:"No recipients",message:"No contact found for the escalation level.",kind:"warn"});return}const te=Date.now();let Se=0;for(const Xe of t){if(!V.channels[Xe]||!Ce.enabledChannels[Xe])continue;const mt=I.find(Tt=>Tt.channels[Xe])||I[0],ot=Xe==="Email"?mt.email:mt.phone,Nt=`${S}-${w}-${Xe}-${te}`,Vs=f_(Nt)<.86?"Delivered":"Failed";u({createdAt:te,invoiceId:S,stageId:w,channel:Xe,to:ot,status:Vs,error:Vs==="Failed"?"Temporary delivery failure. Will retry.":void 0})&&(Se+=1)}q(Xe=>Xe.map(mt=>mt.id===S?{...mt,lastReminderAt:te}:mt)),r({title:"Reminder sent",message:`${Se} delivery record(s) created${h?` (${h})`:""}.`,kind:Se?"success":"info"})},Q=()=>{const S=s,w=k.filter(V=>V.balance>0&&V.status!=="Draft"),h=U.filter(V=>V.enabled).slice().sort((V,Ce)=>V.offsetDaysFromDue-Ce.offsetDaysFromDue);let K=0;for(const V of w)for(const Ce of h){const I=V.dueDate+Ce.offsetDaysFromDue*T;S<I||Ce.trigger==="Upcoming due"&&Math.max(0,Math.floor((S-V.dueDate)/T))>0||(C(V.id,Ce.id),K+=1)}r({title:"Dunning run completed",message:`Evaluated ${w.length} invoice(s). Stages checked: ${h.length}.`,kind:K?"success":"info"})},O=()=>{var S;Oe({id:"",name:"New stage",trigger:"Overdue",offsetDaysFromDue:1,templateId:((S=L[0])==null?void 0:S.id)||"TPL-OVERDUE",channels:{Email:!0,WhatsApp:!0,WeChat:!1,SMS:!0},escalation:"Finance",action:"Soft pause",enabled:!0}),je(!0)},ee=S=>{Oe(JSON.parse(JSON.stringify(S))),je(!0)},F=()=>{if(!Ue.name.trim()){r({title:"Missing name",message:"Stage name is required.",kind:"warn"});return}const S=Ue.id||Sh("STG"),w={...Ue,id:S};ae(h=>{const K=h.findIndex(V=>V.id===S);if(K>=0){const V=h.slice();return V[K]=w,V}return[w,...h]}),je(!1),r({title:"Saved",message:"Dunning stage saved.",kind:"success"})},D=S=>{ae(w=>w.filter(h=>h.id!==S)),r({title:"Deleted",message:"Stage removed.",kind:"info"})},m=()=>{ce({id:"",name:"New template",subject:"Reminder: {invoiceNo}",body:"Hello {contactName}. Invoice {invoiceNo} is due on {dueDate}. Balance: {balance}.",enabledChannels:{Email:!0,WhatsApp:!0,WeChat:!0,SMS:!0}}),Y(!0)},A=S=>{ce(JSON.parse(JSON.stringify(S))),Y(!0)},f=()=>{if(!Ie.name.trim()){r({title:"Missing name",message:"Template name is required.",kind:"warn"});return}const S=Ie.id||Sh("TPL"),w={...Ie,id:S};R(h=>{const K=h.findIndex(V=>V.id===S);if(K>=0){const V=h.slice();return V[K]=w,V}return[w,...h]}),Y(!1),r({title:"Saved",message:"Template saved.",kind:"success"})},B=S=>{if(U.some(h=>h.templateId===S)){r({title:"Blocked",message:"Template is used by a stage.",kind:"warn"});return}R(h=>h.filter(K=>K.id!==S)),r({title:"Deleted",message:"Template removed.",kind:"info"})},p=()=>{const S=Ke.map(Se=>{const Xe=k.find(ot=>ot.id===Se.invoiceId),mt=U.find(ot=>ot.id===Se.stageId);return{id:Se.id,createdAt:Zv(Se.createdAt),invoiceNo:(Xe==null?void 0:Xe.invoiceNo)||Se.invoiceId,stage:(mt==null?void 0:mt.name)||Se.stageId,channel:Se.channel,to:Se.to,status:Se.status,error:Se.error||""}}),w=["id","createdAt","invoiceNo","stage","channel","to","status","error"].join(","),h=Se=>{const Xe=String(Se??"");return/[",\n]/.test(Xe)?`"${Xe.replace(/"/g,'""')}"`:Xe},K=S.map(Se=>[Se.id,Se.createdAt,Se.invoiceNo,Se.stage,Se.channel,Se.to,Se.status,Se.error].map(h).join(",")).join(`
`),V=`${w}
${K}`,Ce=new Blob([V],{type:"text/csv"}),I=URL.createObjectURL(Ce),te=document.createElement("a");te.href=I,te.download="collections-delivery-logs.csv",te.click(),URL.revokeObjectURL(I),r({title:"Exported",message:"Delivery logs CSV downloaded.",kind:"success"})},E=async()=>{const S={enforcementCfg:W,disputeSlaCfg:we,escalationLadder:_e,stages:U,templates:L,exportedAt:new Date().toISOString()},w=new Blob([JSON.stringify(S,null,2)],{type:"application/json"}),h=URL.createObjectURL(w),K=document.createElement("a");K.href=h,K.download="corporatepay-collections-config.json",K.click(),URL.revokeObjectURL(h),r({title:"Exported",message:"Collections config JSON downloaded.",kind:"success"})};return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(j_,{toasts:l,onDismiss:S=>n(w=>w.filter(h=>h.id!==S))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:pg.green},children:e.jsx($o,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Collections, Reminders and Enforcement"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Automated dunning, multi-channel reminders, service suspension, reactivation, escalation routing, and billing dispute SLAs."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(xt,{label:`Enforcement: ${M.mode}`,tone:Nc(M.mode)}),e.jsx(xt,{label:`Predicted risk: ${ue}`,tone:y_(ue)}),e.jsx(xt,{label:`Health: ${ge}/100`,tone:ge>=75?"good":ge>=45?"warn":"bad"}),e.jsx(xt,{label:`Disputes SLA: ${oe.complianceFirst}% first response`,tone:oe.complianceFirst>=90?"good":"warn"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ft,{variant:"outline",onClick:()=>a(Date.now()),children:[e.jsx(Ar,{className:"h-4 w-4"})," Refresh time"]}),e.jsxs(Ft,{variant:"outline",onClick:Q,children:[e.jsx(sl,{className:"h-4 w-4"})," Run scheduler"]}),e.jsxs(Ft,{variant:W.freezeAllServices?"danger":"outline",onClick:()=>{J(S=>({...S,freezeAllServices:!S.freezeAllServices})),r({title:W.freezeAllServices?"Freeze disabled":"Freeze enabled",message:W.freezeAllServices?"Services can resume if no overdue triggers.":"CorporatePay is frozen until disabled.",kind:W.freezeAllServices?"info":"warn"})},children:[W.freezeAllServices?e.jsx(ko,{className:"h-4 w-4"}):e.jsx(ra,{className:"h-4 w-4"})," Freeze"]}),e.jsxs(Ft,{variant:"outline",onClick:()=>Fe(!0),children:[e.jsx(ht,{className:"h-4 w-4"})," Send now"]}),e.jsxs(Ft,{variant:"outline",onClick:E,children:[e.jsx(gt,{className:"h-4 w-4"})," Export config"]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-6",children:[e.jsx(yc,{title:"Outstanding",value:Ne.map(S=>vm(S.balance,S.currency)).join("  "),sub:"All invoices",icon:e.jsx(Sr,{className:"h-5 w-5"}),tone:Ne.some(S=>S.balance>0)?"neutral":"good"}),e.jsx(yc,{title:"Overdue invoices",value:`${Be.length}`,sub:Be.length?`Max ${M.maxOverdueDays} day(s)`:"No overdue",icon:e.jsx(Mt,{className:"h-5 w-5"}),tone:Be.length?"bad":"good"}),e.jsx(yc,{title:"Due soon",value:`${xe.length}`,sub:"Within 3 days",icon:e.jsx(Dn,{className:"h-5 w-5"}),tone:xe.length?"warn":"good"}),e.jsx(yc,{title:"Pending final notices",value:`${H.length}`,sub:`Threshold ${W.finalNoticeAfterOverdueDays} day(s)`,icon:e.jsx(yt,{className:"h-5 w-5"}),tone:H.length?"warn":"good"}),e.jsx(yc,{title:"Delivery failures",value:`${De}`,sub:"Across channels",icon:e.jsx(ji,{className:"h-5 w-5"}),tone:De?"warn":"good"}),e.jsx(yc,{title:"Disputes",value:`${oe.openCount} open`,sub:`${oe.complianceResolution}% resolution SLA`,icon:e.jsx(sy,{className:"h-5 w-5"}),tone:oe.openCount?"warn":"good"})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"overview",label:"Overview"},{id:"dunning",label:"Dunning schedules"},{id:"reminders",label:"Reminders and logs"},{id:"enforcement",label:"Enforcement"},{id:"escalation",label:"Escalation routing"},{id:"health",label:"Health and SLA"}].map(S=>e.jsx("button",{className:Ls("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",i===S.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:i===S.id?{background:pg.green}:void 0,onClick:()=>o(S.id),children:S.label},S.id))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[i==="overview"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsxs(Es,{title:"Collections queue",subtitle:"Prioritize overdue items and upcoming due reminders.",right:e.jsx(xt,{label:`${Pe.length} unpaid`,tone:Pe.length?"warn":"good"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Invoice"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Entity"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Due"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Balance"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Reminders"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[k.filter(S=>S.balance>0&&S.status!=="Draft").slice().sort((S,w)=>{const h=Math.max(0,Math.floor((s-S.dueDate)/T));return Math.max(0,Math.floor((s-w.dueDate)/T))-h}).map(S=>{const w=j[S.entityId],h=g[S.invoiceGroupId],K=Math.max(0,Math.floor((s-S.dueDate)/T)),V=K>=W.fullStopAfterOverdueDays?"bad":K>=W.softPauseAfterOverdueDays?"warn":"neutral",Ce=(w==null?void 0:w.currency)||"UGX";return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:S.invoiceNo}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:S.id}),S.openDisputes?e.jsx("div",{className:"mt-2",children:e.jsx(xt,{label:`${S.openDisputes} dispute`,tone:"warn"})}):null]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(w==null?void 0:w.name)||S.entityId}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(h==null?void 0:h.name)||S.invoiceGroupId}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(xt,{label:vc(S.dueDate),tone:V}),e.jsx("div",{className:"text-xs text-slate-500",children:K>0?`${K} day(s) overdue`:`${Math.max(0,Math.ceil((S.dueDate-s)/T))} day(s) to due`})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(xt,{label:S.status,tone:sb(S.status)})}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:vm(S.balance,Ce)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:S.lastReminderAt?e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Last"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:G4(S.lastReminderAt)})]}):e.jsx(xt,{label:"None",tone:"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ft,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>b(S.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]}),e.jsxs(Ft,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{var I;fe({invoiceId:S.id,stageId:((I=U[0])==null?void 0:I.id)||"STG-1",note:"Manual"}),Fe(!0)},children:[e.jsx(ht,{className:"h-4 w-4"})," Remind"]}),e.jsxs(Ft,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>v(S.id),children:[e.jsx(tt,{className:"h-4 w-4"})," Mark paid"]})]})})]},S.id)}),Pe.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-12 text-center text-sm text-slate-600",children:"No unpaid invoices."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Core: upcoming due, overdue, and final notice reminders. Premium: escalation routing and health score."})]}),e.jsx(Es,{title:"Channel delivery health",subtitle:"Delivery status per channel with logs.",right:e.jsxs(Ft,{variant:"outline",onClick:()=>o("reminders"),children:[e.jsx(et,{className:"h-4 w-4"})," Open logs"]}),children:e.jsx("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-4",children:t.map(S=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-slate-900",children:[e.jsx("span",{className:"text-slate-600",children:jc(S)})," ",S]}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Delivered"}),e.jsx("div",{className:"mt-1 text-lg font-semibold text-slate-900",children:Ae[S].delivered})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsx(xt,{label:`Failed ${Ae[S].failed}`,tone:Ae[S].failed?"warn":"good"}),e.jsx(xt,{label:`Queued ${Ae[S].queued}`,tone:"neutral"})]})]})},S))})})]}),e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(Es,{title:"Enforcement summary",subtitle:"Service suspension rules and reactivation after payment.",right:e.jsx(xt,{label:M.mode,tone:Nc(M.mode)}),children:[e.jsxs("div",{className:Ls("rounded-3xl border p-4",M.mode==="Full stopped"?"border-rose-200 bg-rose-50":M.mode==="Soft paused"?"border-amber-200 bg-amber-50":"border-emerald-200 bg-emerald-50"),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:M.mode}),e.jsx("div",{className:"mt-1 text-xs text-slate-700",children:M.reason}),e.jsxs("div",{className:"mt-2 text-xs text-slate-700",children:["Scope: ",e.jsx("span",{className:"font-semibold",children:W.scope})]})]}),e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-white/60 text-slate-700 ring-1 ring-slate-200",children:e.jsx(yt,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"mt-3 text-xs text-slate-700",children:["Soft pause: CorporatePay is paused and users may be prompted to pay first.",e.jsx("br",{}),"Full stop: corporate-funded services are stopped until compliant."]})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2",children:[e.jsx(bm,{enabled:W.enabled,onChange:S=>J(w=>({...w,enabled:S})),label:"Enable enforcement",description:"Applies suspension rules based on overdue and risk controls."}),e.jsx(bm,{enabled:W.autoReactivateAfterPayment,onChange:S=>J(w=>({...w,autoReactivateAfterPayment:S})),label:"Auto-reactivate after payment",description:"When balances are cleared, services can resume automatically."})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Ft,{variant:"outline",onClick:()=>o("enforcement"),children:[e.jsx(et,{className:"h-4 w-4"})," Configure"]}),e.jsxs(Ft,{variant:"outline",onClick:()=>{W.freezeAllServices?(J(S=>({...S,freezeAllServices:!1})),r({title:"Freeze disabled",message:"Enforcement can now resume normal evaluation.",kind:"info"})):r({title:"Not frozen",message:"Risk freeze is not enabled.",kind:"info"})},children:[e.jsx(ko,{className:"h-4 w-4"})," Unfreeze"]})]})]}),e.jsxs(Es,{title:"Escalation ladder",subtitle:"Premium: finance to CFO to EVzone support.",right:e.jsx(xt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"space-y-2",children:_e.map((S,w)=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:["Step ",w+1,": ",S.level]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Notify: ",S.notify.join(", ")]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[jm(S.level,N).slice(0,3).map(h=>e.jsx(xt,{label:h.name,tone:"neutral"},h.id)),jm(S.level,N).length?null:e.jsx(xt,{label:"No contacts",tone:"warn"})]})]}),e.jsx(ht,{className:"h-5 w-5 text-emerald-700"})]})},S.level))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Escalation routing can be customized per stage in the Escalation tab."})]})]})]}):null,i==="dunning"?e.jsxs("div",{className:"flex flex-col-reverse gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Es,{title:"Dunning schedules",subtitle:"Upcoming due, overdue, and final notice. Configure channels and actions per stage.",right:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ft,{variant:"outline",onClick:m,children:[e.jsx(pt,{className:"h-4 w-4"})," Template"]}),e.jsxs(Ft,{variant:"primary",onClick:O,children:[e.jsx(pt,{className:"h-4 w-4"})," Stage"]})]}),children:[e.jsxs("div",{className:"space-y-2",children:[U.slice().sort((S,w)=>S.offsetDaysFromDue-w.offsetDaysFromDue).map(S=>{const w=L.find(h=>h.id===S.templateId);return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:S.name}),e.jsx(xt,{label:S.trigger,tone:"neutral"}),e.jsx(xt,{label:`Offset ${S.offsetDaysFromDue}d`,tone:"info"}),e.jsx(xt,{label:S.escalation,tone:S.escalation==="EVzone Support"?"warn":"neutral"}),e.jsx(xt,{label:S.action,tone:S.action==="Full stop"?"bad":S.action==="Soft pause"?"warn":"neutral"}),e.jsx(xt,{label:S.enabled?"Enabled":"Off",tone:S.enabled?"good":"neutral"})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Template: ",e.jsx("span",{className:"font-semibold",children:(w==null?void 0:w.name)||S.templateId})]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:t.map(h=>e.jsx(xt,{label:h,tone:S.channels[h]?"good":"neutral"},h))})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ft,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ee(S),children:[e.jsx(Qr,{className:"h-4 w-4"})," Edit"]}),e.jsxs(Ft,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ae(h=>h.map(K=>K.id===S.id?{...K,enabled:!K.enabled}:K)),children:[S.enabled?e.jsx(ra,{className:"h-4 w-4"}):e.jsx(ko,{className:"h-4 w-4"})," ",S.enabled?"Disable":"Enable"]}),e.jsx(Ft,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>D(S.id),children:e.jsx(as,{className:"h-4 w-4"})})]})]})},S.id)}),U.length?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No stages configured."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Best practice: ensure final notice includes all channels and escalates to CFO. EVzone support escalation is optional."})]}),e.jsx(Es,{title:"Templates",subtitle:"Premium: templates can be branded and channel-aware.",right:e.jsx(xt,{label:`${L.length}`,tone:"neutral"}),children:e.jsx("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:L.map(S=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:S.name}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:S.id}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:t.map(w=>e.jsx(xt,{label:w,tone:S.enabledChannels[w]?"good":"neutral"},w))})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(Ft,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>A(S),children:[e.jsx(Qr,{className:"h-4 w-4"})," Edit"]}),e.jsx(Ft,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>B(S.id),children:e.jsx(as,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[e.jsx("div",{className:"font-semibold",children:"Subject"}),e.jsx("div",{className:"mt-1 text-slate-700",children:S.subject}),e.jsx("div",{className:"mt-3 font-semibold",children:"Body"}),e.jsx("div",{className:"mt-1 text-slate-700",children:S.body})]})]},S.id))})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Es,{title:"Runbook",subtitle:"How dunning is executed.",right:e.jsx(xt,{label:"Core",tone:"neutral"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"1) Scheduler checks invoices and stage trigger times"}),e.jsx("li",{children:"2) Stage channels send to escalation recipients"}),e.jsx("li",{children:"3) Delivery logs are recorded per channel"}),e.jsx("li",{children:"4) Enforcement evaluates overdue thresholds and risk freeze"}),e.jsx("li",{children:"5) Payment triggers reactivation when configured"})]})}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Ft,{variant:"primary",onClick:Q,children:[e.jsx(sl,{className:"h-4 w-4"})," Run scheduler"]}),e.jsxs(Ft,{variant:"outline",onClick:()=>Fe(!0),children:[e.jsx(ht,{className:"h-4 w-4"})," Send now"]})]})]}),e.jsxs(Es,{title:"Enforcement mapping",subtitle:"Soft pause vs full stop per stage.",right:e.jsx(xt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"space-y-2",children:U.slice().sort((S,w)=>S.offsetDaysFromDue-w.offsetDaysFromDue).map(S=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:S.name}),e.jsxs("div",{className:"mt-0.5 text-xs text-slate-500",children:["Action: ",S.action]})]}),e.jsx(xt,{label:S.action,tone:S.action==="Full stop"?"bad":S.action==="Soft pause"?"warn":"neutral"})]})},S.id))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: enforcement is also driven by global thresholds in the Enforcement tab."})]})]})]}):null,i==="reminders"?e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Es,{title:"Filters",subtitle:"Search delivery logs.",right:e.jsx(xt,{label:"Core",tone:"neutral"}),children:[e.jsx(eb,{label:"Search",value:Te,onChange:Ee,placeholder:"invoice, stage, to..."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(cr,{label:"Channel",value:Re,onChange:S=>ze(S),options:[{value:"All",label:"All"},...t.map(S=>({value:S,label:S}))]}),e.jsx(cr,{label:"Status",value:qe,onChange:S=>He(S),options:[{value:"All",label:"All"},{value:"Delivered",label:"Delivered"},{value:"Failed",label:"Failed"},{value:"Queued",label:"Queued"}]})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:[e.jsxs(Ft,{variant:"outline",onClick:p,children:[e.jsx(gt,{className:"h-4 w-4"})," Export CSV"]}),e.jsxs(Ft,{variant:"outline",onClick:()=>{Ee(""),ze("All"),He("All"),r({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(fn,{className:"h-4 w-4"})," Reset"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Delivery logs show per-channel status for Email, WhatsApp, WeChat, and SMS."})]}),e.jsx(Es,{title:"Channel health",subtitle:"Delivery status summary.",right:e.jsx(xt,{label:"Premium",tone:"info"}),children:e.jsx("div",{className:"space-y-2",children:t.map(S=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-slate-900",children:[e.jsx("span",{className:"text-slate-600",children:jc(S)})," ",S]}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Delivered"}),e.jsx("div",{className:"mt-1 text-lg font-semibold text-slate-900",children:Ae[S].delivered})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsx(xt,{label:`Failed ${Ae[S].failed}`,tone:Ae[S].failed?"warn":"good"}),e.jsx(xt,{label:`Queued ${Ae[S].queued}`,tone:"neutral"})]})]})},S))})})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs(Es,{title:"Delivery logs",subtitle:"Audit-ready logs per channel.",right:e.jsx(xt,{label:`${Ke.length}`,tone:"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Invoice"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Stage"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Channel"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"To"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Details"})]})}),e.jsxs("tbody",{children:[Ke.map(S=>{const w=k.find(K=>K.id===S.invoiceId),h=U.find(K=>K.id===S.stageId);return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Zv(S.createdAt)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("button",{className:"text-left",onClick:()=>w&&b(w.id),children:[e.jsx("div",{className:"font-semibold text-slate-900",children:(w==null?void 0:w.invoiceNo)||S.invoiceId}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:(w==null?void 0:w.status)||"-"})]})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(h==null?void 0:h.name)||S.stageId}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:"inline-flex items-center gap-2 text-slate-700",children:[e.jsx("span",{className:"text-slate-600",children:jc(S.channel)}),S.channel]})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:S.to}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(xt,{label:S.status,tone:S.status==="Delivered"?"good":S.status==="Failed"?"warn":"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:S.error||"-"})]},S.id)}),Ke.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-12 text-center text-sm text-slate-600",children:"No delivery logs."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: failed deliveries can trigger escalation routing and alternate channels."})]})})]}):null,i==="enforcement"?e.jsxs("div",{className:"flex flex-col-reverse gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(Es,{title:"Simulation",subtitle:"Preview enforcement actions.",right:e.jsxs(Ft,{variant:"outline",onClick:()=>r({title:"Simulation",message:"Preview updated.",kind:"info"}),children:[e.jsx(Ar,{className:"h-4 w-4"})," Run"]}),children:e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-4",children:(()=>{const S=q4(k,W,s);return e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:Ls("grid h-10 w-10 place-items-center rounded-2xl bg-slate-50",Nc(S.mode)==="bad"?"bg-rose-100 text-rose-700":Nc(S.mode)==="warn"?"bg-amber-100 text-amber-800":"bg-emerald-100 text-emerald-700"),children:S.mode==="Active"?e.jsx(tt,{className:"h-5 w-5"}):S.mode==="Soft paused"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(ra,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:S.mode}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:S.reason})]})]})})()})}),e.jsx(Es,{title:"Enforcement audit log",subtitle:"Recent automated actions.",right:e.jsx(xt,{label:"5 events",tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 text-xs text-slate-600",children:[e.jsx("span",{className:"font-semibold text-slate-900",children:vc(s-2*24*3600*1e3)}),": System changed status from Active to Soft paused (Risk alert)."]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 text-xs text-slate-600",children:[e.jsx("span",{className:"font-semibold text-slate-900",children:vc(s-5*24*3600*1e3)}),": Payment received (INV-001). Enforcement restored to Active."]})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Es,{title:"Service suspension rules",subtitle:"Soft pause vs full stop. Reactivation after payment.",right:e.jsx(xt,{label:M.mode,tone:Nc(M.mode)}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(bm,{enabled:W.enabled,onChange:S=>J(w=>({...w,enabled:S})),label:"Enable enforcement",description:"Evaluates overdue and risk freeze rules."}),e.jsx(bm,{enabled:W.autoReactivateAfterPayment,onChange:S=>J(w=>({...w,autoReactivateAfterPayment:S})),label:"Auto-reactivate after payment",description:"When balances clear, services can resume."}),e.jsx(bc,{label:"Soft pause after overdue days",value:W.softPauseAfterOverdueDays,onChange:S=>J(w=>({...w,softPauseAfterOverdueDays:Math.max(0,S)})),hint:"Example: 3",disabled:!W.enabled}),e.jsx(bc,{label:"Full stop after overdue days",value:W.fullStopAfterOverdueDays,onChange:S=>J(w=>({...w,fullStopAfterOverdueDays:Math.max(0,S)})),hint:"Example: 10",disabled:!W.enabled}),e.jsx(bc,{label:"Final notice after overdue days",value:W.finalNoticeAfterOverdueDays,onChange:S=>J(w=>({...w,finalNoticeAfterOverdueDays:Math.max(0,S)})),hint:"Triggers stage and escalation",disabled:!W.enabled}),e.jsx(cr,{label:"Enforcement scope",value:W.scope,onChange:S=>J(w=>({...w,scope:S})),options:[{value:"CorporatePay only",label:"CorporatePay only"},{value:"All services",label:"All services"}],hint:"Soft pause affects checkout",disabled:!W.enabled})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Current evaluation"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Computed from invoices and rules."})]}),e.jsx(xt,{label:M.mode,tone:Nc(M.mode)})]}),e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:M.reason}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Max overdue: ",M.maxOverdueDays," day(s)  Overdue invoices: ",M.overdueCount]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Ft,{variant:W.freezeAllServices?"danger":"outline",onClick:()=>J(S=>({...S,freezeAllServices:!S.freezeAllServices})),children:[W.freezeAllServices?e.jsx(ko,{className:"h-4 w-4"}):e.jsx(ra,{className:"h-4 w-4"})," Risk freeze"]}),e.jsxs(Ft,{variant:"outline",onClick:()=>{q(S=>S.map(w=>w.balance>0&&w.status!=="Draft"?{...w,status:"Sent"}:w)),r({title:"Simulated",message:"Simulated compliance for unpaid invoices (demo).",kind:"info"})},children:[e.jsx(ht,{className:"h-4 w-4"})," Simulate compliance"]})]})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Reactivation occurs after payment when auto-reactivate is enabled and risk freeze is off."})]}),e.jsx(Es,{title:"Reactivation after payment",subtitle:"Mark overdue invoices paid and observe the enforcement state.",right:e.jsx(xt,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[Be.slice(0,5).map(S=>{const w=S.inv,h=j[w.entityId],K=(h==null?void 0:h.currency)||"UGX";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:w.invoiceNo}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[S.overdueDays," day(s) overdue  Balance ",vm(w.balance,K)]})]}),e.jsxs(Ft,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>v(w.id),children:[e.jsx(tt,{className:"h-4 w-4"})," Mark paid"]})]})},w.id)}),Be.length?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No overdue invoices."})]})})]}),e.jsxs("div",{className:"lg:col-span-5 space-y-4",children:[e.jsx(Es,{title:"Soft pause vs full stop",subtitle:"What each mode does.",right:e.jsx(xt,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Soft pause"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"CorporatePay is paused. Reminders continue. Users are prompted to resolve payment."})]}),e.jsx(xt,{label:"Soft paused",tone:"warn"})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Typical triggers: overdue beyond ",W.softPauseAfterOverdueDays," day(s), dispute in review, repeated reminder failures."]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Full stop"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Corporate-funded services are stopped until compliant. Escalations fire."})]}),e.jsx(xt,{label:"Full stopped",tone:"bad"})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Typical triggers: overdue beyond ",W.fullStopAfterOverdueDays," day(s), risk freeze, repeated failed collections."]})]})]})}),e.jsxs(Es,{title:"Escalation integration",subtitle:"When enforcement changes, routing escalates.",right:e.jsx(xt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"1) Upcoming due reminders go to Finance"}),e.jsx("li",{children:"2) Overdue reminders escalate to Finance and optionally CFO"}),e.jsx("li",{children:"3) Final notice escalates to CFO"}),e.jsx("li",{children:"4) Extended delinquency can involve EVzone support"})]})}),e.jsx("div",{className:"mt-3",children:e.jsxs(Ft,{variant:"outline",onClick:()=>o("escalation"),children:[e.jsx(et,{className:"h-4 w-4"})," Open routing"]})})]})]})]}):null,i==="escalation"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-7 space-y-4",children:[e.jsxs(Es,{title:"Escalation routing",subtitle:"Premium: finance to CFO to EVzone support.",right:e.jsx(xt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"space-y-2",children:U.slice().sort((S,w)=>S.offsetDaysFromDue-w.offsetDaysFromDue).map(S=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:S.name}),e.jsx(xt,{label:S.trigger,tone:"neutral"}),e.jsx(xt,{label:`Offset ${S.offsetDaysFromDue}d`,tone:"info"}),e.jsx(xt,{label:`Escalation ${S.escalation}`,tone:S.escalation==="EVzone Support"?"warn":"neutral"})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Recipients: ",jm(S.escalation,N).map(w=>w.name).join(", ")||"None"]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:t.map(w=>e.jsx(xt,{label:w,tone:S.channels[w]?"good":"neutral"},w))})]}),e.jsxs(Ft,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ee(S),children:[e.jsx(Qr,{className:"h-4 w-4"})," Edit stage"]})]})},S.id))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Escalation routing can include EVzone support as a role-gated support desk."})]}),e.jsxs(Es,{title:"Contacts",subtitle:"Configure who receives reminders and escalations.",right:e.jsx(xt,{label:`${N.length}`,tone:"neutral"}),children:[e.jsx("div",{className:"space-y-2",children:N.map(S=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:S.name}),e.jsx(xt,{label:S.role,tone:S.role==="EVzone Support"?"warn":"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[S.email,"  ",S.phone]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:t.map(w=>e.jsx(xt,{label:w,tone:S.channels[w]?"good":"neutral"},w))})]}),e.jsxs(Ft,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{$(w=>w.map(h=>h.id===S.id?{...h,channels:{...h.channels,WhatsApp:!h.channels.WhatsApp}}:h)),r({title:"Updated",message:"Updated contact channels (demo).",kind:"info"})},children:[e.jsx(Us,{className:"h-4 w-4"})," Toggle WhatsApp"]})]})},S.id))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"In production, contacts come from Billing Contacts (D) and Invoice Groups (N)."})]})]}),e.jsxs("div",{className:"lg:col-span-5 space-y-4",children:[e.jsxs(Es,{title:"Routing ladder",subtitle:"Premium: who gets notified by escalation level.",right:e.jsx(xt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"space-y-2",children:_e.map((S,w)=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:["Step ",w+1,": ",S.level]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Notify channels: ",S.notify.join(", ")]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:jm(S.level,N).map(h=>e.jsx(xt,{label:h.name,tone:"neutral"},h.id))})]}),e.jsx(ht,{className:"h-5 w-5 text-emerald-700"})]}),e.jsx("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:t.map(h=>{const K=S.notify.includes(h);return e.jsxs("button",{type:"button",className:Ls("inline-flex items-center gap-2 rounded-2xl border px-3 py-2 text-xs font-semibold",K?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),onClick:()=>{le(V=>V.map(Ce=>{if(Ce.level!==S.level)return Ce;const I=new Set(Ce.notify);return I.has(h)?I.delete(h):I.add(h),{...Ce,notify:Array.from(I)}}))},children:[e.jsx("span",{className:"text-slate-600",children:jc(h)}),h]},h)})})]},S.level))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: routing can escalate based on repeated failures and dispute SLA breaches."})]}),e.jsx(Es,{title:"Test routing",subtitle:"Pick an invoice and stage to simulate send.",right:e.jsx(xt,{label:"Demo",tone:"neutral"}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx(cr,{label:"Invoice",value:ke.invoiceId,onChange:S=>fe(w=>({...w,invoiceId:S})),options:k.map(S=>({value:S.id,label:S.invoiceNo}))}),e.jsx(cr,{label:"Stage",value:ke.stageId,onChange:S=>fe(w=>({...w,stageId:S})),options:U.map(S=>({value:S.id,label:`${S.name} (${S.offsetDaysFromDue}d)`}))}),e.jsxs(Ft,{variant:"primary",onClick:()=>{C(ke.invoiceId,ke.stageId,"Routing test"),o("reminders")},children:[e.jsx(ht,{className:"h-4 w-4"})," Send test"]})]})})]})]}):null,i==="health"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-5 space-y-4",children:[e.jsxs(Es,{title:"Customer health score",subtitle:"Premium: risk score and predicted delinquency.",right:e.jsx(xt,{label:`${ge}/100`,tone:ge>=75?"good":ge>=45?"warn":"bad"}),children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Predicted risk"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:ue}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Based on overdue, disputes, and delivery failures"})]}),e.jsx("div",{className:Ls("grid h-12 w-12 place-items-center rounded-2xl ring-1",ue==="High"?"bg-rose-50 text-rose-700 ring-rose-200":ue==="Medium"?"bg-amber-50 text-amber-800 ring-amber-200":"bg-emerald-50 text-emerald-700 ring-emerald-200"),children:e.jsx(ht,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3",children:[e.jsx(se,{label:"Max overdue days",value:`${M.maxOverdueDays}`,tone:M.maxOverdueDays>=W.fullStopAfterOverdueDays?"bad":M.maxOverdueDays>=W.softPauseAfterOverdueDays?"warn":"good"}),e.jsx(se,{label:"Overdue invoices",value:`${Be.length}`,tone:Be.length?"warn":"good"}),e.jsx(se,{label:"Open disputes",value:`${be.filter(S=>S.status==="Open"||S.status==="In review").length}`,tone:oe.openCount?"warn":"good"}),e.jsx(se,{label:"Delivery failures",value:`${De}`,tone:De?"warn":"good"}),e.jsx(se,{label:"Final notice candidates",value:`${H.length}`,tone:H.length?"warn":"good"})]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: predicted delinquency can be improved with real historical payment patterns and external signals."})]}),e.jsxs(Es,{title:"Dispute SLA controls",subtitle:"Premium: SLA compliance tracking for billing disputes.",right:e.jsx(xt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(bc,{label:"First response SLA (hours)",value:we.firstResponseHours,onChange:S=>G(w=>({...w,firstResponseHours:Math.max(1,S)}))}),e.jsx(bc,{label:"Resolution SLA (hours)",value:we.resolutionHours,onChange:S=>G(w=>({...w,resolutionHours:Math.max(1,S)}))})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"First response compliance"}),e.jsxs("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:[oe.complianceFirst,"%"]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Breaches: ",oe.firstRespBreaches.length]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Resolution compliance"}),e.jsxs("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:[oe.complianceResolution,"%"]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Breaches: ",oe.resolutionBreaches.length]})]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Ft,{variant:"primary",onClick:()=>ne(!0),children:[e.jsx(sy,{className:"h-4 w-4"})," View disputes"]}),e.jsxs(Ft,{variant:"outline",onClick:()=>{const S="DSP-011";Ge(w=>w.map(h=>h.id===S?{...h,firstResponseAt:Date.now(),lastUpdatedAt:Date.now(),status:"In review"}:h)),r({title:"Updated",message:"Simulated first response on a dispute.",kind:"success"})},children:[e.jsx(ht,{className:"h-4 w-4"})," Simulate response"]})]})]})]}),e.jsxs("div",{className:"lg:col-span-7 space-y-4",children:[e.jsx(Es,{title:"Recommendations",subtitle:"Premium next-best actions.",right:e.jsx(xt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{title:"Run scheduler",detail:"Send upcoming and overdue reminders across channels.",cta:"Run now",onClick:Q}),e.jsx(y,{title:"Escalate final notices",detail:`There are ${H.length} invoice(s) past the final notice threshold.`,cta:"Open dunning",onClick:()=>o("dunning")}),e.jsx(y,{title:"Fix delivery failures",detail:`There are ${De} failed delivery attempts. Enable alternate channels or correct contact info.`,cta:"Open logs",onClick:()=>o("reminders")}),e.jsx(y,{title:"Dispute SLA",detail:`Open disputes: ${oe.openCount}. First response compliance: ${oe.complianceFirst}%.`,cta:"Open SLA",onClick:()=>ne(!0)}),e.jsx(y,{title:"Enforcement rules",detail:`Current mode: ${M.mode}. Review thresholds and scope.`,cta:"Configure",onClick:()=>o("enforcement")})]})}),e.jsxs(Es,{title:"Multi-channel coverage",subtitle:"Automated reminders via Email, WhatsApp, WeChat, and SMS.",right:e.jsx(xt,{label:"Core",tone:"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Stage"}),t.map(S=>e.jsx("th",{className:"px-4 py-3 font-semibold",children:S},S)),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Escalation"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Action"})]})}),e.jsx("tbody",{children:U.slice().sort((S,w)=>S.offsetDaysFromDue-w.offsetDaysFromDue).map(S=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:S.name}),t.map(w=>e.jsx("td",{className:"px-4 py-3",children:e.jsx(xt,{label:S.channels[w]?"On":"Off",tone:S.channels[w]?"good":"neutral"})},w)),e.jsx("td",{className:"px-4 py-3",children:e.jsx(xt,{label:S.escalation,tone:S.escalation==="EVzone Support"?"warn":"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(xt,{label:S.action,tone:S.action==="Full stop"?"bad":S.action==="Soft pause"?"warn":"neutral"})})]},S.id))})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"For best results, enable at least two channels per stage and validate contact preferences."})]})]})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"P Collections, Reminders and Enforcement v2. Core: automated reminders on Email, WhatsApp, WeChat, SMS; dunning schedules; service suspension; reactivation after payment. Premium: escalation routing; customer health and predicted risk; dispute SLA compliance."})})]})}),e.jsx(Ah,{open:Me,title:Ue.id?"Edit dunning stage":"New dunning stage",subtitle:"Configure trigger timing, channels, escalation routing, and enforcement action.",onClose:()=>je(!1),actions:[{label:"Save",onClick:F}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Ft,{variant:"outline",onClick:()=>je(!1),children:"Cancel"}),e.jsxs(Ft,{variant:"primary",onClick:F,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(eb,{label:"Name",value:Ue.name,onChange:S=>Oe(w=>({...w,name:S})),placeholder:"Overdue reminder"}),e.jsx(bm,{enabled:Ue.enabled,onChange:S=>Oe(w=>({...w,enabled:S})),label:"Enabled",description:"If off, scheduler will skip it."}),e.jsx(cr,{label:"Trigger",value:Ue.trigger,onChange:S=>Oe(w=>({...w,trigger:S})),options:[{value:"Upcoming due",label:"Upcoming due"},{value:"Overdue",label:"Overdue"},{value:"Final notice",label:"Final notice"}]}),e.jsx(bc,{label:"Offset days from due",value:Ue.offsetDaysFromDue,onChange:S=>Oe(w=>({...w,offsetDaysFromDue:S})),hint:"Negative means before due"}),e.jsx(cr,{label:"Template",value:Ue.templateId,onChange:S=>Oe(w=>({...w,templateId:S})),options:L.map(S=>({value:S.id,label:S.name}))}),e.jsx(cr,{label:"Escalation",value:Ue.escalation,onChange:S=>Oe(w=>({...w,escalation:S})),options:[{value:"Finance",label:"Finance"},{value:"CFO",label:"CFO"},{value:"EVzone Support",label:"EVzone Support"}]}),e.jsx(cr,{label:"Enforcement action",value:Ue.action,onChange:S=>Oe(w=>({...w,action:S})),options:[{value:"None",label:"None"},{value:"Soft pause",label:"Soft pause"},{value:"Full stop",label:"Full stop"}]}),e.jsxs("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Channels"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Select the channels to send this stage."}),e.jsx("div",{className:"mt-3 grid grid-cols-2 gap-2 sm:grid-cols-4",children:t.map(S=>{const w=Ue.channels[S];return e.jsxs("button",{type:"button",className:Ls("flex items-center justify-between gap-2 rounded-2xl border px-3 py-2 text-sm font-semibold",w?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),onClick:()=>Oe(h=>({...h,channels:{...h.channels,[S]:!h.channels[S]}})),children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:Ls("text-slate-600",w&&"text-emerald-700"),children:jc(S)}),S]}),e.jsx(xt,{label:w?"On":"Off",tone:w?"good":"neutral"})]},S)})})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs(Ft,{variant:"outline",className:"w-full",onClick:()=>{je(!1),r({title:"Tip",message:"Use Send now to test a stage.",kind:"info"})},children:[e.jsx(ht,{className:"h-4 w-4"})," Save and test later"]})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Note: stage actions are guidance. Global enforcement rules still apply."})]})}),e.jsx(Ah,{open:he,title:Ie.id?"Edit template":"New template",subtitle:"Templates support placeholders: {invoiceNo}, {dueDate}, {balance}, {contactName}",onClose:()=>Y(!1),actions:[{label:"Save",onClick:f}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Ft,{variant:"outline",onClick:()=>Y(!1),children:"Cancel"}),e.jsxs(Ft,{variant:"primary",onClick:f,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(eb,{label:"Name",value:Ie.name,onChange:S=>ce(w=>({...w,name:S})),placeholder:"Upcoming due reminder"}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Enabled channels"}),e.jsx("div",{className:"mt-3 grid grid-cols-2 gap-2 sm:grid-cols-4",children:t.map(S=>e.jsxs("button",{type:"button",className:Ls("flex items-center justify-between gap-2 rounded-2xl border px-3 py-2 text-sm font-semibold",Ie.enabledChannels[S]?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),onClick:()=>ce(w=>({...w,enabledChannels:{...w.enabledChannels,[S]:!w.enabledChannels[S]}})),children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:Ls("text-slate-600",Ie.enabledChannels[S]&&"text-emerald-700"),children:jc(S)}),S]}),e.jsx(xt,{label:Ie.enabledChannels[S]?"On":"Off",tone:Ie.enabledChannels[S]?"good":"neutral"})]},S))})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(tb,{label:"Subject",value:Ie.subject,onChange:S=>ce(w=>({...w,subject:S})),placeholder:"Upcoming invoice due: {invoiceNo}",hint:"Used for Email",rows:2})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(tb,{label:"Body",value:Ie.body,onChange:S=>ce(w=>({...w,body:S})),placeholder:"Hello {contactName}...",rows:6})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: keep SMS short and actionable. Use WhatsApp for richer content."})]})}),e.jsx(Ah,{open:Qe,title:"Send reminder now",subtitle:"Manual send for a specific invoice and stage.",onClose:()=>Fe(!1),actions:[{label:"Send",onClick:()=>{C(ke.invoiceId,ke.stageId,ke.note||"Manual"),Fe(!1)}}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Ft,{variant:"outline",onClick:()=>Fe(!1),children:"Cancel"}),e.jsxs(Ft,{variant:"primary",onClick:()=>{C(ke.invoiceId,ke.stageId,ke.note||"Manual"),Fe(!1)},children:[e.jsx(ht,{className:"h-4 w-4"})," Send"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(cr,{label:"Invoice",value:ke.invoiceId,onChange:S=>fe(w=>({...w,invoiceId:S})),options:k.map(S=>({value:S.id,label:S.invoiceNo}))}),e.jsx(cr,{label:"Stage",value:ke.stageId,onChange:S=>fe(w=>({...w,stageId:S})),options:U.map(S=>({value:S.id,label:`${S.name} (${S.offsetDaysFromDue}d)`}))}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(tb,{label:"Note",value:ke.note,onChange:S=>fe(w=>({...w,note:S})),placeholder:"Why are you sending this now",rows:3})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Manual sends are logged per channel. Duplicate sends for the same stage and channel are prevented."})]})}),e.jsx(b_,{open:me,title:z?z.invoiceNo:"Invoice",subtitle:z?`${((re=j[z.entityId])==null?void 0:re.name)||z.entityId}  ${((ve=g[z.invoiceGroupId])==null?void 0:ve.name)||z.invoiceGroupId}`:"",onClose:()=>pe(!1),footer:z?e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Collections actions are audit logged in production."}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ft,{variant:"outline",onClick:()=>{var S;fe({invoiceId:z.id,stageId:((S=U[0])==null?void 0:S.id)||"STG-1",note:"Manual"}),Fe(!0)},children:[e.jsx(ht,{className:"h-4 w-4"})," Remind"]}),e.jsxs(Ft,{variant:"primary",onClick:()=>v(z.id),children:[e.jsx(tt,{className:"h-4 w-4"})," Mark paid"]})]})]}):null,children:z?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(xt,{label:z.status,tone:sb(z.status)}),e.jsx(xt,{label:`Issue ${vc(z.issueDate)}`,tone:"neutral"}),e.jsx(xt,{label:`Due ${vc(z.dueDate)}`,tone:z.status==="Overdue"?"bad":"neutral"}),z.openDisputes?e.jsx(xt,{label:`${z.openDisputes} dispute`,tone:"warn"}):null]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Last reminder: ",z.lastReminderAt?G4(z.lastReminderAt):"None"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Balance"}),e.jsx("div",{className:"mt-1 text-lg font-semibold text-slate-900",children:vm(z.balance,((P=j[z.entityId])==null?void 0:P.currency)||"UGX")}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Total: ",vm(z.total,((X=j[z.entityId])==null?void 0:X.currency)||"UGX")]})]})]})}),e.jsx(Es,{title:"Dunning timeline",subtitle:"Stages evaluated based on due date and offsets.",right:e.jsx(xt,{label:"Core",tone:"neutral"}),children:e.jsx("div",{className:"space-y-2",children:U.slice().sort((S,w)=>S.offsetDaysFromDue-w.offsetDaysFromDue).map(S=>{const w=z.dueDate+S.offsetDaysFromDue*T,h=ie.some(V=>V.invoiceId===z.id&&V.stageId===S.id),K=s>=w;return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:S.name}),e.jsx(xt,{label:`Offset ${S.offsetDaysFromDue}d`,tone:"info"}),e.jsx(xt,{label:K?"Eligible":"Not yet",tone:K?"warn":"neutral"}),e.jsx(xt,{label:h?"Sent":"Not sent",tone:h?"good":"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Trigger time: ",vc(w)]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:t.map(V=>e.jsx(xt,{label:V,tone:S.channels[V]?"good":"neutral"},V))})]}),e.jsxs(Ft,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>C(z.id,S.id,"From invoice"),disabled:!S.enabled,children:[e.jsx(ht,{className:"h-4 w-4"})," Send"]})]})},S.id)})})}),e.jsx(Es,{title:"Delivery records",subtitle:"Logs for this invoice.",right:e.jsx(xt,{label:"Core",tone:"neutral"}),children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Stage"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Channel"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"To"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Error"})]})}),e.jsxs("tbody",{children:[ie.filter(S=>S.invoiceId===z.id).slice().sort((S,w)=>w.createdAt-S.createdAt).map(S=>{var w;return e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Zv(S.createdAt)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:((w=U.find(h=>h.id===S.stageId))==null?void 0:w.name)||S.stageId}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:S.channel}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:S.to}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(xt,{label:S.status,tone:S.status==="Delivered"?"good":S.status==="Failed"?"warn":"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:S.error||"-"})]},S.id)}),ie.some(S=>S.invoiceId===z.id)?null:e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No delivery logs for this invoice."})})]})]})})})]}):null}),e.jsx(Ah,{open:Ve,title:"Billing disputes SLA",subtitle:"Premium: SLA compliance tracking for billing disputes.",onClose:()=>ne(!1),footer:e.jsx("div",{className:"flex justify-end",children:e.jsx(Ft,{variant:"outline",onClick:()=>ne(!1),children:"Close"})}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Open disputes"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:oe.openCount}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Including In review"})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"First response breaches"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:oe.firstRespBreaches.length}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["SLA ",we.firstResponseHours,"h"]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Resolution breaches"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:oe.resolutionBreaches.length}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["SLA ",we.resolutionHours,"h"]})]})]}),e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Dispute"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Invoice"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Age"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"First response"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Resolution SLA"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[be.slice().sort((S,w)=>{const h=S.status==="Open"||S.status==="In review",K=w.status==="Open"||w.status==="In review";return h!==K?h?-1:1:w.createdAt-S.createdAt}).map(S=>{const w=k.find(Ce=>Ce.id===S.invoiceId),h=Math.round((s-S.createdAt)/(60*60*1e3)*10)/10,K=!S.firstResponseAt&&h>we.firstResponseHours&&(S.status==="Open"||S.status==="In review"),V=h>we.resolutionHours&&(S.status==="Open"||S.status==="In review");return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:S.id}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(w==null?void 0:w.invoiceNo)||S.invoiceId}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(xt,{label:S.status,tone:sb(S.status)})}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[h,"h"]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(xt,{label:S.firstResponseAt?"Done":K?"Breached":"Pending",tone:S.firstResponseAt?"good":K?"bad":"warn"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(xt,{label:V?"Breached":"OK",tone:V?"bad":"good"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ft,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Ge(Ce=>Ce.map(I=>I.id===S.id?{...I,firstResponseAt:I.firstResponseAt||Date.now(),lastUpdatedAt:Date.now(),status:"In review"}:I)),r({title:"Updated",message:"First response recorded.",kind:"success"})},disabled:!!S.firstResponseAt,children:[e.jsx(ht,{className:"h-4 w-4"})," First response"]}),e.jsxs(Ft,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>{Ge(Ce=>Ce.map(I=>I.id===S.id?{...I,status:"Resolved",lastUpdatedAt:Date.now()}:I)),r({title:"Resolved",message:"Dispute resolved.",kind:"success"})},disabled:S.status==="Resolved",children:[e.jsx(tt,{className:"h-4 w-4"})," Resolve"]})]})})]},S.id)}),be.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-12 text-center text-sm text-slate-600",children:"No disputes."})})]})]})}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: SLA breaches can trigger escalation routing and pause enforcement until reviewed."})]})})]});function se({label:S,value:w,tone:h}){const K=h==="good"?"bg-emerald-50 text-emerald-900 ring-emerald-200":h==="warn"?"bg-amber-50 text-amber-900 ring-amber-200":"bg-rose-50 text-rose-900 ring-rose-200";return e.jsxs("div",{className:Ls("flex items-center justify-between gap-3 rounded-2xl p-3 text-xs ring-1",K),children:[e.jsx("div",{className:"font-semibold",children:S}),e.jsx("div",{className:"font-semibold",children:w})]})}function y({title:S,detail:w,cta:h,onClick:K}){return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:S}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:w})]}),e.jsxs(Ft,{variant:"outline",className:"px-3 py-2 text-xs",onClick:K,children:[e.jsx(et,{className:"h-4 w-4"})," ",h]})]})})}}const hg={green:"#03CD8C",orange:"#F77F00"};function oa(...t){return t.filter(Boolean).join(" ")}function ao(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function my(t,s,a){return Math.max(s,Math.min(a,t))}function Ma(t,s){const a=Math.round(Number(t||0));try{return new Intl.NumberFormat(void 0,{style:"currency",currency:s,maximumFractionDigits:0}).format(a)}catch{return`${s} ${a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}}function C_(t){return new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"2-digit"})}function dd(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function z4(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function xy(t,s){return Math.floor(Math.abs(t-s)/864e5)}function kt({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:oa("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function St({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:hg.green}:t==="accent"?{background:hg.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:oa(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function mi({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:oa(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:oa("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function Eh({label:t,value:s,onChange:a,hint:l,disabled:n}){return e.jsxs("div",{className:oa(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",min:0,onKeyDown:r=>(r.key==="-"||r.key==="e")&&r.preventDefault(),value:s,onChange:r=>{const i=Number(r.target.value||0);i>=0&&a(i)},disabled:n,className:oa("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function cd({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:oa(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:oa("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function S_({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4,disabled:i}){return e.jsxs("div",{className:oa(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:o=>a(o.target.value),placeholder:l,rows:r,disabled:i,className:oa("mt-2 w-full rounded-2xl border p-3 text-sm font-semibold shadow-sm outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function A_({actions:t}){const[s,a]=Xt.useState(!1),l=Xt.useRef(null);return Xt.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:oa("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function Mh({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="980px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:12,scale:.985},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:12,scale:.985},transition:{duration:.18},className:"fixed inset-x-0 bottom-4 top-4 z-50 mx-auto flex w-[min(1020px,calc(100vw-2rem))] flex-col overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i,maxHeight:"92vh"},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex shrink-0 items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(A_,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"shrink-0 border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function E_({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(480px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:oa("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function gl({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function ab(t,s){const a=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),l=URL.createObjectURL(a),n=document.createElement("a");n.href=l,n.download=t,n.click(),URL.revokeObjectURL(l)}function M_(t,s){const a=r=>{const i=String(r??"");return/[",\n]/.test(i)?`"${i.replace(/"/g,'""')}"`:i},l=s.map(r=>a(r.label)).join(","),n=t.map(r=>s.map(i=>a(r[i.key])).join(",")).join(`
`);return`${l}
${n}`}function P_(t,s,a="text/plain"){const l=new Blob([s],{type:a}),n=URL.createObjectURL(l),r=document.createElement("a");r.href=n,r.download=t,r.click(),URL.revokeObjectURL(n)}function O_(t,s){return t==="Vendor"?s.vendor||"-":t==="Service module"?s.serviceModule||"-":t==="Marketplace"?s.marketplace||"-":t==="Group"?s.group||"-":t==="Cost center"?s.costCenter||"-":t==="Tax code"?s.taxCode||"-":t==="Transaction type"?s.type||"-":t==="Transaction status"&&s.status||"-"}function W4(t,s,a,l){const n={};for(const r of t){const i=O_(s,r),o=a==="Count"?1:Number(r[l]||0);n[i]=n[i]||{key:i,value:0},n[i].value+=o}return Object.values(n).sort((r,i)=>i.value-r.value)}function H4(t,s,a){let l=1;if(a.requireSameVendor&&t.vendor!==s.vendor)return 0;if(a.requireSameModule&&t.serviceModule!==s.serviceModule&&(l*=.65),a.requireSameMarketplace){const x=(t.marketplace||"-").trim(),j=(s.marketplace||"-").trim();x!==j&&(l*=.55)}const n=xy(t.serviceDate,s.occurredAt),r=n<=Math.max(0,a.dateWindowDays);l*=r?1:Math.max(0,1-(n-a.dateWindowDays)*.12);const i=Math.max(.001,a.amountTolerancePct/100),o=Math.abs(t.amount-s.amount)/Math.max(1,t.amount),c=o<=i;return l*=c?1:Math.max(0,1-(o-i)*2.2),l*=s.status==="Posted"?1:s.status==="Pending"?.7:0,t.currency!==s.currency?0:my(l,0,1)}function T_(){const s=Date.now(),[a,l]=d.useState([]),n=I=>{const te=ao("toast");l(Se=>[{id:te,...I},...Se].slice(0,4)),window.setTimeout(()=>l(Se=>Se.filter(Xe=>Xe.id!==te)),3200)},[r,i]=d.useState("recon"),[o,c]=d.useState(()=>[{id:"TX-9001",type:"Wallet debit",status:"Posted",currency:"UGX",amount:165e3,vendor:"EVzone Rides",serviceModule:"Rides & Logistics",marketplace:"-",group:"Operations",costCenter:"OPS-001",taxCode:"VAT18",occurredAt:s-4*864e5,reference:"TRP-84001",note:"Airport pickup"},{id:"TX-9002",type:"Wallet debit",status:"Posted",currency:"UGX",amount:98e3,vendor:"EVzone Rides",serviceModule:"Rides & Logistics",marketplace:"-",group:"Operations",costCenter:"OPS-001",taxCode:"VAT18",occurredAt:s-4*864e5,reference:"TRP-84002",note:"City commute"},{id:"TX-9010",type:"Wallet debit",status:"Failed",currency:"UGX",amount:12e4,vendor:"EVzone Rides",serviceModule:"Rides & Logistics",marketplace:"-",group:"Sales",costCenter:"SALES-TRAVEL",taxCode:"VAT18",occurredAt:s-2*864e5,reference:"TRP-99001",note:"Client site"},{id:"TX-9020",type:"Credit draw",status:"Posted",currency:"UGX",amount:9e5,vendor:"Shenzhen Store",serviceModule:"E-Commerce",marketplace:"MyLiveDealz",group:"Procurement",costCenter:"PROC-001",taxCode:"VAT0",occurredAt:s-8*864e5,reference:"ORD-MLD-4401",note:"Deal order"},{id:"TX-9021",type:"Credit draw",status:"Posted",currency:"UGX",amount:11e5,vendor:"Shenzhen Store",serviceModule:"E-Commerce",marketplace:"MyLiveDealz",group:"Procurement",costCenter:"PROC-001",taxCode:"VAT0",occurredAt:s-8*864e5,reference:"ORD-MLD-4402",note:"Deal order"},{id:"TX-9030",type:"Prepaid spend",status:"Posted",currency:"UGX",amount:24e5,vendor:"Kampala Office Mart",serviceModule:"E-Commerce",marketplace:"EVmart",group:"Procurement",costCenter:"PROC-001",taxCode:"VAT18",occurredAt:s-9*864e5,reference:"ORD-EVM-2001",note:"Office supplies"},{id:"TX-9040",type:"Refund",status:"Pending",currency:"UGX",amount:2e5,vendor:"EVzone Rides",serviceModule:"Rides & Logistics",marketplace:"-",group:"Finance",costCenter:"FIN-OPS",taxCode:"VAT18",occurredAt:s-1*864e5,reference:"RFND-1001",note:"Refund pending"},{id:"TX-9050",type:"Reversal",status:"Posted",currency:"UGX",amount:15e4,vendor:"EVzone Rides",serviceModule:"Rides & Logistics",marketplace:"-",group:"Finance",costCenter:"FIN-OPS",taxCode:"VAT18",occurredAt:s-12*864e5,reference:"REV-2001",note:"Duplicate correction"}]),[x,j]=d.useState(()=>[{id:"IL-1001",invoiceNo:"ACME-202601-1042",invoiceId:"INV-0001",entityId:"ENT-UG",currency:"UGX",serviceDate:s-4*864e5,description:"Airport pickup TRP-84001",vendor:"EVzone Rides",serviceModule:"Rides & Logistics",marketplace:"-",group:"Operations",costCenter:"OPS-001",projectTag:"Office commute",taxCode:"VAT18",amount:165e3},{id:"IL-1002",invoiceNo:"ACME-202601-1042",invoiceId:"INV-0001",entityId:"ENT-UG",currency:"UGX",serviceDate:s-4*864e5,description:"City commute TRP-84002",vendor:"EVzone Rides",serviceModule:"Rides & Logistics",marketplace:"-",group:"Operations",costCenter:"OPS-001",projectTag:"Office commute",taxCode:"VAT18",amount:98e3},{id:"IL-1101",invoiceNo:"ACME-202601-1042",invoiceId:"INV-0001",entityId:"ENT-UG",currency:"UGX",serviceDate:s-8*864e5,description:"MyLiveDealz orders",vendor:"Shenzhen Store",serviceModule:"E-Commerce",marketplace:"MyLiveDealz",group:"Procurement",costCenter:"PROC-001",projectTag:"High value",taxCode:"VAT0",amount:2e6},{id:"IL-1201",invoiceNo:"ACME-202601-1042",invoiceId:"INV-0001",entityId:"ENT-UG",currency:"UGX",serviceDate:s-9*864e5,description:"EVmart supplies",vendor:"Kampala Office Mart",serviceModule:"E-Commerce",marketplace:"EVmart",group:"Procurement",costCenter:"PROC-001",projectTag:"Office supplies",taxCode:"VAT18",amount:24e5},{id:"IL-2001",invoiceNo:"ACME-SALES-202512-0088",invoiceId:"INV-0002",entityId:"ENT-UG",currency:"UGX",serviceDate:s-2*864e5,description:"Sales travel ride TRP-99001",vendor:"EVzone Rides",serviceModule:"Rides & Logistics",marketplace:"-",group:"Sales",costCenter:"SALES-TRAVEL",projectTag:"Client meetings",taxCode:"VAT18",amount:12e4}]),[g,N]=d.useState(()=>[{id:"R-01",name:"Strict: same vendor, amount, and date",enabled:!0,requireSameVendor:!0,requireSameModule:!1,requireSameMarketplace:!1,dateWindowDays:1,amountTolerancePct:0,minConfidence:.92,allowPartialMatch:!1},{id:"R-02",name:"Standard: vendor + amount tolerance",enabled:!0,requireSameVendor:!0,requireSameModule:!0,requireSameMarketplace:!1,dateWindowDays:7,amountTolerancePct:5,minConfidence:.85,allowPartialMatch:!0},{id:"R-03",name:"Marketplace: vendor + marketplace",enabled:!0,requireSameVendor:!0,requireSameModule:!0,requireSameMarketplace:!0,dateWindowDays:14,amountTolerancePct:10,minConfidence:.8,allowPartialMatch:!0}]),[$,T]=d.useState(()=>[{id:"MAP-DEF",scope:"Default",key:"*",glCode:"4000",costCenter:"ORG",taxCode:"VAT18",memo:"Default mapping",enabled:!0},{id:"MAP-MOD-RIDES",scope:"Module",key:"Rides & Logistics",glCode:"4100",costCenter:"OPS-001",taxCode:"VAT18",memo:"Ride revenue",enabled:!0},{id:"MAP-MOD-CHG",scope:"Module",key:"EVs & Charging",glCode:"4200",costCenter:"OPS-001",taxCode:"VAT18",memo:"Charging",enabled:!0},{id:"MAP-MKT-MYLIVE",scope:"Marketplace",key:"MyLiveDealz",glCode:"4305",costCenter:"PROC-001",taxCode:"VAT0",memo:"Deals marketplace",enabled:!0},{id:"MAP-VND-SHEN",scope:"Vendor",key:"Shenzhen Store",glCode:"5001",costCenter:"PROC-001",taxCode:"VAT0",memo:"Imports vendor",enabled:!0}]),[k,q]=d.useState(()=>[{id:"MT-01",lineId:"IL-1001",txId:"TX-9001",amount:165e3,method:"Auto",confidence:.98,ruleId:"R-01",createdAt:s-2*60*60*1e3,createdBy:"System",note:"Auto-match"},{id:"MT-02",lineId:"IL-1002",txId:"TX-9002",amount:98e3,method:"Auto",confidence:.98,ruleId:"R-01",createdAt:s-2*60*60*1e3,createdBy:"System",note:"Auto-match"}]),[L,R]=d.useState(()=>[{id:"EX-100",kind:"Failed charge",severity:"Critical",status:"Open",createdAt:s-2*864e5,txId:"TX-9010",invoiceNo:"ACME-SALES-202512-0088",message:"Transaction failed for Sales travel ride. No posted payment exists.",suggestedNext:"Retry charge or route to exceptions approval"},{id:"EX-101",kind:"Refund pending",severity:"Warning",status:"Investigating",createdAt:s-1*864e5,txId:"TX-9040",invoiceNo:"ACME-202601-1042",message:"Refund is pending and may need approval to post.",suggestedNext:"Approve refund or schedule follow-up"}]),[U,ae]=d.useState(()=>[{id:"AU-001",at:s-2*60*60*1e3,actor:"System",action:"AUTO_MATCH_RUN",entityRef:"Batch",details:"Auto-matched 2 lines"}]),[ie,_]=d.useState(""),[W,J]=d.useState("All"),[we,G]=d.useState("All"),[be,Ge]=d.useState(""),[Me,je]=d.useState("Unmatched"),[Ue,Oe]=d.useState(""),[he,Y]=d.useState("All"),[Ie,ce]=d.useState(null),[me,pe]=d.useState(null),[de,ye]=d.useState(!1),[Qe,Fe]=d.useState({amount:0,note:""}),[ke,fe]=d.useState(!1),[Ve,ne]=d.useState(null),[Te,Ee]=d.useState(!1),[Re,ze]=d.useState(null),[qe,He]=d.useState(!1),_e=d.useMemo(()=>{const I={};for(const te of k)I[te.txId]=(I[te.txId]||0)+te.amount;return I},[k]),le=d.useMemo(()=>{const I={};for(const te of k)I[te.lineId]=(I[te.lineId]||0)+te.amount;return I},[k]),z=I=>{const te=o.find(Xe=>Xe.id===I);if(!te)return 0;const Se=_e[I]||0;return Math.max(0,te.amount-Se)},Pe=I=>{const te=x.find(Xe=>Xe.id===I);if(!te)return 0;const Se=le[I]||0;return Math.max(0,te.amount-Se)},Be=I=>Pe(I)<=1e-4,xe=I=>(le[I]||0)>0&&Pe(I)>1e-4,Ne=d.useMemo(()=>Ie&&x.find(I=>I.id===Ie)||null,[Ie,x]),M=d.useMemo(()=>me&&o.find(I=>I.id===me)||null,[me,o]),H=d.useMemo(()=>Ne?k.filter(I=>I.lineId===Ne.id):[],[Ne,k]),Ae=d.useMemo(()=>M?k.filter(I=>I.txId===M.id):[],[M,k]),oe=d.useMemo(()=>{const I=ie.trim().toLowerCase();return o.filter(te=>W==="All"?!0:te.type===W).filter(te=>we==="All"?!0:te.status===we).filter(te=>I?`${te.id} ${te.reference} ${te.vendor} ${te.serviceModule} ${te.marketplace} ${te.group} ${te.costCenter} ${te.note}`.toLowerCase().includes(I):!0).slice().sort((te,Se)=>Se.occurredAt-te.occurredAt)},[o,ie,W,we]),De=d.useMemo(()=>{const I=be.trim().toLowerCase();return x.filter(te=>Me==="Unmatched"?!Be(te.id):Me==="Partially matched"?xe(te.id):!0).filter(te=>I?`${te.invoiceNo} ${te.description} ${te.vendor} ${te.serviceModule} ${te.marketplace} ${te.group} ${te.costCenter} ${te.projectTag} ${te.taxCode}`.toLowerCase().includes(I):!0).slice().sort((te,Se)=>Se.serviceDate-te.serviceDate)},[x,be,Me,le,k]),$e=d.useMemo(()=>{const I=Ue.trim().toLowerCase();return L.filter(te=>he==="All"?!0:te.status===he).filter(te=>I?`${te.id} ${te.kind} ${te.severity} ${te.status} ${te.message} ${te.suggestedNext} ${te.invoiceNo||""} ${te.txId||""}`.toLowerCase().includes(I):!0).slice().sort((te,Se)=>Se.createdAt-te.createdAt)},[L,Ue,he]),ge=d.useMemo(()=>{if(!Ne)return[];const I=o.filter(Xe=>Xe.currency===Ne.currency).filter(Xe=>Xe.status!=="Failed").filter(Xe=>z(Xe.id)>0).filter(Xe=>xy(Xe.occurredAt,Ne.serviceDate)<=30),te=g.filter(Xe=>Xe.enabled);return I.map(Xe=>{let mt=0,ot;for(const Nt of te){const nt=H4(Ne,Xe,Nt);nt>mt&&(mt=nt,ot=Nt)}return{tx:Xe,score:mt,bestRule:ot}}).filter(Xe=>Xe.score>0).sort((Xe,mt)=>mt.score-Xe.score)},[Ne,o,_e,g]),ue=d.useMemo(()=>{const I=x.filter(nt=>!Be(nt.id)).length,te=x.filter(nt=>xe(nt.id)).length,Se=L.filter(nt=>nt.status!=="Resolved").length,Xe=o.filter(nt=>nt.status==="Failed").length,mt=o.filter(nt=>nt.status==="Pending").length,ot=o.filter(nt=>nt.status==="Posted").length,Nt=o.filter(nt=>z(nt.id)>0&&nt.status==="Posted").length;return{unmatched:I,partial:te,openExc:Se,failedTx:Xe,pendingTx:mt,postedTx:ot,unmatchedTx:Nt}},[x,k,L,o,_e]),Ke=I=>ae(te=>[{id:ao("AU"),...I},...te]),b=I=>{const te={id:ao("EX"),createdAt:Date.now(),status:I.status||"Open",...I};R(Se=>[te,...Se]),Ke({at:te.createdAt,actor:"System",action:"EXCEPTION_CREATED",entityRef:te.id,details:`${te.kind} (${te.severity})`})},v=I=>{if(!Ne){n({title:"Select a line",message:"Choose an invoice line to reconcile.",kind:"warn"});return}I&&pe(I);const te=I?o.find(Xe=>Xe.id===I):M,Se=te?Math.min(Pe(Ne.id),z(te.id)):Pe(Ne.id);Fe({amount:Se>0?Se:0,note:""}),ye(!0)},u=(I,te,Se)=>{if(!Ne||!M)return;const Xe=Math.max(0,Math.round(Qe.amount));if(Xe<=0){n({title:"Invalid amount",message:"Match amount must be greater than zero.",kind:"warn"});return}const mt=Pe(Ne.id),ot=z(M.id);if(Xe>mt){n({title:"Too much",message:"Amount exceeds remaining line balance.",kind:"warn"});return}if(Xe>ot){n({title:"Too much",message:"Amount exceeds remaining transaction balance.",kind:"warn"});return}const Nt={id:ao("MT"),lineId:Ne.id,txId:M.id,amount:Xe,method:I,confidence:te,ruleId:Se,createdAt:Date.now(),createdBy:"You",note:Qe.note.trim()||"Manual match"};q(Vs=>[Nt,...Vs]),Ke({at:Nt.createdAt,actor:Nt.createdBy,action:"MATCH_CREATED",entityRef:Nt.id,details:`${Nt.lineId} <- ${Nt.txId} (${Nt.amount})`}),n({title:"Matched",message:`${Ne.invoiceNo} line matched to ${M.id}.`,kind:"success"});const nt=mt-Xe;nt>0&&nt>Math.max(1e3,Ne.amount*.02)&&b({kind:"Partial payment",severity:"Warning",invoiceNo:Ne.invoiceNo,lineId:Ne.id,txId:M.id,message:"Line partially matched. Remaining amount still due.",suggestedNext:"Find another transaction or raise an adjustment",status:"Open"}),ye(!1)},C=I=>{const te=k.find(Se=>Se.id===I);te&&(q(Se=>Se.filter(Xe=>Xe.id!==I)),Ke({at:Date.now(),actor:"You",action:"MATCH_REMOVED",entityRef:I,details:`${te.lineId} x ${te.txId} (${te.amount})`}),n({title:"Unmatched",message:"Match removed.",kind:"info"}))},Q=()=>{const I=g.filter(Tt=>Tt.enabled);if(!I.length){n({title:"No rules",message:"Enable at least one auto-match rule.",kind:"warn"});return}let te=0,Se=0;const Xe=Object.fromEntries(o.map(Tt=>[Tt.id,Tt])),mt=[...k],ot={},Nt={};for(const Tt of mt)ot[Tt.txId]=(ot[Tt.txId]||0)+Tt.amount,Nt[Tt.lineId]=(Nt[Tt.lineId]||0)+Tt.amount;const nt=Tt=>{const Sa=Xe[Tt];return Sa?Math.max(0,Sa.amount-(ot[Tt]||0)):0},Vs=Tt=>{const Sa=x.find(Ut=>Ut.id===Tt);return Sa?Math.max(0,Sa.amount-(Nt[Tt]||0)):0},As=[],Ca=o.filter(Tt=>Tt.status!=="Failed");for(const Tt of x){if(Vs(Tt.id)<=1e-4)continue;const Sa=Ca.filter(Sl=>Sl.currency===Tt.currency).filter(Sl=>nt(Sl.id)>0).filter(Sl=>xy(Sl.occurredAt,Tt.serviceDate)<=30);let Ut=null;for(const Sl of Sa)for(const Qd of I){const Qo=H4(Tt,Sl,Qd);Qo<=0||Qo<Qd.minConfidence||(!Ut||Qo>Ut.score)&&(Ut={tx:Sl,score:Qo,rule:Qd})}if(!Ut){Se+=1;continue}const Uu=Ut.rule,Ko=Math.min(Vs(Tt.id),nt(Ut.tx.id));if(!Uu.allowPartialMatch&&Ko!==Vs(Tt.id)){Se+=1;continue}if(Ko<=0){Se+=1;continue}ot[Ut.tx.id]=(ot[Ut.tx.id]||0)+Ko,Nt[Tt.id]=(Nt[Tt.id]||0)+Ko,As.push({id:ao("MT"),lineId:Tt.id,txId:Ut.tx.id,amount:Math.round(Ko),method:"Auto",confidence:Ut.score,ruleId:Uu.id,createdAt:Date.now(),createdBy:"System",note:`Auto-match by ${Uu.name}`}),te+=1}if(As.length){q(Ut=>[...As,...Ut]),Ke({at:Date.now(),actor:"System",action:"AUTO_MATCH_RUN",entityRef:"Batch",details:`Auto-matched ${te} line(s), skipped ${Se}.`}),n({title:"Auto-match complete",message:`Matched ${te} line(s).`,kind:"success"});const Tt={};for(const Ut of[...k,...As])Tt[Ut.lineId]=(Tt[Ut.lineId]||0)+Ut.amount;const Sa=x.filter(Ut=>Math.max(0,Ut.amount-(Tt[Ut.id]||0))>1e-4);Sa.length&&b({kind:"Unmatched",severity:"Warning",message:`${Sa.length} invoice line(s) remain unmatched after auto-match.",`,suggestedNext:"Review candidate transactions or create adjustments",status:"Open"})}else n({title:"No matches",message:"No auto-matches met the confidence thresholds.",kind:"info"})},O=I=>{R(te=>te.map(Se=>Se.id===I?{...Se,status:"Resolved"}:Se)),Ke({at:Date.now(),actor:"You",action:"EXCEPTION_UPDATED",entityRef:I,details:"Marked resolved"}),n({title:"Resolved",message:"Exception resolved.",kind:"success"})},ee=(I,te)=>{R(Se=>Se.map(Xe=>Xe.id===I?{...Xe,status:te}:Xe)),Ke({at:Date.now(),actor:"You",action:"EXCEPTION_UPDATED",entityRef:I,details:`Status -> ${te}`}),n({title:"Updated",message:"Exception updated.",kind:"info"})},F=I=>{c(te=>te.map(Se=>Se.id===I?{...Se,status:"Pending",note:`${Se.note} (retry queued)`}:Se)),Ke({at:Date.now(),actor:"You",action:"TX_STATUS_UPDATED",entityRef:I,details:"Retry queued"}),n({title:"Retry queued",message:"Transaction moved to Pending.",kind:"success"})},D=I=>{c(te=>te.map(Se=>Se.id===I?{...Se,status:"Posted"}:Se)),Ke({at:Date.now(),actor:"You",action:"TX_STATUS_UPDATED",entityRef:I,details:"Marked Posted"}),n({title:"Updated",message:"Transaction marked Posted.",kind:"success"})},m=I=>{ne(I?JSON.parse(JSON.stringify(I)):{id:"",name:"New rule",enabled:!0,requireSameVendor:!0,requireSameModule:!0,requireSameMarketplace:!1,dateWindowDays:7,amountTolerancePct:5,minConfidence:.85,allowPartialMatch:!0}),fe(!0)},A=()=>{if(!Ve)return;if(!Ve.name.trim()){n({title:"Missing name",message:"Rule name is required.",kind:"warn"});return}const I=!Ve.id,te=Ve.id||ao("R"),Se={...Ve,id:te};N(Xe=>{const mt=Xe.findIndex(ot=>ot.id===te);if(mt>=0){const ot=Xe.slice();return ot[mt]=Se,ot}return[Se,...Xe]}),Ke({at:Date.now(),actor:"You",action:"RULE_UPDATED",entityRef:te,details:`${I?"Created":"Updated"} rule`}),n({title:"Saved",message:"Rule saved.",kind:"success"}),fe(!1)},f=I=>{N(te=>te.filter(Se=>Se.id!==I)),Ke({at:Date.now(),actor:"You",action:"RULE_UPDATED",entityRef:I,details:"Deleted rule"}),n({title:"Deleted",message:"Rule deleted.",kind:"info"})},B=I=>{ze(I?JSON.parse(JSON.stringify(I)):{id:"",scope:"Module",key:"Rides & Logistics",glCode:"4000",costCenter:"ORG",taxCode:"VAT18",memo:"",enabled:!0}),Ee(!0)},p=()=>{if(!Re)return;if(!Re.key.trim()){n({title:"Missing key",message:"Key is required.",kind:"warn"});return}const I=!Re.id,te=Re.id||ao("MAP"),Se={...Re,id:te};T(Xe=>{const mt=Xe.findIndex(ot=>ot.id===te);if(mt>=0){const ot=Xe.slice();return ot[mt]=Se,ot}return[Se,...Xe]}),Ke({at:Date.now(),actor:"You",action:"ERP_MAPPING_UPDATED",entityRef:te,details:`${I?"Created":"Updated"} mapping`}),n({title:"Saved",message:"ERP mapping saved.",kind:"success"}),Ee(!1)},E=I=>{T(te=>te.filter(Se=>Se.id!==I)),Ke({at:Date.now(),actor:"You",action:"ERP_MAPPING_UPDATED",entityRef:I,details:"Deleted mapping"}),n({title:"Deleted",message:"Mapping removed.",kind:"info"})},se=()=>{const I=re();ab("reconciliation-report.json",I),Ke({at:Date.now(),actor:"You",action:"EXPORT",entityRef:"recon-report.json",details:"Exported reconciliation report JSON"}),n({title:"Exported",message:"Reconciliation report JSON downloaded.",kind:"success"})},y=()=>{const I=oe.map(Se=>({id:Se.id,occurredAt:dd(Se.occurredAt),type:Se.type,status:Se.status,currency:Se.currency,amount:Ma(Se.amount,Se.currency),matched:Ma(_e[Se.id]||0,Se.currency),remaining:Ma(z(Se.id),Se.currency),vendor:Se.vendor,module:Se.serviceModule,marketplace:Se.marketplace,group:Se.group,costCenter:Se.costCenter,taxCode:Se.taxCode,reference:Se.reference,note:Se.note})),te=M_(I,[{key:"id",label:"ID"},{key:"occurredAt",label:"Time"},{key:"type",label:"Type"},{key:"status",label:"Status"},{key:"currency",label:"Currency"},{key:"amount",label:"Amount"},{key:"matched",label:"Matched"},{key:"remaining",label:"Remaining"},{key:"vendor",label:"Vendor"},{key:"module",label:"Module"},{key:"marketplace",label:"Marketplace"},{key:"group",label:"Group"},{key:"costCenter",label:"Cost center"},{key:"taxCode",label:"Tax code"},{key:"reference",label:"Reference"},{key:"note",label:"Note"}]);P_("transaction-ledger.csv",te,"text/csv"),Ke({at:Date.now(),actor:"You",action:"EXPORT",entityRef:"transaction-ledger.csv",details:"Exported ledger CSV"}),n({title:"Exported",message:"Ledger CSV downloaded.",kind:"success"})},re=()=>{const I=x.filter(Se=>Pe(Se.id)>1e-4),te=o.filter(Se=>Se.status==="Posted"&&z(Se.id)>1e-4);return{generatedAt:new Date().toISOString(),summary:{invoiceLines:x.length,transactions:o.length,matches:k.length,unmatchedLines:I.length,unmatchedPostedTransactions:te.length,openExceptions:L.filter(Se=>Se.status!=="Resolved").length},matches:k,unmatchedLines:I.map(Se=>({lineId:Se.id,invoiceNo:Se.invoiceNo,vendor:Se.vendor,module:Se.serviceModule,marketplace:Se.marketplace,amount:Se.amount,matched:le[Se.id]||0,remaining:Pe(Se.id)})),unmatchedTransactions:te.map(Se=>({txId:Se.id,type:Se.type,vendor:Se.vendor,module:Se.serviceModule,marketplace:Se.marketplace,amount:Se.amount,matched:_e[Se.id]||0,remaining:z(Se.id)})),exceptions:L,erpMappings:$,rules:g,audit:U}},ve=d.useMemo(()=>re().summary,[x,o,k,L,$,g,U,_e,le]);return d.useEffect(()=>{const I=L.some(Se=>Se.kind==="Unmatched"),te=x.filter(Se=>Pe(Se.id)>1e-4);!I&&te.length>=2&&R(Se=>[{id:ao("EX"),kind:"Unmatched",severity:"Warning",status:"Investigating",createdAt:Date.now(),message:"Some invoice lines are unmatched. Review reconciliation.",suggestedNext:"Run auto-match or match manually"},...Se])},[]),e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(E_,{toasts:a,onDismiss:I=>l(te=>te.filter(Se=>Se.id!==I))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:hg.green},children:e.jsx(Qk,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Transactions and Reconciliation"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Ledger, matching tools, exceptions queue, ERP mappings, auto-match rules, and audit-ready reports."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(kt,{label:`Unmatched lines: ${ue.unmatched}`,tone:ue.unmatched?"warn":"good"}),e.jsx(kt,{label:`Partial: ${ue.partial}`,tone:ue.partial?"info":"neutral"}),e.jsx(kt,{label:`Open exceptions: ${ue.openExc}`,tone:ue.openExc?"bad":"good"}),e.jsx(kt,{label:`Posted tx: ${ue.postedTx}`,tone:"neutral"}),e.jsx(kt,{label:`Unmatched tx: ${ue.unmatchedTx}`,tone:ue.unmatchedTx?"warn":"good"}),e.jsx(kt,{label:"Premium: auto-match + ERP",tone:"info"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(St,{variant:"outline",onClick:()=>i("recon"),children:[e.jsx(Fd,{className:"h-4 w-4"})," Reconcile"]}),e.jsxs(St,{variant:"outline",onClick:Q,children:[e.jsx(ht,{className:"h-4 w-4"})," Auto-match"]}),e.jsxs(St,{variant:"outline",onClick:y,children:[e.jsx(gt,{className:"h-4 w-4"})," Ledger CSV"]}),e.jsxs(St,{variant:"primary",onClick:se,children:[e.jsx(wt,{className:"h-4 w-4"})," Export report"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"recon",label:"Reconciliation"},{id:"ledger",label:"Transaction ledger"},{id:"exceptions",label:"Exceptions queue"},{id:"erp",label:"ERP mappings"},{id:"rules",label:"Auto-match rules"},{id:"reports",label:"Reports"}].map(I=>e.jsx("button",{className:oa("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",r===I.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:r===I.id?{background:hg.green}:void 0,onClick:()=>i(I.id),children:I.label},I.id))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[r==="ledger"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(gl,{title:"Ledger filters",subtitle:"Search by vendor, ref, module, cost center.",right:e.jsx(kt,{label:"Core",tone:"neutral"}),children:[e.jsx(mi,{label:"Search",value:ie,onChange:_,placeholder:"TX-9001, vendor, ORD..."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(cd,{label:"Type",value:W,onChange:I=>J(I),options:[{value:"All",label:"All"},...Array.from(new Set(o.map(I=>I.type))).map(I=>({value:I,label:I}))]}),e.jsx(cd,{label:"Status",value:we,onChange:I=>G(I),options:[{value:"All",label:"All"},{value:"Posted",label:"Posted"},{value:"Pending",label:"Pending"},{value:"Failed",label:"Failed"}]})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:[e.jsxs(St,{variant:"outline",onClick:()=>{_(""),J("All"),G("All"),n({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(fn,{className:"h-4 w-4"})," Reset"]}),e.jsxs(St,{variant:"outline",onClick:y,children:[e.jsx(gt,{className:"h-4 w-4"})," CSV"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Core: ledger shows wallet, credit, prepaid, refunds, and reversals."})]}),e.jsx(gl,{title:"Ledger insights",subtitle:"Premium pivot summary.",right:e.jsx(kt,{label:"Premium",tone:"info"}),children:e.jsx(S,{rows:oe,currency:"UGX"})})]}),e.jsx("div",{className:"lg:col-span-8",children:e.jsxs(gl,{title:"Transaction ledger",subtitle:"Click a transaction to reconcile against the selected invoice line.",right:e.jsx(kt,{label:`${oe.length} tx`,tone:"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Tx"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Type"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Module"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Remaining"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[oe.map(I=>{const te=_e[I.id]||0,Se=z(I.id),Xe=me===I.id;return e.jsxs("tr",{className:oa("border-t border-slate-100 hover:bg-slate-50/60",Xe&&"bg-emerald-50/40"),children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:I.id}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Ref: ",I.reference]})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:dd(I.occurredAt)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:I.type}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(kt,{label:I.status,tone:I.status==="Posted"?"good":I.status==="Pending"?"warn":"bad"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:I.vendor}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[I.serviceModule,I.marketplace!=="-"?`  ${I.marketplace}`:""]}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Ma(I.amount,I.currency)}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:Ma(Se,I.currency)}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Matched: ",Ma(te,I.currency)]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(St,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{pe(I.id),n({title:"Selected",message:"Transaction selected.",kind:"info"})},children:[e.jsx(Fd,{className:"h-4 w-4"})," Select"]}),e.jsxs(St,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>{pe(I.id),v(I.id)},disabled:!Ie||Se<=0||I.status==="Failed",title:Ie?Se<=0?"No remaining amount":I.status==="Failed"?"Failed transaction":"":"Select an invoice line first",children:[e.jsx(tt,{className:"h-4 w-4"})," Match"]}),I.status==="Failed"?e.jsxs(St,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>F(I.id),children:[e.jsx(Ar,{className:"h-4 w-4"})," Retry"]}):I.status==="Pending"?e.jsxs(St,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>D(I.id),children:[e.jsx(ct,{className:"h-4 w-4"})," Post"]}):null,e.jsx(St,{variant:"outline",className:"px-3 py-2 text-xs",onClick:async()=>{try{await navigator.clipboard.writeText(I.id),n({title:"Copied",message:"Transaction ID copied.",kind:"success"})}catch{n({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},children:e.jsx(ls,{className:"h-4 w-4"})})]})})]},I.id)}),oe.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-4 py-12 text-center text-sm text-slate-600",children:"No transactions match filters."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: ERP export mappings (GL codes, cost centers, tax codes) are configured in the ERP tab."})]})})]}):null,r==="recon"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(gl,{title:"Invoice lines",subtitle:"Select a line and match to transactions.",right:e.jsx(kt,{label:Me,tone:"neutral"}),children:[e.jsx(mi,{label:"Search lines",value:be,onChange:Ge,placeholder:"Invoice, vendor, project tag..."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(cd,{label:"Scope",value:Me,onChange:I=>je(I),options:[{value:"Unmatched",label:"Unmatched"},{value:"Partially matched",label:"Partially matched"},{value:"All",label:"All"}],hint:"Worklist"}),e.jsxs(St,{variant:"outline",className:"mt-[22px] w-full sm:mt-0",onClick:Q,children:[e.jsx(ht,{className:"h-4 w-4"})," Auto-match"]})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[De.slice(0,30).map(I=>{const te=Pe(I.id),Se=le[I.id]||0,Xe=Ie===I.id;return e.jsx("button",{type:"button",className:oa("w-full rounded-3xl border bg-white p-4 text-left hover:bg-slate-50",Xe?"border-emerald-300 ring-4 ring-emerald-100":"border-slate-200"),onClick:()=>{ce(I.id)},children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:I.invoiceNo}),te<=1e-4?e.jsx(kt,{label:"Matched",tone:"good"}):Se>0?e.jsx(kt,{label:"Partial",tone:"info"}):e.jsx(kt,{label:"Unmatched",tone:"warn"})]}),e.jsx("div",{className:"mt-1 truncate text-xs text-slate-500",children:I.description}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[I.vendor,"  ",I.serviceModule,I.marketplace!=="-"?`  ${I.marketplace}`:""]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[I.group,"  ",I.costCenter,"  ",I.projectTag]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Amount"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:Ma(I.amount,I.currency)}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Remaining"}),e.jsx("div",{className:oa("mt-1 text-sm font-semibold",te>0?"text-slate-900":"text-emerald-700"),children:Ma(te,I.currency)})]})]})},I.id)}),De.length?null:e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(Qk,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No lines"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Your current scope and filters show no lines."})]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium assistant: auto-match uses enabled rules and confidence thresholds."})]})}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsx(gl,{title:"Reconciliation workspace",subtitle:"Match invoice lines to wallet, credit, prepaid, refunds, and reversals.",right:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(St,{variant:"outline",onClick:()=>i("ledger"),children:[e.jsx(et,{className:"h-4 w-4"})," Open ledger"]}),e.jsxs(St,{variant:"outline",onClick:()=>i("exceptions"),children:[e.jsx(Mt,{className:"h-4 w-4"})," Exceptions"]})]}),children:Ne?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:Ne.invoiceNo}),e.jsx(kt,{label:Ne.taxCode,tone:"neutral"}),e.jsx(kt,{label:Ne.marketplace!=="-"?Ne.marketplace:Ne.serviceModule,tone:"info"})]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:Ne.description}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[Ne.vendor,"  ",C_(Ne.serviceDate)]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[Ne.group,"  ",Ne.costCenter,"  ",Ne.projectTag]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Amount"}),e.jsx("div",{className:"mt-1 text-lg font-semibold text-slate-900",children:Ma(Ne.amount,Ne.currency)}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Remaining"}),e.jsx("div",{className:oa("mt-1 text-sm font-semibold",Pe(Ne.id)>0?"text-slate-900":"text-emerald-700"),children:Ma(Pe(Ne.id),Ne.currency)})]})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:[e.jsxs(St,{variant:"primary",onClick:()=>{var I,te,Se,Xe;!me&&((te=(I=ge[0])==null?void 0:I.tx)!=null&&te.id)&&pe(ge[0].tx.id),v(me||((Xe=(Se=ge[0])==null?void 0:Se.tx)==null?void 0:Xe.id))},disabled:Pe(Ne.id)<=1e-4,children:[e.jsx(tt,{className:"h-4 w-4"})," Match"]}),e.jsxs(St,{variant:"outline",onClick:()=>{pe(null),n({title:"Cleared",message:"Transaction selection cleared.",kind:"info"})},children:[e.jsx(Ye,{className:"h-4 w-4"})," Clear tx"]}),e.jsxs(St,{variant:"outline",onClick:Q,children:[e.jsx(ht,{className:"h-4 w-4"})," Auto-match all"]}),e.jsxs(St,{variant:"outline",onClick:()=>He(!0),children:[e.jsx(wt,{className:"h-4 w-4"})," Report"]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Existing matches"}),e.jsx("div",{className:"mt-2 space-y-2",children:H.length?H.map(I=>{const te=o.find(Se=>Se.id===I.txId);return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:I.txId}),e.jsx(kt,{label:I.method,tone:I.method==="Auto"?"info":"neutral"}),e.jsx(kt,{label:`${Math.round(I.confidence*100)}%`,tone:I.confidence>=.9?"good":I.confidence>=.8?"warn":"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[(te==null?void 0:te.vendor)||"-","  ",(te==null?void 0:te.type)||"-","  ",te?dd(te.occurredAt):"-"]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Note: ",I.note]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Amount"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:Ma(I.amount,Ne.currency)}),e.jsx("div",{className:"mt-2 flex justify-end",children:e.jsxs(St,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>C(I.id),children:[e.jsx(Ye,{className:"h-4 w-4"})," Remove"]})})]})]})},I.id)}):e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No matches yet for this line."})})]})]})}),e.jsxs("div",{className:"lg:col-span-5 space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Candidate transactions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Suggested by rules and scoring."})]}),e.jsx(kt,{label:`Top ${Math.min(8,ge.length)}`,tone:"info"})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[ge.slice(0,8).map(I=>{var Nt;const te=I.tx,Se=z(te.id),Xe=me===te.id,mt=Math.round(I.score*100),ot=((Nt=I.bestRule)==null?void 0:Nt.name)||"-";return e.jsx("button",{type:"button",className:oa("w-full rounded-3xl border bg-white p-4 text-left hover:bg-slate-50",Xe?"border-emerald-300 ring-4 ring-emerald-100":"border-slate-200"),onClick:()=>pe(te.id),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:te.id}),e.jsx(kt,{label:te.status,tone:te.status==="Posted"?"good":"warn"}),e.jsx(kt,{label:`${mt}%`,tone:mt>=90?"good":mt>=80?"warn":"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[te.vendor,"  ",te.type]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[te.serviceModule,te.marketplace!=="-"?`  ${te.marketplace}`:""]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Rule: ",ot]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Available"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:Ma(Se,te.currency)}),e.jsx("div",{className:"mt-2",children:e.jsxs(St,{variant:"primary",className:"px-3 py-2 text-xs",onClick:nt=>{nt.preventDefault(),nt.stopPropagation(),pe(te.id),v(te.id)},disabled:Pe(Ne.id)<=1e-4||Se<=1e-4,children:[e.jsx(tt,{className:"h-4 w-4"})," Match"]})})]})]})},te.id)}),ge.length?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No candidates found. Try opening the ledger and selecting a transaction."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium assistant: auto-match rules can be tuned in the Rules tab."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Selected transaction"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"For manual reconciliation."})]}),e.jsx(kt,{label:M?M.status:"None",tone:M?M.status==="Posted"?"good":M.status==="Pending"?"warn":"bad":"neutral"})]}),M?e.jsxs("div",{className:"mt-3 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:M.id}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[M.vendor,"  ",M.type]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[dd(M.occurredAt),"  Ref ",M.reference]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Note: ",M.note]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Remaining"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:Ma(z(M.id),M.currency)})]})]}),Ae.length?e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Matches"}),e.jsx("ul",{className:"mt-2 space-y-1",children:Ae.slice(0,6).map(I=>e.jsxs("li",{children:[" ",I.lineId," (",Ma(I.amount,M.currency),")"]},I.id))})]}):e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No matches for this transaction."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[M.status==="Failed"?e.jsxs(St,{variant:"outline",onClick:()=>F(M.id),children:[e.jsx(Ar,{className:"h-4 w-4"})," Retry"]}):M.status==="Pending"?e.jsxs(St,{variant:"outline",onClick:()=>D(M.id),children:[e.jsx(ct,{className:"h-4 w-4"})," Mark Posted"]}):null,e.jsxs(St,{variant:"outline",onClick:async()=>{try{await navigator.clipboard.writeText(M.id),n({title:"Copied",message:"Transaction ID copied.",kind:"success"})}catch{n({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},children:[e.jsx(ls,{className:"h-4 w-4"})," Copy ID"]})]})]}):e.jsx("div",{className:"mt-3 rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"Select a candidate or choose a transaction from the Ledger."})]})]})]}):e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(Fd,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"Select an invoice line"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Choose a line on the left to see candidate transactions."})]})})})]}):null,r==="exceptions"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(gl,{title:"Exceptions filters",subtitle:"Search and manage exceptions.",right:e.jsx(kt,{label:"Core",tone:"neutral"}),children:[e.jsx(mi,{label:"Search",value:Ue,onChange:Oe,placeholder:"TX, invoice, message..."}),e.jsx(cd,{label:"Status",value:he,onChange:I=>Y(I),options:[{value:"All",label:"All"},{value:"Open",label:"Open"},{value:"Investigating",label:"Investigating"},{value:"Resolved",label:"Resolved"}]}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:[e.jsxs(St,{variant:"outline",onClick:()=>{Oe(""),Y("All"),n({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(fn,{className:"h-4 w-4"})," Reset"]}),e.jsxs(St,{variant:"outline",onClick:()=>{b({kind:"Unmatched",severity:"Warning",message:"Manual exception created.",suggestedNext:"Review reconciliation"}),n({title:"Created",message:"Exception created.",kind:"success"})},children:[e.jsx(pt,{className:"h-4 w-4"})," New exception"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Core: exceptions queue covers failed charges and partial payments."})]}),e.jsxs(gl,{title:"Premium",subtitle:"Audit-ready reconciliation reports.",right:e.jsx(kt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"1) Exceptions are linked to transactions and invoices"}),e.jsx("li",{children:"2) Actions are audit logged"}),e.jsx("li",{children:"3) Reports export to JSON for ERP ingestion"})]})}),e.jsx("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:e.jsxs(St,{variant:"outline",onClick:()=>i("reports"),children:[e.jsx(et,{className:"h-4 w-4"})," Open reports"]})})]})]}),e.jsx("div",{className:"lg:col-span-8",children:e.jsx(gl,{title:"Exceptions queue",subtitle:"Failed charges, partial payments, and reconciliation gaps.",right:e.jsx(kt,{label:`${$e.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[$e.map(I=>{const te=I.severity==="Critical"?"bad":I.severity==="Warning"?"warn":"info";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:I.id}),e.jsx(kt,{label:I.kind,tone:"neutral"}),e.jsx(kt,{label:I.severity,tone:te}),e.jsx(kt,{label:I.status,tone:I.status==="Resolved"?"good":I.status==="Investigating"?"info":"warn"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",z4(I.createdAt),"  ",dd(I.createdAt)]}),I.invoiceNo?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Invoice: ",I.invoiceNo]}):null,I.txId?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Transaction: ",I.txId]}):null,e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:I.message}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Next: ",I.suggestedNext]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[I.txId?e.jsxs(St,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{pe(I.txId||null),i("ledger"),n({title:"Opened",message:"Transaction selected in ledger.",kind:"info"})},children:[e.jsx(et,{className:"h-4 w-4"})," Open tx"]}):null,I.status!=="Resolved"?e.jsxs(e.Fragment,{children:[e.jsxs(St,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ee(I.id,"Investigating"),children:[e.jsx(wl,{className:"h-4 w-4"})," Investigate"]}),e.jsxs(St,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>O(I.id),children:[e.jsx(tt,{className:"h-4 w-4"})," Resolve"]})]}):e.jsx(kt,{label:"Done",tone:"good"}),I.kind==="Failed charge"&&I.txId?e.jsxs(St,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>F(I.txId),children:[e.jsx(Ar,{className:"h-4 w-4"})," Retry"]}):null]})]})},I.id)}),$e.length?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No exceptions."})]})})})]}):null,r==="erp"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(gl,{title:"ERP export mappings",subtitle:"GL codes, cost centers, tax codes.",right:e.jsx(kt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"1) Mapping resolution: Vendor, then Marketplace, then Module, then Default"}),e.jsx("li",{children:"2) Used by reconciliation exports and ERP posts"}),e.jsx("li",{children:"3) Keep tax codes consistent with entity VAT settings"})]})}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(St,{variant:"primary",onClick:()=>B(),children:[e.jsx(pt,{className:"h-4 w-4"})," New mapping"]}),e.jsxs(St,{variant:"outline",onClick:()=>{ab("erp-mappings.json",$),Ke({at:Date.now(),actor:"You",action:"EXPORT",entityRef:"erp-mappings.json",details:"Exported ERP mappings"}),n({title:"Exported",message:"ERP mappings JSON downloaded.",kind:"success"})},children:[e.jsx(gt,{className:"h-4 w-4"})," Export"]})]})]}),e.jsx(gl,{title:"ERP mapping preview",subtitle:"Check how a transaction maps.",right:e.jsx(kt,{label:"Premium",tone:"info"}),children:e.jsx(K,{tx:M,mappings:$,onPickTx:()=>{i("ledger"),n({title:"Pick tx",message:"Select a transaction in the ledger.",kind:"info"})}})})]}),e.jsx("div",{className:"lg:col-span-8",children:e.jsxs(gl,{title:"Mappings",subtitle:"Define GL, cost center, and tax codes for exports.",right:e.jsx(kt,{label:`${$.length}`,tone:"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Scope"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Key"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"GL"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Cost center"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Tax"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Enabled"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[$.map(I=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx(kt,{label:I.scope,tone:I.scope==="Default"?"neutral":"info"})}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:I.key}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:I.glCode}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:I.costCenter}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:I.taxCode}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(kt,{label:I.enabled?"On":"Off",tone:I.enabled?"good":"neutral"})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(St,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>B(I),children:[e.jsx(wl,{className:"h-4 w-4"})," Edit"]}),e.jsx(St,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>T(te=>te.map(Se=>Se.id===I.id?{...Se,enabled:!Se.enabled}:Se)),children:I.enabled?"Disable":"Enable"}),e.jsx(St,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>E(I.id),children:e.jsx(Ye,{className:"h-4 w-4"})})]}),I.memo?e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:I.memo}):null]})]},I.id)),$.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-12 text-center text-sm text-slate-600",children:"No mappings."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: exports can map invoice lines to GL codes, cost centers, and tax codes."})]})})]}):null,r==="rules"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(gl,{title:"Auto-match rules",subtitle:"Premium: reconciliation assistant rules.",right:e.jsx(kt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"1) Same vendor and currency is recommended"}),e.jsx("li",{children:"2) Date window controls how far back to match"}),e.jsx("li",{children:"3) Amount tolerance handles small differences"}),e.jsx("li",{children:"4) Confidence threshold prevents risky matches"})]})}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(St,{variant:"primary",onClick:()=>m(),children:[e.jsx(pt,{className:"h-4 w-4"})," New rule"]}),e.jsxs(St,{variant:"outline",onClick:Q,children:[e.jsx(ht,{className:"h-4 w-4"})," Run auto-match"]}),e.jsxs(St,{variant:"outline",onClick:()=>{ab("auto-match-rules.json",g),Ke({at:Date.now(),actor:"You",action:"EXPORT",entityRef:"auto-match-rules.json",details:"Exported rules"}),n({title:"Exported",message:"Rules JSON downloaded.",kind:"success"})},children:[e.jsx(gt,{className:"h-4 w-4"})," Export"]})]})]}),e.jsx(gl,{title:"Rule test",subtitle:"Select a line and see top candidates.",right:e.jsx(kt,{label:"Premium",tone:"info"}),children:Ne?e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:Ne.invoiceNo}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:Ne.description}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Top candidates:"}),e.jsxs("div",{className:"mt-2 space-y-2",children:[ge.slice(0,3).map(I=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:I.tx.id}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[I.tx.vendor,"  ",I.tx.type]})]}),e.jsx(kt,{label:`${Math.round(I.score*100)}%`,tone:I.score>=.9?"good":I.score>=.8?"warn":"neutral"})]})},I.tx.id)),ge.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No candidates found."})]})]}):e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"Select an invoice line in Reconciliation."})})]}),e.jsx("div",{className:"lg:col-span-8",children:e.jsxs(gl,{title:"Rules",subtitle:"Tune behavior and thresholds.",right:e.jsx(kt,{label:`${g.filter(I=>I.enabled).length} enabled`,tone:"neutral"}),children:[e.jsxs("div",{className:"space-y-2",children:[g.map(I=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:I.name}),e.jsx(kt,{label:I.enabled?"On":"Off",tone:I.enabled?"good":"neutral"}),e.jsx(kt,{label:`Min ${Math.round(I.minConfidence*100)}%`,tone:"info"}),e.jsx(kt,{label:`Window ${I.dateWindowDays}d`,tone:"neutral"}),e.jsx(kt,{label:`Tol ${I.amountTolerancePct}%`,tone:"neutral"}),e.jsx(kt,{label:I.allowPartialMatch?"Partial OK":"Full only",tone:I.allowPartialMatch?"info":"neutral"})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(kt,{label:I.requireSameVendor?"Same vendor":"Vendor optional",tone:I.requireSameVendor?"good":"neutral"}),e.jsx(kt,{label:I.requireSameModule?"Same module":"Module optional",tone:I.requireSameModule?"good":"neutral"}),e.jsx(kt,{label:I.requireSameMarketplace?"Same marketplace":"Marketplace optional",tone:I.requireSameMarketplace?"good":"neutral"})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(St,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>m(I),children:[e.jsx(wl,{className:"h-4 w-4"})," Edit"]}),e.jsx(St,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>N(te=>te.map(Se=>Se.id===I.id?{...Se,enabled:!Se.enabled}:Se)),children:I.enabled?"Disable":"Enable"}),e.jsx(St,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>f(I.id),children:e.jsx(Ye,{className:"h-4 w-4"})})]})]})},I.id)),g.length?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No rules."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: you can create strict rules for sensitive vendors and looser rules for low risk recurring vendors."})]})})]}):null,r==="reports"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(gl,{title:"Audit-ready reports",subtitle:"Premium reconciliation reports.",right:e.jsx(kt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Matches"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:ve.matches}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Total match records"})]}),e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-emerald-50 text-emerald-700 ring-1 ring-emerald-200",children:e.jsx(ct,{className:"h-5 w-5"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx(P,{label:"Unmatched lines",value:`${ve.unmatchedLines}`,tone:ve.unmatchedLines?"warn":"good",icon:e.jsx(Mt,{className:"h-4 w-4"})}),e.jsx(P,{label:"Unmatched posted tx",value:`${ve.unmatchedPostedTransactions}`,tone:ve.unmatchedPostedTransactions?"warn":"good",icon:e.jsx(Wm,{className:"h-4 w-4"})}),e.jsx(P,{label:"Open exceptions",value:`${ve.openExceptions}`,tone:ve.openExceptions?"bad":"good",icon:e.jsx(yt,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(St,{variant:"primary",onClick:se,children:[e.jsx(gt,{className:"h-4 w-4"})," Export JSON"]}),e.jsxs(St,{variant:"outline",onClick:()=>He(!0),children:[e.jsx(wt,{className:"h-4 w-4"})," Preview"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Reports include: matches, unmatched items, exceptions, rules, ERP mappings, and audit log."})]}),e.jsx(gl,{title:"Audit log",subtitle:"Who changed what and when.",right:e.jsx(kt,{label:`${U.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[U.slice(0,10).map(I=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(kt,{label:I.action,tone:"neutral"}),e.jsx(kt,{label:I.actor,tone:"info"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[dd(I.at),"  ",z4(I.at),"  ",I.entityRef]}),e.jsx("div",{className:"mt-2 text-xs text-slate-700",children:I.details})]}),e.jsx(St,{variant:"outline",className:"px-3 py-2 text-xs",onClick:async()=>{try{await navigator.clipboard.writeText(I.id),n({title:"Copied",message:"Audit ID copied.",kind:"success"})}catch{n({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},children:e.jsx(ls,{className:"h-4 w-4"})})]})},I.id)),U.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No audit events."})]})})]}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs(gl,{title:"Reconciliation overview",subtitle:"Pivot summary over transactions.",right:e.jsx(kt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(w,{rows:o,title:"By vendor",dim:"Vendor"}),e.jsx(w,{rows:o,title:"By module",dim:"Service module"}),e.jsx(w,{rows:o,title:"By transaction type",dim:"Transaction type"}),e.jsx(w,{rows:o,title:"By status",dim:"Transaction status"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: pivot summaries support quicker reconciliation reviews and ERP mapping validation."})]})})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"Q Transactions and Reconciliation v2. Core: ledger, manual matching, reconciliation to invoice lines, exceptions queue. Premium: ERP mappings, auto-match rules, and audit-ready exports."})})]})}),e.jsx(Mh,{open:de,title:"Create match",subtitle:"Match selected invoice line to selected transaction.",onClose:()=>ye(!1),actions:[{label:"Match",onClick:()=>u("Manual",.88)}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(St,{variant:"outline",onClick:()=>ye(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(St,{variant:"outline",onClick:()=>{if(!Ne||!M)return;const I=Math.min(Pe(Ne.id),z(M.id));Fe(te=>({...te,amount:Math.max(0,Math.round(I))})),n({title:"Suggested",message:"Suggested a safe match amount.",kind:"info"})},children:[e.jsx(eU,{className:"h-4 w-4"})," Suggest"]}),e.jsxs(St,{variant:"primary",onClick:()=>u("Manual",.88),disabled:!Ne||!M,children:[e.jsx(tt,{className:"h-4 w-4"})," Match"]})]})]}),children:!Ne||!M?e.jsx("div",{className:"text-sm text-slate-600",children:"Select a line and transaction first."}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Line"}),": ",Ne.invoiceNo,"  ",Ne.id]}),e.jsxs("div",{className:"mt-1",children:[e.jsx("span",{className:"font-semibold",children:"Tx"}),": ",M.id,"  ",M.type,"  ",M.status]}),e.jsxs("div",{className:"mt-1",children:[e.jsx("span",{className:"font-semibold",children:"Line remaining"}),": ",Ma(Pe(Ne.id),Ne.currency)]}),e.jsxs("div",{className:"mt-1",children:[e.jsx("span",{className:"font-semibold",children:"Tx remaining"}),": ",Ma(z(M.id),M.currency)]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Eh,{label:"Match amount",value:Qe.amount,onChange:I=>Fe(te=>({...te,amount:Math.max(0,I)})),hint:`Currency ${Ne.currency}`}),e.jsx(mi,{label:"Note",value:Qe.note,onChange:I=>Fe(te=>({...te,note:I})),placeholder:"Optional",hint:"Saved in audit"})]}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: auto-match creates matches with rule ID and confidence score. Manual matches are also audit logged."})]})}),e.jsx(Mh,{open:ke,title:Ve!=null&&Ve.id?"Edit rule":"New rule",subtitle:"Reconciliation assistant rule settings.",onClose:()=>fe(!1),actions:[{label:"Save",onClick:A},...Ve!=null&&Ve.id?[{label:"Delete",onClick:()=>Ve&&f(Ve.id),variant:"danger"}]:[]],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(St,{variant:"outline",onClick:()=>fe(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[Ve!=null&&Ve.id?e.jsxs(St,{variant:"danger",onClick:()=>Ve&&f(Ve.id),children:[e.jsx(Ye,{className:"h-4 w-4"})," Delete"]}):null,e.jsxs(St,{variant:"primary",onClick:A,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]})]}),children:Ve?e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(mi,{label:"Name",value:Ve.name,onChange:I=>ne(te=>te&&{...te,name:I})}),e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Enabled"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"If off, auto-match skips this rule."})]}),e.jsx("button",{type:"button",className:oa("relative h-7 w-12 rounded-full border transition",Ve.enabled?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>ne(I=>I&&{...I,enabled:!I.enabled}),"aria-label":"Toggle enabled",children:e.jsx("span",{className:oa("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",Ve.enabled?"left-[22px]":"left-1")})})]})}),e.jsx(Eh,{label:"Date window (days)",value:Ve.dateWindowDays,onChange:I=>ne(te=>te&&{...te,dateWindowDays:Math.max(0,I)}),hint:"Max days difference"}),e.jsx(Eh,{label:"Amount tolerance (%)",value:Ve.amountTolerancePct,onChange:I=>ne(te=>te&&{...te,amountTolerancePct:my(I,0,100)}),hint:"Percent diff"}),e.jsx(Eh,{label:"Min confidence (0-100)",value:Math.round(Ve.minConfidence*100),onChange:I=>ne(te=>te&&{...te,minConfidence:my(I,0,100)/100}),hint:"Auto-match threshold"}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Constraints"}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx(X,{label:"Require same vendor",enabled:Ve.requireSameVendor,onChange:I=>ne(te=>te&&{...te,requireSameVendor:I})}),e.jsx(X,{label:"Require same module",enabled:Ve.requireSameModule,onChange:I=>ne(te=>te&&{...te,requireSameModule:I})}),e.jsx(X,{label:"Require same marketplace",enabled:Ve.requireSameMarketplace,onChange:I=>ne(te=>te&&{...te,requireSameMarketplace:I})}),e.jsx(X,{label:"Allow partial match",enabled:Ve.allowPartialMatch,onChange:I=>ne(te=>te&&{...te,allowPartialMatch:I})})]})]}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Tip: strict rules should be placed above looser ones. This demo picks the best scoring rule."})]}):null}),e.jsx(Mh,{open:Te,title:Re!=null&&Re.id?"Edit ERP mapping":"New ERP mapping",subtitle:"Map to GL codes, cost centers, and tax codes for exports.",onClose:()=>Ee(!1),actions:[{label:"Save",onClick:p},...Re!=null&&Re.id?[{label:"Delete",onClick:()=>Re&&E(Re.id),variant:"danger"}]:[]],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(St,{variant:"outline",onClick:()=>Ee(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[Re!=null&&Re.id?e.jsxs(St,{variant:"danger",onClick:()=>Re&&E(Re.id),children:[e.jsx(Ye,{className:"h-4 w-4"})," Delete"]}):null,e.jsxs(St,{variant:"primary",onClick:p,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]})]}),children:Re?e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(cd,{label:"Scope",value:Re.scope,onChange:I=>ze(te=>te&&{...te,scope:I}),options:[{value:"Default",label:"Default"},{value:"Module",label:"Module"},{value:"Marketplace",label:"Marketplace"},{value:"Vendor",label:"Vendor"}]}),e.jsx(mi,{label:"Key",value:Re.key,onChange:I=>ze(te=>te&&{...te,key:I}),placeholder:Re.scope==="Default"?"*":"Rides & Logistics",hint:Re.scope==="Default"?"Use *":"Module, marketplace, or vendor"}),e.jsx(mi,{label:"GL code",value:Re.glCode,onChange:I=>ze(te=>te&&{...te,glCode:I}),placeholder:"4000"}),e.jsx(mi,{label:"Cost center",value:Re.costCenter,onChange:I=>ze(te=>te&&{...te,costCenter:I}),placeholder:"OPS-001"}),e.jsx(mi,{label:"Tax code",value:Re.taxCode,onChange:I=>ze(te=>te&&{...te,taxCode:I}),placeholder:"VAT18"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(S_,{label:"Memo",value:Re.memo,onChange:I=>ze(te=>te&&{...te,memo:I}),placeholder:"Optional memo",rows:3})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(X,{label:"Enabled",enabled:Re.enabled,onChange:I=>ze(te=>te&&{...te,enabled:I})})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Resolution order: Vendor, Marketplace, Module, Default."})]}):null}),e.jsx(Mh,{open:qe,title:"Reconciliation report preview",subtitle:"Audit-ready summary of matching and exceptions.",onClose:()=>He(!1),actions:[{label:"Export JSON",onClick:se}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(St,{variant:"outline",onClick:()=>He(!1),children:"Close"}),e.jsxs(St,{variant:"primary",onClick:se,children:[e.jsx(gt,{className:"h-4 w-4"})," Export JSON"]})]}),children:e.jsx(V,{payload:re()})})]});function P({label:I,value:te,tone:Se,icon:Xe}){const mt=Se==="good"?"bg-emerald-50 text-emerald-700":Se==="warn"?"bg-amber-50 text-amber-800":Se==="bad"?"bg-rose-50 text-rose-700":Se==="info"?"bg-blue-50 text-blue-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:I}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:te})]}),e.jsx("div",{className:oa("grid h-10 w-10 place-items-center rounded-2xl",mt),children:Xe})]})})}function X({label:I,enabled:te,onChange:Se}){return e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:I}),e.jsx("button",{type:"button",className:oa("relative h-7 w-12 rounded-full border transition",te?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>Se(!te),"aria-label":I,children:e.jsx("span",{className:oa("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",te?"left-[22px]":"left-1")})})]})}function S({rows:I,currency:te}){const[Se,Xe]=d.useState("Vendor"),[mt,ot]=d.useState("Amount"),Nt=d.useMemo(()=>W4(I,Se,mt,"amount"),[I,Se,mt]);return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(cd,{label:"Dimension",value:Se,onChange:nt=>Xe(nt),options:["Vendor","Service module","Marketplace","Group","Cost center","Tax code","Transaction type","Transaction status"].map(nt=>({value:nt,label:nt}))}),e.jsx(cd,{label:"Metric",value:mt,onChange:nt=>ot(nt),options:[{value:"Amount",label:"Amount"},{value:"Count",label:"Count"}]})]}),e.jsx("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:Se}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:mt})]})}),e.jsxs("tbody",{children:[Nt.slice(0,10).map(nt=>e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:nt.key}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:mt==="Amount"?Ma(nt.value,te):nt.value})]},nt.key)),Nt.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:2,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No rows."})})]})]})})]})}function w({rows:I,title:te,dim:Se}){const Xe=d.useMemo(()=>W4(I,Se,"Amount","amount"),[I,Se]);return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:te}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Top 6"})]}),e.jsx(kt,{label:"Premium",tone:"info"})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[Xe.slice(0,6).map(mt=>e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-800",children:mt.key}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:Ma(mt.value,"UGX")})]},mt.key)),Xe.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No data."})]})]})}function h(I,te){if(!I)return null;const Se=te.filter(nt=>nt.enabled),Xe=Se.find(nt=>nt.scope==="Vendor"&&nt.key===I.vendor);if(Xe)return Xe;const mt=Se.find(nt=>nt.scope==="Marketplace"&&nt.key===I.marketplace);if(mt)return mt;const ot=Se.find(nt=>nt.scope==="Module"&&nt.key===I.serviceModule);return ot||Se.find(nt=>nt.scope==="Default"&&nt.key==="*")||null}function K({tx:I,mappings:te,onPickTx:Se}){if(!I)return e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:["Select a transaction to preview ERP mapping.",e.jsx("div",{className:"mt-3",children:e.jsxs(St,{variant:"outline",onClick:Se,children:[e.jsx(et,{className:"h-4 w-4"})," Open ledger"]})})]});const Xe=h(I,te);return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:I.id}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[I.vendor,"  ",I.serviceModule,I.marketplace!=="-"?`  ${I.marketplace}`:""]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Amount: ",Ma(I.amount,I.currency),"  Status ",I.status]})]}),e.jsx(kt,{label:"Preview",tone:"info"})]}),e.jsxs("div",{className:"mt-3 rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Resolved mapping"}),Xe?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-2",children:["Scope: ",e.jsx("span",{className:"font-semibold",children:Xe.scope}),"  Key: ",e.jsx("span",{className:"font-semibold",children:Xe.key})]}),e.jsxs("div",{className:"mt-1",children:["GL: ",e.jsx("span",{className:"font-semibold",children:Xe.glCode}),"  Cost center: ",e.jsx("span",{className:"font-semibold",children:Xe.costCenter}),"  Tax: ",e.jsx("span",{className:"font-semibold",children:Xe.taxCode})]}),Xe.memo?e.jsxs("div",{className:"mt-2",children:["Memo: ",Xe.memo]}):null]}):e.jsx("div",{className:"mt-2",children:"No enabled mapping. Create a default mapping."})]})]})}function V({payload:I}){var te,Se;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Summary"}),e.jsxs("div",{className:"mt-2 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx(Ce,{label:"Invoice lines",value:String(I.summary.invoiceLines)}),e.jsx(Ce,{label:"Transactions",value:String(I.summary.transactions)}),e.jsx(Ce,{label:"Matches",value:String(I.summary.matches)}),e.jsx(Ce,{label:"Unmatched lines",value:String(I.summary.unmatchedLines)}),e.jsx(Ce,{label:"Unmatched posted tx",value:String(I.summary.unmatchedPostedTransactions)}),e.jsx(Ce,{label:"Open exceptions",value:String(I.summary.openExceptions)})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Unmatched lines"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Top 8"})]}),e.jsx(kt,{label:"Audit",tone:"info"})]}),e.jsx("div",{className:"mt-3 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Line"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Invoice"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Remaining"})]})}),e.jsxs("tbody",{children:[(I.unmatchedLines||[]).slice(0,8).map(Xe=>e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Xe.lineId}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Xe.invoiceNo}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Xe.vendor}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Ma(Xe.amount,"UGX")}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Ma(Xe.remaining,"UGX")})]},Xe.lineId)),(te=I.unmatchedLines)!=null&&te.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-10 text-center text-sm text-slate-600",children:"None"})})]})]})})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Audit log"}),e.jsxs("div",{className:"mt-3 space-y-2",children:[(I.audit||[]).slice(0,8).map(Xe=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(kt,{label:Xe.action,tone:"neutral"}),e.jsx(kt,{label:Xe.actor,tone:"info"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[dd(new Date(Xe.at).getTime()),"  ",Xe.entityRef]}),e.jsx("div",{className:"mt-2 text-xs text-slate-700",children:Xe.details})]}),e.jsx(kt,{label:"Audit",tone:"info"})]})},Xe.id)),(Se=I.audit)!=null&&Se.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No audit entries."})]})]}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"This preview is a subset. Export JSON to get the full report."})]})}function Ce({label:I,value:te}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:I}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:te})]})}}const gg={green:"#03CD8C",orange:"#F77F00"};function yl(...t){return t.filter(Boolean).join(" ")}function wc(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function Yr(t,s,a){return Math.max(s,Math.min(a,t))}function kc(t){return new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"2-digit"})}function X4(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function Et({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:yl("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Vt({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:gg.green}:t==="accent"?{background:gg.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:yl(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function R_({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:yl("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:yl("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function Nn({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:yl(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:yl("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function ym({label:t,value:s,onChange:a,hint:l,disabled:n}){return e.jsxs("div",{className:yl(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",value:s,onChange:r=>a(Number(r.target.value||0)),disabled:n,className:yl("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function ud({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:yl(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:yl("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function Ph({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:i=>a(i.target.value),placeholder:l,rows:r,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"})]})}function WE({actions:t}){const[s,a]=Xt.useState(!1),l=Xt.useRef(null);return Xt.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:yl("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function lb({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="980px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:12,scale:.985},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:12,scale:.985},transition:{duration:.18},className:"fixed inset-x-0 top-[7vh] z-50 mx-auto w-[min(1040px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(WE,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[72vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function D_({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,actions:i}){return d.useEffect(()=>{const o=c=>c.key==="Escape"&&n();return t&&window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,x:18},animate:{opacity:1,x:0},exit:{opacity:0,x:18},transition:{duration:.18},className:yl("fixed z-50 overflow-hidden border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]","left-2 right-2 bottom-2 top-[10vh] rounded-[28px]","lg:left-auto lg:right-4 lg:top-4 lg:bottom-4 lg:w-[720px]"),role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-base font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i&&e.jsx(WE,{actions:i}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"h-full min-h-0 overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function I_({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(480px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:yl("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function Gn({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function nb(t){return t==="Approved"?"good":t==="Blocked"?"bad":"warn"}function Nm(t){return t==="High"?"bad":t==="Medium"?"warn":"good"}function $_(t){return t==="Verified"?"good":t==="Expired"?"bad":"warn"}function xi(t){return t<55?"High":t<80?"Medium":"Low"}function pi(t){const a=Yr(t.rating*10,0,50),l=Yr((t.slaOnTimePct-70)*.6,-20,18),n=Yr(t.negotiatedTerms.discountPct*.8,0,12),r=t.complianceDocs.reduce((x,j)=>j.status==="Expired"?x+18:j.status==="Pending"?x+8:x,0),i=t.status==="Blocked"?40:0,o=t.status==="Pending"?10:0,c=50+a+l+n-r-i-o;return Math.round(Yr(c,0,100))}function L_(t,s){const a=t.riskScore,l=t.preferred?6:0,n=t.negotiatedTerms.discountPct,r=t.slaOnTimePct,i=t.rating,o=N=>t.modules.includes(N),c=N=>t.marketplaces.includes(N);let x=0;s==="Corporate Rides"&&(x=o("Rides & Logistics")?100:0),s==="EV Charging"&&(x=o("EVs & Charging")?100:0),s==="Deals Procurement"&&(x=c("MyLiveDealz")?100:0),s==="Office Supplies"&&(x=c("EVmart")||c("LivingMart")||c("GeneratMart")?100:0),s==="IT Devices"&&(x=c("GadgetMart")?100:0),s==="Facilities Services"&&(x=c("ServiceMart")?100:0),s==="Travel Procurement"&&(x=o("Travel & Tourism")||c("ExpressMart")?100:0);const j=Yr(i*12+r*.25+n*1.2,0,100),g=t.status!=="Approved"?45:0;return Math.round(Yr(.45*x+.35*j+.2*a+l-g,0,100))}function F_(){const t=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],s=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],a=["Corporate Rides","EV Charging","Office Supplies","IT Devices","Facilities Services","Travel Procurement","Deals Procurement"],[l,n]=d.useState([]),r=M=>{const H=wc("toast");n(Ae=>[{id:H,...M},...Ae].slice(0,4)),window.setTimeout(()=>n(Ae=>Ae.filter(oe=>oe.id!==H)),3200)},[i,o]=d.useState(()=>{const M=Date.now(),H=(De,$e,ge,ue,Ke="")=>({id:wc("DOC"),type:De,name:ue,status:$e,issuedAt:M-120*24*60*60*1e3,expiresAt:M+ge*24*60*60*1e3,notes:Ke}),Ae=(De,$e,ge,ue,Ke)=>({id:wc("CTR"),title:De,startAt:M-ge*24*60*60*1e3,endAt:M+ue*24*60*60*1e3,paymentTerms:"Net 14",discountPct:$e,slaText:"On-time delivery 92%+, response < 2h",rateCardName:Ke,notes:"Negotiated for corporate volumes."});return[{id:"V-001",name:"EVzone Rides",country:"Uganda",city:"Kampala",status:"Approved",preferred:!0,categories:["Mobility","Corporate transport"],modules:["Rides & Logistics"],marketplaces:[],rating:4.6,slaOnTimePct:93,negotiatedTerms:{discountPct:7,paymentTerms:"Net 14",warrantyDays:0},riskScore:88,riskLevel:"Low",complianceDocs:[H("License","Verified",200,"Operations license"),H("Insurance","Verified",80,"Liability insurance")],contracts:[Ae("Ride services master agreement",7,120,240,"Ride rate card v3.pdf")],lastActiveAt:M-2*60*60*1e3,notes:"Preferred vendor for corporate rides."},{id:"V-002",name:"EVzone Charging",country:"Uganda",city:"Kampala",status:"Approved",preferred:!0,categories:["Energy","EV infrastructure"],modules:["EVs & Charging"],marketplaces:[],rating:4.3,slaOnTimePct:90,negotiatedTerms:{discountPct:5,paymentTerms:"Net 7",warrantyDays:0},riskScore:83,riskLevel:"Low",complianceDocs:[H("License","Verified",180,"Energy operations license"),H("Insurance","Verified",40,"Equipment insurance")],contracts:[Ae("Charging credits agreement",5,60,300,"Charging rate card.pdf")],lastActiveAt:M-7*60*60*1e3,notes:"Charging credits supplier."},{id:"V-003",name:"Kampala Office Mart",country:"Uganda",city:"Kampala",status:"Approved",preferred:!1,categories:["Office supplies","Consumables"],modules:["E-Commerce"],marketplaces:["EVmart","GeneratMart"],rating:4.1,slaOnTimePct:86,negotiatedTerms:{discountPct:3,paymentTerms:"Net 14",warrantyDays:14},riskScore:74,riskLevel:"Medium",complianceDocs:[H("Tax/VAT","Verified",140,"VAT certificate"),H("Business registration","Verified",320,"Registration")],contracts:[Ae("Office supplies agreement",3,30,200,"Office supplies rate card.xlsx")],lastActiveAt:M-2*24*60*60*1e3,notes:"Local supplier for office and general supplies."},{id:"V-004",name:"Shenzhen Store",country:"China",city:"Shenzhen",status:"Approved",preferred:!1,categories:["Imports","Electronics"],modules:["E-Commerce"],marketplaces:["MyLiveDealz","GadgetMart"],rating:4,slaOnTimePct:82,negotiatedTerms:{discountPct:8,paymentTerms:"Net 30",warrantyDays:90},riskScore:68,riskLevel:"Medium",complianceDocs:[H("Business registration","Verified",300,"Business license"),H("Insurance","Pending",120,"Cargo insurance","Pending verification")],contracts:[Ae("Cross-border procurement",8,10,180,"Imports rate card.pdf")],lastActiveAt:M-9*60*60*1e3,notes:"Used for deals procurement. Monitor compliance."},{id:"V-005",name:"ServicePro",country:"Uganda",city:"Kampala",status:"Pending",preferred:!1,categories:["Facilities","Maintenance"],modules:["E-Commerce"],marketplaces:["ServiceMart"],rating:3.8,slaOnTimePct:76,negotiatedTerms:{discountPct:0,paymentTerms:"Due on receipt",warrantyDays:30},riskScore:60,riskLevel:"Medium",complianceDocs:[H("Insurance","Pending",60,"Liability insurance","Awaiting certificate"),H("License","Pending",60,"Trade license")],contracts:[],lastActiveAt:M-14*24*60*60*1e3,notes:"Awaiting onboarding checks."},{id:"V-006",name:"Express CN",country:"China",city:"Wuxi",status:"Blocked",preferred:!1,categories:["Logistics"],modules:["E-Commerce"],marketplaces:["ExpressMart"],rating:2.9,slaOnTimePct:62,negotiatedTerms:{discountPct:0,paymentTerms:"Net 7",warrantyDays:0},riskScore:34,riskLevel:"High",complianceDocs:[H("Insurance","Expired",-10,"Cargo insurance","Expired"),H("Tax/VAT","Pending",90,"Tax certificate")],contracts:[],lastActiveAt:M-40*24*60*60*1e3,notes:"Blocked due to expired insurance and SLA breaches."}].map(De=>{const $e=pi(De);return{...De,riskScore:$e,riskLevel:xi($e)}}).sort((De,$e)=>De.status!==$e.status?De.status==="Pending"?-1:1:$e.riskScore-De.riskScore)}),[c,x]=d.useState("directory"),[j,g]=d.useState(""),[N,$]=d.useState("All"),[T,k]=d.useState("All"),[q,L]=d.useState("All"),[R,U]=d.useState("All"),[ae,ie]=d.useState(!1),[_,W]=d.useState(!1),[J,we]=d.useState(null),G=d.useMemo(()=>J&&i.find(M=>M.id===J)||null,[J,i]),[be,Ge]=d.useState(!1),[Me,je]=d.useState(()=>({id:"",name:"",country:"Uganda",city:"Kampala",status:"Pending",preferred:!1,categories:[""],modules:["E-Commerce"],marketplaces:["Other Marketplace"],rating:4,slaOnTimePct:85,negotiatedTerms:{discountPct:0,paymentTerms:"Net 14",warrantyDays:30},riskScore:70,riskLevel:"Medium",complianceDocs:[],contracts:[],lastActiveAt:Date.now(),notes:""})),[Ue,Oe]=d.useState(!1),[he,Y]=d.useState(()=>({id:"",type:"License",name:"",status:"Pending",issuedAt:Date.now(),expiresAt:Date.now()+180*24*60*60*1e3,notes:""})),[Ie,ce]=d.useState(!1),[me,pe]=d.useState(()=>({id:"",title:"",startAt:Date.now()-7*24*60*60*1e3,endAt:Date.now()+180*24*60*60*1e3,paymentTerms:"Net 14",discountPct:0,slaText:"",rateCardName:"",notes:""})),de=d.useMemo(()=>{const M=i.length,H=i.filter(ue=>ue.status==="Approved").length,Ae=i.filter(ue=>ue.status==="Pending").length,oe=i.filter(ue=>ue.status==="Blocked").length,De=i.filter(ue=>ue.preferred&&ue.status==="Approved").length,$e=i.filter(ue=>ue.riskLevel==="High").length,ge=i.reduce((ue,Ke)=>{const b=Ke.complianceDocs.some(v=>v.expiresAt&&v.expiresAt<Date.now()+2592e6&&v.status==="Verified");return ue+(b?1:0)},0);return{total:M,approved:H,pending:Ae,blocked:oe,preferred:De,highRisk:$e,expiringDocs:ge}},[i]),ye=d.useMemo(()=>{const M=j.trim().toLowerCase();return i.filter(H=>N==="All"?!0:H.status===N).filter(H=>T==="All"?!0:H.riskLevel===T).filter(H=>ae?H.preferred:!0).filter(H=>q==="All"?!0:H.modules.includes(q)).filter(H=>R==="All"?!0:H.marketplaces.includes(R)).filter(H=>M?`${H.id} ${H.name} ${H.country} ${H.city} ${H.status} ${H.categories.join(" ")} ${H.modules.join(" ")} ${H.marketplaces.join(" ")}`.toLowerCase().includes(M):!0).slice().sort((H,Ae)=>H.status!==Ae.status?H.status==="Pending"?-1:1:H.preferred!==Ae.preferred?H.preferred?-1:1:Ae.riskScore-H.riskScore)},[i,j,N,T,ae,q,R]),Qe=d.useMemo(()=>i.filter(M=>M.status==="Pending"),[i]),Fe=d.useMemo(()=>i.map(H=>{const Ae=H.complianceDocs.filter(b=>b.status==="Expired").length,oe=H.complianceDocs.filter(b=>b.status==="Pending").length,De=H.complianceDocs.filter(b=>b.status==="Verified").length,$e=H.complianceDocs.some(b=>b.type==="Insurance"&&b.status==="Verified"),ge=H.complianceDocs.some(b=>b.type==="License"&&b.status==="Verified"),ue=H.riskScore,Ke=(Ae>0?2:0)+(oe>1?1:0)+($e?0:1)+(ge?0:1)+(H.status==="Blocked"?2:0);return{vendor:H,expired:Ae,pending:oe,verified:De,hasInsurance:$e,hasLicense:ge,score:ue,redFlags:Ke}}).sort((H,Ae)=>Ae.redFlags-H.redFlags||H.score-Ae.score),[i]),ke=d.useMemo(()=>{const M=i.filter(H=>H.status==="Approved");return a.map(H=>{const Ae=M.map(oe=>({vendor:oe,score:L_(oe,H)})).filter(oe=>oe.score>0).sort((oe,De)=>De.score-oe.score);return{category:H,top:Ae.slice(0,3)}})},[i]),fe=()=>{const M={vendors:i,exportedAt:new Date().toISOString()},H=new Blob([JSON.stringify(M,null,2)],{type:"application/json"}),Ae=URL.createObjectURL(H),oe=document.createElement("a");oe.href=Ae,oe.download="corporatepay-vendors.json",oe.click(),URL.revokeObjectURL(Ae),r({title:"Exported",message:"Vendors JSON downloaded.",kind:"success"})},Ve=async()=>{try{await navigator.clipboard.writeText(JSON.stringify(i,null,2)),r({title:"Copied",message:"Copied vendors JSON to clipboard.",kind:"success"})}catch{r({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},ne=M=>{we(M),W(!0)},Te=M=>{o(H=>H.map(Ae=>{if(Ae.id!==M)return Ae;const oe=pi(Ae);return{...Ae,riskScore:oe,riskLevel:xi(oe)}})),r({title:"Risk updated",message:"Vendor risk score recalculated.",kind:"success"})},Ee=(M,H)=>{o(Ae=>Ae.map(oe=>{if(oe.id!==M)return oe;const De={...oe,status:H},$e=pi(De);return{...De,riskScore:$e,riskLevel:xi($e)}})),r({title:"Updated",message:`Vendor status set to ${H}.`,kind:"success"})},Re=M=>{o(H=>H.map(Ae=>Ae.id!==M?Ae:{...Ae,preferred:!Ae.preferred})),r({title:"Updated",message:"Preferred vendor updated.",kind:"info"})},ze=()=>{je({id:"",name:"",country:"Uganda",city:"Kampala",status:"Pending",preferred:!1,categories:[""],modules:["E-Commerce"],marketplaces:["Other Marketplace"],rating:4,slaOnTimePct:85,negotiatedTerms:{discountPct:0,paymentTerms:"Net 14",warrantyDays:30},riskScore:70,riskLevel:"Medium",complianceDocs:[],contracts:[],lastActiveAt:Date.now(),notes:""}),Ge(!0)},qe=M=>{je(JSON.parse(JSON.stringify(M))),Ge(!0)},He=()=>{if(!Me.name.trim()){r({title:"Missing name",message:"Vendor name is required.",kind:"warn"});return}const M=Date.now(),H=!Me.id,Ae=Me.id||wc("V"),oe=Me.categories.map(ge=>ge.trim()).filter(Boolean),De={...Me,id:Ae,categories:oe.length?oe:["Other"],lastActiveAt:H?M:Me.lastActiveAt},$e=pi(De);De.riskScore=$e,De.riskLevel=xi($e),o(ge=>{const ue=ge.findIndex(b=>b.id===Ae),Ke=ge.slice();return ue>=0?Ke[ue]=De:Ke.unshift(De),Ke}),r({title:"Saved",message:"Vendor saved.",kind:"success"}),Ge(!1),we(Ae)},_e=M=>{o(H=>H.filter(Ae=>Ae.id!==M)),J===M&&(we(null),W(!1)),r({title:"Deleted",message:"Vendor deleted.",kind:"info"})},le=()=>{if(!G){r({title:"Select vendor",message:"Open a vendor first.",kind:"warn"});return}Y({id:"",type:"License",name:"",status:"Pending",issuedAt:Date.now()-30*24*60*60*1e3,expiresAt:Date.now()+180*24*60*60*1e3,notes:""}),Oe(!0)},z=()=>{if(!G)return;if(!he.name.trim()){r({title:"Missing",message:"Document name is required.",kind:"warn"});return}const M={...he,id:he.id||wc("DOC")};o(H=>H.map(Ae=>{if(Ae.id!==G.id)return Ae;const oe=Ae.complianceDocs.slice(),De=oe.findIndex(ue=>ue.id===M.id);De>=0?oe[De]=M:oe.unshift(M);const $e={...Ae,complianceDocs:oe},ge=pi($e);return{...$e,riskScore:ge,riskLevel:xi(ge)}})),r({title:"Saved",message:"Compliance document saved.",kind:"success"}),Oe(!1)},Pe=M=>{G&&(o(H=>H.map(Ae=>{if(Ae.id!==G.id)return Ae;const oe={...Ae,complianceDocs:Ae.complianceDocs.filter($e=>$e.id!==M)},De=pi(oe);return{...oe,riskScore:De,riskLevel:xi(De)}})),r({title:"Deleted",message:"Document removed.",kind:"info"}))},Be=()=>{if(!G){r({title:"Select vendor",message:"Open a vendor first.",kind:"warn"});return}pe({id:"",title:"",startAt:Date.now()-7*24*60*60*1e3,endAt:Date.now()+180*24*60*60*1e3,paymentTerms:"Net 14",discountPct:0,slaText:"On-time delivery 90%+, response < 4h",rateCardName:"",notes:""}),ce(!0)},xe=()=>{if(!G)return;if(!me.title.trim()){r({title:"Missing",message:"Contract title is required.",kind:"warn"});return}const M={...me,id:me.id||wc("CTR")};o(H=>H.map(Ae=>{if(Ae.id!==G.id)return Ae;const oe=Ae.contracts.slice(),De=oe.findIndex(ue=>ue.id===M.id);De>=0?oe[De]=M:oe.unshift(M);const $e={...Ae,contracts:oe,negotiatedTerms:{...Ae.negotiatedTerms,discountPct:Math.max(Ae.negotiatedTerms.discountPct,M.discountPct),paymentTerms:M.paymentTerms||Ae.negotiatedTerms.paymentTerms}},ge=pi($e);return{...$e,riskScore:ge,riskLevel:xi(ge)}})),r({title:"Saved",message:"Contract saved.",kind:"success"}),ce(!1)},Ne=M=>{G&&(o(H=>H.map(Ae=>{if(Ae.id!==G.id)return Ae;const oe={...Ae,contracts:Ae.contracts.filter($e=>$e.id!==M)},De=pi(oe);return{...oe,riskScore:De,riskLevel:xi(De)}})),r({title:"Deleted",message:"Contract removed.",kind:"info"}))};return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(I_,{toasts:l,onDismiss:M=>n(H=>H.filter(Ae=>Ae.id!==M))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:gg.green},children:e.jsx(Xl,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Vendor and Catalog Management"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Vendor directory across modules and marketplaces, allowlist and denylist, compliance docs, contracts, and preferred vendor recommendations."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(Et,{label:`Total: ${de.total}`,tone:"neutral"}),e.jsx(Et,{label:`Approved: ${de.approved}`,tone:"good"}),e.jsx(Et,{label:`Pending: ${de.pending}`,tone:de.pending?"warn":"good"}),e.jsx(Et,{label:`Blocked: ${de.blocked}`,tone:de.blocked?"bad":"good"}),e.jsx(Et,{label:`Preferred: ${de.preferred}`,tone:"info"}),e.jsx(Et,{label:`High risk: ${de.highRisk}`,tone:de.highRisk?"bad":"good"}),e.jsx(Et,{label:`Docs expiring: ${de.expiringDocs}`,tone:de.expiringDocs?"warn":"good"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Vt,{variant:"outline",onClick:Ve,children:[e.jsx(ls,{className:"h-4 w-4"})," Copy JSON"]}),e.jsxs(Vt,{variant:"outline",onClick:fe,children:[e.jsx(gt,{className:"h-4 w-4"})," Export"]}),e.jsxs(Vt,{variant:"outline",onClick:()=>x("requests"),children:[e.jsx(g0,{className:"h-4 w-4"})," Requests (",Qe.length,")"]}),e.jsxs(Vt,{variant:"primary",onClick:ze,children:[e.jsx(pt,{className:"h-4 w-4"})," New vendor"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"directory",label:"Directory"},{id:"requests",label:"Vendor requests"},{id:"risk",label:"Risk and compliance"},{id:"contracts",label:"Contracts and rate cards"},{id:"recommendations",label:"Preferred recommendations"}].map(M=>e.jsx("button",{className:yl("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",c===M.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:c===M.id?{background:gg.green}:void 0,onClick:()=>x(M.id),children:M.label},M.id))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[c==="directory"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(Gn,{title:"Filters",subtitle:"Search and slice vendor directory.",right:e.jsx(Et,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-2 py-2",children:[e.jsx(ka,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:j,onChange:M=>g(M.target.value),placeholder:"Vendor name, module, marketplace...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(ud,{label:"Status",value:N,onChange:M=>$(M),options:[{value:"All",label:"All"},{value:"Approved",label:"Approved"},{value:"Pending",label:"Pending"},{value:"Blocked",label:"Blocked"}]}),e.jsx(ud,{label:"Risk",value:T,onChange:M=>k(M),options:[{value:"All",label:"All"},{value:"Low",label:"Low"},{value:"Medium",label:"Medium"},{value:"High",label:"High"}]}),e.jsx(ud,{label:"Module",value:q,onChange:M=>L(M),options:[{value:"All",label:"All"},...t.map(M=>({value:M,label:M}))]}),e.jsx(ud,{label:"Marketplace",value:R,onChange:M=>U(M),options:[{value:"All",label:"All"},...s.map(M=>({value:M,label:M}))],hint:"E-Commerce"})]}),e.jsx("div",{className:"mt-3",children:e.jsx(R_,{enabled:ae,onChange:ie,label:"Preferred only",description:"Show preferred vendors first"})}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Vt,{variant:"outline",onClick:()=>{g(""),$("All"),k("All"),L("All"),U("All"),ie(!1),r({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(fn,{className:"h-4 w-4"})," Reset"]}),e.jsxs(Vt,{variant:"outline",onClick:()=>x("risk"),children:[e.jsx(Hm,{className:"h-4 w-4"})," Risk"]}),e.jsxs(Vt,{variant:"outline",onClick:()=>x("recommendations"),children:[e.jsx(Dl,{className:"h-4 w-4"})," Recommendations"]})]})]}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: Vendor risk scoring is logic-based initially. Later, you can enrich it with compliance signals and dispute history."})]})}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs(Gn,{title:"Vendor directory",subtitle:"Approve vendors (allowlist) or block (denylist). Open a vendor to view compliance and contracts.",right:e.jsx(Et,{label:`${ye.length} vendor(s)`,tone:"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Risk"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Rating"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"SLA"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Terms"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Modules"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Marketplaces"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[ye.map(M=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"flex items-start justify-between gap-3",children:e.jsxs("button",{className:"text-left",onClick:()=>ne(M.id),children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:M.name}),M.preferred?e.jsx(Et,{label:"Preferred",tone:"info"}):null,e.jsx(Et,{label:M.id,tone:"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[M.city,", ",M.country,"  Active ",X4(M.lastActiveAt)]})]})})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Et,{label:M.status,tone:nb(M.status)})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(Et,{label:`${M.riskLevel} (${M.riskScore})`,tone:Nm(M.riskLevel)}),M.complianceDocs.some(H=>H.status==="Expired")?e.jsx(Et,{label:"Expired doc",tone:"bad"}):null]})}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[e.jsx("span",{className:"font-semibold text-slate-900",children:M.rating.toFixed(1)})," / 5"]}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[e.jsxs("span",{className:"font-semibold text-slate-900",children:[M.slaOnTimePct,"%"]})," on-time"]}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Discount ",e.jsxs("span",{className:"font-semibold text-slate-900",children:[M.negotiatedTerms.discountPct,"%"]})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Terms ",e.jsx("span",{className:"font-semibold text-slate-900",children:M.negotiatedTerms.paymentTerms})]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[M.modules.slice(0,2).map(H=>e.jsx(Et,{label:H,tone:"neutral"},H)),M.modules.length>2?e.jsx(Et,{label:`+${M.modules.length-2}`,tone:"neutral"}):null]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[M.marketplaces.slice(0,2).map(H=>e.jsx(Et,{label:H,tone:"neutral"},H)),M.marketplaces.length>2?e.jsx(Et,{label:`+${M.marketplaces.length-2}`,tone:"neutral"}):null,M.marketplaces.length?null:e.jsx(Et,{label:"-",tone:"neutral"})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Vt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Re(M.id),disabled:M.status!=="Approved",title:M.status!=="Approved"?"Approve first":"",children:e.jsx(Dl,{className:"h-4 w-4"})}),e.jsxs(Vt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>qe(M),children:[e.jsx(wl,{className:"h-4 w-4"})," Edit"]}),M.status!=="Approved"?e.jsxs(Vt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>Ee(M.id,"Approved"),children:[e.jsx(Co,{className:"h-4 w-4"})," Approve"]}):e.jsxs(Vt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Ee(M.id,"Blocked"),children:[e.jsx(Hm,{className:"h-4 w-4"})," Block"]}),e.jsxs(Vt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ne(M.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]})]})})]},M.id)),ye.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-4 py-12 text-center text-sm text-slate-600",children:"No vendors match your filters."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Core: allowlist and denylist. Premium: risk scoring, compliance docs, contracts, and preferred recommendations."})]})})]}):null,c==="requests"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(Gn,{title:"Requests",subtitle:"Pending vendors awaiting approval.",right:e.jsx(Et,{label:`${Qe.length}`,tone:Qe.length?"warn":"good"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Approve vendors to add them to the allowlist. Block vendors to deny access."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Vt,{variant:"primary",onClick:ze,children:[e.jsx(pt,{className:"h-4 w-4"})," New vendor"]}),e.jsxs(Vt,{variant:"outline",onClick:()=>x("directory"),children:[e.jsx(et,{className:"h-4 w-4"})," Directory"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: onboarding can require compliance documents before approval."})]})}),e.jsx("div",{className:"lg:col-span-8",children:e.jsx(Gn,{title:"Pending approvals",subtitle:"Approve or block.",right:e.jsx(Et,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[Qe.map(M=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:M.name}),e.jsx(Et,{label:M.id,tone:"neutral"}),e.jsx(Et,{label:`${M.riskLevel} (${M.riskScore})`,tone:Nm(M.riskLevel)})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[M.city,", ",M.country,"  Rating ",M.rating.toFixed(1),"  SLA ",M.slaOnTimePct,"%"]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[M.modules.map(H=>e.jsx(Et,{label:H,tone:"neutral"},H)),M.marketplaces.map(H=>e.jsx(Et,{label:H,tone:"neutral"},H))]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Docs: ",M.complianceDocs.length,"  Contracts: ",M.contracts.length]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Vt,{variant:"outline",onClick:()=>ne(M.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]}),e.jsxs(Vt,{variant:"primary",onClick:()=>Ee(M.id,"Approved"),children:[e.jsx(Co,{className:"h-4 w-4"})," Approve"]}),e.jsxs(Vt,{variant:"outline",onClick:()=>Ee(M.id,"Blocked"),children:[e.jsx(Hm,{className:"h-4 w-4"})," Block"]})]})]})},M.id)),Qe.length?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No pending vendors."})]})})})]}):null,c==="risk"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsxs(Gn,{title:"Risk hotspots",subtitle:"High risk or missing compliance.",right:e.jsx(Et,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"space-y-2",children:Fe.slice(0,8).map(M=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("button",{className:"text-left",onClick:()=>ne(M.vendor.id),children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:M.vendor.name}),e.jsx(Et,{label:M.vendor.status,tone:nb(M.vendor.status)}),e.jsx(Et,{label:`${M.vendor.riskLevel} (${M.vendor.riskScore})`,tone:Nm(M.vendor.riskLevel)})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Expired: ",M.expired,"  Pending: ",M.pending,"  Verified: ",M.verified]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Insurance: ",M.hasInsurance?"Yes":"No","  License: ",M.hasLicense?"Yes":"No"]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(Vt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Te(M.vendor.id),children:[e.jsx(Nv,{className:"h-4 w-4"})," Recalc"]}),e.jsxs(Vt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ne(M.vendor.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]})]})]})},M.vendor.id))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: Attach compliance documents and mark them verified to improve risk score."})]})}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs(Gn,{title:"Compliance overview",subtitle:"Doc status across all vendors.",right:e.jsx(Et,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Docs"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Verified"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Pending"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Expired"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsx("tbody",{children:i.slice().sort((M,H)=>{const Ae=M.complianceDocs.filter(De=>De.status==="Expired").length;return H.complianceDocs.filter(De=>De.status==="Expired").length-Ae||M.riskScore-H.riskScore}).slice(0,10).map(M=>{const H=M.complianceDocs.filter(De=>De.status==="Verified").length,Ae=M.complianceDocs.filter(De=>De.status==="Pending").length,oe=M.complianceDocs.filter(De=>De.status==="Expired").length;return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:M.name}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:M.complianceDocs.length}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Et,{label:`${H}`,tone:H?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Et,{label:`${Ae}`,tone:Ae?"warn":"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Et,{label:`${oe}`,tone:oe?"bad":"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Vt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ne(M.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]}),e.jsxs(Vt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Te(M.id),children:[e.jsx(Nv,{className:"h-4 w-4"})," Recalc"]})]})})]},M.id)})})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: For enterprise safety, require Insurance + License verified before approval for sensitive categories."})]})})]}):null,c==="contracts"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(Gn,{title:"Contracts and rate cards",subtitle:"Premium: contract + rate-card storage.",right:e.jsx(Et,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Open a vendor to add contract documents and rate cards. Use negotiated terms for approvals and savings insights."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Vt,{variant:"outline",onClick:()=>x("directory"),children:[e.jsx(et,{className:"h-4 w-4"})," Open directory"]}),e.jsxs(Vt,{variant:"primary",onClick:()=>{!J&&i[0]&&we(i[0].id),W(!0)},children:[e.jsx(et,{className:"h-4 w-4"})," Open vendor"]})]})]})}),e.jsx("div",{className:"lg:col-span-8",children:e.jsx(Gn,{title:"Active contracts",subtitle:"Across all vendors.",right:e.jsx(Et,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"space-y-2",children:[i.flatMap(M=>M.contracts.map(H=>({vendor:M,contract:H}))).sort((M,H)=>H.contract.startAt-M.contract.startAt).slice(0,12).map(({vendor:M,contract:H})=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:H.title}),e.jsx(Et,{label:M.name,tone:"neutral"}),e.jsx(Et,{label:`${H.discountPct}% discount`,tone:H.discountPct?"info":"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[kc(H.startAt),"  ",kc(H.endAt),"  ",H.paymentTerms]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Rate card: ",H.rateCardName||"-"]}),H.slaText?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["SLA: ",H.slaText]}):null]}),e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:e.jsxs(Vt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ne(M.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open vendor"]})})]})},H.id)),i.some(M=>M.contracts.length)?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No contracts yet."})]})})})]}):null,c==="recommendations"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(Gn,{title:"How recommendations work",subtitle:"Premium: preferred vendor recommendations by spend category.",right:e.jsx(Et,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Recommendations are based on:",e.jsxs("ul",{className:"mt-2 space-y-1",children:[e.jsx("li",{children:"1) Vendor fit (module/marketplace coverage)"}),e.jsx("li",{children:"2) Quality (rating + SLA)"}),e.jsx("li",{children:"3) Savings (negotiated discount)"}),e.jsx("li",{children:"4) Risk score (compliance and history)"}),e.jsx("li",{children:"5) Preferred flag (admin curated)"})]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Tip: Approvals can auto-route to preferred vendors, and non-preferred purchases can require additional approvals."})]})}),e.jsx("div",{className:"lg:col-span-8",children:e.jsx(Gn,{title:"Recommended vendors",subtitle:"Top 3 per spend category.",right:e.jsx(Et,{label:"Premium",tone:"info"}),children:e.jsx("div",{className:"space-y-3",children:ke.map(M=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ly,{className:"h-4 w-4 text-slate-500"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:M.category})]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Top vendors based on fit, savings, and risk."})]}),e.jsx(Et,{label:M.top.length?"Available":"No vendors",tone:M.top.length?"good":"warn"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-3",children:[M.top.map(H=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:H.vendor.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Score ",H.score,"/100"]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(Et,{label:H.vendor.riskLevel,tone:Nm(H.vendor.riskLevel)}),e.jsx(Et,{label:`${H.vendor.rating.toFixed(1)}`,tone:"neutral"}),e.jsx(Et,{label:`${H.vendor.slaOnTimePct}% SLA`,tone:"neutral"}),e.jsx(Et,{label:`${H.vendor.negotiatedTerms.discountPct}% off`,tone:H.vendor.negotiatedTerms.discountPct?"info":"neutral"})]})]}),H.vendor.preferred?e.jsx(Dl,{className:"h-5 w-5 text-amber-500"}):e.jsx(Dl,{className:"h-5 w-5 text-slate-300"})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Vt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ne(H.vendor.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]}),e.jsxs(Vt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Re(H.vendor.id),disabled:H.vendor.status!=="Approved",children:[e.jsx(Dl,{className:"h-4 w-4"})," Preferred"]})]})]},H.vendor.id)),M.top.length?null:e.jsx("div",{className:"md:col-span-3 rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No approved vendors match this category yet."})]})]},M.category))})})})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"R Vendor and Catalog Management v2. Core: vendor directory, allowlist and denylist, metadata. Premium: risk scoring and compliance docs, contracts and rate cards, and preferred vendor recommendations."})})]})}),e.jsx(D_,{open:_,title:G?G.name:"Vendor",subtitle:G?`${G.city}, ${G.country}  ${G.status}  Risk ${G.riskScore}/100`:"",onClose:()=>W(!1),footer:G?e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsxs(Vt,{variant:"outline",onClick:()=>qe(G),children:[e.jsx(wl,{className:"h-4 w-4"})," Edit vendor"]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Vt,{variant:"outline",onClick:()=>Te(G.id),children:[e.jsx(Nv,{className:"h-4 w-4"})," Recalc risk"]}),e.jsxs(Vt,{variant:"outline",onClick:le,children:[e.jsx(dg,{className:"h-4 w-4"})," Add doc"]}),e.jsxs(Vt,{variant:"outline",onClick:Be,children:[e.jsx(pt,{className:"h-4 w-4"})," Add contract"]})]})]}):null,children:G?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Et,{label:G.status,tone:nb(G.status)}),e.jsx(Et,{label:G.preferred?"Preferred":"Standard",tone:G.preferred?"info":"neutral"}),e.jsx(Et,{label:`${G.riskLevel} (${G.riskScore})`,tone:Nm(G.riskLevel)}),e.jsx(Et,{label:`${G.rating.toFixed(1)}`,tone:"neutral"}),e.jsx(Et,{label:`${G.slaOnTimePct}% SLA`,tone:"neutral"})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Categories: ",G.categories.join(", ")]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Last active: ",X4(G.lastActiveAt)]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsxs(Vt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Re(G.id),disabled:G.status!=="Approved",children:[e.jsx(Dl,{className:"h-4 w-4"})," ",G.preferred?"Unprefer":"Prefer"]}),G.status!=="Approved"?e.jsxs(Vt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>Ee(G.id,"Approved"),children:[e.jsx(Co,{className:"h-4 w-4"})," Approve"]}):e.jsxs(Vt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Ee(G.id,"Blocked"),children:[e.jsx(Hm,{className:"h-4 w-4"})," Block"]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Negotiated terms"}),e.jsxs("div",{className:"mt-2",children:["Discount: ",e.jsxs("span",{className:"font-semibold",children:[G.negotiatedTerms.discountPct,"%"]})]}),e.jsxs("div",{className:"mt-1",children:["Payment terms: ",e.jsx("span",{className:"font-semibold",children:G.negotiatedTerms.paymentTerms})]}),e.jsxs("div",{className:"mt-1",children:["Warranty: ",e.jsxs("span",{className:"font-semibold",children:[G.negotiatedTerms.warrantyDays," day(s)"]})]})]}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Coverage"}),e.jsxs("div",{className:"mt-2",children:["Modules: ",G.modules.join(", ")||"-"]}),e.jsxs("div",{className:"mt-1",children:["Marketplaces: ",G.marketplaces.join(", ")||"-"]})]})]}),G.notes?e.jsx("div",{className:"mt-3 rounded-2xl bg-white p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:G.notes}):null]}),e.jsx(Gn,{title:"Compliance documents",subtitle:"Premium: licenses, insurance, and verification.",right:e.jsx(Et,{label:`${G.complianceDocs.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[G.complianceDocs.map(M=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Et,{label:M.type,tone:"neutral"}),e.jsx(Et,{label:M.status,tone:$_(M.status)}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:M.name})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Issued ",M.issuedAt?kc(M.issuedAt):"-","  Expires ",M.expiresAt?kc(M.expiresAt):"-"]}),M.notes?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Notes: ",M.notes]}):null]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Vt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{const H=M.status==="Pending"?"Verified":M.status==="Verified"?"Expired":"Pending";o(Ae=>Ae.map(oe=>{if(oe.id!==G.id)return oe;const De=oe.complianceDocs.map(ue=>ue.id===M.id?{...ue,status:H}:ue),$e={...oe,complianceDocs:De},ge=pi($e);return{...$e,riskScore:ge,riskLevel:xi(ge)}})),r({title:"Updated",message:"Document status updated.",kind:"success"})},children:[e.jsx(HF,{className:"h-4 w-4"})," Toggle status"]}),e.jsx(Vt,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>Pe(M.id),children:e.jsx(as,{className:"h-4 w-4"})})]})]})},M.id)),G.complianceDocs.length?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No compliance docs yet. Add License and Insurance for enterprise safety."})]})}),e.jsx(Gn,{title:"Contracts and rate cards",subtitle:"Premium: store agreements and rate cards.",right:e.jsx(Et,{label:`${G.contracts.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[G.contracts.map(M=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:M.title}),e.jsx(Et,{label:`${M.discountPct}% off`,tone:M.discountPct?"info":"neutral"}),e.jsx(Et,{label:M.paymentTerms,tone:"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[kc(M.startAt),"  ",kc(M.endAt)]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Rate card: ",M.rateCardName||"-"]}),M.slaText?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["SLA: ",M.slaText]}):null,M.notes?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Notes: ",M.notes]}):null]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(Vt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{pe(JSON.parse(JSON.stringify(M))),ce(!0)},children:[e.jsx(wl,{className:"h-4 w-4"})," Edit"]}),e.jsx(Vt,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>Ne(M.id),children:e.jsx(as,{className:"h-4 w-4"})})]})]})},M.id)),G.contracts.length?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No contracts. Add a contract and rate card for negotiated pricing."})]})})]}):e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"Select a vendor."})}),e.jsx(lb,{open:be,title:Me.id?"Edit vendor":"New vendor",subtitle:"Core: vendor directory and allowlist/denylist. Premium: compliance and contracts are added per vendor.",onClose:()=>Ge(!1),actions:[{label:"Save",onClick:He},...Me.id?[{label:"Delete",onClick:()=>{_e(Me.id),Ge(!1)},variant:"danger"}]:[]],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Vt,{variant:"outline",onClick:()=>Ge(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[Me.id?e.jsxs(Vt,{variant:"danger",onClick:()=>{_e(Me.id),Ge(!1)},children:[e.jsx(as,{className:"h-4 w-4"})," Delete"]}):null,e.jsxs(Vt,{variant:"primary",onClick:He,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Nn,{label:"Vendor name",value:Me.name,onChange:M=>je(H=>({...H,name:M})),placeholder:"Vendor name"}),e.jsx(ud,{label:"Status",value:Me.status,onChange:M=>je(H=>({...H,status:M})),options:[{value:"Pending",label:"Pending"},{value:"Approved",label:"Approved"},{value:"Blocked",label:"Blocked"}]}),e.jsx(Nn,{label:"Country",value:Me.country,onChange:M=>je(H=>({...H,country:M})),placeholder:"Country"}),e.jsx(Nn,{label:"City",value:Me.city,onChange:M=>je(H=>({...H,city:M})),placeholder:"City"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Nn,{label:"Categories (comma separated)",value:Me.categories.join(", "),onChange:M=>je(H=>({...H,categories:M.split(",").map(Ae=>Ae.trim())})),placeholder:"Office supplies, Consumables",hint:"Metadata"})}),e.jsx(ym,{label:"Rating (0-5)",value:Me.rating,onChange:M=>je(H=>({...H,rating:Yr(M,0,5)})),hint:"Internal"}),e.jsx(ym,{label:"SLA on-time percent",value:Me.slaOnTimePct,onChange:M=>je(H=>({...H,slaOnTimePct:Yr(M,0,100)})),hint:"Internal"}),e.jsx(ym,{label:"Discount percent",value:Me.negotiatedTerms.discountPct,onChange:M=>je(H=>({...H,negotiatedTerms:{...H.negotiatedTerms,discountPct:Yr(M,0,100)}}))}),e.jsx(ym,{label:"Warranty days",value:Me.negotiatedTerms.warrantyDays,onChange:M=>je(H=>({...H,negotiatedTerms:{...H.negotiatedTerms,warrantyDays:Math.max(0,M)}}))}),e.jsx(Nn,{label:"Payment terms",value:Me.negotiatedTerms.paymentTerms,onChange:M=>je(H=>({...H,negotiatedTerms:{...H.negotiatedTerms,paymentTerms:M}})),placeholder:"Net 14"}),e.jsxs("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Modules"}),e.jsx("div",{className:"mt-2 grid grid-cols-1 gap-2 sm:grid-cols-2",children:t.map(M=>{const H=Me.modules.includes(M);return e.jsxs("button",{type:"button",className:yl("rounded-2xl border px-3 py-3 text-left",H?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),onClick:()=>je(Ae=>({...Ae,modules:H?Ae.modules.filter(oe=>oe!==M):[...Ae.modules,M]})),children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:M}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:H?"Enabled":"Disabled"})]},M)})})]}),e.jsxs("div",{className:yl("md:col-span-2 rounded-3xl border border-slate-200 bg-white p-4",Me.modules.includes("E-Commerce")?"":"opacity-60"),children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Marketplaces"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Only relevant when E-Commerce is enabled."}),e.jsx("div",{className:"mt-2 grid grid-cols-1 gap-2 sm:grid-cols-2",children:s.map(M=>{const H=Me.marketplaces.includes(M),Ae=!Me.modules.includes("E-Commerce");return e.jsxs("button",{type:"button",disabled:Ae,className:yl("rounded-2xl border px-3 py-3 text-left",H?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50",Ae&&"cursor-not-allowed"),onClick:()=>{Ae||je(oe=>({...oe,marketplaces:H?oe.marketplaces.filter(De=>De!==M):[...oe.marketplaces,M]}))},children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:M}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:H?"Enabled":"Disabled"})]},M)})})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Ph,{label:"Notes",value:Me.notes,onChange:M=>je(H=>({...H,notes:M})),placeholder:"Vendor notes",rows:3})})]})}),e.jsx(lb,{open:Ue,title:he.id?"Edit compliance doc":"Add compliance doc",subtitle:"Premium: store and verify licenses, insurance, and other compliance documents.",onClose:()=>Oe(!1),actions:[{label:"Save",onClick:z}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Vt,{variant:"outline",onClick:()=>Oe(!1),children:"Cancel"}),e.jsxs(Vt,{variant:"primary",onClick:z,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(ud,{label:"Type",value:he.type,onChange:M=>Y(H=>({...H,type:M})),options:["Business registration","Tax/VAT","License","Insurance","KYC","Other"].map(M=>({value:M,label:M}))}),e.jsx(ud,{label:"Status",value:he.status,onChange:M=>Y(H=>({...H,status:M})),options:["Pending","Verified","Expired"].map(M=>({value:M,label:M}))}),e.jsx(Nn,{label:"Document name",value:he.name,onChange:M=>Y(H=>({...H,name:M})),placeholder:"Insurance certificate"}),e.jsx(Nn,{label:"Issued date",value:he.issuedAt?new Date(he.issuedAt).toISOString().slice(0,10):"",onChange:M=>Y(H=>({...H,issuedAt:new Date(M).getTime()})),type:"date"}),e.jsx(Nn,{label:"Expiry date",value:he.expiresAt?new Date(he.expiresAt).toISOString().slice(0,10):"",onChange:M=>Y(H=>({...H,expiresAt:new Date(M).getTime()})),type:"date"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Ph,{label:"Notes",value:he.notes,onChange:M=>Y(H=>({...H,notes:M})),placeholder:"Verification notes",rows:3})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Upload is simulated here. In production this stores file metadata and secure URLs."})]})}),e.jsx(lb,{open:Ie,title:me.id?"Edit contract":"Add contract",subtitle:"Premium: contract + rate card storage and negotiated pricing.",onClose:()=>ce(!1),actions:[{label:"Save",onClick:xe}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Vt,{variant:"outline",onClick:()=>ce(!1),children:"Cancel"}),e.jsxs(Vt,{variant:"primary",onClick:xe,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Nn,{label:"Title",value:me.title,onChange:M=>pe(H=>({...H,title:M})),placeholder:"Master services agreement"}),e.jsx(Nn,{label:"Rate card name",value:me.rateCardName,onChange:M=>pe(H=>({...H,rateCardName:M})),placeholder:"Rate card.pdf"}),e.jsx(Nn,{label:"Start date",type:"date",value:new Date(me.startAt).toISOString().slice(0,10),onChange:M=>pe(H=>({...H,startAt:new Date(M).getTime()}))}),e.jsx(Nn,{label:"End date",type:"date",value:new Date(me.endAt).toISOString().slice(0,10),onChange:M=>pe(H=>({...H,endAt:new Date(M).getTime()}))}),e.jsx(Nn,{label:"Payment terms",value:me.paymentTerms,onChange:M=>pe(H=>({...H,paymentTerms:M})),placeholder:"Net 14"}),e.jsx(ym,{label:"Discount percent",value:me.discountPct,onChange:M=>pe(H=>({...H,discountPct:Yr(M,0,100)}))}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Ph,{label:"SLA text",value:me.slaText,onChange:M=>pe(H=>({...H,slaText:M})),placeholder:"On-time 92%+, response < 2h",rows:3})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Ph,{label:"Notes",value:me.notes,onChange:M=>pe(H=>({...H,notes:M})),placeholder:"Optional",rows:3})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Rate card upload is simulated. In production you store files with access control."})]})})]})}const gx={green:"#03CD8C",orange:"#F77F00"};function Ta(...t){return t.filter(Boolean).join(" ")}function Pa(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function U_(t){return new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"2-digit"})}function md(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function K4(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function ln(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function Cc(t,s){const a=Math.round(Number(t||0));try{return new Intl.NumberFormat(void 0,{style:"currency",currency:s,maximumFractionDigits:0}).format(a)}catch{return`${s} ${a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}}function Rt({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Ta("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function _t({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:gx.green}:t==="accent"?{background:gx.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Ta(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function qn({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:Ta(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:Ta("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function wm({label:t,value:s,onChange:a,hint:l,disabled:n}){return e.jsxs("div",{className:Ta(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",value:s,onChange:r=>a(Number(r.target.value||0)),disabled:n,className:Ta("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function xd({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:Ta(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:Ta("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function km({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4,disabled:i}){return e.jsxs("div",{className:Ta(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:o=>a(o.target.value),placeholder:l,rows:r,disabled:i,className:Ta("mt-2 w-full rounded-2xl border p-3 text-sm font-semibold shadow-sm outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function il({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function Sc({title:t,subtitle:s}){return e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(wt,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:s})]})}function V_({actions:t}){const[s,a]=Xt.useState(!1),l=Xt.useRef(null);return Xt.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:Ta("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function Oh({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="980px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:12,scale:.985},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:12,scale:.985},transition:{duration:.18},className:"fixed inset-x-0 top-[7vh] z-50 mx-auto w-[min(1020px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(V_,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[72vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function __({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(480px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Ta("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function B_(){return["Delivery inspection completed","Warranty documents received","Commissioning completed","Training provided","Acceptance signed"].map(s=>({id:Pa("CHK"),label:s,done:!1}))}function G_(){return`ASSET-${Math.floor(1e3+Math.random()*9e3)}`}function rb(t,s,a,l){const n={Manager:"Manager",Finance:"Finance Desk",CFO:"CFO",CEO:"CEO","EVzone Support":"EVzone Support"};let r=t.steps.slice();if(t.appliesTo==="Any"&&l>=15e6&&!r.some(i=>i.role==="CFO")&&(r=[...r,{role:"CFO",slaHours:24}]),a==="CapEx"){const i=r.some(c=>c.role==="CFO"),o=r.some(c=>c.role==="CEO");i||(r=[...r,{role:"CFO",slaHours:24}]),o||(r=[...r,{role:"CEO",slaHours:24}])}return r.map(i=>({id:Pa("APR"),role:i.role,assignee:n[i.role]||i.role,status:"Pending",slaHours:i.slaHours,requestedAt:s}))}function q_(){var A,f,B;const t=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],s=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],[a,l]=d.useState([]),n=p=>{const E=Pa("toast");l(se=>[{id:E,...p},...se].slice(0,4)),window.setTimeout(()=>l(se=>se.filter(y=>y.id!==E)),3200)},[r,i]=d.useState(()=>[{id:"TPL-OPEX",name:"Standard OpEx",appliesTo:"OpEx",minAmountUGX:0,description:"Manager then Finance approval. Suitable for routine procurement.",steps:[{role:"Manager",slaHours:8},{role:"Finance",slaHours:12}]},{id:"TPL-CAPEX",name:"Executive CapEx",appliesTo:"CapEx",minAmountUGX:0,description:"Manager then CFO then CEO. For high value assets and CapEx.",steps:[{role:"Manager",slaHours:8},{role:"CFO",slaHours:24},{role:"CEO",slaHours:24}]},{id:"TPL-HIGH",name:"High Value OpEx",appliesTo:"Any",minAmountUGX:1e7,description:"Manager and Finance. CFO added automatically when estimate is high.",steps:[{role:"Manager",slaHours:8},{role:"Finance",slaHours:12}]}]),[o]=d.useState(()=>[{id:"V-001",name:"EVzone Rides",country:"Uganda",rating:4.6,status:"Approved",riskLevel:"Low",riskScore:88,categories:["Mobility","Corporate transport"],modules:["Rides & Logistics"],marketplaces:[],negotiatedDiscountPct:7,slaOnTimePct:93},{id:"V-002",name:"EVzone Charging",country:"Uganda",rating:4.3,status:"Approved",riskLevel:"Low",riskScore:83,categories:["Energy","EV infrastructure"],modules:["EVs & Charging"],marketplaces:[],negotiatedDiscountPct:5,slaOnTimePct:90},{id:"V-010",name:"Shenzhen EV Motors",country:"China",rating:4.2,status:"Approved",riskLevel:"Medium",riskScore:74,categories:["Vehicles","Fleet"],modules:["E-Commerce"],marketplaces:["MyLiveDealz","EVmart"],negotiatedDiscountPct:10,slaOnTimePct:84},{id:"V-011",name:"Kampala Auto Supplier",country:"Uganda",rating:4,status:"Approved",riskLevel:"Medium",riskScore:70,categories:["Vehicles","Service"],modules:["E-Commerce"],marketplaces:["EVmart","ServiceMart"],negotiatedDiscountPct:4,slaOnTimePct:86},{id:"V-020",name:"Express CN",country:"China",rating:2.9,status:"Blocked",riskLevel:"High",riskScore:34,categories:["Logistics"],modules:["E-Commerce"],marketplaces:["ExpressMart"],negotiatedDiscountPct:0,slaOnTimePct:62}]),[c]=d.useState(()=>({opExMonthlyLimitUGX:12e6,opExMonthlyUsedUGX:98e5,capExAnnualLimitUGX:15e7,capExAnnualUsedUGX:42e6})),x=Math.max(0,c.opExMonthlyLimitUGX-c.opExMonthlyUsedUGX),j=Math.max(0,c.capExAnnualLimitUGX-c.capExAnnualUsedUGX),[g,N]=d.useState(()=>{const p=Date.now(),E={id:"RFQ-001",title:"Company vehicle procurement",createdAt:p-6*24*60*60*1e3,createdBy:"Procurement Desk",status:"Sent",fundingType:"CapEx",serviceModule:"E-Commerce",marketplace:"EVmart",category:"Vehicle",specs:"Electric SUV. Minimum 400km range. Right-hand drive. Warranty 5 years.",quantity:1,unit:"Unit",deliveryLocation:"Millennium House, Nsambya Road 472, Kampala",warrantyNeeds:"5 years vehicle, 8 years battery",attachments:[{id:Pa("AT"),name:"Vehicle specs.pdf",note:"Initial specs",uploadedAt:p-6*24*60*60*1e3,uploadedBy:"Procurement Desk"}],estimatedBudgetUGX:9e7,capexJustification:"High value asset cannot fit monthly OpEx. Requires CapEx approval.",approvalTemplateId:"TPL-CAPEX",approvals:rb({appliesTo:"CapEx",steps:[{role:"Manager",slaHours:8},{role:"CFO",slaHours:24},{role:"CEO",slaHours:24}]},p-6*24*60*60*1e3,"CapEx",9e7).map((y,re)=>({...y,status:re<3?"Approved":"Pending",decidedAt:p-5*24*60*60*1e3,decisionNote:"Approved"})),invited:[{vendorId:"V-010",status:"Invited",invitedAt:p-5*24*60*60*1e3,lastSeenAt:p-4*24*60*60*1e3},{vendorId:"V-011",status:"Quoted",invitedAt:p-5*24*60*60*1e3,lastSeenAt:p-2*24*60*60*1e3}],qna:[{id:Pa("QNA"),at:p-4*24*60*60*1e3,by:"Buyer",message:"Confirm charging standard and warranty terms.",attachments:[]},{id:Pa("QNA"),at:p-4*24*60*60*1e3+3*60*60*1e3,by:"Vendor",vendorId:"V-011",message:"Supports CCS2. Warranty 5y vehicle and 8y battery.",attachments:[]}],quotes:[{id:"QT-001",rfqId:"RFQ-001",vendorId:"V-011",createdAt:p-2*24*60*60*1e3,status:"Submitted",currency:"UGX",total:88e6,leadTimeDays:30,warrantyMonths:60,paymentTerms:"30% deposit, 60% on delivery, 10% commissioning",notes:"Includes delivery and registration assistance.",attachments:[{id:Pa("AT"),name:"Quote.pdf",note:"Quotation",uploadedAt:p-2*24*60*60*1e3,uploadedBy:"Kampala Auto Supplier"}],lineItems:[{description:"Electric SUV",qty:1,unitPrice:88e6}]}],selectedQuoteId:"QT-001",po:{id:"PO-001",rfqId:"RFQ-001",vendorId:"V-011",createdAt:p-1*24*60*60*1e3,status:"Issued",total:88e6,currency:"UGX",deliverTo:"Millennium House, Nsambya Road 472, Kampala",deliverByDays:30,shippingTerms:"DAP Kampala",milestones:[{id:Pa("MS"),name:"Deposit",pct:30,dueInDays:2,status:"Invoiced"},{id:Pa("MS"),name:"Delivery",pct:60,dueInDays:30,status:"Planned"},{id:Pa("MS"),name:"Commissioning",pct:10,dueInDays:40,status:"Planned"}],notes:"Milestone payments required."},assets:[]},se={id:"RFQ-002",title:"Office generator replacement",createdAt:p-3*24*60*60*1e3,createdBy:"Admin",status:"Approval pending",fundingType:"OpEx",serviceModule:"E-Commerce",marketplace:"ServiceMart",category:"Equipment",specs:"Backup generator 50kVA, installation required.",quantity:1,unit:"Unit",deliveryLocation:"Kampala HQ",warrantyNeeds:"Minimum 1 year",attachments:[],estimatedBudgetUGX:18e6,capexJustification:"",approvalTemplateId:"TPL-HIGH",approvals:rb({appliesTo:"Any",steps:[{role:"Manager",slaHours:8},{role:"Finance",slaHours:12}]},p-3*24*60*60*1e3,"OpEx",18e6),invited:[],qna:[],quotes:[],assets:[]};return[E,se]}),[$,T]=d.useState(()=>"RFQ-001"),k=d.useMemo(()=>g.find(p=>p.id===$)||null,[g,$]),[q,L]=d.useState("rfqs"),[R,U]=d.useState("Overview"),[ae,ie]=d.useState(0),[_,W]=d.useState(()=>({title:"",fundingType:"OpEx",serviceModule:"E-Commerce",marketplace:"EVmart",category:"Vehicle",specs:"",quantity:1,unit:"Unit",deliveryLocation:"",warrantyNeeds:"",estimatedBudgetUGX:0,capexJustification:"",approvalTemplateId:"TPL-OPEX",vendorIds:[],attachments:[]})),[J,we]=d.useState(!1),[G,be]=d.useState({name:"",note:""}),[Ge,Me]=d.useState(!1),[je,Ue]=d.useState("Please submit your quotation with lead time and warranty."),[Oe,he]=d.useState(!1),[Y,Ie]=d.useState({vendorId:"",total:0,leadTimeDays:30,warrantyMonths:12,paymentTerms:"Net 14",notes:""}),[ce,me]=d.useState(!1),[pe,de]=d.useState({type:"Vehicle",description:"",serialNo:"",location:"Kampala HQ",assignedTo:""}),[ye,Qe]=d.useState(""),[Fe,ke]=d.useState(""),fe=d.useMemo(()=>{const p=g.filter(re=>re.status!=="Closed").length,E=g.filter(re=>re.status==="Approval pending").length,se=g.reduce((re,ve)=>re+ve.quotes.length,0),y=g.filter(re=>re.fundingType==="CapEx").length;return{active:p,pendingApprovals:E,quotes:se,capex:y}},[g]),Ve=d.useMemo(()=>(_.estimatedBudgetUGX||0)<=x,[_.estimatedBudgetUGX,x]),ne=d.useMemo(()=>{const p=_.estimatedBudgetUGX||0;return p<=0?_.fundingType:p>x?"CapEx":"OpEx"},[_.fundingType,_.estimatedBudgetUGX,x]),Te=(p,E)=>{N(se=>se.map(y=>y.id===p?{...y,...E}:y))},Ee=(p,E)=>{N(se=>se.map(y=>y.id===p?{...y,attachments:[E,...y.attachments]}:y))},Re=p=>n({title:p,message:"Downloaded file.",kind:"success"}),ze=()=>{if(!k)return;const p={rfq:k,exportedAt:new Date().toISOString()},E=new Blob([JSON.stringify(p,null,2)],{type:"application/json"}),se=URL.createObjectURL(E),y=document.createElement("a");y.href=se,y.download=`rfq-${k.id}.json`,y.click(),URL.revokeObjectURL(se),Re("Exported")},qe=()=>{if(!k)return;const p=k.quotes.map(S=>{const w=o.find(h=>h.id===S.vendorId);return{rfqId:k.id,vendor:(w==null?void 0:w.name)||S.vendorId,currency:S.currency,total:S.total,leadTimeDays:S.leadTimeDays,warrantyMonths:S.warrantyMonths,paymentTerms:S.paymentTerms,notes:S.notes}}),E=S=>{const w=String(S??"");return/[",\n]/.test(w)?`"${w.replace(/"/g,'""')}"`:w},se=["rfqId","vendor","currency","total","leadTimeDays","warrantyMonths","paymentTerms","notes"].join(","),y=p.map(S=>[S.rfqId,S.vendor,S.currency,S.total,S.leadTimeDays,S.warrantyMonths,S.paymentTerms,S.notes].map(E).join(",")).join(`
`),re=`${se}
${y}`,ve=new Blob([re],{type:"text/csv"}),P=URL.createObjectURL(ve),X=document.createElement("a");X.href=P,X.download=`rfq-${k.id}-quotes.csv`,X.click(),URL.revokeObjectURL(P),Re("Exported")},He=()=>{if(!k)return;const p=`
      <html>
        <head>
          <title>RFQ ${k.id}</title>
          <style>
            body{font-family: ui-sans-serif, system-ui; padding:24px;}
            .muted{color:#64748b;font-size:12px}
            h2{margin:0}
            table{width:100%; border-collapse:collapse; margin-top:16px}
            th,td{border:1px solid #e2e8f0; padding:10px; font-size:12px}
            th{background:#f8fafc; text-align:left}
          </style>
        </head>
        <body>
          <h2>RFQ ${k.id} - ${k.title}</h2>
          <div class="muted">Status: ${k.status}  Funding: ${k.fundingType}  Created: ${U_(k.createdAt)}</div>
          <div class="muted">Module: ${k.serviceModule}${k.marketplace?`  Marketplace: ${k.marketplace}`:""}</div>
          <div class="muted">Delivery: ${k.deliveryLocation}</div>
          <h3 style="margin-top:16px">Specs</h3>
          <div>${k.specs}</div>
          <h3 style="margin-top:16px">Quotes</h3>
          <table>
            <thead>
              <tr><th>Vendor</th><th>Total</th><th>Lead time</th><th>Warranty</th><th>Terms</th></tr>
            </thead>
            <tbody>
              ${k.quotes.map(se=>{const y=o.find(re=>re.id===se.vendorId);return`<tr><td>${(y==null?void 0:y.name)||se.vendorId}</td><td>${se.currency} ${se.total}</td><td>${se.leadTimeDays} days</td><td>${se.warrantyMonths} months</td><td>${se.paymentTerms}</td></tr>`}).join("")}
            </tbody>
          </table>
          <div class="muted" style="margin-top:16px">Generated by EVzone CorporatePay</div>
        </body>
      </html>
    `,E=window.open("","_blank");if(!E){n({title:"Popup blocked",message:"Allow popups to print/export PDF.",kind:"warn"});return}E.document.open(),E.document.write(p),E.document.close(),E.focus(),E.print(),n({title:"Print ready",message:"Use Print to PDF to save.",kind:"info"})},_e=()=>{if(!_.title.trim()){n({title:"Missing",message:"Add an RFQ title.",kind:"warn"});return}if(!_.deliveryLocation.trim()){n({title:"Missing",message:"Add a delivery location.",kind:"warn"});return}if(!_.specs.trim()){n({title:"Missing",message:"Add specifications.",kind:"warn"});return}if(_.estimatedBudgetUGX<=0){n({title:"Missing",message:"Add an estimated budget.",kind:"warn"});return}const p=Date.now(),E=`RFQ-${String(100+Math.floor(Math.random()*900))}`,se=r.find(X=>X.id===_.approvalTemplateId)||r[0],y=_.fundingType,re=rb(se,p,y,_.estimatedBudgetUGX),ve=(_.vendorIds.length?_.vendorIds:o.filter(X=>X.status==="Approved").slice(0,2).map(X=>X.id)).map(X=>({vendorId:X,status:"Not invited"})),P={id:E,title:_.title.trim(),createdAt:p,createdBy:"You",status:"Approval pending",fundingType:y,serviceModule:_.serviceModule,marketplace:_.serviceModule==="E-Commerce"?_.marketplace:void 0,category:_.category.trim()||"High value asset",specs:_.specs.trim(),quantity:Math.max(1,_.quantity),unit:_.unit.trim()||"Unit",deliveryLocation:_.deliveryLocation.trim(),warrantyNeeds:_.warrantyNeeds.trim(),attachments:_.attachments,estimatedBudgetUGX:_.estimatedBudgetUGX,capexJustification:y==="CapEx"?_.capexJustification.trim():"",approvalTemplateId:se.id,approvals:re,invited:ve,qna:[],quotes:[],assets:[]};N(X=>[P,...X]),T(E),L("rfqs"),U("Approvals"),n({title:"Submitted",message:"RFQ created and sent for approval.",kind:"success"})},le=p=>{const E=Date.now();N(se=>se.map(y=>{if(y.id!==p)return y;const re=y.approvals.findIndex(X=>X.status==="Pending");if(re<0)return y;const ve=y.approvals.slice();ve[re]={...ve[re],status:"Approved",decidedAt:E,decisionNote:"Approved"};const P=ve.every(X=>X.status==="Approved");return{...y,approvals:ve,status:P?"Approved":y.status}})),n({title:"Approved",message:"Approval step approved.",kind:"success"})},z=p=>{const E=Date.now();N(se=>se.map(y=>{if(y.id!==p)return y;const re=y.approvals.findIndex(P=>P.status==="Pending");if(re<0)return y;const ve=y.approvals.slice();return ve[re]={...ve[re],status:"Rejected",decidedAt:E,decisionNote:"Rejected"},{...y,approvals:ve,status:"Draft"}})),n({title:"Rejected",message:"Approval rejected. RFQ moved back to Draft.",kind:"warn"})},Pe=p=>{const E=Date.now();N(se=>se.map(y=>{if(y.id!==p||y.status!=="Approved"&&y.status!=="Sent")return y;const re=y.invited.map(ve=>ve.status==="Not invited"?{...ve,status:"Invited",invitedAt:E,lastSeenAt:E}:ve);return{...y,invited:re,status:"Sent"}})),n({title:"Sent",message:"RFQ sent to invited vendors.",kind:"success"})},Be=(p,E)=>{const se=Date.now();N(y=>y.map(re=>{if(re.id!==p)return re;const ve=re.invited.map(P=>P.vendorId===E?{...P,status:P.status==="Invited"?"Viewed":P.status,lastSeenAt:se}:P);return{...re,invited:ve}})),n({title:"Updated",message:"Vendor marked as viewed.",kind:"info"})},xe=p=>{k&&(Ie({vendorId:p,total:k.estimatedBudgetUGX||0,leadTimeDays:30,warrantyMonths:24,paymentTerms:"30/60/10",notes:""}),he(!0))},Ne=()=>{if(!k)return;if(!Y.vendorId){n({title:"Missing",message:"Select a vendor.",kind:"warn"});return}if(Y.total<=0){n({title:"Missing",message:"Add a quote total.",kind:"warn"});return}const p=Date.now(),E={id:Pa("QT"),rfqId:k.id,vendorId:Y.vendorId,createdAt:p,status:"Submitted",currency:"UGX",total:Y.total,leadTimeDays:Math.max(1,Y.leadTimeDays),warrantyMonths:Math.max(0,Y.warrantyMonths),paymentTerms:Y.paymentTerms.trim()||"Net 14",notes:Y.notes.trim(),attachments:[{id:Pa("AT"),name:"Quote.pdf",note:"Uploaded",uploadedAt:p,uploadedBy:"Vendor"}],lineItems:[{description:k.category||"Item",qty:k.quantity,unitPrice:Y.total/Math.max(1,k.quantity)}]};N(se=>se.map(y=>{if(y.id!==k.id)return y;const re=[E,...y.quotes],ve=y.invited.map(P=>P.vendorId===E.vendorId?{...P,status:"Quoted",lastSeenAt:p}:P);return{...y,quotes:re,invited:ve}})),n({title:"Submitted",message:"Quote added.",kind:"success"}),he(!1),U("Quotes")},M=p=>{k&&(Te(k.id,{selectedQuoteId:p}),n({title:"Selected",message:"Winning quote selected.",kind:"success"}))},H=()=>{if(!k)return;const p=k.quotes.find(y=>y.id===k.selectedQuoteId);if(!p){n({title:"Select quote",message:"Select a winning quote first.",kind:"warn"});return}const E=Date.now(),se={id:Pa("PO"),rfqId:k.id,vendorId:p.vendorId,createdAt:E,status:"Draft",total:p.total,currency:p.currency,deliverTo:k.deliveryLocation,deliverByDays:p.leadTimeDays,shippingTerms:"DAP",milestones:[{id:Pa("MS"),name:"Deposit",pct:30,dueInDays:2,status:"Planned"},{id:Pa("MS"),name:"Delivery",pct:60,dueInDays:p.leadTimeDays,status:"Planned"},{id:Pa("MS"),name:"Commissioning",pct:10,dueInDays:p.leadTimeDays+10,status:"Planned"}],notes:"Milestone payments required."};N(y=>y.map(re=>re.id===k.id?{...re,po:se,status:"Awarded"}:re)),n({title:"Created",message:"Purchase order created.",kind:"success"}),U("PO")},Ae=p=>{k!=null&&k.po&&(N(E=>E.map(se=>se.id===k.id?{...se,po:{...se.po,status:p}}:se)),n({title:"Updated",message:`PO status set to ${p}.`,kind:"info"}))},oe=p=>{k!=null&&k.po&&(N(E=>E.map(se=>{if(se.id!==k.id||!se.po)return se;const y=se.po.milestones.map(re=>re.id===p?{...re,status:re.status==="Paid"?"Planned":"Paid"}:re);return{...se,po:{...se.po,milestones:y}}})),n({title:"Updated",message:"Milestone updated.",kind:"success"}))},De=()=>{if(!(k!=null&&k.po)){n({title:"PO required",message:"Create a PO before adding assets.",kind:"warn"});return}de({type:k.category.toLowerCase().includes("vehicle")?"Vehicle":"Equipment",description:k.title,serialNo:"",location:k.deliveryLocation,assignedTo:""}),me(!0)},$e=()=>{if(!k)return;if(!pe.description.trim()){n({title:"Missing",message:"Asset description is required.",kind:"warn"});return}const p=Date.now(),E={id:Pa("AS"),tag:G_(),type:pe.type,description:pe.description.trim(),serialNo:pe.serialNo.trim(),location:pe.location.trim()||k.deliveryLocation,assignedTo:pe.assignedTo.trim(),createdAt:p,checklist:B_(),attachments:[]};N(se=>se.map(y=>y.id===k.id?{...y,assets:[E,...y.assets]}:y)),n({title:"Created",message:"Asset record created.",kind:"success"}),me(!1),U("Assets")},ge=(p,E)=>{k&&N(se=>se.map(y=>{if(y.id!==k.id)return y;const re=y.assets.map(ve=>{if(ve.id!==p)return ve;const P=ve.checklist.map(X=>X.id===E?{...X,done:!X.done}:X);return{...ve,checklist:P}});return{...y,assets:re}}))},ue=()=>{if(!k)return;if(!ye.trim()){n({title:"Empty",message:"Write a message.",kind:"warn"});return}const p=Date.now(),E={id:Pa("QNA"),at:p,by:Fe?"Vendor":"Buyer",vendorId:Fe||void 0,message:ye.trim(),attachments:[]};N(se=>se.map(y=>y.id===k.id?{...y,qna:[...y.qna,E]}:y)),Qe(""),n({title:"Sent",message:"Message added.",kind:"success"})},Ke=()=>{if(!G.name.trim()){n({title:"Missing",message:"Attachment name required.",kind:"warn"});return}const p=Date.now(),E={id:Pa("AT"),name:G.name.trim(),note:G.note.trim(),uploadedAt:p,uploadedBy:"You"};W(se=>({...se,attachments:[E,...se.attachments]})),be({name:"",note:""}),we(!1),n({title:"Added",message:"Attachment added to draft.",kind:"success"})},b=()=>{if(!k)return;if(!G.name.trim()){n({title:"Missing",message:"Attachment name required.",kind:"warn"});return}const p=Date.now(),E={id:Pa("AT"),name:G.name.trim(),note:G.note.trim(),uploadedAt:p,uploadedBy:"You"};Ee(k.id,E),be({name:"",note:""}),we(!1),n({title:"Added",message:"Attachment added.",kind:"success"})},v=()=>{_.estimatedBudgetUGX>0&&_.estimatedBudgetUGX>x&&(W(p=>({...p,fundingType:"CapEx"})),n({title:"Suggested",message:"Estimate exceeds monthly OpEx. Switched to CapEx.",kind:"info"}))},u=p=>p==="Approved"||p==="Awarded"?"good":p==="Approval pending"?"warn":p==="Sent"?"info":"neutral",C=p=>p==="Quoted"?"good":p==="Invited"||p==="Viewed"?"info":p==="Declined"?"bad":"neutral",Q=p=>p==="Approved"?"good":p==="Rejected"?"bad":"warn",O=d.useMemo(()=>k!=null&&k.quotes.length?k.quotes.slice().sort((p,E)=>p.total-E.total)[0]:null,[k]),ee=d.useMemo(()=>k!=null&&k.selectedQuoteId&&k.quotes.find(p=>p.id===k.selectedQuoteId)||null,[k]),F=d.useMemo(()=>{if(!k||!ee)return null;const p=O;if(!p)return null;const E=ee.total-p.total;return{best:p.total,selected:ee.total,diff:E}},[k,ee,O]);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(__,{toasts:a,onDismiss:p=>l(E=>E.filter(se=>se.id!==p))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:gx.green},children:e.jsx(wt,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"RFQ and Quote Requests (High Value Assets)"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"RFQ creation, approvals, vendor Q and A, quote comparison, PO conversion, milestone payments, and asset handover."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(Rt,{label:`Active RFQs: ${fe.active}`,tone:"neutral"}),e.jsx(Rt,{label:`Approvals pending: ${fe.pendingApprovals}`,tone:fe.pendingApprovals?"warn":"good"}),e.jsx(Rt,{label:`Quotes received: ${fe.quotes}`,tone:fe.quotes?"info":"neutral"}),e.jsx(Rt,{label:`CapEx: ${fe.capex}`,tone:"info"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(_t,{variant:"outline",onClick:()=>L("rfqs"),children:[e.jsx(et,{className:"h-4 w-4"})," RFQs"]}),e.jsxs(_t,{variant:"primary",onClick:()=>{L("create"),ie(0),n({title:"Create",message:"Start RFQ creation.",kind:"info"})},children:[e.jsx(pt,{className:"h-4 w-4"})," New RFQ"]}),e.jsxs(_t,{variant:"outline",onClick:()=>L("templates"),children:[e.jsx(yt,{className:"h-4 w-4"})," Approval templates"]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-4",children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"OpEx remaining"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:ln(x)}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Monthly budget"})]}),e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-slate-50 text-slate-700 ring-1 ring-slate-200",children:e.jsx($a,{className:"h-5 w-5"})})]})}),e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"CapEx remaining"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:ln(j)}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Annual allocation"})]}),e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-blue-50 text-blue-700 ring-1 ring-blue-200",children:e.jsx(Sr,{className:"h-5 w-5"})})]})}),e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Preferred vendors"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:o.filter(p=>p.status==="Approved"&&p.riskLevel!=="High").length}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Allowlisted vendors"})]}),e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-amber-50 text-amber-800 ring-1 ring-amber-200",children:e.jsx(Dl,{className:"h-5 w-5"})})]})}),e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"High value workflow"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:"CapEx and milestones"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Executive approvals"})]}),e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-emerald-50 text-emerald-700 ring-1 ring-emerald-200",children:e.jsx(ct,{className:"h-5 w-5"})})]})})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"rfqs",label:"RFQs"},{id:"create",label:"Create RFQ"},{id:"templates",label:"Approval templates"}].map(p=>e.jsx("button",{className:Ta("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",q===p.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:q===p.id?{background:gx.green}:void 0,onClick:()=>L(p.id),children:p.label},p.id))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[q==="rfqs"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsx(il,{title:"RFQ list",subtitle:"Select an RFQ to manage approvals, vendors, quotes, and conversion.",right:e.jsx(Rt,{label:`${g.length} total`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[g.map(p=>{const E=p.id===$;return e.jsx("button",{type:"button",onClick:()=>{T(p.id),U("Overview")},className:Ta("w-full rounded-3xl border bg-white p-4 text-left hover:bg-slate-50",E?"border-emerald-300 ring-4 ring-emerald-100":"border-slate-200"),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:p.title}),e.jsx(Rt,{label:p.status,tone:u(p.status)}),e.jsx(Rt,{label:p.fundingType,tone:p.fundingType==="CapEx"?"info":"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[p.id,"  Created ",K4(p.createdAt),"  By ",p.createdBy]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[p.serviceModule,p.marketplace?`  ${p.marketplace}`:""]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Estimate"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:ln(p.estimatedBudgetUGX)}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Quotes ",p.quotes.length]})]})]})},p.id)}),g.length?null:e.jsx(Sc,{title:"No RFQs",subtitle:"Create an RFQ to start procurement."})]})}),e.jsx(il,{title:"Quick actions",subtitle:"Common flows.",right:e.jsx(Rt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs(_t,{variant:"primary",onClick:()=>{L("create"),ie(0)},children:[e.jsx(pt,{className:"h-4 w-4"})," New RFQ"]}),e.jsxs(_t,{variant:"outline",onClick:()=>{k&&(U("Approvals"),n({title:"Approvals",message:"Open approvals tab.",kind:"info"}))},disabled:!k,children:[e.jsx(yt,{className:"h-4 w-4"})," Approvals"]}),e.jsxs(_t,{variant:"outline",onClick:()=>U("Quotes"),disabled:!k,children:[e.jsx(Sr,{className:"h-4 w-4"})," Quote comparison"]}),e.jsxs(_t,{variant:"outline",onClick:()=>U("PO"),disabled:!k,children:[e.jsx(wt,{className:"h-4 w-4"})," PO and invoices"]})]})})]}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsx(il,{title:"RFQ details",subtitle:"Manage the selected RFQ.",right:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(_t,{variant:"outline",onClick:ze,disabled:!k,children:[e.jsx(gt,{className:"h-4 w-4"})," Export JSON"]}),e.jsxs(_t,{variant:"outline",onClick:He,disabled:!k,children:[e.jsx(wt,{className:"h-4 w-4"})," Export PDF"]})]}),children:k?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:["Overview","Approvals","Vendors","Quotes","PO","Assets"].map(p=>e.jsx("button",{className:Ta("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",R===p?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:R===p?{background:gx.green}:void 0,onClick:()=>U(p),children:p},p))}),R==="Overview"?e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:k.title}),e.jsx(Rt,{label:k.status,tone:u(k.status)}),e.jsx(Rt,{label:k.fundingType,tone:k.fundingType==="CapEx"?"info":"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[k.id,"  Created ",md(k.createdAt),"  By ",k.createdBy]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(Rt,{label:k.serviceModule,tone:"neutral"}),k.marketplace?e.jsx(Rt,{label:k.marketplace,tone:"neutral"}):null,e.jsx(Rt,{label:`Qty ${k.quantity} ${k.unit}`,tone:"neutral"}),e.jsx(Rt,{label:`Estimate ${ln(k.estimatedBudgetUGX)}`,tone:"info"})]}),e.jsxs("div",{className:"mt-3 text-sm text-slate-700",children:["Delivery: ",e.jsx("span",{className:"font-semibold",children:k.deliveryLocation})]}),k.warrantyNeeds?e.jsxs("div",{className:"mt-1 text-sm text-slate-700",children:["Warranty: ",e.jsx("span",{className:"font-semibold",children:k.warrantyNeeds})]}):null]}),e.jsxs("div",{className:"flex flex-col items-start gap-2 md:items-end",children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Budget check"}),e.jsxs("div",{className:"mt-1",children:["OpEx remaining: ",e.jsx("span",{className:"font-semibold",children:ln(x)})]}),e.jsxs("div",{className:"mt-1",children:["CapEx remaining: ",e.jsx("span",{className:"font-semibold",children:ln(j)})]}),k.fundingType==="OpEx"&&k.estimatedBudgetUGX>x?e.jsx("div",{className:"mt-2 text-rose-700 font-semibold",children:"Does not fit OpEx. Consider CapEx."}):null]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(_t,{variant:"primary",onClick:()=>le(k.id),disabled:k.status!=="Approval pending"||!k.approvals.some(p=>p.status==="Pending"),children:[e.jsx(tt,{className:"h-4 w-4"})," Approve next"]}),e.jsxs(_t,{variant:"outline",onClick:()=>Pe(k.id),disabled:!(k.status==="Approved"||k.status==="Sent"),children:[e.jsx(Xs,{className:"h-4 w-4"})," Send RFQ"]})]})]})]})}),e.jsx(il,{title:"Specifications",subtitle:"What vendors will quote against.",right:e.jsx(Rt,{label:"Core",tone:"neutral"}),children:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-sm text-slate-700 ring-1 ring-slate-200 whitespace-pre-wrap",children:k.specs})}),e.jsx(il,{title:"Attachments",subtitle:"Specs, drawings, or requirements.",right:e.jsxs(_t,{variant:"outline",onClick:()=>{be({name:"",note:""}),we(!0)},children:[e.jsx(dg,{className:"h-4 w-4"})," Add"]}),children:e.jsxs("div",{className:"space-y-2",children:[k.attachments.map(p=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:p.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[md(p.uploadedAt),"  ",p.uploadedBy]}),p.note?e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Note: ",p.note]}):null]}),e.jsx(_t,{variant:"outline",className:"px-3 py-2 text-xs",onClick:async()=>{try{await navigator.clipboard.writeText(p.name),n({title:"Copied",message:"Attachment name copied.",kind:"success"})}catch{n({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},children:e.jsx(ls,{className:"h-4 w-4"})})]})},p.id)),k.attachments.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No attachments."})]})})]}):null,R==="Approvals"?e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs(il,{title:"Approval chain",subtitle:"Required approvals before sending RFQ.",right:e.jsx(Rt,{label:((A=r.find(p=>p.id===k.approvalTemplateId))==null?void 0:A.name)||k.approvalTemplateId,tone:"info"}),children:[e.jsxs("div",{className:"space-y-2",children:[k.approvals.map((p,E)=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Rt,{label:`Step ${E+1}`,tone:"neutral"}),e.jsx(Rt,{label:p.role,tone:"neutral"}),e.jsx(Rt,{label:p.status,tone:Q(p.status)}),e.jsx(Rt,{label:`SLA ${p.slaHours}h`,tone:"info"})]}),e.jsxs("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:["Assignee: ",p.assignee]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Requested ",md(p.requestedAt)]}),p.decidedAt?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Decided ",md(p.decidedAt),"  ",p.decisionNote||""]}):null]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(_t,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>le(k.id),disabled:p.status!=="Pending"||k.status!=="Approval pending",children:[e.jsx(tt,{className:"h-4 w-4"})," Approve"]}),e.jsxs(_t,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>z(k.id),disabled:p.status!=="Pending"||k.status!=="Approval pending",children:[e.jsx(Ye,{className:"h-4 w-4"})," Reject"]})]})]})},p.id)),k.approvals.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No approvals configured."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: Executive approval chain templates are used for CapEx and very high value purchases."})]}),e.jsx(il,{title:"Send readiness",subtitle:"RFQ can only be sent after approval.",right:e.jsx(Rt,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Checklist"}),e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsx(D,{ok:!!k.specs.trim(),label:"Specs provided"}),e.jsx(D,{ok:!!k.deliveryLocation.trim(),label:"Delivery location"}),e.jsx(D,{ok:k.invited.length>0,label:"Vendors selected"}),e.jsx(D,{ok:k.approvals.every(p=>p.status==="Approved"),label:"Approvals completed"})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Actions"}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Only available once approved."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(_t,{variant:"primary",onClick:()=>Pe(k.id),disabled:!k.approvals.every(p=>p.status==="Approved"),children:[e.jsx(Xs,{className:"h-4 w-4"})," Send RFQ"]}),e.jsxs(_t,{variant:"outline",onClick:()=>U("Vendors"),children:[e.jsx(Us,{className:"h-4 w-4"})," Vendors"]})]}),k.fundingType==="CapEx"?e.jsx("div",{className:"mt-3 rounded-2xl bg-blue-50 p-3 text-xs text-blue-700 ring-1 ring-blue-200",children:"CapEx: milestone payments and asset handover will be enabled after quote award."}):null]})]})})]}):null,R==="Vendors"?e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsx(il,{title:"Vendor invitations",subtitle:"Invite vendors to quote and track status.",right:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(_t,{variant:"outline",onClick:()=>Me(!0),children:[e.jsx(Xs,{className:"h-4 w-4"})," Invite"]}),e.jsxs(_t,{variant:"outline",onClick:()=>n({title:"Tip",message:"Use vendor allowlist from Vendor Management (R).",kind:"info"}),children:[e.jsx(vn,{className:"h-4 w-4"})," Tip"]})]}),children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Rating"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Risk"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Last seen"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[k.invited.map(p=>{const E=o.find(y=>y.id===p.vendorId),se=(E==null?void 0:E.riskLevel)==="High"?"bad":(E==null?void 0:E.riskLevel)==="Medium"?"warn":"good";return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:(E==null?void 0:E.name)||p.vendorId}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:(E==null?void 0:E.country)||"-"})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Rt,{label:p.status,tone:C(p.status)})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:E?`${E.rating.toFixed(1)} / 5`:"-"}),e.jsx("td",{className:"px-4 py-3",children:E?e.jsx(Rt,{label:`${E.riskLevel} (${E.riskScore})`,tone:se}):e.jsx(Rt,{label:"-",tone:"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:p.lastSeenAt?K4(p.lastSeenAt):"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(_t,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Be(k.id,p.vendorId),disabled:p.status!=="Invited",children:[e.jsx(et,{className:"h-4 w-4"})," Mark viewed"]}),e.jsxs(_t,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>xe(p.vendorId),disabled:p.status==="Declined",children:[e.jsx(pt,{className:"h-4 w-4"})," Add quote"]})]})})]},p.vendorId)}),k.invited.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-10",children:e.jsx(Sc,{title:"No vendors",subtitle:"Invite vendors to start receiving quotes."})})})]})]})})}),e.jsxs(il,{title:"Q and A thread",subtitle:"Clarify requirements with vendors.",right:e.jsx(Rt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"space-y-2",children:[k.qna.map(p=>{const E=p.vendorId?o.find(y=>y.id===p.vendorId):null,se=p.by==="Buyer"?"bg-emerald-50 border-emerald-200":"bg-white border-slate-200";return e.jsx("div",{className:Ta("rounded-3xl border p-4",se),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Rt,{label:p.by,tone:p.by==="Buyer"?"good":"neutral"}),E?e.jsx(Rt,{label:E.name,tone:"info"}):null]}),e.jsx("div",{className:"mt-2 text-sm text-slate-800 whitespace-pre-wrap",children:p.message}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:md(p.at)})]}),e.jsx(ji,{className:"h-5 w-5 text-slate-400"})]})},p.id)}),k.qna.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No messages yet."})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx(xd,{label:"Post as",value:Fe,onChange:ke,options:[{value:"",label:"Buyer"},...k.invited.map(p=>{var E;return{value:p.vendorId,label:((E=o.find(se=>se.id===p.vendorId))==null?void 0:E.name)||p.vendorId}})],hint:"Simulate vendor reply"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(km,{label:"Message",value:ye,onChange:Qe,placeholder:"Ask a question or reply",rows:3})}),e.jsx("div",{className:"md:col-span-3 flex justify-end",children:e.jsxs(_t,{variant:"primary",onClick:ue,children:[e.jsx(tt,{className:"h-4 w-4"})," Send"]})})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: Q and A can require attachments and can be audit logged."})]})]}):null,R==="Quotes"?e.jsx("div",{className:"mt-4 space-y-4",children:e.jsxs(il,{title:"Quote comparison",subtitle:"Compare vendor quotes and select a winner.",right:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(_t,{variant:"outline",onClick:qe,children:[e.jsx(gt,{className:"h-4 w-4"})," Export CSV"]}),e.jsxs(_t,{variant:"primary",onClick:H,children:[e.jsx(wt,{className:"h-4 w-4"})," Convert to PO"]})]}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Total"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Lead time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Warranty"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Terms"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Select"})]})}),e.jsxs("tbody",{children:[k.quotes.slice().sort((p,E)=>p.total-E.total).map(p=>{const E=o.find(re=>re.id===p.vendorId),se=k.selectedQuoteId===p.id,y=(O==null?void 0:O.id)===p.id;return e.jsxs("tr",{className:Ta("border-t border-slate-100 hover:bg-slate-50/60",se&&"bg-emerald-50/40"),children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:(E==null?void 0:E.name)||p.vendorId}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[p.id,y?"  Best":""]})]}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Cc(p.total,p.currency)}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[p.leadTimeDays," days"]}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[p.warrantyMonths," months"]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:p.paymentTerms}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Rt,{label:p.status,tone:"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(_t,{variant:se?"primary":"outline",className:"px-3 py-2 text-xs",onClick:()=>M(p.id),children:[e.jsx(tt,{className:"h-4 w-4"})," ",se?"Selected":"Select"]})})]},p.id)}),k.quotes.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10",children:e.jsx(Sc,{title:"No quotes",subtitle:"Invite vendors and add quotes."})})})]})]})}),F?e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Savings analysis"}),e.jsxs("div",{className:"mt-1",children:["Best quote: ",e.jsx("span",{className:"font-semibold",children:Cc(F.best,"UGX")})]}),e.jsxs("div",{className:"mt-1",children:["Selected: ",e.jsx("span",{className:"font-semibold",children:Cc(F.selected,"UGX")})]}),e.jsxs("div",{className:"mt-1",children:["Difference: ",e.jsx("span",{className:Ta("font-semibold",F.diff<=0?"text-emerald-700":"text-rose-700"),children:Cc(F.diff,"UGX")})]})]}):null,e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: quote comparison can include compliance and contract checks and can recommend preferred vendors."})]})}):null,R==="PO"?e.jsx("div",{className:"mt-4 space-y-4",children:e.jsx(il,{title:"Purchase order",subtitle:"Convert quote to PO then track milestone payments and invoices.",right:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(_t,{variant:"outline",onClick:H,children:[e.jsx(pt,{className:"h-4 w-4"})," Create PO"]}),e.jsxs(_t,{variant:"outline",onClick:()=>n({title:"Invoices",message:"In production, each milestone generates an invoice.",kind:"info"}),children:[e.jsx(wt,{className:"h-4 w-4"})," Invoice schedule"]})]}),children:k.po?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:k.po.id}),e.jsx(Rt,{label:k.po.status,tone:k.po.status==="Accepted"?"good":k.po.status==="Issued"?"info":"neutral"}),ee?e.jsx(Rt,{label:((f=o.find(p=>p.id===ee.vendorId))==null?void 0:f.name)||ee.vendorId,tone:"neutral"}):null]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",md(k.po.createdAt),"  Deliver by ",k.po.deliverByDays," day(s)"]}),e.jsxs("div",{className:"mt-2 text-sm text-slate-700",children:["Deliver to: ",e.jsx("span",{className:"font-semibold",children:k.po.deliverTo})]}),e.jsxs("div",{className:"mt-1 text-sm text-slate-700",children:["Shipping: ",e.jsx("span",{className:"font-semibold",children:k.po.shippingTerms})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Total"}),e.jsx("div",{className:"mt-1 text-lg font-semibold text-slate-900",children:Cc(k.po.total,k.po.currency)}),e.jsxs("div",{className:"mt-2 flex flex-wrap justify-end gap-2",children:[e.jsxs(_t,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Ae("Issued"),children:[e.jsx(Xs,{className:"h-4 w-4"})," Issue"]}),e.jsxs(_t,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Ae("Accepted"),children:[e.jsx(ct,{className:"h-4 w-4"})," Accept"]}),e.jsxs(_t,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Ae("Closed"),children:[e.jsx(tt,{className:"h-4 w-4"})," Close"]})]})]})]})}),e.jsxs(il,{title:"Milestone payments",subtitle:"Premium: deposit, delivery, commissioning.",right:e.jsx(Rt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Milestone"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Percent"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Due in"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Action"})]})}),e.jsx("tbody",{children:k.po.milestones.map(p=>{const E=Math.round(k.po.total*p.pct/100),se=p.status==="Paid"?"good":p.status==="Invoiced"?"info":"neutral";return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:p.name}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[p.pct,"%"]}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[p.dueInDays," day(s)"]}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Cc(E,k.po.currency)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Rt,{label:p.status,tone:se})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(_t,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>oe(p.id),children:[e.jsx(sl,{className:"h-4 w-4"})," Toggle paid"]})})]},p.id)})})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"In production, each milestone produces an invoice and reconciles in Transactions."})]})]}):e.jsx(Sc,{title:"No PO",subtitle:"Select a winning quote and convert to a purchase order."})})}):null,R==="Assets"?e.jsx("div",{className:"mt-4 space-y-4",children:e.jsx(il,{title:"Assets and handover",subtitle:"Premium: asset tagging and handover checklist for vehicles and equipment.",right:e.jsxs(_t,{variant:"primary",onClick:De,children:[e.jsx(ly,{className:"h-4 w-4"})," New asset"]}),children:e.jsxs("div",{className:"space-y-3",children:[k.assets.map(p=>{const E=p.checklist.filter(y=>y.done).length,se=p.checklist.length;return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Rt,{label:p.type,tone:"neutral"}),e.jsx(Rt,{label:p.tag,tone:"info"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:p.description})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",md(p.createdAt)]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Serial: ",p.serialNo||"-","  Location: ",p.location]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Assigned to: ",p.assignedTo||"-"]})]}),e.jsx("div",{className:"text-right",children:e.jsx(Rt,{label:`${E}/${se} complete`,tone:E===se?"good":E>0?"warn":"neutral"})})]}),e.jsx("div",{className:"mt-4 grid grid-cols-1 gap-2",children:p.checklist.map(y=>e.jsxs("label",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("span",{className:Ta("text-sm font-semibold",y.done?"text-emerald-700":"text-slate-800"),children:y.label}),e.jsx("input",{type:"checkbox",checked:y.done,onChange:()=>ge(p.id,y.id),className:"h-4 w-4 rounded border-slate-300"})]},y.id))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: handover checklist can require uploads, signatures, and audit trails."})]},p.id)}),k.assets.length?null:e.jsx(Sc,{title:"No assets",subtitle:"Create an asset record after PO award to track tagging and handover."})]})})}):null]}):e.jsx(Sc,{title:"Select an RFQ",subtitle:"Choose an RFQ from the list to view details."})})})]}):null,q==="create"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(il,{title:"Create RFQ",subtitle:"Wizard for high value procurement.",right:e.jsx(Rt,{label:`Step ${ae+1}/5`,tone:"info"}),children:[e.jsx("div",{className:"space-y-2",children:[{i:0,label:"Basics"},{i:1,label:"Specs"},{i:2,label:"Vendors"},{i:3,label:"Budget and approvals"},{i:4,label:"Review"}].map(p=>e.jsx("button",{type:"button",className:Ta("w-full rounded-3xl border bg-white p-4 text-left hover:bg-slate-50",ae===p.i?"border-emerald-300 ring-4 ring-emerald-100":"border-slate-200"),onClick:()=>ie(p.i),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:p.label}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Configure ",p.label.toLowerCase()]})]}),ae===p.i?e.jsx(et,{className:"h-5 w-5 text-emerald-700"}):null]})},p.i))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: if estimate exceeds OpEx remaining, CapEx is recommended with executive approvals and milestones."})]}),e.jsx(il,{title:"Budget snapshot",subtitle:"Helps decide OpEx vs CapEx.",right:e.jsx(Rt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"OpEx remaining"}),e.jsx("div",{className:"mt-1 text-lg font-semibold text-slate-900",children:ln(x)}),e.jsx("div",{className:"mt-3 text-xs text-slate-500",children:"CapEx remaining"}),e.jsx("div",{className:"mt-1 text-lg font-semibold text-slate-900",children:ln(j)}),_.estimatedBudgetUGX>0?e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Estimate: ",e.jsx("span",{className:"font-semibold",children:ln(_.estimatedBudgetUGX)}),e.jsxs("div",{className:"mt-1",children:["Suggested: ",e.jsx("span",{className:"font-semibold",children:ne})]}),ne==="CapEx"?e.jsx("div",{className:"mt-1 text-rose-700 font-semibold",children:"Does not fit monthly OpEx."}):e.jsx("div",{className:"mt-1 text-emerald-700 font-semibold",children:"Fits monthly OpEx."})]}):null]})})]}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs(il,{title:"RFQ draft",subtitle:"Complete all steps then request approvals.",right:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(_t,{variant:"outline",onClick:()=>{be({name:"",note:""}),we(!0)},children:[e.jsx(dg,{className:"h-4 w-4"})," Attachment"]}),e.jsxs(_t,{variant:"primary",onClick:_e,title:"Creates RFQ and sends for approvals",children:[e.jsx(yt,{className:"h-4 w-4"})," Request approvals"]})]}),children:[ae===0?e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(qn,{label:"Title",value:_.title,onChange:p=>W(E=>({...E,title:p})),placeholder:"Example: Company vehicle procurement"}),e.jsx(xd,{label:"Funding type",value:_.fundingType,onChange:p=>W(E=>({...E,fundingType:p})),options:[{value:"OpEx",label:"OpEx"},{value:"CapEx",label:"CapEx"}],hint:_.estimatedBudgetUGX>0?`Suggested: ${ne}`:""}),e.jsx(xd,{label:"Service module",value:_.serviceModule,onChange:p=>W(E=>({...E,serviceModule:p})),options:t.map(p=>({value:p,label:p}))}),e.jsx(xd,{label:"Marketplace",value:_.marketplace,onChange:p=>W(E=>({...E,marketplace:p})),options:s.map(p=>({value:p,label:p})),disabled:_.serviceModule!=="E-Commerce",hint:_.serviceModule!=="E-Commerce"?"Only for E-Commerce":""}),e.jsx(qn,{label:"Category",value:_.category,onChange:p=>W(E=>({...E,category:p})),placeholder:"Vehicle, equipment, service"}),e.jsx(wm,{label:"Quantity",value:_.quantity,onChange:p=>W(E=>({...E,quantity:Math.max(1,p)}))}),e.jsx(qn,{label:"Unit",value:_.unit,onChange:p=>W(E=>({...E,unit:p})),placeholder:"Unit"}),e.jsx(wm,{label:"Estimated budget (UGX)",value:_.estimatedBudgetUGX,onChange:p=>W(E=>({...E,estimatedBudgetUGX:Math.max(0,p)})),hint:"Used for approvals"}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs(_t,{variant:"outline",onClick:v,children:[e.jsx(vn,{className:"h-4 w-4"})," Apply suggested funding"]})})]}):null,ae===1?e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx(km,{label:"Specifications",value:_.specs,onChange:p=>W(E=>({...E,specs:p})),placeholder:"Detailed requirements",rows:8}),e.jsx(qn,{label:"Delivery location",value:_.deliveryLocation,onChange:p=>W(E=>({...E,deliveryLocation:p})),placeholder:"Address"}),e.jsx(qn,{label:"Warranty needs",value:_.warrantyNeeds,onChange:p=>W(E=>({...E,warrantyNeeds:p})),placeholder:"Warranty requirements"})]}):null,ae===2?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Select vendors"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Only approved vendors are recommended."}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2 md:grid-cols-2",children:o.filter(p=>p.status!=="Blocked").map(p=>{const E=_.vendorIds.includes(p.id);return e.jsx("button",{type:"button",className:Ta("rounded-3xl border p-4 text-left",E?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),onClick:()=>W(se=>({...se,vendorIds:E?se.vendorIds.filter(y=>y!==p.id):[...se.vendorIds,p.id]})),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:p.name}),e.jsx(Rt,{label:p.riskLevel,tone:p.riskLevel==="High"?"bad":p.riskLevel==="Medium"?"warn":"good"}),e.jsx(Rt,{label:`${p.rating.toFixed(1)}`,tone:"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[p.country,"  SLA ",p.slaOnTimePct,"%  Discount ",p.negotiatedDiscountPct,"%"]})]}),e.jsx(Rt,{label:E?"Selected":"Select",tone:E?"good":"neutral"})]})},p.id)})})]}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:["Selected vendors: ",_.vendorIds.length?_.vendorIds.map(p=>{var E;return((E=o.find(se=>se.id===p))==null?void 0:E.name)||p}).join(", "):"None"]})]}):null,ae===3?e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(xd,{label:"Approval template",value:_.approvalTemplateId,onChange:p=>W(E=>({...E,approvalTemplateId:p})),options:r.filter(p=>p.appliesTo==="Any"||p.appliesTo===_.fundingType).map(p=>({value:p.id,label:`${p.name} (min ${ln(p.minAmountUGX)})`})),hint:"Executive chain for CapEx"}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Budget mode"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"OpEx uses monthly cap. CapEx uses annual allocation."}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[e.jsx(Rt,{label:`OpEx remaining ${ln(x)}`,tone:x?"neutral":"warn"}),e.jsx(Rt,{label:`CapEx remaining ${ln(j)}`,tone:j?"neutral":"warn"})]}),_.estimatedBudgetUGX>0&&!Ve?e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"This estimate does not fit monthly OpEx. Use CapEx with executive approvals."}):null]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(km,{label:"CapEx justification",value:_.capexJustification,onChange:p=>W(E=>({...E,capexJustification:p})),placeholder:"Required for CapEx",rows:4,disabled:_.fundingType!=="CapEx",hint:_.fundingType==="CapEx"?"Explain why monthly budget cannot cover":"Not required"})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: CapEx vs OpEx budgeting supports assets that cannot fit monthly budgets."})]}):null,ae===4?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Review"}),e.jsxs("div",{className:"mt-2 grid grid-cols-1 gap-2 md:grid-cols-2",children:[e.jsx(m,{label:"Title",value:_.title||"-"}),e.jsx(m,{label:"Funding",value:_.fundingType}),e.jsx(m,{label:"Service module",value:_.serviceModule}),e.jsx(m,{label:"Marketplace",value:_.serviceModule==="E-Commerce"?_.marketplace:"-"}),e.jsx(m,{label:"Estimate",value:_.estimatedBudgetUGX?ln(_.estimatedBudgetUGX):"-"}),e.jsx(m,{label:"Delivery",value:_.deliveryLocation||"-"}),e.jsx(m,{label:"Quantity",value:`${_.quantity} ${_.unit}`}),e.jsx(m,{label:"Vendors",value:_.vendorIds.length?_.vendorIds.map(p=>{var E;return((E=o.find(se=>se.id===p))==null?void 0:E.name)||p}).join(", "):"Auto pick"}),e.jsx(m,{label:"Template",value:((B=r.find(p=>p.id===_.approvalTemplateId))==null?void 0:B.name)||_.approvalTemplateId}),e.jsx(m,{label:"Attachments",value:`${_.attachments.length}`})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200 whitespace-pre-wrap",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Specs"}),e.jsx("div",{className:"mt-2",children:_.specs||"-"})]})]}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Clicking Request approvals will create the RFQ and start the approval workflow."})]}):null]})})]}):null,q==="templates"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsxs(il,{title:"Templates",subtitle:"Executive approval chain templates.",right:e.jsx(Rt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"space-y-2",children:r.slice().sort((p,E)=>p.minAmountUGX-E.minAmountUGX).map(p=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:p.name}),e.jsx(Rt,{label:p.appliesTo,tone:p.appliesTo==="CapEx"?"info":"neutral"}),e.jsx(Rt,{label:`Min ${ln(p.minAmountUGX)}`,tone:"neutral"})]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:p.id}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:p.description}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:p.steps.map((E,se)=>e.jsx(Rt,{label:`${se+1}. ${E.role} (${E.slaHours}h)`,tone:"neutral"},`${p.id}-${se}`))})]}),e.jsxs(_t,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{const E={...p,id:Pa("TPL"),name:`${p.name} Copy`};i(se=>[E,...se]),n({title:"Duplicated",message:"Template duplicated.",kind:"success"})},children:[e.jsx(ls,{className:"h-4 w-4"})," Duplicate"]})]})},p.id))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: chain templates can vary by module, marketplace, vendor risk, and funding type."})]})}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs(il,{title:"Template guidance",subtitle:"How to choose templates.",right:e.jsx(Rt,{label:"Info",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"1) OpEx uses Manager then Finance for routine purchases."}),e.jsx("li",{children:"2) CapEx uses Manager then CFO then CEO for high value assets."}),e.jsx("li",{children:"3) High value OpEx can add CFO automatically when estimate is above threshold."}),e.jsx("li",{children:"4) Vendor risk score can require extra approvals."})]})}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Next suggested additions"}),e.jsxs("ul",{className:"mt-2 space-y-1",children:[e.jsx("li",{children:" Template per Service Module (Travel, Medical) with stricter SLA"}),e.jsx("li",{children:" Template that includes EVzone Support for regulated categories"}),e.jsx("li",{children:" Escalation if SLA breached"})]})]})]})})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"S RFQ and Quote Requests v2. Core: RFQ flow, vendor invitations and Q and A, quote comparison, convert quote to PO and invoice. Premium: CapEx vs OpEx budgeting, milestone payments, asset tagging and handover checklist, executive approval templates."})})]})}),e.jsx(Oh,{open:J,title:"Add attachment",subtitle:q==="create"?"Adds attachment to draft.":"Adds attachment to RFQ.",onClose:()=>we(!1),actions:[{label:"Add",onClick:()=>{q==="create"?Ke():b()}}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(_t,{variant:"outline",onClick:()=>we(!1),children:"Cancel"}),e.jsxs(_t,{variant:"primary",onClick:()=>{q==="create"?Ke():b()},children:[e.jsx(ct,{className:"h-4 w-4"})," Add"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(qn,{label:"File name",value:G.name,onChange:p=>be(E=>({...E,name:p})),placeholder:"Specs.pdf"}),e.jsx(qn,{label:"Note",value:G.note,onChange:p=>be(E=>({...E,note:p})),placeholder:"Optional"}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Upload is simulated. In production, files are stored securely with access control."})]})}),e.jsxs(Oh,{open:Ge,title:"Invite vendors",subtitle:"Send RFQ invite with message.",onClose:()=>Me(!1),actions:[{label:"Send",onClick:()=>{k&&(Pe(k.id),Me(!1))}}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(_t,{variant:"outline",onClick:()=>Me(!1),children:"Cancel"}),e.jsxs(_t,{variant:"primary",onClick:()=>{k&&(Pe(k.id),Me(!1))},children:[e.jsx(Xs,{className:"h-4 w-4"})," Send"]})]}),children:[e.jsx(km,{label:"Invite message",value:je,onChange:Ue,rows:4}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"In production, invites are delivered via Email, WhatsApp, WeChat, and SMS, with delivery logs."})]}),e.jsx(Oh,{open:Oe,title:"Add quote",subtitle:"Enter quote details for comparison and award.",onClose:()=>he(!1),actions:[{label:"Save",onClick:Ne}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(_t,{variant:"outline",onClick:()=>he(!1),children:"Cancel"}),e.jsxs(_t,{variant:"primary",onClick:Ne,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(xd,{label:"Vendor",value:Y.vendorId,onChange:p=>Ie(E=>({...E,vendorId:p})),options:((k==null?void 0:k.invited)||[]).map(p=>{var E;return{value:p.vendorId,label:((E=o.find(se=>se.id===p.vendorId))==null?void 0:E.name)||p.vendorId}})}),e.jsx(wm,{label:"Total (UGX)",value:Y.total,onChange:p=>Ie(E=>({...E,total:Math.max(0,p)}))}),e.jsx(wm,{label:"Lead time (days)",value:Y.leadTimeDays,onChange:p=>Ie(E=>({...E,leadTimeDays:Math.max(1,p)}))}),e.jsx(wm,{label:"Warranty (months)",value:Y.warrantyMonths,onChange:p=>Ie(E=>({...E,warrantyMonths:Math.max(0,p)}))}),e.jsx(qn,{label:"Payment terms",value:Y.paymentTerms,onChange:p=>Ie(E=>({...E,paymentTerms:p})),placeholder:"30/60/10 or Net 14"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(km,{label:"Notes",value:Y.notes,onChange:p=>Ie(E=>({...E,notes:p})),rows:4})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: quotes can include compliance checks and rate card links."})]})}),e.jsx(Oh,{open:ce,title:"Create asset record",subtitle:"Asset tagging and handover checklist.",onClose:()=>me(!1),actions:[{label:"Create",onClick:$e}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(_t,{variant:"outline",onClick:()=>me(!1),children:"Cancel"}),e.jsxs(_t,{variant:"primary",onClick:$e,children:[e.jsx(ly,{className:"h-4 w-4"})," Create"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(xd,{label:"Asset type",value:pe.type,onChange:p=>de(E=>({...E,type:p})),options:[{value:"Vehicle",label:"Vehicle"},{value:"Equipment",label:"Equipment"},{value:"Other",label:"Other"}]}),e.jsx(qn,{label:"Serial number",value:pe.serialNo,onChange:p=>de(E=>({...E,serialNo:p})),placeholder:"Optional"}),e.jsx(qn,{label:"Description",value:pe.description,onChange:p=>de(E=>({...E,description:p})),placeholder:"Vehicle or equipment description"}),e.jsx(qn,{label:"Location",value:pe.location,onChange:p=>de(E=>({...E,location:p})),placeholder:"Site"}),e.jsx(qn,{label:"Assigned to",value:pe.assignedTo,onChange:p=>de(E=>({...E,assignedTo:p})),placeholder:"Department or person"}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"After creation, complete the handover checklist and attach warranty documents."})]})})]});function D({ok:p,label:E}){return e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:E}),p?e.jsx(Rt,{label:"Done",tone:"good"}):e.jsx(Rt,{label:"Pending",tone:"warn"})]})}function m({label:p,value:E}){return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:p}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:E})]})}}const fg={green:"#03CD8C",orange:"#F77F00"};function Da(...t){return t.filter(Boolean).join(" ")}function wn(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function ib(t,s,a){return Math.max(s,Math.min(a,t))}function Q4(t){return new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"2-digit"})}function ur(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function z_(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function Y4(t,s){const a=Math.round(Number(t||0));try{return new Intl.NumberFormat(void 0,{style:"currency",currency:s,maximumFractionDigits:0}).format(a)}catch{return`${s} ${a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}}function J4(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function Pt({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Da("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function zt({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:fg.green}:t==="accent"?{background:fg.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Da(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Ac({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:Da("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:Da("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function Z4({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:Da(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:Da("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function ob({label:t,value:s,onChange:a,hint:l,disabled:n}){return e.jsxs("div",{className:Da(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",value:s,onChange:r=>a(Number(r.target.value||0)),disabled:n,className:Da("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function Lr({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:Da(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:Da("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function db({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4,disabled:i}){return e.jsxs("div",{className:Da(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:o=>a(o.target.value),placeholder:l,rows:r,disabled:i,className:Da("mt-2 w-full rounded-2xl border p-3 text-sm font-semibold shadow-sm outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function HE({actions:t}){const[s,a]=Xt.useState(!1),l=Xt.useRef(null);return Xt.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:Da("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function cb({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="980px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:12,scale:.985},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:12,scale:.985},transition:{duration:.18},className:"fixed inset-x-0 top-[7vh] z-50 mx-auto w-[min(1020px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(HE,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[72vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function W_({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,actions:i}){return d.useEffect(()=>{const o=c=>c.key==="Escape"&&n();return t&&window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,x:18},animate:{opacity:1,x:0},exit:{opacity:0,x:18},transition:{duration:.18},className:Da("fixed z-50 overflow-hidden border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]","left-2 right-2 bottom-2 top-[10vh] rounded-[28px]","lg:left-auto lg:right-4 lg:top-4 lg:bottom-4 lg:w-[760px]"),role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-base font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i&&e.jsx(HE,{actions:i}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"h-full min-h-0 overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function H_({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(480px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Da("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function Ml({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function Ec({title:t,subtitle:s}){return e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(wt,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:s})]})}function ub(t){return t==="Completed"?"good":t==="In progress"||t==="Confirmed"?"info":t==="Cancelled"||t==="Refunded"?"bad":t==="Rebooked"?"warn":"neutral"}function eC(t){return t==="Critical"?"bad":t==="Warning"?"warn":"info"}function X_(t){return t==="Resolved"?"good":t==="In review"?"info":"warn"}function lo(t,s){if(t.status==="Cancelled"||t.status==="Refunded")return{breached:!1,overdueDays:0,lateDays:0};if(t.completedAt){const l=Math.max(0,Math.ceil((t.completedAt-t.dueAt)/864e5));return{breached:l>0,overdueDays:0,lateDays:l}}const a=Math.max(0,Math.ceil((s-t.dueAt)/(24*60*60*1e3)));return{breached:a>0,overdueDays:a,lateDays:0}}function mb(t,s){if(!s||t.currency!=="UGX")return 0;const a=Math.round(t.total*s.penaltyPct/100);return Math.min(a,Math.max(0,s.penaltyCapUGX))}function K_(){var Ke;const t=Date.now(),s=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],a=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],[l,n]=d.useState([]),r=b=>{const v=wn("toast");n(u=>[{id:v,...b},...u].slice(0,4)),window.setTimeout(()=>n(u=>u.filter(C=>C.id!==v)),3200)},[i,o]=d.useState(()=>({autoDisputeOnSlaBreach:!0,autoPenaltyCalc:!0,penaltyApprovalThresholdUGX:5e5,requireApprovalForPenalty:!0})),[c,x]=d.useState(()=>[{id:"V-011",name:"Kampala Auto Supplier",country:"Uganda",status:"Approved",ratingAvg:4.1,ratingCount:28,slaOnTimeTargetPct:90,penaltyPct:2,penaltyCapUGX:25e5,categories:["Vehicles","Fleet"],modules:["E-Commerce"],marketplaces:["EVmart","ServiceMart"]},{id:"V-010",name:"Shenzhen EV Motors",country:"China",status:"Approved",ratingAvg:4.2,ratingCount:41,slaOnTimeTargetPct:85,penaltyPct:1,penaltyCapUGX:3e6,categories:["Vehicles","Imports"],modules:["E-Commerce"],marketplaces:["MyLiveDealz","EVmart"]},{id:"V-001",name:"EVzone Rides",country:"Uganda",status:"Approved",ratingAvg:4.6,ratingCount:290,slaOnTimeTargetPct:95,penaltyPct:1,penaltyCapUGX:8e5,categories:["Mobility"],modules:["Rides & Logistics"],marketplaces:[]},{id:"V-002",name:"EVzone Charging",country:"Uganda",status:"Approved",ratingAvg:4.3,ratingCount:120,slaOnTimeTargetPct:92,penaltyPct:1,penaltyCapUGX:6e5,categories:["Energy"],modules:["EVs & Charging"],marketplaces:[]},{id:"V-020",name:"Express CN",country:"China",status:"Blocked",ratingAvg:2.9,ratingCount:15,slaOnTimeTargetPct:80,penaltyPct:2,penaltyCapUGX:15e5,categories:["Logistics"],modules:["E-Commerce"],marketplaces:["ExpressMart"]}]),j=d.useMemo(()=>Object.fromEntries(c.map(b=>[b.id,b])),[c]),g=(b,v)=>{const u=b.map(C=>({id:wn("TL"),label:C}));return u[0]={...u[0],at:v,note:"Created"},u},[N,$]=d.useState(()=>{const v=Date.now(),u=v-8*864e5,C=v+24*864e5,Q=v-2*864e5,O=v-1*864e5+2*60*60*1e3,ee=v-12*864e5,F=v-2*864e5,D=v-5*864e5,m=v-2*864e5;return[{id:"FUL-PO-001",ref:"PO-001",type:"Purchase Order",status:"In progress",createdAt:u,dueAt:C,module:"E-Commerce",marketplace:"EVmart",vendorId:"V-011",currency:"UGX",total:88e6,description:"Electric SUV procurement (high value asset)",location:"Millennium House, Nsambya Road 472, Kampala",timeline:g(["PO created","PO issued","Vendor accepted","Deposit paid","In transit","Delivered","Commissioned","Closed"],u),currentStep:4,proofs:[{id:wn("PR"),name:"PO.pdf",type:"Other",note:"Purchase order document",addedAt:u+2*60*60*1e3,addedBy:"Procurement"},{id:wn("PR"),name:"Deposit receipt.jpg",type:"Photo",note:"Deposit paid proof",addedAt:u+4*864e5,addedBy:"Finance"}]},{id:"FUL-RIDE-101",ref:"SCH-RIDE-101",type:"Ride Schedule",status:"Completed",createdAt:Q,scheduledAt:Q+2*60*60*1e3,dueAt:O,completedAt:O-12*60*1e3,module:"Rides & Logistics",vendorId:"V-001",currency:"UGX",total:165e3,description:"Airport pickup schedule for visiting client",location:"Entebbe Airport  Kampala HQ",timeline:g(["Scheduled","Driver assigned","Picked up","Dropped off"],Q),currentStep:3,proofs:[{id:wn("PR"),name:"Trip receipt.pdf",type:"Trip receipt",note:"Receipt and route",addedAt:O,addedBy:"System"}],rating:{stars:5,comment:"On time and professional.",at:O+10*60*1e3}},{id:"FUL-DEL-009",ref:"DEL-009",type:"Delivery",status:"Cancelled",createdAt:ee,dueAt:F,module:"E-Commerce",marketplace:"ExpressMart",vendorId:"V-020",currency:"UGX",total:34e4,description:"Document courier to branch",location:"Kampala HQ  Jinja",timeline:g(["Created","Pickup","In transit","Delivered"],ee),currentStep:1,proofs:[]},{id:"FUL-SVC-044",ref:"SVC-044",type:"Service Booking",status:"Completed",createdAt:D,dueAt:m,completedAt:m-3*60*60*1e3,module:"E-Commerce",marketplace:"ServiceMart",vendorId:"V-011",currency:"UGX",total:54e4,description:"Office maintenance service booking",location:"Kampala HQ",timeline:g(["Booked","Confirmed","In service","Completed"],D),currentStep:3,proofs:[{id:wn("PR"),name:"Completion log.txt",type:"Completion log",note:"Work completed and signed",addedAt:m-2*60*60*1e3,addedBy:"Vendor"},{id:wn("PR"),name:"Signature.png",type:"Signature",note:"Site sign-off",addedAt:m-2*60*60*1e3,addedBy:"Admin"}],rating:{stars:4,comment:"Good work. Arrived slightly earlier.",at:m-30*60*1e3}}]}),[T,k]=d.useState(()=>[{id:"EX-001",createdAt:Date.now()-2*24*60*60*1e3,kind:"Cancellation",status:"Open",severity:"Warning",fulfillmentId:"FUL-DEL-009",title:"Delivery cancelled",detail:"Delivery request was cancelled after pickup delay.",recommendedAction:"Refund or rebook with an approved vendor."}]),[q,L]=d.useState(()=>[]),[R,U]=d.useState("overview"),[ae,ie]=d.useState(""),[_,W]=d.useState("All"),[J,we]=d.useState("All"),[G,be]=d.useState("All"),[Ge,Me]=d.useState("All"),[je,Ue]=d.useState(!1),[Oe,he]=d.useState(!1),[Y,Ie]=d.useState(null),ce=d.useMemo(()=>Y&&N.find(b=>b.id===Y)||null,[Y,N]),me=d.useMemo(()=>ce?j[ce.vendorId]:null,[ce,j]),[pe,de]=d.useState(!1),[ye,Qe]=d.useState(()=>({type:"Purchase Order",module:"E-Commerce",marketplace:"EVmart",vendorId:"V-011",currency:"UGX",total:0,description:"",location:"",dueInDays:7})),[Fe,ke]=d.useState(!1),[fe,Ve]=d.useState({type:"Photo",name:"",note:""}),[ne,Te]=d.useState(!1),[Ee,Re]=d.useState({stars:5,comment:"",acknowledge:!1}),ze=d.useMemo(()=>{const b=N.filter(O=>!["Completed","Cancelled","Refunded"].includes(O.status)).length,v=N.filter(O=>O.completedAt&&Date.now()-O.completedAt<7*24*60*60*1e3).length,u=N.filter(O=>lo(O,t).breached).length,C=T.filter(O=>O.status==="Open").length,Q=q.filter(O=>O.status!=="Resolved").length;return{open:b,completed7d:v,breached:u,openExceptions:C,openDisputes:Q}},[N,T,q,t]),qe=d.useMemo(()=>{const b=ae.trim().toLowerCase();return N.filter(v=>_==="All"?!0:v.type===_).filter(v=>J==="All"?!0:v.status===J).filter(v=>G==="All"?!0:v.module===G).filter(v=>Ge==="All"?!0:v.vendorId===Ge).filter(v=>je?lo(v,t).breached:!0).filter(v=>{if(!b)return!0;const u=j[v.vendorId];return`${v.id} ${v.ref} ${v.type} ${v.status} ${v.module} ${v.marketplace||""} ${(u==null?void 0:u.name)||""} ${v.description} ${v.location}`.toLowerCase().includes(b)}).slice().sort((v,u)=>u.createdAt-v.createdAt)},[N,ae,_,J,G,Ge,je,j,t]),He=d.useMemo(()=>{const b={};for(const v of N){const u=j[v.vendorId];b[v.vendorId]=b[v.vendorId]||{totalCompleted:0,onTime:0,breached:0,penaltiesUGX:0},lo(v,t).breached&&(b[v.vendorId].breached+=1,i.autoPenaltyCalc&&(b[v.vendorId].penaltiesUGX+=mb(v,u))),v.status==="Completed"&&(b[v.vendorId].totalCompleted+=1,(!v.completedAt||v.completedAt<=v.dueAt)&&(b[v.vendorId].onTime+=1))}return c.map(v=>{const u=b[v.id]||{totalCompleted:0,onTime:0,breached:0,penaltiesUGX:0},C=u.totalCompleted?Math.round(u.onTime/u.totalCompleted*100):100;return{vendor:v,...u,onTimePct:C}}).sort((v,u)=>u.penaltiesUGX-v.penaltiesUGX||u.breached-v.breached||v.vendor.name.localeCompare(u.vendor.name))},[N,c,j,i.autoPenaltyCalc,t]),_e=b=>{Ie(b),he(!0)},le=b=>{const v={id:wn("EX"),createdAt:b.createdAt??Date.now(),status:b.status??"Open",...b};return k(u=>[v,...u]),v},z=()=>{let b=0,v=0;for(const u of N){const C=lo(u,t);if(!C.breached)continue;if(!T.some(O=>O.kind==="SLA breach"&&O.fulfillmentId===u.id)){const O=u.completedAt?`Completed ${C.lateDays} day(s) late.`:`Overdue by ${C.overdueDays} day(s).`;le({kind:"SLA breach",severity:"Critical",fulfillmentId:u.id,title:"SLA breach detected",detail:O,recommendedAction:"Review penalty and open a dispute if needed."}),v+=1}i.autoDisputeOnSlaBreach&&(q.some(ee=>ee.fulfillmentId===u.id&&ee.reason.toLowerCase().includes("sla breach"))||(L(ee=>[{id:wn("DSP"),createdAt:Date.now(),fulfillmentId:u.id,status:"Open",reason:"SLA breach auto-trigger",autoTriggered:!0,evidence:[]},...ee]),b+=1))}r({title:"SLA scan completed",message:`Exceptions created: ${v}. Disputes created: ${b}.`,kind:v||b?"success":"info"})},Pe=()=>{const b=qe.map(m=>{const A=j[m.vendorId],f=lo(m,t),B=i.autoPenaltyCalc?mb(m,A):0;return{id:m.id,ref:m.ref,type:m.type,status:m.status,module:m.module,marketplace:m.marketplace||"-",vendor:(A==null?void 0:A.name)||m.vendorId,dueAt:ur(m.dueAt),completedAt:m.completedAt?ur(m.completedAt):"-",currency:m.currency,total:m.total,slaBreach:f.breached?"Yes":"No",penaltyUGX:B,location:m.location}}),v=["id","ref","type","status","module","marketplace","vendor","dueAt","completedAt","currency","total","slaBreach","penaltyUGX","location"],u=m=>{const A=String(m??"");return/[",\n]/.test(A)?`"${A.replace(/"/g,'""')}"`:A},C=v.join(","),Q=b.map(m=>v.map(A=>u(m[A])).join(",")).join(`
`),O=`${C}
${Q}`,ee=new Blob([O],{type:"text/csv"}),F=URL.createObjectURL(ee),D=document.createElement("a");D.href=F,D.download="corporatepay-fulfillment.csv",D.click(),URL.revokeObjectURL(F),r({title:"Exported",message:"Fulfillment CSV downloaded.",kind:"success"})},Be=()=>{const b={items:N,exceptions:T,disputes:q,vendors:c,settings:i,exportedAt:new Date().toISOString()},v=new Blob([JSON.stringify(b,null,2)],{type:"application/json"}),u=URL.createObjectURL(v),C=document.createElement("a");C.href=u,C.download="corporatepay-fulfillment.json",C.click(),URL.revokeObjectURL(u),r({title:"Exported",message:"Fulfillment JSON downloaded.",kind:"success"})},xe=()=>{if(!ye.description.trim()){r({title:"Missing",message:"Add a description.",kind:"warn"});return}if(!ye.location.trim()){r({title:"Missing",message:"Add a location.",kind:"warn"});return}if(!ye.total||ye.total<=0){r({title:"Missing",message:"Add a total amount showing expected cost.",kind:"warn"});return}const b=24*60*60*1e3,v=Date.now(),u=v+ib(ye.dueInDays,0,365)*b,C=ye.type,O=(C==="Purchase Order"?["Created","Confirmed","In progress","Delivered","Completed"]:C==="Service Booking"?["Booked","Confirmed","In service","Completed"]:C==="Delivery"?["Created","Picked up","In transit","Delivered"]:["Scheduled","Driver assigned","Picked up","Dropped off"]).map(F=>({id:wn("TL"),label:F}));O[0]={...O[0],at:v,note:"Created"};const ee={id:wn("FUL"),ref:`${C==="Purchase Order"?"PO":C==="Service Booking"?"SVC":C==="Delivery"?"DEL":"SCH"}-${Math.floor(100+Math.random()*900)}`,type:C,status:"Pending",createdAt:v,dueAt:u,module:ye.module,marketplace:ye.module==="E-Commerce"?ye.marketplace:void 0,vendorId:ye.vendorId,currency:ye.currency,total:Math.round(ye.total),description:ye.description.trim(),location:ye.location.trim(),timeline:O,currentStep:0,proofs:[]};$(F=>[ee,...F]),de(!1),U("items"),r({title:"Created",message:"New request created.",kind:"success"})},Ne=b=>{$(v=>v.map(u=>{if(u.id!==b||u.status==="Cancelled"||u.status==="Refunded")return u;const C=Math.min(u.timeline.length-1,u.currentStep+1),Q=u.timeline.slice();Q[C].at||(Q[C]={...Q[C],at:Date.now()});let O=u.status;C===0?O="Pending":C===u.timeline.length-1?O="Completed":C>=1&&C<=2?O="Confirmed":O="In progress";const ee=O==="Completed"?Date.now():u.completedAt;return{...u,timeline:Q,currentStep:C,status:O,completedAt:ee}})),r({title:"Updated",message:"Status advanced.",kind:"success"})},M=b=>{$(v=>v.map(u=>u.id===b?{...u,status:"Cancelled"}:u)),le({kind:"Cancellation",severity:"Warning",fulfillmentId:b,title:"Cancelled",detail:"Request was cancelled by admin.",recommendedAction:"Rebook if needed."}),r({title:"Cancelled",message:"Item cancelled.",kind:"warn"})},H=b=>{$(v=>v.map(u=>u.id===b?{...u,status:"Refunded"}:u)),le({kind:"Refund",severity:"Warning",fulfillmentId:b,title:"Refund initiated",detail:"Refund recorded (demo).",recommendedAction:"Verify refund settlement in Transactions."}),r({title:"Refunded",message:"Refund recorded.",kind:"info"})},Ae=b=>{$(v=>v.map(u=>u.id===b?{...u,status:"Rebooked"}:u)),le({kind:"Rebooking",severity:"Info",fulfillmentId:b,title:"Rebook requested",detail:"Item rebook requested. Create a new request to replace it.",recommendedAction:"Create a new booking and link reference."}),r({title:"Rebooked",message:"Rebooking logged.",kind:"info"})},oe=()=>{if(!ce)return;if(!fe.name.trim()){r({title:"Missing",message:"Add a proof name.",kind:"warn"});return}const b={id:wn("PR"),name:fe.name.trim(),type:fe.type,note:fe.note.trim(),addedAt:Date.now(),addedBy:"You"};$(v=>v.map(u=>u.id===ce.id?{...u,proofs:[b,...u.proofs]}:u)),ke(!1),r({title:"Added",message:"Proof attached.",kind:"success"})},De=(b,v=!1)=>{if(!ce)return;if(!b.trim()){r({title:"Missing",message:"Add a dispute reason.",kind:"warn"});return}const u={id:wn("DSP"),createdAt:Date.now(),fulfillmentId:ce.id,status:"Open",reason:b.trim(),autoTriggered:v,evidence:[]};L(C=>[u,...C]),r({title:"Dispute opened",message:"Dispute created.",kind:"success"})},$e=()=>{ce&&(Re({stars:5,comment:"",acknowledge:!1}),Te(!0))},ge=()=>{if(!ce)return;if(!Ee.acknowledge){r({title:"Required",message:"Acknowledge that rating is recorded.",kind:"warn"});return}const b=ib(Math.round(Ee.stars),1,5),v=Ee.comment.trim(),u=Date.now();$(C=>C.map(Q=>Q.id===ce.id?{...Q,rating:{stars:b,comment:v,at:u}}:Q)),x(C=>C.map(Q=>{if(Q.id!==ce.vendorId)return Q;const O=Q.ratingCount+1,ee=(Q.ratingAvg*Q.ratingCount+b)/O;return{...Q,ratingAvg:Math.round(ee*10)/10,ratingCount:O}})),Te(!1),r({title:"Thanks",message:"Vendor feedback recorded.",kind:"success"})};return d.useEffect(()=>{Te(!1)},[Y]),e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(H_,{toasts:l,onDismiss:b=>n(v=>v.filter(u=>u.id!==b))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:fg.green},children:e.jsx(wt,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Orders, Service Requests and Fulfillment"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Track POs, bookings, deliveries, and ride schedules with timelines, proofs, exceptions, SLAs, and dispute triggers."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(Pt,{label:`Open: ${ze.open}`,tone:ze.open?"warn":"good"}),e.jsx(Pt,{label:`Completed 7d: ${ze.completed7d}`,tone:"good"}),e.jsx(Pt,{label:`SLA breaches: ${ze.breached}`,tone:ze.breached?"bad":"good"}),e.jsx(Pt,{label:`Exceptions: ${ze.openExceptions}`,tone:ze.openExceptions?"warn":"good"}),e.jsx(Pt,{label:`Disputes: ${ze.openDisputes}`,tone:ze.openDisputes?"warn":"good"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(zt,{variant:"outline",onClick:z,children:[e.jsx(sl,{className:"h-4 w-4"})," SLA scan"]}),e.jsxs(zt,{variant:"outline",onClick:Pe,children:[e.jsx(gt,{className:"h-4 w-4"})," Export CSV"]}),e.jsxs(zt,{variant:"outline",onClick:Be,children:[e.jsx(gt,{className:"h-4 w-4"})," Export JSON"]}),e.jsxs(zt,{variant:"primary",onClick:()=>de(!0),children:[e.jsx(pt,{className:"h-4 w-4"})," New"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"overview",label:"Overview"},{id:"items",label:"All fulfillment"},{id:"exceptions",label:"Exceptions"},{id:"sla",label:"SLA and penalties"},{id:"disputes",label:"Disputes"}].map(b=>e.jsx("button",{className:Da("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",R===b.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:R===b.id?{background:fg.green}:void 0,onClick:()=>U(b.id),children:b.label},b.id))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[R==="overview"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsxs(Ml,{title:"Fulfillment health",subtitle:"Status timelines and proofs for end-to-end operational visibility.",right:e.jsx(Pt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-4",children:[e.jsx(ue,{title:"Open items",value:`${ze.open}`,sub:"Pending, confirmed, in progress",icon:e.jsx(Dn,{className:"h-5 w-5"}),tone:ze.open?"warn":"good"}),e.jsx(ue,{title:"Completed",value:`${ze.completed7d}`,sub:"Last 7 days",icon:e.jsx(tt,{className:"h-5 w-5"}),tone:"good"}),e.jsx(ue,{title:"SLA breaches",value:`${ze.breached}`,sub:"Overdue or late",icon:e.jsx(Mt,{className:"h-5 w-5"}),tone:ze.breached?"bad":"good"}),e.jsx(ue,{title:"Disputes",value:`${ze.openDisputes}`,sub:"Open or in review",icon:e.jsx(yt,{className:"h-5 w-5"}),tone:ze.openDisputes?"warn":"good"})]}),e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Item"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Type"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Due"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"SLA"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Proofs"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Action"})]})}),e.jsxs("tbody",{children:[qe.slice(0,6).map(b=>{const v=j[b.vendorId],u=lo(b,t);return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:b.ref}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[b.module,b.marketplace?`  ${b.marketplace}`:""]})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:b.type}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(v==null?void 0:v.name)||b.vendorId}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Pt,{label:b.status,tone:ub(b.status)})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Q4(b.dueAt)}),e.jsxs("td",{className:"px-4 py-3",children:[u.breached?e.jsx(Pt,{label:"Breached",tone:"bad"}):e.jsx(Pt,{label:"OK",tone:"good"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:u.overdueDays?`${u.overdueDays} day(s) overdue`:u.lateDays?`${u.lateDays} day(s) late`:"On track"})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:b.proofs.length}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(zt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>_e(b.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]})})]},b.id)}),N.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-10",children:e.jsx(Ec,{title:"No fulfillment",subtitle:"Create your first order or booking."})})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: SLA breaches can auto-create disputes and calculate penalties."})]}),e.jsxs(Ml,{title:"Automation settings",subtitle:"Premium controls for dispute triggers and penalty calculations.",right:e.jsx(Pt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(Ac,{enabled:i.autoDisputeOnSlaBreach,onChange:b=>o(v=>({...v,autoDisputeOnSlaBreach:b})),label:"Auto dispute on SLA breach",description:"Creates a dispute record when overdue or late."}),e.jsx(Ac,{enabled:i.autoPenaltyCalc,onChange:b=>o(v=>({...v,autoPenaltyCalc:b})),label:"Auto penalty calculation",description:"Estimates penalty amounts per vendor terms."}),e.jsx(Ac,{enabled:i.requireApprovalForPenalty,onChange:b=>o(v=>({...v,requireApprovalForPenalty:b})),label:"Require approval for penalties",description:"If penalty exceeds threshold, route to approval chain."}),e.jsx("div",{className:Da(!i.requireApprovalForPenalty&&"opacity-60"),children:e.jsx(ob,{label:"Penalty approval threshold",value:i.penaltyApprovalThresholdUGX,onChange:b=>o(v=>({...v,penaltyApprovalThresholdUGX:Math.max(0,b)})),hint:"UGX",disabled:!i.requireApprovalForPenalty})})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(zt,{variant:"primary",onClick:z,children:[e.jsx(sl,{className:"h-4 w-4"})," Run SLA scan"]}),e.jsxs(zt,{variant:"outline",onClick:()=>U("sla"),children:[e.jsx(et,{className:"h-4 w-4"})," View SLA"]}),e.jsxs(zt,{variant:"outline",onClick:()=>U("disputes"),children:[e.jsx(et,{className:"h-4 w-4"})," View disputes"]})]})]})]}),e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(Ml,{title:"Exceptions snapshot",subtitle:"Open issues needing attention.",right:e.jsx(Pt,{label:`${T.filter(b=>b.status==="Open").length}`,tone:T.filter(b=>b.status==="Open").length?"warn":"good"}),children:[e.jsxs("div",{className:"space-y-2",children:[T.filter(b=>b.status==="Open").slice(0,5).map(b=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Pt,{label:b.kind,tone:"neutral"}),e.jsx(Pt,{label:b.severity,tone:eC(b.severity)})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:b.title}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[z_(b.createdAt),"  ",b.fulfillmentId]}),e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:b.detail})]}),e.jsxs(zt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{_e(b.fulfillmentId),U("items")},children:[e.jsx(et,{className:"h-4 w-4"})," Open"]})]})},b.id)),T.filter(b=>b.status==="Open").length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No open exceptions."})]}),e.jsx("div",{className:"mt-3",children:e.jsxs(zt,{variant:"outline",className:"w-full",onClick:()=>U("exceptions"),children:[e.jsx(et,{className:"h-4 w-4"})," Open exceptions"]})})]}),e.jsxs(Ml,{title:"Quality feedback",subtitle:"Premium: vendor rating loop after fulfillment.",right:e.jsx(Pt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"space-y-2",children:c.filter(b=>b.status==="Approved").slice(0,5).map(b=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:b.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Rating ",b.ratingAvg.toFixed(1),"  ",b.ratingCount," reviews"]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(Pt,{label:`SLA target ${b.slaOnTimeTargetPct}%`,tone:"neutral"}),e.jsx(Pt,{label:`Penalty ${b.penaltyPct}%`,tone:"neutral"})]})]}),e.jsx(Dl,{className:"h-5 w-5 text-amber-500"})]})},b.id))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Ratings can be required after completion for specific categories."})]})]})]}):null,R==="items"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(Ml,{title:"Filters",subtitle:"Search and filter all fulfillment.",right:e.jsx(Pt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-2 py-2",children:[e.jsx(ka,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:ae,onChange:b=>ie(b.target.value),placeholder:"ref, vendor, location...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(Lr,{label:"Type",value:_,onChange:b=>W(b),options:[{value:"All",label:"All"},...["Purchase Order","Service Booking","Delivery","Ride Schedule"].map(b=>({value:b,label:b}))]}),e.jsx(Lr,{label:"Status",value:J,onChange:b=>we(b),options:[{value:"All",label:"All"},...["Pending","Confirmed","In progress","Completed","Cancelled","Refunded","Rebooked"].map(b=>({value:b,label:b}))]}),e.jsx(Lr,{label:"Module",value:G,onChange:b=>be(b),options:[{value:"All",label:"All"},...s.map(b=>({value:b,label:b}))]}),e.jsx(Lr,{label:"Vendor",value:Ge,onChange:Me,options:[{value:"All",label:"All"},...c.map(b=>({value:b.id,label:b.name}))]})]}),e.jsx("div",{className:"mt-3",children:e.jsx(Ac,{enabled:je,onChange:Ue,label:"SLA breach only",description:"Overdue or completed late"})}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(zt,{variant:"outline",onClick:()=>{ie(""),W("All"),we("All"),be("All"),Me("All"),Ue(!1),r({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(fn,{className:"h-4 w-4"})," Reset"]}),e.jsxs(zt,{variant:"outline",onClick:Pe,children:[e.jsx(gt,{className:"h-4 w-4"})," CSV"]})]})]}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Proofs are required for delivery and completion confirmation in regulated programs."})]})}),e.jsx("div",{className:"lg:col-span-8",children:e.jsx(Ml,{title:"All fulfillment",subtitle:"Track orders, bookings, deliveries, and ride schedules with proofs and exceptions.",right:e.jsx(Pt,{label:`${qe.length}`,tone:"neutral"}),children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Ref"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Type"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Due"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"SLA"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Proofs"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[qe.map(b=>{const v=j[b.vendorId],u=lo(b,t);return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:b.ref}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[b.module,b.marketplace?`  ${b.marketplace}`:""]})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:b.type}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(v==null?void 0:v.name)||b.vendorId}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Pt,{label:b.status,tone:ub(b.status)})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Q4(b.dueAt)}),e.jsxs("td",{className:"px-4 py-3",children:[u.breached?e.jsx(Pt,{label:"Breached",tone:"bad"}):e.jsx(Pt,{label:"OK",tone:"good"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:u.overdueDays?`${u.overdueDays} overdue`:u.lateDays?`${u.lateDays} late`:""})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:b.proofs.length}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(zt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>_e(b.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]}),e.jsxs(zt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Ne(b.id),disabled:b.status==="Completed"||b.status==="Cancelled"||b.status==="Refunded",title:b.status==="Completed"?"Already completed":"Advance timeline",children:[e.jsx(tt,{className:"h-4 w-4"})," Advance"]})]})})]},b.id)}),qe.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-10",children:e.jsx(Ec,{title:"No results",subtitle:"Try changing your filters."})})})]})]})})})})]}):null,R==="exceptions"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(Ml,{title:"Exceptions",subtitle:"Cancellations, refunds, rebooking, SLA breaches.",right:e.jsx(Pt,{label:"Core",tone:"neutral"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Use this queue to resolve exceptions and keep the audit trail clean."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(zt,{variant:"outline",onClick:z,children:[e.jsx(sl,{className:"h-4 w-4"})," Scan SLA"]}),e.jsxs(zt,{variant:"outline",onClick:()=>U("items"),children:[e.jsx(et,{className:"h-4 w-4"})," Open fulfillment"]})]})]})}),e.jsx("div",{className:"lg:col-span-8",children:e.jsx(Ml,{title:"Exceptions queue",subtitle:"Resolve, refund, rebook, or dispute.",right:e.jsx(Pt,{label:`${T.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[T.map(b=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Pt,{label:b.kind,tone:"neutral"}),e.jsx(Pt,{label:b.severity,tone:eC(b.severity)}),e.jsx(Pt,{label:b.status,tone:b.status==="Resolved"?"good":"warn"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:b.title}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[ur(b.createdAt),"  ",b.fulfillmentId]}),e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:b.detail}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Recommended: ",b.recommendedAction]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(zt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>_e(b.fulfillmentId),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]}),b.status==="Open"?e.jsxs(zt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>{k(v=>v.map(u=>u.id===b.id?{...u,status:"Resolved"}:u)),r({title:"Resolved",message:"Exception resolved.",kind:"success"})},children:[e.jsx(tt,{className:"h-4 w-4"})," Resolve"]}):null]})]})},b.id)),T.length?null:e.jsx(Ec,{title:"No exceptions",subtitle:"Everything is running smoothly."})]})})})]}):null,R==="sla"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(Ml,{title:"SLA and penalties",subtitle:"Premium: vendor SLA tracking and penalties.",right:e.jsx(Pt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Penalty calculations are estimates. In production, you can require approvals and generate credit notes."}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx(Ac,{enabled:i.autoPenaltyCalc,onChange:b=>o(v=>({...v,autoPenaltyCalc:b})),label:"Auto calculate penalties",description:"Uses vendor penalty terms"}),e.jsx(Ac,{enabled:i.autoDisputeOnSlaBreach,onChange:b=>o(v=>({...v,autoDisputeOnSlaBreach:b})),label:"Auto dispute on breach",description:"Creates disputes when breach detected"})]}),e.jsx("div",{className:"mt-3",children:e.jsxs(zt,{variant:"primary",className:"w-full",onClick:z,children:[e.jsx(sl,{className:"h-4 w-4"})," Run SLA scan"]})})]})}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs(Ml,{title:"Vendor SLA tracking",subtitle:"On-time rate, breaches, penalties, and ratings.",right:e.jsx(Pt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Target"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"On-time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Breaches"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Penalty estimate"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Rating"})]})}),e.jsxs("tbody",{children:[He.map(b=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:b.vendor.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[b.vendor.country,"  ",b.vendor.status]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Pt,{label:`${b.vendor.slaOnTimeTargetPct}%`,tone:"neutral"})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx(Pt,{label:`${b.onTimePct}%`,tone:b.onTimePct>=b.vendor.slaOnTimeTargetPct?"good":b.onTimePct>=b.vendor.slaOnTimeTargetPct-5?"warn":"bad"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[b.totalCompleted," completed"]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Pt,{label:`${b.breached}`,tone:b.breached?"warn":"good"})}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:J4(b.penaltiesUGX)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Dl,{className:"h-4 w-4 text-amber-500"}),e.jsx("span",{className:"font-semibold text-slate-900",children:b.vendor.ratingAvg.toFixed(1)}),e.jsxs("span",{className:"text-xs text-slate-500",children:["(",b.vendor.ratingCount,")"]})]})})]},b.vendor.id)),He.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-10",children:e.jsx(Ec,{title:"No vendors",subtitle:"No vendor stats available."})})})]})]})}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: penalties can create credit notes or adjustments in Invoices and Statements."})]})})]}):null,R==="disputes"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(Ml,{title:"Disputes",subtitle:"Auto triggers on SLA breach and manual disputes.",right:e.jsx(Pt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Disputes can be triggered automatically on SLA breach or opened manually with evidence."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(zt,{variant:"outline",onClick:z,children:[e.jsx(sl,{className:"h-4 w-4"})," Scan SLA"]}),e.jsxs(zt,{variant:"outline",onClick:()=>U("items"),children:[e.jsx(et,{className:"h-4 w-4"})," Open fulfillment"]})]})]})}),e.jsx("div",{className:"lg:col-span-8",children:e.jsx(Ml,{title:"Dispute list",subtitle:"Open, review, resolve.",right:e.jsx(Pt,{label:`${q.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[q.map(b=>{const v=N.find(C=>C.id===b.fulfillmentId),u=v?j[v.vendorId]:null;return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Pt,{label:b.status,tone:X_(b.status)}),e.jsx(Pt,{label:b.autoTriggered?"Auto":"Manual",tone:b.autoTriggered?"info":"neutral"}),v?e.jsx(Pt,{label:v.ref,tone:"neutral"}):null]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:b.reason}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",ur(b.createdAt)]}),v?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Vendor: ",(u==null?void 0:u.name)||v.vendorId,"  Type: ",v.type,"  Total: ",Y4(v.total,v.currency)]}):null]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[v?e.jsxs(zt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>_e(v.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open item"]}):null,b.status!=="Resolved"?e.jsxs(zt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>{L(C=>C.map(Q=>Q.id===b.id?{...Q,status:"Resolved"}:Q)),r({title:"Resolved",message:"Dispute resolved.",kind:"success"})},children:[e.jsx(tt,{className:"h-4 w-4"})," Resolve"]}):null]})]})},b.id)}),q.length?null:e.jsx(Ec,{title:"No disputes",subtitle:"Run SLA scan or create a dispute from an item."})]})})})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"T Orders, Service Requests and Fulfillment v2. Core: track POs, bookings, deliveries, and ride schedules with timelines and proofs plus exception handling. Premium: vendor SLA tracking and penalties, quality feedback loop, and automated dispute triggers."})})]})}),e.jsx(cb,{open:pe,title:"Create request",subtitle:"Create a PO, service booking, delivery, or ride schedule for tracking.",onClose:()=>de(!1),actions:[{label:"Create",onClick:xe}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(zt,{variant:"outline",onClick:()=>de(!1),children:"Cancel"}),e.jsxs(zt,{variant:"primary",onClick:xe,children:[e.jsx(ct,{className:"h-4 w-4"})," Create"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Lr,{label:"Type",value:ye.type,onChange:b=>Qe(v=>({...v,type:b})),options:["Purchase Order","Service Booking","Delivery","Ride Schedule"].map(b=>({value:b,label:b}))}),e.jsx(Lr,{label:"Module",value:ye.module,onChange:b=>Qe(v=>({...v,module:b})),options:s.map(b=>({value:b,label:b}))}),e.jsx(Lr,{label:"Marketplace",value:ye.marketplace,onChange:b=>Qe(v=>({...v,marketplace:b})),options:a.map(b=>({value:b,label:b})),disabled:ye.module!=="E-Commerce",hint:ye.module!=="E-Commerce"?"Only for E-Commerce":""}),e.jsx(Lr,{label:"Vendor",value:ye.vendorId,onChange:b=>Qe(v=>({...v,vendorId:b})),options:c.map(b=>({value:b.id,label:`${b.name} (${b.status})`}))}),e.jsx(Lr,{label:"Currency",value:ye.currency,onChange:b=>Qe(v=>({...v,currency:b})),options:["UGX","USD","EUR","CNY"].map(b=>({value:b,label:b}))}),e.jsx(ob,{label:"Total",value:ye.total,onChange:b=>Qe(v=>({...v,total:Math.max(0,b)})),hint:"Expected cost"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Z4,{label:"Location",value:ye.location,onChange:b=>Qe(v=>({...v,location:b})),placeholder:"Delivery or service location"})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(db,{label:"Description",value:ye.description,onChange:b=>Qe(v=>({...v,description:b})),placeholder:"What needs to be delivered or done",rows:4})}),e.jsx(ob,{label:"Due in (days)",value:ye.dueInDays,onChange:b=>Qe(v=>({...v,dueInDays:ib(b,0,365)})),hint:"SLA baseline"}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"For high value items, create RFQ first, then convert to PO. This page focuses on tracking and fulfillment."})]})}),e.jsx(cb,{open:Fe,title:"Add proof",subtitle:"Upload delivery confirmations or completion logs (simulated).",onClose:()=>ke(!1),actions:[{label:"Add",onClick:oe}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(zt,{variant:"outline",onClick:()=>ke(!1),children:"Cancel"}),e.jsxs(zt,{variant:"primary",onClick:oe,children:[e.jsx(ct,{className:"h-4 w-4"})," Add"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Lr,{label:"Proof type",value:fe.type,onChange:b=>Ve(v=>({...v,type:b})),options:["Delivery confirmation","Completion log","Trip receipt","Signature","Photo","Other"].map(b=>({value:b,label:b}))}),e.jsx(Z4,{label:"File name",value:fe.name,onChange:b=>Ve(v=>({...v,name:b})),placeholder:"photo.jpg"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(db,{label:"Note",value:fe.note,onChange:b=>Ve(v=>({...v,note:b})),rows:3,placeholder:"Optional"})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"In production, files are stored securely and referenced by signed URLs."})]})}),e.jsx(cb,{open:ne,title:"Rate vendor",subtitle:"Premium: quality feedback loop after fulfillment.",onClose:()=>Te(!1),actions:[{label:"Submit",onClick:ge}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(zt,{variant:"outline",onClick:()=>Te(!1),children:"Cancel"}),e.jsxs(zt,{variant:"primary",onClick:ge,children:[e.jsx(Dl,{className:"h-4 w-4"})," Submit"]})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Stars"}),e.jsx("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[1,2,3,4,5].map(b=>e.jsxs("button",{type:"button",className:Da("inline-flex items-center gap-2 rounded-2xl border px-4 py-2 text-sm font-semibold",Ee.stars>=b?"border-amber-200 bg-amber-50":"border-slate-200 bg-white hover:bg-slate-50"),onClick:()=>Re(v=>({...v,stars:b})),children:[e.jsx(Dl,{className:Da("h-4 w-4",Ee.stars>=b?"text-amber-500":"text-slate-300")}),b]},b))})]}),e.jsx(db,{label:"Comment",value:Ee.comment,onChange:b=>Re(v=>({...v,comment:b})),placeholder:"Optional feedback",rows:4}),e.jsxs("label",{className:"flex items-start gap-3 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("input",{type:"checkbox",className:"mt-1 h-4 w-4 rounded border-slate-300",checked:Ee.acknowledge,onChange:b=>Re(v=>({...v,acknowledge:b.target.checked}))}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Acknowledge"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"This feedback is stored and can be used to improve vendor performance."})]})]})]})}),e.jsx(W_,{open:Oe,title:ce?`${ce.ref}  ${ce.type}`:"Fulfillment",subtitle:ce?`${ce.module}${ce.marketplace?`  ${ce.marketplace}`:""}  ${((Ke=j[ce.vendorId])==null?void 0:Ke.name)||ce.vendorId}`:"",onClose:()=>he(!1),footer:ce?e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Actions are audit logged in production."}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(zt,{variant:"outline",onClick:()=>{Ve({type:"Photo",name:"",note:""}),ke(!0)},children:[e.jsx(pt,{className:"h-4 w-4"})," Add proof"]}),e.jsxs(zt,{variant:"outline",onClick:()=>{ce&&(De("Manual dispute",!1),U("disputes"))},children:[e.jsx(yt,{className:"h-4 w-4"})," Dispute"]}),e.jsxs(zt,{variant:"primary",onClick:()=>Ne(ce.id),disabled:ce.status==="Completed"||ce.status==="Cancelled"||ce.status==="Refunded",children:[e.jsx(tt,{className:"h-4 w-4"})," Advance"]})]})]}):null,children:ce?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Pt,{label:ce.status,tone:ub(ce.status)}),e.jsx(Pt,{label:ce.currency,tone:"neutral"}),me?e.jsx(Pt,{label:`Vendor SLA ${me.slaOnTimeTargetPct}%`,tone:"neutral"}):null]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:ce.description}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",ur(ce.createdAt),"  Due ",ur(ce.dueAt)]}),e.jsxs("div",{className:"mt-2 text-sm text-slate-700",children:["Location: ",e.jsx("span",{className:"font-semibold",children:ce.location})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Total"}),e.jsx("div",{className:"mt-1 text-lg font-semibold text-slate-900",children:Y4(ce.total,ce.currency)}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Proofs ",ce.proofs.length]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsxs(zt,{variant:"outline",onClick:()=>M(ce.id),disabled:ce.status==="Completed"||ce.status==="Cancelled"||ce.status==="Refunded",children:[e.jsx(Ye,{className:"h-4 w-4"})," Cancel"]}),e.jsxs(zt,{variant:"outline",onClick:()=>H(ce.id),disabled:ce.status==="Refunded",children:[e.jsx($a,{className:"h-4 w-4"})," Refund"]}),e.jsxs(zt,{variant:"outline",onClick:()=>Ae(ce.id),disabled:ce.status==="Rebooked",children:[e.jsx(Dn,{className:"h-4 w-4"})," Rebook"]})]})]}),e.jsx(Ml,{title:"SLA status",subtitle:"Overdue checks and penalty estimate.",right:e.jsx(Pt,{label:"Premium",tone:"info"}),children:(()=>{const b=lo(ce,t),v=i.autoPenaltyCalc?mb(ce,me||void 0):0,u=i.requireApprovalForPenalty&&v>=i.penaltyApprovalThresholdUGX;return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[b.breached?e.jsx(Pt,{label:"Breached",tone:"bad"}):e.jsx(Pt,{label:"OK",tone:"good"}),b.overdueDays?e.jsx(Pt,{label:`${b.overdueDays} day(s) overdue`,tone:"warn"}):null,b.lateDays?e.jsx(Pt,{label:`${b.lateDays} day(s) late`,tone:"warn"}):null]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Due: ",ur(ce.dueAt),ce.completedAt?`  Completed: ${ur(ce.completedAt)}`:""]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Penalty estimate"}),e.jsx("div",{className:"mt-1 text-lg font-semibold text-slate-900",children:J4(v)}),u?e.jsx("div",{className:"mt-1 text-xs font-semibold text-amber-700",children:"Approval required"}):e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"No approval needed"})]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(zt,{variant:"outline",onClick:()=>De("SLA breach dispute",!0),disabled:!b.breached,children:[e.jsx(yt,{className:"h-4 w-4"})," Open dispute"]}),e.jsxs(zt,{variant:"outline",onClick:()=>{r({title:"Penalty",message:"In production, penalties can create credit notes or adjustments.",kind:"info"})},disabled:!b.breached||!i.autoPenaltyCalc,children:[e.jsx(wt,{className:"h-4 w-4"})," Create credit note"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Automated dispute triggers run via SLA scan. You can run the scan from the page header."})]})})()}),e.jsx(Ml,{title:"Status timeline",subtitle:"Timeline plus completion logs.",right:e.jsx(Pt,{label:"Core",tone:"neutral"}),children:e.jsx("div",{className:"space-y-2",children:ce.timeline.map((b,v)=>{const u=v<ce.currentStep,C=v===ce.currentStep;return e.jsx("div",{className:Da("rounded-3xl border p-4",C?"border-emerald-200 bg-emerald-50":"border-slate-200 bg-white"),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Pt,{label:`Step ${v+1}`,tone:"neutral"}),u?e.jsx(Pt,{label:"Done",tone:"good"}):C?e.jsx(Pt,{label:"Current",tone:"info"}):e.jsx(Pt,{label:"Next",tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:b.label}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[b.at?ur(b.at):"Not reached",b.note?`  ${b.note}`:""]})]}),C&&ce.status!=="Completed"&&ce.status!=="Cancelled"&&ce.status!=="Refunded"?e.jsxs(zt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>Ne(ce.id),children:[e.jsx(tt,{className:"h-4 w-4"})," Advance"]}):null]})},b.id)})})}),e.jsx(Ml,{title:"Proofs",subtitle:"Delivery confirmations, completion logs, receipts.",right:e.jsxs(zt,{variant:"outline",onClick:()=>{Ve({type:"Photo",name:"",note:""}),ke(!0)},children:[e.jsx(pt,{className:"h-4 w-4"})," Add"]}),children:e.jsxs("div",{className:"space-y-2",children:[ce.proofs.map(b=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Pt,{label:b.type,tone:"neutral"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:b.name})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Added ",ur(b.addedAt),"  ",b.addedBy]}),b.note?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Note: ",b.note]}):null]}),e.jsx(zt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:async()=>{try{await navigator.clipboard.writeText(b.name),r({title:"Copied",message:"Proof filename copied.",kind:"success"})}catch{r({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},children:e.jsx(ls,{className:"h-4 w-4"})})]})},b.id)),ce.proofs.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No proofs attached."})]})}),e.jsx(Ml,{title:"Vendor feedback",subtitle:"Rate vendor after completion.",right:e.jsx(Pt,{label:"Premium",tone:"info"}),children:ce.status==="Completed"?e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:ce.rating?e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Dl,{className:"h-5 w-5 text-amber-500"}),e.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:[ce.rating.stars," star(s)"]}),e.jsx(Pt,{label:ur(ce.rating.at),tone:"neutral"})]}),ce.rating.comment?e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:ce.rating.comment}):e.jsx("div",{className:"mt-2 text-sm text-slate-600",children:"No comment."})]}),e.jsxs(zt,{variant:"outline",onClick:$e,children:[e.jsx(Dl,{className:"h-4 w-4"})," Update"]})]}):e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"No rating yet"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: ratings can be required for some modules."})]}),e.jsxs(zt,{variant:"primary",onClick:$e,children:[e.jsx(Dl,{className:"h-4 w-4"})," Rate now"]})]})}):e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Rating is available once the item is completed."})})]}):e.jsx(Ec,{title:"No item selected",subtitle:"Select a fulfillment item to view details."})})]});function ue({title:b,value:v,sub:u,icon:C,tone:Q}){const O=Q==="good"?"bg-emerald-50 text-emerald-700":Q==="warn"?"bg-amber-50 text-amber-800":Q==="bad"?"bg-rose-50 text-rose-700":Q==="info"?"bg-blue-50 text-blue-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:b}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:v}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:u})]}),e.jsx("div",{className:Da("grid h-10 w-10 place-items-center rounded-2xl",O),children:C})]})})}}const fx={green:"#03CD8C",orange:"#F77F00"};function ca(...t){return t.filter(Boolean).join(" ")}function Fr(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function Th(t,s,a){return Math.max(s,Math.min(a,t))}function Mc(t){return new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"2-digit"})}function mr(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function xb(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function Q_(t){const s=new Date(t),a=c=>String(c).padStart(2,"0"),l=s.getFullYear(),n=a(s.getMonth()+1),r=a(s.getDate()),i=a(s.getHours()),o=a(s.getMinutes());return`${l}-${n}-${r}T${i}:${o}`}function Y_(t){const s=new Date(t).getTime();return Number.isFinite(s)?s:Date.now()}function dt({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:ca("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Jt({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:fx.green}:t==="accent"?{background:fx.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:ca(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Cm({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:ca("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:ca("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function nn({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:ca(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:ca("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function pb({label:t,value:s,onChange:a,hint:l,disabled:n}){return e.jsxs("div",{className:ca(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",value:s,onChange:r=>a(Number(r.target.value||0)),disabled:n,className:ca("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function zn({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:ca(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:ca("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function tC({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4,disabled:i}){return e.jsxs("div",{className:ca(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:o=>a(o.target.value),placeholder:l,rows:r,disabled:i,className:ca("mt-2 w-full rounded-2xl border p-3 text-sm font-semibold shadow-sm outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function XE({actions:t}){const[s,a]=d.useState(!1),l=Xt.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:ca("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function hb({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="980px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:12,scale:.985},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:12,scale:.985},transition:{duration:.18},className:"fixed inset-x-0 top-[7vh] z-50 mx-auto w-[min(1040px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(XE,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[72vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function J_({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,actions:i}){return d.useEffect(()=>{const o=c=>c.key==="Escape"&&n();return t&&window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,x:18},animate:{opacity:1,x:0},exit:{opacity:0,x:18},transition:{duration:.18},className:ca("fixed z-50 overflow-hidden border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]","left-2 right-2 bottom-2 top-[10vh] rounded-[28px]","lg:left-auto lg:right-4 lg:top-4 lg:bottom-4 lg:w-[760px]"),role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-base font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i&&e.jsx(XE,{actions:i}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"h-full min-h-0 overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function Z_({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(480px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:ca("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function Ga({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function no({title:t,subtitle:s}){return e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(VF,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:s})]})}function gb(t){return t==="Completed"?"good":t==="Confirmed"?"info":t==="Pending approval"?"warn":t==="Cancelled"?"bad":"neutral"}function Sm(t){return t==="Approved"?"good":t==="Rejected"?"bad":"warn"}function Am(t,s="06:00",a="22:00"){const l=new Date(t),n=l.getHours(),r=l.getMinutes(),i=n*60+r,o=j=>{const[g,N]=j.split(":").map($=>Number($));return(g||0)*60+(N||0)},c=o(s),x=o(a);return i<c||i>x}function eB(t){return new Date(t).getHours()}function pd(t){return`${t}-${Math.floor(100+Math.random()*900)}`}function sC(t){const s=t.some(n=>n.includes("VIP")||n.includes("Premium")||n.includes("CapEx")||n.includes("Executive")),a=t.some(n=>n.includes("CEO")),l=[{role:"Manager",slaHours:8},{role:"Finance",slaHours:12}];return s&&!l.some(n=>n.role==="CFO")&&l.push({role:"CFO",slaHours:24}),a&&l.push({role:"CEO",slaHours:24}),l}function tB(){const t=Date.now(),s=["Client meeting","Airport","Office commute","Event","Visitor","Other"],[a,l]=d.useState([]),n=u=>{const C=Fr("toast");l(Q=>[{id:C,...u},...Q].slice(0,4)),window.setTimeout(()=>l(Q=>Q.filter(O=>O.id!==C)),3200)},[r,i]=d.useState(()=>({workStart:"06:00",workEnd:"22:00",requirePurpose:!0,requireProjectTag:!0,requireCostCenter:!0,premiumRequiresApproval:!0,vipPremiumAllowedWithApproval:!0,enforceVisitorHost:!0,peakHourThreshold:6})),[o]=d.useState(()=>[{id:"E-001",name:"Mary N.",group:"Operations",costCenter:"OPS-001",vip:!1,email:"mary@acme.com"},{id:"E-002",name:"John S.",group:"Sales",costCenter:"SALES-TRAVEL",vip:!1,email:"john@acme.com"},{id:"E-003",name:"Irene K.",group:"Operations",costCenter:"OPS-001",vip:!0,email:"irene@acme.com"},{id:"E-004",name:"Daisy O.",group:"Finance",costCenter:"FIN-OPS",vip:!1,email:"daisy@acme.com"},{id:"E-005",name:"Procurement Desk",group:"Procurement",costCenter:"PROC-001",vip:!1}]),[c,x]=d.useState(()=>[{id:"VST-01",name:"Alex Chen",company:"Shenzhen Motors",hostEmployeeId:"E-003",vip:!0,phone:"+86 177 0000 0000"},{id:"VST-02",name:"Sarah Kato",company:"Partner Co",hostEmployeeId:"E-001",vip:!1,phone:"+256 701 222 222"}]),j=d.useMemo(()=>Object.fromEntries(o.map(u=>[u.id,u])),[o]),g=d.useMemo(()=>Object.fromEntries(c.map(u=>[u.id,u])),[c]),[N,$]=d.useState(()=>{const C=t+1728e5+36e6;return[{id:"EVT-001",name:"Investor Roadshow",location:"Kampala Serena",startAt:C,endAt:C+3*60*60*1e3,organizer:"Travel Coordinator",attendees:[{type:"Employee",id:"E-001"},{type:"Employee",id:"E-002"},{type:"Employee",id:"E-003"},{type:"Visitor",id:"VST-01"}],notes:"Bulk bookings required. VIP guest attending."}]}),[T,k]=d.useState(()=>[{id:"RC-001",name:"Office commute - Operations",days:["Mon","Tue","Wed","Thu","Fri"],timeLocal:"07:30",pickup:"Home",dropoff:"Kampala HQ",category:"Standard",purpose:"Office commute",tags:["Commute"],employees:["E-001","E-003"],enabled:!0},{id:"RC-002",name:"Airport run - Sales",days:["Mon","Wed","Fri"],timeLocal:"05:30",pickup:"Kampala HQ",dropoff:"Entebbe Airport",category:"Premium",purpose:"Airport",tags:["Airport"],employees:["E-002"],enabled:!1}]),[q,L]=d.useState(()=>{const Q=t+864e5+324e5,O=t+2*864e5+8*36e5,ee=t+2*864e5+18*36e5;return[{id:"BK-001",ref:pd("TRV"),travelerType:"Visitor",travelerId:"VST-01",bookedBy:"Travel Coordinator",createdAt:t-5*36e5,scheduledAt:Q,pickup:"Entebbe Airport",dropoff:"Kampala HQ",category:"Premium",purpose:"Visitor",tags:["VIP","Airport"],costCenter:"SALES-TRAVEL",projectTag:"Roadshow",module:"Rides & Logistics",status:"Pending approval",vipRequested:!0,policyNotes:["Premium requested","VIP traveler"],proofs:[]},{id:"BK-002",ref:pd("TRV"),travelerType:"Employee",travelerId:"E-001",bookedBy:"Travel Coordinator",createdAt:t-2*36e5,scheduledAt:O,pickup:"Kampala HQ",dropoff:"Kampala Serena",category:"Standard",purpose:"Event",tags:["Event"],costCenter:"OPS-001",projectTag:"Investor Roadshow",module:"Rides & Logistics",status:"Confirmed",eventId:"EVT-001",vipRequested:!1,policyNotes:[],proofs:[]},{id:"BK-003",ref:pd("TRV"),travelerType:"Employee",travelerId:"E-002",bookedBy:"Travel Coordinator",createdAt:t-90*60*1e3,scheduledAt:ee,pickup:"Kampala Serena",dropoff:"Kampala HQ",category:"Standard",purpose:"Event",tags:["Event","Return"],costCenter:"SALES-TRAVEL",projectTag:"Investor Roadshow",module:"Rides & Logistics",status:"Confirmed",eventId:"EVT-001",vipRequested:!1,policyNotes:[],proofs:[]}]}),[R,U]=d.useState(()=>[{id:"VX-001",travelerType:"Employee",travelerId:"E-003",exceptionType:"Premium rides",validFrom:t-3*864e5,validTo:t+30*864e5,status:"Approved",requestedBy:"Org Admin",reason:"Executive travel allowance",approvalId:"APR-EX-001"}]),[ae,ie]=d.useState(()=>{const C=(O,ee)=>{const F=sC(O),D={Manager:"Manager",Finance:"Finance Desk",CFO:"CFO",CEO:"CEO"};return F.map(m=>({id:Fr("AS"),role:m.role,assignee:D[m.role],status:"Pending",requestedAt:ee,slaHours:m.slaHours}))},Q=t-18e6;return[{id:"APR-001",createdAt:Q,createdBy:"Travel Coordinator",status:"Pending",scope:"Booking",scopeId:"BK-001",reason:"VIP airport pickup requires premium category",policyFlags:["VIP traveler","Premium requested"],steps:C(["VIP","Premium"],Q)}]}),[_,W]=d.useState("overview"),[J,we]=d.useState(""),[G,be]=d.useState("All"),[Ge,Me]=d.useState("All"),[je,Ue]=d.useState(!1),[Oe,he]=d.useState(null),Y=d.useMemo(()=>Oe&&q.find(u=>u.id===Oe)||null,[Oe,q]),[Ie,ce]=d.useState(!1),[me,pe]=d.useState(0),[de,ye]=d.useState(()=>({travelerType:"Employee",travelerId:"E-001",bookedBy:"Travel Coordinator",scheduledAt:Q_(t+24*60*60*1e3),pickup:"Kampala HQ",dropoff:"Entebbe Airport",category:"Standard",purpose:"Airport",purposeOther:"",tags:"Airport,Client",costCenter:"OPS-001",projectTag:"Business travel",module:"Rides & Logistics",vipRequested:!1})),[Qe,Fe]=d.useState(!1),[ke,fe]=d.useState(()=>({eventId:"EVT-001",pickup:"Kampala HQ",dropoff:"Kampala Serena",category:"Standard",createReturn:!0,returnPickup:"Kampala Serena",returnDropoff:"Kampala HQ",offsetMinsBeforeStart:30,returnMinsAfterEnd:15,purpose:"Event",tags:"Event",costCenter:"OPS-001",projectTag:"Investor Roadshow"})),[Ve,ne]=d.useState(!1),[Te,Ee]=d.useState(()=>({travelerType:"Employee",travelerId:"E-003",exceptionType:"Premium rides",validDays:30,reason:""})),Re=(u,C)=>{var Q,O;return u==="Employee"?((Q=j[C])==null?void 0:Q.name)||C:((O=g[C])==null?void 0:O.name)||C},ze=(u,C)=>{var Q,O;return u==="Employee"?!!((Q=j[C])!=null&&Q.vip):!!((O=g[C])!=null&&O.vip)},qe=u=>{var Q;const C=g[u];return C?((Q=j[C.hostEmployeeId])==null?void 0:Q.name)||C.hostEmployeeId:"-"},He=d.useMemo(()=>q.filter(u=>u.scheduledAt>t&&u.status!=="Cancelled"),[q,t]),_e=d.useMemo(()=>ae.filter(u=>u.status==="Pending").length,[ae]),le=d.useMemo(()=>N.filter(u=>u.startAt>t).sort((u,C)=>u.startAt-C.startAt),[N,t]),z=d.useMemo(()=>{const u=J.trim().toLowerCase();return q.filter(C=>G==="All"?!0:C.status===G).filter(C=>Ge==="All"?!0:C.travelerType===Ge).filter(C=>u?`${C.ref} ${C.id} ${Re(C.travelerType,C.travelerId)} ${C.pickup} ${C.dropoff} ${C.purpose} ${C.tags.join(" ")} ${C.costCenter} ${C.projectTag}`.toLowerCase().includes(u):!0).slice().sort((C,Q)=>C.scheduledAt-Q.scheduledAt)},[q,J,G,Ge,j,g]),Pe=d.useMemo(()=>{const u=Array.from({length:24},()=>0);for(const C of He)u[eB(C.scheduledAt)]+=1;return u},[He]),Be=d.useMemo(()=>{let u=0,C=-1;return Pe.forEach((Q,O)=>{Q>C&&(C=Q,u=O)}),{hour:u,count:C}},[Pe]),xe=Be.count>=r.peakHourThreshold,Ne=d.useMemo(()=>{const u=q.filter(O=>["Draft","Pending approval","Confirmed"].includes(O.status)).length,C=q.filter(O=>{const ee=new Date(O.scheduledAt),F=new Date(t);return ee.getFullYear()===F.getFullYear()&&ee.getMonth()===F.getMonth()&&ee.getDate()===F.getDate()}).length,Q=ae.filter(O=>O.status==="Pending"&&O.policyFlags.some(ee=>ee.toLowerCase().includes("vip"))).length;return{open:u,dueToday:C,vipPending:Q}},[q,ae,t]),M=d.useMemo(()=>{const u=Y_(de.scheduledAt),C=[],Q=ze(de.travelerType,de.travelerId),O=Am(u,r.workStart,r.workEnd);if(r.requirePurpose&&(!de.purpose||de.purpose==="Other"&&!de.purposeOther.trim())&&C.push("Purpose required"),r.requireProjectTag&&!de.projectTag.trim()&&C.push("Project tag required"),r.requireCostCenter&&!de.costCenter.trim()&&C.push("Cost center required"),de.travelerType==="Visitor"&&r.enforceVisitorHost){const f=g[de.travelerId];f!=null&&f.hostEmployeeId||C.push("Visitor host required")}O&&C.push("After-hours");const ee=R.some(f=>{if(f.status!=="Approved"||f.travelerType!==de.travelerType||f.travelerId!==de.travelerId||f.exceptionType!=="After-hours"&&f.exceptionType!=="Premium rides")return!1;const B=u;return B>=f.validFrom&&B<=f.validTo}),F=de.category==="Premium";F&&r.premiumRequiresApproval&&C.push("Premium requested"),(de.vipRequested||Q)&&C.push("VIP traveler");const D=C.some(f=>["After-hours","Premium requested","VIP traveler"].includes(f))&&!ee,m=C.filter(f=>f.endsWith("required"));return{scheduledAt:u,flags:C,errors:m,needsApproval:D,hasActiveVipException:ee,afterHours:O,premium:F,tVip:Q}},[de,r,R,g,ze]),H=u=>{he(u),Ue(!0)},Ae=u=>{const C=Date.now(),Q=sC(u.flags),O={Manager:"Manager",Finance:"Finance Desk",CFO:"CFO",CEO:"CEO"},ee=Q.map(D=>({id:Fr("AS"),role:D.role,assignee:O[D.role],status:"Pending",requestedAt:C,slaHours:D.slaHours})),F={id:Fr("APR"),createdAt:C,createdBy:u.createdBy,status:"Pending",scope:u.scope,scopeId:u.scopeId,reason:u.reason,policyFlags:u.flags,steps:ee};return ie(D=>[F,...D]),F},oe=()=>{const u=M;if(u.errors.length){n({title:"Fix required fields",message:u.errors.join("  "),kind:"warn"});return}const C=Date.now(),Q=Fr("BK"),O=de.tags.split(",").map(D=>D.trim()).filter(Boolean).slice(0,10),ee=de.purpose==="Other"?de.purposeOther.trim():void 0,F={id:Q,ref:pd("TRV"),travelerType:de.travelerType,travelerId:de.travelerId,bookedBy:de.bookedBy,createdAt:C,scheduledAt:u.scheduledAt,pickup:de.pickup.trim(),dropoff:de.dropoff.trim(),category:de.category,purpose:de.purpose,purposeOther:ee,tags:O,costCenter:de.costCenter.trim(),projectTag:de.projectTag.trim(),module:de.module,status:u.needsApproval?"Pending approval":"Confirmed",vipRequested:de.vipRequested||u.tVip,policyNotes:u.flags.filter(D=>!D.endsWith("required")),proofs:[]};L(D=>[F,...D]),u.needsApproval&&Ae({scope:"Booking",scopeId:F.id,createdBy:de.bookedBy,reason:"Policy exception required for this booking",flags:u.flags.filter(D=>!D.endsWith("required"))}),n({title:"Created",message:u.needsApproval?"Booking created and sent for approval.":"Booking confirmed.",kind:"success"}),ce(!1),pe(0),W("bookings")},De=()=>{const u=N.find(A=>A.id===ke.eventId);if(!u){n({title:"Missing",message:"Select an event.",kind:"warn"});return}const C=u.startAt,Q=u.endAt,O=[],ee=C-ke.offsetMinsBeforeStart*60*1e3,F=Q+ke.returnMinsAfterEnd*60*1e3,D=Date.now();for(const A of u.attendees){Re(A.type,A.id);const f=ze(A.type,A.id),B=[];ke.category==="Premium"&&r.premiumRequiresApproval&&B.push("Premium requested"),f&&B.push("VIP traveler"),Am(ee,r.workStart,r.workEnd)&&B.push("After-hours");const p=B.length>0;if(O.push({id:Fr("BK"),ref:pd("EVT"),travelerType:A.type,travelerId:A.id,bookedBy:"Travel Coordinator",createdAt:D,scheduledAt:ee,pickup:ke.pickup,dropoff:ke.dropoff,category:ke.category,purpose:ke.purpose,tags:ke.tags.split(",").map(E=>E.trim()).filter(Boolean),costCenter:ke.costCenter,projectTag:ke.projectTag,module:"Rides & Logistics",status:p?"Pending approval":"Confirmed",eventId:u.id,vipRequested:f,policyNotes:B,proofs:[]}),ke.createReturn){const E=[];ke.category==="Premium"&&r.premiumRequiresApproval&&E.push("Premium requested"),f&&E.push("VIP traveler"),Am(F,r.workStart,r.workEnd)&&E.push("After-hours");const se=E.length>0;O.push({id:Fr("BK"),ref:pd("EVT"),travelerType:A.type,travelerId:A.id,bookedBy:"Travel Coordinator",createdAt:D,scheduledAt:F,pickup:ke.returnPickup,dropoff:ke.returnDropoff,category:ke.category,purpose:ke.purpose,tags:[...ke.tags.split(",").map(y=>y.trim()).filter(Boolean),"Return"],costCenter:ke.costCenter,projectTag:ke.projectTag,module:"Rides & Logistics",status:se?"Pending approval":"Confirmed",eventId:u.id,vipRequested:f,policyNotes:E,proofs:[]})}}if(L(A=>[...O,...A]),O.some(A=>A.status==="Pending approval")){const A=Array.from(new Set(O.flatMap(f=>f.policyNotes))).filter(Boolean);Ae({scope:"Event",scopeId:u.id,createdBy:"Travel Coordinator",reason:`Bulk event booking requires policy approval (${O.filter(f=>f.status==="Pending approval").length} pending).`,flags:A.length?A:["Bulk booking"]})}n({title:"Bulk created",message:`Created ${O.length} booking(s).`,kind:"success"}),Fe(!1),W("bookings")},$e=u=>{const C=Date.now();ie(Q=>Q.map(O=>{if(O.id!==u)return O;const ee=O.steps.findIndex(A=>A.status==="Pending");if(ee<0)return O;const F=O.steps.slice();F[ee]={...F[ee],status:"Approved",decidedAt:C,note:"Approved"};const m=F.every(A=>A.status==="Approved")?"Approved":"Pending";return{...O,steps:F,status:m}})),ae.find(Q=>Q.id===u),ae.map(Q=>(Q.id===u,Q)),setTimeout(()=>{ie(Q=>{const O=Q.find(ee=>ee.id===u);return!O||O.status!=="Approved"||(O.scope==="Booking"&&L(ee=>ee.map(F=>F.id===O.scopeId?{...F,status:"Confirmed"}:F)),O.scope==="Event"&&L(ee=>ee.map(F=>F.eventId===O.scopeId&&F.status==="Pending approval"?{...F,status:"Confirmed"}:F)),O.scope==="VIP Exception"&&U(ee=>ee.map(F=>F.approvalId===O.id?{...F,status:"Approved"}:F)),n({title:"Approved",message:"Approval progressed.",kind:"success"})),Q})},0)},ge=u=>{const C=Date.now();ie(O=>O.map(ee=>{if(ee.id!==u)return ee;const F=ee.steps.findIndex(m=>m.status==="Pending"),D=ee.steps.slice();return F>=0&&(D[F]={...D[F],status:"Rejected",decidedAt:C,note:"Rejected"}),{...ee,steps:D,status:"Rejected"}}));const Q=ae.find(O=>O.id===u);(Q==null?void 0:Q.scope)==="Booking"&&L(O=>O.map(ee=>ee.id===Q.scopeId?{...ee,status:"Cancelled",policyNotes:[...ee.policyNotes,"Rejected"]}:ee)),n({title:"Rejected",message:"Approval rejected.",kind:"warn"})},ue=()=>{if(!Te.reason.trim()){n({title:"Missing",message:"Add a reason.",kind:"warn"});return}const C=Date.now(),Q={id:Fr("VX"),travelerType:Te.travelerType,travelerId:Te.travelerId,exceptionType:Te.exceptionType,validFrom:C,validTo:C+Th(Te.validDays,1,365)*864e5,status:"Pending",requestedBy:"Org Admin",reason:Te.reason.trim()},O=["VIP",Te.exceptionType==="Premium rides"?"Premium":"After-hours"],ee=Ae({scope:"VIP Exception",scopeId:Q.id,createdBy:"Org Admin",reason:Q.reason,flags:O});Q.approvalId=ee.id,U(F=>[Q,...F]),n({title:"Requested",message:"VIP exception requested and sent for approval.",kind:"success"}),ne(!1),W("approvals")},Ke=()=>{const u=z.map(f=>{const B=Re(f.travelerType,f.travelerId),p=f.travelerType==="Visitor"?qe(f.travelerId):"-";return{ref:f.ref,status:f.status,traveler:B,travelerType:f.travelerType,host:p,when:mr(f.scheduledAt),pickup:f.pickup,dropoff:f.dropoff,category:f.category,purpose:f.purpose==="Other"?f.purposeOther||"Other":f.purpose,tags:f.tags.join(";"),costCenter:f.costCenter,projectTag:f.projectTag,policyNotes:f.policyNotes.join(";")}}),C=Object.keys(u[0]||{ref:""}),Q=f=>{const B=String(f??"");return/[",\n]/.test(B)?`"${B.replace(/"/g,'""')}"`:B},O=C.join(","),ee=u.map(f=>C.map(B=>Q(f[B])).join(",")).join(`
`),F=`${O}
${ee}`,D=new Blob([F],{type:"text/csv"}),m=URL.createObjectURL(D),A=document.createElement("a");A.href=m,A.download="corporate-travel-bookings.csv",A.click(),URL.revokeObjectURL(m),n({title:"Exported",message:"Bookings CSV downloaded.",kind:"success"})};return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(Z_,{toasts:a,onDismiss:u=>l(C=>C.filter(Q=>Q.id!==u))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:fx.green},children:e.jsx(Dn,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Corporate Travel and Scheduling"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Pre-book rides for visitors, events, and recurring commutes. Book on behalf, enforce purpose tags, and handle VIP exceptions with approvals."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(dt,{label:`Open: ${Ne.open}`,tone:Ne.open?"warn":"good"}),e.jsx(dt,{label:`Today: ${Ne.dueToday}`,tone:Ne.dueToday?"info":"neutral"}),e.jsx(dt,{label:`Approvals: ${_e}`,tone:_e?"warn":"good"}),e.jsx(dt,{label:`VIP pending: ${Ne.vipPending}`,tone:Ne.vipPending?"warn":"good"}),e.jsx(dt,{label:xe?`Peak hour: ${Be.hour}:00 (${Be.count})`:`Peak hour: ${Be.hour}:00`,tone:xe?"warn":"neutral"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Jt,{variant:"outline",onClick:Ke,children:[e.jsx(gt,{className:"h-4 w-4"})," Export CSV"]}),e.jsxs(Jt,{variant:"outline",onClick:()=>Fe(!0),children:[e.jsx(Us,{className:"h-4 w-4"})," Bulk event booking"]}),e.jsxs(Jt,{variant:"primary",onClick:()=>{ce(!0),pe(0)},children:[e.jsx(pt,{className:"h-4 w-4"})," New booking"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"overview",label:"Overview"},{id:"bookings",label:"Bookings"},{id:"events",label:"Events"},{id:"recurring",label:"Recurring commutes"},{id:"vip",label:"Visitors and VIP"},{id:"insights",label:"Scheduling insights"},{id:"approvals",label:"Approvals"}].map(u=>e.jsx("button",{className:ca("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",_===u.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:_===u.id?{background:fx.green}:void 0,onClick:()=>W(u.id),children:u.label},u.id))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[_==="overview"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsxs(Ga,{title:"Upcoming bookings",subtitle:"Pre-booked rides, event transfers, and visitor trips.",right:e.jsx(dt,{label:`${He.length} upcoming`,tone:He.length?"info":"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"When"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Traveler"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Route"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Purpose"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[He.slice().sort((u,C)=>u.scheduledAt-C.scheduledAt).slice(0,6).map(u=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:mr(u.scheduledAt)}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:Re(u.travelerType,u.travelerId)}),ze(u.travelerType,u.travelerId)?e.jsx(dt,{label:"VIP",tone:"info"}):null,e.jsx(dt,{label:u.travelerType,tone:"neutral"})]}),u.travelerType==="Visitor"?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Host: ",qe(u.travelerId)]}):null]}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[u.pickup,"  ",u.dropoff]}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx(dt,{label:u.purpose==="Other"?u.purposeOther||"Other":u.purpose,tone:"neutral"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[u.tags.slice(0,3).join(", "),u.tags.length>3?"":""]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(dt,{label:u.status,tone:gb(u.status)})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(Jt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>H(u.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]})})]},u.id)),He.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-10",children:e.jsx(no,{title:"No upcoming bookings",subtitle:"Create a booking or bulk book for an event."})})})]})]})}),xe?e.jsxs("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:["Smart scheduling: peak time detected around ",Be.hour,":00. Consider preplanning 15-30 minutes earlier or switching to bulk event booking."]}):e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Smart scheduling: no peak congestion detected in upcoming bookings."})]}),e.jsxs(Ga,{title:"Policy guardrails",subtitle:"Trip purpose enforcement and tagging.",right:e.jsx(dt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(Cm,{enabled:r.requirePurpose,onChange:u=>i(C=>({...C,requirePurpose:u})),label:"Require trip purpose",description:"Purpose must be selected and stored."}),e.jsx(Cm,{enabled:r.requireProjectTag,onChange:u=>i(C=>({...C,requireProjectTag:u})),label:"Require project tag",description:"Used for reporting and chargeback."}),e.jsx(Cm,{enabled:r.requireCostCenter,onChange:u=>i(C=>({...C,requireCostCenter:u})),label:"Require cost center",description:"Enforced on booking creation."}),e.jsx(Cm,{enabled:r.premiumRequiresApproval,onChange:u=>i(C=>({...C,premiumRequiresApproval:u})),label:"Premium requires approval",description:"Policy exceptions are approval-gated."})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:["Default working hours: ",r.workStart," to ",r.workEnd,". After-hours bookings require approval unless a VIP exception is active."]})]})]}),e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsx(Ga,{title:"Events",subtitle:"Upcoming corporate events with manifests.",right:e.jsx(dt,{label:`${le.length}`,tone:le.length?"info":"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[le.slice(0,4).map(u=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:u.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[mr(u.startAt),"  ",u.location]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(dt,{label:`${u.attendees.length} attendees`,tone:"neutral"}),u.attendees.some(C=>ze(C.type,C.id))?e.jsx(dt,{label:"VIP present",tone:"info"}):null]})]}),e.jsxs(Jt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{fe(C=>({...C,eventId:u.id,projectTag:u.name})),Fe(!0)},children:[e.jsx(Us,{className:"h-4 w-4"})," Bulk"]})]})},u.id)),le.length?null:e.jsx(no,{title:"No upcoming events",subtitle:"Create an event manifest first (future)."})]})}),e.jsxs(Ga,{title:"Approvals queue",subtitle:"Policy exceptions and VIP handling.",right:e.jsx(dt,{label:`${_e}`,tone:_e?"warn":"good"}),children:[e.jsxs("div",{className:"space-y-2",children:[ae.filter(u=>u.status==="Pending").slice(0,4).map(u=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(dt,{label:u.scope,tone:"neutral"}),e.jsx(dt,{label:u.status,tone:Sm(u.status)}),e.jsx(dt,{label:`${u.steps.filter(C=>C.status==="Pending").length} step(s)`,tone:"info"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:u.reason}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[xb(u.createdAt),"  ",u.createdBy]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[u.policyFlags.slice(0,3).map((C,Q)=>e.jsx(dt,{label:C,tone:"neutral"},`${u.id}-f-${Q}`)),u.policyFlags.length>3?e.jsx(dt,{label:"+more",tone:"neutral"}):null]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(Jt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>$e(u.id),children:[e.jsx(tt,{className:"h-4 w-4"})," Approve"]}),e.jsxs(Jt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ge(u.id),children:[e.jsx(Ye,{className:"h-4 w-4"})," Reject"]})]})]})},u.id)),ae.filter(u=>u.status==="Pending").length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No pending approvals."})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Jt,{variant:"outline",onClick:()=>W("approvals"),children:[e.jsx(et,{className:"h-4 w-4"})," Open approvals"]}),e.jsxs(Jt,{variant:"outline",onClick:()=>ne(!0),children:[e.jsx(Xr,{className:"h-4 w-4"})," VIP exception"]})]})]})]})]}):null,_==="bookings"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(Ga,{title:"Search and filters",subtitle:"Coordinator view.",right:e.jsx(dt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-2 py-2",children:[e.jsx(ka,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:J,onChange:u=>we(u.target.value),placeholder:"ref, traveler, route, tag...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(zn,{label:"Status",value:G,onChange:u=>be(u),options:[{value:"All",label:"All"},...["Draft","Pending approval","Confirmed","Completed","Cancelled"].map(u=>({value:u,label:u}))]}),e.jsx(zn,{label:"Traveler type",value:Ge,onChange:u=>Me(u),options:[{value:"All",label:"All"},{value:"Employee",label:"Employee"},{value:"Visitor",label:"Visitor"}]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Jt,{variant:"outline",onClick:()=>{we(""),be("All"),Me("All"),n({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(fn,{className:"h-4 w-4"})," Reset"]}),e.jsxs(Jt,{variant:"outline",onClick:Ke,children:[e.jsx(gt,{className:"h-4 w-4"})," CSV"]}),e.jsxs(Jt,{variant:"primary",onClick:()=>ce(!0),children:[e.jsx(pt,{className:"h-4 w-4"})," New"]})]})]}),e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Book on behalf: choose employee or visitor, then apply purpose tags, cost center, and project tag."})]})}),e.jsx("div",{className:"lg:col-span-8",children:e.jsx(Ga,{title:"Bookings",subtitle:"Pre-booked rides and scheduled transfers.",right:e.jsx(dt,{label:`${z.length}`,tone:"neutral"}),children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Ref"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"When"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Traveler"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Route"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Category"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Purpose"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[z.map(u=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:u.ref}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:u.id})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:mr(u.scheduledAt)}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:Re(u.travelerType,u.travelerId)}),ze(u.travelerType,u.travelerId)?e.jsx(dt,{label:"VIP",tone:"info"}):null,e.jsx(dt,{label:u.travelerType,tone:"neutral"})]}),u.travelerType==="Visitor"?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Host: ",qe(u.travelerId)]}):null]}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[u.pickup,"  ",u.dropoff]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(dt,{label:u.category,tone:u.category==="Premium"?"info":"neutral"})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx(dt,{label:u.purpose==="Other"?u.purposeOther||"Other":u.purpose,tone:"neutral"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[u.costCenter,"  ",u.projectTag]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(dt,{label:u.status,tone:gb(u.status)})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(Jt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>H(u.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]})})]},u.id)),z.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-10",children:e.jsx(no,{title:"No bookings",subtitle:"Create a booking or adjust filters."})})})]})]})})})})]}):null,_==="events"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsx(Ga,{title:"Event manifests",subtitle:"Premium: many riders and bulk booking.",right:e.jsx(dt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"space-y-2",children:[N.slice().sort((u,C)=>u.startAt-C.startAt).map(u=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:u.name}),e.jsx(dt,{label:Mc(u.startAt),tone:"neutral"}),e.jsx(dt,{label:`${u.attendees.length} attendees`,tone:"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[mr(u.startAt)," to ",mr(u.endAt)]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Location: ",u.location]}),u.notes?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Notes: ",u.notes]}):null]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(Jt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{fe(C=>({...C,eventId:u.id,projectTag:u.name})),Fe(!0)},children:[e.jsx(Us,{className:"h-4 w-4"})," Bulk"]}),e.jsxs(Jt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{W("bookings"),we(u.name),n({title:"Filtered",message:"Showing related bookings.",kind:"info"})},children:[e.jsx(et,{className:"h-4 w-4"})," Bookings"]})]})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Manifest"}),e.jsxs("div",{className:"mt-2 grid grid-cols-1 gap-2 sm:grid-cols-2",children:[u.attendees.slice(0,6).map((C,Q)=>e.jsxs("div",{className:"flex items-center justify-between gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-800",children:Re(C.type,C.id)}),e.jsxs("div",{className:"flex items-center gap-2",children:[ze(C.type,C.id)?e.jsx(dt,{label:"VIP",tone:"info"}):null,e.jsx(dt,{label:C.type,tone:"neutral"})]})]},`${u.id}-a-${Q}`)),u.attendees.length>6?e.jsxs("div",{className:"text-xs text-slate-500",children:["+",u.attendees.length-6," more"]}):null]})]})]},u.id)),N.length?null:e.jsx(no,{title:"No events",subtitle:"Add an event manifest first."})]})})}),e.jsxs("div",{className:"lg:col-span-7 space-y-4",children:[e.jsx(Ga,{title:"Peak-time preplanning",subtitle:"Premium: detect peak times and suggest buffers.",right:e.jsx(dt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Peak hour"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Computed from upcoming bookings by hour."})]}),e.jsx(dt,{label:`${Be.hour}:00  ${Be.count} booking(s)`,tone:xe?"warn":"neutral"})]}),e.jsx("div",{className:"mt-4 grid grid-cols-6 gap-2 sm:grid-cols-8 md:grid-cols-12",children:Pe.map((u,C)=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-2 text-center",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-700",children:C}),e.jsx("div",{className:ca("mt-2 h-2 rounded-full",u?"bg-emerald-200":"bg-slate-100"),style:{width:"100%"}}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:u})]},C))}),e.jsxs("div",{className:"mt-4 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:["Smart suggestion: if booking at ",Be.hour,":00, consider scheduling 15-30 minutes earlier and pre-assigning vehicles for event manifests."]})]})}),e.jsx(Ga,{title:"VIP handling",subtitle:"Policy exceptions with approvals.",right:e.jsx(dt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"VIP exceptions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Allow premium rides or after-hours for specific travelers."})]}),e.jsxs(Jt,{variant:"primary",onClick:()=>ne(!0),children:[e.jsx(Xr,{className:"h-4 w-4"})," Request"]})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[R.slice(0,5).map(u=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(dt,{label:u.exceptionType,tone:"neutral"}),e.jsx(dt,{label:u.status,tone:Sm(u.status)}),e.jsx(dt,{label:`${Mc(u.validFrom)}  ${Mc(u.validTo)}`,tone:"info"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:Re(u.travelerType,u.travelerId)}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Requested by ",u.requestedBy,"  ",u.reason]})]}),u.approvalId?e.jsx(dt,{label:u.approvalId,tone:"neutral"}):null]})},u.id)),R.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No VIP exceptions."})]})]})})]})]}):null,_==="recurring"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsxs(Ga,{title:"Recurring commutes",subtitle:"Core: recurring schedules for office commute.",right:e.jsx(dt,{label:`${T.length}`,tone:"neutral"}),children:[e.jsxs("div",{className:"space-y-2",children:[T.map(u=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:u.name}),e.jsx(dt,{label:u.enabled?"Enabled":"Disabled",tone:u.enabled?"good":"neutral"}),e.jsx(dt,{label:`${u.timeLocal}`,tone:"neutral"}),e.jsx(dt,{label:u.category,tone:u.category==="Premium"?"info":"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Days: ",u.days.join(", ")]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Route: ",u.pickup,"  ",u.dropoff]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Employees: ",u.employees.map(C=>{var Q;return((Q=j[C])==null?void 0:Q.name)||C}).join(", ")]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(Jt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{k(C=>C.map(Q=>Q.id===u.id?{...Q,enabled:!Q.enabled}:Q)),n({title:"Updated",message:"Recurring schedule updated.",kind:"success"})},children:[e.jsx(PE,{className:"h-4 w-4"})," Toggle"]}),e.jsxs(Jt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{const C=Date.now()+1728e5,[Q,O]=u.timeLocal.split(":").map(A=>Number(A)),ee=new Date(C);ee.setHours(Q||0,O||0,0,0);const F=ee.getTime(),D=u.employees.map(A=>{const f=j[A],B=[];u.category==="Premium"&&r.premiumRequiresApproval&&B.push("Premium requested"),Am(F,r.workStart,r.workEnd)&&B.push("After-hours"),f!=null&&f.vip&&B.push("VIP traveler");const p=B.length>0;return{id:Fr("BK"),ref:pd("RC"),travelerType:"Employee",travelerId:A,bookedBy:"Travel Coordinator",createdAt:Date.now(),scheduledAt:F,pickup:u.pickup,dropoff:u.dropoff,category:u.category,purpose:u.purpose,tags:u.tags,costCenter:(f==null?void 0:f.costCenter)||"OPS-001",projectTag:u.name,module:"Rides & Logistics",status:p?"Pending approval":"Confirmed",recurringId:u.id,vipRequested:!!(f!=null&&f.vip),policyNotes:B,proofs:[]}});L(A=>[...D,...A]),D.some(A=>A.status==="Pending approval")&&Ae({scope:"Event",scopeId:u.id,createdBy:"Travel Coordinator",reason:"Recurring booking instance requires policy approval",flags:Array.from(new Set(D.flatMap(A=>A.policyNotes)))}),n({title:"Generated",message:`Created ${D.length} booking(s) from recurring schedule.`,kind:"success"}),W("bookings")},children:[e.jsx(ht,{className:"h-4 w-4"})," Generate"]})]})]})},u.id)),T.length?null:e.jsx(no,{title:"No recurring schedules",subtitle:"Create a recurring commute plan."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: smart scheduling can preplan around peak time and suggest alternate pickup windows."})]})}),e.jsxs("div",{className:"lg:col-span-7 space-y-4",children:[e.jsxs(Ga,{title:"Policy enforcement preview",subtitle:"What would require approval.",right:e.jsx(dt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"After-hours"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Outside ",r.workStart," to ",r.workEnd]})]}),e.jsx(dt,{label:"Approval",tone:"warn"})]}),e.jsx("div",{className:"mt-3 text-xs text-slate-600",children:"Best practice: require Manager and Finance approval; add CFO for VIP."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Premium"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium category request"})]}),e.jsx(dt,{label:"Approval",tone:"warn"})]}),e.jsx("div",{className:"mt-3 text-xs text-slate-600",children:"Best practice: allow premium for VIP only through approvals or VIP exception."})]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Tip: Link enforcement to Approval Workflow Builder (J) for organization-wide consistency."})]}),e.jsx(Ga,{title:"Recurring best practices",subtitle:"Operational tips for commuting programs.",right:e.jsx(dt,{label:"Premium",tone:"info"}),children:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"1) Start with a pilot group for commutes, then expand"}),e.jsx("li",{children:"2) Enforce purpose tagging and cost center"}),e.jsx("li",{children:"3) Prebook 15-30 minutes earlier during peak traffic"}),e.jsx("li",{children:"4) Maintain VIP exceptions for executives with audit trails"})]})})})]})]}):null,_==="vip"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-6 space-y-4",children:e.jsxs(Ga,{title:"Visitors",subtitle:"Core: visitor prebooking and host enforcement.",right:e.jsx(dt,{label:`${c.length}`,tone:"neutral"}),children:[e.jsxs("div",{className:"space-y-2",children:[c.map(u=>{var C;return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:u.name}),e.jsx(dt,{label:u.company,tone:"neutral"}),u.vip?e.jsx(dt,{label:"VIP",tone:"info"}):null]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Host: ",((C=j[u.hostEmployeeId])==null?void 0:C.name)||u.hostEmployeeId]}),u.phone?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Phone: ",u.phone]}):null]}),e.jsxs(Jt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>{ye(Q=>({...Q,travelerType:"Visitor",travelerId:u.id,pickup:"Entebbe Airport",dropoff:"Kampala HQ",category:u.vip?"Premium":"Standard",vipRequested:u.vip,purpose:"Visitor",projectTag:"Visitor transport",tags:u.vip?"VIP,Airport":"Visitor,Airport"})),pe(1),ce(!0)},children:[e.jsx(BF,{className:"h-4 w-4"})," Book"]})]})},u.id)}),c.length?null:e.jsx(no,{title:"No visitors",subtitle:"Add visitors to enable pre-booking."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: visitor bookings should always store host employee and trip purpose."})]})}),e.jsx("div",{className:"lg:col-span-6 space-y-4",children:e.jsxs(Ga,{title:"VIP exceptions",subtitle:"Premium: policy exceptions with approvals.",right:e.jsx(dt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Jt,{variant:"primary",onClick:()=>ne(!0),children:[e.jsx(Xr,{className:"h-4 w-4"})," Request exception"]}),e.jsxs(Jt,{variant:"outline",onClick:()=>W("approvals"),children:[e.jsx(et,{className:"h-4 w-4"})," View approvals"]})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[R.map(u=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(dt,{label:u.exceptionType,tone:"neutral"}),e.jsx(dt,{label:u.status,tone:Sm(u.status)}),e.jsx(dt,{label:`${Mc(u.validFrom)}  ${Mc(u.validTo)}`,tone:"info"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:Re(u.travelerType,u.travelerId)}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Requested by ",u.requestedBy,"  ",u.reason]}),u.approvalId?e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Approval: ",u.approvalId]}):null]}),e.jsx(Xr,{className:ca("h-5 w-5",u.status==="Approved"?"text-amber-500":"text-slate-300")})]})},u.id)),R.length?null:e.jsx(no,{title:"No VIP exceptions",subtitle:"Request an exception to allow premium or after-hours travel."})]})]})})]}):null,_==="insights"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-5 space-y-4",children:[e.jsx(Ga,{title:"Peak time detection",subtitle:"Premium: smart scheduling suggestions.",right:e.jsx(dt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Peak hour"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Upcoming bookings by hour (0-23)"})]}),e.jsx(dt,{label:`${Be.hour}:00  ${Be.count}`,tone:xe?"warn":"neutral"})]}),e.jsx("div",{className:"mt-4 grid grid-cols-6 gap-2 sm:grid-cols-8 md:grid-cols-12",children:Pe.map((u,C)=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-2 text-center",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-700",children:C}),e.jsx("div",{className:ca("mt-2 h-2 rounded-full",u?"bg-emerald-200":"bg-slate-100")}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:u})]},C))}),e.jsx("div",{className:"mt-4 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Suggestion: schedule event transfers 30 minutes earlier during peak hours and use bulk booking to reduce coordination load."})]})}),e.jsx(Ga,{title:"Recommendations",subtitle:"Next best coordinator actions.",right:e.jsx(dt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{title:"Bulk book your next event",detail:le.length?`Upcoming event: ${le[0].name} has ${le[0].attendees.length} attendee(s).`:"Create an event manifest to bulk book rides.",cta:"Bulk book",onClick:()=>Fe(!0)}),e.jsx(v,{title:"Resolve pending approvals",detail:`There are ${_e} approval request(s) pending.`,cta:"Open approvals",onClick:()=>W("approvals")}),e.jsx(v,{title:"Create a VIP exception",detail:"For recurring executive travel, create an approved VIP exception with audit trail.",cta:"Request",onClick:()=>ne(!0)})]})})]}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs(Ga,{title:"Program insights",subtitle:"Policy compliance and quality indicators.",right:e.jsx(dt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(b,{title:"After-hours",value:`${q.filter(u=>Am(u.scheduledAt,r.workStart,r.workEnd)).length}`,sub:"Bookings outside window",icon:e.jsx(sl,{className:"h-5 w-5"}),tone:"warn"}),e.jsx(b,{title:"Premium",value:`${q.filter(u=>u.category==="Premium").length}`,sub:"Premium category",icon:e.jsx(Xr,{className:"h-5 w-5"}),tone:"info"}),e.jsx(b,{title:"Purpose missing",value:`${q.filter(u=>u.purpose==="Other"&&!u.purposeOther).length}`,sub:"Should be 0",icon:e.jsx(Mt,{className:"h-5 w-5"}),tone:"bad"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: peak time detection can be expanded with traffic data and city events calendars."})]})})]}):null,_==="approvals"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(Ga,{title:"Approvals",subtitle:"VIP, premium, and after-hours exceptions.",right:e.jsx(dt,{label:"Core",tone:"neutral"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Approvals are required before sending some bookings to dispatch."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Jt,{variant:"primary",onClick:()=>ne(!0),children:[e.jsx(Xr,{className:"h-4 w-4"})," VIP exception"]}),e.jsxs(Jt,{variant:"outline",onClick:()=>n({title:"Tip",message:"Map these approvals to your global Approval Workflow Builder (J).",kind:"info"}),children:[e.jsx(vn,{className:"h-4 w-4"})," Tip"]})]})]})}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsx(Ga,{title:"Approval requests",subtitle:"Approve or reject with audit trail.",right:e.jsx(dt,{label:`${ae.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[ae.slice().sort((u,C)=>C.createdAt-u.createdAt).map(u=>{const C=u.steps.findIndex(O=>O.status==="Pending"),Q=C>=0?u.steps[C]:null;return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(dt,{label:u.scope,tone:"neutral"}),e.jsx(dt,{label:u.status,tone:Sm(u.status)}),e.jsx(dt,{label:u.id,tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:u.reason}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",xb(u.createdAt),"  ",u.createdBy]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:u.policyFlags.map((O,ee)=>e.jsx(dt,{label:O,tone:"neutral"},`${u.id}-pf-${ee}`))}),Q?e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Next: ",e.jsx("span",{className:"font-semibold",children:Q.role})," (",Q.assignee,")  SLA ",Q.slaHours,"h"]}):null]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Jt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>$e(u.id),disabled:u.status!=="Pending",children:[e.jsx(tt,{className:"h-4 w-4"})," Approve"]}),e.jsxs(Jt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ge(u.id),disabled:u.status!=="Pending",children:[e.jsx(Ye,{className:"h-4 w-4"})," Reject"]}),u.scope==="Booking"?e.jsxs(Jt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{H(u.scopeId)},children:[e.jsx(et,{className:"h-4 w-4"})," Open booking"]}):null]})]}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2 md:grid-cols-2",children:u.steps.map(O=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:O.role}),e.jsx(dt,{label:O.status,tone:Sm(O.status)})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Assignee: ",O.assignee,"  SLA ",O.slaHours,"h"]}),O.decidedAt?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Decided ",mr(O.decidedAt),"  ",O.note||""]}):null]},O.id))})]},u.id)}),ae.length?null:e.jsx(no,{title:"No approvals",subtitle:"Policy exceptions will appear here."})]})})})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"U Corporate Travel and Scheduling v2. Core: pre-book rides for visitors, events, recurring commutes; coordinator book-on-behalf tools; purpose tagging. Premium: event manifests and bulk booking, VIP exception approvals, and peak-time scheduling insights."})})]})}),e.jsx(J_,{open:je,title:Y?`${Y.ref}  ${Y.category}`:"Booking",subtitle:Y?`${Re(Y.travelerType,Y.travelerId)}  ${mr(Y.scheduledAt)}`:"",onClose:()=>Ue(!1),footer:Y?e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"In production, this links to dispatch and driver assignment."}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Jt,{variant:"outline",onClick:()=>{L(u=>u.map(C=>C.id===Y.id?{...C,status:"Cancelled"}:C)),n({title:"Cancelled",message:"Booking cancelled.",kind:"warn"}),Ue(!1)},disabled:Y.status==="Cancelled"||Y.status==="Completed",children:[e.jsx(Ye,{className:"h-4 w-4"})," Cancel"]}),e.jsxs(Jt,{variant:"primary",onClick:()=>{L(u=>u.map(C=>C.id===Y.id?{...C,status:"Completed",proofs:[{id:Fr("AT"),name:"Trip receipt.pdf",note:"Receipt",addedAt:Date.now(),addedBy:"System"},...C.proofs]}:C)),n({title:"Completed",message:"Booking marked completed.",kind:"success"})},disabled:Y.status!=="Confirmed",title:Y.status!=="Confirmed"?"Only confirmed bookings can complete":"",children:[e.jsx(tt,{className:"h-4 w-4"})," Complete"]})]})]}):null,children:Y?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(dt,{label:Y.status,tone:gb(Y.status)}),e.jsx(dt,{label:Y.purpose==="Other"?Y.purposeOther||"Other":Y.purpose,tone:"neutral"}),ze(Y.travelerType,Y.travelerId)?e.jsx(dt,{label:"VIP",tone:"info"}):null,Y.category==="Premium"?e.jsx(dt,{label:"Premium",tone:"info"}):e.jsx(dt,{label:"Standard",tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:Re(Y.travelerType,Y.travelerId)}),Y.travelerType==="Visitor"?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Host: ",qe(Y.travelerId)]}):null,e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Booked by ",Y.bookedBy,"  Created ",xb(Y.createdAt)]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Scheduled"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:mr(Y.scheduledAt)}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Cost center"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:Y.costCenter})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Pickup"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:Y.pickup})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Drop-off"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:Y.dropoff})]})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Tags"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:Y.tags.length?Y.tags.map((u,C)=>e.jsx(dt,{label:u,tone:"neutral"},`${Y.id}-t-${C}`)):e.jsx(dt,{label:"None",tone:"neutral"})}),e.jsxs("div",{className:"mt-3 text-xs text-slate-600",children:["Project: ",Y.projectTag]})]}),Y.policyNotes.length?e.jsxs("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:[e.jsx("div",{className:"font-semibold",children:"Policy notes"}),e.jsx("ul",{className:"mt-2 space-y-1",children:Y.policyNotes.map((u,C)=>e.jsxs("li",{children:[" ",u]},`${Y.id}-pn-${C}`))})]}):null]}),e.jsx(Ga,{title:"Proofs",subtitle:"Receipts and completion logs.",right:e.jsx(dt,{label:`${Y.proofs.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[Y.proofs.map(u=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:u.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[mr(u.addedAt),"  ",u.addedBy]}),u.note?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Note: ",u.note]}):null]}),e.jsx(Jt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:async()=>{try{await navigator.clipboard.writeText(u.name),n({title:"Copied",message:"Proof name copied.",kind:"success"})}catch{n({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},children:e.jsx(ls,{className:"h-4 w-4"})})]})},u.id)),Y.proofs.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No proofs yet."})]})})]}):null}),e.jsx(hb,{open:Ie,title:"New booking",subtitle:"Coordinator booking on behalf. Purpose, tags, and policy enforcement are required.",onClose:()=>ce(!1),actions:[{label:"Create",onClick:oe}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Jt,{variant:"outline",onClick:()=>ce(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Jt,{variant:"outline",onClick:()=>pe(u=>u>0?u-1:u),disabled:me===0,children:"Back"}),me<2?e.jsxs(Jt,{variant:"primary",onClick:()=>pe(u=>u+1),children:["Next",e.jsx(et,{className:"h-4 w-4"})]}):e.jsxs(Jt,{variant:"primary",onClick:oe,children:[e.jsx(ct,{className:"h-4 w-4"})," Create"]})]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:[0,1,2].map(u=>e.jsx("button",{type:"button",className:ca("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",me===u?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:me===u?{background:fx.green}:void 0,onClick:()=>pe(u),children:u===0?"Traveler":u===1?"Trip details":"Policy check"},u))}),me===0?e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(zn,{label:"Traveler type",value:de.travelerType,onChange:u=>ye(C=>{var Q,O;return{...C,travelerType:u,travelerId:u==="Employee"?((Q=o[0])==null?void 0:Q.id)||"":((O=c[0])==null?void 0:O.id)||""}}),options:[{value:"Employee",label:"Employee"},{value:"Visitor",label:"Visitor"}]}),e.jsx(zn,{label:"Traveler",value:de.travelerId,onChange:u=>ye(C=>({...C,travelerId:u})),options:(de.travelerType==="Employee"?o:c).map(u=>({value:u.id,label:u.name}))}),e.jsx(nn,{label:"Booked by",value:de.bookedBy,onChange:u=>ye(C=>({...C,bookedBy:u})),placeholder:"Travel Coordinator"}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"VIP"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Flag the booking as VIP handling."})]}),e.jsx("button",{type:"button",className:ca("relative h-7 w-12 rounded-full border transition",de.vipRequested?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>ye(u=>({...u,vipRequested:!u.vipRequested})),"aria-label":"Toggle VIP",children:e.jsx("span",{className:ca("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",de.vipRequested?"left-[22px]":"left-1")})})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[ze(de.travelerType,de.travelerId)?e.jsx(dt,{label:"Traveler is VIP",tone:"info"}):e.jsx(dt,{label:"Standard traveler",tone:"neutral"}),de.travelerType==="Visitor"?e.jsx(dt,{label:`Host: ${qe(de.travelerId)}`,tone:"neutral"}):null]})]})]}):null,me===1?e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(nn,{label:"Pickup",value:de.pickup,onChange:u=>ye(C=>({...C,pickup:u})),placeholder:"Kampala HQ"}),e.jsx(nn,{label:"Drop-off",value:de.dropoff,onChange:u=>ye(C=>({...C,dropoff:u})),placeholder:"Entebbe Airport"}),e.jsx(nn,{label:"Scheduled time",type:"datetime-local",value:de.scheduledAt,onChange:u=>ye(C=>({...C,scheduledAt:u})),hint:"Local time"}),e.jsx(zn,{label:"Ride category",value:de.category,onChange:u=>ye(C=>({...C,category:u})),options:[{value:"Standard",label:"Standard"},{value:"Premium",label:"Premium"}]}),e.jsx(zn,{label:"Purpose",value:de.purpose,onChange:u=>ye(C=>({...C,purpose:u})),options:s.map(u=>({value:u,label:u}))}),e.jsx(nn,{label:"Tags",value:de.tags,onChange:u=>ye(C=>({...C,tags:u})),placeholder:"Comma separated",hint:"Example: Airport,VIP,Event"}),e.jsx(nn,{label:"Cost center",value:de.costCenter,onChange:u=>ye(C=>({...C,costCenter:u})),placeholder:"OPS-001"}),e.jsx(nn,{label:"Project tag",value:de.projectTag,onChange:u=>ye(C=>({...C,projectTag:u})),placeholder:"Roadshow"}),e.jsx(zn,{label:"Module",value:de.module,onChange:u=>ye(C=>({...C,module:u})),options:[{value:"Rides & Logistics",label:"Rides & Logistics"},{value:"Travel & Tourism",label:"Travel & Tourism"},{value:"Other Service Module",label:"Other Service Module"}],hint:"Typically Rides & Logistics"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(tC,{label:"If purpose is Other",value:de.purposeOther,onChange:u=>ye(C=>({...C,purposeOther:u})),placeholder:"Explain the purpose",rows:3,disabled:de.purpose!=="Other",hint:de.purpose!=="Other"?"Disabled":"Required when Other"})})]}):null,me===2?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Policy check"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"This preview shows why approval may be required."})]}),M.needsApproval?e.jsx(dt,{label:"Approval required",tone:"warn"}):e.jsx(dt,{label:"No approval",tone:"good"})]}),M.errors.length?e.jsxs("div",{className:"mt-3 rounded-2xl bg-rose-50 p-3 text-xs text-rose-800 ring-1 ring-rose-200",children:[e.jsx("div",{className:"font-semibold",children:"Missing"}),e.jsx("ul",{className:"mt-2 space-y-1",children:M.errors.map((u,C)=>e.jsxs("li",{children:[" ",u]},`err-${C}`))})]}):null,e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Scheduled"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:mr(M.scheduledAt)}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["After-hours: ",M.afterHours?"Yes":"No"]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Category"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:de.category}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["VIP: ",M.tVip||de.vipRequested?"Yes":"No"]})]})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Flags"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[M.flags.length?M.flags.map((u,C)=>e.jsx(dt,{label:u,tone:u.endsWith("required")?"bad":"neutral"},`flag-${C}`)):e.jsx(dt,{label:"None",tone:"neutral"}),M.hasActiveVipException?e.jsx(dt,{label:"VIP exception active",tone:"info"}):null]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"If approval is required, the booking will be created in Pending approval and routed to Manager then Finance, and optionally CFO for VIP or Premium."})]})}):null]})}),e.jsx(hb,{open:Qe,title:"Bulk travel plan",subtitle:"Premium: schedule many rides on behalf of employees.",onClose:()=>Fe(!1),actions:[{label:"Create",onClick:De}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Jt,{variant:"outline",onClick:()=>Fe(!1),children:"Cancel"}),e.jsxs(Jt,{variant:"primary",onClick:De,children:[e.jsx(ct,{className:"h-4 w-4"})," Create"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(zn,{label:"Event",value:ke.eventId,onChange:u=>fe(C=>({...C,eventId:u})),options:N.map(u=>({value:u.id,label:`${u.name} (${Mc(u.startAt)})`}))}),e.jsx(zn,{label:"Category",value:ke.category,onChange:u=>fe(C=>({...C,category:u})),options:[{value:"Standard",label:"Standard"},{value:"Premium",label:"Premium"}]}),e.jsx(nn,{label:"Pickup",value:ke.pickup,onChange:u=>fe(C=>({...C,pickup:u}))}),e.jsx(nn,{label:"Drop-off",value:ke.dropoff,onChange:u=>fe(C=>({...C,dropoff:u}))}),e.jsx(pb,{label:"Minutes before event",value:ke.offsetMinsBeforeStart,onChange:u=>fe(C=>({...C,offsetMinsBeforeStart:Th(u,0,240)})),hint:"Departure buffer"}),e.jsx(nn,{label:"Tags",value:ke.tags,onChange:u=>fe(C=>({...C,tags:u})),hint:"Comma separated"}),e.jsx(nn,{label:"Cost center",value:ke.costCenter,onChange:u=>fe(C=>({...C,costCenter:u}))}),e.jsx(nn,{label:"Project tag",value:ke.projectTag,onChange:u=>fe(C=>({...C,projectTag:u}))}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Cm,{enabled:ke.createReturn,onChange:u=>fe(C=>({...C,createReturn:u})),label:"Create return trips",description:"Generate return rides after the event ends."})}),e.jsx(nn,{label:"Return pickup",value:ke.returnPickup,onChange:u=>fe(C=>({...C,returnPickup:u})),disabled:!ke.createReturn}),e.jsx(nn,{label:"Return drop-off",value:ke.returnDropoff,onChange:u=>fe(C=>({...C,returnDropoff:u})),disabled:!ke.createReturn}),e.jsx(pb,{label:"Minutes after event",value:ke.returnMinsAfterEnd,onChange:u=>fe(C=>({...C,returnMinsAfterEnd:Th(u,0,240)})),disabled:!ke.createReturn}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Bulk booking uses the event manifest. If any generated booking violates policy (VIP, Premium, after-hours), an event-level approval request is created."})]})}),e.jsx(hb,{open:Ve,title:"Request VIP exception",subtitle:"Premium: allow luxury rides or after-hours travel through approvals.",onClose:()=>ne(!1),actions:[{label:"Submit",onClick:ue}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Jt,{variant:"outline",onClick:()=>ne(!1),children:"Cancel"}),e.jsxs(Jt,{variant:"primary",onClick:ue,children:[e.jsx(yt,{className:"h-4 w-4"})," Submit"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(zn,{label:"Traveler type",value:Te.travelerType,onChange:u=>Ee(C=>{var Q,O;return{...C,travelerType:u,travelerId:u==="Employee"?((Q=o[0])==null?void 0:Q.id)||"":((O=c[0])==null?void 0:O.id)||""}}),options:[{value:"Employee",label:"Employee"},{value:"Visitor",label:"Visitor"}]}),e.jsx(zn,{label:"Traveler",value:Te.travelerId,onChange:u=>Ee(C=>({...C,travelerId:u})),options:(Te.travelerType==="Employee"?o:c).map(u=>({value:u.id,label:u.name}))}),e.jsx(zn,{label:"Exception type",value:Te.exceptionType,onChange:u=>Ee(C=>({...C,exceptionType:u})),options:[{value:"Premium rides",label:"Premium rides"},{value:"After-hours",label:"After-hours"}]}),e.jsx(pb,{label:"Valid days",value:Te.validDays,onChange:u=>Ee(C=>({...C,validDays:Th(u,1,365)})),hint:"1 to 365"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(tC,{label:"Reason",value:Te.reason,onChange:u=>Ee(C=>({...C,reason:u})),placeholder:"Explain the business justification",rows:4})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Executive approval chain templates (CFO/CEO) can be applied for VIP exceptions in your workflow builder."})]})})]});function b({title:u,value:C,sub:Q,icon:O,tone:ee}){const F=ee==="good"?"bg-emerald-50 text-emerald-700":ee==="warn"?"bg-amber-50 text-amber-800":ee==="bad"?"bg-rose-50 text-rose-700":ee==="info"?"bg-blue-50 text-blue-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:u}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:C}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:Q})]}),e.jsx("div",{className:ca("grid h-10 w-10 place-items-center rounded-2xl",F),children:O})]})})}function v({title:u,detail:C,cta:Q,onClick:O}){return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:u}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:C})]}),e.jsxs(Jt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:O,children:[e.jsx(et,{className:"h-4 w-4"})," ",Q]})]})})}}const Jx={green:"#03CD8C",orange:"#F77F00"};function cn(...t){return t.filter(Boolean).join(" ")}function hd(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function aC(t,s,a){return Math.max(s,Math.min(a,t))}function Em(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function qs(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function lC(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function nC(t,s){const a=r=>{const i=String(r??"");return/[",\n]/.test(i)?`"${i.replace(/"/g,'""')}"`:i},l=s.map(r=>a(r.label)).join(","),n=t.map(r=>s.map(i=>a(r[i.key])).join(",")).join(`
`);return`${l}
${n}`}function Rh(t,s,a="text/plain"){const l=new Blob([s],{type:a}),n=URL.createObjectURL(l),r=document.createElement("a");r.href=n,r.download=t,r.click(),URL.revokeObjectURL(n)}function sB(t){let s=t>>>0;return()=>(s=s*1664525+1013904223>>>0,s/4294967296)}function vt({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:cn("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function ms({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:Jx.green}:t==="accent"?{background:Jx.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:cn(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Zs({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:cn(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:cn("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function Pc({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:cn(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:cn("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function aB({actions:t}){const[s,a]=d.useState(!1),l=Xt.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:cn("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function rC({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="980px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:12,scale:.985},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:12,scale:.985},transition:{duration:.18},className:"fixed inset-x-0 top-[7vh] z-50 mx-auto w-[min(1040px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(aB,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[72vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function lB({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(480px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:cn("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function Is({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function qa({title:t,value:s,sub:a,icon:l,tone:n="neutral"}){const r=n==="good"?"bg-emerald-50 text-emerald-700":n==="warn"?"bg-amber-50 text-amber-800":n==="bad"?"bg-rose-50 text-rose-700":n==="info"?"bg-blue-50 text-blue-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:t}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:s}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a})]}),e.jsx("div",{className:cn("grid h-10 w-10 place-items-center rounded-2xl",r),children:l})]})})}function fb({label:t,value:s,total:a,right:l}){const n=a>0?Math.round(s/a*100):0;return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:t}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[n,"% share"]})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:l??qs(s)})})]}),e.jsx("div",{className:"mt-3 h-2 w-full overflow-hidden rounded-full bg-slate-100",children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${Math.min(100,n)}%`,background:Jx.green}})})]})}function nB(t){if(!t.length)return 0;const s=t.slice().sort((l,n)=>l-n),a=Math.floor(s.length/2);return s.length%2?s[a]:(s[a-1]+s[a])/2}function iC(t,s,a){const l=new Date,n=l.getTime(),r=new Date(l.getFullYear(),0,1).getTime(),i=24*60*60*1e3;if(t==="7d")return{start:n-7*i,end:n};if(t==="30d")return{start:n-30*i,end:n};if(t==="90d")return{start:n-90*i,end:n};if(t==="YTD")return{start:r,end:n};const o=s?new Date(s).getTime():n-30*i,c=a?new Date(a).getTime()+(24*60*60*1e3-1):n;return{start:Number.isFinite(o)?o:n-30*i,end:Number.isFinite(c)?c:n}}function ro(t,s){switch(s){case"Group":return t.group;case"Cost center":return t.costCenter;case"Module":return t.module;case"Marketplace":return t.marketplace||"-";case"Vendor":return t.vendor;case"Requester":return t.requesterName;case"Risk":return t.risk;default:return"-"}}function Dh(t){return t>=7&&t<=9||t>=17&&t<=20}function rB(){const t=d.useMemo(()=>[{id:"U-1001",name:"Mary N.",group:"Operations",costCenter:"OPS-001"},{id:"U-1002",name:"John S.",group:"Sales",costCenter:"SALES-TRAVEL"},{id:"U-1003",name:"Irene K.",group:"Operations",costCenter:"OPS-001"},{id:"U-1004",name:"Daisy O.",group:"Finance",costCenter:"FIN-OPS"},{id:"U-1005",name:"Procurement Desk",group:"Procurement",costCenter:"PROC-001"}],[]);d.useMemo(()=>["EVzone Rides","EVzone Charging","Kampala Office Mart","Shenzhen Store","Shenzhen Tech","ServicePro","Express CN","Hotel Partner","Airline Partner"],[]);const s=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],a=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],[l,n]=d.useState([]),r=m=>{const A=hd("toast");n(f=>[{id:A,...m},...f].slice(0,4)),window.setTimeout(()=>n(f=>f.filter(B=>B.id!==A)),3200)},i=d.useMemo(()=>{const m=sB(1337),A=Date.now(),f=24*60*60*1e3,B=[],p=[],E=h=>{const K=h.reduce((Ce,I)=>Ce+I.w,0);let V=m()*K;for(const Ce of h)if(V-=Ce.w,V<=0)return Ce.item;return h[h.length-1].item},se=h=>h==="Ride"?"Rides & Logistics":h==="Charging"?"EVs & Charging":"E-Commerce",y=()=>E([{item:"EVmart",w:1.1},{item:"GadgetMart",w:.9},{item:"LivingMart",w:.6},{item:"ServiceMart",w:.8},{item:"MyLiveDealz",w:.9},{item:"ExpressMart",w:.5}]),re=(h,K)=>h==="Ride"?"EVzone Rides":h==="Charging"?"EVzone Charging":K==="MyLiveDealz"?"Shenzhen Store":K==="GadgetMart"?"Shenzhen Tech":K==="ExpressMart"?"Express CN":K==="ServiceMart"?"ServicePro":"Kampala Office Mart",ve=(h,K,V=0)=>K==="MyLiveDealz"?"High":K==="ExpressMart"||h==="Charging"&&V>18e4?"Medium":"Low",P=(h,K)=>h==="Ride"?E([{item:["Client"],w:1},{item:["Airport"],w:.6},{item:["Commute"],w:.8}]):h==="Charging"?E([{item:["Depot"],w:1},{item:["Commute"],w:.7},{item:["Emergency"],w:.2}]):K==="MyLiveDealz"?["Deal","Promo"]:K==="ServiceMart"?["Service","Booking"]:["Procurement"],X=h=>{const K=h.ts-Math.floor((m()*90+10)*6e4),V=Math.floor(m()*240+10),Ce=K+V*6e4,I=h.amountUGX<=2e5?"Auto-approved":m()<.88?"Approved":"Rejected",te=h.amountUGX>1e6?24:12,Se=h.amountUGX>1e6?"CFO":h.risk==="High"?"Finance Desk":"Manager";return{id:hd("APR"),requestedAt:K,decidedAt:Ce,module:h.module,marketplace:h.marketplace,requesterId:h.requesterId,requesterName:h.requesterName,approver:Se,outcome:I,amountUGX:h.amountUGX,reason:h.risk==="High"?"High risk marketplace":"Above threshold",slaHours:te}};for(let h=0;h<90;h++){const K=A-h*f,Ce=1+Math.floor(m()*3)+Math.floor(m()*3);for(let Se=0;Se<Ce;Se++){const Xe=E([{item:t[0],w:1},{item:t[1],w:1},{item:t[2],w:.8},{item:t[4],w:.4}]),mt=Math.floor(m()*24),ot=K-Math.floor(m()*4*60*60*1e3)+mt*60*60*1e3,Nt=Math.round(45e3+m()*18e4),nt={id:hd("TX"),ts:ot,type:"Ride",module:se("Ride"),vendor:re("Ride"),requesterId:Xe.id,requesterName:Xe.name,group:Xe.group,costCenter:Xe.costCenter,amountUGX:Nt,currency:"UGX",risk:ve("Ride",void 0,Nt),approved:!0,tags:P("Ride")};if(Nt>2e5||m()<.08){const As=X(nt);p.push(As),nt.approvalId=As.id,nt.approved=As.outcome!=="Rejected"}B.push(nt)}const I=Math.floor(m()*2);for(let Se=0;Se<I;Se++){const Xe=E([{item:t[0],w:.8},{item:t[2],w:1},{item:t[1],w:.6}]),mt=E([{item:8,w:1.1},{item:18,w:1},{item:Math.floor(m()*24),w:.7}]),ot=K+mt*60*60*1e3+Math.floor(m()*40)*6e4,Nt=12+m()*55,nt=Dh(mt)?1350:1050,Vs=Math.round(Nt*nt),As={id:hd("TX"),ts:ot,type:"Charging",module:se("Charging"),vendor:re("Charging"),requesterId:Xe.id,requesterName:Xe.name,group:Xe.group,costCenter:Xe.costCenter,amountUGX:Vs,currency:"UGX",risk:ve("Charging",void 0,Vs),approved:!0,tags:P("Charging")};if(Vs>2e5||Dh(mt)||m()<.05){const Tt=X(As);p.push(Tt),As.approvalId=Tt.id,As.approved=Tt.outcome!=="Rejected"}B.push(As)}const te=Math.floor(m()*3);for(let Se=0;Se<te;Se++){const Xe=E([{item:t[4],w:1.2},{item:t[0],w:.7},{item:t[1],w:.7}]),mt=y(),ot=Math.floor(m()*24),Nt=K+ot*60*60*1e3+Math.floor(m()*50)*6e4,nt=mt==="MyLiveDealz"?18e4+m()*32e5:7e4+m()*12e5,Vs=Math.round(nt),As=mt==="ServiceMart"?"Service":"Purchase",Ca={id:hd("TX"),ts:Nt,type:As,module:"E-Commerce",marketplace:mt,vendor:re(As,mt),requesterId:Xe.id,requesterName:Xe.name,group:Xe.group,costCenter:Xe.costCenter,amountUGX:Vs,currency:"UGX",risk:ve(As,mt,Vs),approved:!0,tags:P(As,mt)};if(Vs>25e4||Ca.risk==="High"||m()<.08){const Sa=X(Ca);p.push(Sa),Ca.approvalId=Sa.id,Ca.approved=Sa.outcome!=="Rejected"}B.push(Ca)}}const S=B.slice().sort((h,K)=>K.ts-h.ts).slice(0,900),w=p.slice().sort((h,K)=>K.requestedAt-h.requestedAt).slice(0,500);return{txs:S,approvals:w}},[t]),[o,c]=d.useState("overview"),[x,j]=d.useState("30d"),[g,N]=d.useState(new Date(Date.now()-30*24*60*60*1e3).toISOString().slice(0,10)),[$,T]=d.useState(new Date().toISOString().slice(0,10)),[k,q]=d.useState("All"),[L,R]=d.useState("All"),[U,ae]=d.useState("All"),[ie,_]=d.useState("All"),[W,J]=d.useState("All"),[we,G]=d.useState("All"),[be,Ge]=d.useState("All"),[Me,je]=d.useState(""),Ue=["Group","Cost center","Module","Marketplace","Vendor","Requester","Risk"],[Oe,he]=d.useState("Module"),[Y,Ie]=d.useState("None"),[ce,me]=d.useState("Spend"),[pe,de]=d.useState(()=>[{id:"RPT-001",name:"Spend by module (30d)",timeRange:"30d",dimensionA:"Module",metric:"Spend",filters:{module:"All",marketplace:"All",group:"All",costCenter:"All",vendor:"All",requester:"All",risk:"All"},createdAt:Date.now()-2*24*60*60*1e3},{id:"RPT-002",name:"Spend by vendor (90d)",timeRange:"90d",dimensionA:"Vendor",metric:"Spend",filters:{module:"All",marketplace:"All",group:"All",costCenter:"All",vendor:"All",requester:"All",risk:"All"},createdAt:Date.now()-5*24*60*60*1e3}]),[ye,Qe]=d.useState(()=>[{id:"SCH-001",reportId:"RPT-001",enabled:!0,frequency:"Weekly",hourLocal:9,dayOfWeek:"Mon",recipients:"finance@acme.com, ap@acme.com",channels:{email:!0,whatsapp:!1,wechat:!1,sms:!1},formats:{csv:!0,pdf:!0,json:!1},lastRunAt:Date.now()-2*24*60*60*1e3,lastStatus:"Success"}]),[Fe,ke]=d.useState(!1),[fe,Ve]=d.useState(()=>({id:"",name:"",timeRange:"30d",customFrom:new Date(Date.now()-30*24*60*60*1e3).toISOString().slice(0,10),customTo:new Date().toISOString().slice(0,10),dimensionA:"Module",dimensionB:void 0,metric:"Spend",filters:{module:"All",marketplace:"All",group:"All",costCenter:"All",vendor:"All",requester:"All",risk:"All"},createdAt:Date.now()})),[ne,Te]=d.useState(!1),[Ee,Re]=d.useState(()=>({id:"",reportId:"RPT-001",enabled:!0,frequency:"Weekly",hourLocal:9,dayOfWeek:"Mon",dayOfMonth:1,recipients:"finance@acme.com",channels:{email:!0,whatsapp:!0,wechat:!1,sms:!1},formats:{csv:!0,pdf:!0,json:!1}})),ze=d.useMemo(()=>iC(x,g,$),[x,g,$]),qe=i.txs,He=i.approvals,_e=d.useMemo(()=>{const m=Me.trim().toLowerCase();return qe.filter(A=>A.ts>=ze.start&&A.ts<=ze.end).filter(A=>k==="All"?!0:A.module===k).filter(A=>L==="All"?!0:(A.marketplace||"-")===L).filter(A=>U==="All"?!0:A.group===U).filter(A=>ie==="All"?!0:A.costCenter===ie).filter(A=>W==="All"?!0:A.vendor===W).filter(A=>we==="All"?!0:A.requesterName===we).filter(A=>be==="All"?!0:A.risk===be).filter(A=>m?`${A.id} ${A.type} ${A.module} ${A.marketplace||""} ${A.vendor} ${A.requesterName} ${A.group} ${A.costCenter} ${A.risk} ${A.tags.join(" ")}`.toLowerCase().includes(m):!0).slice().sort((A,f)=>f.ts-A.ts)},[qe,ze.start,ze.end,k,L,U,ie,W,we,be,Me]),le=d.useMemo(()=>He.filter(m=>m.requestedAt>=ze.start&&m.requestedAt<=ze.end).filter(m=>k==="All"?!0:m.module===k).filter(m=>L==="All"?!0:(m.marketplace||"-")===L).filter(m=>we==="All"?!0:m.requesterName===we).slice().sort((m,A)=>A.requestedAt-m.requestedAt),[He,ze.start,ze.end,k,L,we]);d.useMemo(()=>_e.reduce((m,A)=>m+(A.approved?A.amountUGX:0),0),[_e]);const z=_e.length,Pe=d.useMemo(()=>_e.filter(m=>m.approved).reduce((m,A)=>m+A.amountUGX,0),[_e]),Be=d.useMemo(()=>_e.filter(m=>!m.approved).reduce((m,A)=>m+A.amountUGX,0),[_e]);d.useMemo(()=>le.filter(m=>m.outcome!=="Auto-approved"&&m.outcome!=="Approved"&&m.outcome!=="Rejected").length,[le]);const xe=d.useMemo(()=>{const m=new Map;return _e.forEach(A=>{const f=A.module,B=m.get(f)||{spend:0,count:0};m.set(f,{spend:B.spend+(A.approved?A.amountUGX:0),count:B.count+1})}),Array.from(m.entries()).map(([A,f])=>({key:A,...f})).sort((A,f)=>f.spend-A.spend)},[_e]),Ne=d.useMemo(()=>{const m=new Map;return _e.forEach(A=>{A.approved&&m.set(A.vendor,(m.get(A.vendor)||0)+A.amountUGX)}),Array.from(m.entries()).map(([A,f])=>({vendor:A,spend:f})).sort((A,f)=>f.spend-A.spend).slice(0,6)},[_e]),M=d.useMemo(()=>{const m=le.map(y=>Math.max(1,Math.round((y.decidedAt-y.requestedAt)/6e4))),A=m.length?Math.round(m.reduce((y,re)=>y+re,0)/m.length):0,f=Math.round(nB(m)),B=le.filter(y=>(y.decidedAt-y.requestedAt)/36e5>y.slaHours).length,p=le.filter(y=>y.outcome==="Auto-approved").length,E=le.filter(y=>y.outcome==="Approved").length,se=le.filter(y=>y.outcome==="Rejected").length;return{avgMins:A,medMins:f,breaches:B,auto:p,approved:E,rejected:se,total:le.length}},[le]),H=d.useMemo(()=>{const m=new Map;return le.forEach(A=>{const f=A.module,B=m.get(f)||{total:0,avgMins:0,ok:0,rejected:0,breach:0},p=Math.max(1,Math.round((A.decidedAt-A.requestedAt)/6e4)),E=B.total+1,se=Math.round((B.avgMins*B.total+p)/E),y=(A.decidedAt-A.requestedAt)/36e5>A.slaHours?1:0;m.set(f,{total:E,avgMins:se,ok:B.ok+(A.outcome==="Approved"||A.outcome==="Auto-approved"?1:0),rejected:B.rejected+(A.outcome==="Rejected"?1:0),breach:B.breach+y})}),Array.from(m.entries()).map(([A,f])=>({module:A,...f,approvalRate:f.total?Math.round(f.ok/f.total*100):100})).sort((A,f)=>f.total-A.total)},[le]),Ae=d.useMemo(()=>{const m=Oe,A=Y==="None"?null:Y,f=new Map;_e.forEach(E=>{const se=ro(E,m),y=f.get(se)||{spend:0,count:0};f.set(se,{spend:y.spend+(E.approved?E.amountUGX:0),count:y.count+1})});const B=Array.from(f.entries()).map(([E,se])=>({key:E,...se,avg:se.count?Math.round(se.spend/se.count):0})).sort((E,se)=>ce==="Transactions"?se.count-E.count:ce==="Avg transaction"?se.avg-E.avg:se.spend-E.spend);let p=null;if(A){const E=new Map;_e.forEach(X=>{if(!X.approved)return;const S=ro(X,A);E.set(S,(E.get(S)||0)+X.amountUGX)});const se=Array.from(E.entries()).sort((X,S)=>S[1]-X[1]).slice(0,6).map(([X])=>X),y=new Map,re=new Map;_e.forEach(X=>{if(!X.approved)return;const S=ro(X,m),w=ro(X,A),h=se.includes(w)?w:"Other",K=y.get(S)||{};K[h]=(K[h]||0)+X.amountUGX,y.set(S,K),re.set(S,(re.get(S)||0)+X.amountUGX)});const ve=[...se,"Other"].filter((X,S,w)=>X!=="Other"?!0:Array.from(y.values()).some(K=>(K.Other||0)>0)),P=Array.from(y.entries()).map(([X,S])=>({rowKey:X,cells:S,total:re.get(X)||0})).sort((X,S)=>S.total-X.total).slice(0,12);p={columns:ve,rows:P}}return{rowsA:B,pivot:p}},[_e,Oe,Y,ce]),oe=d.useMemo(()=>{const A=ze.end,f={start:A-7*864e5,end:A},B={start:A-14*864e5,end:A-7*864e5},p=(w,h)=>w.ts>=h.start&&w.ts<h.end&&w.approved,E=w=>{const h=new Map;return qe.forEach(K=>{p(K,w)&&h.set(K.vendor,(h.get(K.vendor)||0)+K.amountUGX)}),h},se=E(f),y=E(B),re=Array.from(se.entries()).map(([w,h])=>({kind:"Unusual vendor spend",vendor:w,last7:h,prev7:y.get(w)||0})).filter(w=>w.last7>=7e5&&w.prev7>0&&w.last7>w.prev7*2).sort((w,h)=>h.last7-w.last7).slice(0,6),ve=qe.filter(w=>w.approved).filter(w=>{const h=new Date(w.ts).getHours();return h<6||h>22}).filter(w=>w.ts>=ze.start&&w.ts<=ze.end).slice(0,10),P=(()=>{const w=_e.filter(V=>V.approved).reduce((V,Ce)=>V+Ce.amountUGX,0),h=_e.filter(V=>V.approved&&V.risk==="High").reduce((V,Ce)=>V+Ce.amountUGX,0),K=w?Math.round(h/w*100):0;return{spend:w,high:h,pct:K}})(),X=(()=>{const w=_e.filter(K=>K.approved&&K.type==="Charging"),h=w.filter(K=>{const V=new Date(K.ts).getHours();return Dh(V)});return{total:w.length,peak:h.length,pct:w.length?Math.round(h.length/w.length*100):0}})(),S=le.filter(w=>w.amountUGX<=2e5&&w.outcome==="Approved").length;return{vendorSpikes:re,afterHours:ve,highRiskShare:P,chargingPeak:X,lowAmountApprovals:S}},[qe,_e,le,ze.start,ze.end]),De=d.useMemo(()=>{const m=new Map;_e.filter(re=>re.approved).forEach(re=>{const ve=re.module,P=m.get(ve)||{spend:0,vendors:new Map};P.spend+=re.amountUGX,P.vendors.set(re.vendor,(P.vendors.get(re.vendor)||0)+re.amountUGX),m.set(ve,P)});const A=Array.from(m.entries()).map(([re,ve])=>{var w,h;const P=Array.from(ve.vendors.entries()).sort((K,V)=>V[1]-K[1]),X=((w=P[0])==null?void 0:w[1])||0,S=ve.spend?Math.round(X/ve.spend*100):0;return{module:re,totalSpend:ve.spend,vendorCount:P.length,topVendor:((h=P[0])==null?void 0:h[0])||"-",topShare:S}}).filter(re=>re.totalSpend>=15e5&&re.vendorCount>=3&&re.topShare<=70).sort((re,ve)=>ve.totalSpend-re.totalSpend).slice(0,6),f=le.filter(re=>re.outcome==="Approved"&&re.amountUGX<=2e5).length,B=le.length,p=B?Math.round(f/B*100):0,E=_e.filter(re=>re.approved&&re.type==="Charging"),se=E.filter(re=>Dh(new Date(re.ts).getHours())),y=E.length?Math.round(se.length/E.length*100):0;return{vendorConsolidation:A,policy:{smallApprovals:f,totalApprovals:B,smallPct:p},charging:{total:E.length,peak:se.length,peakPct:y}}},[_e,le]),$e=d.useMemo(()=>Array.from(new Set(qe.map(m=>m.costCenter))).sort(),[qe]),ge=d.useMemo(()=>Array.from(new Set(qe.map(m=>m.vendor))).sort(),[qe]),ue=d.useMemo(()=>Array.from(new Set(qe.map(m=>m.requesterName))).sort(),[qe]),Ke=()=>{const m=_e.map(f=>({ts:Em(f.ts),id:f.id,type:f.type,module:f.module,marketplace:f.marketplace||"-",vendor:f.vendor,requester:f.requesterName,group:f.group,costCenter:f.costCenter,amountUGX:f.amountUGX,risk:f.risk,approved:f.approved?"Yes":"No",approvalId:f.approvalId||"-",tags:f.tags.join(";")})),A=nC(m,[{key:"ts",label:"Time"},{key:"id",label:"Transaction ID"},{key:"type",label:"Type"},{key:"module",label:"Module"},{key:"marketplace",label:"Marketplace"},{key:"vendor",label:"Vendor"},{key:"requester",label:"Requester"},{key:"group",label:"Group"},{key:"costCenter",label:"Cost center"},{key:"amountUGX",label:"Amount (UGX)"},{key:"risk",label:"Risk"},{key:"approved",label:"Approved"},{key:"approvalId",label:"Approval ID"},{key:"tags",label:"Tags"}]);Rh("transactions.csv",A,"text/csv"),r({title:"Exported",message:"Transactions CSV downloaded.",kind:"success"})},b=()=>{const m=Ae.rowsA.map(f=>({dimension:f.key,spendUGX:f.spend,transactions:f.count,avgUGX:f.avg})),A=nC(m,[{key:"dimension",label:Oe},{key:"spendUGX",label:"Spend (UGX)"},{key:"transactions",label:"Transactions"},{key:"avgUGX",label:"Avg (UGX)"}]);Rh("report-aggregate.csv",A,"text/csv"),r({title:"Exported",message:"Aggregate CSV downloaded.",kind:"success"})},v=()=>{const m={filters:{timeRange:x,customFrom:g,customTo:$,moduleFilter:k,marketplaceFilter:L,groupFilter:U,costCenterFilter:ie,vendorFilter:W,requesterFilter:we,riskFilter:be,q:Me},totals:{approvedSpend:Pe,rejectedSpend:Be,txCount:z,approvalCount:le.length},transactions:_e,approvals:le,generatedAt:new Date().toISOString()};Rh("report.json",JSON.stringify(m,null,2),"application/json"),r({title:"Exported",message:"JSON downloaded.",kind:"success"})},u=()=>{const m=`
      <html>
        <head>
          <title>CorporatePay Report</title>
          <style>
            body{font-family: ui-sans-serif, system-ui; padding:24px;}
            .muted{color:#64748b;font-size:12px}
            h2{margin:0}
            .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:16px}
            .card{border:1px solid #e2e8f0;border-radius:16px;padding:12px}
            table{width:100%; border-collapse:collapse; margin-top:16px}
            th,td{border:1px solid #e2e8f0; padding:10px; font-size:12px}
            th{background:#f8fafc; text-align:left}
          </style>
        </head>
        <body>
          <h2>CorporatePay Reporting & Analytics</h2>
          <div class="muted">Time range: ${x}${x==="Custom"?` (${g} to ${$})`:""}  Generated: ${new Date().toLocaleString()}</div>
          <div class="grid">
            <div class="card"><div class="muted">Approved spend</div><div style="font-size:20px;font-weight:700">${qs(Pe)}</div></div>
            <div class="card"><div class="muted">Transactions</div><div style="font-size:20px;font-weight:700">${z}</div></div>
            <div class="card"><div class="muted">Approvals</div><div style="font-size:20px;font-weight:700">${le.length}</div></div>
          </div>

          <h3 style="margin-top:18px">Top vendors</h3>
          <table>
            <thead><tr><th>Vendor</th><th>Spend</th></tr></thead>
            <tbody>
              ${Ne.map(f=>`<tr><td>${f.vendor}</td><td>${qs(f.spend)}</td></tr>`).join("")}
            </tbody>
          </table>

          <div class="muted" style="margin-top:18px">Tip: Use browser Print  Save as PDF.</div>
        </body>
      </html>
    `,A=window.open("","_blank");if(!A){r({title:"Popup blocked",message:"Allow popups to export PDF via Print.",kind:"warn"});return}A.document.open(),A.document.write(m),A.document.close(),A.focus(),A.print(),r({title:"Print ready",message:"Use Print to PDF to save.",kind:"info"})},C=d.useMemo(()=>{const m=iC(fe.timeRange,fe.customFrom,fe.customTo),A=fe.filters,f=qe.filter(ve=>ve.ts>=m.start&&ve.ts<=m.end).filter(ve=>A.module&&A.module!=="All"?ve.module===A.module:!0).filter(ve=>A.marketplace&&A.marketplace!=="All"?(ve.marketplace||"-")===A.marketplace:!0).filter(ve=>A.group&&A.group!=="All"?ve.group===A.group:!0).filter(ve=>A.costCenter&&A.costCenter!=="All"?ve.costCenter===A.costCenter:!0).filter(ve=>A.vendor&&A.vendor!=="All"?ve.vendor===A.vendor:!0).filter(ve=>A.requester&&A.requester!=="All"?ve.requesterName===A.requester:!0).filter(ve=>A.risk&&A.risk!=="All"?ve.risk===A.risk:!0).filter(ve=>ve.approved),B=fe.dimensionA,p=fe.dimensionB,E=new Map;f.forEach(ve=>{const P=ro(ve,B),X=E.get(P)||{spend:0,count:0};E.set(P,{spend:X.spend+ve.amountUGX,count:X.count+1})});const se=Array.from(E.entries()).map(([ve,P])=>({key:ve,spend:P.spend,count:P.count,avg:P.count?Math.round(P.spend/P.count):0})).sort((ve,P)=>P.spend-ve.spend).slice(0,12);let y=null;if(p){const ve=new Map;f.forEach(K=>{const V=ro(K,p);ve.set(V,(ve.get(V)||0)+K.amountUGX)});const P=Array.from(ve.entries()).sort((K,V)=>V[1]-K[1]).slice(0,5).map(([K])=>K),X=new Map,S=new Map;f.forEach(K=>{const V=ro(K,B),Ce=ro(K,p),I=P.includes(Ce)?Ce:"Other",te=X.get(V)||{};te[I]=(te[I]||0)+K.amountUGX,X.set(V,te),S.set(V,(S.get(V)||0)+K.amountUGX)});const w=[...P,"Other"].filter(K=>K!=="Other"?!0:Array.from(X.values()).some(V=>(V.Other||0)>0)),h=Array.from(X.entries()).map(([K,V])=>({rowKey:K,cells:V,total:S.get(K)||0})).sort((K,V)=>V.total-K.total).slice(0,10);y={columns:w,rows:h}}const re={spend:f.reduce((ve,P)=>ve+P.amountUGX,0),count:f.length};return{rows:se,pivot:y,totalsAll:re}},[fe,qe]),Q=()=>{if(fe.name.trim().length<3){r({title:"Name required",message:"Enter a report name.",kind:"warn"});return}const m=!fe.id,A=fe.id||hd("RPT"),f={...fe,id:A,createdAt:m?Date.now():fe.createdAt};de(B=>{const p=B.findIndex(se=>se.id===A),E=B.slice();return p>=0?E[p]=f:E.unshift(f),E}),r({title:"Saved",message:"Report saved.",kind:"success"}),ke(!1),c("schedules")},O=()=>{if(!pe.find(B=>B.id===Ee.reportId)){r({title:"Select report",message:"Choose a report to schedule.",kind:"warn"});return}if(Ee.recipients.trim().length<3){r({title:"Recipients required",message:"Enter recipients emails or numbers.",kind:"warn"});return}const A=Ee.id||hd("SCH"),f={...Ee,id:A,enabled:!0};Qe(B=>{const p=B.findIndex(se=>se.id===A),E=B.slice();return p>=0?E[p]=f:E.unshift(f),E}),r({title:"Scheduled",message:"Report schedule saved.",kind:"success"}),Te(!1)},ee=m=>{Qe(A=>A.map(f=>f.id===m?{...f,lastRunAt:Date.now(),lastStatus:Math.random()<.92?"Success":"Failed"}:f)),r({title:"Triggered",message:"Schedule run triggered (demo).",kind:"info"})},F="PDF export uses Print to PDF.";return e.jsxs("div",{className:"min-h-screen bg-slate-50 transition-colors dark:bg-slate-950",children:[e.jsx(lB,{toasts:l,onDismiss:m=>n(A=>A.filter(f=>f.id!==m))}),e.jsx("div",{className:"px-4 py-6 md:px-6 lg:px-8",children:e.jsxs("div",{className:"bg-white transition-colors dark:bg-slate-900",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 transition-colors md:px-6 dark:border-slate-800 dark:bg-slate-900",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:Jx.green},children:e.jsx(Sr,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"Reporting & Analytics"}),e.jsx("div",{className:"mt-1 text-sm text-slate-500 dark:text-slate-400",children:"Spend breakdowns, approvals, anomalies, and scheduled reports"}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(vt,{label:`Approved spend: ${qs(Pe)}`,tone:"good"}),e.jsx(vt,{label:`Rejected: ${qs(Be)}`,tone:Be?"warn":"good"}),e.jsx(vt,{label:`Tx: ${z}`,tone:"neutral"}),e.jsx(vt,{label:`Approvals: ${le.length}`,tone:le.length?"info":"neutral"}),e.jsx(vt,{label:F,tone:"neutral"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ms,{variant:"outline",onClick:Ke,children:[e.jsx(gt,{className:"h-4 w-4"})," Export CSV"]}),e.jsxs(ms,{variant:"outline",onClick:v,children:[e.jsx(gt,{className:"h-4 w-4"})," Export JSON"]}),e.jsxs(ms,{variant:"outline",onClick:u,title:F,children:[e.jsx(wt,{className:"h-4 w-4"})," Export PDF"]}),e.jsxs(ms,{variant:"accent",onClick:()=>{Ve({id:"",name:"",timeRange:x,customFrom:g,customTo:$,dimensionA:"Module",dimensionB:void 0,metric:"Spend",filters:{module:"All",marketplace:"All",group:"All",costCenter:"All",vendor:"All",requester:"All",risk:"All"},createdAt:Date.now()}),ke(!0)},children:[e.jsx(e4,{className:"h-4 w-4"})," Build report"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"overview",label:"Overview"},{id:"spend",label:"Spend explorer"},{id:"approvals",label:"Approvals"},{id:"anomalies",label:"Anomalies"},{id:"savings",label:"Savings"},{id:"builder",label:"Custom builder"},{id:"schedules",label:"Schedules"}].map(m=>e.jsx("button",{className:cn("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",o===m.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:o===m.id?{background:Jx.green}:void 0,onClick:()=>c(m.id),children:m.label},m.id))}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 rounded-2xl border border-slate-200 bg-slate-50 p-4 transition-colors md:grid-cols-12 dark:border-slate-700 dark:bg-slate-800",children:[e.jsx("div",{className:"md:col-span-3",children:e.jsx(Zs,{label:"Time range",value:x,onChange:m=>j(m),options:[{value:"7d",label:"Last 7 days"},{value:"30d",label:"Last 30 days"},{value:"90d",label:"Last 90 days"},{value:"YTD",label:"Year to date"},{value:"Custom",label:"Custom"}]})}),e.jsx("div",{className:cn("md:col-span-2",x!=="Custom"&&"opacity-60"),children:e.jsx(Pc,{label:"From",type:"date",value:g,onChange:N,disabled:x!=="Custom"})}),e.jsx("div",{className:cn("md:col-span-2",x!=="Custom"&&"opacity-60"),children:e.jsx(Pc,{label:"To",type:"date",value:$,onChange:T,disabled:x!=="Custom"})}),e.jsx("div",{className:"md:col-span-3",children:e.jsx(Zs,{label:"Module",value:k,onChange:m=>q(m),options:[{value:"All",label:"All"},...s.map(m=>({value:m,label:m}))]})}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400",children:"Search"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2.5 dark:border-slate-700 dark:bg-slate-800",children:[e.jsx(ka,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:Me,onChange:m=>je(m.target.value),placeholder:"vendor, tag...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400 dark:text-white"}),Me?e.jsx("button",{className:"rounded-xl p-1 text-slate-500 hover:bg-slate-100 dark:hover:bg-slate-700",onClick:()=>je(""),"aria-label":"Clear",children:e.jsx(Ye,{className:"h-4 w-4"})}):null]})]}),e.jsxs("div",{className:"md:col-span-12 grid grid-cols-1 gap-3 md:grid-cols-6",children:[e.jsx(Zs,{label:"Marketplace",value:L,onChange:m=>R(m),options:[{value:"All",label:"All"},...a.map(m=>({value:m,label:m}))],hint:"E-Commerce",disabled:k!=="All"&&k!=="E-Commerce"}),e.jsx(Zs,{label:"Group",value:U,onChange:m=>ae(m),options:[{value:"All",label:"All"},...["Operations","Sales","Finance","Admin","Procurement"].map(m=>({value:m,label:m}))]}),e.jsx(Zs,{label:"Cost center",value:ie,onChange:_,options:[{value:"All",label:"All"},...$e.map(m=>({value:m,label:m}))]}),e.jsx(Zs,{label:"Vendor",value:W,onChange:J,options:[{value:"All",label:"All"},...ge.map(m=>({value:m,label:m}))]}),e.jsx(Zs,{label:"Requester",value:we,onChange:G,options:[{value:"All",label:"All"},...ue.map(m=>({value:m,label:m}))]}),e.jsx(Zs,{label:"Risk",value:be,onChange:m=>Ge(m),options:[{value:"All",label:"All"},{value:"Low",label:"Low"},{value:"Medium",label:"Medium"},{value:"High",label:"High"}]})]}),e.jsxs("div",{className:"md:col-span-12 flex flex-wrap items-center justify-between gap-2",children:[e.jsxs("div",{className:"text-xs text-slate-500",children:["Showing ",e.jsx("span",{className:"font-semibold text-slate-900",children:_e.length})," transactions and ",e.jsx("span",{className:"font-semibold text-slate-900",children:le.length})," approvals in this time range."]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ms,{variant:"outline",onClick:()=>{R("All"),ae("All"),_("All"),J("All"),G("All"),Ge("All"),je(""),r({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(fn,{className:"h-4 w-4"})," Reset"]}),e.jsxs(ms,{variant:"outline",onClick:b,children:[e.jsx(gt,{className:"h-4 w-4"})," Export aggregate"]})]})]})]})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[o==="overview"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsxs(Is,{title:"KPIs",subtitle:"High-level performance and spend signals.",right:e.jsx(vt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-4",children:[e.jsx(qa,{title:"Approved spend",value:qs(Pe),sub:"Within selected range",icon:e.jsx(Sr,{className:"h-5 w-5"}),tone:"good"}),e.jsx(qa,{title:"Transactions",value:`${z}`,sub:"All events",icon:e.jsx(qd,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(qa,{title:"Approvals",value:`${M.total}`,sub:`Avg ${M.avgMins}m  Median ${M.medMins}m`,icon:e.jsx(sl,{className:"h-5 w-5"}),tone:M.breaches?"warn":"good"}),e.jsx(qa,{title:"SLA breaches",value:`${M.breaches}`,sub:"Approval SLA",icon:e.jsx(Mt,{className:"h-5 w-5"}),tone:M.breaches?"bad":"good"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Is,{title:"Spend by module",subtitle:"Top modules by approved spend.",right:e.jsx(vt,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[xe.slice(0,8).map(m=>e.jsx(fb,{label:m.key,value:m.spend,total:Pe,right:qs(m.spend)},m.key)),xe.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-sm text-slate-600",children:"No data."})]})}),e.jsxs(Is,{title:"Top vendors",subtitle:"Where most money goes.",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"space-y-2",children:[Ne.map(m=>e.jsx(fb,{label:m.vendor,value:m.spend,total:Pe,right:qs(m.spend)},m.vendor)),Ne.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-sm text-slate-600",children:"No vendor spend."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: vendor consolidation suggestions appear in Savings."})]})]})]}),e.jsx(Is,{title:"Recent activity",subtitle:"Sample of the most recent transactions.",right:e.jsx(vt,{label:"Core",tone:"neutral"}),children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Module"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Requester"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Risk"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Approved"})]})}),e.jsxs("tbody",{children:[_e.slice(0,10).map(m=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Em(m.ts)}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:m.module}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:m.marketplace?m.marketplace:m.type})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:m.vendor}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:m.requesterName}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:qs(m.amountUGX)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(vt,{label:m.risk,tone:m.risk==="High"?"bad":m.risk==="Medium"?"warn":"good"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(vt,{label:m.approved?"Yes":"No",tone:m.approved?"good":"warn"})})]},m.id)),_e.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No transactions match the filters."})})]})]})})})]}),e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(Is,{title:"Quick exports",subtitle:"CSV, JSON, and Print to PDF.",right:e.jsx(vt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs(ms,{variant:"outline",onClick:Ke,children:[e.jsx(gt,{className:"h-4 w-4"})," Export transactions CSV"]}),e.jsxs(ms,{variant:"outline",onClick:b,children:[e.jsx(gt,{className:"h-4 w-4"})," Export aggregate CSV"]}),e.jsxs(ms,{variant:"outline",onClick:v,children:[e.jsx(gt,{className:"h-4 w-4"})," Export JSON"]}),e.jsxs(ms,{variant:"outline",onClick:u,title:F,children:[e.jsx(wt,{className:"h-4 w-4"})," Export PDF"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Core exports: CSV/PDF/JSON. Premium: scheduled reports in Schedules."})]}),e.jsx(Is,{title:"Premium signals",subtitle:"Anomaly and savings snapshots.",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"High-risk spend"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Share of spend marked High risk."})]}),e.jsx(vt,{label:`${oe.highRiskShare.pct}%`,tone:oe.highRiskShare.pct>=20?"warn":"good"})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:[qs(oe.highRiskShare.high)," / ",qs(oe.highRiskShare.spend)]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Charging peak usage"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Peak hour charging share."})]}),e.jsx(vt,{label:`${oe.chargingPeak.pct}%`,tone:oe.chargingPeak.pct>=40?"warn":"good"})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Peak ",oe.chargingPeak.peak," / Total ",oe.chargingPeak.total]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Vendor consolidation"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Modules with fragmented vendors."})]}),e.jsx(vt,{label:`${De.vendorConsolidation.length}`,tone:De.vendorConsolidation.length?"info":"good"})]}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Open Savings tab for recommendations."})]})]})})]})]}):null,o==="spend"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(Is,{title:"Explorer settings",subtitle:"Choose dimensions and metric.",right:e.jsx(vt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx(Zs,{label:"Primary dimension",value:Oe,onChange:m=>he(m),options:Ue.map(m=>({value:m,label:m}))}),e.jsx(Zs,{label:"Secondary dimension",value:Y,onChange:m=>Ie(m),options:[{value:"None",label:"None"},...Ue.filter(m=>m!==Oe).map(m=>({value:m,label:m}))],hint:"Premium pivot"}),e.jsx(Zs,{label:"Metric",value:ce,onChange:m=>me(m),options:[{value:"Spend",label:"Spend"},{value:"Transactions",label:"Transactions"},{value:"Avg transaction",label:"Avg transaction"}]}),e.jsxs(ms,{variant:"outline",onClick:b,children:[e.jsx(gt,{className:"h-4 w-4"})," Export aggregate"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: add a secondary dimension to create a pivot-style table."})]}),e.jsx(Is,{title:"Top results",subtitle:"Sorted by selected metric.",right:e.jsx(vt,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[Ae.rowsA.slice(0,10).map(m=>{const A=ce==="Transactions"?m.count:ce==="Avg transaction"?m.avg:m.spend,f=ce==="Transactions"?Ae.rowsA.reduce((B,p)=>B+p.count,0):ce==="Avg transaction"?Math.max(...Ae.rowsA.map(B=>B.avg),1):Pe;return e.jsx(fb,{label:m.key,value:A,total:f,right:ce==="Transactions"?`${A}`:qs(A)},m.key)}),Ae.rowsA.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-sm text-slate-600",children:"No data."})]})})]}),e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsx(Is,{title:"Pivot table",subtitle:Ae.pivot?`${Oe} by ${Y}`:"Enable a secondary dimension to show pivot.",right:e.jsx(vt,{label:Ae.pivot?"Premium":"Off",tone:Ae.pivot?"info":"neutral"}),children:Ae.pivot?e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:Oe}),Ae.pivot.columns.map(m=>e.jsx("th",{className:"px-4 py-3 font-semibold",children:m},m)),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Total"})]})}),e.jsx("tbody",{children:Ae.pivot.rows.map(m=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:m.rowKey}),Ae.pivot.columns.map(A=>e.jsx("td",{className:"px-4 py-3 text-slate-700",children:qs(m.cells[A]||0)},`${m.rowKey}-${A}`)),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:qs(m.total)})]},m.rowKey))})]})}):e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"Select a secondary dimension to build a pivot. Example: Module by Vendor."})}),e.jsx(Is,{title:"Raw transactions",subtitle:"Drilldown view.",right:e.jsx(vt,{label:"Core",tone:"neutral"}),children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Type"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Module"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Requester"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Approved"})]})}),e.jsxs("tbody",{children:[_e.slice(0,16).map(m=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Em(m.ts)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:m.type}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[m.module,m.marketplace?`  ${m.marketplace}`:""]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:m.vendor}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:m.requesterName}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:qs(m.amountUGX)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(vt,{label:m.approved?"Yes":"No",tone:m.approved?"good":"warn"})})]},m.id)),_e.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No transactions."})})]})]})})})]})]}):null,o==="approvals"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(Is,{title:"Approval KPIs",subtitle:"Performance reports.",right:e.jsx(vt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx(qa,{title:"Avg cycle time",value:`${M.avgMins}m`,sub:"Mean",icon:e.jsx(sl,{className:"h-5 w-5"}),tone:M.avgMins>180?"warn":"good"}),e.jsx(qa,{title:"Median",value:`${M.medMins}m`,sub:"Median",icon:e.jsx(sl,{className:"h-5 w-5"}),tone:M.medMins>180?"warn":"good"}),e.jsx(qa,{title:"SLA breaches",value:`${M.breaches}`,sub:"Over SLA",icon:e.jsx(Mt,{className:"h-5 w-5"}),tone:M.breaches?"bad":"good"}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Outcomes"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(vt,{label:`Auto: ${M.auto}`,tone:"info"}),e.jsx(vt,{label:`Approved: ${M.approved}`,tone:"good"}),e.jsx(vt,{label:`Rejected: ${M.rejected}`,tone:M.rejected?"warn":"good"})]})]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Core: approval performance reports. Premium: scheduled approvals performance reports via Schedules."})]})}),e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsx(Is,{title:"Approvals by module",subtitle:"Cycle time, approval rate, SLA breaches.",right:e.jsx(vt,{label:"Core",tone:"neutral"}),children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Module"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Total"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Approval rate"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Avg mins"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Rejected"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Breaches"})]})}),e.jsxs("tbody",{children:[H.map(m=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:m.module}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:m.total}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(vt,{label:`${m.approvalRate}%`,tone:m.approvalRate>=90?"good":m.approvalRate>=75?"warn":"bad"})}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[m.avgMins,"m"]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:m.rejected}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(vt,{label:`${m.breach}`,tone:m.breach?"warn":"good"})})]},m.module)),H.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No approvals."})})]})]})})}),e.jsx(Is,{title:"Recent approvals",subtitle:"Audit-friendly list.",right:e.jsx(vt,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[le.slice(0,10).map(m=>{const A=Math.max(1,Math.round((m.decidedAt-m.requestedAt)/6e4)),f=(m.decidedAt-m.requestedAt)/36e5>m.slaHours;return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(vt,{label:m.outcome,tone:m.outcome==="Rejected"?"bad":m.outcome==="Auto-approved"?"info":"good"}),e.jsx(vt,{label:m.module,tone:"neutral"}),m.marketplace?e.jsx(vt,{label:m.marketplace,tone:"neutral"}):null,e.jsx(vt,{label:m.id,tone:"neutral"}),f?e.jsx(vt,{label:"SLA breach",tone:"warn"}):e.jsx(vt,{label:"SLA ok",tone:"good"})]}),e.jsxs("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:[qs(m.amountUGX),"  ",m.requesterName]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Approver: ",m.approver,"  Cycle: ",A,"m  SLA: ",m.slaHours,"h"]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Reason: ",m.reason]})]}),e.jsxs("div",{className:"text-right text-xs text-slate-500",children:["Requested ",lC(m.requestedAt)]})]})},m.id)}),le.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-sm text-slate-600",children:"No approvals in this range."})]})})]})]}):null,o==="anomalies"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(Is,{title:"Anomaly dashboards",subtitle:"Logic-based detection (initial).",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Anomalies are detected using safe, explainable rules. Later you can add ML/AI.",e.jsxs("ul",{className:"mt-2 space-y-1",children:[e.jsx("li",{children:"1) Vendor spike: last 7 days > 2x previous 7 days"}),e.jsx("li",{children:"2) After-hours usage outside policy window"}),e.jsx("li",{children:"3) High-risk share trends"}),e.jsx("li",{children:"4) Charging peak-hour usage"})]})]}),e.jsxs(ms,{variant:"outline",onClick:()=>r({title:"Tip",message:"Use Notifications Center for real-time alert routing.",kind:"info"}),children:[e.jsx(vn,{className:"h-4 w-4"})," Alert routing tip"]})]}),e.jsx(Is,{title:"Quick counters",subtitle:"What needs attention.",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx(qa,{title:"Vendor spikes",value:`${oe.vendorSpikes.length}`,sub:"Last 7d vs previous 7d",icon:e.jsx(ht,{className:"h-5 w-5"}),tone:oe.vendorSpikes.length?"warn":"good"}),e.jsx(qa,{title:"After-hours tx",value:`${oe.afterHours.length}`,sub:"In selected range",icon:e.jsx(Dn,{className:"h-5 w-5"}),tone:oe.afterHours.length?"warn":"good"}),e.jsx(qa,{title:"High-risk share",value:`${oe.highRiskShare.pct}%`,sub:"Of approved spend",icon:e.jsx(Mt,{className:"h-5 w-5"}),tone:oe.highRiskShare.pct>=20?"warn":"good"}),e.jsx(qa,{title:"Charging peak",value:`${oe.chargingPeak.pct}%`,sub:"Peak-hour sessions",icon:e.jsx(sl,{className:"h-5 w-5"}),tone:oe.chargingPeak.pct>=40?"warn":"good"})]})})]}),e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsx(Is,{title:"Unusual vendor spend",subtitle:"Spike detection.",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"space-y-2",children:[oe.vendorSpikes.map(m=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(vt,{label:"Vendor spike",tone:"warn"}),e.jsx(vt,{label:m.vendor,tone:"neutral"})]}),e.jsxs("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:["Last 7d: ",qs(m.last7)]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Previous 7d: ",qs(m.prev7)]}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Why: spend more than 2x week-over-week"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ms,{variant:"outline",onClick:()=>{J(m.vendor),c("spend"),r({title:"Filtered",message:`Showing spend for ${m.vendor}.`,kind:"info"})},children:[e.jsx(et,{className:"h-4 w-4"})," Drill down"]}),e.jsxs(ms,{variant:"outline",onClick:()=>r({title:"Rule",message:"Create rule from this event (demo).",kind:"info"}),children:[e.jsx(wl,{className:"h-4 w-4"})," Create rule"]})]})]})},m.vendor)),oe.vendorSpikes.length?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No vendor spikes detected."})]})}),e.jsx(Is,{title:"After-hours transactions",subtitle:"Outside policy window (6-22).",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Module"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Requester"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Action"})]})}),e.jsxs("tbody",{children:[oe.afterHours.map(m=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Em(m.ts)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:m.module}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:m.vendor}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:m.requesterName}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:qs(m.amountUGX)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(ms,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{G(m.requesterName),c("spend"),r({title:"Filtered",message:`Showing spend for ${m.requesterName}.`,kind:"info"})},children:[e.jsx(et,{className:"h-4 w-4"})," Drill down"]})})]},m.id)),oe.afterHours.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No after-hours activity detected."})})]})]})})})]})]}):null,o==="savings"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(Is,{title:"Savings dashboard",subtitle:"Premium recommendations.",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Savings opportunities are generated from transaction and approvals patterns."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3",children:[e.jsx(qa,{title:"Consolidation opportunities",value:`${De.vendorConsolidation.length}`,sub:"Modules with fragmented vendors",icon:e.jsx(ht,{className:"h-5 w-5"}),tone:De.vendorConsolidation.length?"info":"good"}),e.jsx(qa,{title:"Low-value approvals",value:`${De.policy.smallApprovals}`,sub:`${De.policy.smallPct}% of approvals`,icon:e.jsx(sl,{className:"h-5 w-5"}),tone:De.policy.smallPct>=30?"warn":"good"}),e.jsx(qa,{title:"Charging peak share",value:`${De.charging.peakPct}%`,sub:`${De.charging.peak}/${De.charging.total} charging tx`,icon:e.jsx(Dn,{className:"h-5 w-5"}),tone:De.charging.peakPct>=40?"warn":"good"})]})]}),e.jsx(Is,{title:"Suggested actions",subtitle:"Do the next best thing.",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{title:"Consolidate vendors",detail:"Reduce vendor fragmentation to improve pricing and SLA.",cta:"Open",onClick:()=>r({title:"Next",message:"Start a vendor consolidation project (demo).",kind:"info"})}),e.jsx(D,{title:"Improve policies",detail:"Reduce approvals for low amounts by updating thresholds.",cta:"Open",onClick:()=>r({title:"Next",message:"Open policy simulator (demo).",kind:"info"})}),e.jsx(D,{title:"Shift charging off-peak",detail:"Move charging sessions away from peak tariffs to reduce cost.",cta:"Open",onClick:()=>{q("EVs & Charging"),c("spend"),r({title:"Filtered",message:"Showing EV charging spend.",kind:"info"})}})]})})]}),e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsx(Is,{title:"Vendor consolidation",subtitle:"Vendor consolidation, policy improvements.",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"space-y-2",children:[De.vendorConsolidation.map(m=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(vt,{label:"Consolidation",tone:"info"}),e.jsx(vt,{label:m.module,tone:"neutral"}),e.jsx(vt,{label:`${m.vendorCount} vendors`,tone:"neutral"})]}),e.jsxs("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:["Total spend: ",qs(m.totalSpend)]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Top vendor: ",m.topVendor," (",m.topShare,"% share)"]}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Suggestion: negotiate a preferred vendor set for this module and route non-preferred purchases for approval."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ms,{variant:"outline",onClick:()=>{he("Vendor"),q(m.module),c("spend"),r({title:"Explorer",message:"Exploring vendor mix.",kind:"info"})},children:[e.jsx(et,{className:"h-4 w-4"})," Explore"]}),e.jsxs(ms,{variant:"outline",onClick:()=>r({title:"Created",message:"Vendor consolidation task created (demo).",kind:"success"}),children:[e.jsx(ht,{className:"h-4 w-4"})," Create plan"]})]})]})},m.module)),De.vendorConsolidation.length?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No consolidation opportunities found."})]})}),e.jsx(Is,{title:"Policy improvements",subtitle:"Reduce approval friction.",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Low-value approvals"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Approvals under UGX 200,000."})]}),e.jsx(vt,{label:`${De.policy.smallPct}%`,tone:De.policy.smallPct>=30?"warn":"good"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx(qa,{title:"Small approvals",value:`${De.policy.smallApprovals}`,sub:"Approved",icon:e.jsx(tt,{className:"h-5 w-5"}),tone:"info"}),e.jsx(qa,{title:"Total approvals",value:`${De.policy.totalApprovals}`,sub:"All",icon:e.jsx(sl,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(qa,{title:"Suggestion",value:De.policy.smallPct>=30?"Raise threshold":"OK",sub:"Policy",icon:e.jsx(ht,{className:"h-5 w-5"}),tone:De.policy.smallPct>=30?"warn":"good"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Recommendation: If this is consistently high, raise auto-approval threshold and add guardrails (risk, vendor allowlist) to keep safety."})]})}),e.jsx(Is,{title:"Charging cost optimization",subtitle:"Off-peak scheduling.",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Peak-hour charging"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Share of charging transactions during peak tariff hours."})]}),e.jsx(vt,{label:`${De.charging.peakPct}%`,tone:De.charging.peakPct>=40?"warn":"good"})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Peak ",De.charging.peak," / Total ",De.charging.total]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:"Suggestion: Move non-urgent charging to off-peak windows and batch depot top-ups."})]})})]})]}):null,o==="builder"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsxs(Is,{title:"Custom report builder",subtitle:"Premium: build and save report configurations.",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs(ms,{variant:"primary",onClick:()=>{Ve({id:"",name:"",timeRange:x,customFrom:g,customTo:$,dimensionA:Oe,dimensionB:Y==="None"?void 0:Y,metric:ce,filters:{module:k,marketplace:L,group:U,costCenter:ie,vendor:W,requester:we,risk:be},createdAt:Date.now()}),ke(!0)},children:[e.jsx(e4,{className:"h-4 w-4"})," New report"]}),e.jsxs(ms,{variant:"outline",onClick:()=>{r({title:"Tip",message:"Saved reports can be scheduled for email delivery in Schedules.",kind:"info"})},children:[e.jsx(vn,{className:"h-4 w-4"})," Tip"]})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[pe.map(m=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:m.name}),e.jsx(vt,{label:m.timeRange,tone:"neutral"}),e.jsx(vt,{label:m.metric,tone:"info"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[m.id,"  Created ",lC(m.createdAt)]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Dim: ",m.dimensionA,m.dimensionB?` by ${m.dimensionB}`:""]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(ms,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Ve(JSON.parse(JSON.stringify(m))),ke(!0)},children:[e.jsx(wl,{className:"h-4 w-4"})," Edit"]}),e.jsxs(ms,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Re(A=>({...A,reportId:m.id})),Te(!0)},children:[e.jsx(Xs,{className:"h-4 w-4"})," Schedule"]})]})]})},m.id)),pe.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-sm text-slate-600",children:"No saved reports."})]})]})}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs(Is,{title:"Preview",subtitle:"Preview uses the draft report configuration.",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(qa,{title:"Spend",value:qs(C.totalsAll.spend),sub:"Approved",icon:e.jsx(Sr,{className:"h-5 w-5"}),tone:"good"}),e.jsx(qa,{title:"Transactions",value:`${C.totalsAll.count}`,sub:"Approved",icon:e.jsx(qd,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(qa,{title:"Preview rows",value:`${C.rows.length}`,sub:"Top rows",icon:e.jsx(wt,{className:"h-5 w-5"}),tone:"info"})]}),e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:fe.dimensionA}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Spend"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Tx"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Avg"})]})}),e.jsxs("tbody",{children:[C.rows.map(m=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:m.key}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:qs(m.spend)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:m.count}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:qs(m.avg)})]},m.key)),C.rows.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No data."})})]})]})}),C.pivot?e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Pivot preview"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[fe.dimensionA," by ",fe.dimensionB]})]}),e.jsx(vt,{label:"Premium",tone:"info"})]}),e.jsx("div",{className:"mt-3 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:fe.dimensionA}),C.pivot.columns.map(m=>e.jsx("th",{className:"px-4 py-3 font-semibold",children:m},m)),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Total"})]})}),e.jsx("tbody",{children:C.pivot.rows.map(m=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:m.rowKey}),C.pivot.columns.map(A=>e.jsx("td",{className:"px-4 py-3 text-slate-700",children:qs(m.cells[A]||0)},`${m.rowKey}-${A}`)),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:qs(m.total)})]},m.rowKey))})]})})]}):null]})})]}):null,o==="schedules"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsx(Is,{title:"Saved reports",subtitle:"Pick a report and schedule it.",right:e.jsxs(ms,{variant:"primary",onClick:()=>{var m;Re({id:"",reportId:((m=pe[0])==null?void 0:m.id)||"RPT-001",enabled:!0,frequency:"Weekly",hourLocal:9,dayOfWeek:"Mon",dayOfMonth:1,recipients:"finance@acme.com",channels:{email:!0,whatsapp:!0,wechat:!1,sms:!1},formats:{csv:!0,pdf:!0,json:!1}}),Te(!0)},disabled:!pe.length,children:[e.jsx(Xs,{className:"h-4 w-4"})," New schedule"]}),children:e.jsxs("div",{className:"space-y-2",children:[pe.map(m=>{const A=ye.filter(f=>f.reportId===m.id).length;return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:m.name}),e.jsx(vt,{label:m.metric,tone:"info"}),e.jsx(vt,{label:m.timeRange,tone:"neutral"}),e.jsx(vt,{label:`Schedules: ${A}`,tone:A?"info":"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[m.id,"  ",m.dimensionA,m.dimensionB?` by ${m.dimensionB}`:""]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(ms,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Re(f=>({...f,reportId:m.id,recipients:"finance@acme.com"})),Te(!0)},children:[e.jsx(Xs,{className:"h-4 w-4"})," Schedule"]}),e.jsxs(ms,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{const f={report:m,exportedAt:new Date().toISOString()};Rh(`report-${m.id}.json`,JSON.stringify(f,null,2),"application/json"),r({title:"Exported",message:"Report definition JSON downloaded.",kind:"success"})},children:[e.jsx(gt,{className:"h-4 w-4"})," Definition"]})]})]})},m.id)}),pe.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-sm text-slate-600",children:"No saved reports."})]})})}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs(Is,{title:"Scheduled reports",subtitle:"Email delivery and scheduling.",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"space-y-2",children:[ye.slice().sort((m,A)=>(A.lastRunAt||0)-(m.lastRunAt||0)).map(m=>{const A=pe.find(p=>p.id===m.reportId),f=Object.entries(m.formats).filter(([,p])=>p).map(([p])=>p.toUpperCase()).join(", "),B=Object.entries(m.channels).filter(([,p])=>p).map(([p])=>p).join(", ");return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(vt,{label:m.enabled?"Enabled":"Disabled",tone:m.enabled?"good":"neutral"}),e.jsx(vt,{label:m.frequency,tone:"neutral"}),e.jsx(vt,{label:`${String(m.hourLocal).padStart(2,"0")}:00`,tone:"neutral"}),m.frequency==="Weekly"?e.jsx(vt,{label:m.dayOfWeek||"Mon",tone:"neutral"}):null,m.frequency==="Monthly"?e.jsx(vt,{label:`Day ${m.dayOfMonth||1}`,tone:"neutral"}):null,e.jsx(vt,{label:m.id,tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:(A==null?void 0:A.name)||m.reportId}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Recipients: ",m.recipients]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Channels: ",B||"-","  Formats: ",f||"-"]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Last run: ",m.lastRunAt?`${Em(m.lastRunAt)} (${m.lastStatus})`:"Never"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ms,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Qe(p=>p.map(E=>E.id===m.id?{...E,enabled:!E.enabled}:E)),r({title:"Updated",message:"Schedule updated.",kind:"success"})},children:[e.jsx(wl,{className:"h-4 w-4"})," Toggle"]}),e.jsxs(ms,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ee(m.id),children:[e.jsx(ht,{className:"h-4 w-4"})," Run now"]}),e.jsxs(ms,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Re(JSON.parse(JSON.stringify(m))),Te(!0)},children:[e.jsx(et,{className:"h-4 w-4"})," Edit"]})]})]})},m.id)}),ye.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-sm text-slate-600",children:"No schedules yet."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: scheduled report emails. In production, delivery logs appear in Notifications & Activity Center."})]})})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"V Reporting & Analytics v2. Core: spend breakdowns + approvals performance + CSV/PDF/JSON export. Premium: anomalies, savings dashboard, custom report builder, scheduled report emails."})})]})}),e.jsx(rC,{open:Fe,title:fe.id?"Edit report":"New report",subtitle:"Choose dimensions, metric, time range, and filters.",onClose:()=>ke(!1),actions:[{label:"Save",onClick:Q}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(ms,{variant:"outline",onClick:()=>ke(!1),children:"Cancel"}),e.jsxs(ms,{variant:"primary",onClick:Q,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Pc,{label:"Report name",value:fe.name,onChange:m=>Ve(A=>({...A,name:m})),placeholder:"Example: Spend by vendor"}),e.jsx(Zs,{label:"Metric",value:fe.metric,onChange:m=>Ve(A=>({...A,metric:m})),options:[{value:"Spend",label:"Spend"},{value:"Transactions",label:"Transactions"},{value:"Avg transaction",label:"Avg transaction"}]}),e.jsx(Zs,{label:"Time range",value:fe.timeRange,onChange:m=>Ve(A=>({...A,timeRange:m})),options:[{value:"7d",label:"Last 7 days"},{value:"30d",label:"Last 30 days"},{value:"90d",label:"Last 90 days"},{value:"YTD",label:"Year to date"},{value:"Custom",label:"Custom"}]}),e.jsx("div",{className:cn(fe.timeRange!=="Custom"&&"opacity-60"),children:e.jsx(Pc,{label:"From",type:"date",value:fe.customFrom||"",onChange:m=>Ve(A=>({...A,customFrom:m})),disabled:fe.timeRange!=="Custom"})}),e.jsx("div",{className:cn(fe.timeRange!=="Custom"&&"opacity-60"),children:e.jsx(Pc,{label:"To",type:"date",value:fe.customTo||"",onChange:m=>Ve(A=>({...A,customTo:m})),disabled:fe.timeRange!=="Custom"})}),e.jsx(Zs,{label:"Primary dimension",value:fe.dimensionA,onChange:m=>Ve(A=>({...A,dimensionA:m})),options:Ue.map(m=>({value:m,label:m}))}),e.jsx(Zs,{label:"Secondary dimension",value:fe.dimensionB||"None",onChange:m=>Ve(A=>({...A,dimensionB:m==="None"?void 0:m})),options:[{value:"None",label:"None"},...Ue.filter(m=>m!==fe.dimensionA).map(m=>({value:m,label:m}))],hint:"Premium pivot"}),e.jsxs("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Filters"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(Zs,{label:"Module",value:fe.filters.module||"All",onChange:m=>Ve(A=>({...A,filters:{...A.filters,module:m}})),options:[{value:"All",label:"All"},...s.map(m=>({value:m,label:m}))]}),e.jsx(Zs,{label:"Marketplace",value:fe.filters.marketplace||"All",onChange:m=>Ve(A=>({...A,filters:{...A.filters,marketplace:m}})),options:[{value:"All",label:"All"},...a.map(m=>({value:m,label:m}))],disabled:fe.filters.module!=="All"&&fe.filters.module!=="E-Commerce"}),e.jsx(Zs,{label:"Group",value:fe.filters.group||"All",onChange:m=>Ve(A=>({...A,filters:{...A.filters,group:m}})),options:[{value:"All",label:"All"},...["Operations","Sales","Finance","Admin","Procurement"].map(m=>({value:m,label:m}))]}),e.jsx(Zs,{label:"Risk",value:fe.filters.risk||"All",onChange:m=>Ve(A=>({...A,filters:{...A.filters,risk:m}})),options:[{value:"All",label:"All"},{value:"Low",label:"Low"},{value:"Medium",label:"Medium"},{value:"High",label:"High"}]})]}),e.jsx("div",{className:"mt-3 text-xs text-slate-600",children:"More filters (vendor, requester, cost center) can be added as needed."})]})]})}),e.jsx(rC,{open:ne,title:Ee.id?"Edit schedule":"New schedule",subtitle:"Send scheduled report emails (and other channels) with attachments.",onClose:()=>Te(!1),actions:[{label:"Save schedule",onClick:O}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(ms,{variant:"outline",onClick:()=>Te(!1),children:"Cancel"}),e.jsxs(ms,{variant:"primary",onClick:O,children:[e.jsx(Xs,{className:"h-4 w-4"})," Save schedule"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Zs,{label:"Report",value:Ee.reportId,onChange:m=>Re(A=>({...A,reportId:m})),options:pe.map(m=>({value:m.id,label:m.name}))}),e.jsx(Zs,{label:"Frequency",value:Ee.frequency,onChange:m=>Re(A=>({...A,frequency:m})),options:[{value:"Daily",label:"Daily"},{value:"Weekly",label:"Weekly"},{value:"Monthly",label:"Monthly"}]}),e.jsx(Zs,{label:"Hour",value:`${Ee.hourLocal}`,onChange:m=>Re(A=>({...A,hourLocal:aC(Number(m),0,23)})),options:Array.from({length:24},(m,A)=>({value:`${A}`,label:`${String(A).padStart(2,"0")}:00`}))}),e.jsx(Zs,{label:"Day of week",value:Ee.dayOfWeek||"Mon",onChange:m=>Re(A=>({...A,dayOfWeek:m})),options:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map(m=>({value:m,label:m})),disabled:Ee.frequency!=="Weekly"}),e.jsx(Zs,{label:"Day of month",value:`${Ee.dayOfMonth||1}`,onChange:m=>Re(A=>({...A,dayOfMonth:aC(Number(m),1,28)})),options:Array.from({length:28},(m,A)=>({value:`${A+1}`,label:`${A+1}`})),disabled:Ee.frequency!=="Monthly"}),e.jsx(Pc,{label:"Recipients",value:Ee.recipients,onChange:m=>Re(A=>({...A,recipients:m})),placeholder:"emails and/or phone numbers",hint:"Comma separated"}),e.jsxs("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Channels"}),e.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2 sm:grid-cols-4",children:[{k:"email",label:"Email"},{k:"whatsapp",label:"WhatsApp"},{k:"wechat",label:"WeChat"},{k:"sms",label:"SMS"}].map(m=>e.jsxs("label",{className:"flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-700",children:[e.jsx("input",{type:"checkbox",checked:Ee.channels[m.k],onChange:A=>Re(f=>({...f,channels:{...f.channels,[m.k]:A.target.checked}})),className:"h-4 w-4 rounded border-slate-300"}),m.label]},m.k))}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"Attachments"}),e.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2 sm:grid-cols-3",children:[{k:"csv",label:"CSV"},{k:"pdf",label:"PDF"},{k:"json",label:"JSON"}].map(m=>e.jsxs("label",{className:"flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-700",children:[e.jsx("input",{type:"checkbox",checked:Ee.formats[m.k],onChange:A=>Re(f=>({...f,formats:{...f.formats,[m.k]:A.target.checked}})),className:"h-4 w-4 rounded border-slate-300"}),m.label]},m.k))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: scheduled report emails. Delivery logs show per channel (Email/WhatsApp/WeChat/SMS)."})]})]})})]});function D({title:m,detail:A,cta:f,onClick:B}){return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:m}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:A})]}),e.jsxs(ms,{variant:"outline",className:"px-3 py-2 text-xs",onClick:B,children:[e.jsx(et,{className:"h-4 w-4"})," ",f]})]})})}}const So={green:"#03CD8C",orange:"#F77F00"};function Kl(...t){return t.filter(Boolean).join(" ")}function Ih(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function gr(t,s,a){return Math.max(s,Math.min(a,t))}function oC(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function io(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function Ns(t,s=0){return Number(t||0).toLocaleString(void 0,{maximumFractionDigits:s,minimumFractionDigits:s})}function kn(t){const s=Number(t||0);return s>=1e3?`${Ns(s/1e3,2)} tCO2e`:`${Ns(s,0)} kgCO2e`}function iB(t){let s=t>>>0;return()=>(s=s*1664525+1013904223>>>0,s/4294967296)}function vb(t,s){const a=r=>{const i=String(r??"");return/[",\n]/.test(i)?`"${i.replace(/"/g,'""')}"`:i},l=s.map(r=>a(r.label)).join(","),n=t.map(r=>s.map(i=>a(r[i.key])).join(",")).join(`
`);return`${l}
${n}`}function $h(t,s,a="text/plain"){const l=new Blob([s],{type:a}),n=URL.createObjectURL(l),r=document.createElement("a");r.href=n,r.download=t,r.click(),URL.revokeObjectURL(n)}function oB(t,s,a){const l=new Date,n=l.getTime(),r=new Date(l.getFullYear(),0,1).getTime(),i=24*60*60*1e3;if(t==="7d")return{start:n-7*i,end:n};if(t==="30d")return{start:n-30*i,end:n};if(t==="90d")return{start:n-90*i,end:n};if(t==="YTD")return{start:r,end:n};const o=s?new Date(s).getTime():n-30*i,c=a?new Date(a).getTime()+(24*60*60*1e3-1):n;return{start:Number.isFinite(o)?o:n-30*i,end:Number.isFinite(c)?c:n}}function Ss({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Kl("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Za({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:So.green}:t==="accent"?{background:So.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Kl(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Mm({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:Kl(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:Kl("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function bb({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:Kl(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:Kl("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function jb({label:t,value:s,onChange:a,hint:l,disabled:n,min:r=0,max:i=999999,step:o=.01}){return e.jsxs("div",{className:Kl(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",min:r,max:i,step:o,value:Number.isFinite(s)?s:0,onChange:c=>a(Number(c.target.value||0)),disabled:n,className:Kl("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function dB({actions:t}){const[s,a]=d.useState(!1),l=Xt.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:Kl("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function dC({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="980px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:12,scale:.985},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:12,scale:.985},transition:{duration:.18},className:"fixed inset-x-0 top-[7vh] z-50 mx-auto w-[min(1020px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(dB,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[72vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function cB({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(480px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Kl("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function ol({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function cC({title:t,subtitle:s}){return e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(Ld,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:s})]})}function Wn({title:t,value:s,sub:a,icon:l,tone:n="neutral"}){const r=n==="good"?"bg-emerald-50 text-emerald-700":n==="warn"?"bg-amber-50 text-amber-800":n==="bad"?"bg-rose-50 text-rose-700":n==="info"?"bg-blue-50 text-blue-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:t}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:s}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a})]}),e.jsx("div",{className:Kl("grid h-10 w-10 place-items-center rounded-2xl",r),children:l})]})})}function hi({value:t,label:s}){const a=gr(t,0,100),l=82,n=10,r=(l-n)/2,i=2*Math.PI*r,o=a/100*i;return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:s}),e.jsxs("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:[Math.round(a),"%"]})]}),e.jsxs("div",{className:"relative grid place-items-center",children:[e.jsxs("svg",{width:l,height:l,className:"-rotate-90",children:[e.jsx("circle",{cx:l/2,cy:l/2,r,stroke:"#E2E8F0",strokeWidth:n,fill:"none"}),e.jsx("circle",{cx:l/2,cy:l/2,r,stroke:So.green,strokeWidth:n,fill:"none",strokeDasharray:`${o} ${i}`,strokeLinecap:"round"})]}),e.jsxs("div",{className:"absolute text-sm font-semibold text-slate-900",children:[Math.round(a),"%"]})]})]})})}function uB({label:t,value:s,total:a,right:l}){const n=a>0?Math.round(s/a*100):0;return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:t}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[n,"% share"]})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:l??Ns(s,0)})})]}),e.jsx("div",{className:"mt-3 h-2 w-full overflow-hidden rounded-full bg-slate-100",children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${Math.min(100,n)}%`,background:So.green}})})]})}function uC(t){const s=gr(t,0,100);return s>=85?{label:"A",tone:"good"}:s>=70?{label:"B",tone:"info"}:s>=55?{label:"C",tone:"warn"}:{label:"D",tone:"bad"}}function mB(){const t=["Operations","Sales","Finance","Admin","Procurement"],s=["OPS-001","SALES-TRAVEL","FIN-OPS","ADMIN-001","PROC-001"],[a,l]=d.useState([]),n=ne=>{const Te=Ih("toast");l(Ee=>[{id:Te,...ne},...Ee].slice(0,4)),window.setTimeout(()=>l(Ee=>Ee.filter(Re=>Re.id!==Te)),3200)},[r,i]=d.useState(!0),[o,c]=d.useState("overview"),[x,j]=d.useState("30d"),[g,N]=d.useState(new Date(Date.now()-30*24*60*60*1e3).toISOString().slice(0,10)),[$,T]=d.useState(new Date().toISOString().slice(0,10)),[k,q]=d.useState("All"),[L,R]=d.useState("All"),[U,ae]=d.useState(""),[ie,_]=d.useState({gridKgCO2ePerKWh:.45,iceKgCO2ePerKm:.2,renewableSharePct:0}),[W,J]=d.useState(!1),we=["Internal ESG Template v1","Scorecard Template v1","Mobility Emissions Template v1","Other"],[G,be]=d.useState(!1),[Ge,Me]=d.useState("Internal ESG Template v1"),[je,Ue]=d.useState("CSV"),[Oe,he]=d.useState("ESG Report"),Y=d.useMemo(()=>oB(x,g,$),[x,g,$]),Ie=d.useMemo(()=>{const ne=iB(2026),Te=Date.now(),Ee=24*60*60*1e3,Re=["Mary N.","John S.","Irene K.","Daisy O.","Procurement Desk","Admin Desk"],ze=[],qe=[],He=Be=>Be[Math.floor(ne()*Be.length)],_e=Be=>{const xe=Be.reduce((M,H)=>M+H.w,0);let Ne=ne()*xe;for(const M of Be)if(Ne-=M.w,Ne<=0)return M.item;return Be[Be.length-1].item},le={Operations:["OPS-001"],Sales:["SALES-TRAVEL"],Finance:["FIN-OPS"],Admin:["ADMIN-001"],Procurement:["PROC-001"]},z={Operations:.62,Sales:.44,Finance:.35,Admin:.25,Procurement:.28},Pe=["Kampala HQ","Entebbe Fast Hub","Jinja Road Hub","Other"];for(let Be=0;Be<90;Be++){const xe=Te-Be*Ee;for(const Ne of t){const M=He(le[Ne]),H=1+Math.floor(ne()*4);for(let Ae=0;Ae<H;Ae++){const oe=Math.floor(ne()*24),De=xe+oe*60*60*1e3+Math.floor(ne()*50)*6e4,$e=_e([{item:"Ride",w:1},{item:"Delivery",w:.35},{item:"Commute",w:.55}]),ge=ne()<z[Ne],ue=Math.round((4+ne()*26)*10)/10,Ke=ge?ne()<.07?"Medium":"Low":ne()<.08?"Medium":"Low",b=$e==="Ride"?_e([{item:["Client"],w:1},{item:["Airport"],w:.4},{item:["Commute"],w:.6}]):$e==="Delivery"?["Delivery"]:["Commute"];if(ze.push({id:Ih("MOB"),ts:De,group:Ne,costCenter:M,requester:He(Re),mobilityType:$e,vehicleType:ge?"EV":"ICE",km:ue,module:"Rides & Logistics",tags:b,risk:Ke}),ge&&ne()<.26){const v=_e([{item:"Kampala HQ",w:1.2},{item:"Jinja Road Hub",w:.6},{item:"Entebbe Fast Hub",w:.45},{item:"Other",w:.2}]),u=_e([{item:8,w:.9},{item:18,w:1},{item:Math.floor(ne()*24),w:.8}]),C=xe+u*60*60*1e3+Math.floor(ne()*45)*6e4,Q=!(u>=7&&u<=9)&&!(u>=17&&u<=20),O=Math.round((8+ne()*42)*10)/10,F=Math.round(O*(Q?1050:1350)),D=ne()<.9;qe.push({id:Ih("CHG"),ts:C,group:Ne,costCenter:M,vehicleType:"EV",site:v,kWh:O,costUGX:F,offPeak:Q,hasReceipt:D,module:"EVs & Charging",tags:["Charging",Q?"Off-peak":"Peak"]})}}if(ne()<.14){const Ae=He(Pe),oe=_e([{item:19,w:1},{item:13,w:.6},{item:Math.floor(ne()*24),w:.6}]),De=xe+oe*60*60*1e3+Math.floor(ne()*45)*6e4,$e=!(oe>=7&&oe<=9)&&!(oe>=17&&oe<=20),ge=Math.round((10+ne()*50)*10)/10,Ke=Math.round(ge*($e?1050:1350)),b=ne()<.88;qe.push({id:Ih("CHG"),ts:De,group:Ne,costCenter:M,vehicleType:"EV",site:Ae,kWh:ge,costUGX:Ke,offPeak:$e,hasReceipt:b,module:"EVs & Charging",tags:["Charging",$e?"Off-peak":"Peak"]})}}}return{mobility:ze,charging:qe}},[]),ce=d.useMemo(()=>{if(!r)return[];const ne=U.trim().toLowerCase();return Ie.mobility.filter(Te=>Te.ts>=Y.start&&Te.ts<=Y.end).filter(Te=>k==="All"?!0:Te.group===k).filter(Te=>L==="All"?!0:Te.costCenter===L).filter(Te=>ne?`${Te.requester} ${Te.group} ${Te.costCenter} ${Te.mobilityType} ${Te.vehicleType} ${Te.tags.join(" ")}`.toLowerCase().includes(ne):!0).slice().sort((Te,Ee)=>Ee.ts-Te.ts)},[Ie.mobility,Y.start,Y.end,k,L,U,r]),me=d.useMemo(()=>{if(!r)return[];const ne=U.trim().toLowerCase();return Ie.charging.filter(Te=>Te.ts>=Y.start&&Te.ts<=Y.end).filter(Te=>k==="All"?!0:Te.group===k).filter(Te=>L==="All"?!0:Te.costCenter===L).filter(Te=>ne?`${Te.site} ${Te.group} ${Te.costCenter} ${Te.tags.join(" ")}`.toLowerCase().includes(ne):!0).slice().sort((Te,Ee)=>Ee.ts-Te.ts)},[Ie.charging,Y.start,Y.end,k,L,U,r]),pe=d.useMemo(()=>{const ne=ce.filter(z=>z.vehicleType==="EV").reduce((z,Pe)=>z+Pe.km,0),Te=ce.filter(z=>z.vehicleType==="ICE").reduce((z,Pe)=>z+Pe.km,0),Ee=ne+Te,Re=me.reduce((z,Pe)=>z+Pe.kWh,0),ze=me.reduce((z,Pe)=>z+Pe.costUGX,0),qe=me.length,He=qe?Math.round(me.filter(z=>z.offPeak).length/qe*100):0,_e=qe?Math.round(me.filter(z=>z.hasReceipt).length/qe*100):0,le=Ee?Math.round(ne/Ee*100):0;return{kmEV:ne,kmICE:Te,kmAll:Ee,evSharePct:le,kWh:Re,chargingSpend:ze,sessions:qe,offPeakPct:He,receiptPct:_e}},[ce,me]),de=d.useMemo(()=>{const ne=gr(ie.renewableSharePct,0,100)/100,Te=Math.max(0,ie.gridKgCO2ePerKWh)*(1-ne),Ee=pe.kWh*Te,Re=pe.kmICE*Math.max(0,ie.iceKgCO2ePerKm),ze=pe.kmEV*Math.max(0,ie.iceKgCO2ePerKm),qe=Math.max(0,ze-Ee),He=pe.kmAll>0?(Re+Ee)/pe.kmAll:0,_e=pe.kmEV>0?Ee/pe.kmEV:0;return{effectiveGridFactor:Te,evScope2Kg:Ee,iceKg:Re,avoidedKg:qe,intensityKgPerKm:He,evIntensityKgPerKm:_e,baselineIceForEVkm:ze}},[pe,ie]),ye=d.useMemo(()=>{const ne=pe.evSharePct,Te=pe.offPeakPct,Ee=pe.receiptPct,Re=gr(ie.renewableSharePct,0,100),ze=de.intensityKgPerKm,qe=gr(100-ze*300,0,100),He=Math.round(ne*.28+Te*.18+Re*.18+Ee*.18+qe*.18);return{adoptionScore:ne,offPeakScore:Te,renewableScore:Re,dataQualityScore:Ee,intensityScore:qe,overall:He}},[pe.evSharePct,pe.offPeakPct,pe.receiptPct,ie.renewableSharePct,de.intensityKgPerKm]),Qe=d.useMemo(()=>{const ne=new Map;for(const Ee of t)ne.set(Ee,{kmEV:0,kmICE:0,kWh:0,spend:0});ce.forEach(Ee=>{const Re=ne.get(Ee.group)||{kmEV:0,kmICE:0,kWh:0,spend:0};Ee.vehicleType==="EV"?Re.kmEV+=Ee.km:Re.kmICE+=Ee.km,ne.set(Ee.group,Re)}),me.forEach(Ee=>{const Re=ne.get(Ee.group)||{kmEV:0,kmICE:0,kWh:0,spend:0};Re.kWh+=Ee.kWh,Re.spend+=Ee.costUGX,ne.set(Ee.group,Re)});const Te=Array.from(ne.entries()).map(([Ee,Re])=>({group:Ee,...Re,kmAll:Re.kmEV+Re.kmICE}));return Te.sort((Ee,Re)=>Re.kmAll-Ee.kmAll),Te},[ce,me]),Fe=d.useMemo(()=>{const ne=new Map;return["Kampala HQ","Entebbe Fast Hub","Jinja Road Hub","Other"].forEach(Ee=>ne.set(Ee,{sessions:0,kWh:0,spend:0,offPeak:0})),me.forEach(Ee=>{const Re=ne.get(Ee.site)||{sessions:0,kWh:0,spend:0,offPeak:0};Re.sessions+=1,Re.kWh+=Ee.kWh,Re.spend+=Ee.costUGX,Re.offPeak+=Ee.offPeak?1:0,ne.set(Ee.site,Re)}),Array.from(ne.entries()).map(([Ee,Re])=>({site:Ee,...Re,offPeakPct:Re.sessions?Math.round(Re.offPeak/Re.sessions*100):0})).sort((Ee,Re)=>Re.kWh-Ee.kWh)},[me]),ke=()=>{const ne={name:Oe.trim()||"ESG Report",generatedAt:new Date().toISOString(),timeRange:x,customFrom:x==="Custom"?g:void 0,customTo:x==="Custom"?$:void 0,filters:{group:k,costCenter:L,query:U||void 0},factors:ie},Te={meta:ne,core:{evKm:pe.kmEV,iceKm:pe.kmICE,totalKm:pe.kmAll,evSharePct:pe.evSharePct,chargingKWh:pe.kWh,chargingSpendUGX:pe.chargingSpend,chargingSessions:pe.sessions,chargingOffPeakPct:pe.offPeakPct,receiptCoveragePct:pe.receiptPct},emissions:{effectiveGridKgCO2ePerKWh:de.effectiveGridFactor,evScope2KgCO2e:de.evScope2Kg,iceKgCO2e:de.iceKg,avoidedKgCO2e:de.avoidedKg,intensityKgCO2ePerKm:de.intensityKgPerKm},scorecards:{overall:ye.overall,adoption:ye.adoptionScore,offPeak:ye.offPeakScore,renewable:ye.renewableScore,dataQuality:ye.dataQualityScore,intensity:ye.intensityScore}};if(je==="JSON"){const ze={templateId:Ge,...Te,breakdowns:{byGroup:Qe,chargingBySite:Fe}};$h(`${Oe||"esg"}.json`,JSON.stringify(ze,null,2),"application/json"),n({title:"Exported",message:"JSON downloaded.",kind:"success"}),be(!1);return}if(je==="CSV"){if(Ge==="Scorecard Template v1"){const He=[{reportName:ne.name,generatedAt:ne.generatedAt,timeRange:ne.timeRange,group:ne.filters.group,costCenter:ne.filters.costCenter,overallScore:ye.overall,adoptionScore:ye.adoptionScore,offPeakScore:ye.offPeakScore,renewableScore:ye.renewableScore,dataQualityScore:ye.dataQualityScore,intensityScore:ye.intensityScore}],_e=vb(He,[{key:"reportName",label:"report_name"},{key:"generatedAt",label:"generated_at"},{key:"timeRange",label:"time_range"},{key:"group",label:"group"},{key:"costCenter",label:"cost_center"},{key:"overallScore",label:"overall_score"},{key:"adoptionScore",label:"adoption_score"},{key:"offPeakScore",label:"offpeak_score"},{key:"renewableScore",label:"renewable_score"},{key:"dataQualityScore",label:"data_quality_score"},{key:"intensityScore",label:"intensity_score"}]);$h(`${Oe||"esg"}-scorecard.csv`,_e,"text/csv"),n({title:"Exported",message:"CSV downloaded.",kind:"success"}),be(!1);return}if(Ge==="Mobility Emissions Template v1"){const He=Qe.map(le=>{const z=le.kmAll,Pe=z?Math.round(le.kmEV/z*100):0;return{reportName:ne.name,group:le.group,evKm:Math.round(le.kmEV*10)/10,iceKm:Math.round(le.kmICE*10)/10,totalKm:Math.round(z*10)/10,evSharePct:Pe,chargingKWh:Math.round(le.kWh*10)/10,chargingSpendUGX:Math.round(le.spend),gridKgCO2ePerKWh:de.effectiveGridFactor,iceKgCO2ePerKm:ie.iceKgCO2ePerKm}}),_e=vb(He,[{key:"reportName",label:"report_name"},{key:"group",label:"group"},{key:"evKm",label:"ev_km"},{key:"iceKm",label:"ice_km"},{key:"totalKm",label:"total_km"},{key:"evSharePct",label:"ev_share_pct"},{key:"chargingKWh",label:"charging_kwh"},{key:"chargingSpendUGX",label:"charging_spend_ugx"},{key:"gridKgCO2ePerKWh",label:"grid_kgco2e_per_kwh"},{key:"iceKgCO2ePerKm",label:"ice_kgco2e_per_km"}]);$h(`${Oe||"esg"}-mobility.csv`,_e,"text/csv"),n({title:"Exported",message:"CSV downloaded.",kind:"success"}),be(!1);return}const ze=[{reportName:ne.name,generatedAt:ne.generatedAt,timeRange:ne.timeRange,group:ne.filters.group,costCenter:ne.filters.costCenter,evKm:Math.round(pe.kmEV*10)/10,iceKm:Math.round(pe.kmICE*10)/10,totalKm:Math.round(pe.kmAll*10)/10,evSharePct:pe.evSharePct,chargingKWh:Math.round(pe.kWh*10)/10,chargingSpendUGX:Math.round(pe.chargingSpend),chargingSessions:pe.sessions,offPeakPct:pe.offPeakPct,receiptCoveragePct:pe.receiptPct,evScope2KgCO2e:Math.round(de.evScope2Kg),iceKgCO2e:Math.round(de.iceKg),avoidedKgCO2e:Math.round(de.avoidedKg),overallScore:ye.overall}],qe=vb(ze,[{key:"reportName",label:"report_name"},{key:"generatedAt",label:"generated_at"},{key:"timeRange",label:"time_range"},{key:"group",label:"group"},{key:"costCenter",label:"cost_center"},{key:"evKm",label:"ev_km"},{key:"iceKm",label:"ice_km"},{key:"totalKm",label:"total_km"},{key:"evSharePct",label:"ev_share_pct"},{key:"chargingKWh",label:"charging_kwh"},{key:"chargingSpendUGX",label:"charging_spend_ugx"},{key:"chargingSessions",label:"charging_sessions"},{key:"offPeakPct",label:"charging_offpeak_pct"},{key:"receiptCoveragePct",label:"receipt_coverage_pct"},{key:"evScope2KgCO2e",label:"ev_scope2_kgco2e"},{key:"iceKgCO2e",label:"ice_kgco2e"},{key:"avoidedKgCO2e",label:"avoided_kgco2e"},{key:"overallScore",label:"sustainability_score"}]);$h(`${Oe||"esg"}-internal.csv`,qe,"text/csv"),n({title:"Exported",message:"CSV downloaded.",kind:"success"}),be(!1);return}const Ee=`
      <html>
        <head>
          <title>${ne.name}</title>
          <style>
            body{font-family: ui-sans-serif, system-ui; padding:24px;}
            .muted{color:#64748b;font-size:12px}
            h2{margin:0}
            .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:16px}
            .card{border:1px solid #e2e8f0;border-radius:16px;padding:12px}
            table{width:100%; border-collapse:collapse; margin-top:16px}
            th,td{border:1px solid #e2e8f0; padding:10px; font-size:12px}
            th{background:#f8fafc; text-align:left}
          </style>
        </head>
        <body>
          <h2>${ne.name}</h2>
          <div class="muted">Generated: ${new Date().toLocaleString()}  Time range: ${x}${x==="Custom"?` (${g} to ${$})`:""}</div>
          <div class="muted">Filters: Group ${k}  Cost center ${L}</div>

          <div class="grid">
            <div class="card"><div class="muted">EV share</div><div style="font-size:20px;font-weight:700">${pe.evSharePct}%</div></div>
            <div class="card"><div class="muted">Charging kWh</div><div style="font-size:20px;font-weight:700">${Math.round(pe.kWh)}</div></div>
            <div class="card"><div class="muted">Avoided emissions</div><div style="font-size:20px;font-weight:700">${kn(de.avoidedKg)}</div></div>
          </div>

          <h3 style="margin-top:18px">Core metrics</h3>
          <table>
            <thead><tr><th>Metric</th><th>Value</th></tr></thead>
            <tbody>
              <tr><td>Total km</td><td>${Math.round(pe.kmAll)}</td></tr>
              <tr><td>EV km</td><td>${Math.round(pe.kmEV)}</td></tr>
              <tr><td>ICE km</td><td>${Math.round(pe.kmICE)}</td></tr>
              <tr><td>Charging spend</td><td>${io(pe.chargingSpend)}</td></tr>
              <tr><td>EV Scope 2 emissions</td><td>${kn(de.evScope2Kg)}</td></tr>
              <tr><td>ICE emissions</td><td>${kn(de.iceKg)}</td></tr>
              <tr><td>Sustainability score</td><td>${ye.overall}</td></tr>
            </tbody>
          </table>

          <div class="muted" style="margin-top:16px">Note: emission factors are organization-configurable. This export uses your current factor settings.</div>
          <div class="muted" style="margin-top:8px">Use browser Print and select Save as PDF.</div>
        </body>
      </html>
    `,Re=window.open("","_blank");if(!Re){n({title:"Popup blocked",message:"Allow popups to export PDF via Print.",kind:"warn"});return}Re.document.open(),Re.document.write(Ee),Re.document.close(),Re.focus(),Re.print(),n({title:"Print ready",message:"Use Print to PDF to save.",kind:"info"}),be(!1)},fe=async()=>{const ne={templateId:Ge,fields:{ev_km:"number",ice_km:"number",charging_kwh:"number",charging_spend_ugx:"number",ev_scope2_kgco2e:"number",avoided_kgco2e:"number",sustainability_score:"0-100"},notes:"Align these keys to your internal ESG format templates."};try{await navigator.clipboard.writeText(JSON.stringify(ne,null,2)),n({title:"Copied",message:"Template example copied.",kind:"success"})}catch{n({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},Ve=uC(ye.overall);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(cB,{toasts:a,onDismiss:ne=>l(Te=>Te.filter(Ee=>Ee.id!==ne))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:So.green},children:e.jsx(Ld,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Sustainability and ESG Reporting"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"EV usage, charging utilization and spend, emissions estimates, and ESG scorecards with export templates."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(Ss,{label:`EV share ${pe.evSharePct}%`,tone:pe.evSharePct>=50?"good":pe.evSharePct>=30?"info":"warn"}),e.jsx(Ss,{label:`Charging ${Math.round(pe.kWh)} kWh`,tone:"neutral"}),e.jsx(Ss,{label:`Charging spend ${io(pe.chargingSpend)}`,tone:"neutral"}),e.jsx(Ss,{label:`Avoided ${kn(de.avoidedKg)}`,tone:de.avoidedKg>0?"good":"neutral"}),e.jsx(Ss,{label:`Score ${ye.overall} (${Ve.label})`,tone:Ve.tone})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Za,{variant:"outline",onClick:()=>J(!0),children:[e.jsx(wl,{className:"h-4 w-4"})," Factors"]}),e.jsxs(Za,{variant:"outline",onClick:()=>be(!0),children:[e.jsx(gt,{className:"h-4 w-4"})," Export"]}),e.jsxs(Za,{variant:"primary",onClick:()=>i(ne=>!ne),children:[e.jsx(ct,{className:"h-4 w-4"})," ",r?"Tracking on":"Tracking off"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"overview",label:"Overview"},{id:"ev-usage",label:"EV usage"},{id:"charging",label:"Charging"},{id:"emissions",label:"Emissions"},{id:"scorecards",label:"Scorecards"},{id:"templates",label:"Templates"}].map(ne=>e.jsx("button",{className:Kl("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",o===ne.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:o===ne.id?{background:So.green}:void 0,onClick:()=>c(ne.id),children:ne.label},ne.id))}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 rounded-3xl border border-slate-200 bg-white p-4 md:grid-cols-12",children:[e.jsx("div",{className:"md:col-span-3",children:e.jsx(Mm,{label:"Time range",value:x,onChange:ne=>j(ne),options:[{value:"7d",label:"Last 7 days"},{value:"30d",label:"Last 30 days"},{value:"90d",label:"Last 90 days"},{value:"YTD",label:"Year to date"},{value:"Custom",label:"Custom"}]})}),e.jsx("div",{className:Kl("md:col-span-2",x!=="Custom"&&"opacity-60"),children:e.jsx(bb,{label:"From",type:"date",value:g,onChange:N,disabled:x!=="Custom"})}),e.jsx("div",{className:Kl("md:col-span-2",x!=="Custom"&&"opacity-60"),children:e.jsx(bb,{label:"To",type:"date",value:$,onChange:T,disabled:x!=="Custom"})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Mm,{label:"Group",value:k,onChange:ne=>q(ne),options:[{value:"All",label:"All"},...t.map(ne=>({value:ne,label:ne}))]})}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2.5",children:[e.jsx(ka,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:U,onChange:ne=>ae(ne.target.value),placeholder:"site, requester, tag...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"}),U?e.jsx("button",{className:"rounded-xl p-1 text-slate-500 hover:bg-slate-100",onClick:()=>ae(""),"aria-label":"Clear",children:e.jsx(Ye,{className:"h-4 w-4"})}):null]})]}),e.jsxs("div",{className:"md:col-span-12 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx(Mm,{label:"Cost center",value:L,onChange:R,options:[{value:"All",label:"All"},...s.map(ne=>({value:ne,label:ne}))]}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:"Note: emission factors are defaults for demo. Update Factors to match your internal ESG standards."})]}),e.jsxs("div",{className:"md:col-span-12 flex flex-wrap items-center justify-between gap-2",children:[e.jsxs("div",{className:"text-xs text-slate-500",children:["Showing ",e.jsx("span",{className:"font-semibold text-slate-900",children:ce.length})," mobility event(s) and ",e.jsx("span",{className:"font-semibold text-slate-900",children:me.length})," charging session(s)."]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Za,{variant:"outline",onClick:()=>{q("All"),R("All"),ae(""),n({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(fn,{className:"h-4 w-4"})," Reset"]}),e.jsxs(Za,{variant:"outline",onClick:()=>be(!0),children:[e.jsx(gt,{className:"h-4 w-4"})," Export"]})]})]})]})]}),e.jsx("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:r?o==="overview"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsxs(ol,{title:"Core ESG metrics",subtitle:"Core: EV usage metrics plus charging spend and utilization.",right:e.jsx(Ss,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-4",children:[e.jsx(Wn,{title:"EV share",value:`${pe.evSharePct}%`,sub:`${Ns(pe.kmEV,0)} km EV`,icon:e.jsx(Ld,{className:"h-5 w-5"}),tone:pe.evSharePct>=50?"good":pe.evSharePct>=30?"info":"warn"}),e.jsx(Wn,{title:"Charging kWh",value:`${Ns(pe.kWh,0)}`,sub:`${pe.sessions} sessions`,icon:e.jsx(jv,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(Wn,{title:"Charging spend",value:io(pe.chargingSpend),sub:`Off-peak ${pe.offPeakPct}%`,icon:e.jsx(Xx,{className:"h-5 w-5"}),tone:pe.offPeakPct>=60?"good":"warn"}),e.jsx(Wn,{title:"Avoided emissions",value:kn(de.avoidedKg),sub:`Intensity ${Ns(de.intensityKgPerKm,3)} kg/km`,icon:e.jsx(ht,{className:"h-5 w-5"}),tone:de.avoidedKg>0?"good":"neutral"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(ol,{title:"Mobility breakdown by group",subtitle:"EV km and ICE km",right:e.jsx(Ss,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[Qe.map(ne=>{const Te=ne.kmAll,Ee=Te?Math.round(ne.kmEV/Te*100):0;return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:ne.group}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["EV share ",Ee,"%"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:[Ns(Te,0)," km"]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["EV ",Ns(ne.kmEV,0),"  ICE ",Ns(ne.kmICE,0)]})]})]}),e.jsx("div",{className:"mt-3 h-2 w-full overflow-hidden rounded-full bg-slate-100",children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${Math.min(100,Ee)}%`,background:So.green}})})]},ne.group)}),Qe.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-sm text-slate-600",children:"No group data."})]})}),e.jsx(ol,{title:"Charging utilization by site",subtitle:"kWh, spend, off-peak",right:e.jsx(Ss,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[Fe.map(ne=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:ne.site}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Sessions ",ne.sessions,"  Off-peak ",ne.offPeakPct,"%"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:[Ns(ne.kWh,0)," kWh"]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Spend ",io(ne.spend)]})]})]}),e.jsx("div",{className:"mt-3 h-2 w-full overflow-hidden rounded-full bg-slate-100",children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${Math.min(100,ne.offPeakPct)}%`,background:So.green}})})]},ne.site)),Fe.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-sm text-slate-600",children:"No charging data."})]})})]})]}),e.jsxs(ol,{title:"Data quality",subtitle:"Premium: receipt coverage and audit readiness.",right:e.jsx(Ss,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(hi,{value:pe.receiptPct,label:"Receipt coverage"}),e.jsx(hi,{value:pe.offPeakPct,label:"Off-peak share"}),e.jsx(hi,{value:ye.overall,label:"Sustainability score"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: integrate receipt coverage into your audit controls and dispute workflows."})]})]}),e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(ol,{title:"Quick actions",subtitle:"Exports and configuration.",right:e.jsx(Ss,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs(Za,{variant:"outline",onClick:()=>be(!0),children:[e.jsx(gt,{className:"h-4 w-4"})," Export ESG"]}),e.jsxs(Za,{variant:"outline",onClick:()=>J(!0),children:[e.jsx(wl,{className:"h-4 w-4"})," Edit factors"]}),e.jsxs(Za,{variant:"outline",onClick:fe,children:[e.jsx(ls,{className:"h-4 w-4"})," Copy template keys"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: schedule delivery using the Scheduling section in Reporting & Analytics (V)."})]}),e.jsx(ol,{title:"Core notes",subtitle:"What is included.",right:e.jsx(Ss,{label:"Core",tone:"neutral"}),children:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"1) EV usage metrics computed from mobility events"}),e.jsx("li",{children:"2) Charging spend and utilization from EVs & Charging sessions"}),e.jsx("li",{children:"3) Emissions estimates depend on configured factors"})]})})}),e.jsx(ol,{title:"Premium notes",subtitle:"Scorecards and templates.",right:e.jsx(Ss,{label:"Premium",tone:"info"}),children:e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium includes scorecards, anomaly signals, and exports aligned to internal ESG templates."})})]})]}):o==="ev-usage"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(ol,{title:"EV usage summary",subtitle:"Core: EV usage metrics.",right:e.jsx(Ss,{label:"Core",tone:"neutral"}),children:[e.jsx(Wn,{title:"Total km",value:Ns(pe.kmAll,0),sub:`EV ${Ns(pe.kmEV,0)}  ICE ${Ns(pe.kmICE,0)}`,icon:e.jsx(qd,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(Wn,{title:"EV share",value:`${pe.evSharePct}%`,sub:"EV km over total km",icon:e.jsx(Ld,{className:"h-5 w-5"}),tone:pe.evSharePct>=50?"good":pe.evSharePct>=30?"info":"warn"}),e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:"Best practice: enforce purpose tags and cost centers on mobility transactions so ESG reporting is auditable."})]})}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsx(ol,{title:"Mobility events",subtitle:"Drilldown list",right:e.jsx(Ss,{label:`${ce.length}`,tone:"neutral"}),children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Cost center"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Type"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vehicle"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"km"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Requester"})]})}),e.jsxs("tbody",{children:[ce.slice(0,18).map(ne=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:oC(ne.ts)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:ne.group}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:ne.costCenter}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:ne.mobilityType}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Ss,{label:ne.vehicleType,tone:ne.vehicleType==="EV"?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Ns(ne.km,1)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:ne.requester})]},ne.id)),ce.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No mobility events."})})]})]})})})})]}):o==="charging"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(ol,{title:"Charging metrics",subtitle:"Core: spend and utilization.",right:e.jsx(Ss,{label:"Core",tone:"neutral"}),children:[e.jsx(Wn,{title:"Sessions",value:`${pe.sessions}`,sub:`Off-peak ${pe.offPeakPct}%`,icon:e.jsx(jv,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(Wn,{title:"kWh",value:Ns(pe.kWh,0),sub:`Avg ${pe.sessions?Ns(pe.kWh/pe.sessions,1):"0"} kWh/session`,icon:e.jsx(Xx,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(Wn,{title:"Spend",value:io(pe.chargingSpend),sub:`Receipt coverage ${pe.receiptPct}%`,icon:e.jsx(wt,{className:"h-5 w-5"}),tone:pe.receiptPct>=85?"good":"warn"}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Tip: Shift non-urgent charging to off-peak windows to reduce costs."})]}),e.jsx(ol,{title:"Site utilization",subtitle:"kWh by site",right:e.jsx(Ss,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[Fe.map(ne=>e.jsx(uB,{label:ne.site,value:ne.kWh,total:Math.max(1,pe.kWh),right:`${Ns(ne.kWh,0)} kWh`},ne.site)),Fe.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-sm text-slate-600",children:"No charging data."})]})})]}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsx(ol,{title:"Charging sessions",subtitle:"Drilldown list",right:e.jsx(Ss,{label:`${me.length}`,tone:"neutral"}),children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Site"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"kWh"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Spend"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Off-peak"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Receipt"})]})}),e.jsxs("tbody",{children:[me.slice(0,18).map(ne=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:oC(ne.ts)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:ne.site}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:ne.group}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Ns(ne.kWh,1)}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:io(ne.costUGX)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Ss,{label:ne.offPeak?"Yes":"No",tone:ne.offPeak?"good":"warn"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Ss,{label:ne.hasReceipt?"Yes":"No",tone:ne.hasReceipt?"good":"warn"})})]},ne.id)),me.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No sessions."})})]})]})})})})]}):o==="emissions"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(ol,{title:"Emissions",subtitle:"Premium: estimates and scorecards.",right:e.jsx(Ss,{label:"Premium",tone:"info"}),children:[e.jsx(Wn,{title:"EV Scope 2",value:kn(de.evScope2Kg),sub:`Grid factor ${Ns(de.effectiveGridFactor,3)} kg/kWh`,icon:e.jsx(jv,{className:"h-5 w-5"}),tone:"info"}),e.jsx(Wn,{title:"ICE emissions",value:kn(de.iceKg),sub:`ICE factor ${Ns(ie.iceKgCO2ePerKm,3)} kg/km`,icon:e.jsx(qd,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(Wn,{title:"Avoided",value:kn(de.avoidedKg),sub:"If EV km would otherwise be ICE",icon:e.jsx(ht,{className:"h-5 w-5"}),tone:de.avoidedKg>0?"good":"neutral"}),e.jsxs(Za,{variant:"outline",onClick:()=>J(!0),children:[e.jsx(wl,{className:"h-4 w-4"})," Edit factors"]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Factors are organization-configurable. Align to your internal ESG standards."})]})}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs(ol,{title:"Emissions table",subtitle:"Key values used in exports",right:e.jsx(Ss,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Metric"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Value"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Notes"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:"EV kWh"}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[Ns(pe.kWh,1)," kWh"]}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:"From EVs & Charging sessions"})]}),e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:"Effective grid factor"}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[Ns(de.effectiveGridFactor,3)," kgCO2e/kWh"]}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:"Grid factor adjusted for renewable share"})]}),e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:"EV Scope 2 emissions"}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:kn(de.evScope2Kg)}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:"kWh multiplied by effective grid factor"})]}),e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:"ICE emissions"}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:kn(de.iceKg)}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:"ICE km multiplied by ICE factor"})]}),e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:"Avoided emissions"}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:kn(de.avoidedKg)}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:"Baseline ICE for EV km minus EV Scope 2"})]}),e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:"Overall intensity"}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[Ns(de.intensityKgPerKm,3)," kgCO2e/km"]}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:"(ICE + EV Scope 2) divided by total km"})]})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: export these values in templates aligned to your internal ESG formats."})]})})]}):o==="scorecards"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsxs(ol,{title:"Sustainability scorecards",subtitle:"Premium: scorecards and grades.",right:e.jsx(Ss,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(hi,{value:ye.overall,label:"Overall"}),e.jsx(hi,{value:ye.adoptionScore,label:"EV adoption"}),e.jsx(hi,{value:ye.offPeakScore,label:"Off-peak charging"}),e.jsx(hi,{value:ye.renewableScore,label:"Renewable share"}),e.jsx(hi,{value:ye.dataQualityScore,label:"Data quality"}),e.jsx(hi,{value:ye.intensityScore,label:"Emissions intensity"})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Overall grade: ",e.jsx("span",{className:"font-semibold",children:Ve.label}),". Weights are explainable and can be customized to your ESG framework."]})]})}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs(ol,{title:"Scorecard detail",subtitle:"How the score is computed",right:e.jsx(Ss,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Dimension"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Score"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Meaning"})]})}),e.jsx("tbody",{children:[{k:"EV adoption",v:ye.adoptionScore,d:"EV km share of total mobility"},{k:"Off-peak charging",v:ye.offPeakScore,d:"Off-peak sessions share"},{k:"Renewable share",v:ye.renewableScore,d:"Renewable electricity share used to adjust Scope 2"},{k:"Data quality",v:ye.dataQualityScore,d:"Receipt coverage in charging logs"},{k:"Emissions intensity",v:ye.intensityScore,d:"Lower kgCO2e per km is better"}].map(ne=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:ne.k}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Ss,{label:`${Math.round(ne.v)}`,tone:uC(ne.v).tone})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:ne.d})]},ne.k))})]})}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Za,{variant:"outline",onClick:()=>be(!0),children:[e.jsx(gt,{className:"h-4 w-4"})," Export scorecard"]}),e.jsxs(Za,{variant:"outline",onClick:fe,children:[e.jsx(ls,{className:"h-4 w-4"})," Copy template keys"]})]})]})})]}):o==="templates"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsxs(ol,{title:"ESG template library",subtitle:"Premium: exports aligned to internal format templates.",right:e.jsx(Ss,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"space-y-2",children:we.map(ne=>e.jsx("button",{type:"button",className:Kl("w-full rounded-3xl border bg-white p-4 text-left hover:bg-slate-50",Ge===ne?"border-emerald-300 ring-4 ring-emerald-100":"border-slate-200"),onClick:()=>Me(ne),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:ne}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:ne==="Internal ESG Template v1"?"Summary for internal ESG packs":ne==="Scorecard Template v1"?"Scorecards and ratings":ne==="Mobility Emissions Template v1"?"Mobility and emissions by group":"Custom mapping slot"})]}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]})},ne))}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Za,{variant:"primary",onClick:()=>be(!0),children:[e.jsx(gt,{className:"h-4 w-4"})," Export now"]}),e.jsxs(Za,{variant:"outline",onClick:fe,children:[e.jsx(ls,{className:"h-4 w-4"})," Copy keys"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: schedule reports using Reporting & Analytics schedules, and deliver via Email, WhatsApp, WeChat, or SMS."})]})}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsx(ol,{title:"Template preview",subtitle:"Fields included",right:e.jsx(Ss,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:Ge}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Preview is based on current filters and factor settings."})]}),e.jsx(Ss,{label:je,tone:"neutral"})]}),e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Field"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Value"})]})}),e.jsx("tbody",{children:[{k:"ev_km",v:Ns(pe.kmEV,1)},{k:"ice_km",v:Ns(pe.kmICE,1)},{k:"charging_kwh",v:Ns(pe.kWh,1)},{k:"charging_spend_ugx",v:io(pe.chargingSpend)},{k:"ev_scope2_kgco2e",v:kn(de.evScope2Kg)},{k:"avoided_kgco2e",v:kn(de.avoidedKg)},{k:"sustainability_score",v:`${ye.overall} (${Ve.label})`}].map(ne=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:ne.k}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:ne.v})]},ne.k))})]})}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Za,{variant:"outline",onClick:()=>be(!0),children:[e.jsx(gt,{className:"h-4 w-4"})," Export"]}),e.jsxs(Za,{variant:"outline",onClick:fe,children:[e.jsx(ls,{className:"h-4 w-4"})," Copy keys"]})]})]})})})]}):e.jsx(cC,{title:"Select a tab",subtitle:"Use the tabs to view ESG dashboards."}):e.jsx(cC,{title:"Tracking disabled",subtitle:"Enable tracking to compute EV usage and ESG metrics."})}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"W Sustainability and ESG Reporting v2. Core: EV usage metrics and EV charging spend/utilization. Premium: emissions estimates, scorecards, and template-aligned ESG exports."})})]})}),e.jsx(dC,{open:W,title:"Emission factors",subtitle:"Set values to match your internal ESG standards. Defaults are placeholders for demo.",onClose:()=>J(!1),actions:[{label:"Save",onClick:()=>{_(ne=>({gridKgCO2ePerKWh:gr(ne.gridKgCO2ePerKWh,0,5),iceKgCO2ePerKm:gr(ne.iceKgCO2ePerKm,0,2),renewableSharePct:gr(ne.renewableSharePct,0,100)})),n({title:"Saved",message:"Factors updated.",kind:"success"}),J(!1)}}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Za,{variant:"outline",onClick:()=>J(!1),children:"Close"}),e.jsxs(Za,{variant:"primary",onClick:()=>{_(ne=>({gridKgCO2ePerKWh:gr(ne.gridKgCO2ePerKWh,0,5),iceKgCO2ePerKm:gr(ne.iceKgCO2ePerKm,0,2),renewableSharePct:gr(ne.renewableSharePct,0,100)})),n({title:"Saved",message:"Factors updated.",kind:"success"}),J(!1)},children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(jb,{label:"Grid factor",value:ie.gridKgCO2ePerKWh,onChange:ne=>_(Te=>({...Te,gridKgCO2ePerKWh:ne})),hint:"kgCO2e per kWh",min:0,max:5,step:.001}),e.jsx(jb,{label:"ICE baseline factor",value:ie.iceKgCO2ePerKm,onChange:ne=>_(Te=>({...Te,iceKgCO2ePerKm:ne})),hint:"kgCO2e per km",min:0,max:2,step:.001}),e.jsx(jb,{label:"Renewable share",value:ie.renewableSharePct,onChange:ne=>_(Te=>({...Te,renewableSharePct:ne})),hint:"Percent",min:0,max:100,step:1}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"How it works"}),e.jsx("div",{className:"mt-2 text-xs text-slate-700",children:"Effective grid factor = grid factor multiplied by (1 - renewable share). EV Scope 2 = charging kWh multiplied by effective grid factor."}),e.jsx("div",{className:"mt-3 text-xs text-slate-600",children:"Avoided emissions = baseline ICE for EV km minus EV Scope 2."})]}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Use the same factors across your organization for consistent reporting."})]})}),e.jsx(dC,{open:G,title:"Export ESG report",subtitle:"Choose a template and format. Exports use current filters and factor settings.",onClose:()=>be(!1),actions:[{label:"Export",onClick:ke}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Za,{variant:"outline",onClick:()=>be(!1),children:"Cancel"}),e.jsxs(Za,{variant:"primary",onClick:ke,children:[e.jsx(gt,{className:"h-4 w-4"})," Export"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(bb,{label:"Export name",value:Oe,onChange:he,placeholder:"ESG Report",hint:"Used in file name"}),e.jsx(Mm,{label:"Format",value:je,onChange:ne=>Ue(ne),options:[{value:"CSV",label:"CSV"},{value:"JSON",label:"JSON"},{value:"PDF",label:"PDF (Print)"}]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Mm,{label:"Template",value:Ge,onChange:ne=>Me(ne),options:we.map(ne=>({value:ne,label:ne})),hint:"Aligned to internal templates"})}),e.jsxs("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Current totals: EV ",Ns(pe.kmEV,0)," km, ICE ",Ns(pe.kmICE,0)," km, Charging ",Ns(pe.kWh,0)," kWh, Spend ",io(pe.chargingSpend),"."]}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"PDF export uses Print to PDF. Allow popups if prompted."})]})})]})}const vg={green:"#03CD8C",orange:"#F77F00"};function Ql(...t){return t.filter(Boolean).join(" ")}function Pm(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function mC(t,s,a){return Math.max(s,Math.min(a,t))}function xB(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function Ur(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function Lh(t){return t?t.length<=8?"":`${t.slice(0,4)}${t.slice(-4)}`:""}function ft({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Ql("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Ht({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:vg.green}:t==="accent"?{background:vg.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Ql(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Vr({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:Ql("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:Ql("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function Om({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:Ql(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:Ql("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function oo({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:Ql(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:Ql("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function KE({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:Ql("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function Fh({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="980px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:12,scale:.985},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:12,scale:.985},transition:{duration:.18},className:"fixed inset-x-0 top-[7vh] z-50 mx-auto w-[min(1040px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(KE,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[72vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function pB({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,actions:i}){return d.useEffect(()=>{const o=c=>c.key==="Escape"&&n();return t&&window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,x:18},animate:{opacity:1,x:0},exit:{opacity:0,x:18},transition:{duration:.18},className:Ql("fixed z-50 overflow-hidden border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]","left-2 right-2 bottom-2 top-[10vh] rounded-[28px]","lg:left-auto lg:right-4 lg:top-4 lg:bottom-4 lg:w-[760px]"),role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-base font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i&&e.jsx(KE,{actions:i}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"h-full min-h-0 overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function hB({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(480px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Ql("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function pa({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function Tm({title:t,subtitle:s}){return e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(su,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:s})]})}function Uh(t){return t==="Success"?"good":t==="Retrying"?"warn":"bad"}function gB(t){return t==="Active"?"good":"neutral"}function fB(t){return t==="Enabled"?"good":"neutral"}function Vh(t){const s=Math.random().toString(36).slice(2)+Math.random().toString(36).slice(2);return`${t}_${s.slice(0,24)}`}function Rm(){return`req_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function vB(){const t=[{scope:"read:transactions",label:"Read transactions",desc:"View wallet, charging, rides, and purchase ledger events"},{scope:"read:invoices",label:"Read invoices",desc:"Fetch invoices, statements, and line items"},{scope:"read:approvals",label:"Read approvals",desc:"Fetch approval requests and decision history"},{scope:"write:approvals",label:"Write approvals",desc:"Approve or reject requests via API"},{scope:"read:budgets",label:"Read budgets",desc:"Read group and user budgets, caps, and alerts"},{scope:"write:budgets",label:"Write budgets",desc:"Update budgets (recommended to restrict)"},{scope:"webhooks:read",label:"Read webhooks",desc:"List webhook endpoints and deliveries"},{scope:"webhooks:write",label:"Write webhooks",desc:"Create, update, rotate secrets, and delete endpoints"},{scope:"exports:read",label:"Read exports",desc:"List ERP export jobs and download results"},{scope:"exports:write",label:"Write exports",desc:"Create ERP export jobs"}],s=[{ev:"invoice.created",desc:"Triggered when an invoice is created"},{ev:"invoice.paid",desc:"Triggered when an invoice is marked paid"},{ev:"approval.completed",desc:"Triggered when an approval flow completes"},{ev:"limit.breached",desc:"Triggered when a hard/soft limit is breached"}],[a,l]=d.useState([]),n=u=>{const C=Pm("toast");l(Q=>[{id:C,...u},...Q].slice(0,4)),window.setTimeout(()=>l(Q=>Q.filter(O=>O.id!==C)),3200)},[r,i]=d.useState(()=>({apiBaseProd:"https://api.evzone.example/corporatepay/v1",apiBaseSandbox:"https://sandbox-api.evzone.example/corporatepay/v1",webhookSigningAlgo:"HMAC-SHA256",rateLimitRpm:300,ipAllowlist:"",requireHmac:!0,sandboxEnabled:!0,webhookInspectorEnabled:!0})),[o,c]=d.useState("overview"),[x,j]=d.useState(()=>{const u=Date.now();return[{id:"EXP-001",createdAt:u-3*24*60*60*1e3,createdBy:"Finance Desk",env:"Production",kind:"Invoices",format:"CSV",status:"Ready",rangeLabel:"Last 30 days",rows:84,sizeKB:92,notes:"Weekly AP pack"},{id:"EXP-002",createdAt:u-1*24*60*60*1e3,createdBy:"Finance Desk",env:"Production",kind:"Transactions",format:"JSON",status:"Ready",rangeLabel:"Last 7 days",rows:260,sizeKB:210,notes:"ERP sync"}]}),[g,N]=d.useState(()=>{const u=Date.now();return[{id:"KEY-001",name:"ERP sync",env:"Production",scopes:["read:transactions","read:invoices","exports:read"],status:"Active",createdAt:u-18*24*60*60*1e3,lastUsedAt:u-6*60*60*1e3,keyPrefix:"cp_live_4f8a",ipAllowlist:"10.0.0.0/24"},{id:"KEY-002",name:"Ops dashboard",env:"Sandbox",scopes:["read:transactions","read:approvals","webhooks:read"],status:"Active",createdAt:u-6*24*60*60*1e3,lastUsedAt:u-2*24*60*60*1e3,keyPrefix:"cp_test_c21b",ipAllowlist:""},{id:"KEY-003",name:"Legacy key",env:"Production",scopes:["read:transactions"],status:"Revoked",createdAt:u-120*24*60*60*1e3,lastUsedAt:u-90*24*60*60*1e3,keyPrefix:"cp_live_9a1c",ipAllowlist:""}]}),[$,T]=d.useState(()=>{const u=Date.now();return[{id:"WH-001",env:"Production",url:"https://erp.acme.com/webhooks/evzone",events:["invoice.created","invoice.paid","approval.completed"],status:"Enabled",createdAt:u-25*24*60*60*1e3,lastDeliveryAt:u-45*60*1e3,secretHint:"a9c3",hmacEnabled:!0,retryCount:5},{id:"WH-002",env:"Sandbox",url:"https://requestbin.example/sandbox",events:["limit.breached","approval.completed"],status:"Enabled",createdAt:u-3*24*60*60*1e3,lastDeliveryAt:u-10*60*1e3,secretHint:"7b1d",hmacEnabled:!0,retryCount:3}]}),[k,q]=d.useState(()=>{const u=Date.now();return[{id:"DLV-1001",env:"Production",endpointId:"WH-001",at:u-45*60*1e3,event:"invoice.created",status:"Success",httpStatus:200,attempts:1,durationMs:240,requestId:Rm(),responseSnippet:"OK",bodyPreview:{event:"invoice.created",invoiceId:"INV-0083",amountUGX:128e4,status:"sent"},headersPreview:{"x-evzone-signature":"sha256=","x-evzone-env":"production"}},{id:"DLV-1002",env:"Production",endpointId:"WH-001",at:u-41*60*1e3,event:"approval.completed",status:"Retrying",httpStatus:502,attempts:2,durationMs:900,requestId:Rm(),responseSnippet:"Bad gateway",bodyPreview:{event:"approval.completed",approvalId:"APR-221",outcome:"approved",amountUGX:45e4},headersPreview:{"x-evzone-signature":"sha256=","x-evzone-env":"production"}},{id:"DLV-2001",env:"Sandbox",endpointId:"WH-002",at:u-10*60*1e3,event:"limit.breached",status:"Success",httpStatus:200,attempts:1,durationMs:160,requestId:Rm(),responseSnippet:"OK",bodyPreview:{event:"limit.breached",scope:"group",group:"Finance",pct:102},headersPreview:{"x-evzone-signature":"sha256=","x-evzone-env":"sandbox"}}]}),L=d.useMemo(()=>g.filter(u=>u.status==="Active").length,[g]),R=d.useMemo(()=>$.filter(u=>u.status==="Enabled").length,[$]);d.useMemo(()=>x.slice().sort((u,C)=>C.createdAt-u.createdAt)[0]||null,[x]);const[U,ae]=d.useState(""),[ie,_]=d.useState("All"),[W,J]=d.useState(!1),[we,G]=d.useState(()=>{const u={};return t.forEach(C=>u[C.scope]=["read:transactions","read:invoices"].includes(C.scope)),{name:"",env:"Production",ipAllowlist:"",scopes:u}}),[be,Ge]=d.useState(!1),[Me,je]=d.useState(null),[Ue,Oe]=d.useState(!1),[he,Y]=d.useState(()=>({env:"Production",url:"",hmac:!0,retryCount:5,events:{"invoice.created":!0,"invoice.paid":!0,"approval.completed":!0,"limit.breached":!0}})),[Ie,ce]=d.useState(!1),[me,pe]=d.useState(()=>{const u=new Date().toISOString().slice(0,10);return{env:"Production",kind:"Transactions",format:"CSV",range:"30d",from:new Date(Date.now()-30*24*60*60*1e3).toISOString().slice(0,10),to:u}}),[de,ye]=d.useState(!1),[Qe,Fe]=d.useState(null),ke=d.useMemo(()=>Qe&&k.find(u=>u.id===Qe)||null,[Qe,k]),[fe,Ve]=d.useState(()=>({enabled:r.sandboxEnabled,routeWebhooksToInspector:!0,testModeBanner:!0})),[ne,Te]=d.useState(()=>({ssoGoogle:!1,ssoMicrosoft:!1,hrisImport:!1})),Ee=d.useMemo(()=>{const u=U.trim().toLowerCase();return g.filter(C=>ie==="All"?!0:C.env===ie).filter(C=>u?`${C.name} ${C.id} ${C.env} ${C.status} ${C.scopes.join(" ")} ${C.ipAllowlist}`.toLowerCase().includes(u):!0).slice().sort((C,Q)=>Q.createdAt-C.createdAt)},[g,U,ie]),Re=d.useMemo(()=>{const u=U.trim().toLowerCase();return $.filter(C=>ie==="All"?!0:C.env===ie).filter(C=>u?`${C.url} ${C.id} ${C.env} ${C.events.join(" ")} ${C.status}`.toLowerCase().includes(u):!0).slice().sort((C,Q)=>Q.createdAt-C.createdAt)},[$,U,ie]),ze=d.useMemo(()=>{const u=U.trim().toLowerCase();return k.filter(C=>ie==="All"?!0:C.env===ie).filter(C=>u?`${C.id} ${C.endpointId} ${C.event} ${C.status} ${C.httpStatus} ${C.requestId}`.toLowerCase().includes(u):!0).slice().sort((C,Q)=>Q.at-C.at)},[k,U,ie]),qe=d.useMemo(()=>{const u=U.trim().toLowerCase();return x.filter(C=>ie==="All"?!0:C.env===ie).filter(C=>u?`${C.id} ${C.kind} ${C.format} ${C.status} ${C.rangeLabel} ${C.createdBy} ${C.notes}`.toLowerCase().includes(u):!0).slice().sort((C,Q)=>Q.createdAt-C.createdAt)},[x,U,ie]),He=()=>{const u={};t.forEach(C=>u[C.scope]=["read:transactions","read:invoices","exports:read"].includes(C.scope)),G({name:"",env:"Production",ipAllowlist:r.ipAllowlist,scopes:u}),J(!0)},_e=()=>{if(we.name.trim().length<3){n({title:"Name required",message:"Enter a key name.",kind:"warn"});return}const u=Object.entries(we.scopes).filter(([,ee])=>ee).map(([ee])=>ee);if(!u.length){n({title:"Scopes required",message:"Select at least one scope.",kind:"warn"});return}const C=Vh(we.env==="Production"?"cp_live":"cp_test"),Q=Lh(C),O={id:Pm("KEY"),name:we.name.trim(),env:we.env,scopes:u,status:"Active",createdAt:Date.now(),lastUsedAt:void 0,keyPrefix:`${C.slice(0,10)}`,ipAllowlist:we.ipAllowlist.trim()};N(ee=>[O,...ee]),je({title:"API key created",secret:C,hint:Q}),Ge(!0),n({title:"Created",message:"API key created. Copy the secret now.",kind:"success"}),J(!1)},le=u=>{N(C=>C.map(Q=>Q.id===u?{...Q,status:"Revoked"}:Q)),n({title:"Revoked",message:"API key revoked.",kind:"info"})},z=u=>{const C=g.find(ee=>ee.id===u);if(!C)return;const Q=Vh(C.env==="Production"?"cp_live":"cp_test"),O=Lh(Q);N(ee=>ee.map(F=>F.id===u?{...F,keyPrefix:`${Q.slice(0,10)}`,lastUsedAt:void 0}:F)),je({title:"API key rotated",secret:Q,hint:O}),Ge(!0),n({title:"Rotated",message:"Secret rotated. Copy the new secret.",kind:"success"})},Pe=()=>{Y({env:"Production",url:"",hmac:!0,retryCount:5,events:{"invoice.created":!0,"invoice.paid":!0,"approval.completed":!0,"limit.breached":!0}}),Oe(!0)},Be=()=>{if(!he.url.trim().startsWith("http")){n({title:"Invalid URL",message:"Enter a valid https URL.",kind:"warn"});return}const u=Object.entries(he.events).filter(([,ee])=>ee).map(([ee])=>ee);if(!u.length){n({title:"Events required",message:"Select at least one event.",kind:"warn"});return}const C=Vh(he.env==="Production"?"wh_live":"wh_test"),Q=Lh(C),O={id:Pm("WH"),env:he.env,url:he.url.trim(),events:u,status:"Enabled",createdAt:Date.now(),lastDeliveryAt:void 0,secretHint:Q,hmacEnabled:he.hmac,retryCount:mC(he.retryCount,0,12)};T(ee=>[O,...ee]),je({title:"Webhook secret created",secret:C,hint:Q}),Ge(!0),n({title:"Created",message:"Webhook endpoint created.",kind:"success"}),Oe(!1)},xe=u=>{T(C=>C.map(Q=>Q.id===u?{...Q,status:Q.status==="Enabled"?"Disabled":"Enabled"}:Q))},Ne=u=>{const C=$.find(ee=>ee.id===u);if(!C)return;const Q=Vh(C.env==="Production"?"wh_live":"wh_test"),O=Lh(Q);T(ee=>ee.map(F=>F.id===u?{...F,secretHint:O}:F)),je({title:"Webhook secret rotated",secret:Q,hint:O}),Ge(!0),n({title:"Rotated",message:"Webhook secret rotated.",kind:"success"})},M=u=>{T(C=>C.filter(Q=>Q.id!==u)),q(C=>C.filter(Q=>Q.endpointId!==u)),n({title:"Deleted",message:"Webhook endpoint deleted.",kind:"info"})},H=(u,C)=>{const Q=$.find(A=>A.id===u);if(!Q)return;const O=Math.random()<.86,ee=O?"Success":Math.random()<.5?"Retrying":"Failed",F=O?200:ee==="Retrying"?502:400,D=ee==="Retrying"?2:1,m={id:Pm("DLV"),env:Q.env,endpointId:Q.id,at:Date.now(),event:C,status:ee,httpStatus:F,attempts:D,durationMs:Math.round(120+Math.random()*900),requestId:Rm(),responseSnippet:O?"OK":ee==="Retrying"?"Bad gateway":"Bad request",bodyPreview:C==="invoice.created"?{event:C,invoiceId:"INV-NEW",amountUGX:98e4,status:"sent"}:C==="invoice.paid"?{event:C,invoiceId:"INV-NEW",paidAt:new Date().toISOString()}:C==="approval.completed"?{event:C,approvalId:"APR-NEW",outcome:"approved",amountUGX:25e4}:{event:C,scope:"group",group:"Finance",pct:101},headersPreview:{"x-evzone-env":Q.env.toLowerCase(),"x-evzone-signature":r.requireHmac?"sha256=":"(disabled)","x-evzone-request-id":Rm()}};q(A=>[m,...A].slice(0,250)),T(A=>A.map(f=>f.id===Q.id?{...f,lastDeliveryAt:m.at}:f)),n({title:"Test sent",message:`${C} sent to ${Q.id}.`,kind:"success"})},Ae=()=>{const u=new Date().toISOString().slice(0,10),C=new Date(Date.now()-30*24*60*60*1e3).toISOString().slice(0,10);pe({env:"Production",kind:"Transactions",format:"CSV",range:"30d",from:C,to:u}),ce(!0)},oe=()=>{const u=Pm("EXP"),C=me.range==="custom"?`${me.from} to ${me.to}`:me.range==="7d"?"Last 7 days":me.range==="90d"?"Last 90 days":"Last 30 days",Q={id:u,createdAt:Date.now(),createdBy:"You",env:me.env,kind:me.kind,format:me.format,status:"Running",rangeLabel:C,rows:0,sizeKB:0,notes:""};j(O=>[Q,...O]),ce(!1),n({title:"Started",message:"Export job started.",kind:"info"}),window.setTimeout(()=>{j(O=>O.map(ee=>{if(ee.id!==u)return ee;const F=Math.random()<.93;return{...ee,status:F?"Ready":"Failed",rows:F?Math.round(80+Math.random()*600):0,sizeKB:F?Math.round(60+Math.random()*400):0,notes:F?"Ready for download":"Exporter error (demo)"}})),n({title:"Export finished",message:De(x,u),kind:"success"})},850)};function De(u,C){return u.find(O=>O.id===C),"Completed."}const $e=u=>{const C=x.find(p=>p.id===u);if(!C||C.status!=="Ready")return;const Q={meta:{exportId:C.id,env:C.env,kind:C.kind,format:C.format,range:C.rangeLabel,generatedAt:new Date().toISOString()},rows:Array.from({length:Math.min(20,Math.max(3,Math.round(3+Math.random()*8)))}).map((p,E)=>({id:`row_${E+1}`,amountUGX:Math.round(1e4+Math.random()*12e5),costCenter:"OPS-001",vendor:"EVzone",createdAt:new Date(Date.now()-E*36e5).toISOString()}))};if(C.format==="JSON"){const p=JSON.stringify(Q,null,2),E=new Blob([p],{type:"application/json"}),se=URL.createObjectURL(E),y=document.createElement("a");y.href=se,y.download=`export-${C.id}.json`,y.click(),URL.revokeObjectURL(se),n({title:"Downloaded",message:"JSON export downloaded.",kind:"success"});return}const O=[{key:"id",label:"id"},{key:"amountUGX",label:"amount_ugx"},{key:"costCenter",label:"cost_center"},{key:"vendor",label:"vendor"},{key:"createdAt",label:"created_at"}],ee=p=>{const E=String(p??"");return/[",\n]/.test(E)?`"${E.replace(/"/g,'""')}"`:E},F=O.map(p=>ee(p.label)).join(","),D=Q.rows.map(p=>O.map(E=>ee(p[E.key])).join(",")).join(`
`),m=`${F}
${D}`,A=new Blob([m],{type:"text/csv"}),f=URL.createObjectURL(A),B=document.createElement("a");B.href=f,B.download=`export-${C.id}.csv`,B.click(),URL.revokeObjectURL(f),n({title:"Downloaded",message:"CSV export downloaded.",kind:"success"})},ge=()=>{const u={openapi:"3.0.0",info:{title:"EVzone CorporatePay API",version:"v1"},servers:[{url:r.apiBaseProd},{url:r.apiBaseSandbox}],paths:{"/transactions":{get:{summary:"List transactions",security:[{apiKey:[]}]}},"/invoices":{get:{summary:"List invoices",security:[{apiKey:[]}]}},"/approvals":{get:{summary:"List approvals",security:[{apiKey:[]}]}},"/webhooks":{get:{summary:"List webhooks",security:[{apiKey:[]}]},post:{summary:"Create webhook"}}},components:{securitySchemes:{apiKey:{type:"apiKey",in:"header",name:"Authorization"}}}},C=JSON.stringify(u,null,2),Q=new Blob([C],{type:"application/json"}),O=URL.createObjectURL(Q),ee=document.createElement("a");ee.href=O,ee.download="openapi-corporatepay.json",ee.click(),URL.revokeObjectURL(O),n({title:"Downloaded",message:"OpenAPI JSON downloaded.",kind:"success"})},ue=async(u,C)=>{try{await navigator.clipboard.writeText(u),n({title:"Copied",message:C,kind:"success"})}catch{n({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},Ke=d.useMemo(()=>{const u=g.filter(Q=>Q.env==="Production"&&Q.status==="Active").length,C=g.filter(Q=>Q.env==="Sandbox"&&Q.status==="Active").length;return{prod:u,sand:C}},[g]),b=d.useMemo(()=>{const u=$.filter(Q=>Q.env==="Production"&&Q.status==="Enabled").length,C=$.filter(Q=>Q.env==="Sandbox"&&Q.status==="Enabled").length;return{prod:u,sand:C}},[$]);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(hB,{toasts:a,onDismiss:u=>l(C=>C.filter(Q=>Q.id!==u))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:vg.green},children:e.jsx(su,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Integrations and Developer Center"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"ERP exports, secure API keys, webhook automation, sandbox tools, and phase 2 SSO and HRIS."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(ft,{label:`API keys: ${L} active`,tone:L?"good":"neutral"}),e.jsx(ft,{label:`Webhooks: ${R} enabled`,tone:R?"good":"neutral"}),e.jsx(ft,{label:`Sandbox: ${r.sandboxEnabled?"On":"Off"}`,tone:r.sandboxEnabled?"info":"neutral"}),e.jsx(ft,{label:`HMAC: ${r.requireHmac?"Required":"Optional"}`,tone:r.requireHmac?"info":"neutral"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ht,{variant:"outline",onClick:ge,children:[e.jsx(gt,{className:"h-4 w-4"})," OpenAPI"]}),e.jsxs(Ht,{variant:"outline",onClick:Ae,children:[e.jsx(gt,{className:"h-4 w-4"})," New export"]}),e.jsxs(Ht,{variant:"outline",onClick:Pe,children:[e.jsx(tu,{className:"h-4 w-4"})," New webhook"]}),e.jsxs(Ht,{variant:"primary",onClick:He,children:[e.jsx(Lc,{className:"h-4 w-4"})," New API key"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"overview",label:"Overview"},{id:"exports",label:"ERP exports"},{id:"keys",label:"API keys"},{id:"webhooks",label:"Webhooks"},{id:"sandbox",label:"Sandbox"},{id:"sso",label:"SSO and HRIS"}].map(u=>e.jsx("button",{className:Ql("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",o===u.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:o===u.id?{background:vg.green}:void 0,onClick:()=>c(u.id),children:u.label},u.id))}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 rounded-3xl border border-slate-200 bg-white p-4 md:grid-cols-12",children:[e.jsxs("div",{className:"md:col-span-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2.5",children:[e.jsx(ka,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:U,onChange:u=>ae(u.target.value),placeholder:"key, webhook, export...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"}),U?e.jsx("button",{className:"rounded-xl p-1 text-slate-500 hover:bg-slate-100",onClick:()=>ae(""),"aria-label":"Clear",children:e.jsx(Ye,{className:"h-4 w-4"})}):null]})]}),e.jsx("div",{className:"md:col-span-3",children:e.jsx(oo,{label:"Environment",value:ie,onChange:u=>_(u),options:[{value:"All",label:"All"},{value:"Production",label:"Production"},{value:"Sandbox",label:"Sandbox"}]})}),e.jsx("div",{className:"md:col-span-5",children:e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Base URLs: ",e.jsx("span",{className:"font-semibold",children:"Prod"})," ",r.apiBaseProd,"  ",e.jsx("span",{className:"font-semibold",children:"Sandbox"})," ",r.apiBaseSandbox]})})]})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[o==="overview"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsxs(pa,{title:"Developer posture",subtitle:"Security, observability, and operational readiness.",right:e.jsx(ft,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-4",children:[e.jsx(v,{title:"Production keys",value:`${Ke.prod}`,icon:e.jsx(Lc,{className:"h-5 w-5"}),tone:Ke.prod?"good":"neutral",sub:"Active"}),e.jsx(v,{title:"Sandbox keys",value:`${Ke.sand}`,icon:e.jsx(su,{className:"h-5 w-5"}),tone:r.sandboxEnabled?"info":"neutral",sub:"Active"}),e.jsx(v,{title:"Prod webhooks",value:`${b.prod}`,icon:e.jsx(tu,{className:"h-5 w-5"}),tone:b.prod?"good":"neutral",sub:"Enabled"}),e.jsx(v,{title:"HMAC signing",value:r.requireHmac?"On":"Off",icon:e.jsx(yt,{className:"h-5 w-5"}),tone:r.requireHmac?"info":"neutral",sub:r.webhookSigningAlgo})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(pa,{title:"ERP and accounting exports",subtitle:"CSV and JSON exports for ERP systems.",right:e.jsx(ft,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[qe.slice(0,4).map(u=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ft,{label:u.env,tone:u.env==="Production"?"neutral":"info"}),e.jsx(ft,{label:u.kind,tone:"neutral"}),e.jsx(ft,{label:u.format,tone:"info"}),e.jsx(ft,{label:u.status,tone:u.status==="Ready"?"good":u.status==="Failed"?"bad":"warn"})]}),e.jsxs("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:[u.id,"  ",u.rangeLabel]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",Ur(u.createdAt),"  ",u.createdBy]})]}),e.jsxs(Ht,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>$e(u.id),disabled:u.status!=="Ready",children:[e.jsx(gt,{className:"h-4 w-4"})," Download"]})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Rows ",u.rows,"  Size ",u.sizeKB," KB  ",u.notes||""]})]},u.id)),qe.length?null:e.jsx(Tm,{title:"No exports",subtitle:"Create an export job to begin."})]})}),e.jsxs(pa,{title:"Webhook inspector",subtitle:"Premium: inspect deliveries and payloads.",right:e.jsx(ft,{label:r.webhookInspectorEnabled?"Premium":"Off",tone:r.webhookInspectorEnabled?"info":"neutral"}),children:[e.jsxs("div",{className:"space-y-2",children:[ze.slice(0,5).map(u=>e.jsx("button",{type:"button",className:"w-full rounded-3xl border border-slate-200 bg-white p-4 text-left hover:bg-slate-50",onClick:()=>{Fe(u.id),ye(!0)},disabled:!r.webhookInspectorEnabled,children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ft,{label:u.env,tone:u.env==="Production"?"neutral":"info"}),e.jsx(ft,{label:u.event,tone:"neutral"}),e.jsx(ft,{label:u.status,tone:Uh(u.status)}),e.jsx(ft,{label:`HTTP ${u.httpStatus}`,tone:u.httpStatus>=200&&u.httpStatus<300?"good":"warn"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[Ur(u.at),"  Attempts ",u.attempts,"  ",u.durationMs,"ms"]})]}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]})},u.id)),ze.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No deliveries yet."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: inspector shows request and response with retry traces. Use Sandbox to test safely."})]})]})]}),e.jsx(pa,{title:"Security controls",subtitle:"Keys, scopes, and network restrictions.",right:e.jsx(ft,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"API keys"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Rotate and revoke keys. Use least privilege scopes."})]}),e.jsx(Lc,{className:"h-5 w-5 text-slate-400"})]}),e.jsx("div",{className:"mt-3 text-xs text-slate-600",children:"Best practice: create separate keys per integration (ERP, BI, approvals automation). Restrict by IP allowlist where possible."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Webhook signing"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"HMAC signature verification to prevent spoofing."})]}),e.jsx(ra,{className:"h-5 w-5 text-slate-400"})]}),e.jsxs("div",{className:"mt-3 text-xs text-slate-600",children:["Use header ",e.jsx("span",{className:"font-semibold",children:"x-evzone-signature"})," to verify payload integrity."]})]})]})})]}),e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(pa,{title:"Quick actions",subtitle:"Common tasks",right:e.jsx(ft,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs(Ht,{variant:"primary",onClick:He,children:[e.jsx(Lc,{className:"h-4 w-4"})," Create API key"]}),e.jsxs(Ht,{variant:"outline",onClick:Pe,children:[e.jsx(tu,{className:"h-4 w-4"})," Create webhook"]}),e.jsxs(Ht,{variant:"outline",onClick:Ae,children:[e.jsx(gt,{className:"h-4 w-4"})," Create ERP export"]}),e.jsxs(Ht,{variant:"outline",onClick:ge,children:[e.jsx(wt,{className:"h-4 w-4"})," Download OpenAPI"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: sandbox and webhook inspector available under Sandbox tab."})]}),e.jsx(pa,{title:"Environment",subtitle:"Production vs sandbox",right:e.jsx(ft,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(Vr,{enabled:r.sandboxEnabled,onChange:u=>{i(C=>({...C,sandboxEnabled:u})),n({title:"Updated",message:`Sandbox ${u?"enabled":"disabled"}.`,kind:"success"})},label:"Sandbox enabled",description:"Allows test keys and test webhook events"}),e.jsx(Vr,{enabled:r.webhookInspectorEnabled,onChange:u=>{i(C=>({...C,webhookInspectorEnabled:u})),n({title:"Updated",message:`Inspector ${u?"enabled":"disabled"}.`,kind:"success"})},label:"Webhook inspector",description:"Premium debugging for payloads and retries"})]})})]})]}):null,o==="exports"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(pa,{title:"ERP exports",subtitle:"Core: CSV/JSON exports",right:e.jsx(ft,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Supported export types:",e.jsxs("ul",{className:"mt-2 space-y-1",children:[e.jsx("li",{children:" Transactions (ledger)"}),e.jsx("li",{children:" Invoices and line items"}),e.jsx("li",{children:" Approvals history"})]})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2",children:[e.jsxs(Ht,{variant:"primary",onClick:Ae,children:[e.jsx(gt,{className:"h-4 w-4"})," New export"]}),e.jsxs(Ht,{variant:"outline",onClick:()=>{const u={version:1,gl_code:"string",cost_center:"string",vendor_code:"string",tax_code:"string",amount_ugx:"number",module:"string",marketplace:"string",invoice_group_code:"string"},C=new Blob([JSON.stringify(u,null,2)],{type:"application/json"}),Q=URL.createObjectURL(C),O=document.createElement("a");O.href=Q,O.download="erp-mapping-template.json",O.click(),URL.revokeObjectURL(Q),n({title:"Downloaded",message:"ERP mapping template downloaded.",kind:"success"})},children:[e.jsx(wt,{className:"h-4 w-4"})," Mapping template"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Best practice: include AP codes and invoice group codes for clean ERP routing."})]})}),e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsx(pa,{title:"Export jobs",subtitle:"Downloadable jobs for ERP sync",right:e.jsx(ft,{label:`${qe.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[qe.map(u=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ft,{label:u.env,tone:u.env==="Production"?"neutral":"info"}),e.jsx(ft,{label:u.kind,tone:"neutral"}),e.jsx(ft,{label:u.format,tone:"info"}),e.jsx(ft,{label:u.status,tone:u.status==="Ready"?"good":u.status==="Failed"?"bad":"warn"})]}),e.jsxs("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:[u.id,"  ",u.rangeLabel]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",Ur(u.createdAt),"  ",u.createdBy]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Rows ",u.rows,"  Size ",u.sizeKB," KB  ",u.notes||""]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ht,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>$e(u.id),disabled:u.status!=="Ready",children:[e.jsx(gt,{className:"h-4 w-4"})," Download"]}),e.jsxs(Ht,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{j(C=>C.filter(Q=>Q.id!==u.id)),n({title:"Removed",message:"Export job removed.",kind:"info"})},children:[e.jsx(as,{className:"h-4 w-4"})," Remove"]})]})]})},u.id)),qe.length?null:e.jsx(Tm,{title:"No export jobs",subtitle:"Create an export job to begin."})]})}),e.jsx(pa,{title:"Export formats",subtitle:"CSV and JSON",right:e.jsx(ft,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"CSV"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Good for spreadsheets and ERP imports"})]}),e.jsx(wt,{className:"h-5 w-5 text-slate-400"})]}),e.jsx("div",{className:"mt-3 text-xs text-slate-600",children:"Includes stable column names for mapping."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"JSON"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Best for API based ingestion"})]}),e.jsx(Ii,{className:"h-5 w-5 text-slate-400"})]}),e.jsx("div",{className:"mt-3 text-xs text-slate-600",children:"Includes meta block and structured rows."})]})]})})]})]}):null,o==="keys"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(pa,{title:"API keys",subtitle:"Core: secure endpoints, keys, scopes",right:e.jsx(ft,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"How auth works"}),e.jsxs("ul",{className:"mt-2 space-y-1",children:[e.jsx("li",{children:"1) Create an API key"}),e.jsx("li",{children:"2) Assign least-privilege scopes"}),e.jsx("li",{children:"3) Use Authorization: Bearer <key>"}),e.jsx("li",{children:"4) Rotate periodically and revoke on compromise"})]})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2",children:[e.jsxs(Ht,{variant:"primary",onClick:He,children:[e.jsx(Lc,{className:"h-4 w-4"})," New API key"]}),e.jsxs(Ht,{variant:"outline",onClick:()=>ue(r.apiBaseProd,"Production base URL copied"),children:[e.jsx(ls,{className:"h-4 w-4"})," Copy API base"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Security tip: restrict integrations to IP allowlist and scope only the endpoints needed."})]})}),e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsx(pa,{title:"Keys list",subtitle:"Create, rotate, revoke",right:e.jsx(ft,{label:`${Ee.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[Ee.map(u=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ft,{label:u.env,tone:u.env==="Production"?"neutral":"info"}),e.jsx(ft,{label:u.status,tone:gB(u.status)}),e.jsx(ft,{label:u.id,tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:u.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",Ur(u.createdAt),"  Last used ",u.lastUsedAt?Ur(u.lastUsedAt):"Never"]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[u.scopes.slice(0,6).map(C=>e.jsx(ft,{label:C,tone:"neutral"},`${u.id}-${C}`)),u.scopes.length>6?e.jsx(ft,{label:"+more",tone:"neutral"}):null]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Key prefix: ",u.keyPrefix,u.ipAllowlist?`  IP allowlist: ${u.ipAllowlist}`:""]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ht,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>z(u.id),disabled:u.status!=="Active",title:u.status!=="Active"?"Revoked":"Rotate secret",children:[e.jsx(Ar,{className:"h-4 w-4"})," Rotate"]}),e.jsxs(Ht,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>le(u.id),disabled:u.status!=="Active",children:[e.jsx(as,{className:"h-4 w-4"})," Revoke"]})]})]})},u.id)),Ee.length?null:e.jsx(Tm,{title:"No keys",subtitle:"Create an API key to start."})]})}),e.jsx(pa,{title:"Scopes reference",subtitle:"What each scope allows",right:e.jsx(ft,{label:"Core",tone:"neutral"}),children:e.jsx("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:t.map(u=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:u.label}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:u.scope}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:u.desc})]}),e.jsx(ra,{className:"h-5 w-5 text-slate-400"})]})},u.scope))})})]})]}):null,o==="webhooks"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(pa,{title:"Webhooks",subtitle:"Core: invoice, approvals, limits",right:e.jsx(ft,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Events"}),e.jsx("ul",{className:"mt-2 space-y-1",children:s.map(u=>e.jsxs("li",{children:[" ",e.jsx("span",{className:"font-semibold",children:u.ev}),": ",u.desc]},u.ev))})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2",children:[e.jsxs(Ht,{variant:"primary",onClick:Pe,children:[e.jsx(tu,{className:"h-4 w-4"})," New webhook"]}),e.jsxs(Ht,{variant:"outline",onClick:()=>ye(!0),disabled:!r.webhookInspectorEnabled,children:[e.jsx(su,{className:"h-4 w-4"})," Webhook inspector"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Security tip: verify HMAC signature and implement idempotency using requestId."})]}),e.jsx(pa,{title:"Webhook security",subtitle:"HMAC and retries",right:e.jsx(ft,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(Vr,{enabled:r.requireHmac,onChange:u=>{i(C=>({...C,requireHmac:u})),n({title:"Updated",message:`HMAC ${u?"required":"optional"}.`,kind:"success"})},label:"Require HMAC signatures",description:"Adds x-evzone-signature and rejects unsigned payloads"}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Signing algorithm: ",e.jsx("span",{className:"font-semibold",children:r.webhookSigningAlgo}),e.jsxs("div",{className:"mt-2",children:["Header: ",e.jsx("span",{className:"font-semibold",children:"x-evzone-signature"})]}),e.jsxs("div",{className:"mt-1",children:["Header: ",e.jsx("span",{className:"font-semibold",children:"x-evzone-request-id"})]})]})]})})]}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs(pa,{title:"Webhook endpoints",subtitle:"Manage endpoints",right:e.jsx(ft,{label:`${Re.length}`,tone:"neutral"}),children:[e.jsxs("div",{className:"space-y-2",children:[Re.map(u=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ft,{label:u.env,tone:u.env==="Production"?"neutral":"info"}),e.jsx(ft,{label:u.status,tone:fB(u.status)}),e.jsx(ft,{label:u.id,tone:"neutral"}),e.jsx(ft,{label:`Retries ${u.retryCount}`,tone:"neutral"}),e.jsx(ft,{label:u.hmacEnabled?"HMAC":"No HMAC",tone:u.hmacEnabled?"info":"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:u.url}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",Ur(u.createdAt),"  Last delivery ",u.lastDeliveryAt?Ur(u.lastDeliveryAt):"Never"]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:u.events.map(C=>e.jsx(ft,{label:C,tone:"neutral"},`${u.id}-${C}`))}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Secret: ",u.secretHint]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ht,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{const C=u.events[0]||"invoice.created";H(u.id,C)},disabled:u.status!=="Enabled",children:[e.jsx(tt,{className:"h-4 w-4"})," Test"]}),e.jsxs(Ht,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Ne(u.id),children:[e.jsx(Ar,{className:"h-4 w-4"})," Rotate"]}),e.jsxs(Ht,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{xe(u.id),n({title:"Updated",message:`Webhook ${u.status==="Enabled"?"disabled":"enabled"}.`,kind:"success"})},children:[e.jsx(wl,{className:"h-4 w-4"})," Toggle"]}),e.jsxs(Ht,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>M(u.id),children:[e.jsx(as,{className:"h-4 w-4"})," Delete"]})]})]})},u.id)),Re.length?null:e.jsx(Tm,{title:"No webhooks",subtitle:"Create a webhook endpoint."})]}),e.jsxs(pa,{title:"Delivery logs",subtitle:"Recent deliveries",right:e.jsx(ft,{label:r.webhookInspectorEnabled?"Premium":"Off",tone:r.webhookInspectorEnabled?"info":"neutral"}),children:[e.jsxs("div",{className:"space-y-2",children:[ze.slice(0,10).map(u=>e.jsx("button",{type:"button",className:"w-full rounded-3xl border border-slate-200 bg-white p-4 text-left hover:bg-slate-50",onClick:()=>{Fe(u.id),ye(!0)},disabled:!r.webhookInspectorEnabled,children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ft,{label:u.env,tone:u.env==="Production"?"neutral":"info"}),e.jsx(ft,{label:u.event,tone:"neutral"}),e.jsx(ft,{label:u.status,tone:Uh(u.status)}),e.jsx(ft,{label:`HTTP ${u.httpStatus}`,tone:u.httpStatus>=200&&u.httpStatus<300?"good":"warn"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[Ur(u.at),"  ",u.endpointId,"  Attempts ",u.attempts,"  ",u.durationMs,"ms"]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Response: ",u.responseSnippet]})]}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]})},u.id)),ze.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No deliveries found."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: open a delivery to see payload, headers, and retry traces."})]})]})})]}):null,o==="sandbox"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsxs(pa,{title:"Sandbox mode",subtitle:"Premium: safe testing",right:e.jsx(ft,{label:"Premium",tone:"info"}),children:[e.jsx(Vr,{enabled:r.sandboxEnabled,onChange:u=>{i(C=>({...C,sandboxEnabled:u})),n({title:"Updated",message:`Sandbox ${u?"enabled":"disabled"}.`,kind:"success"})},label:"Enable sandbox",description:"Allows test keys, test exports, and test webhook deliveries"}),e.jsx(Vr,{enabled:fe.routeWebhooksToInspector,onChange:u=>Ve(C=>({...C,routeWebhooksToInspector:u})),label:"Route test deliveries to inspector",description:"Sends sandbox events into the inspector feed"}),e.jsx(Vr,{enabled:r.webhookInspectorEnabled,onChange:u=>i(C=>({...C,webhookInspectorEnabled:u})),label:"Webhook inspector",description:"Inspect payloads, retries, and signatures"}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Sandbox base: ",e.jsx("span",{className:"font-semibold",children:r.apiBaseSandbox}),e.jsxs("div",{className:"mt-2",children:["Use keys with prefix ",e.jsx("span",{className:"font-semibold",children:"cp_test_"})]})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2",children:[e.jsxs(Ht,{variant:"outline",onClick:()=>{const u=$.find(C=>C.env==="Sandbox"&&C.status==="Enabled");if(!u){n({title:"No sandbox webhook",message:"Create a sandbox webhook first.",kind:"warn"});return}H(u.id,"invoice.created")},disabled:!r.sandboxEnabled,children:[e.jsx(tt,{className:"h-4 w-4"})," Send test invoice.created"]}),e.jsxs(Ht,{variant:"outline",onClick:()=>{const u=$.find(C=>C.env==="Sandbox"&&C.status==="Enabled");if(!u){n({title:"No sandbox webhook",message:"Create a sandbox webhook first.",kind:"warn"});return}H(u.id,"limit.breached")},disabled:!r.sandboxEnabled,children:[e.jsx(Mt,{className:"h-4 w-4"})," Simulate limit breach"]}),e.jsxs(Ht,{variant:"outline",onClick:()=>{var u;Fe(((u=ze[0])==null?void 0:u.id)||null),ye(!0)},disabled:!r.webhookInspectorEnabled,children:[e.jsx(su,{className:"h-4 w-4"})," Open inspector"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: sandbox/test mode + webhook inspector."})]})}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs(pa,{title:"Sandbox exports",subtitle:"Test ERP exports",right:e.jsx(ft,{label:"Core",tone:"neutral"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:"You can run exports in sandbox to validate mappings before production."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Ht,{variant:"primary",onClick:()=>{pe(u=>({...u,env:"Sandbox"})),ce(!0)},disabled:!r.sandboxEnabled,children:[e.jsx(gt,{className:"h-4 w-4"})," New sandbox export"]}),e.jsxs(Ht,{variant:"outline",onClick:ge,children:[e.jsx(wt,{className:"h-4 w-4"})," OpenAPI"]})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[x.filter(u=>u.env==="Sandbox").slice(0,6).map(u=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ft,{label:u.env,tone:"info"}),e.jsx(ft,{label:u.kind,tone:"neutral"}),e.jsx(ft,{label:u.format,tone:"info"}),e.jsx(ft,{label:u.status,tone:u.status==="Ready"?"good":u.status==="Failed"?"bad":"warn"})]}),e.jsxs("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:[u.id,"  ",u.rangeLabel]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",Ur(u.createdAt),"  ",u.createdBy]})]}),e.jsxs(Ht,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>$e(u.id),disabled:u.status!=="Ready",children:[e.jsx(gt,{className:"h-4 w-4"})," Download"]})]})},u.id)),x.some(u=>u.env==="Sandbox")?null:e.jsx(Tm,{title:"No sandbox exports",subtitle:"Create a sandbox export job."})]})]})})]}):null,o==="sso"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsxs(pa,{title:"SSO (Phase 2)",subtitle:"Premium: Google and Microsoft",right:e.jsx(ft,{label:"Phase 2",tone:"info"}),children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["SSO is planned for phase 2 and will support:",e.jsxs("ul",{className:"mt-2 space-y-1",children:[e.jsx("li",{children:" Google Workspace and Microsoft Entra ID"}),e.jsx("li",{children:" Domain allowlist and just-in-time provisioning"}),e.jsx("li",{children:" Optional SCIM user sync"})]})]}),e.jsx(Vr,{enabled:ne.ssoGoogle,onChange:u=>{Te(C=>({...C,ssoGoogle:u})),n({title:"Phase 2",message:"SSO configuration placeholder toggled (demo).",kind:"info"})},label:"Google SSO",description:"Coming soon"}),e.jsx(Vr,{enabled:ne.ssoMicrosoft,onChange:u=>{Te(C=>({...C,ssoMicrosoft:u})),n({title:"Phase 2",message:"SSO configuration placeholder toggled (demo).",kind:"info"})},label:"Microsoft SSO",description:"Coming soon"}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Phase 2: when enabled, login pages (X1/X2) will show SSO buttons."})]})}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs(pa,{title:"HRIS import (Phase 2)",subtitle:"Premium: HRIS connectors",right:e.jsx(ft,{label:"Phase 2",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:"HRIS import will support scheduled user sync and group assignment rules."}),e.jsx(Vr,{enabled:ne.hrisImport,onChange:u=>{Te(C=>({...C,hrisImport:u})),n({title:"Phase 2",message:"HRIS import placeholder toggled (demo).",kind:"info"})},label:"Enable HRIS import",description:"Coming soon"}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[{name:"Workday",desc:"User sync and cost centers"},{name:"BambooHR",desc:"Employee directory import"},{name:"SAP SuccessFactors",desc:"Org structure and roles"},{name:"Custom CSV",desc:"Fallback import for any HRIS"}].map(u=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:u.name}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:u.desc})]}),e.jsx(ft,{label:"Phase 2",tone:"info"})]})},u.name))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Best practice: even before HRIS sync, bulk import (C) can seed users with groups and cost centers."})]})})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"Y Integrations & Developer Center v2. Core: ERP exports (CSV/JSON), secure API keys and scopes, webhooks for invoices, approvals, and limit breaches. Premium: sandbox and webhook inspector, plus phase 2 SSO and HRIS import placeholders."})})]})}),e.jsx(Fh,{open:W,title:"Create API key",subtitle:"Secrets are shown once. Use least privilege scopes.",onClose:()=>J(!1),actions:[{label:"Create",onClick:_e}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Ht,{variant:"outline",onClick:()=>J(!1),children:"Cancel"}),e.jsxs(Ht,{variant:"primary",onClick:_e,children:[e.jsx(ct,{className:"h-4 w-4"})," Create"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Om,{label:"Key name",value:we.name,onChange:u=>G(C=>({...C,name:u})),placeholder:"Example: ERP sync"}),e.jsx(oo,{label:"Environment",value:we.env,onChange:u=>G(C=>({...C,env:u})),options:[{value:"Production",label:"Production"},{value:"Sandbox",label:"Sandbox"}]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Om,{label:"IP allowlist",value:we.ipAllowlist,onChange:u=>G(C=>({...C,ipAllowlist:u})),placeholder:"Example: 10.0.0.0/24",hint:"Optional"})}),e.jsxs("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Scopes"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Select what this key can do."}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2 md:grid-cols-2",children:t.map(u=>e.jsxs("label",{className:"flex items-start gap-3 rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("input",{type:"checkbox",className:"mt-1 h-4 w-4 rounded border-slate-300",checked:we.scopes[u.scope],onChange:C=>G(Q=>({...Q,scopes:{...Q.scopes,[u.scope]:C.target.checked}}))}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:u.label}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:u.scope}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:u.desc})]})]},u.scope))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Best practice: avoid write scopes unless needed. Prefer separate keys per system."})]})]})}),e.jsx(Fh,{open:Ue,title:"Create webhook",subtitle:"Receive event callbacks (HMAC recommended).",onClose:()=>Oe(!1),actions:[{label:"Create",onClick:Be}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Ht,{variant:"outline",onClick:()=>Oe(!1),children:"Cancel"}),e.jsxs(Ht,{variant:"primary",onClick:Be,children:[e.jsx(ct,{className:"h-4 w-4"})," Create"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(oo,{label:"Environment",value:he.env,onChange:u=>Y(C=>({...C,env:u})),options:[{value:"Production",label:"Production"},{value:"Sandbox",label:"Sandbox"}]}),e.jsx(Om,{label:"Endpoint URL",value:he.url,onChange:u=>Y(C=>({...C,url:u})),placeholder:"https://your-system.com/webhooks/evzone"}),e.jsx(oo,{label:"Retry count",value:`${he.retryCount}`,onChange:u=>Y(C=>({...C,retryCount:mC(Number(u),0,12)})),options:Array.from({length:13},(u,C)=>({value:`${C}`,label:`${C}`})),hint:"0 to 12"}),e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsx(Vr,{enabled:he.hmac,onChange:u=>Y(C=>({...C,hmac:u})),label:"HMAC signing",description:"Adds x-evzone-signature header"})}),e.jsxs("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Events"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Choose which events to receive."}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2 md:grid-cols-2",children:s.map(u=>e.jsxs("label",{className:"flex items-start gap-3 rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("input",{type:"checkbox",className:"mt-1 h-4 w-4 rounded border-slate-300",checked:he.events[u.ev],onChange:C=>Y(Q=>({...Q,events:{...Q.events,[u.ev]:C.target.checked}}))}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:u.ev}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:u.desc})]})]},u.ev))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Secrets are shown once on create and can be rotated later."})]})]})}),e.jsx(Fh,{open:Ie,title:"Create ERP export",subtitle:"CSV/JSON exports for accounting systems.",onClose:()=>ce(!1),actions:[{label:"Run export",onClick:oe}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Ht,{variant:"outline",onClick:()=>ce(!1),children:"Cancel"}),e.jsxs(Ht,{variant:"primary",onClick:oe,children:[e.jsx(gt,{className:"h-4 w-4"})," Run export"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(oo,{label:"Environment",value:me.env,onChange:u=>pe(C=>({...C,env:u})),options:[{value:"Production",label:"Production"},{value:"Sandbox",label:"Sandbox"}]}),e.jsx(oo,{label:"Export kind",value:me.kind,onChange:u=>pe(C=>({...C,kind:u})),options:[{value:"Transactions",label:"Transactions"},{value:"Invoices",label:"Invoices"},{value:"Approvals",label:"Approvals"}]}),e.jsx(oo,{label:"Format",value:me.format,onChange:u=>pe(C=>({...C,format:u})),options:[{value:"CSV",label:"CSV"},{value:"JSON",label:"JSON"}]}),e.jsx(oo,{label:"Range",value:me.range,onChange:u=>pe(C=>({...C,range:u})),options:[{value:"7d",label:"Last 7 days"},{value:"30d",label:"Last 30 days"},{value:"90d",label:"Last 90 days"},{value:"custom",label:"Custom"}]}),e.jsx("div",{className:Ql(me.range!=="custom"&&"opacity-60"),children:e.jsx(Om,{label:"From",type:"date",value:me.from,onChange:u=>pe(C=>({...C,from:u})),disabled:me.range!=="custom"})}),e.jsx("div",{className:Ql(me.range!=="custom"&&"opacity-60"),children:e.jsx(Om,{label:"To",type:"date",value:me.to,onChange:u=>pe(C=>({...C,to:u})),disabled:me.range!=="custom"})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:"In production, exports can also push directly to ERP via secure API endpoints."})]})}),e.jsxs(Fh,{open:be,title:(Me==null?void 0:Me.title)||"Secret",subtitle:"Copy now. You will not be able to view this secret again.",onClose:()=>{Ge(!1),je(null)},footer:e.jsx("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:e.jsxs(Ht,{variant:"primary",onClick:()=>{Ge(!1),je(null)},children:[e.jsx(tt,{className:"h-4 w-4"})," Done"]})}),children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Secret"}),e.jsx("div",{className:"mt-2 font-mono text-sm font-semibold text-slate-900 break-all",children:(Me==null?void 0:Me.secret)||""}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Hint: ",(Me==null?void 0:Me.hint)||""]})]}),e.jsx(Ht,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ue((Me==null?void 0:Me.secret)||"","Secret copied"),children:e.jsx(ls,{className:"h-4 w-4"})})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Store this in your secrets manager. If lost, rotate to generate a new secret."})]}),e.jsx(pB,{open:de,title:ke?`Webhook delivery ${ke.id}`:"Webhook inspector",subtitle:ke?`${ke.event}  ${ke.env}  ${xB(ke.at)}`:"Inspect deliveries and payloads",onClose:()=>{ye(!1),Fe(null)},footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Inspector is premium and intended for debugging."}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ht,{variant:"outline",onClick:()=>{Fe(null),n({title:"Cleared",message:"Selection cleared.",kind:"info"})},children:[e.jsx(Ye,{className:"h-4 w-4"})," Clear"]}),e.jsxs(Ht,{variant:"primary",onClick:()=>{ye(!1)},children:[e.jsx(tt,{className:"h-4 w-4"})," Close"]})]})]}),children:ke?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ft,{label:ke.env,tone:ke.env==="Production"?"neutral":"info"}),e.jsx(ft,{label:ke.event,tone:"neutral"}),e.jsx(ft,{label:ke.status,tone:Uh(ke.status)}),e.jsx(ft,{label:`HTTP ${ke.httpStatus}`,tone:ke.httpStatus>=200&&ke.httpStatus<300?"good":"warn"}),e.jsx(ft,{label:`Attempts ${ke.attempts}`,tone:"neutral"}),e.jsx(ft,{label:`${ke.durationMs}ms`,tone:"neutral"})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Endpoint: ",ke.endpointId,"  Request: ",ke.requestId]}),e.jsxs("div",{className:"mt-2 text-sm text-slate-700",children:["Response: ",e.jsx("span",{className:"font-semibold",children:ke.responseSnippet})]})]}),e.jsxs(pa,{title:"Headers",subtitle:"Preview",right:e.jsx(ft,{label:"Premium",tone:"info"}),children:[e.jsx("pre",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-800 overflow-auto",children:JSON.stringify(ke.headersPreview,null,2)}),e.jsxs(Ht,{variant:"outline",onClick:()=>ue(JSON.stringify(ke.headersPreview,null,2),"Headers copied"),children:[" ",e.jsx(ls,{className:"h-4 w-4"})," Copy"]})]}),e.jsxs(pa,{title:"Body",subtitle:"Payload",right:e.jsx(ft,{label:"Premium",tone:"info"}),children:[e.jsx("pre",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-800 overflow-auto",children:JSON.stringify(ke.bodyPreview,null,2)}),e.jsxs(Ht,{variant:"outline",onClick:()=>ue(JSON.stringify(ke.bodyPreview,null,2),"Body copied"),children:[" ",e.jsx(ls,{className:"h-4 w-4"})," Copy"]})]}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Best practice: implement idempotency in your receiver using x-evzone-request-id."})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Select a delivery from Webhooks or Overview to see full details."}),e.jsx("div",{className:"space-y-2",children:ze.slice(0,30).map(u=>e.jsx("button",{type:"button",className:"w-full rounded-3xl border border-slate-200 bg-white p-4 text-left hover:bg-slate-50",onClick:()=>Fe(u.id),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ft,{label:u.env,tone:u.env==="Production"?"neutral":"info"}),e.jsx(ft,{label:u.event,tone:"neutral"}),e.jsx(ft,{label:u.status,tone:Uh(u.status)}),e.jsx(ft,{label:`HTTP ${u.httpStatus}`,tone:u.httpStatus>=200&&u.httpStatus<300?"good":"warn"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[Ur(u.at),"  ",u.endpointId,"  Attempts ",u.attempts]})]}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]})},u.id))})]})})]});function v({title:u,value:C,sub:Q,icon:O,tone:ee}){const F=ee==="good"?"bg-emerald-50 text-emerald-700":ee==="warn"?"bg-amber-50 text-amber-800":ee==="bad"?"bg-rose-50 text-rose-700":ee==="info"?"bg-blue-50 text-blue-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:u}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:C}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:Q})]}),e.jsx("div",{className:Ql("grid h-10 w-10 place-items-center rounded-2xl",F),children:O})]})})}}const bg={green:"#03CD8C",orange:"#F77F00"};function en(...t){return t.filter(Boolean).join(" ")}function Oc(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function xC(t,s,a){return Math.max(s,Math.min(a,t))}function co(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function uo(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function bB(t){return Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function rt({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:en("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function yb(t){return t==="Critical"?"bad":t==="Warning"?"warn":"info"}function jB(t){return t==="Valid"?"good":t==="Expiring"?"warn":t==="Expired"||t==="Missing"?"bad":"neutral"}function Dt({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:bg.green}:t==="accent"?{background:bg.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:en(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function gi({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:en("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:en("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function _h({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:en(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:en("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function pC({label:t,value:s,onChange:a,hint:l,disabled:n,min:r=0,max:i=3650}){return e.jsxs("div",{className:en(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",min:r,max:i,value:Number.isFinite(s)?s:0,onChange:o=>a(Number(o.target.value||0)),disabled:n,className:en("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function Cn({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:en(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:en("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function Bh({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:i=>a(i.target.value),placeholder:l,rows:r,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"})]})}function QE({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:en("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function Gh({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="980px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:12,scale:.985},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:12,scale:.985},transition:{duration:.18},className:"fixed inset-x-0 top-[7vh] z-50 mx-auto w-[min(1040px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(QE,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[72vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function yB({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,actions:i}){return d.useEffect(()=>{const o=c=>c.key==="Escape"&&n();return t&&window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,x:18},animate:{opacity:1,x:0},exit:{opacity:0,x:18},transition:{duration:.18},className:en("fixed z-50 overflow-hidden border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]","left-2 right-2 bottom-2 top-[10vh] rounded-[28px]","lg:left-auto lg:right-4 lg:top-4 lg:bottom-4 lg:w-[760px]"),role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-base font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i&&e.jsx(QE,{actions:i}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"h-full min-h-0 overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function NB({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(480px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:en("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function Bs({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function _r({title:t,subtitle:s}){return e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(yt,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:s})]})}function hC(t){let s=2166136261;for(let a=0;a<t.length;a++)s^=t.charCodeAt(a),s=Math.imul(s,16777619);return(s>>>0).toString(16).padStart(8,"0")}async function qh(t){try{const a=new TextEncoder().encode(t);if(!(crypto!=null&&crypto.subtle))return hC(t);const l=await crypto.subtle.digest("SHA-256",a);return Array.from(new Uint8Array(l)).map(r=>r.toString(16).padStart(2,"0")).join("")}catch{return hC(t)}}function gC(t){const s=new WeakSet,a=l=>{if(l&&typeof l=="object"){if(s.has(l))return"[Circular]";if(s.add(l),Array.isArray(l))return l.map(a);const n=Object.keys(l).sort(),r={};for(const i of n)r[i]=a(l[i]);return r}return l};return JSON.stringify(a(t))}function wB(){const t=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],[s,a]=d.useState([]),l=h=>{const K=Oc("toast");a(V=>[{id:K,...h},...V].slice(0,4)),window.setTimeout(()=>a(V=>V.filter(Ce=>Ce.id!==K)),3200)},[n,r]=d.useState("Org Admin"),[i,o]=d.useState("overview"),[c,x]=d.useState(()=>({requireMfaOrgAdmin:!0,requireMfaFinance:!0,requireMfaApprover:!0,requireMfaSupport:!0,trustDeviceDays:30,requireStepUpNewDevice:!0,requireStepUpSensitive:!0,ipAllowlist:""})),[j,g]=d.useState(!0),[N,$]=d.useState(()=>{const h=Date.now();return[{id:"RET-01",category:"Audit logs",retentionDays:365,legalHold:!1,purgeMode:"Archive",lastPurgeAt:h-7*24*60*60*1e3,notes:"Archive to cold storage after 365 days"},{id:"RET-02",category:"Invoices and statements",retentionDays:2555,legalHold:!1,purgeMode:"Archive",lastPurgeAt:h-30*24*60*60*1e3,notes:"7 years retention"},{id:"RET-03",category:"Transaction ledger",retentionDays:2555,legalHold:!1,purgeMode:"Archive",lastPurgeAt:h-30*24*60*60*1e3,notes:"7 years retention"},{id:"RET-04",category:"Approvals",retentionDays:730,legalHold:!1,purgeMode:"Archive",lastPurgeAt:h-14*24*60*60*1e3,notes:"2 years retention"},{id:"RET-05",category:"Webhook deliveries",retentionDays:90,legalHold:!1,purgeMode:"Hard delete",lastPurgeAt:h-3*24*60*60*1e3,notes:"Operational logs"},{id:"RET-06",category:"API access logs",retentionDays:180,legalHold:!1,purgeMode:"Hard delete",lastPurgeAt:h-3*24*60*60*1e3,notes:"Security analytics"},{id:"RET-07",category:"Support sessions",retentionDays:365,legalHold:!1,purgeMode:"Archive",lastPurgeAt:h-14*24*60*60*1e3,notes:"Support audit trails"},{id:"RET-08",category:"Exports",retentionDays:60,legalHold:!1,purgeMode:"Hard delete",lastPurgeAt:h-3*24*60*60*1e3,notes:"Reduce sensitive artifacts"}]}),[T,k]=d.useState(()=>[{id:"DC-01",actionKey:"retention_change",title:"Change data retention",enabled:!0,approversRequired:2,stepUpMfaRequired:!0,allowBreakGlass:!0,notes:"Prevents silent data deletion changes"},{id:"DC-02",actionKey:"mfa_policy_change",title:"Change MFA policy",enabled:!0,approversRequired:2,stepUpMfaRequired:!0,allowBreakGlass:!0,notes:"Protects auth baseline"},{id:"DC-03",actionKey:"support_write_action",title:"Support write actions",enabled:!0,approversRequired:2,stepUpMfaRequired:!0,allowBreakGlass:!1,notes:"EVzone Support cannot write without org approval"},{id:"DC-04",actionKey:"rotate_prod_key",title:"Rotate production API keys",enabled:!0,approversRequired:2,stepUpMfaRequired:!0,allowBreakGlass:!0,notes:"Reduce integration outage risk"},{id:"DC-05",actionKey:"forensic_export_prod",title:"Generate production forensic exports",enabled:!0,approversRequired:2,stepUpMfaRequired:!0,allowBreakGlass:!0,notes:"Sensitive logs export"},{id:"DC-06",actionKey:"disable_support_mode",title:"Disable support mode",enabled:!0,approversRequired:2,stepUpMfaRequired:!0,allowBreakGlass:!0,notes:"Avoid accidental lockout during incident"}]),[q,L]=d.useState(()=>{const h=Date.now();return[{id:"DCR-001",createdAt:h-2*60*60*1e3,requestedBy:"EVzone Support",requesterRole:"EVzone Support",env:"Production",actionKey:"support_write_action",reason:"Need to re-send overdue invoices with corrected AP routing",status:"Pending",approvals:[{by:"Org Admin",role:"Org Admin",at:h-30*60*1e3}],required:2}]}),[R,U]=d.useState(()=>[{id:"SUP-001",startedAt:Date.now()-3*60*60*1e3,env:"Production",agent:"EVzone Support",reason:"Invoice delivery troubleshooting",writeEnabled:!1,writeRequests:["DCR-001"]}]),[ae,ie]=d.useState(()=>{const h=Date.now();return[{id:"DEV-001",user:"Org Admin",role:"Org Admin",device:"iPhone 15 Pro",deviceType:"Phone",firstSeenAt:h-40*24*60*60*1e3,lastSeenAt:h-2*60*60*1e3,status:"Trusted",trustedUntil:h+22*24*60*60*1e3,ipLast:"197.157.0.12",geoLast:"Kampala, UG",riskSignals:[]},{id:"DEV-002",user:"Finance Desk",role:"Finance",device:"Windows Laptop",deviceType:"Laptop",firstSeenAt:h-120*24*60*60*1e3,lastSeenAt:h-10*60*1e3,status:"Trusted",trustedUntil:h+10*24*60*60*1e3,ipLast:"197.157.0.18",geoLast:"Kampala, UG",riskSignals:["New IP observed"]},{id:"DEV-003",user:"EVzone Support",role:"EVzone Support",device:"Support Console",deviceType:"Other",firstSeenAt:h-12*24*60*60*1e3,lastSeenAt:h-45*60*1e3,status:"Trusted",trustedUntil:h+7*24*60*60*1e3,ipLast:"41.210.0.9",geoLast:"Nairobi, KE",riskSignals:["Support mode"]},{id:"DEV-004",user:"John S.",role:"Employee",device:"Android",deviceType:"Phone",firstSeenAt:h-9*24*60*60*1e3,lastSeenAt:h-3*24*60*60*1e3,status:"Revoked",ipLast:"102.88.1.11",geoLast:"Entebbe, UG",riskSignals:["Password reset"]}]}),[_,W]=d.useState(()=>{const h=Date.now();return[{id:"LG-001",at:h-2*60*60*1e3,user:"Org Admin",role:"Org Admin",ip:"197.157.0.12",geo:"Kampala, UG",device:"iPhone 15 Pro",outcome:"Success",note:"Trusted device"},{id:"LG-002",at:h-70*60*1e3,user:"Finance Desk",role:"Finance",ip:"197.157.0.18",geo:"Kampala, UG",device:"Windows Laptop",outcome:"Step-up required",note:"New IP observed"},{id:"LG-003",at:h-45*60*1e3,user:"EVzone Support",role:"EVzone Support",ip:"41.210.0.9",geo:"Nairobi, KE",device:"Support Console",outcome:"Success",note:"Support session"},{id:"LG-004",at:h-2*24*60*60*1e3,user:"John S.",role:"Employee",ip:"102.88.1.11",geo:"Entebbe, UG",device:"Android",outcome:"Blocked",note:"Device revoked"}]}),[J,we]=d.useState(()=>{const h=Date.now();return[{id:"AUD-001",ts:h-2*60*60*1e3,env:"Production",severity:"Info",actor:"Org Admin",role:"Org Admin",ip:"197.157.0.12",device:"iPhone 15 Pro",module:"Security",marketplace:"-",event:"Auth.Login",targetType:"session",targetId:"sess_001",summary:"Login success",metadata:{outcome:"success",method:"password+mfa"}},{id:"AUD-002",ts:h-65*60*1e3,env:"Production",severity:"Warning",actor:"Finance Desk",role:"Finance",ip:"197.157.0.18",device:"Windows Laptop",module:"Security",marketplace:"-",event:"Auth.Login",targetType:"session",targetId:"sess_002",summary:"Step-up required",metadata:{outcome:"step-up",reason:"new ip"}},{id:"AUD-003",ts:h-3*24*60*60*1e3,env:"Production",severity:"Info",actor:"Org Admin",role:"Org Admin",ip:"197.157.0.12",device:"iPhone 15 Pro",module:"Security",marketplace:"-",event:"Policy.Retention.Updated",targetType:"retention",targetId:"RET-05",summary:"Updated retention rule",metadata:{category:"Webhook deliveries"},diff:{before:{retentionDays:60},after:{retentionDays:90}}},{id:"AUD-004",ts:h-3*60*60*1e3,env:"Production",severity:"Warning",actor:"EVzone Support",role:"EVzone Support",ip:"41.210.0.9",device:"Support Console",module:"System",marketplace:"-",event:"Support.Session.Start",targetType:"support_session",targetId:"SUP-001",summary:"Support session started",metadata:{supportMode:!0}},{id:"AUD-005",ts:h-2*60*60*1e3,env:"Production",severity:"Critical",actor:"System",role:"System",ip:"-",device:"-",module:"Billing",marketplace:"-",event:"Support.Action.Requested",targetType:"dual_control_request",targetId:"DCR-001",summary:"Support write requested",metadata:{action:"resend invoices"}}]}),[G,be]=d.useState(()=>[]),[Ge,Me]=d.useState(()=>{const h=Date.now();return[{id:"ATT-001",policyName:"CorporatePay Acceptable Use",version:"v1.2",requiredForRoles:["Org Admin","Finance","Approver","EVzone Support"],dueBy:h+14*24*60*60*1e3,lastUpdatedAt:h-14*24*60*60*1e3,completion:[{user:"Org Admin",role:"Org Admin",at:h-10*24*60*60*1e3},{user:"Finance Desk",role:"Finance",at:h-9*24*60*60*1e3}]},{id:"ATT-002",policyName:"Support Mode Rules",version:"v2.0",requiredForRoles:["EVzone Support","Org Admin"],dueBy:h+21*24*60*60*1e3,lastUpdatedAt:h-30*24*60*60*1e3,completion:[{user:"EVzone Support",role:"EVzone Support",at:h-5*24*60*60*1e3}]}]}),[je,Ue]=d.useState(()=>{const h=Date.now(),K=h+20*24*60*60*1e3,V=h-12*24*60*60*1e3;return[{id:"VD-001",vendor:"EVzone Rides",docType:"Insurance",fileName:"insurance-2026.pdf",verified:!0,expiryDate:K,status:"Expiring",uploadedAt:h-40*24*60*60*1e3,uploadedBy:"Procurement Desk",notes:"Renewal requested"},{id:"VD-002",vendor:"Shenzhen Store",docType:"License",fileName:"license.pdf",verified:!0,expiryDate:h+210*24*60*60*1e3,status:"Valid",uploadedAt:h-70*24*60*60*1e3,uploadedBy:"Procurement Desk",notes:""},{id:"VD-003",vendor:"Express CN",docType:"Safety",fileName:"safety-cert.pdf",verified:!1,expiryDate:V,status:"Expired",uploadedAt:h-190*24*60*60*1e3,uploadedBy:"Procurement Desk",notes:"Awaiting updated certificate"},{id:"VD-004",vendor:"ServicePro",docType:"Tax",fileName:"tax-clearance.pdf",verified:!0,expiryDate:h+30*24*60*60*1e3,status:"Valid",uploadedAt:h-10*24*60*60*1e3,uploadedBy:"Procurement Desk",notes:""}]}),[Oe,he]=d.useState(""),[Y,Ie]=d.useState("All"),[ce,me]=d.useState("All"),[pe,de]=d.useState("All"),[ye,Qe]=d.useState("All"),[Fe,ke]=d.useState(!1),[fe,Ve]=d.useState(null),ne=d.useMemo(()=>fe&&J.find(h=>h.id===fe)||null,[fe,J]),[Te,Ee]=d.useState(null),[Re,ze]=d.useState(""),[qe,He]=d.useState(!1),[_e,le]=d.useState(()=>({env:"Production",range:"Last 7 days",includeSupport:!0,includeCompliance:!0,reason:""})),[z,Pe]=d.useState(!1),[Be,xe]=d.useState(()=>({vendor:"",docType:"License",fileName:"",expiryDate:"",verified:!1,notes:""})),[Ne,M]=d.useState(!1),[H,Ae]=d.useState({attId:"ATT-001",confirm:!1,note:""}),oe=h=>{const K={id:Oc("AUD"),ts:h.ts??Date.now(),...h};return we(V=>[K,...V].slice(0,800)),K},De=d.useMemo(()=>Object.fromEntries(T.map(h=>[h.actionKey,h])),[T]),$e=(h,K)=>{const V=De[h];return V!=null&&V.enabled?h==="forensic_export_prod"||h==="rotate_prod_key"?K==="Production":!0:!1},ge=(h,K,V)=>{const Ce=De[h],I=(Ce==null?void 0:Ce.approversRequired)??2,te={id:Oc("DCR"),createdAt:Date.now(),requestedBy:n,requesterRole:n,env:K,actionKey:h,reason:V.trim()||"Policy required",status:"Pending",approvals:[],required:I};return L(Se=>[te,...Se]),oe({env:K,severity:"Critical",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Support.Action.Requested",targetType:"dual_control_request",targetId:te.id,summary:"Dual control request created",metadata:{actionKey:h,required:I,reason:te.reason}}),l({title:"Approval required",message:`Created request ${te.id}.`,kind:"warn"}),te},ue=h=>{const K=Date.now();L(V=>V.map(Ce=>{if(Ce.id!==h||Ce.status!=="Pending"||Ce.approvals.some(Se=>Se.by===n))return Ce;const I=[...Ce.approvals,{by:n,role:n,at:K}],te=I.length>=Ce.required?"Approved":"Pending";return{...Ce,approvals:I,status:te}})),oe({env:"Production",severity:"Info",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Policy.DualControl.Updated",targetType:"dual_control_request",targetId:h,summary:"Dual control approval recorded",metadata:{by:n}}),l({title:"Approved",message:"Approval recorded.",kind:"success"})},Ke=h=>{L(K=>K.map(V=>V.id===h?{...V,status:"Rejected"}:V)),oe({env:"Production",severity:"Warning",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Policy.DualControl.Updated",targetType:"dual_control_request",targetId:h,summary:"Dual control request rejected",metadata:{by:n}}),l({title:"Rejected",message:"Request rejected.",kind:"info"})},b=d.useMemo(()=>{const h=Oe.trim().toLowerCase();return J.filter(K=>Y==="All"?!0:K.env===Y).filter(K=>ce==="All"?!0:K.severity===ce).filter(K=>pe==="All"?!0:K.role===pe).filter(K=>ye==="All"?!0:K.module===ye).filter(K=>h?`${K.id} ${K.actor} ${K.role} ${K.event} ${K.targetType} ${K.targetId} ${K.summary} ${K.module} ${K.marketplace}`.toLowerCase().includes(h):!0).slice().sort((K,V)=>V.ts-K.ts)},[J,Oe,Y,ce,pe,ye]),v=d.useMemo(()=>je.filter(h=>h.status==="Expiring"||h.status==="Expired"||h.status==="Missing"),[je]),u=d.useMemo(()=>q.filter(h=>h.status==="Pending").length,[q]),C=d.useMemo(()=>R.filter(h=>!h.endedAt).length,[R]),Q=d.useMemo(()=>{const h=[];c.requireMfaOrgAdmin&&h.push("Org Admin"),c.requireMfaFinance&&h.push("Finance"),c.requireMfaApprover&&h.push("Approver"),c.requireMfaSupport&&h.push("EVzone Support");const K=Array.from(new Set(h)),V=K.length?100:0;return{requiredRoles:K,pct:V}},[c]),O=()=>{const h={filters:{envFilter:Y,sevFilter:ce,roleFilter:pe,moduleFilter:ye,q:Oe},entries:b,exportedAt:new Date().toISOString()},K=new Blob([JSON.stringify(h,null,2)],{type:"application/json"}),V=URL.createObjectURL(K),Ce=document.createElement("a");Ce.href=V,Ce.download="corporatepay-audit.json",Ce.click(),URL.revokeObjectURL(V),l({title:"Exported",message:"Audit JSON downloaded.",kind:"success"})},ee=()=>{const h=["ts","env","severity","actor","role","event","module","marketplace","targetType","targetId","summary"],K=ot=>{const Nt=String(ot??"");return/[",\n]/.test(Nt)?`"${Nt.replace(/"/g,'""')}"`:Nt},V=b.map(ot=>({ts:co(ot.ts),env:ot.env,severity:ot.severity,actor:ot.actor,role:ot.role,event:ot.event,module:ot.module,marketplace:ot.marketplace,targetType:ot.targetType,targetId:ot.targetId,summary:ot.summary})),Ce=h.join(","),I=V.map(ot=>h.map(Nt=>K(ot[Nt])).join(",")).join(`
`),te=`${Ce}
${I}`,Se=new Blob([te],{type:"text/csv"}),Xe=URL.createObjectURL(Se),mt=document.createElement("a");mt.href=Xe,mt.download="corporatepay-audit.csv",mt.click(),URL.revokeObjectURL(Xe),l({title:"Exported",message:"Audit CSV downloaded.",kind:"success"})},F=h=>{ze(""),Ee(h)},D=()=>{if(Re.trim().length<8){l({title:"Reason required",message:"Provide a clear reason for audit.",kind:"warn"});return}const h=Te==="enable";if(!h&&$e("disable_support_mode","Production")){ge("disable_support_mode","Production",Re),Ee(null);return}g(h),Ee(null),oe({env:"Production",severity:"Warning",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:h?"Support.Session.Start":"Support.Session.End",targetType:"support_mode",targetId:"org",summary:h?"Support mode enabled":"Support mode disabled",metadata:{reason:Re.trim()}}),l({title:"Updated",message:h?"Support enabled.":"Support disabled.",kind:"success"})},m=h=>{const K=Date.now();ie(V=>V.map(Ce=>Ce.id===h?{...Ce,status:"Revoked",trustedUntil:void 0,lastSeenAt:K}:Ce)),oe({env:"Production",severity:"Warning",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Auth.Device.Revoked",targetType:"device",targetId:h,summary:"Device revoked",metadata:{deviceId:h}}),l({title:"Revoked",message:"Device access revoked.",kind:"success"})},A=()=>{if($e("retention_change","Production")){ge("retention_change","Production","Update retention settings");return}oe({env:"Production",severity:"Info",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Policy.Retention.Updated",targetType:"retention",targetId:"bulk",summary:"Retention policy updated",metadata:{count:N.length}}),l({title:"Applied",message:"Retention settings applied.",kind:"success"})},f=()=>{if($e("mfa_policy_change","Production")){ge("mfa_policy_change","Production","Update MFA and device trust policy");return}oe({env:"Production",severity:"Info",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Auth.MFA.Enabled",targetType:"mfa_policy",targetId:"org",summary:"MFA policy updated",metadata:{...c}}),l({title:"Saved",message:"MFA policy saved.",kind:"success"})},B=h=>{Ve(h),ke(!0)},p=async()=>{const h=_e.env;if(h==="Production"&&$e("forensic_export_prod","Production")){if(!_e.reason.trim()){l({title:"Reason required",message:"Add a reason for production forensic export.",kind:"warn"});return}ge("forensic_export_prod","Production",_e.reason),He(!1);return}const K=b.slice(0,200).slice().reverse(),V=crypto!=null&&crypto.subtle?"SHA-256":"FNV-1a";let Ce=await qh("0");for(const nt of K){const Vs=gC({id:nt.id,ts:nt.ts,env:nt.env,severity:nt.severity,actor:nt.actor,role:nt.role,ip:nt.ip,device:nt.device,module:nt.module,marketplace:nt.marketplace,event:nt.event,targetType:nt.targetType,targetId:nt.targetId,summary:nt.summary,metadata:nt.metadata,diff:nt.diff||null});Ce=await qh(`${Ce}|${Vs}`)}const I=Ce,te={exportId:Oc("FXM"),createdAt:new Date().toISOString(),env:h,algorithm:V,recordCount:K.length,rangeLabel:_e.range,finalHash:I,disclaimer:V==="FNV-1a"?"FNV used because SHA-256 not available.":"SHA-256 used for hash chain."},Se={id:Oc("FX"),createdAt:Date.now(),createdBy:n,env:h,rangeLabel:_e.range,recordCount:K.length,algo:V,finalHash:I,status:"Ready",manifest:te,entries:K};be(nt=>[Se,...nt]),oe({env:h,severity:"Critical",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Export.Forensic.Created",targetType:"forensic_export",targetId:Se.id,summary:"Forensic export created",metadata:{recordCount:Se.recordCount,finalHash:Se.finalHash,algo:Se.algo,reason:_e.reason||""}}),l({title:"Created",message:`Forensic export ${Se.id} ready.`,kind:"success"}),He(!1);const Xe={manifest:te,entries:K},mt=new Blob([JSON.stringify(Xe,null,2)],{type:"application/json"}),ot=URL.createObjectURL(mt),Nt=document.createElement("a");Nt.href=ot,Nt.download=`forensic-export-${Se.id}.json`,Nt.click(),URL.revokeObjectURL(ot)},E=async h=>{const K=G.find(te=>te.id===h);if(!K)return;const V=K.entries.slice().sort((te,Se)=>te.ts-Se.ts);let Ce=await qh("0");for(const te of V){const Se=gC({id:te.id,ts:te.ts,env:te.env,severity:te.severity,actor:te.actor,role:te.role,ip:te.ip,device:te.device,module:te.module,marketplace:te.marketplace,event:te.event,targetType:te.targetType,targetId:te.targetId,summary:te.summary,metadata:te.metadata,diff:te.diff||null});Ce=await qh(`${Ce}|${Se}`)}const I=Ce===K.finalHash;be(te=>te.map(Se=>Se.id===h?{...Se,verifiedAt:Date.now(),verifiedOk:I}:Se)),oe({env:K.env,severity:I?"Info":"Critical",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Export.Forensic.Verified",targetType:"forensic_export",targetId:h,summary:I?"Forensic export verified":"Forensic export verification failed",metadata:{ok:I}}),l({title:I?"Verified":"Mismatch",message:I?"Hash chain valid.":"Hash mismatch detected.",kind:I?"success":"error"})},se=()=>{if(!Be.vendor.trim()||!Be.fileName.trim()){l({title:"Missing",message:"Vendor and file name are required.",kind:"warn"});return}const h=Be.expiryDate?new Date(Be.expiryDate).getTime():void 0;let K="Valid";const V=Date.now();h?h<V?K="Expired":h<V+30*24*60*60*1e3&&(K="Expiring"):K="Valid";const Ce={id:Oc("VD"),vendor:Be.vendor.trim(),docType:Be.docType,fileName:Be.fileName.trim(),verified:Be.verified,expiryDate:h,status:K,uploadedAt:V,uploadedBy:n,notes:Be.notes.trim()};Ue(I=>[Ce,...I]),oe({env:"Production",severity:K==="Expired"?"Critical":K==="Expiring"?"Warning":"Info",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Compliance.VendorDoc.Updated",targetType:"vendor_doc",targetId:Ce.id,summary:"Vendor compliance doc added",metadata:{vendor:Ce.vendor,docType:Ce.docType,status:Ce.status}}),l({title:"Saved",message:"Vendor document saved.",kind:"success"}),Pe(!1)},y=()=>{if(!H.confirm){l({title:"Confirm required",message:"Confirm your attestation.",kind:"warn"});return}const h=Date.now();Me(K=>K.map(V=>V.id!==H.attId||V.completion.some(Ce=>Ce.user===n)?V:{...V,completion:[{user:n,role:n,at:h},...V.completion]})),oe({env:"Production",severity:"Info",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Compliance.Attestation.Completed",targetType:"policy_attestation",targetId:H.attId,summary:"Policy attestation completed",metadata:{note:H.note||""}}),l({title:"Completed",message:"Attestation recorded.",kind:"success"}),M(!1)},re=h=>{const K=G.find(Se=>Se.id===h);if(!K)return;const V={manifest:K.manifest,entries:K.entries},Ce=new Blob([JSON.stringify(V,null,2)],{type:"application/json"}),I=URL.createObjectURL(Ce),te=document.createElement("a");te.href=I,te.download=`forensic-export-${K.id}.json`,te.click(),URL.revokeObjectURL(I),l({title:"Downloaded",message:"Forensic bundle downloaded.",kind:"success"})},ve=d.useMemo(()=>je.filter(h=>h.status==="Expired"||h.status==="Missing").length,[je]),P=d.useMemo(()=>{const h=new Date,K=new Date(h.getFullYear(),h.getMonth(),h.getDate()).getTime();return J.filter(V=>V.ts>=K).length},[J]),X=d.useMemo(()=>{const h=Q.pct,K=ae.filter(I=>I.status==="Trusted").length,V=ae.length||1,Ce=Math.round(K/V*100);return{mfa:h,trustPct:Ce}},[Q.pct,ae]),S=[{id:"overview",label:"Overview"},{id:"audit",label:"Audit logs"},{id:"mfa",label:"MFA and device trust"},{id:"retention",label:"Data retention"},{id:"support",label:"Support mode"},{id:"dual",label:"Dual control"},{id:"forensics",label:"Forensic exports"},{id:"compliance",label:"Compliance center"}];return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(NB,{toasts:s,onDismiss:h=>a(K=>K.filter(V=>V.id!==h))}),n==="EVzone Support"?e.jsx("div",{className:"sticky top-0 z-30 border-b border-amber-200 bg-amber-50 px-4 py-2 text-sm text-amber-900",children:e.jsxs("div",{className:"mx-auto flex max-w-[1400px] items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(yt,{className:"h-4 w-4"})," Support session view. No silent actions. Writes require approvals."]}),e.jsx(rt,{label:j?"Support mode enabled":"Support mode disabled",tone:j?"info":"warn"})]})}):null,e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:bg.green},children:e.jsx(yt,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Security, Audit and Compliance"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Audit logs, MFA policies, device trust, retention, support gating, dual control, forensic exports, and compliance evidence."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(rt,{label:`Audit today: ${P}`,tone:"neutral"}),e.jsx(rt,{label:`Dual pending: ${u}`,tone:u?"warn":"good"}),e.jsx(rt,{label:`Support sessions: ${C}`,tone:C?"info":"neutral"}),e.jsx(rt,{label:`Docs alerts: ${v.length}`,tone:v.length?"warn":"good"}),e.jsx(rt,{label:`MFA coverage: ${X.mfa}%`,tone:X.mfa>=100?"good":"warn"}),e.jsx(rt,{label:`Trust coverage: ${X.trustPct}%`,tone:X.trustPct>=70?"good":"warn"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Cn,{label:"View as",value:n,onChange:h=>r(h),options:[{value:"Org Admin",label:"Org Admin"},{value:"Finance",label:"Finance"},{value:"Approver",label:"Approver"},{value:"EVzone Support",label:"EVzone Support"}]}),e.jsxs(Dt,{variant:"outline",onClick:ee,children:[e.jsx(gt,{className:"h-4 w-4"})," Export CSV"]}),e.jsxs(Dt,{variant:"outline",onClick:O,children:[e.jsx(gt,{className:"h-4 w-4"})," Export JSON"]}),e.jsxs(Dt,{variant:"primary",onClick:()=>He(!0),children:[e.jsx(qi,{className:"h-4 w-4"})," Forensic export"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:S.map(h=>e.jsx("button",{className:en("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",i===h.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:i===h.id?{background:bg.green}:void 0,onClick:()=>o(h.id),children:h.label},h.id))}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 rounded-3xl border border-slate-200 bg-white p-4 md:grid-cols-12",children:[e.jsxs("div",{className:"md:col-span-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2.5",children:[e.jsx(ka,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:Oe,onChange:h=>he(h.target.value),placeholder:"audit, device, vendor, request...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"}),Oe?e.jsx("button",{className:"rounded-xl p-1 text-slate-500 hover:bg-slate-100",onClick:()=>he(""),"aria-label":"Clear",children:e.jsx(Ye,{className:"h-4 w-4"})}):null]})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Cn,{label:"Environment",value:Y,onChange:h=>Ie(h),options:[{value:"All",label:"All"},{value:"Production",label:"Production"},{value:"Sandbox",label:"Sandbox"}]})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Cn,{label:"Severity",value:ce,onChange:h=>me(h),options:[{value:"All",label:"All"},{value:"Info",label:"Info"},{value:"Warning",label:"Warning"},{value:"Critical",label:"Critical"}]})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Cn,{label:"Actor role",value:pe,onChange:h=>de(h),options:[{value:"All",label:"All"},{value:"Org Admin",label:"Org Admin"},{value:"Finance",label:"Finance"},{value:"Approver",label:"Approver"},{value:"EVzone Support",label:"EVzone Support"},{value:"System",label:"System"},{value:"Employee",label:"Employee"}]})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Cn,{label:"Module",value:ye,onChange:h=>Qe(h),options:[{value:"All",label:"All"},{value:"Security",label:"Security"},{value:"Billing",label:"Billing"},{value:"System",label:"System"},...t.map(h=>({value:h,label:h}))]})}),e.jsxs("div",{className:"md:col-span-12 flex flex-wrap items-center justify-between gap-2",children:[e.jsxs("div",{className:"text-xs text-slate-500",children:["Filtered audit entries: ",e.jsx("span",{className:"font-semibold text-slate-900",children:b.length})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Dt,{variant:"outline",onClick:()=>{Ie("All"),me("All"),de("All"),Qe("All"),he(""),l({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(fn,{className:"h-4 w-4"})," Reset"]}),e.jsxs(Dt,{variant:"outline",onClick:()=>He(!0),children:[e.jsx(qi,{className:"h-4 w-4"})," Forensic export"]})]})]})]})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[i==="overview"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs(Bs,{title:"Security posture",subtitle:"Core controls plus premium compliance.",right:e.jsx(rt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-4",children:[e.jsx(w,{title:"Audit",value:`${P}`,sub:"Today",icon:e.jsx(wt,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(w,{title:"MFA coverage",value:`${X.mfa}%`,sub:"Privileged roles",icon:e.jsx(Su,{className:"h-5 w-5"}),tone:X.mfa>=100?"good":"warn"}),e.jsx(w,{title:"Device trust",value:`${X.trustPct}%`,sub:"Trusted devices",icon:e.jsx(og,{className:"h-5 w-5"}),tone:X.trustPct>=70?"good":"warn"}),e.jsx(w,{title:"Compliance",value:`${v.length}`,sub:"Docs needing action",icon:e.jsx(yt,{className:"h-5 w-5"}),tone:v.length?"warn":"good"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs(Bs,{title:"Latest audit events",subtitle:"Recent security and compliance activity",right:e.jsx(rt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"space-y-2",children:[b.slice(0,6).map(h=>e.jsx("button",{type:"button",className:"w-full rounded-3xl border border-slate-200 bg-white p-4 text-left hover:bg-slate-50",onClick:()=>B(h.id),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(rt,{label:h.severity,tone:yb(h.severity)}),e.jsx(rt,{label:h.env,tone:h.env==="Sandbox"?"info":"neutral"}),e.jsx(rt,{label:h.role,tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:h.summary}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[uo(h.ts),"  ",h.event,"  ",h.targetId]})]}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]})},h.id)),b.length?null:e.jsx(_r,{title:"No audit data",subtitle:"No events found."})]}),e.jsx("div",{className:"mt-3",children:e.jsxs(Dt,{variant:"outline",className:"w-full",onClick:()=>o("audit"),children:[" ",e.jsx(et,{className:"h-4 w-4"})," Open audit logs"]})})]}),e.jsxs(Bs,{title:"Risk hotspots",subtitle:"Premium: dual control and expiring docs",right:e.jsx(rt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Dual control pending"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Sensitive actions awaiting approvals"})]}),e.jsx(rt,{label:`${u}`,tone:u?"warn":"good"})]}),e.jsx("div",{className:"mt-3",children:e.jsxs(Dt,{variant:"outline",className:"w-full",onClick:()=>o("dual"),children:[" ",e.jsx(et,{className:"h-4 w-4"})," Review requests"]})})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Vendor docs"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Expiring or expired"})]}),e.jsx(rt,{label:`${v.length}`,tone:v.length?"warn":"good"})]}),e.jsx("div",{className:"mt-3",children:e.jsxs(Dt,{variant:"outline",className:"w-full",onClick:()=>o("compliance"),children:[" ",e.jsx(et,{className:"h-4 w-4"})," Open compliance"]})})]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: dual control policies prevent accidental irreversible changes."})]})]})]})}),e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(Bs,{title:"Quick actions",subtitle:"Common security operations",right:e.jsx(rt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs(Dt,{variant:"outline",onClick:()=>o("mfa"),children:[" ",e.jsx(Su,{className:"h-4 w-4"})," MFA policies"]}),e.jsxs(Dt,{variant:"outline",onClick:()=>o("retention"),children:[" ",e.jsx(qi,{className:"h-4 w-4"})," Data retention"]}),e.jsxs(Dt,{variant:"outline",onClick:()=>o("support"),children:[" ",e.jsx(yt,{className:"h-4 w-4"})," Support mode"]}),e.jsxs(Dt,{variant:"primary",onClick:()=>He(!0),children:[" ",e.jsx(qi,{className:"h-4 w-4"})," Forensic export"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: use Forensic exports only for investigations and keep dual control enabled."})]}),e.jsxs(Bs,{title:"Retention snapshot",subtitle:"Top retention rules",right:e.jsx(rt,{label:"Core",tone:"neutral"}),children:[e.jsx("div",{className:"space-y-2",children:N.slice(0,5).map(h=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:h.category}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[h.retentionDays," days  ",h.purgeMode]})]}),e.jsx(rt,{label:h.legalHold?"Legal hold":"Normal",tone:h.legalHold?"warn":"neutral"})]})},h.id))}),e.jsx("div",{className:"mt-3",children:e.jsxs(Dt,{variant:"outline",className:"w-full",onClick:()=>o("retention"),children:[" ",e.jsx(et,{className:"h-4 w-4"})," Manage retention"]})})]})]})]}):null,i==="audit"?e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsxs(Bs,{title:"Audit logs",subtitle:"Core: every action is logged. Premium: forensic exports and immutable verification.",right:e.jsx(rt,{label:`${b.length}`,tone:"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Severity"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Event"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Target"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Module"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Action"})]})}),e.jsxs("tbody",{children:[b.slice(0,60).map(h=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:co(h.ts)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(rt,{label:h.severity,tone:yb(h.severity)})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:h.actor}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[h.role,"  ",h.env]})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:h.event}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[h.targetType,"  ",h.targetId]}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[h.module,h.marketplace!=="-"?`  ${h.marketplace}`:""]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(Dt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>B(h.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]})})]},h.id)),b.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10",children:e.jsx(_r,{title:"No events",subtitle:"No audit events match your filters."})})})]})]})}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Dt,{variant:"outline",onClick:ee,children:[e.jsx(gt,{className:"h-4 w-4"})," Export CSV"]}),e.jsxs(Dt,{variant:"outline",onClick:O,children:[e.jsx(gt,{className:"h-4 w-4"})," Export JSON"]}),e.jsxs(Dt,{variant:"primary",onClick:()=>He(!0),children:[e.jsx(qi,{className:"h-4 w-4"})," Forensic export"]})]})]})}):null,i==="mfa"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-5 space-y-4",children:[e.jsxs(Bs,{title:"MFA policies",subtitle:"Core: MFA policies and device trust",right:e.jsx(rt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx(gi,{enabled:c.requireMfaOrgAdmin,onChange:h=>x(K=>({...K,requireMfaOrgAdmin:h})),label:"Require MFA for Org Admin",description:"Strongly recommended"}),e.jsx(gi,{enabled:c.requireMfaFinance,onChange:h=>x(K=>({...K,requireMfaFinance:h})),label:"Require MFA for Finance",description:"Recommended"}),e.jsx(gi,{enabled:c.requireMfaApprover,onChange:h=>x(K=>({...K,requireMfaApprover:h})),label:"Require MFA for Approver",description:"Recommended"}),e.jsx(gi,{enabled:c.requireMfaSupport,onChange:h=>x(K=>({...K,requireMfaSupport:h})),label:"Require MFA for EVzone Support",description:"Required for support mode"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(pC,{label:"Trust device days",value:c.trustDeviceDays,onChange:h=>x(K=>({...K,trustDeviceDays:xC(h,1,180)})),hint:"1-180"}),e.jsx(_h,{label:"IP allowlist",value:c.ipAllowlist,onChange:h=>x(K=>({...K,ipAllowlist:h})),placeholder:"Optional",hint:"CIDR"}),e.jsxs("div",{className:"md:col-span-2 grid grid-cols-1 gap-3",children:[e.jsx(gi,{enabled:c.requireStepUpNewDevice,onChange:h=>x(K=>({...K,requireStepUpNewDevice:h})),label:"Step-up on new device",description:"Force MFA on new device sign-in"}),e.jsx(gi,{enabled:c.requireStepUpSensitive,onChange:h=>x(K=>({...K,requireStepUpSensitive:h})),label:"Step-up on sensitive actions",description:"Extra challenge for retention, keys, exports"})]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Dt,{variant:"primary",onClick:f,children:[e.jsx(ct,{className:"h-4 w-4"})," Save policy"]}),e.jsxs(Dt,{variant:"outline",onClick:()=>l({title:"Break-glass",message:"Break-glass controls live in admin security console (demo).",kind:"info"}),children:[e.jsx(ra,{className:"h-4 w-4"})," Break-glass"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: conditional access policies like geo allowlist, time restrictions, and tamper alerts."})]}),e.jsx(Bs,{title:"Login history",subtitle:"Security events",right:e.jsx(rt,{label:`${_.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[_.slice(0,6).map(h=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(rt,{label:h.outcome,tone:h.outcome==="Success"?"good":h.outcome==="Blocked"?"bad":"warn"}),e.jsx(rt,{label:h.role,tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:h.user}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[co(h.at),"  ",h.geo,"  ",h.ip]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:[h.device,"  ",h.note]})]}),e.jsx(Dn,{className:"h-5 w-5 text-slate-400"})]})},h.id)),_.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No login events."})]})})]}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs(Bs,{title:"Device trust",subtitle:"Trusted devices and session controls",right:e.jsx(rt,{label:"Core",tone:"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"User"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Device"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Last seen"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Risk"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[ae.map(h=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:h.user}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[h.role,"  ",h.geoLast]})]}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-700",children:[h.deviceType==="Phone"?e.jsx(bw,{className:"h-4 w-4"}):h.deviceType==="Laptop"?e.jsx(og,{className:"h-4 w-4"}):e.jsx(su,{className:"h-4 w-4"}),h.device]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:h.ipLast})]}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx(rt,{label:h.status,tone:h.status==="Trusted"?"good":h.status==="Revoked"?"bad":"neutral"}),h.trustedUntil?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Until ",co(h.trustedUntil)]}):null]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:uo(h.lastSeenAt)}),e.jsxs("td",{className:"px-4 py-3",children:[h.riskSignals.length?e.jsx(rt,{label:h.riskSignals[0],tone:"warn"}):e.jsx(rt,{label:"None",tone:"good"}),h.riskSignals.length>1?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["+",h.riskSignals.length-1," more"]}):null]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Dt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{l({title:"Signed out",message:"Forced sign-out executed (demo).",kind:"info"}),oe({env:"Production",severity:"Warning",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Auth.Device.Revoked",targetType:"session",targetId:h.id,summary:"Forced sign-out",metadata:{deviceId:h.id}})},disabled:h.status==="Revoked",children:[e.jsx(ra,{className:"h-4 w-4"})," Sign out"]}),e.jsxs(Dt,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>m(h.id),disabled:h.status==="Revoked",children:[e.jsx(as,{className:"h-4 w-4"})," Revoke"]})]})})]},h.id)),ae.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-10",children:e.jsx(_r,{title:"No devices",subtitle:"No device trust records found."})})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: conditional access includes geo allowlist, impossible travel checks, and tamper alert exports."})]})})]}):null,i==="retention"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(Bs,{title:"Retention settings",subtitle:"Core: data retention settings",right:e.jsx(rt,{label:"Core",tone:"neutral"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:"Retention applies per category. Legal hold prevents deletion. Use archive for audit grade categories."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Dt,{variant:"primary",onClick:A,children:[e.jsx(ct,{className:"h-4 w-4"})," Apply"]}),e.jsxs(Dt,{variant:"outline",onClick:()=>{const h=N.reduce((K,V)=>K+Math.round(2e3/Math.max(30,V.retentionDays)),0);l({title:"Preview",message:`Estimated purge impact: ${bB(h)} records.`,kind:"info"})},children:[e.jsx(ka,{className:"h-4 w-4"})," Preview purge"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: forensic exports are tamper-evident and suitable for investigations."})]}),e.jsx(Bs,{title:"Legal hold",subtitle:"Prevent deletion",right:e.jsx(rt,{label:"Core",tone:"neutral"}),children:e.jsx("div",{className:"space-y-2",children:N.filter(h=>h.legalHold).length?N.filter(h=>h.legalHold).map(h=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:h.category}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Hold active"})]}),e.jsx(rt,{label:"Legal hold",tone:"warn"})]})},h.id)):e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No legal holds enabled."})})})]}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs(Bs,{title:"Retention rules",subtitle:"Edit days, legal hold, and purge mode",right:e.jsx(rt,{label:`${N.length}`,tone:"neutral"}),children:[e.jsxs("div",{className:"space-y-2",children:[N.map(h=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:h.category}),e.jsx(rt,{label:h.purgeMode,tone:"neutral"}),e.jsx(rt,{label:h.legalHold?"Legal hold":"Normal",tone:h.legalHold?"warn":"neutral"}),e.jsx(rt,{label:h.id,tone:"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Last purge: ",h.lastPurgeAt?co(h.lastPurgeAt):"Never"]}),h.notes?e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:h.notes}):null]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-3",children:[e.jsx(pC,{label:"Days",value:h.retentionDays,onChange:K=>$(V=>V.map(Ce=>Ce.id===h.id?{...Ce,retentionDays:xC(K,1,3650)}:Ce)),hint:"1-3650"}),e.jsx(Cn,{label:"Mode",value:h.purgeMode,onChange:K=>$(V=>V.map(Ce=>Ce.id===h.id?{...Ce,purgeMode:K}:Ce)),options:[{value:"Soft delete",label:"Soft delete"},{value:"Hard delete",label:"Hard delete"},{value:"Archive",label:"Archive"}]}),e.jsx("div",{className:"mt-6",children:e.jsx(gi,{enabled:h.legalHold,onChange:K=>$(V=>V.map(Ce=>Ce.id===h.id?{...Ce,legalHold:K}:Ce)),label:"Hold",description:""})})]})]})},h.id)),N.length?null:e.jsx(_r,{title:"No rules",subtitle:"No retention rules configured."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Core: retention settings. Premium: dual control for changes and tamper-evident forensic exports."})]})})]}):null,i==="support"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsxs(Bs,{title:"Support mode",subtitle:"Core: support mode gating, no silent actions",right:e.jsx(rt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"EVzone Support access"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Role-gated support sign-in. Writes require approvals."})]}),e.jsx(rt,{label:j?"Enabled":"Disabled",tone:j?"good":"warn"})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:["Rules:",e.jsxs("ul",{className:"mt-2 space-y-1",children:[e.jsx("li",{children:"1) View-only by default"}),e.jsx("li",{children:"2) No silent actions"}),e.jsx("li",{children:"3) Step-up authentication for sensitive actions"}),e.jsx("li",{children:"4) Always audited and visible to org admins"})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs(Dt,{variant:"primary",onClick:()=>F("enable"),disabled:j,children:[e.jsx(yt,{className:"h-4 w-4"})," Enable"]}),e.jsxs(Dt,{variant:"danger",onClick:()=>F("disable"),disabled:!j,children:[e.jsx(yt,{className:"h-4 w-4"})," Disable"]})]})]}),e.jsx(Bs,{title:"Support sessions",subtitle:"Active and recent",right:e.jsx(rt,{label:`${R.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[R.map(h=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(rt,{label:h.env,tone:h.env==="Sandbox"?"info":"neutral"}),e.jsx(rt,{label:h.endedAt?"Closed":"Active",tone:h.endedAt?"neutral":"info"}),e.jsx(rt,{label:h.writeEnabled?"Write enabled":"View only",tone:h.writeEnabled?"warn":"neutral"}),e.jsx(rt,{label:h.id,tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:h.agent}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Started ",uo(h.startedAt),"  Reason: ",h.reason]}),h.writeRequests.length?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Write requests: ",h.writeRequests.join(", ")]}):null]}),h.endedAt?null:e.jsxs(Dt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{U(K=>K.map(V=>V.id===h.id?{...V,endedAt:Date.now()}:V)),oe({env:h.env,severity:"Info",actor:n,role:n,ip:"-",device:"-",module:"System",marketplace:"-",event:"Support.Session.End",targetType:"support_session",targetId:h.id,summary:"Support session ended",metadata:{}}),l({title:"Closed",message:"Session ended.",kind:"success"})},children:[e.jsx(Ye,{className:"h-4 w-4"})," End"]})]})},h.id)),R.length?null:e.jsx(_r,{title:"No sessions",subtitle:"No support sessions."})]})})]})}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs(Bs,{title:"Support write requests",subtitle:"Premium: dual control gating",right:e.jsx(rt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"space-y-2",children:[q.filter(h=>h.actionKey==="support_write_action").map(h=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(rt,{label:h.env,tone:h.env==="Sandbox"?"info":"neutral"}),e.jsx(rt,{label:h.status,tone:h.status==="Approved"?"good":h.status==="Rejected"?"bad":"warn"}),e.jsx(rt,{label:h.id,tone:"neutral"}),e.jsx(rt,{label:`${h.approvals.length}/${h.required} approvals`,tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:h.reason}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Requested ",uo(h.createdAt)," by ",h.requestedBy]}),h.approvals.length?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Approvals: ",h.approvals.map(K=>`${K.by}`).join(", ")]}):e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"No approvals yet."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Dt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>ue(h.id),disabled:n==="EVzone Support"||h.status!=="Pending",title:n==="EVzone Support"?"Support cannot approve":"Approve",children:[e.jsx(tt,{className:"h-4 w-4"})," Approve"]}),e.jsxs(Dt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Ke(h.id),disabled:n==="EVzone Support"||h.status!=="Pending",children:[e.jsx(Ye,{className:"h-4 w-4"})," Reject"]})]})]})},h.id)),q.filter(h=>h.actionKey==="support_write_action").length?null:e.jsx(_r,{title:"No requests",subtitle:"No support write requests."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Support mode gating: EVzone Support cannot silently change anything. Every write action must be requested and approved."})]})})]}):null,i==="dual"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-5 space-y-4",children:[e.jsx(Bs,{title:"Dual control policies",subtitle:"Premium: two-person control for sensitive actions",right:e.jsx(rt,{label:"Premium",tone:"info"}),children:e.jsx("div",{className:"space-y-2",children:T.map(h=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:h.title}),e.jsx(rt,{label:h.enabled?"Enabled":"Disabled",tone:h.enabled?"good":"neutral"}),e.jsx(rt,{label:`${h.approversRequired} approver(s)`,tone:"neutral"}),h.stepUpMfaRequired?e.jsx(rt,{label:"Step-up MFA",tone:"info"}):e.jsx(rt,{label:"No step-up",tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:h.notes}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(gi,{enabled:h.enabled,onChange:K=>{k(V=>V.map(Ce=>Ce.id===h.id?{...Ce,enabled:K}:Ce)),oe({env:"Production",severity:"Info",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Policy.DualControl.Updated",targetType:"dual_control_policy",targetId:h.id,summary:"Dual control policy updated",metadata:{actionKey:h.actionKey,enabled:K}}),l({title:"Updated",message:"Policy updated.",kind:"success"})},label:"Enabled"}),e.jsx(Cn,{label:"Approvers",value:`${h.approversRequired}`,onChange:K=>{const V=Number(K)||2;k(Ce=>Ce.map(I=>I.id===h.id?{...I,approversRequired:V}:I))},options:[{value:"2",label:"2"},{value:"3",label:"3"}]})]})]}),e.jsx(yt,{className:"h-5 w-5 text-slate-400"})]})},h.id))})}),e.jsx(Bs,{title:"Simulation",subtitle:"See what a sensitive action would require",right:e.jsx(rt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Scenario"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(Cn,{label:"Action",value:"forensic_export_prod",onChange:()=>{},options:[{value:"forensic_export_prod",label:"Forensic export (production)"},{value:"retention_change",label:"Change retention"},{value:"mfa_policy_change",label:"Change MFA policy"},{value:"support_write_action",label:"Support write action"},{value:"rotate_prod_key",label:"Rotate production keys"}],disabled:!0}),e.jsx(Cn,{label:"Environment",value:"Production",onChange:()=>{},options:[{value:"Production",label:"Production"}],disabled:!0})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"With dual control enabled: two approvals and step-up MFA are required before export."})]})})]}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsx(Bs,{title:"Requests",subtitle:"Approve or reject",right:e.jsx(rt,{label:`${q.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[q.map(h=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(rt,{label:h.env,tone:h.env==="Sandbox"?"info":"neutral"}),e.jsx(rt,{label:h.status,tone:h.status==="Approved"?"good":h.status==="Rejected"?"bad":"warn"}),e.jsx(rt,{label:h.actionKey,tone:"neutral"}),e.jsx(rt,{label:`${h.approvals.length}/${h.required} approvals`,tone:"neutral"}),e.jsx(rt,{label:h.id,tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:h.reason}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Requested ",uo(h.createdAt)," by ",h.requestedBy]}),h.approvals.length?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Approvals: ",h.approvals.map(K=>`${K.by}`).join(", ")]}):e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"No approvals yet."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Dt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>ue(h.id),disabled:n==="EVzone Support"||h.status!=="Pending",children:[e.jsx(tt,{className:"h-4 w-4"})," Approve"]}),e.jsxs(Dt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Ke(h.id),disabled:n==="EVzone Support"||h.status!=="Pending",children:[e.jsx(Ye,{className:"h-4 w-4"})," Reject"]})]})]})},h.id)),q.length?null:e.jsx(_r,{title:"No requests",subtitle:"No dual control requests."})]})})})]}):null,i==="forensics"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsxs(Bs,{title:"Forensic exports",subtitle:"Premium: tamper-evident exports",right:e.jsx(rt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:"Forensic exports create a hash chain over selected audit entries. Verification recomputes the chain."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2",children:[e.jsxs(Dt,{variant:"primary",onClick:()=>He(!0),children:[e.jsx(qi,{className:"h-4 w-4"})," New forensic export"]}),e.jsxs(Dt,{variant:"outline",onClick:()=>l({title:"Tip",message:"Keep dual control enabled for production exports.",kind:"info"}),children:[e.jsx(vn,{className:"h-4 w-4"})," Tip"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: forensic exports can be used for investigations and compliance audits."})]})}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsx(Bs,{title:"Export jobs",subtitle:"Create, download, verify",right:e.jsx(rt,{label:`${G.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[G.map(h=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(rt,{label:h.env,tone:h.env==="Sandbox"?"info":"neutral"}),e.jsx(rt,{label:h.status,tone:h.status==="Ready"?"good":"bad"}),e.jsx(rt,{label:h.algo,tone:"neutral"}),typeof h.verifiedOk=="boolean"?e.jsx(rt,{label:h.verifiedOk?"Verified":"Mismatch",tone:h.verifiedOk?"good":"bad"}):e.jsx(rt,{label:"Not verified",tone:"neutral"}),e.jsx(rt,{label:h.id,tone:"neutral"})]}),e.jsxs("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:[h.rangeLabel,"  ",h.recordCount," record(s)"]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",uo(h.createdAt)," by ",h.createdBy]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Final hash: ",e.jsxs("span",{className:"font-mono",children:[h.finalHash.slice(0,10),""]})]}),h.verifiedAt?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Verified ",uo(h.verifiedAt)]}):null]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Dt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>re(h.id),children:[e.jsx(gt,{className:"h-4 w-4"})," Download"]}),e.jsxs(Dt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>E(h.id),children:[e.jsx(tt,{className:"h-4 w-4"})," Verify"]})]})]})},h.id)),G.length?null:e.jsx(_r,{title:"No forensic exports",subtitle:"Create a forensic export to start."})]})})})]}):null,i==="compliance"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-5 space-y-4",children:[e.jsxs(Bs,{title:"Compliance center",subtitle:"Premium: attestations and vendor docs",right:e.jsx(rt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:"Keep policy attestations current and vendor compliance documents valid."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2",children:[e.jsxs(Dt,{variant:"primary",onClick:()=>{xe({vendor:"",docType:"License",fileName:"",expiryDate:"",verified:!1,notes:""}),Pe(!0)},children:[e.jsx(pt,{className:"h-4 w-4"})," Add vendor doc"]}),e.jsxs(Dt,{variant:"outline",onClick:()=>{var h;Ae({attId:((h=Ge[0])==null?void 0:h.id)||"ATT-001",confirm:!1,note:""}),M(!0)},children:[e.jsx(ct,{className:"h-4 w-4"})," Attest policy"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: store evidence attachments and expiry alerts in Notifications Center."})]}),e.jsx(Bs,{title:"Policy attestations",subtitle:"Track completion by role",right:e.jsx(rt,{label:`${Ge.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[Ge.map(h=>{const K=h.requiredForRoles.includes(n),V=h.completion.some(I=>I.user===n),Ce=h.dueBy?h.dueBy<Date.now()+7*24*60*60*1e3:!1;return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:h.policyName}),e.jsx(rt,{label:h.version,tone:"neutral"}),K?e.jsx(rt,{label:"Required",tone:"warn"}):e.jsx(rt,{label:"Optional",tone:"neutral"}),V?e.jsx(rt,{label:"Done",tone:"good"}):e.jsx(rt,{label:"Pending",tone:K?"warn":"neutral"}),Ce?e.jsx(rt,{label:"Due soon",tone:"warn"}):null]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Updated ",uo(h.lastUpdatedAt),"  Completed ",h.completion.length]}),h.dueBy?e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Due by ",co(h.dueBy)]}):null]}),e.jsxs(Dt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Ae({attId:h.id,confirm:!1,note:""}),M(!0)},disabled:V,children:[e.jsx(ct,{className:"h-4 w-4"})," Attest"]})]})},h.id)}),Ge.length?null:e.jsx(_r,{title:"No policies",subtitle:"No attestations configured."})]})})]}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs(Bs,{title:"Vendor compliance docs",subtitle:"Licenses, insurance, and more",right:e.jsx(rt,{label:`${je.length}`,tone:"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Doc"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Expiry"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Verified"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[je.map(h=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:h.vendor}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:h.id})]}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[h.docType,"  ",h.fileName]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(rt,{label:h.status,tone:jB(h.status)})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:h.expiryDate?co(h.expiryDate):"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(rt,{label:h.verified?"Yes":"No",tone:h.verified?"good":"warn"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Dt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Ue(K=>K.map(V=>V.id===h.id?{...V,verified:!V.verified,uploadedAt:Date.now(),uploadedBy:n}:V)),l({title:"Updated",message:"Verification updated.",kind:"success"}),oe({env:"Production",severity:"Info",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Compliance.VendorDoc.Updated",targetType:"vendor_doc",targetId:h.id,summary:"Vendor doc verification updated",metadata:{verified:!h.verified}})},children:[e.jsx(tt,{className:"h-4 w-4"})," Toggle verify"]}),e.jsxs(Dt,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>{Ue(K=>K.filter(V=>V.id!==h.id)),l({title:"Deleted",message:"Doc removed.",kind:"info"}),oe({env:"Production",severity:"Warning",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Compliance.VendorDoc.Updated",targetType:"vendor_doc",targetId:h.id,summary:"Vendor doc deleted",metadata:{}})},children:[e.jsx(as,{className:"h-4 w-4"})," Remove"]})]})})]},h.id)),je.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-10",children:e.jsx(_r,{title:"No docs",subtitle:"Add a vendor compliance doc."})})})]})]})}),ve?e.jsxs("div",{className:"mt-3 rounded-2xl bg-rose-50 p-3 text-xs text-rose-800 ring-1 ring-rose-200",children:["Attention: ",ve," vendor doc(s) are missing or expired."]}):e.jsx("div",{className:"mt-3 rounded-2xl bg-emerald-50 p-3 text-xs text-emerald-900 ring-1 ring-emerald-200",children:"All critical vendor docs look healthy."})]})})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"Z Security, Audit and Compliance v2. Core: audit logs, MFA policies, device trust, retention, support gating. Premium: dual-control policies, tamper-evident forensic exports, and compliance center."})})]})}),e.jsx(yB,{open:Fe,title:ne?`Audit ${ne.id}`:"Audit",subtitle:ne?`${ne.event}  ${co(ne.ts)}`:"Details",onClose:()=>ke(!1),footer:ne?e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Core: every action logged. Premium: forensic exports for investigations."}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Dt,{variant:"outline",onClick:async()=>{if(ne)try{await navigator.clipboard.writeText(JSON.stringify(ne,null,2)),l({title:"Copied",message:"Audit JSON copied.",kind:"success"})}catch{l({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},children:[e.jsx(ls,{className:"h-4 w-4"})," Copy JSON"]}),e.jsxs(Dt,{variant:"primary",onClick:()=>He(!0),children:[e.jsx(qi,{className:"h-4 w-4"})," Forensic export"]})]})]}):null,children:ne?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(rt,{label:ne.severity,tone:yb(ne.severity)}),e.jsx(rt,{label:ne.env,tone:ne.env==="Sandbox"?"info":"neutral"}),e.jsx(rt,{label:ne.role,tone:"neutral"}),e.jsx(rt,{label:ne.module,tone:"neutral"}),ne.marketplace!=="-"?e.jsx(rt,{label:ne.marketplace,tone:"neutral"}):null]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:ne.summary}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Actor: ",ne.actor,"  IP ",ne.ip,"  Device ",ne.device]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Target: ",ne.targetType,"  ",ne.targetId]})]}),e.jsx(Bs,{title:"Metadata",subtitle:"Raw payload",right:e.jsx(rt,{label:"Core",tone:"neutral"}),children:e.jsx("pre",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-800 overflow-auto",children:JSON.stringify(ne.metadata,null,2)})}),ne.diff?e.jsx(Bs,{title:"Diff",subtitle:"Before and after",right:e.jsx(rt,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx("pre",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-800 overflow-auto",children:JSON.stringify(ne.diff.before,null,2)}),e.jsx("pre",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-800 overflow-auto",children:JSON.stringify(ne.diff.after,null,2)})]})}):null,e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Audit is linked to approvals and support actions. No silent actions are permitted."})]}):null}),e.jsxs(Gh,{open:Te!==null,title:Te==="enable"?"Enable support mode":"Disable support mode",subtitle:"Reason is required and always audited.",onClose:()=>Ee(null),actions:[{label:"Confirm",onClick:D,variant:Te==="disable"?"danger":"default"}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Dt,{variant:"outline",onClick:()=>Ee(null),children:"Cancel"}),e.jsxs(Dt,{variant:Te==="disable"?"danger":"primary",onClick:D,children:[e.jsx(yt,{className:"h-4 w-4"})," Confirm"]})]}),children:[e.jsx(Bh,{label:"Reason",value:Re,onChange:ze,placeholder:"Example: troubleshooting billing delivery",rows:4}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"If dual control is enabled, disabling support requires approvals."})]}),e.jsx(Gh,{open:qe,title:"Create forensic export",subtitle:"Premium: tamper-evident export of audit logs.",onClose:()=>He(!1),actions:[{label:"Generate",onClick:p}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Dt,{variant:"outline",onClick:()=>He(!1),children:"Cancel"}),e.jsxs(Dt,{variant:"primary",onClick:p,children:[e.jsx(qi,{className:"h-4 w-4"})," Generate"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Cn,{label:"Environment",value:_e.env,onChange:h=>le(K=>({...K,env:h})),options:[{value:"Production",label:"Production"},{value:"Sandbox",label:"Sandbox"}],hint:"Production may require approvals"}),e.jsx(Cn,{label:"Range",value:_e.range,onChange:h=>le(K=>({...K,range:h})),options:[{value:"Last 7 days",label:"Last 7 days"},{value:"Last 30 days",label:"Last 30 days"},{value:"Custom",label:"Custom"}]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Bh,{label:"Reason",value:_e.reason,onChange:h=>le(K=>({...K,reason:h})),placeholder:"Required for production exports",rows:4,hint:"Audit logged"})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Forensic export bundles include a manifest and a hash chain. Verification recomputes the chain."})]})}),e.jsx(Gh,{open:z,title:"Add vendor compliance doc",subtitle:"Premium: store evidence and track expiry.",onClose:()=>Pe(!1),actions:[{label:"Save",onClick:se}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Dt,{variant:"outline",onClick:()=>Pe(!1),children:"Cancel"}),e.jsxs(Dt,{variant:"primary",onClick:se,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(_h,{label:"Vendor",value:Be.vendor,onChange:h=>xe(K=>({...K,vendor:h})),placeholder:"Vendor name"}),e.jsx(Cn,{label:"Doc type",value:Be.docType,onChange:h=>xe(K=>({...K,docType:h})),options:[{value:"License",label:"License"},{value:"Insurance",label:"Insurance"},{value:"Tax",label:"Tax"},{value:"Safety",label:"Safety"},{value:"Other",label:"Other"}]}),e.jsx(_h,{label:"File name",value:Be.fileName,onChange:h=>xe(K=>({...K,fileName:h})),placeholder:"doc.pdf",hint:"Simulated"}),e.jsx(_h,{label:"Expiry",type:"date",value:Be.expiryDate,onChange:h=>xe(K=>({...K,expiryDate:h})),hint:"Optional"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(gi,{enabled:Be.verified,onChange:h=>xe(K=>({...K,verified:h})),label:"Verified",description:"Mark as verified after review"})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Bh,{label:"Notes",value:Be.notes,onChange:h=>xe(K=>({...K,notes:h})),placeholder:"Optional",rows:4})})]})}),e.jsx(Gh,{open:Ne,title:"Policy attestation",subtitle:"Premium: policy attestations are auditable.",onClose:()=>M(!1),actions:[{label:"Attest",onClick:y}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Dt,{variant:"outline",onClick:()=>M(!1),children:"Cancel"}),e.jsxs(Dt,{variant:"primary",onClick:y,children:[e.jsx(ct,{className:"h-4 w-4"})," Attest"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx(Cn,{label:"Policy",value:H.attId,onChange:h=>Ae(K=>({...K,attId:h})),options:Ge.map(h=>({value:h.id,label:`${h.policyName} (${h.version})`}))}),e.jsxs("label",{className:"flex items-start gap-3 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("input",{type:"checkbox",className:"mt-1 h-4 w-4 rounded border-slate-300",checked:H.confirm,onChange:h=>Ae(K=>({...K,confirm:h.target.checked}))}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Confirm"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"I have read and agree to follow this policy."})]})]}),e.jsx(Bh,{label:"Note",value:H.note,onChange:h=>Ae(K=>({...K,note:h})),placeholder:"Optional",rows:3})]})})]});function w({title:h,value:K,sub:V,icon:Ce,tone:I}){const te=I==="good"?"bg-emerald-50 text-emerald-700":I==="warn"?"bg-amber-50 text-amber-800":I==="bad"?"bg-rose-50 text-rose-700":I==="info"?"bg-blue-50 text-blue-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:h}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:K}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:V})]}),e.jsx("div",{className:en("grid h-10 w-10 place-items-center rounded-2xl",te),children:Ce})]})})}}const jg={green:"#03CD8C",orange:"#F77F00"};function bn(...t){return t.filter(Boolean).join(" ")}function za(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function Dm(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function gd(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function jt({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:bn("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function kB(t){return t==="Critical"?"bad":t==="Warning"?"warn":"info"}function fC(t){return t==="Critical"?"bad":t==="High"?"warn":t==="Medium"?"info":"neutral"}function CB(t){return t==="Major Outage"?"bad":t==="Partial Outage"?"warn":t==="Degraded"?"info":"neutral"}function Ms({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:jg.green}:t==="accent"?{background:jg.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:bn(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Tc({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:bn("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:bn("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function vC({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:bn(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:bn("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function fd({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:bn(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:bn("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function zh({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4,disabled:i}){return e.jsxs("div",{className:bn(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:o=>a(o.target.value),placeholder:l,rows:r,disabled:i,className:bn("mt-2 w-full rounded-2xl border p-3 text-sm font-semibold shadow-sm outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function SB({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:bn("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function Nb({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="980px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:12,scale:.985},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:12,scale:.985},transition:{duration:.18},className:"fixed inset-x-0 top-[7vh] z-50 mx-auto w-[min(1040px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(SB,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[72vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function bC({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r}){return d.useEffect(()=>{const i=o=>o.key==="Escape"&&n();return t&&window.addEventListener("keydown",i),()=>window.removeEventListener("keydown",i)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,x:18},animate:{opacity:1,x:0},exit:{opacity:0,x:18},transition:{duration:.18},className:bn("fixed z-50 overflow-hidden border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]","left-2 right-2 bottom-2 top-[10vh] rounded-[28px]","lg:left-auto lg:right-4 lg:top-4 lg:bottom-4 lg:w-[760px]"),role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-base font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"h-full min-h-0 overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function AB({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(480px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:bn("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function Pl({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function Im({title:t,subtitle:s}){return e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(sy,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:s})]})}function EB(){const t=["Billing","Security","Integrations","Rides & Logistics","EVs & Charging","E-Commerce","Finance & Payments","Travel & Tourism","Other"],s=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],[a,l]=d.useState([]),n=F=>{const D=za("toast");l(m=>[{id:D,...F},...m].slice(0,4)),window.setTimeout(()=>l(m=>m.filter(A=>A.id!==D)),3200)},[r,i]=d.useState("Org Admin"),o=r==="Org Admin",c=r==="EVzone Support",x=o||c,[j,g]=d.useState(!0),[N,$]=d.useState(!0),[T,k]=d.useState({enabled:!0,allowSupportToToggle:!1,requireOrgApproval:!0,storageDays:30,noticeText:"This support session may be recorded for security, QA, and incident review."}),[q,L]=d.useState(()=>{const F=Date.now();return[{id:"CASE-001",createdAt:F-2*24*60*60*1e3,updatedAt:F-40*60*1e3,createdBy:"Finance Desk",requesterRole:"Finance",title:"Invoice email delivery is delayed",description:"AP email did not receive weekly invoice. Need to confirm delivery logs and retry policy.",module:"Billing",marketplace:"-",priority:"High",status:"In Progress",assignedTo:"EVzone Support",tags:["billing","email","weekly"],attachments:1,watchers:["Org Admin","Finance Desk"],timeline:[{id:za("T"),at:F-2*24*60*60*1e3,by:"Finance Desk",message:"Invoice not received",kind:"customer"},{id:za("T"),at:F-23*60*60*1e3,by:"EVzone Support",message:"Investigating delivery logs and AP routing.",kind:"support"},{id:za("T"),at:F-40*60*1e3,by:"System",message:"Webhook delivery retry observed (502).",kind:"system"}]},{id:"CASE-002",createdAt:F-6*60*60*1e3,updatedAt:F-55*60*1e3,createdBy:"Org Admin",requesterRole:"Org Admin",title:"Need audit export for dispute",description:"Generate a forensic export for last 30 days for compliance review.",module:"Security",marketplace:"-",priority:"Medium",status:"Open",assignedTo:"EVzone Support",tags:["audit","forensic"],attachments:0,watchers:["Org Admin"],timeline:[{id:za("T"),at:F-6*60*60*1e3,by:"Org Admin",message:"Please help generate forensic export",kind:"customer"},{id:za("T"),at:F-55*60*1e3,by:"EVzone Support",message:"Ready to proceed. Require approval for production export.",kind:"support"}]}]}),[R,U]=d.useState(()=>{const F=Date.now();return[{id:"SUP-SESSION-001",startedAt:F-3*60*60*1e3,startedBy:"EVzone Support",orgVisible:!0,bannerEnabled:!0,watermarkEnabled:!0,mode:"View-only",recordingEnabled:!1,recordingApproved:!1,relatedCaseId:"CASE-001",toolsScope:{readOnly:!0,guidedActionsAllowed:!1},actions:[{id:za("A"),at:F-175*60*1e3,by:"EVzone Support",type:"Read-only check",label:"Check invoice delivery logs",outcome:"OK",notes:"Email channel shows delayed queue."},{id:za("A"),at:F-155*60*1e3,by:"EVzone Support",type:"Read-only check",label:"Verify invoice group routing",outcome:"OK",notes:"AP email matches invoice group."},{id:za("A"),at:F-45*60*1e3,by:"EVzone Support",type:"Read-only check",label:"Inspect webhook deliveries",outcome:"Failed",notes:"502 from ERP endpoint, retrying."}]}]}),[ae,ie]=d.useState(()=>{const F=Date.now();return[{id:"INC-001",createdAt:F-10*60*60*1e3,createdBy:"EVzone Support",title:"Webhook delivery delays (some orgs)",severity:"Degraded",status:"Monitoring",message:"Some webhook endpoints experiencing intermittent 5xx. Retries in progress.",modules:["Integrations","Billing"],pinned:!0,visibleToOrgAdmins:!0,updates:[{id:za("U"),at:F-10*60*60*1e3,status:"Investigating",message:"We are investigating intermittent 5xx errors.",by:"EVzone Support"},{id:za("U"),at:F-7*60*60*1e3,status:"Identified",message:"Issue identified on edge gateway. Rolling restart.",by:"EVzone Support"},{id:za("U"),at:F-2*60*60*1e3,status:"Monitoring",message:"Recovery in progress; monitoring success rate.",by:"EVzone Support"}]}]}),[_,W]=d.useState(()=>{const F=Date.now();return[{id:"AUD-001",at:F-3*60*60*1e3,severity:"Warning",actor:"EVzone Support",role:"EVzone Support",event:"Support session started",why:"Troubleshoot invoice delivery",metadata:{sessionId:"SUP-SESSION-001",caseId:"CASE-001"}},{id:"AUD-002",at:F-2*60*60*1e3,severity:"Info",actor:"Org Admin",role:"Org Admin",event:"Support mode verified",why:"Org admin visibility",metadata:{supportEnabled:!0,watermark:!0}}]}),J=[{id:"tool_delivery_logs",label:"Inspect delivery logs",module:"Billing",kind:"Read-only check",risk:"Low",description:"Check invoice delivery status by channel (Email/WhatsApp/WeChat/SMS) and latest attempts."},{id:"tool_invoice_group",label:"Validate invoice group routing",module:"Billing",kind:"Read-only check",risk:"Low",description:"Verify invoice group AP emails, CCs, frequency, and mapping for the selected entity."},{id:"tool_webhook_inspector",label:"Webhook inspector",module:"Integrations",kind:"Read-only check",risk:"Medium",description:"Inspect a delivery payload, signature headers, status, and retry trace."},{id:"tool_resend_invoice",label:"Resend invoice (guided)",module:"Billing",kind:"Guided action",risk:"High",description:"Guided action that requests approval, re-validates recipients, and then re-sends invoice."},{id:"tool_rotate_key",label:"Rotate production API key (guided)",module:"Integrations",kind:"Guided action",risk:"High",description:"Guided rotation using dual-control approval with downtime warning."},{id:"tool_forensic_export",label:"Generate forensic export",module:"Security",kind:"Guided action",risk:"High",description:"Creates a tamper-evident audit export (production requires approval)."}],[we,G]=d.useState("cases"),[be,Ge]=d.useState(""),[Me,je]=d.useState(!1),[Ue,Oe]=d.useState({title:"",description:"",module:"Billing",marketplace:"-",priority:"Medium",tags:[]}),[he,Y]=d.useState(!1),[Ie,ce]=d.useState(null),me=d.useMemo(()=>Ie&&q.find(F=>F.id===Ie)||null,[q,Ie]),[pe,de]=d.useState(!1),[ye,Qe]=d.useState(null),Fe=d.useMemo(()=>ye&&R.find(F=>F.id===ye)||null,[R,ye]),[ke,fe]=d.useState(!1),[Ve,ne]=d.useState({title:"",severity:"Info",status:"Investigating",message:"",modules:["Billing"],pinned:!1,visibleToOrgAdmins:!0}),[Te,Ee]=d.useState(!1),[Re,ze]=d.useState(""),qe=d.useMemo(()=>q.filter(F=>F.status!=="Closed").length,[q]),He=d.useMemo(()=>R.filter(F=>!F.endedAt).length,[R]),_e=d.useMemo(()=>ae.filter(F=>F.pinned&&F.visibleToOrgAdmins).length,[ae]),le=d.useMemo(()=>{const F=be.trim().toLowerCase();return q.filter(D=>F?`${D.id} ${D.title} ${D.description} ${D.module} ${D.marketplace} ${D.priority} ${D.status} ${D.tags.join(" ")}`.toLowerCase().includes(F):!0).slice().sort((D,m)=>m.updatedAt-D.updatedAt)},[q,be]),z=d.useMemo(()=>{const F=be.trim().toLowerCase();return R.filter(D=>F?`${D.id} ${D.startedBy} ${D.mode} ${D.relatedCaseId||""}`.toLowerCase().includes(F):!0).slice().sort((D,m)=>(m.endedAt||m.startedAt)-(D.endedAt||D.startedAt))},[R,be]),Pe=d.useMemo(()=>{const F=be.trim().toLowerCase();return ae.filter(D=>c||o?!0:D.visibleToOrgAdmins).filter(D=>F?`${D.id} ${D.title} ${D.severity} ${D.status} ${D.message} ${D.modules.join(" ")}`.toLowerCase().includes(F):!0).slice().sort((D,m)=>m.createdAt-D.createdAt)},[ae,be,c,o]),Be=d.useMemo(()=>{const F=be.trim().toLowerCase();return _.filter(D=>F?`${D.id} ${D.actor} ${D.role} ${D.event} ${D.why} ${JSON.stringify(D.metadata)}`.toLowerCase().includes(F):!0).slice().sort((D,m)=>m.at-D.at)},[_,be]),xe=d.useMemo(()=>{const F=be.trim().toLowerCase();return J.filter(D=>F?`${D.label} ${D.module} ${D.kind} ${D.risk} ${D.description}`.toLowerCase().includes(F):!0)},[be]),Ne=F=>{const D={id:za("AUD"),at:F.at??Date.now(),severity:F.severity,actor:F.actor,role:F.role,event:F.event,why:F.why,metadata:F.metadata};W(m=>[D,...m].slice(0,600))},M=()=>{Oe({title:"",description:"",module:"Billing",marketplace:"-",priority:"Medium",tags:[]}),je(!0)},H=()=>{const F=String(Ue.title||"").trim(),D=String(Ue.description||"").trim();if(F.length<4||D.length<8){n({title:"Missing",message:"Provide a title and description.",kind:"warn"});return}const m=Date.now(),A=za("CASE"),f={id:A,createdAt:m,updatedAt:m,createdBy:c?"EVzone Support":r,requesterRole:r,title:F,description:D,module:Ue.module||"Billing",marketplace:Ue.marketplace||"-",priority:Ue.priority||"Medium",status:"New",assignedTo:"EVzone Support",tags:Array.isArray(Ue.tags)?Ue.tags:[],attachments:0,watchers:["Org Admin"],timeline:[{id:za("T"),at:m,by:r,message:"Case created",kind:"system"}]};L(B=>[f,...B]),Ne({severity:"Info",actor:r,role:r,event:"Support case created",why:"Request support",metadata:{caseId:A,module:f.module,priority:f.priority}}),n({title:"Created",message:`Case ${A} created.`,kind:"success"}),je(!1),ce(A),Y(!0)},Ae=(F,D,m)=>{const A=D.trim();if(!A)return;const f=Date.now();L(B=>B.map(p=>p.id===F?{...p,updatedAt:f,timeline:[...p.timeline,{id:za("T"),at:f,by:r,message:A,kind:m}],status:p.status==="New"?"Open":p.status}:p)),Ne({severity:"Info",actor:r,role:r,event:"Case message added",why:"Case collaboration",metadata:{caseId:F,kind:m}})},oe=F=>{if(!j){n({title:"Blocked",message:"Support mode is disabled by the organization.",kind:"warn"});return}if(!c){n({title:"Support role required",message:"Switch to EVzone Support to start a session.",kind:"info"});return}const D=Date.now(),m={id:za("SUP"),startedAt:D,startedBy:"EVzone Support",orgVisible:!0,bannerEnabled:!0,watermarkEnabled:N,mode:"View-only",recordingEnabled:!1,recordingApproved:!T.requireOrgApproval,relatedCaseId:F,toolsScope:{readOnly:!0,guidedActionsAllowed:!1},actions:[]};U(A=>[m,...A]),Ne({severity:"Warning",actor:"EVzone Support",role:"EVzone Support",event:"Support session started",why:"Troubleshooting",metadata:{sessionId:m.id,caseId:F||null,mode:m.mode}}),n({title:"Session started",message:`Session ${m.id} started.`,kind:"success"}),Qe(m.id),de(!0)},De=F=>{const D=Date.now();U(m=>m.map(A=>A.id===F?{...A,endedAt:D}:A)),Ne({severity:"Info",actor:r,role:r,event:"Support session ended",why:"Session closed",metadata:{sessionId:F}}),n({title:"Ended",message:"Session ended.",kind:"info"})},$e=F=>{const D=Fe;if(!D||D.endedAt){n({title:"No active session",message:"Open an active support session first.",kind:"warn"});return}if(F.kind==="Read-only check"&&!D.toolsScope.readOnly){n({title:"Blocked",message:"Read-only tools are disabled for this session.",kind:"warn"});return}if(F.kind==="Guided action"&&!D.toolsScope.guidedActionsAllowed){n({title:"Approval required",message:"Guided actions are not enabled. Request approval.",kind:"warn"});return}const A=F.risk==="High"?.75:F.risk==="Medium"?.85:.92,f=Math.random()<A,B=f?"OK":"Failed",p=Date.now(),E={id:za("ACT"),at:p,by:r,type:F.kind,label:F.label,outcome:B,notes:F.kind==="Read-only check"?f?"Check completed. No write actions performed.":"Check failed. Review integrations and retry.":f?"Guided action completed with guardrails.":"Guided action failed. Requires manual review."};U(se=>se.map(y=>y.id===D.id?{...y,actions:[...y.actions,E]}:y)),Ne({severity:F.kind==="Guided action"&&F.risk==="High"?"Warning":"Info",actor:r,role:r,event:"Support tool executed",why:F.kind==="Read-only check"?"Troubleshooting":"Guided remediation",metadata:{sessionId:D.id,tool:F.id,outcome:B}}),n({title:f?"Done":"Failed",message:`${F.label}: ${B}.`,kind:f?"success":"warn"})},ge=F=>{U(D=>D.map(m=>m.id===F?{...m,mode:"Guided actions"}:m)),Ne({severity:"Warning",actor:r,role:r,event:"Guided actions requested",why:"Support remediation request",metadata:{sessionId:F,requestedBy:r}}),n({title:"Requested",message:"Guided actions request created (demo).",kind:"info"})},ue=F=>{if(!o){n({title:"Org Admin required",message:"Only Org Admin can approve guided actions.",kind:"warn"});return}U(D=>D.map(m=>m.id===F?{...m,toolsScope:{...m.toolsScope,guidedActionsAllowed:!0},mode:"Guided actions"}:m)),Ne({severity:"Info",actor:r,role:r,event:"Guided actions approved",why:"Enable remediation",metadata:{sessionId:F}}),n({title:"Approved",message:"Guided actions enabled for this session.",kind:"success"})},Ke=()=>{if(!Fe||Fe.endedAt){n({title:"No active session",message:"Open an active session first.",kind:"warn"});return}ze(""),Ee(!0)},b=()=>{if(!Fe)return;const F=Fe;if(!T.enabled){n({title:"Disabled",message:"Recording is disabled by policy.",kind:"warn"}),Ee(!1);return}if(c&&!T.allowSupportToToggle){n({title:"Blocked",message:"Support cannot toggle recording. Org Admin must approve.",kind:"warn"}),Ee(!1);return}if(T.requireOrgApproval&&!o){n({title:"Approval required",message:"Recording toggle requires Org Admin approval.",kind:"warn"}),Ee(!1);return}if(Re.trim().length<8){n({title:"Reason required",message:"Provide a clear reason.",kind:"warn"});return}const D=!F.recordingEnabled;U(m=>m.map(A=>A.id===F.id?{...A,recordingEnabled:D,recordingApproved:!0}:A)),Ne({severity:"Warning",actor:r,role:r,event:D?"Session recording enabled":"Session recording disabled",why:"Policy-controlled recording toggle",metadata:{sessionId:F.id,reason:Re.trim(),storageDays:T.storageDays}}),n({title:"Updated",message:D?"Recording enabled.":"Recording disabled.",kind:"success"}),Ee(!1)},v=()=>{ne({title:"",severity:"Info",status:"Investigating",message:"",modules:["Billing"],pinned:!1,visibleToOrgAdmins:!0}),fe(!0)},u=()=>{if(!x){n({title:"Blocked",message:"You cannot create incident messages.",kind:"warn"});return}const F=String(Ve.title||"").trim(),D=String(Ve.message||"").trim();if(F.length<4||D.length<8){n({title:"Missing",message:"Provide a title and message.",kind:"warn"});return}const m=Date.now(),A={id:za("INC"),createdAt:m,createdBy:r,title:F,severity:Ve.severity||"Info",status:Ve.status||"Investigating",message:D,modules:Ve.modules||["Billing"],pinned:!!Ve.pinned,visibleToOrgAdmins:Ve.visibleToOrgAdmins!==!1,updates:[{id:za("U"),at:m,status:Ve.status||"Investigating",message:D,by:r}]};ie(f=>[A,...f]),Ne({severity:"Warning",actor:r,role:r,event:"Incident message created",why:"Org status update",metadata:{incidentId:A.id,severity:A.severity,status:A.status}}),n({title:"Published",message:`Incident ${A.id} published.`,kind:"success"}),fe(!1)},C=()=>{const F={exportedAt:new Date().toISOString(),cases:q,sessions:R,incidents:ae,audit:_},D=new Blob([JSON.stringify(F,null,2)],{type:"application/json"}),m=URL.createObjectURL(D),A=document.createElement("a");A.href=m,A.download="corporatepay-support-tools.json",A.click(),URL.revokeObjectURL(m),n({title:"Exported",message:"Downloaded JSON.",kind:"success"})},Q=d.useMemo(()=>!Fe||Fe.endedAt||!Fe.bannerEnabled?null:{text:`Support session active (${Fe.id}). Mode: ${Fe.mode}.`,watermark:N&&Fe.watermarkEnabled,recording:Fe.recordingEnabled},[Fe,N]),O=F=>{if(!o){n({title:"Org Admin required",message:"Only Org Admin can change support enablement.",kind:"warn"});return}g(F),Ne({severity:"Warning",actor:r,role:r,event:F?"Support mode enabled":"Support mode disabled",why:"Org policy change",metadata:{supportEnabled:F}}),n({title:"Updated",message:F?"Support enabled.":"Support disabled.",kind:"success"})},ee=F=>{if(!o){n({title:"Org Admin required",message:"Only Org Admin can change recording policy.",kind:"warn"});return}k(D=>{const m=F(D);return Ne({severity:"Warning",actor:r,role:r,event:"Recording policy updated",why:"Policy change",metadata:m}),m}),n({title:"Saved",message:"Recording policy updated.",kind:"success"})};return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(AB,{toasts:a,onDismiss:F=>l(D=>D.filter(m=>m.id!==F))}),Q?e.jsxs("div",{className:"sticky top-0 z-30 border-b border-emerald-200 bg-emerald-50 px-4 py-2",children:[e.jsxs("div",{className:"mx-auto flex max-w-[1400px] flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-emerald-900",children:[e.jsx(yt,{className:"h-4 w-4"}),Q.text,Q.recording?e.jsx(jt,{label:"Recording",tone:"warn"}):e.jsx(jt,{label:"Not recording",tone:"neutral"}),me?e.jsx(jt,{label:`Case ${me.id}`,tone:"info"}):null]}),e.jsx("div",{className:"text-xs text-emerald-900",children:"Visible to org admins. No silent actions."})]}),Q.watermark?e.jsx("div",{className:"pointer-events-none fixed inset-0 z-10 grid place-items-center opacity-[0.06]",children:e.jsx("div",{className:"rotate-[-18deg] text-[44px] font-black tracking-tight text-slate-900",children:"SUPPORT SESSION"})}):null]}):null,e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:jg.green},children:e.jsx($d,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Support and EVzone Admin Tools"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Embedded EVzone support inside the org console with auditable sessions, case tracking, scoped tools, and incident messaging."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(jt,{label:`Cases: ${qe}`,tone:qe?"info":"neutral"}),e.jsx(jt,{label:`Sessions: ${He}`,tone:He?"warn":"neutral"}),e.jsx(jt,{label:`Pinned incidents: ${_e}`,tone:_e?"warn":"neutral"}),e.jsx(jt,{label:`Support mode: ${j?"On":"Off"}`,tone:j?"good":"warn"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"min-w-[220px]",children:e.jsx(fd,{label:"View as",value:r,onChange:F=>i(F),options:[{value:"Org Admin",label:"Org Admin"},{value:"Finance",label:"Finance"},{value:"Approver",label:"Approver"},{value:"Employee",label:"Employee"},{value:"EVzone Support",label:"EVzone Support"}],hint:"Role gated"})}),e.jsxs(Ms,{variant:"outline",onClick:C,children:[e.jsx(gt,{className:"h-4 w-4"})," Export JSON"]}),e.jsxs(Ms,{variant:"primary",onClick:M,children:[e.jsx(pt,{className:"h-4 w-4"})," Request support"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"cases",label:"Cases"},{id:"sessions",label:"Sessions"},{id:"tools",label:"Troubleshooting tools"},{id:"incidents",label:"Incidents and status"},{id:"audit",label:"Audit"}].map(F=>e.jsx("button",{className:bn("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",we===F.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:we===F.id?{background:jg.green}:void 0,onClick:()=>G(F.id),children:F.label},F.id))}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 rounded-3xl border border-slate-200 bg-white p-4 md:grid-cols-12",children:[e.jsxs("div",{className:"md:col-span-7",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2.5",children:[e.jsx(ka,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:be,onChange:F=>Ge(F.target.value),placeholder:"case id, incident, session, tool...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"}),be?e.jsx("button",{className:"rounded-xl p-1 text-slate-500 hover:bg-slate-100",onClick:()=>Ge(""),"aria-label":"Clear",children:e.jsx(Ye,{className:"h-4 w-4"})}):null]})]}),e.jsx("div",{className:"md:col-span-5",children:e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Support is embedded here as a role. For deeper policies see ",e.jsx("span",{className:"font-semibold",children:"Z Security"})," and ",e.jsx("span",{className:"font-semibold",children:"D Org Setup"}),"."]})})]})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[we==="cases"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsx(Pl,{title:"Support cases",subtitle:"Core: request support and track cases.",right:e.jsx(jt,{label:`${le.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[le.map(F=>e.jsx("button",{type:"button",className:"w-full rounded-3xl border border-slate-200 bg-white p-4 text-left hover:bg-slate-50",onClick:()=>{ce(F.id),Y(!0)},children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(jt,{label:F.priority,tone:fC(F.priority)}),e.jsx(jt,{label:F.status,tone:F.status==="Resolved"?"good":F.status==="In Progress"?"info":F.status==="New"?"warn":"neutral"}),e.jsx(jt,{label:F.module,tone:"neutral"}),F.marketplace!=="-"?e.jsx(jt,{label:F.marketplace,tone:"neutral"}):null,e.jsx(jt,{label:F.id,tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:F.title}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",gd(F.createdAt)," by ",F.createdBy,"  Updated ",gd(F.updatedAt)]}),e.jsx("div",{className:"mt-2 text-xs text-slate-600 line-clamp-2",children:F.description}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[F.tags.slice(0,4).map(D=>e.jsx(jt,{label:D,tone:"neutral"},`${F.id}-${D}`)),F.tags.length>4?e.jsx(jt,{label:"+more",tone:"neutral"}):null]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(jt,{label:F.attachments?`${F.attachments} attachment(s)`:"No attachments",tone:F.attachments?"info":"neutral"}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]})]})},F.id)),le.length?null:e.jsx(Im,{title:"No cases",subtitle:"Create a support request to get help."})]})})}),e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(Pl,{title:"Org admin controls",subtitle:"Core: support enablement and visibility.",right:e.jsx(jt,{label:o?"Editable":"View",tone:o?"info":"neutral"}),children:[e.jsx(Tc,{enabled:j,onChange:F=>O(F),label:"Support mode",description:"EVzone support can sign in when enabled"}),e.jsx(Tc,{enabled:N,onChange:F=>{if(!o){n({title:"Org Admin required",message:"Only Org Admin can change watermark.",kind:"warn"});return}$(F),Ne({severity:"Warning",actor:r,role:r,event:"Support watermark updated",why:"Visibility control",metadata:{watermark:F}}),n({title:"Saved",message:"Watermark updated.",kind:"success"})},label:"Watermark",description:"Banner and watermark during sessions"}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:"Safety: sessions are always visible and audited. Support cannot silently change settings."})]}),e.jsxs(Pl,{title:"Premium recording policy",subtitle:"Session recording toggle (policy-controlled).",right:e.jsx(jt,{label:"Premium",tone:"info"}),children:[e.jsx(Tc,{enabled:T.enabled,onChange:F=>ee(D=>({...D,enabled:F})),label:"Recording enabled",description:"Allow session recording"}),e.jsx(Tc,{enabled:T.requireOrgApproval,onChange:F=>ee(D=>({...D,requireOrgApproval:F})),label:"Require org approval",description:"Recording toggles require Org Admin"}),e.jsx(Tc,{enabled:T.allowSupportToToggle,onChange:F=>ee(D=>({...D,allowSupportToToggle:F})),label:"Allow support to toggle",description:"If off, only Org Admin can toggle"}),e.jsx(fd,{label:"Storage",value:`${T.storageDays}`,onChange:F=>ee(D=>({...D,storageDays:Number(F)})),options:[{value:"7",label:"7 days"},{value:"14",label:"14 days"},{value:"30",label:"30 days"},{value:"90",label:"90 days"}]}),e.jsx(zh,{label:"Notice text",value:T.noticeText,onChange:F=>ee(D=>({...D,noticeText:F})),rows:3})]})]})]}):null,we==="sessions"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsx(Pl,{title:"Support sessions",subtitle:"Core: sessions are always auditable and visible (banner + watermark).",right:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ms,{variant:"outline",onClick:()=>oe(Ie||void 0),disabled:!j||!c,children:[e.jsx($d,{className:"h-4 w-4"})," Start session"]}),e.jsx(jt,{label:j?"Support enabled":"Support disabled",tone:j?"good":"warn"})]}),children:e.jsxs("div",{className:"space-y-2",children:[z.map(F=>e.jsx("button",{type:"button",className:"w-full rounded-3xl border border-slate-200 bg-white p-4 text-left hover:bg-slate-50",onClick:()=>{Qe(F.id),de(!0)},children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(jt,{label:F.endedAt?"Ended":"Active",tone:F.endedAt?"neutral":"warn"}),e.jsx(jt,{label:F.mode,tone:F.mode==="Guided actions"?"info":"neutral"}),e.jsx(jt,{label:F.recordingEnabled?"Recording":"Not recording",tone:F.recordingEnabled?"warn":"neutral"}),e.jsx(jt,{label:F.toolsScope.guidedActionsAllowed?"Guided allowed":"Guided off",tone:F.toolsScope.guidedActionsAllowed?"info":"neutral"}),e.jsx(jt,{label:F.id,tone:"neutral"})]}),e.jsxs("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:["Support agent: ",F.startedBy]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Started ",gd(F.startedAt),F.endedAt?`  Ended ${gd(F.endedAt)}`:""]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Case: ",F.relatedCaseId||"-","  Actions: ",F.actions.length]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[F.endedAt?null:e.jsxs(Ms,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>De(F.id),children:[e.jsx(Ye,{className:"h-4 w-4"})," End"]}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]})]})},F.id)),z.length?null:e.jsx(Im,{title:"No sessions",subtitle:"Start a session from a case."})]})})}),e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(Pl,{title:"Session actions",subtitle:"Premium: recording and guided actions.",right:e.jsx(jt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs(Ms,{variant:"outline",onClick:Ke,disabled:!Fe||!!Fe.endedAt,children:[e.jsx(kv,{className:"h-4 w-4"})," Toggle recording"]}),e.jsxs(Ms,{variant:"outline",onClick:()=>{if(!Fe){n({title:"No session",message:"Select a session first.",kind:"warn"});return}ge(Fe.id)},disabled:!Fe||!!Fe.endedAt,children:[e.jsx(TE,{className:"h-4 w-4"})," Request guided actions"]}),e.jsxs(Ms,{variant:"primary",onClick:()=>{if(!Fe){n({title:"No session",message:"Select a session first.",kind:"warn"});return}ue(Fe.id)},disabled:!Fe||!!Fe.endedAt||!o,title:o?"Approve":"Org Admin required",children:[e.jsx(ct,{className:"h-4 w-4"})," Approve guided actions"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Guided actions are scoped and guarded. All changes are auditable and visible."})]}),e.jsx(Pl,{title:"Recording notice",subtitle:"Policy controlled",right:e.jsx(jt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[T.noticeText,e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Storage: ",T.storageDays," days  Org approval: ",T.requireOrgApproval?"Required":"Not required"]})]})})]})]}):null,we==="tools"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsx(Pl,{title:"Scoped troubleshooting tools",subtitle:"Premium: read-only and guided actions.",right:e.jsx(jt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"space-y-2",children:[xe.map(F=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(jt,{label:F.kind,tone:F.kind==="Guided action"?"warn":"good"}),e.jsx(jt,{label:F.module,tone:"neutral"}),e.jsx(jt,{label:`Risk ${F.risk}`,tone:F.risk==="High"?"bad":F.risk==="Medium"?"warn":"good"}),e.jsx(jt,{label:F.id,tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:F.label}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:F.description})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ms,{variant:F.kind==="Guided action"?"primary":"outline",className:"px-3 py-2 text-xs",onClick:()=>$e(F),disabled:!Fe||!!Fe.endedAt,title:Fe?"Run":"Open a session first",children:[e.jsx(ht,{className:"h-4 w-4"})," Run"]}),e.jsxs(Ms,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{if(!Fe){n({title:"No session",message:"Select an active session first.",kind:"warn"});return}de(!0)},children:[e.jsx(et,{className:"h-4 w-4"})," Session"]})]})]}),F.kind==="Guided action"?e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Guided actions require approval and will always show confirmations and audit logs."}):e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Read-only check. No data changes."})]},F.id)),xe.length?null:e.jsx(Im,{title:"No tools",subtitle:"No tools match your search."})]})})}),e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsx(Pl,{title:"Active session",subtitle:"Select a session to run tools.",right:e.jsx(jt,{label:Fe&&!Fe.endedAt?"Active":"None",tone:Fe&&!Fe.endedAt?"warn":"neutral"}),children:Fe?e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(jt,{label:Fe.id,tone:"neutral"}),e.jsx(jt,{label:Fe.mode,tone:Fe.mode==="Guided actions"?"info":"neutral"}),e.jsx(jt,{label:Fe.toolsScope.guidedActionsAllowed?"Guided allowed":"Guided off",tone:Fe.toolsScope.guidedActionsAllowed?"info":"neutral"})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Case: ",Fe.relatedCaseId||"-"]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Ms,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>de(!0),children:[e.jsx(et,{className:"h-4 w-4"})," Open session"]}),Fe.endedAt?null:e.jsxs(Ms,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>De(Fe.id),children:[e.jsx(Ye,{className:"h-4 w-4"})," End"]})]})]}):e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"Select a session from Sessions tab."})}),e.jsx(Pl,{title:"Policy reminder",subtitle:"Support scope",right:e.jsx(jt,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Support is embedded with role gating. Sessions are visible and audited.",e.jsxs("ul",{className:"mt-2 space-y-1",children:[e.jsx("li",{children:"1) View-only by default"}),e.jsx("li",{children:"2) Guided actions require approvals"}),e.jsx("li",{children:"3) Recording is policy-controlled"})]})]})})]})]}):null,we==="incidents"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsx(Pl,{title:"Incident and status messaging",subtitle:"Premium: communicate incidents to org admins.",right:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ms,{variant:"outline",onClick:v,disabled:!x,title:x?"Create":"Not allowed",children:[e.jsx(Zk,{className:"h-4 w-4"})," New status"]}),e.jsx(jt,{label:x?"Publisher":"Viewer",tone:x?"info":"neutral"})]}),children:e.jsxs("div",{className:"space-y-2",children:[Pe.map(F=>{var D;return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(jt,{label:F.severity,tone:CB(F.severity)}),e.jsx(jt,{label:F.status,tone:F.status==="Resolved"?"good":F.status==="Monitoring"?"info":"warn"}),F.pinned?e.jsx(jt,{label:"Pinned",tone:"info"}):null,e.jsx(jt,{label:F.id,tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:F.title}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Posted ",gd(F.createdAt)," by ",F.createdBy]}),e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:F.message}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:F.modules.map(m=>e.jsx(jt,{label:m,tone:"neutral"},`${F.id}-${m}`))})]}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[e.jsx("div",{className:"font-semibold",children:"Latest update"}),e.jsx("div",{className:"mt-1",children:(D=F.updates[F.updates.length-1])==null?void 0:D.message})]})]})},F.id)}),Pe.length?null:e.jsx(Im,{title:"No incidents",subtitle:"No active incidents to display."})]})})}),e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(Pl,{title:"Org admin notice",subtitle:"Status feed is for org admins",right:e.jsx(jt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: incident messages can be routed to email and WhatsApp as well. Logs appear in Notifications Center (B)."}),e.jsxs(Ms,{variant:"outline",className:"w-full",onClick:()=>{n({title:"Scheduled",message:"Digest scheduling is handled in Reporting (V) and Notifications (B).",kind:"info"})},children:[e.jsx($o,{className:"h-4 w-4"})," Digest routing"]})]}),e.jsx(Pl,{title:"Visibility rules",subtitle:"Who sees what",right:e.jsx(jt,{label:"Core",tone:"neutral"}),children:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"1) Org admins always see org incidents"}),e.jsx("li",{children:"2) Support can publish only if enabled"}),e.jsx("li",{children:"3) Actions remain auditable and visible"})]})})})]})]}):null,we==="audit"?e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsxs(Pl,{title:"Audit",subtitle:"Core: sessions are auditable and visible.",right:e.jsx(jt,{label:`${Be.length}`,tone:"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Severity"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Event"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Why"})]})}),e.jsxs("tbody",{children:[Be.slice(0,60).map(F=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Dm(F.at)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(jt,{label:F.severity,tone:kB(F.severity)})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:F.actor}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:F.role})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:F.event}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:F.why})]},F.id)),Be.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-10",children:e.jsx(Im,{title:"No audit entries",subtitle:"Actions will appear here."})})})]})]})}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Ms,{variant:"outline",onClick:C,children:[e.jsx(gt,{className:"h-4 w-4"})," Export bundle"]}),e.jsxs(Ms,{variant:"outline",onClick:async()=>{try{await navigator.clipboard.writeText(JSON.stringify({audit:Be},null,2)),n({title:"Copied",message:"Audit JSON copied.",kind:"success"})}catch{n({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},children:[e.jsx(ls,{className:"h-4 w-4"})," Copy JSON"]})]})]})}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"AA Support and EVzone Admin Tools v2. Core: embedded EVzone support role, auditable sessions, request support, and case tracking. Premium: session recording policy, scoped troubleshooting tools, and incident/status messaging."})})]})}),e.jsx(Nb,{open:Me,title:"Request support",subtitle:"Core: create a support case.",onClose:()=>je(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Ms,{variant:"outline",onClick:()=>je(!1),children:"Cancel"}),e.jsxs(Ms,{variant:"primary",onClick:H,children:[e.jsx(ct,{className:"h-4 w-4"})," Create case"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(vC,{label:"Title",value:String(Ue.title||""),onChange:F=>Oe(D=>({...D,title:F})),placeholder:"Short summary"}),e.jsx(fd,{label:"Module",value:String(Ue.module||"Billing"),onChange:F=>Oe(D=>({...D,module:F})),options:t.map(F=>({value:F,label:F}))}),e.jsx(fd,{label:"Marketplace",value:String(Ue.marketplace||"-"),onChange:F=>Oe(D=>({...D,marketplace:F})),options:[{value:"-",label:"-"},...s.map(F=>({value:F,label:F}))],disabled:Ue.module!=="E-Commerce",hint:Ue.module!=="E-Commerce"?"Only for E-Commerce":void 0}),e.jsx(fd,{label:"Priority",value:String(Ue.priority||"Medium"),onChange:F=>Oe(D=>({...D,priority:F})),options:[{value:"Low",label:"Low"},{value:"Medium",label:"Medium"},{value:"High",label:"High"},{value:"Critical",label:"Critical"}]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(zh,{label:"Description",value:String(Ue.description||""),onChange:F=>Oe(D=>({...D,description:F})),placeholder:"Describe the issue, impact, and expected outcome",rows:5})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:"Attachments and evidence can be added in the case timeline (demo)."})]})}),e.jsx(bC,{open:he,title:me?`Case ${me.id}`:"Case",subtitle:me?`${me.title}  ${me.status}`:"",onClose:()=>Y(!1),footer:me?e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Core: case tracking. Premium: start a session and use scoped tools."}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ms,{variant:"outline",onClick:()=>oe(me.id),disabled:!c||!j,children:[e.jsx($d,{className:"h-4 w-4"})," Start session"]}),e.jsxs(Ms,{variant:"primary",onClick:()=>G("sessions"),children:[e.jsx(et,{className:"h-4 w-4"})," Sessions"]})]})]}):null,children:me?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(jt,{label:me.priority,tone:fC(me.priority)}),e.jsx(jt,{label:me.status,tone:me.status==="Resolved"?"good":me.status==="In Progress"?"info":"neutral"}),e.jsx(jt,{label:me.module,tone:"neutral"}),me.marketplace!=="-"?e.jsx(jt,{label:me.marketplace,tone:"neutral"}):null,e.jsx(jt,{label:`Assigned: ${me.assignedTo||"-"}`,tone:"info"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:me.title}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:me.description}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Created ",Dm(me.createdAt),"  Updated ",Dm(me.updatedAt)]})]}),e.jsxs(Pl,{title:"Timeline",subtitle:"Messages and system notes",right:e.jsx(jt,{label:`${me.timeline.length}`,tone:"neutral"}),children:[e.jsx("div",{className:"space-y-2",children:me.timeline.slice().sort((F,D)=>F.at-D.at).map(F=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(jt,{label:F.kind,tone:F.kind==="support"?"info":(F.kind==="customer","neutral")}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:F.by}),e.jsx("div",{className:"text-xs text-slate-500",children:gd(F.at)})]}),e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:F.message})]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:async()=>{try{await navigator.clipboard.writeText(F.message),n({title:"Copied",message:"Message copied.",kind:"success"})}catch{n({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},"aria-label":"Copy",children:e.jsx(ls,{className:"h-4 w-4"})})]})},F.id))}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2",children:e.jsxs(Ms,{variant:"outline",onClick:()=>{const F=prompt("Add a note to the case");F&&(Ae(me.id,F,c?"support":"customer"),n({title:"Added",message:"Timeline updated.",kind:"success"}))},children:[e.jsx(ji,{className:"h-4 w-4"})," Add message"]})})]})]}):null}),e.jsx(bC,{open:pe,title:Fe?`Session ${Fe.id}`:"Session",subtitle:Fe?`${Fe.mode}  ${Fe.endedAt?"Ended":"Active"}`:"",onClose:()=>de(!1),footer:Fe?e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Premium: scoped tools and recording policy controlled."}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ms,{variant:"outline",onClick:Ke,disabled:!!Fe.endedAt,children:[e.jsx(kv,{className:"h-4 w-4"})," Recording"]}),Fe.endedAt?null:e.jsxs(Ms,{variant:"outline",onClick:()=>De(Fe.id),children:[e.jsx(Ye,{className:"h-4 w-4"})," End"]})]})]}):null,children:Fe?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(jt,{label:Fe.mode,tone:Fe.mode==="Guided actions"?"info":"neutral"}),e.jsx(jt,{label:Fe.recordingEnabled?"Recording":"Not recording",tone:Fe.recordingEnabled?"warn":"neutral"}),e.jsx(jt,{label:Fe.toolsScope.guidedActionsAllowed?"Guided allowed":"Guided off",tone:Fe.toolsScope.guidedActionsAllowed?"info":"neutral"}),e.jsx(jt,{label:Fe.orgVisible?"Org-visible":"Hidden",tone:Fe.orgVisible?"good":"warn"})]}),e.jsxs("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:["Started by ",Fe.startedBy]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Started ",Dm(Fe.startedAt),Fe.endedAt?`  Ended ${Dm(Fe.endedAt)}`:""]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Case: ",Fe.relatedCaseId||"-"]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"No silent actions: every tool execution creates an audit entry."})]}),e.jsx(Pl,{title:"Actions log",subtitle:"Executed checks and guided actions",right:e.jsx(jt,{label:`${Fe.actions.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[Fe.actions.map(F=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(jt,{label:F.type,tone:F.type==="Guided action"?"warn":"good"}),e.jsx(jt,{label:F.outcome,tone:F.outcome==="OK"?"good":F.outcome==="Failed"?"warn":"neutral"}),e.jsx("div",{className:"text-xs text-slate-500",children:gd(F.at)})]}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:F.label}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:F.notes})]}),e.jsxs("div",{className:"text-xs text-slate-500",children:["By ",F.by]})]})},F.id)),Fe.actions.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No actions yet. Run a tool from Tools tab."})]})}),e.jsxs(Pl,{title:"Permissions",subtitle:"Scoped troubleshooting tools",right:e.jsx(jt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Read-only tools"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Enabled"}),e.jsx(jt,{label:Fe.toolsScope.readOnly?"On":"Off",tone:Fe.toolsScope.readOnly?"good":"warn"})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Guided actions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Approval required"}),e.jsx(jt,{label:Fe.toolsScope.guidedActionsAllowed?"Allowed":"Not allowed",tone:Fe.toolsScope.guidedActionsAllowed?"info":"neutral"})]})]}),e.jsx("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:e.jsxs(Ms,{variant:"outline",onClick:()=>G("tools"),children:[e.jsx(et,{className:"h-4 w-4"})," Open tools"]})})]})]}):null}),e.jsxs(Nb,{open:Te,title:"Toggle session recording",subtitle:"Premium: policy controlled. Requires reason and may require org approval.",onClose:()=>Ee(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Ms,{variant:"outline",onClick:()=>Ee(!1),children:"Cancel"}),e.jsxs(Ms,{variant:"primary",onClick:b,children:[e.jsx(kv,{className:"h-4 w-4"})," Confirm"]})]}),children:[e.jsx(zh,{label:"Reason",value:Re,onChange:ze,placeholder:"Example: capture evidence for incident review",rows:4}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Policy: enabled ",String(T.enabled),"  support toggle ",String(T.allowSupportToToggle),"  org approval ",String(T.requireOrgApproval),"  storage ",T.storageDays," days."]})]}),e.jsx(Nb,{open:ke,title:"New incident or status message",subtitle:"Premium: incident/status messaging module.",onClose:()=>fe(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Ms,{variant:"outline",onClick:()=>fe(!1),children:"Cancel"}),e.jsxs(Ms,{variant:"primary",onClick:u,children:[e.jsx(Zk,{className:"h-4 w-4"})," Publish"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(vC,{label:"Title",value:String(Ve.title||""),onChange:F=>ne(D=>({...D,title:F})),placeholder:"Short incident title"}),e.jsx(fd,{label:"Severity",value:String(Ve.severity||"Info"),onChange:F=>ne(D=>({...D,severity:F})),options:[{value:"Info",label:"Info"},{value:"Degraded",label:"Degraded"},{value:"Partial Outage",label:"Partial Outage"},{value:"Major Outage",label:"Major Outage"}]}),e.jsx(fd,{label:"Status",value:String(Ve.status||"Investigating"),onChange:F=>ne(D=>({...D,status:F})),options:[{value:"Investigating",label:"Investigating"},{value:"Identified",label:"Identified"},{value:"Monitoring",label:"Monitoring"},{value:"Resolved",label:"Resolved"}]}),e.jsx(Tc,{enabled:!!Ve.pinned,onChange:F=>ne(D=>({...D,pinned:F})),label:"Pinned",description:"Show at top"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(zh,{label:"Message",value:String(Ve.message||""),onChange:F=>ne(D=>({...D,message:F})),placeholder:"What is happening, impact, ETA",rows:5})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:"In production, status messages can be delivered via email and WhatsApp and show in Notifications Center."})]})})]})}const Td={green:"#03CD8C",orange:"#F77F00"};function En(...t){return t.filter(Boolean).join(" ")}function jC(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function MB(t,s,a){return Math.max(s,Math.min(a,t))}function wb(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function PB(t,s,a="text/plain"){const l=new Blob([s],{type:a}),n=URL.createObjectURL(l),r=document.createElement("a");r.href=n,r.download=t,r.click(),URL.revokeObjectURL(n)}function dl({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:En("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function yC(t){return t==="Premium"?"info":"neutral"}function kb(t){return t==="At risk"?"bad":t==="Needs attention"?"warn":"good"}function xr({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:Td.green}:t==="accent"?{background:Td.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:En(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function OB({value:t}){const s=MB(t,0,100),a=78,l=10,n=(a-l)/2,r=2*Math.PI*n,i=s/100*r;return e.jsxs("div",{className:"relative grid place-items-center",children:[e.jsxs("svg",{width:a,height:a,className:"-rotate-90",children:[e.jsx("circle",{cx:a/2,cy:a/2,r:n,stroke:"#E2E8F0",strokeWidth:l,fill:"none"}),e.jsx("circle",{cx:a/2,cy:a/2,r:n,stroke:Td.green,strokeWidth:l,fill:"none",strokeDasharray:`${i} ${r}`,strokeLinecap:"round"})]}),e.jsxs("div",{className:"absolute text-sm font-semibold text-slate-900",children:[Math.round(s),"%"]})]})}function TB({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:En("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function RB({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="920px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[8vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(TB,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function DB({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:En("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function Rc({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function NC({title:t,subtitle:s}){return e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(wl,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:s})]})}function IB(){const[t,s]=d.useState([]),a=he=>{const Y=jC("toast");s(Ie=>[{id:Y,...he},...Ie].slice(0,4)),window.setTimeout(()=>s(Ie=>Ie.filter(ce=>ce.id!==Y)),3200)},l=Date.now(),n=d.useMemo(()=>{const he=Y=>({...Y,lastUpdatedAt:l-Y.lastUpdatedDaysAgo*24*60*60*1e3});return[he({id:"org_setup",title:"Organization Profile and Program Setup",description:"Company profile, entities, billing contacts, branding, invoice groups, and support toggle.",category:"Organization",path:"/settings/org/setup",tier:"Core",roles:["Org Admin"],tags:["profile","entities","billing","invoice groups","support"],icon:Xl,lastUpdatedDaysAgo:2,health:"Healthy",quickActions:[{id:"open",label:"Open wizard",kind:"open"},{id:"copy",label:"Copy link",kind:"copy"}]}),he({id:"modules_marketplaces",title:"Modules and Marketplaces Enablement",description:"Enable service modules and marketplaces including MyLiveDealz. Includes Other slots for expansion.",category:"Organization",path:"/settings/modules",tier:"Core",roles:["Org Admin"],tags:["service modules","marketplaces","rollout"],icon:wa,lastUpdatedDaysAgo:3,health:"Healthy",quickActions:[{id:"open",label:"Manage enablement",kind:"open"},{id:"copy",label:"Copy link",kind:"copy"}]}),he({id:"users_invites",title:"Users and Invitations",description:"Invite employees, set group and cost center defaults, bulk import, and offboarding.",category:"Access",path:"/settings/users",tier:"Core",roles:["Org Admin","Finance"],tags:["users","invites","CSV import","offboarding"],icon:Us,lastUpdatedDaysAgo:6,health:"Needs attention",quickActions:[{id:"open",label:"Open users",kind:"open"},{id:"action",label:"Invite user",kind:"action",hint:"Quick create"}]}),he({id:"groups_cost_centers",title:"Groups and Cost Centers",description:"Create Groups, cost centers, project tags, and chargeback rules.",category:"Access",path:"/settings/groups",tier:"Core",roles:["Org Admin","Finance"],tags:["groups","cost centers","project codes"],icon:ZF,lastUpdatedDaysAgo:9,health:"Healthy",quickActions:[{id:"open",label:"Open groups",kind:"open"},{id:"copy",label:"Copy link",kind:"copy"}]}),he({id:"roles_permissions",title:"Roles, Permissions and Governance",description:"Custom roles, module permissions, two-admin model controls, delegation, and simulation.",category:"Access",path:"/settings/roles",tier:"Core",roles:["Org Admin"],tags:["RBAC","governance","delegation"],icon:Co,lastUpdatedDaysAgo:12,health:"Healthy",quickActions:[{id:"open",label:"Open roles",kind:"open"},{id:"copy",label:"Copy link",kind:"copy"}]}),he({id:"policy_builder",title:"Policies",description:"Policy builder for rides, services, purchases and marketplace restrictions with inheritance.",category:"Controls",path:"/settings/policies",tier:"Core",roles:["Org Admin","Approver"],tags:["policy","inheritance","simulator"],icon:TE,lastUpdatedDaysAgo:4,health:"Needs attention",quickActions:[{id:"open",label:"Open policies",kind:"open"},{id:"action",label:"Simulate scenario",kind:"action"}]}),he({id:"approval_workflows",title:"Approval Workflow Builder",description:"Create approval flows per module and marketplace including RFQs and high value assets.",category:"Controls",path:"/settings/approvals/workflows",tier:"Core",roles:["Org Admin","Approver","Finance"],tags:["approvals","rules","SLA"],icon:ct,lastUpdatedDaysAgo:7,health:"Healthy",quickActions:[{id:"open",label:"Open builder",kind:"open"},{id:"action",label:"Create template",kind:"action"}]}),he({id:"budgets",title:"Budgets, Spend Limits and Controls",description:"Org, group, user, module, and marketplace budgets with forecasting and exceptions.",category:"Finance",path:"/settings/budgets",tier:"Core",roles:["Org Admin","Finance"],tags:["budgets","caps","exceptions"],icon:$a,lastUpdatedDaysAgo:1,health:"At risk",quickActions:[{id:"open",label:"Open budgets",kind:"open"},{id:"action",label:"Request exception",kind:"action"}]}),he({id:"billing_invoice_groups",title:"Billing Setup and Invoice Groups",description:"Invoice frequency, invoice groups, tax, templates, and billing simulations.",category:"Finance",path:"/settings/billing",tier:"Core",roles:["Org Admin","Finance"],tags:["billing","invoice groups","tax"],icon:wt,lastUpdatedDaysAgo:5,health:"Healthy",quickActions:[{id:"open",label:"Open billing",kind:"open"},{id:"copy",label:"Copy link",kind:"copy"}]}),he({id:"reporting",title:"Reporting and Analytics",description:"Spend reports, approval performance, exports, custom report builder, and schedules.",category:"Reporting",path:"/reports",tier:"Core",roles:["Org Admin","Finance","Approver"],tags:["reports","exports","schedules"],icon:Sr,lastUpdatedDaysAgo:2,health:"Healthy",quickActions:[{id:"open",label:"Open reports",kind:"open"},{id:"action",label:"Schedule report",kind:"action"}]}),he({id:"esg",title:"Sustainability and ESG Reporting",description:"EV usage metrics, charging utilization, emissions estimates, and ESG template exports.",category:"Reporting",path:"/reports/esg",tier:"Premium",roles:["Org Admin","Finance"],tags:["ESG","emissions","templates"],icon:Ld,lastUpdatedDaysAgo:2,health:"Healthy",quickActions:[{id:"open",label:"Open ESG",kind:"open"},{id:"action",label:"Update factors",kind:"action"}]}),he({id:"integrations",title:"Integrations and Developer Center",description:"ERP exports, secure API keys, scopes, webhooks, sandbox mode, and inspector.",category:"Integrations",path:"/settings/integrations",tier:"Core",roles:["Org Admin","Finance"],tags:["exports","API keys","webhooks"],icon:tu,lastUpdatedDaysAgo:1,health:"Healthy",quickActions:[{id:"open",label:"Open integrations",kind:"open"},{id:"action",label:"Create webhook",kind:"action"}]}),he({id:"security",title:"Security, Audit and Compliance",description:"Audit logs, MFA policies, retention, support mode gating, dual control, forensic exports.",category:"Security",path:"/settings/security",tier:"Core",roles:["Org Admin","Finance"],tags:["audit","MFA","retention","dual control"],icon:ra,lastUpdatedDaysAgo:1,health:"Needs attention",quickActions:[{id:"open",label:"Open security",kind:"open"},{id:"action",label:"Run posture check",kind:"action"}]}),he({id:"support_tools",title:"Support and EVzone Admin Tools",description:"Embedded support role, auditable sessions, scoped tools, recording policy, and status messages.",category:"Support",path:"/settings/support-tools",tier:"Premium",roles:["Org Admin","EVzone Support","Finance"],tags:["support","cases","sessions","incidents"],icon:$d,lastUpdatedDaysAgo:0,health:"Healthy",quickActions:[{id:"open",label:"Open support tools",kind:"open"},{id:"action",label:"Request support",kind:"action"}]})]},[l]),r=["All","Organization","Access","Controls","Finance","Integrations","Security","Support","Reporting"],[i,o]=d.useState("All"),[c,x]=d.useState(""),[j,g]=d.useState("Org Admin"),[N,$]=d.useState(()=>["org_setup","security","integrations"]),[T,k]=d.useState("org_setup"),[q,L]=d.useState(!1),[R,U]=d.useState(null),[ae,ie]=d.useState(""),_=d.useMemo(()=>n.find(he=>he.id===T)||n[0],[n,T]),W=d.useMemo(()=>_.roles.includes(j),[_.roles,j]),J=d.useMemo(()=>{const he=c.trim().toLowerCase();return n.filter(Y=>i==="All"?!0:Y.category===i).filter(Y=>he?`${Y.title} ${Y.description} ${Y.category} ${Y.tags.join(" ")} ${Y.path} ${Y.tier}`.toLowerCase().includes(he):!0).slice().sort((Y,Ie)=>{const ce=N.includes(Y.id)?1:0,me=N.includes(Ie.id)?1:0;if(ce!==me)return me-ce;const pe=Qe=>Qe==="At risk"?3:Qe==="Needs attention"?2:1,de=pe(Y.health),ye=pe(Ie.health);return de!==ye?ye-de:Ie.lastUpdatedAt-Y.lastUpdatedAt})},[n,i,c,N]),we=d.useMemo(()=>{const he=["org_setup","modules_marketplaces","billing_invoice_groups","security","integrations"],Y=he.filter(Ie=>{const ce=n.find(me=>me.id===Ie);return ce?ce.health==="Healthy":!1}).length;return Math.round(Y/he.length*100)},[n]),G=d.useMemo(()=>{const he=n.length,Y=n.filter(pe=>pe.health==="At risk").length,Ie=n.filter(pe=>pe.health==="Needs attention").length,ce=n.filter(pe=>pe.tier==="Premium").length,me=n.filter(pe=>pe.tier==="Phase 2").length;return{total:he,risk:Y,attention:Ie,premium:ce,phase2:me}},[n]),be=()=>{const he={generatedAt:new Date().toISOString(),viewAs:j,category:i,query:c||void 0,pinned:N,items:n.map(Y=>({id:Y.id,title:Y.title,category:Y.category,path:Y.path,tier:Y.tier,roles:Y.roles,tags:Y.tags,health:Y.health,lastUpdatedAt:Y.lastUpdatedAt}))};PB("admin-settings-hub.json",JSON.stringify(he,null,2),"application/json"),a({title:"Exported",message:"Settings manifest downloaded.",kind:"success"})},Ge=async he=>{try{await navigator.clipboard.writeText(he),a({title:"Copied",message:"Link copied.",kind:"success"})}catch{a({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},Me=he=>{if(!he.roles.includes(j)){U(he.id),ie(""),L(!0);return}k(he.id),a({title:"Navigate",message:`Open ${he.path}`,kind:"info"})},je=he=>{$(Y=>Y.includes(he)?Y.filter(Ie=>Ie!==he):[he,...Y].slice(0,8))},Ue=()=>{if(R){if(ae.trim().length<8){a({title:"Reason required",message:"Explain why you need access.",kind:"warn"});return}a({title:"Requested",message:`Access request created for ${R}.`,kind:"success"}),L(!1)}},Oe=d.useMemo(()=>n.slice().sort((he,Y)=>Y.lastUpdatedAt-he.lastUpdatedAt).slice(0,6).map(he=>({id:jC("chg"),at:he.lastUpdatedAt,title:he.title,note:he.health==="Healthy"?"Updated configuration":he.health==="Needs attention"?"Requires review":"At risk limit",path:he.path,health:he.health})),[n]);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(DB,{toasts:t,onDismiss:he=>s(Y=>Y.filter(Ie=>Ie.id!==he))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:Td.green},children:e.jsx(wl,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Admin Settings Hub"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"One place to manage every CorporatePay setting. Use search, filters, and role-based access."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(dl,{label:`Total ${G.total}`,tone:"neutral"}),e.jsx(dl,{label:`At risk ${G.risk}`,tone:G.risk?"warn":"good"}),e.jsx(dl,{label:`Needs attention ${G.attention}`,tone:G.attention?"warn":"good"}),e.jsx(dl,{label:`Premium ${G.premium}`,tone:G.premium?"info":"neutral"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"min-w-[220px]",children:e.jsx($B,{label:"View as",value:j,onChange:he=>g(he),options:[{value:"Org Admin",label:"Org Admin"},{value:"Finance",label:"Finance"},{value:"Approver",label:"Approver"},{value:"Employee",label:"Employee"},{value:"EVzone Support",label:"EVzone Support"}],hint:"Role gating"})}),e.jsxs(xr,{variant:"outline",onClick:be,children:[e.jsx(gt,{className:"h-4 w-4"})," Export manifest"]}),e.jsxs(xr,{variant:"primary",onClick:()=>{k("support_tools"),a({title:"Support",message:"Open support tools",kind:"info"})},children:[e.jsx($d,{className:"h-4 w-4"})," Support tools"]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 rounded-3xl border border-slate-200 bg-white p-4 md:grid-cols-12",children:[e.jsxs("div",{className:"md:col-span-7",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search settings"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2.5",children:[e.jsx(ka,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:c,onChange:he=>x(he.target.value),placeholder:"policy, budgets, invoice groups, API keys...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"}),c?e.jsx("button",{className:"rounded-xl p-1 text-slate-500 hover:bg-slate-100",onClick:()=>x(""),"aria-label":"Clear",type:"button",children:e.jsx(Ye,{className:"h-4 w-4"})}):null]})]}),e.jsxs("div",{className:"md:col-span-5",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Category"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:r.map(he=>e.jsx("button",{type:"button",className:En("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",i===he?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:i===he?{background:Td.green}:void 0,onClick:()=>o(he),children:he},he))})]})]})]}),e.jsx("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsx(Rc,{title:"Settings",subtitle:"Click a card to view details and actions. Locked items can request access.",right:e.jsx(dl,{label:`${J.length} shown`,tone:"neutral"}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[J.map(he=>{const Y=he.icon,Ie=!he.roles.includes(j),ce=N.includes(he.id);return e.jsxs("button",{type:"button",className:En("relative rounded-3xl border bg-white p-4 text-left shadow-sm transition hover:bg-slate-50",T===he.id?"border-emerald-300 ring-4 ring-emerald-100":"border-slate-200"),onClick:()=>{k(he.id),Ie&&a({title:"Locked",message:"Request access to open.",kind:"warn"})},children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex min-w-0 items-start gap-3",children:[e.jsx("div",{className:En("grid h-11 w-11 shrink-0 place-items-center rounded-2xl text-white",Ie?"bg-slate-400":""),style:Ie?void 0:{background:Td.green},children:e.jsx(Y,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:he.title}),e.jsx(dl,{label:he.tier,tone:yC(he.tier)}),e.jsx(dl,{label:he.health,tone:kb(he.health)})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[he.category,"  Updated ",wb(he.lastUpdatedAt)]}),e.jsx("div",{className:"mt-2 line-clamp-2 text-sm text-slate-700",children:he.description}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[he.tags.slice(0,4).map(me=>e.jsx(dl,{label:me,tone:"neutral"},`${he.id}-${me}`)),he.tags.length>4?e.jsx(dl,{label:"+more",tone:"neutral"}):null]})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsx("button",{type:"button",className:En("rounded-2xl p-2",ce?"bg-amber-50 text-amber-900 ring-1 ring-amber-200":"text-slate-500 hover:bg-slate-100"),onClick:me=>{me.stopPropagation(),je(he.id),a({title:ce?"Unpinned":"Pinned",message:he.title,kind:"info"})},"aria-label":ce?"Unpin":"Pin",children:e.jsx(Dl,{className:En("h-4 w-4",ce&&"fill-current")})}),e.jsxs(xr,{variant:Ie?"outline":"primary",className:"px-3 py-2 text-xs",onClick:me=>{me.stopPropagation(),Me(he)},children:[Ie?e.jsx(ra,{className:"h-4 w-4"}):e.jsx(et,{className:"h-4 w-4"}),Ie?"Request":"Open"]})]})]}),Ie?e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Locked for role: ",e.jsx("span",{className:"font-semibold",children:j}),". Request access to proceed."]}):null]},he.id)}),J.length?null:e.jsx(NC,{title:"No matches",subtitle:"Try a different search or category."})]})})}),e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsx(Rc,{title:"Selected",subtitle:"Details and quick actions",right:e.jsx(dl,{label:W?"Accessible":"Locked",tone:W?"good":"warn"}),children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"flex items-start justify-between gap-3",children:e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:_.title}),e.jsx(dl,{label:_.tier,tone:yC(_.tier)}),e.jsx(dl,{label:_.health,tone:kb(_.health)})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[_.category,"  Updated ",wb(_.lastUpdatedAt)]}),e.jsx("div",{className:"mt-3 text-sm text-slate-700",children:_.description}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Path: ",e.jsx("span",{className:"font-mono",children:_.path})]}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:e.jsx(dl,{label:`Allowed roles: ${_.roles.join(", ")}`,tone:"neutral"})})]})}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(xr,{variant:W?"primary":"outline",onClick:()=>Me(_),children:[e.jsx(et,{className:"h-4 w-4"}),W?"Open":"Request access"]}),e.jsxs(xr,{variant:"outline",onClick:()=>void Ge(_.path),children:[e.jsx(ls,{className:"h-4 w-4"})," Copy link"]}),e.jsxs(xr,{variant:"outline",onClick:()=>{je(_.id),a({title:N.includes(_.id)?"Unpinned":"Pinned",message:_.title,kind:"info"})},children:[e.jsx(Dl,{className:En("h-4 w-4",N.includes(_.id)&&"fill-current")}),N.includes(_.id)?"Unpin":"Pin"]})]}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2",children:_.quickActions.map(he=>e.jsxs("button",{type:"button",className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-3 text-left hover:bg-slate-50",onClick:()=>{if(he.kind==="copy"){Ge(_.path);return}if(he.kind==="open"){Me(_);return}a({title:"Action",message:he.hint||he.label,kind:"info"})},children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:he.label}),he.hint?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:he.hint}):null]}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]},he.id))})]})}),e.jsxs(Rc,{title:"Go-live readiness",subtitle:"Quick snapshot of key configuration.",right:e.jsx(dl,{label:we>=80?"On track":"Needs work",tone:we>=80?"good":"warn"}),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(OB,{value:we}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:[we,"%"]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Org setup, modules, billing, security, integrations"})]})]}),e.jsxs(xr,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{k("org_setup"),a({title:"Tip",message:"Start with Organization Setup wizard.",kind:"info"})},children:[e.jsx(et,{className:"h-4 w-4"})," Wizard"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"This is a demo readiness score for the settings hub."})]}),e.jsx(Rc,{title:"Pinned",subtitle:"Your top shortcuts",right:e.jsx(dl,{label:`${N.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[N.map(he=>n.find(Y=>Y.id===he)).filter(Boolean).map(he=>{const Y=he,Ie=Y.icon,ce=!Y.roles.includes(j);return e.jsx("button",{type:"button",className:"w-full rounded-3xl border border-slate-200 bg-white p-4 text-left hover:bg-slate-50",onClick:()=>k(Y.id),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:En("grid h-10 w-10 place-items-center rounded-2xl text-white",ce?"bg-slate-400":""),style:ce?void 0:{background:Td.green},children:e.jsx(Ie,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:Y.title}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:Y.path})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:ce?e.jsx(ra,{className:"h-4 w-4 text-slate-400"}):e.jsx(et,{className:"h-5 w-5 text-slate-400"})})]})},Y.id)}),N.length?null:e.jsx(NC,{title:"No pinned items",subtitle:"Pin settings you use most."})]})}),e.jsx(Rc,{title:"Recent changes",subtitle:"Last updates",right:e.jsx(dl,{label:"Live",tone:"info"}),children:e.jsx("div",{className:"space-y-2",children:Oe.map(he=>e.jsx("button",{type:"button",className:"w-full rounded-3xl border border-slate-200 bg-white p-4 text-left hover:bg-slate-50",onClick:()=>{const Y=n.find(Ie=>Ie.path===he.path);Y&&k(Y.id)},children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(dl,{label:he.health,tone:kb(he.health)}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:he.title})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[wb(he.at),"  ",he.note]})]}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]})},he.id))})}),e.jsx(Rc,{title:"Help",subtitle:"Guidance and support",right:e.jsx(dl,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs(xr,{variant:"outline",onClick:()=>a({title:"Help Center",message:"Opening help center (demo).",kind:"info"}),children:[e.jsx(Fu,{className:"h-4 w-4"})," Help Center"]}),e.jsxs(xr,{variant:"outline",onClick:()=>{k("support_tools"),a({title:"Request support",message:"Create a support case from Support Tools.",kind:"info"})},children:[e.jsx(ji,{className:"h-4 w-4"})," Request support"]})]})})]})]})}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"Admin Settings Hub v2: single umbrella page linking to all CorporatePay settings. Includes search, category filters, pinned shortcuts, role-gated access requests, and a readiness snapshot."})})]})}),e.jsxs(RB,{open:q,title:"Request access",subtitle:"This creates a request for Org Admin to grant permissions.",onClose:()=>L(!1),actions:[{label:"Submit",onClick:Ue}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(xr,{variant:"outline",onClick:()=>L(!1),children:"Cancel"}),e.jsxs(xr,{variant:"primary",onClick:Ue,children:[e.jsx(ct,{className:"h-4 w-4"})," Submit"]})]}),children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Role"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:j}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"Setting"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:R})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("textarea",{value:ae,onChange:he=>ie(he.target.value),placeholder:"Explain why you need access and for how long",rows:4,className:"w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Requests should be auditable and time-bounded in production."})]})]})]})}function $B({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:En(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:En("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}const vx={green:"#03CD8C",orange:"#F77F00"};function ya(...t){return t.filter(Boolean).join(" ")}function Br(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function vd(t,s,a){return Math.max(s,Math.min(a,t))}function wC(t){return new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"2-digit"})}function fi(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function Cb(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function kC(t){const s=new Date(t),a=c=>String(c).padStart(2,"0"),l=s.getFullYear(),n=a(s.getMonth()+1),r=a(s.getDate()),i=a(s.getHours()),o=a(s.getMinutes());return`${l}-${n}-${r}T${i}:${o}`}function CC(t){const s=new Date(t).getTime();return Number.isFinite(s)?s:Date.now()}function Wh(t){return new Date(t).getHours()}function Hh(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function LB(t,s="06:00",a="22:00"){const l=new Date(t),n=l.getHours()*60+l.getMinutes(),r=c=>{const[x,j]=c.split(":").map(g=>Number(g));return(x||0)*60+(j||0)},i=r(s),o=r(a);return n<i||n>o}function Sb(t){return t>=7&&t<=9||t>=17&&t<=20}function ut({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:ya("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function ss({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:vx.green}:t==="accent"?{background:vx.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:ya(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function $m({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:ya("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:ya("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function Gr({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:ya(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:ya("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function qr({label:t,value:s,onChange:a,hint:l,disabled:n}){return e.jsxs("div",{className:ya(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",value:s,onChange:r=>a(Number(r.target.value||0)),disabled:n,className:ya("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function pr({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:ya(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:ya("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function SC({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4,disabled:i}){return e.jsxs("div",{className:ya(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:o=>a(o.target.value),placeholder:l,rows:r,disabled:i,className:ya("mt-2 w-full rounded-2xl border p-3 text-sm font-semibold shadow-sm outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function YE({actions:t}){const[s,a]=d.useState(!1),l=Xt.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:ya("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function Ab({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="980px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:12,scale:.985},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:12,scale:.985},transition:{duration:.18},className:"fixed inset-x-0 top-[7vh] z-50 mx-auto w-[min(1040px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(YE,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[72vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function FB({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,actions:i}){return d.useEffect(()=>{const o=c=>c.key==="Escape"&&n();return t&&window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,x:18},animate:{opacity:1,x:0},exit:{opacity:0,x:18},transition:{duration:.18},className:ya("fixed z-50 overflow-hidden border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]","left-2 right-2 bottom-2 top-[10vh] rounded-[28px]","lg:left-auto lg:right-4 lg:top-4 lg:bottom-4 lg:w-[760px]"),role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-base font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i&&e.jsx(YE,{actions:i}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"h-full min-h-0 overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function UB({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(480px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:ya("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function fl({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function Lm({title:t,subtitle:s}){return e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(Xx,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:s})]})}function Eb(t){return t==="Completed"?"good":t==="In progress"||t==="Confirmed"?"info":t==="Pending approval"?"warn":t==="Cancelled"?"bad":"neutral"}function Xh(t){return t==="Approved"?"good":t==="Rejected"?"bad":"warn"}function AC(t){return t==="Online"?"good":t==="Limited"?"warn":"bad"}function Dc(t){return`${t}-${Math.floor(100+Math.random()*900)}`}function EC(t){const s=t.some(l=>l.includes("DC")||l.includes("VIP")||l.includes("Priority")),a=[{role:"Manager",slaHours:8},{role:"Finance",slaHours:12}];return s&&a.push({role:"CFO",slaHours:24}),a}function VB(){var v,u,C,Q,O,ee,F,D,m,A;const t=Date.now(),s=["Operations","Office commute","Delivery","Executive","Event","Visitor","Other"],a=["Type 2 (AC)","CCS2 (DC)","GB/T (DC)","CHAdeMO (DC)"],[l,n]=d.useState([]),r=f=>{const B=Br("toast");n(p=>[{id:B,...f},...p].slice(0,4)),window.setTimeout(()=>n(p=>p.filter(E=>E.id!==B)),3200)},[i,o]=d.useState(()=>({workStart:"06:00",workEnd:"22:00",requirePurpose:!0,requireProjectTag:!0,requireCostCenter:!0,dcRequiresApproval:!0,priorityRequiresApproval:!0,maxKWhPerSession:60,maxBudgetUGXPerSession:5e5,peakHourThreshold:5})),[c]=d.useState(()=>[{id:"SITE-UG-HQ",name:"Kampala HQ Charging",city:"Kampala",address:"Kampala HQ, Nsambya",operator:"EVzone",status:"Online",reliabilityPct:96,connectors:[{connector:"Type 2 (AC)",powerKW:22,count:4,priceUGXPerKWh:850},{connector:"CCS2 (DC)",powerKW:60,count:2,priceUGXPerKWh:1200}]},{id:"SITE-UG-EBB",name:"Entebbe Airport Fast Hub",city:"Entebbe",address:"Entebbe Airport Road",operator:"Partner CPO",status:"Limited",reliabilityPct:88,connectors:[{connector:"CCS2 (DC)",powerKW:120,count:2,priceUGXPerKWh:1450},{connector:"CHAdeMO (DC)",powerKW:50,count:1,priceUGXPerKWh:1400}]},{id:"SITE-UG-JJA",name:"Jinja Road Hub",city:"Wakiso",address:"Jinja Road",operator:"EVzone",status:"Online",reliabilityPct:92,connectors:[{connector:"Type 2 (AC)",powerKW:11,count:6,priceUGXPerKWh:800},{connector:"CCS2 (DC)",powerKW:60,count:1,priceUGXPerKWh:1200}]}]),[x]=d.useState(()=>[{id:"VEH-001",label:"Company EV 01",ownerType:"Company",ownerName:"Acme Fleet",group:"Operations",costCenter:"OPS-001",vip:!1,batteryKWh:62},{id:"VEH-002",label:"Company EV 02",ownerType:"Company",ownerName:"Acme Fleet",group:"Operations",costCenter:"OPS-001",vip:!1,batteryKWh:62},{id:"VEH-003",label:"Employee EV (John)",ownerType:"Employee",ownerName:"John S.",group:"Sales",costCenter:"SALES-TRAVEL",vip:!1,batteryKWh:50},{id:"VEH-004",label:"Executive EV",ownerType:"Employee",ownerName:"Irene K.",group:"Operations",costCenter:"OPS-001",vip:!0,batteryKWh:75},{id:"VEH-005",label:"Visitor EV",ownerType:"Visitor",ownerName:"Alex Chen",group:"Sales",costCenter:"SALES-TRAVEL",vip:!0,batteryKWh:70}]),j=d.useMemo(()=>Object.fromEntries(c.map(f=>[f.id,f])),[c]),g=d.useMemo(()=>Object.fromEntries(x.map(f=>[f.id,f])),[x]),[N,$]=d.useState(()=>[{id:"VX-001",vehicleId:"VEH-004",exceptionType:"DC fast",validFrom:t-3*864e5,validTo:t+30*864e5,requestedBy:"Org Admin",status:"Approved",reason:"Executive charging allowance",approvalId:"APR-EX-001"}]),[T,k]=d.useState(()=>{const B=t-108e5;return[{id:"APR-001",createdAt:B,createdBy:"Charging Coordinator",status:"Pending",scope:"Session",scopeId:"CS-001",reason:"Visitor VIP requested DC fast at Airport",flags:["VIP","DC"],steps:EC(["VIP","DC"]).map(p=>({id:Br("AS"),role:p.role,assignee:p.role==="Manager"?"Manager":p.role==="Finance"?"Finance Desk":"CFO",status:"Pending",requestedAt:B,slaHours:p.slaHours}))}]}),[q,L]=d.useState(()=>[{id:"PLAN-001",name:"Daily depot top-up",days:["Mon","Tue","Wed","Thu","Fri"],timeLocal:"19:30",siteId:"SITE-UG-HQ",connector:"Type 2 (AC)",durationMins:120,expectedKWh:35,maxBudgetUGX:35e3,purpose:"Operations",tags:["Depot","Operations"],vehicles:["VEH-001","VEH-002"],enabled:!0}]),[R,U]=d.useState(()=>{const p=t+864e5+324e5,E=t+1*864e5+18*36e5,se=t+2*864e5+7*36e5;return[{id:"CS-001",ref:Dc("CHG"),vehicleId:"VEH-005",bookedBy:"Charging Coordinator",createdAt:t-3*36e5,scheduledAt:p,durationMins:40,siteId:"SITE-UG-EBB",connector:"CCS2 (DC)",expectedKWh:45,maxBudgetUGX:12e4,purpose:"Visitor",tags:["VIP","Airport"],costCenter:"SALES-TRAVEL",projectTag:"Roadshow",module:"EVs & Charging",status:"Pending approval",policyNotes:["VIP","DC fast"],proofs:[]},{id:"CS-002",ref:Dc("CHG"),vehicleId:"VEH-001",bookedBy:"Charging Coordinator",createdAt:t-90*60*1e3,scheduledAt:E,durationMins:120,siteId:"SITE-UG-HQ",connector:"Type 2 (AC)",expectedKWh:30,maxBudgetUGX:3e4,purpose:"Operations",tags:["Depot"],costCenter:"OPS-001",projectTag:"Daily ops",module:"EVs & Charging",status:"Confirmed",policyNotes:[],proofs:[]},{id:"CS-003",ref:Dc("CHG"),vehicleId:"VEH-003",bookedBy:"Charging Coordinator",createdAt:t-2*36e5,scheduledAt:se,durationMins:60,siteId:"SITE-UG-JJA",connector:"Type 2 (AC)",expectedKWh:25,maxBudgetUGX:25e3,purpose:"Office commute",tags:["Commute"],costCenter:"SALES-TRAVEL",projectTag:"Commute program",module:"EVs & Charging",status:"Confirmed",policyNotes:[],proofs:[]}]}),[ae,ie]=d.useState("overview"),[_,W]=d.useState(""),[J,we]=d.useState("All"),[G,be]=d.useState("All"),[Ge,Me]=d.useState("All"),[je,Ue]=d.useState(!1),[Oe,he]=d.useState(null),Y=d.useMemo(()=>Oe&&R.find(f=>f.id===Oe)||null,[Oe,R]),[Ie,ce]=d.useState(!1),[me,pe]=d.useState(0),[de,ye]=d.useState(()=>{var f,B;return{vehicleId:((f=x[0])==null?void 0:f.id)||"",bookedBy:"Charging Coordinator",scheduledAt:kC(t+24*60*60*1e3),durationMins:60,siteId:((B=c[0])==null?void 0:B.id)||"",connector:"Type 2 (AC)",expectedKWh:25,maxBudgetUGX:25e3,purpose:"Operations",purposeOther:"",tags:"Operations",costCenter:"OPS-001",projectTag:"Charging",prioritySlot:!1}}),[Qe,Fe]=d.useState(!1),[ke,fe]=d.useState(()=>{var f;return{name:"Fleet morning top-up",siteId:((f=c[0])==null?void 0:f.id)||"",startAt:kC(t+2*24*60*60*1e3+8*60*60*1e3),intervalMins:20,durationMins:40,connector:"Type 2 (AC)",expectedKWh:18,maxBudgetUGX:18e3,purpose:"Operations",tags:"Fleet",costCenter:"OPS-001",projectTag:"Fleet plan",vehicleIds:["VEH-001","VEH-002"],prioritySlot:!1}}),[Ve,ne]=d.useState(!1),[Te,Ee]=d.useState(()=>({vehicleId:"VEH-004",exceptionType:"DC fast",validDays:30,reason:""})),Re=f=>{var B;return((B=g[f])==null?void 0:B.label)||f},ze=f=>{const B=g[f];return B?`${B.ownerName} (${B.ownerType})`:"-"},qe=(f,B,p)=>N.some(E=>E.vehicleId===f&&E.exceptionType===B&&E.status==="Approved"&&p>=E.validFrom&&p<=E.validTo),He=f=>{var re;const B=[],p=LB(f.whenTs,i.workStart,i.workEnd),E=Sb(Wh(f.whenTs)),se=f.connector.includes("DC"),y=!!((re=g[f.vehicleId])!=null&&re.vip);return p&&B.push("After-hours"),E&&B.push("Peak tariff"),y&&B.push("VIP"),f.prioritySlot&&B.push("Priority slot"),se&&B.push("DC fast"),f.expectedKWh>i.maxKWhPerSession&&B.push("Above kWh limit"),f.maxBudgetUGX>i.maxBudgetUGXPerSession&&B.push("Above budget limit"),{flags:B,after:p,peak:E,vip:y,isDC:se}},_e=d.useMemo(()=>{const f=CC(de.scheduledAt),B=[];i.requirePurpose&&(!de.purpose||de.purpose==="Other"&&!de.purposeOther.trim())&&B.push("Purpose required"),i.requireCostCenter&&!de.costCenter.trim()&&B.push("Cost center required"),i.requireProjectTag&&!de.projectTag.trim()&&B.push("Project tag required");const p=He({whenTs:f,connector:de.connector,prioritySlot:de.prioritySlot,expectedKWh:de.expectedKWh,maxBudgetUGX:de.maxBudgetUGX,vehicleId:de.vehicleId});let E=!1;p.isDC&&i.dcRequiresApproval&&!qe(de.vehicleId,"DC fast",f)&&(E=!0),de.prioritySlot&&i.priorityRequiresApproval&&!qe(de.vehicleId,"Priority slot",f)&&(E=!0),p.after&&!qe(de.vehicleId,"After-hours",f)&&(E=!0),(de.expectedKWh>i.maxKWhPerSession||de.maxBudgetUGX>i.maxBudgetUGXPerSession)&&(E=!0),p.vip&&(p.isDC||de.prioritySlot||p.after)&&(E=!0);const se=B.length===0,y=p.peak?"Consider scheduling 30-60 minutes earlier or later to avoid peak tariff.":"No peak tariff warning.",re=p.flags.filter(P=>P!=="Peak tariff"),ve=p.isDC&&qe(de.vehicleId,"DC fast",f)||de.prioritySlot&&qe(de.vehicleId,"Priority slot",f)||p.after&&qe(de.vehicleId,"After-hours",f);return{whenTs:f,requiredErrors:B,...p,needsApproval:E,canCreate:se,suggestion:y,approvalFlags:re,hasActiveVipException:ve}},[de,i,N,g]),le=d.useMemo(()=>{const f=_.trim().toLowerCase();return R.filter(B=>J==="All"?!0:B.status===J).filter(B=>G==="All"?!0:B.vehicleId===G).filter(B=>Ge==="All"?!0:B.siteId===Ge).filter(B=>{if(!f)return!0;const p=g[B.vehicleId],E=j[B.siteId];return`${B.ref} ${B.id} ${(p==null?void 0:p.label)||""} ${(p==null?void 0:p.ownerName)||""} ${(E==null?void 0:E.name)||""} ${B.connector} ${B.purpose} ${B.tags.join(" ")} ${B.costCenter} ${B.projectTag}`.toLowerCase().includes(f)}).slice().sort((B,p)=>B.scheduledAt-p.scheduledAt)},[R,_,J,G,Ge,g,j]),z=d.useMemo(()=>R.filter(f=>f.scheduledAt>t&&f.status!=="Cancelled"),[R,t]),Pe=d.useMemo(()=>{const f=Array.from({length:24},()=>0);for(const B of z)f[Wh(B.scheduledAt)]+=1;return f},[z]),Be=d.useMemo(()=>{let f=0,B=-1;return Pe.forEach((p,E)=>{p>B&&(B=p,f=E)}),{hour:f,count:B}},[Pe]),xe=Be.count>=i.peakHourThreshold,Ne=d.useMemo(()=>{const f={};for(const E of c)f[E.id]=E.connectors.reduce((se,y)=>se+y.count,0);const B={};for(const E of c)B[E.id]=Array.from({length:24},()=>0);for(const E of z){const se=Wh(E.scheduledAt);B[E.siteId][se]+=1}const p=Object.keys(B).flatMap(E=>B[E].map((se,y)=>({siteId:E,h:y,count:se,cap:f[E]||1})).filter(se=>se.count>se.cap)).sort((E,se)=>se.count-E.count);return{capBySite:f,booked:B,congested:p}},[z,c]),M=d.useMemo(()=>{const f=R.filter(se=>["Draft","Pending approval","Confirmed"].includes(se.status)).length,B=T.filter(se=>se.status==="Pending").length,p=T.filter(se=>se.status==="Pending"&&se.flags.some(y=>y.toLowerCase().includes("vip"))).length,E=R.filter(se=>se.connector.includes("DC")).length;return{open:f,pendingApprovals:B,vipPending:p,dcCount:E}},[R,T]),H=f=>{he(f),Ue(!0)},Ae=f=>{const B=Date.now(),p={Manager:"Manager",Finance:"Finance Desk",CFO:"CFO",CEO:"CEO"},E=EC(f.flags).map(y=>({id:Br("AS"),role:y.role,assignee:p[y.role],status:"Pending",requestedAt:B,slaHours:y.slaHours})),se={id:Br("APR"),createdAt:B,createdBy:f.createdBy,status:"Pending",scope:f.scope,scopeId:f.scopeId,reason:f.reason,flags:f.flags,steps:E};return k(y=>[se,...y]),se},oe=()=>{if(!_e.canCreate){r({title:"Fix required fields",message:_e.requiredErrors.join("  "),kind:"warn"});return}const f=Date.now(),B=Br("CS"),p=de.tags.split(",").map(y=>y.trim()).filter(Boolean).slice(0,12),E=de.purpose==="Other"?de.purposeOther.trim():void 0,se={id:B,ref:Dc("CHG"),vehicleId:de.vehicleId,bookedBy:de.bookedBy,createdAt:f,scheduledAt:_e.whenTs,durationMins:vd(de.durationMins,10,360),siteId:de.siteId,connector:de.connector,expectedKWh:Math.max(1,de.expectedKWh),maxBudgetUGX:Math.max(0,de.maxBudgetUGX),purpose:de.purpose,purposeOther:E,tags:p,costCenter:de.costCenter.trim(),projectTag:de.projectTag.trim(),module:"EVs & Charging",status:_e.needsApproval?"Pending approval":"Confirmed",policyNotes:_e.flags.filter(y=>!y.endsWith("required")),proofs:[]};U(y=>[se,...y]),_e.needsApproval&&Ae({scope:"Session",scopeId:se.id,createdBy:se.bookedBy,reason:"Policy exception required for EV charging session",flags:_e.approvalFlags.length?_e.approvalFlags:["Policy exception"]}),r({title:"Created",message:_e.needsApproval?"Session created and sent for approval.":"Session confirmed.",kind:"success"}),ce(!1),pe(0),ie("sessions")},De=()=>{const f=CC(ke.startAt),B=Date.now();if(!ke.vehicleIds.length){r({title:"No vehicles",message:"Select at least one vehicle.",kind:"warn"});return}const p=[];let E=!1;if(ke.vehicleIds.forEach((se,y)=>{const re=f+y*ke.intervalMins*60*1e3,ve=He({whenTs:re,connector:ke.connector,prioritySlot:ke.prioritySlot,expectedKWh:ke.expectedKWh,maxBudgetUGX:ke.maxBudgetUGX,vehicleId:se}).flags,P=ve.some(X=>X==="After-hours"||X==="DC fast"||X==="Priority slot"||X==="VIP");E=E||P,p.push({id:Br("CS"),ref:Dc("FLT"),vehicleId:se,bookedBy:"Charging Coordinator",createdAt:B,scheduledAt:re,durationMins:vd(ke.durationMins,10,360),siteId:ke.siteId,connector:ke.connector,expectedKWh:Math.max(1,ke.expectedKWh),maxBudgetUGX:Math.max(0,ke.maxBudgetUGX),purpose:ke.purpose,tags:ke.tags.split(",").map(X=>X.trim()).filter(Boolean),costCenter:ke.costCenter,projectTag:ke.projectTag,module:"EVs & Charging",status:P?"Pending approval":"Confirmed",policyNotes:ve.filter(X=>X!=="Peak tariff"),proofs:[]})}),U(se=>[...p,...se]),E){const se=Array.from(new Set(p.flatMap(y=>y.policyNotes))).filter(Boolean);Ae({scope:"Fleet plan",scopeId:Br("PLANRUN"),createdBy:"Charging Coordinator",reason:`Bulk fleet charging requires policy approval (${p.filter(y=>y.status==="Pending approval").length} pending).`,flags:se.length?se:["Bulk charging"]})}r({title:"Bulk created",message:`Created ${p.length} session(s).`,kind:"success"}),Fe(!1),ie("sessions")},$e=f=>{const B=Date.now();k(p=>p.map(E=>{if(E.id!==f)return E;const se=E.steps.findIndex(ve=>ve.status==="Pending");if(se<0)return E;const y=E.steps.slice();y[se]={...y[se],status:"Approved",decidedAt:B,note:"Approved"};const re=y.every(ve=>ve.status==="Approved");return{...E,steps:y,status:re?"Approved":"Pending"}})),setTimeout(()=>{k(p=>{const E=p.find(se=>se.id===f);return!E||E.status!=="Approved"||(E.scope==="Session"&&U(se=>se.map(y=>y.id===E.scopeId?{...y,status:"Confirmed"}:y)),E.scope==="VIP Exception"&&$(se=>se.map(y=>y.approvalId===E.id?{...y,status:"Approved"}:y)),r({title:"Approved",message:"Approval progressed.",kind:"success"})),p})},0)},ge=f=>{const B=Date.now();k(E=>E.map(se=>{if(se.id!==f)return se;const y=se.steps.findIndex(ve=>ve.status==="Pending"),re=se.steps.slice();return y>=0&&(re[y]={...re[y],status:"Rejected",decidedAt:B,note:"Rejected"}),{...se,steps:re,status:"Rejected"}}));const p=T.find(E=>E.id===f);(p==null?void 0:p.scope)==="Session"&&U(E=>E.map(se=>se.id===p.scopeId?{...se,status:"Cancelled",policyNotes:[...se.policyNotes,"Rejected"]}:se)),r({title:"Rejected",message:"Approval rejected.",kind:"warn"})},ue=()=>{if(!Te.reason.trim()){r({title:"Missing",message:"Add a reason.",kind:"warn"});return}const B=Date.now(),p={id:Br("VX"),vehicleId:Te.vehicleId,exceptionType:Te.exceptionType,validFrom:B,validTo:B+vd(Te.validDays,1,365)*864e5,requestedBy:"Org Admin",status:"Pending",reason:Te.reason.trim()},E=["VIP",Te.exceptionType==="DC fast"?"DC":Te.exceptionType==="Priority slot"?"Priority":"After-hours"],se=Ae({scope:"VIP Exception",scopeId:p.id,createdBy:p.requestedBy,reason:p.reason,flags:E});p.approvalId=se.id,$(y=>[p,...y]),r({title:"Requested",message:"VIP exception requested and routed to approvals.",kind:"success"}),ne(!1),ie("approvals")},Ke=()=>{const f=le.map(X=>{const S=g[X.vehicleId],w=j[X.siteId];return{ref:X.ref,status:X.status,when:fi(X.scheduledAt),vehicle:(S==null?void 0:S.label)||X.vehicleId,owner:S?`${S.ownerName} (${S.ownerType})`:"-",site:(w==null?void 0:w.name)||X.siteId,connector:X.connector,expectedKWh:X.expectedKWh,maxBudgetUGX:X.maxBudgetUGX,purpose:X.purpose==="Other"?X.purposeOther||"Other":X.purpose,tags:X.tags.join(";"),costCenter:X.costCenter,projectTag:X.projectTag,policyNotes:X.policyNotes.join(";")}}),B=Object.keys(f[0]||{ref:""}),p=X=>{const S=String(X??"");return/[",\n]/.test(S)?`"${S.replace(/"/g,'""')}"`:S},E=B.join(","),se=f.map(X=>B.map(S=>p(X[S])).join(",")).join(`
`),y=`${E}
${se}`,re=new Blob([y],{type:"text/csv"}),ve=URL.createObjectURL(re),P=document.createElement("a");P.href=ve,P.download="corporate-ev-charging-sessions.csv",P.click(),URL.revokeObjectURL(ve),r({title:"Exported",message:"Sessions CSV downloaded.",kind:"success"})};return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(UB,{toasts:l,onDismiss:f=>n(B=>B.filter(p=>p.id!==f))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:vx.green},children:e.jsx(Xx,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Corporate EV Charging Scheduling"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Pre-book charging sessions for employees, visitors, and company vehicles. Enforce purpose tagging, coordinate bulk plans, and handle VIP exceptions with approvals."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(ut,{label:`Open: ${M.open}`,tone:M.open?"warn":"good"}),e.jsx(ut,{label:`Approvals: ${M.pendingApprovals}`,tone:M.pendingApprovals?"warn":"good"}),e.jsx(ut,{label:`VIP pending: ${M.vipPending}`,tone:M.vipPending?"warn":"good"}),e.jsx(ut,{label:`DC sessions: ${M.dcCount}`,tone:M.dcCount?"info":"neutral"}),e.jsx(ut,{label:xe?`Peak hour: ${Be.hour}:00 (${Be.count})`:`Peak hour: ${Be.hour}:00`,tone:xe?"warn":"neutral"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ss,{variant:"outline",onClick:Ke,children:[e.jsx(gt,{className:"h-4 w-4"})," Export CSV"]}),e.jsxs(ss,{variant:"outline",onClick:()=>Fe(!0),children:[e.jsx(Us,{className:"h-4 w-4"})," Bulk fleet plan"]}),e.jsxs(ss,{variant:"primary",onClick:()=>{ce(!0),pe(0)},children:[e.jsx(pt,{className:"h-4 w-4"})," New session"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"overview",label:"Overview"},{id:"sessions",label:"Sessions"},{id:"sites",label:"Sites"},{id:"recurring",label:"Recurring"},{id:"vip",label:"VIP"},{id:"approvals",label:"Approvals"},{id:"insights",label:"Insights"}].map(f=>e.jsx("button",{className:ya("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",ae===f.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:ae===f.id?{background:vx.green}:void 0,onClick:()=>ie(f.id),children:f.label},f.id))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[ae==="overview"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsxs(fl,{title:"Upcoming sessions",subtitle:"Next scheduled sessions across all sites.",right:e.jsx(ut,{label:`${z.length} upcoming`,tone:z.length?"info":"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"When"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vehicle"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Site"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Connector"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Purpose"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Action"})]})}),e.jsxs("tbody",{children:[z.slice().sort((f,B)=>f.scheduledAt-B.scheduledAt).slice(0,7).map(f=>{const B=g[f.vehicleId],p=j[f.siteId],E=Sb(Wh(f.scheduledAt));return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:fi(f.scheduledAt)}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:(B==null?void 0:B.label)||f.vehicleId}),B!=null&&B.vip?e.jsx(ut,{label:"VIP",tone:"info"}):null,e.jsx(ut,{label:B?B.ownerType:"-",tone:"neutral"}),E?e.jsx(ut,{label:"Peak",tone:"warn"}):e.jsx(ut,{label:"Off-peak",tone:"good"})]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:B?`${B.ownerName}  ${B.costCenter}`:"-"})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(p==null?void 0:p.name)||f.siteId}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx(ut,{label:f.connector,tone:f.connector.includes("DC")?"info":"neutral"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[f.expectedKWh," kWh  ",f.durationMins," min"]})]}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx(ut,{label:f.purpose==="Other"?f.purposeOther||"Other":f.purpose,tone:"neutral"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[f.tags.slice(0,3).join(", "),f.tags.length>3?"":""]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ut,{label:f.status,tone:Eb(f.status)})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(ss,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>H(f.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]})})]},f.id)}),z.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10",children:e.jsx(Lm,{title:"No upcoming sessions",subtitle:"Create a new charging session or run a recurring plan."})})})]})]})}),Ne.congested.length?e.jsxs("div",{className:"mt-3 rounded-2xl bg-rose-50 p-3 text-xs text-rose-800 ring-1 ring-rose-200",children:["Congestion risk: ",((v=j[Ne.congested[0].siteId])==null?void 0:v.name)||Ne.congested[0].siteId," at ",Ne.congested[0].h,":00 is over capacity (",Ne.congested[0].count,"/",Ne.congested[0].cap,")."]}):xe?e.jsxs("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:["Smart scheduling: peak hour detected around ",Be.hour,":00. Consider off-peak scheduling or distributing sessions across sites."]}):e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Smart scheduling: no peak congestion detected in upcoming sessions."})]}),e.jsxs(fl,{title:"Policy guardrails",subtitle:"Purpose enforcement, limits, and approvals.",right:e.jsx(ut,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx($m,{enabled:i.requirePurpose,onChange:f=>o(B=>({...B,requirePurpose:f})),label:"Require purpose",description:"Purpose stored for reporting and audits."}),e.jsx($m,{enabled:i.requireProjectTag,onChange:f=>o(B=>({...B,requireProjectTag:f})),label:"Require project tag",description:"Used for chargeback and analytics."}),e.jsx($m,{enabled:i.requireCostCenter,onChange:f=>o(B=>({...B,requireCostCenter:f})),label:"Require cost center",description:"Enforced on creation."}),e.jsx($m,{enabled:i.dcRequiresApproval,onChange:f=>o(B=>({...B,dcRequiresApproval:f})),label:"DC requires approval",description:"DC fast charging is approval-gated."}),e.jsx($m,{enabled:i.priorityRequiresApproval,onChange:f=>o(B=>({...B,priorityRequiresApproval:f})),label:"Priority requires approval",description:"Priority slot requests require approval."}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Limits"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3",children:[e.jsx(qr,{label:"Max kWh per session",value:i.maxKWhPerSession,onChange:f=>o(B=>({...B,maxKWhPerSession:Math.max(1,f)})),hint:"kWh"}),e.jsx(qr,{label:"Max budget per session",value:i.maxBudgetUGXPerSession,onChange:f=>o(B=>({...B,maxBudgetUGXPerSession:Math.max(0,f)})),hint:"UGX"})]})]})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:["Working hours: ",i.workStart," to ",i.workEnd,". After-hours sessions require approval unless an exception is active."]})]})]}),e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsx(fl,{title:"Sites",subtitle:"Operational health and pricing.",right:e.jsx(ut,{label:`${c.length}`,tone:"neutral"}),children:e.jsx("div",{className:"space-y-2",children:c.map(f=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:f.name}),e.jsx(ut,{label:f.status,tone:AC(f.status)}),e.jsx(ut,{label:`${f.reliabilityPct}%`,tone:f.reliabilityPct>=90?"good":f.reliabilityPct>=80?"warn":"bad"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[f.city,"  ",f.operator]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Connectors: ",f.connectors.reduce((B,p)=>B+p.count,0)," total"]})]}),e.jsxs(ss,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{ie("sites"),Me(f.id),r({title:"Filtered",message:"Showing sessions for this site.",kind:"info"})},children:[e.jsx(et,{className:"h-4 w-4"})," View"]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[f.connectors.slice(0,3).map(B=>e.jsx(ut,{label:`${B.connector}  ${B.powerKW}kW`,tone:B.connector.includes("DC")?"info":"neutral"},`${f.id}-${B.connector}`)),f.connectors.length>3?e.jsx(ut,{label:"+more",tone:"neutral"}):null]})]},f.id))})}),e.jsxs(fl,{title:"Approvals",subtitle:"Policy exceptions and VIP handling.",right:e.jsx(ut,{label:`${T.filter(f=>f.status==="Pending").length}`,tone:T.filter(f=>f.status==="Pending").length?"warn":"good"}),children:[e.jsxs("div",{className:"space-y-2",children:[T.filter(f=>f.status==="Pending").slice(0,4).map(f=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ut,{label:f.scope,tone:"neutral"}),e.jsx(ut,{label:f.status,tone:Xh(f.status)}),e.jsx(ut,{label:`${f.steps.filter(B=>B.status==="Pending").length} step(s)`,tone:"info"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:f.reason}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[Cb(f.createdAt),"  ",f.createdBy]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(ss,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>$e(f.id),children:[e.jsx(tt,{className:"h-4 w-4"})," Approve"]}),e.jsxs(ss,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ge(f.id),children:[e.jsx(Ye,{className:"h-4 w-4"})," Reject"]})]})]})},f.id)),T.filter(f=>f.status==="Pending").length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No pending approvals."})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(ss,{variant:"outline",onClick:()=>ie("approvals"),children:[e.jsx(et,{className:"h-4 w-4"})," Open approvals"]}),e.jsxs(ss,{variant:"outline",onClick:()=>ne(!0),children:[e.jsx(Xr,{className:"h-4 w-4"})," VIP exception"]})]})]})]})]}):null,ae==="sessions"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(fl,{title:"Search and filters",subtitle:"Coordinator view",right:e.jsx(ut,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-2 py-2",children:[e.jsx(ka,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:_,onChange:f=>W(f.target.value),placeholder:"ref, vehicle, site, tag...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(pr,{label:"Status",value:J,onChange:f=>we(f),options:[{value:"All",label:"All"},...["Draft","Pending approval","Confirmed","In progress","Completed","Cancelled"].map(f=>({value:f,label:f}))]}),e.jsx(pr,{label:"Vehicle",value:G,onChange:be,options:[{value:"All",label:"All"},...x.map(f=>({value:f.id,label:f.label}))]}),e.jsx(pr,{label:"Site",value:Ge,onChange:Me,options:[{value:"All",label:"All"},...c.map(f=>({value:f.id,label:f.name}))]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(ss,{variant:"outline",onClick:()=>{W(""),we("All"),be("All"),Me("All"),r({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(fn,{className:"h-4 w-4"})," Reset"]}),e.jsxs(ss,{variant:"outline",onClick:Ke,children:[e.jsx(gt,{className:"h-4 w-4"})," CSV"]}),e.jsxs(ss,{variant:"primary",onClick:()=>ce(!0),children:[e.jsx(pt,{className:"h-4 w-4"})," New"]})]})]}),e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Best practice: store purpose tags, cost center, and project tag on every charging session."})]})}),e.jsx("div",{className:"lg:col-span-8",children:e.jsx(fl,{title:"Sessions",subtitle:"Pre-booked corporate charging sessions.",right:e.jsx(ut,{label:`${le.length}`,tone:"neutral"}),children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Ref"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"When"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vehicle"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Site"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"kWh and budget"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[le.map(f=>{const B=g[f.vehicleId],p=j[f.siteId];return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:f.ref}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:f.id})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:fi(f.scheduledAt)}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:(B==null?void 0:B.label)||f.vehicleId}),B!=null&&B.vip?e.jsx(ut,{label:"VIP",tone:"info"}):null,e.jsx(ut,{label:B?B.ownerType:"-",tone:"neutral"})]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:B?`${B.ownerName}  ${B.costCenter}`:"-"})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(p==null?void 0:p.name)||f.siteId}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx(ut,{label:`${f.expectedKWh} kWh`,tone:"neutral"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Budget ",Hh(f.maxBudgetUGX),"  ",f.connector]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ut,{label:f.status,tone:Eb(f.status)})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(ss,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>H(f.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]})})]},f.id)}),le.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10",children:e.jsx(Lm,{title:"No sessions",subtitle:"Create a session or change filters."})})})]})]})})})})]}):null,ae==="sites"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsx(fl,{title:"Charging sites",subtitle:"Status, reliability, and connectors.",right:e.jsx(ut,{label:"Core",tone:"neutral"}),children:e.jsx("div",{className:"space-y-2",children:c.map(f=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:f.name}),e.jsx(ut,{label:f.status,tone:AC(f.status)}),e.jsx(ut,{label:`${f.reliabilityPct}%`,tone:f.reliabilityPct>=90?"good":f.reliabilityPct>=80?"warn":"bad"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[f.city,"  ",f.operator]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:f.address})]}),e.jsxs(ss,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Me(f.id),ie("sessions"),r({title:"Filtered",message:"Showing sessions for this site.",kind:"info"})},children:[e.jsx(et,{className:"h-4 w-4"})," Sessions"]})]}),e.jsx("div",{className:"mt-3 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Connector"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Power"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Count"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Price"})]})}),e.jsx("tbody",{children:f.connectors.map(B=>e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx(ut,{label:B.connector,tone:B.connector.includes("DC")?"info":"neutral"})}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[B.powerKW," kW"]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:B.count}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[Hh(B.priceUGXPerKWh)," / kWh"]})]},`${f.id}-${B.connector}-${B.powerKW}`))})]})})]},f.id))})})}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsx(fl,{title:"Site utilization",subtitle:"Premium: detect over-capacity time windows.",right:e.jsx(ut,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Over-capacity alerts"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"If sessions scheduled exceed connector capacity per hour."}),e.jsxs("div",{className:"mt-3 space-y-2",children:[Ne.congested.slice(0,6).map(f=>{var B;return e.jsxs("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 p-3 text-xs text-rose-800",children:[((B=j[f.siteId])==null?void 0:B.name)||f.siteId," at ",f.h,":00 is over capacity (",f.count,"/",f.cap,")."]},`${f.siteId}-${f.h}`)}),Ne.congested.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No over-capacity windows detected."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: you can add load management rules and stagger sessions by connector power."})]})})})]}):null,ae==="recurring"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-6 space-y-4",children:e.jsxs(fl,{title:"Recurring plans",subtitle:"Core: recurring charging schedules.",right:e.jsx(ut,{label:`${q.length}`,tone:"neutral"}),children:[e.jsxs("div",{className:"space-y-2",children:[q.map(f=>{var B;return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:f.name}),e.jsx(ut,{label:f.enabled?"Enabled":"Disabled",tone:f.enabled?"good":"neutral"}),e.jsx(ut,{label:f.timeLocal,tone:"neutral"}),e.jsx(ut,{label:f.connector.includes("DC")?"DC":"AC",tone:f.connector.includes("DC")?"info":"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Days: ",f.days.join(", ")]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Site: ",((B=j[f.siteId])==null?void 0:B.name)||f.siteId]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Vehicles: ",f.vehicles.map(p=>{var E;return((E=g[p])==null?void 0:E.label)||p}).join(", ")]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(ss,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{L(p=>p.map(E=>E.id===f.id?{...E,enabled:!E.enabled}:E)),r({title:"Updated",message:"Plan updated.",kind:"success"})},children:[e.jsx(PE,{className:"h-4 w-4"})," Toggle"]}),e.jsxs(ss,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{const p=Date.now()+1728e5,[E,se]=f.timeLocal.split(":").map(X=>Number(X)),y=new Date(p);y.setHours(E||0,se||0,0,0);const re=y.getTime(),ve=f.vehicles.map(X=>{var h;const S=He({whenTs:re,connector:f.connector,prioritySlot:!1,expectedKWh:f.expectedKWh,maxBudgetUGX:f.maxBudgetUGX,vehicleId:X}).flags,w=S.some(K=>K==="After-hours"||K==="DC fast"||K==="VIP");return{id:Br("CS"),ref:Dc("RC"),vehicleId:X,bookedBy:"Charging Coordinator",createdAt:Date.now(),scheduledAt:re,durationMins:f.durationMins,siteId:f.siteId,connector:f.connector,expectedKWh:f.expectedKWh,maxBudgetUGX:f.maxBudgetUGX,purpose:f.purpose,tags:f.tags,costCenter:((h=g[X])==null?void 0:h.costCenter)||"OPS-001",projectTag:f.name,module:"EVs & Charging",status:w?"Pending approval":"Confirmed",policyNotes:S.filter(K=>K!=="Peak tariff"),proofs:[]}});U(X=>[...ve,...X]),ve.some(X=>X.status==="Pending approval")&&Ae({scope:"Fleet plan",scopeId:f.id,createdBy:"Charging Coordinator",reason:"Recurring plan generated sessions requiring approval",flags:Array.from(new Set(ve.flatMap(X=>X.policyNotes))).filter(Boolean)}),r({title:"Generated",message:`Created ${ve.length} session(s) from plan.`,kind:"success"}),ie("sessions")},disabled:!f.enabled,title:f.enabled?"":"Enable plan first",children:[e.jsx(ht,{className:"h-4 w-4"})," Generate"]})]})]})},f.id)}),q.length?null:e.jsx(Lm,{title:"No plans",subtitle:"Create a recurring charging plan."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: plans can be extended with tariff calendars and site load constraints."})]})}),e.jsx("div",{className:"lg:col-span-6 space-y-4",children:e.jsxs(fl,{title:"Best practices",subtitle:"Operational tips",right:e.jsx(ut,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"1) Use off-peak windows for depot top-ups"}),e.jsx("li",{children:"2) Stagger sessions by 15-30 minutes to avoid connector contention"}),e.jsx("li",{children:"3) Enforce purpose tags and cost centers for chargeback"}),e.jsx("li",{children:"4) Maintain VIP exceptions with approvals and audit trails"})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Tip: Link these approvals to your global Approval Workflow Builder so Corporate Travel and EV Charging share the same governance."})]})})]}):null,ae==="vip"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-6 space-y-4",children:e.jsx(fl,{title:"Vehicles",subtitle:"Company, employee, and visitor EVs.",right:e.jsx(ut,{label:`${x.length}`,tone:"neutral"}),children:e.jsx("div",{className:"space-y-2",children:x.map(f=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:f.label}),e.jsx(ut,{label:f.ownerType,tone:"neutral"}),f.vip?e.jsx(ut,{label:"VIP",tone:"info"}):null,e.jsx(ut,{label:`${f.batteryKWh}kWh`,tone:"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Owner: ",f.ownerName]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Cost center: ",f.costCenter,"  Group: ",f.group]})]}),e.jsxs(ss,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>{ye(B=>({...B,vehicleId:f.id,category:f.vip?"Premium":"Standard",connector:f.vip?"CCS2 (DC)":"Type 2 (AC)",purpose:f.ownerType==="Visitor"?"Visitor":"Operations",tags:f.vip?"VIP":"Operations",costCenter:f.costCenter,projectTag:f.ownerType==="Visitor"?"Visitor charging":"Charging",prioritySlot:f.vip})),pe(1),ce(!0)},children:[e.jsx(Xx,{className:"h-4 w-4"})," Schedule"]})]})},f.id))})})}),e.jsx("div",{className:"lg:col-span-6 space-y-4",children:e.jsxs(fl,{title:"VIP exceptions",subtitle:"Premium: DC, priority slot, after-hours",right:e.jsx(ut,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ss,{variant:"primary",onClick:()=>ne(!0),children:[e.jsx(Xr,{className:"h-4 w-4"})," Request exception"]}),e.jsxs(ss,{variant:"outline",onClick:()=>ie("approvals"),children:[e.jsx(et,{className:"h-4 w-4"})," View approvals"]})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[N.map(f=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ut,{label:f.exceptionType,tone:"neutral"}),e.jsx(ut,{label:f.status,tone:Xh(f.status)}),e.jsx(ut,{label:`${wC(f.validFrom)} to ${wC(f.validTo)}`,tone:"info"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:Re(f.vehicleId)}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Requested by ",f.requestedBy,"  ",f.reason]}),f.approvalId?e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Approval: ",f.approvalId]}):null]}),e.jsx(Xr,{className:ya("h-5 w-5",f.status==="Approved"?"text-amber-500":"text-slate-300")})]})},f.id)),N.length?null:e.jsx(Lm,{title:"No VIP exceptions",subtitle:"Request an exception to allow DC, priority, or after-hours."})]})]})})]}):null,ae==="approvals"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(fl,{title:"Approvals",subtitle:"Policy exceptions for DC, priority, after-hours.",right:e.jsx(ut,{label:"Core",tone:"neutral"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Approvals are required before a session is sent to the station booking engine."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(ss,{variant:"primary",onClick:()=>ne(!0),children:[e.jsx(Xr,{className:"h-4 w-4"})," VIP exception"]}),e.jsxs(ss,{variant:"outline",onClick:()=>r({title:"Tip",message:"Map these approvals to your global Approval Workflow Builder.",kind:"info"}),children:[e.jsx(vn,{className:"h-4 w-4"})," Tip"]})]})]})}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsx(fl,{title:"Approval requests",subtitle:"Approve or reject with audit trail.",right:e.jsx(ut,{label:`${T.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[T.slice().sort((f,B)=>B.createdAt-f.createdAt).map(f=>{const B=f.steps.findIndex(E=>E.status==="Pending"),p=B>=0?f.steps[B]:null;return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ut,{label:f.scope,tone:"neutral"}),e.jsx(ut,{label:f.status,tone:Xh(f.status)}),e.jsx(ut,{label:f.id,tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:f.reason}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",Cb(f.createdAt),"  ",f.createdBy]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:f.flags.map((E,se)=>e.jsx(ut,{label:E,tone:E.toLowerCase().includes("vip")?"info":"neutral"},`${f.id}-f-${se}`))}),p?e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Next: ",e.jsx("span",{className:"font-semibold",children:p.role})," (",p.assignee,")  SLA ",p.slaHours,"h"]}):null]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ss,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>$e(f.id),disabled:f.status!=="Pending",children:[e.jsx(tt,{className:"h-4 w-4"})," Approve"]}),e.jsxs(ss,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ge(f.id),disabled:f.status!=="Pending",children:[e.jsx(Ye,{className:"h-4 w-4"})," Reject"]}),f.scope==="Session"?e.jsxs(ss,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{H(f.scopeId)},children:[e.jsx(et,{className:"h-4 w-4"})," Open session"]}):null]})]}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2 md:grid-cols-2",children:f.steps.map(E=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:E.role}),e.jsx(ut,{label:E.status,tone:Xh(E.status)})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Assignee: ",E.assignee,"  SLA ",E.slaHours,"h"]}),E.decidedAt?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Decided ",fi(E.decidedAt),"  ",E.note||""]}):null]},E.id))})]},f.id)}),T.length?null:e.jsx(Lm,{title:"No approvals",subtitle:"Policy exceptions will appear here."})]})})})]}):null,ae==="insights"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsx(fl,{title:"Peak tariff detection",subtitle:"Premium: recommend off-peak scheduling.",right:e.jsx(ut,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Peak hour"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Upcoming sessions by hour (0-23)"})]}),e.jsx(ut,{label:`${Be.hour}:00  ${Be.count}`,tone:xe?"warn":"neutral"})]}),e.jsx("div",{className:"mt-4 grid grid-cols-6 gap-2 sm:grid-cols-8 md:grid-cols-12",children:Pe.map((f,B)=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-2 text-center",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-700",children:B}),e.jsx("div",{className:ya("mt-2 h-2 rounded-full",Sb(B)?"bg-amber-200":"bg-emerald-200")}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:f})]},B))}),e.jsx("div",{className:"mt-4 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Suggestion: avoid peak tariff windows (7-9 and 17-20) for non-urgent charging. Use AC off-peak top-ups."})]})})}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs(fl,{title:"Smart recommendations",subtitle:"Next best coordinator actions.",right:e.jsx(ut,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{title:"Bulk schedule a fleet top-up",detail:"Use bulk fleet plan to create staged sessions and reduce congestion.",cta:"Bulk plan",onClick:()=>Fe(!0)}),e.jsx(b,{title:"Resolve pending approvals",detail:`There are ${T.filter(f=>f.status==="Pending").length} approval request(s) pending.`,cta:"Open approvals",onClick:()=>ie("approvals")}),e.jsx(b,{title:"Create a VIP exception",detail:"For recurring executive DC fast charging, request an approved VIP exception with audit trail.",cta:"Request",onClick:()=>ne(!0)})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: you can extend this with tariff calendars, dynamic pricing, and station reliability predictions."})]})})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"Corporate EV Charging Scheduling v2. Core: pre-book sessions, book on behalf, enforce purpose and tags. Premium: bulk fleet booking, VIP exceptions with approvals, and smart peak time insights."})})]})}),e.jsx(FB,{open:je,title:Y?`${Y.ref}  ${Y.connector}`:"Session",subtitle:Y?`${Re(Y.vehicleId)}  ${fi(Y.scheduledAt)}  ${((u=j[Y.siteId])==null?void 0:u.name)||Y.siteId}`:"",onClose:()=>Ue(!1),footer:Y?e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"In production, this links to station reservation and session telemetry."}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ss,{variant:"outline",onClick:()=>{U(f=>f.map(B=>B.id===Y.id?{...B,status:"Cancelled"}:B)),r({title:"Cancelled",message:"Session cancelled.",kind:"warn"}),Ue(!1)},disabled:Y.status==="Cancelled"||Y.status==="Completed",children:[e.jsx(Ye,{className:"h-4 w-4"})," Cancel"]}),e.jsxs(ss,{variant:"primary",onClick:()=>{var y;const f=Date.now(),B=Math.min(Y.expectedKWh,Math.max(1,Math.round(Y.expectedKWh*.92))),p=j[Y.siteId],E=((y=p==null?void 0:p.connectors.find(re=>re.connector===Y.connector))==null?void 0:y.priceUGXPerKWh)||900,se=Math.round(B*E);U(re=>re.map(ve=>ve.id===Y.id?{...ve,status:"Completed",proofs:[{id:Br("AT"),name:"Charge receipt.pdf",note:"Receipt",addedAt:f,addedBy:"System"},...ve.proofs],result:{kWhDelivered:B,costUGX:se,endedAt:f}}:ve)),r({title:"Completed",message:"Session marked completed.",kind:"success"})},disabled:Y.status!=="Confirmed",title:Y.status!=="Confirmed"?"Only confirmed sessions can complete":"",children:[e.jsx(tt,{className:"h-4 w-4"})," Complete"]})]})]}):null,children:Y?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ut,{label:Y.status,tone:Eb(Y.status)}),e.jsx(ut,{label:Y.connector,tone:Y.connector.includes("DC")?"info":"neutral"}),(C=g[Y.vehicleId])!=null&&C.vip?e.jsx(ut,{label:"VIP",tone:"info"}):null]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:Re(Y.vehicleId)}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Owner: ",ze(Y.vehicleId)]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Booked by ",Y.bookedBy,"  Created ",Cb(Y.createdAt)]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Scheduled"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:fi(Y.scheduledAt)}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Budget"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:Hh(Y.maxBudgetUGX)})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Site"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:((Q=j[Y.siteId])==null?void 0:Q.name)||Y.siteId}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:((O=j[Y.siteId])==null?void 0:O.address)||""})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Plan"}),e.jsxs("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:[Y.expectedKWh," kWh  ",Y.durationMins," min"]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Cost center ",Y.costCenter,"  Project ",Y.projectTag]})]})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Tags"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:Y.tags.length?Y.tags.map((f,B)=>e.jsx(ut,{label:f,tone:"neutral"},`${Y.id}-t-${B}`)):e.jsx(ut,{label:"None",tone:"neutral"})}),e.jsxs("div",{className:"mt-3 text-xs text-slate-600",children:["Purpose: ",Y.purpose==="Other"?Y.purposeOther||"Other":Y.purpose]})]}),Y.policyNotes.length?e.jsxs("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:[e.jsx("div",{className:"font-semibold",children:"Policy notes"}),e.jsx("ul",{className:"mt-2 space-y-1",children:Y.policyNotes.map((f,B)=>e.jsxs("li",{children:[" ",f]},`${Y.id}-pn-${B}`))})]}):null,Y.result?e.jsxs("div",{className:"mt-3 rounded-2xl bg-emerald-50 p-3 text-xs text-emerald-900 ring-1 ring-emerald-200",children:["Completed: ",Y.result.kWhDelivered," kWh  Cost ",Hh(Y.result.costUGX),"  Ended ",fi(Y.result.endedAt)]}):null]}),e.jsx(fl,{title:"Proofs",subtitle:"Receipts and meter logs",right:e.jsx(ut,{label:`${Y.proofs.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[Y.proofs.map(f=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:f.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[fi(f.addedAt),"  ",f.addedBy]}),f.note?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Note: ",f.note]}):null]}),e.jsx(ss,{variant:"outline",className:"px-3 py-2 text-xs",onClick:async()=>{try{await navigator.clipboard.writeText(f.name),r({title:"Copied",message:"Proof name copied.",kind:"success"})}catch{r({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},children:e.jsx(ls,{className:"h-4 w-4"})})]})},f.id)),Y.proofs.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No proofs yet."})]})})]}):null}),e.jsx(Ab,{open:Ie,title:"New charging session",subtitle:"Book on behalf. Purpose tags and policy enforcement are required.",onClose:()=>ce(!1),actions:[{label:"Create",onClick:oe}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(ss,{variant:"outline",onClick:()=>ce(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ss,{variant:"outline",onClick:()=>pe(f=>f>0?f-1:f),disabled:me===0,children:"Back"}),me<2?e.jsxs(ss,{variant:"primary",onClick:()=>pe(f=>f+1),children:["Next",e.jsx(et,{className:"h-4 w-4"})]}):e.jsxs(ss,{variant:"primary",onClick:oe,children:[e.jsx(ct,{className:"h-4 w-4"})," Create"]})]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:[0,1,2].map(f=>e.jsx("button",{type:"button",className:ya("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",me===f?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:me===f?{background:vx.green}:void 0,onClick:()=>pe(f),children:f===0?"Vehicle":f===1?"Session":"Policy check"},f))}),me===0?e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(pr,{label:"Vehicle",value:de.vehicleId,onChange:f=>{const B=g[f];ye(p=>({...p,vehicleId:f,costCenter:(B==null?void 0:B.costCenter)||p.costCenter,prioritySlot:!!(B!=null&&B.vip)}))},options:x.map(f=>({value:f.id,label:`${f.label} (${f.ownerType})${f.vip?"  VIP":""}`}))}),e.jsx(Gr,{label:"Booked by",value:de.bookedBy,onChange:f=>ye(B=>({...B,bookedBy:f})),placeholder:"Charging Coordinator"}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 md:col-span-2",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Vehicle context"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"VIP, battery size, and default cost center."})]}),e.jsx(UF,{className:"h-5 w-5 text-slate-400"})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[(ee=g[de.vehicleId])!=null&&ee.vip?e.jsx(ut,{label:"VIP",tone:"info"}):e.jsx(ut,{label:"Standard",tone:"neutral"}),e.jsx(ut,{label:`${((F=g[de.vehicleId])==null?void 0:F.batteryKWh)||0} kWh`,tone:"neutral"}),e.jsx(ut,{label:((D=g[de.vehicleId])==null?void 0:D.costCenter)||"-",tone:"neutral"}),e.jsx(ut,{label:((m=g[de.vehicleId])==null?void 0:m.ownerType)||"-",tone:"neutral"})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Owner: ",((A=g[de.vehicleId])==null?void 0:A.ownerName)||"-"]})]})]}):null,me===1?e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Gr,{label:"Scheduled time",type:"datetime-local",value:de.scheduledAt,onChange:f=>ye(B=>({...B,scheduledAt:f})),hint:"Local time"}),e.jsx(qr,{label:"Duration",value:de.durationMins,onChange:f=>ye(B=>({...B,durationMins:vd(f,10,360)})),hint:"Minutes"}),e.jsx(pr,{label:"Site",value:de.siteId,onChange:f=>ye(B=>({...B,siteId:f})),options:c.map(f=>({value:f.id,label:`${f.name} (${f.status})`}))}),e.jsx(pr,{label:"Connector",value:de.connector,onChange:f=>ye(B=>({...B,connector:f})),options:a.map(f=>({value:f,label:f}))}),e.jsx(qr,{label:"Expected energy",value:de.expectedKWh,onChange:f=>ye(B=>({...B,expectedKWh:Math.max(1,f)})),hint:"kWh"}),e.jsx(qr,{label:"Max budget",value:de.maxBudgetUGX,onChange:f=>ye(B=>({...B,maxBudgetUGX:Math.max(0,f)})),hint:"UGX"}),e.jsx(pr,{label:"Purpose",value:de.purpose,onChange:f=>ye(B=>({...B,purpose:f})),options:s.map(f=>({value:f,label:f}))}),e.jsx(Gr,{label:"Tags",value:de.tags,onChange:f=>ye(B=>({...B,tags:f})),placeholder:"Comma separated",hint:"Example: Fleet,Airport"}),e.jsx(Gr,{label:"Cost center",value:de.costCenter,onChange:f=>ye(B=>({...B,costCenter:f})),placeholder:"OPS-001"}),e.jsx(Gr,{label:"Project tag",value:de.projectTag,onChange:f=>ye(B=>({...B,projectTag:f})),placeholder:"Charging program"}),e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 md:col-span-2",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Priority slot"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Premium: request priority reservation, approval-gated."})]}),e.jsx("button",{type:"button",className:ya("relative h-7 w-12 rounded-full border transition",de.prioritySlot?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>ye(f=>({...f,prioritySlot:!f.prioritySlot})),"aria-label":"Toggle priority",children:e.jsx("span",{className:ya("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",de.prioritySlot?"left-[22px]":"left-1")})})]})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(SC,{label:"If purpose is Other",value:de.purposeOther,onChange:f=>ye(B=>({...B,purposeOther:f})),placeholder:"Explain the purpose",rows:3,disabled:de.purpose!=="Other",hint:de.purpose!=="Other"?"Disabled":"Required when Other"})})]}):null,me===2?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Policy check"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"This preview shows why approval may be required."})]}),_e.needsApproval?e.jsx(ut,{label:"Approval required",tone:"warn"}):e.jsx(ut,{label:"No approval",tone:"good"})]}),_e.requiredErrors.length?e.jsxs("div",{className:"mt-3 rounded-2xl bg-rose-50 p-3 text-xs text-rose-800 ring-1 ring-rose-200",children:[e.jsx("div",{className:"font-semibold",children:"Missing"}),e.jsx("ul",{className:"mt-2 space-y-1",children:_e.requiredErrors.map((f,B)=>e.jsxs("li",{children:[" ",f]},`err-${B}`))})]}):null,e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Scheduled"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:fi(_e.whenTs)}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["After-hours: ",_e.after?"Yes":"No"]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Tariff"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:_e.peak?"Peak":"Off-peak"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:_e.suggestion})]})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Flags"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[_e.flags.length?_e.flags.map((f,B)=>e.jsx(ut,{label:f,tone:f.endsWith("required")?"bad":f==="Peak tariff"?"warn":"neutral"},`flag-${B}`)):e.jsx(ut,{label:"None",tone:"neutral"}),_e.hasActiveVipException?e.jsx(ut,{label:"VIP exception active",tone:"info"}):null]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"If approval is required, the session is created in Pending approval and routed to Manager then Finance, and optionally CFO for VIP, DC fast, or priority."})]})}):null]})}),e.jsx(Ab,{open:Qe,title:"Bulk fleet charging plan",subtitle:"Premium: schedule many vehicles with staggered slots.",onClose:()=>Fe(!1),actions:[{label:"Create",onClick:De}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(ss,{variant:"outline",onClick:()=>Fe(!1),children:"Cancel"}),e.jsxs(ss,{variant:"primary",onClick:De,children:[e.jsx(ct,{className:"h-4 w-4"})," Create"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Gr,{label:"Plan name",value:ke.name,onChange:f=>fe(B=>({...B,name:f}))}),e.jsx(pr,{label:"Site",value:ke.siteId,onChange:f=>fe(B=>({...B,siteId:f})),options:c.map(f=>({value:f.id,label:f.name}))}),e.jsx(Gr,{label:"Start time",type:"datetime-local",value:ke.startAt,onChange:f=>fe(B=>({...B,startAt:f}))}),e.jsx(qr,{label:"Interval",value:ke.intervalMins,onChange:f=>fe(B=>({...B,intervalMins:vd(f,5,120)})),hint:"Minutes"}),e.jsx(qr,{label:"Duration",value:ke.durationMins,onChange:f=>fe(B=>({...B,durationMins:vd(f,10,360)})),hint:"Minutes"}),e.jsx(pr,{label:"Connector",value:ke.connector,onChange:f=>fe(B=>({...B,connector:f})),options:a.map(f=>({value:f,label:f}))}),e.jsx(qr,{label:"Expected kWh",value:ke.expectedKWh,onChange:f=>fe(B=>({...B,expectedKWh:Math.max(1,f)})),hint:"kWh"}),e.jsx(qr,{label:"Max budget",value:ke.maxBudgetUGX,onChange:f=>fe(B=>({...B,maxBudgetUGX:Math.max(0,f)})),hint:"UGX"}),e.jsx(Gr,{label:"Tags",value:ke.tags,onChange:f=>fe(B=>({...B,tags:f})),hint:"Comma separated"}),e.jsx(Gr,{label:"Cost center",value:ke.costCenter,onChange:f=>fe(B=>({...B,costCenter:f}))}),e.jsx(Gr,{label:"Project tag",value:ke.projectTag,onChange:f=>fe(B=>({...B,projectTag:f}))}),e.jsxs("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Vehicles"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Select vehicles to schedule in sequence."})]}),e.jsx(ut,{label:`${ke.vehicleIds.length} selected`,tone:ke.vehicleIds.length?"info":"neutral"})]}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2 sm:grid-cols-2",children:x.map(f=>{const B=ke.vehicleIds.includes(f.id);return e.jsxs("button",{type:"button",className:ya("rounded-2xl border px-3 py-3 text-left",B?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),onClick:()=>fe(p=>({...p,vehicleIds:B?p.vehicleIds.filter(E=>E!==f.id):[...p.vehicleIds,f.id]})),children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:f.label}),f.vip?e.jsx(ut,{label:"VIP",tone:"info"}):null]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[f.ownerName,"  ",f.costCenter]})]},f.id)})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Bulk plan creates sessions and creates one fleet-plan approval if any session violates policy."})]})]})}),e.jsx(Ab,{open:Ve,title:"Request VIP charging exception",subtitle:"Premium: allow DC fast, priority slots, or after-hours through approvals.",onClose:()=>ne(!1),actions:[{label:"Submit",onClick:ue}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(ss,{variant:"outline",onClick:()=>ne(!1),children:"Cancel"}),e.jsxs(ss,{variant:"primary",onClick:ue,children:[e.jsx(yt,{className:"h-4 w-4"})," Submit"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(pr,{label:"Vehicle",value:Te.vehicleId,onChange:f=>Ee(B=>({...B,vehicleId:f})),options:x.map(f=>({value:f.id,label:`${f.label}${f.vip?"  VIP":""}`}))}),e.jsx(pr,{label:"Exception type",value:Te.exceptionType,onChange:f=>Ee(B=>({...B,exceptionType:f})),options:[{value:"DC fast",label:"DC fast"},{value:"Priority slot",label:"Priority slot"},{value:"After-hours",label:"After-hours"}]}),e.jsx(qr,{label:"Valid days",value:Te.validDays,onChange:f=>Ee(B=>({...B,validDays:vd(f,1,365)})),hint:"1 to 365"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(SC,{label:"Reason",value:Te.reason,onChange:f=>Ee(B=>({...B,reason:f})),placeholder:"Explain the business justification",rows:4})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Best practice: CFO is added automatically for DC or priority exceptions."})]})})]});function b({title:f,detail:B,cta:p,onClick:E}){return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:f}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:B})]}),e.jsxs(ss,{variant:"outline",className:"px-3 py-2 text-xs",onClick:E,children:[e.jsx(et,{className:"h-4 w-4"})," ",p]})]})})}}const Cf={dashboard:TU,notifications_activity:FU,command_center:WU,org_setup:tV,modules_enablement:iV,users:xV,groups:vV,roles_permissions:SV,policies:TV,approval_workflows:_V,approvals_inbox:WV,budgets:t_,wallet_billing:n_,billing_setup:u_,invoices:g_,collections:k_,reconciliation:T_,vendors:F_,rfq:q_,fulfillment:K_,travel:tB,reporting:rB,esg:mB,integrations:vB,security:wB,support_tools:EB,settings_hub:IB,ev_charging:VB};({...Cf});const Li={green:"#03CD8C",orange:"#F77F00"};function Hs(...t){return t.filter(Boolean).join(" ")}function _B(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function BB(t){const[s,a]=d.useState(()=>typeof window>"u"?!1:window.matchMedia(t).matches);return d.useEffect(()=>{var r;if(typeof window>"u")return;const l=window.matchMedia(t),n=()=>a(l.matches);return n(),(r=l.addEventListener)==null||r.call(l,"change",n),()=>{var i;return(i=l.removeEventListener)==null?void 0:i.call(l,"change",n)}},[t]),s}function ql({label:t,tone:s}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Hs("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Ci({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:Li.green}:t==="accent"?{background:Li.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Hs(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function GB({channel:t}){const a={Email:{bg:"bg-slate-50",fg:"text-slate-700",icon:e.jsx(Xs,{className:"h-3.5 w-3.5"})},WhatsApp:{bg:"bg-emerald-50",fg:"text-emerald-700",icon:e.jsx(f0,{className:"h-3.5 w-3.5"})},WeChat:{bg:"bg-green-50",fg:"text-green-700",icon:e.jsx(f0,{className:"h-3.5 w-3.5"})},SMS:{bg:"bg-blue-50",fg:"text-blue-700",icon:e.jsx(f0,{className:"h-3.5 w-3.5"})}}[t];return e.jsxs("span",{className:Hs("inline-flex items-center gap-1.5 rounded-full px-2 py-1 text-xs font-semibold",a.bg,a.fg),children:[a.icon,t]})}function Kh({open:t,onClose:s,anchorRef:a,children:l,width:n=360}){var c;d.useEffect(()=>{const x=j=>{j.key==="Escape"&&s()};return t&&window.addEventListener("keydown",x),()=>window.removeEventListener("keydown",x)},[t,s]);const r=(c=a.current)==null?void 0:c.getBoundingClientRect(),i=r?Math.max(16,window.innerWidth-r.right):16,o=r?r.bottom+10:54;return e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40",onClick:s,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}),e.jsx(We.div,{initial:{opacity:0,y:8,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:8,scale:.98},transition:{duration:.16},className:"fixed z-50 overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-[0_24px_70px_rgba(2,8,23,0.18)]",style:{width:n,right:i,top:o},role:"menu",children:l})]}):null})}function MC({nav:t,active:s,onSelect:a,collapsed:l,theme:n,onToggleTheme:r}){const i=n==="dark"?"bg-slate-900":"bg-slate-50",o=n==="dark"?"border-slate-800":"border-slate-200",c=n==="dark"?"text-white":"text-slate-900",x=n==="dark"?"text-slate-400":"text-slate-500";return e.jsxs("div",{className:Hs("flex h-full flex-col",l?"px-1":"px-2",i),children:[e.jsxs("div",{className:Hs("flex items-center gap-2 border-b py-3",o,l?"justify-center px-1":"px-2"),children:[e.jsx("div",{className:"grid h-8 w-8 shrink-0 place-items-center rounded-xl text-white",style:{background:Li.green},children:e.jsx(ht,{className:"h-4 w-4"})}),!l&&e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:Hs("truncate text-xs font-bold",c),children:"CorporatePay"}),e.jsx("div",{className:Hs("truncate text-[10px]",x),children:"Console"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto py-2",children:e.jsx("div",{className:"space-y-0.5",children:t.map(j=>e.jsx(qB,{item:j,active:s,onSelect:a,collapsed:l,theme:n},j.id))})}),e.jsxs("div",{className:Hs("border-t py-2",o),children:[e.jsxs("button",{onClick:r,className:Hs("flex w-full items-center gap-2 rounded-xl px-2 py-1.5 text-left transition-colors",n==="dark"?"text-slate-300 hover:bg-slate-800":"text-slate-700 hover:bg-slate-100",l&&"justify-center"),title:n==="light"?"Switch to dark mode":"Switch to light mode",children:[n==="light"?e.jsx(YF,{className:"h-4 w-4"}):e.jsx(tU,{className:"h-4 w-4"}),!l&&e.jsx("span",{className:"text-xs font-medium",children:n==="light"?"Dark mode":"Light mode"})]}),e.jsxs("button",{onClick:()=>a("support_tools"),className:Hs("flex w-full items-center gap-2 rounded-xl px-2 py-1.5 text-left transition-colors",n==="dark"?"text-slate-300 hover:bg-slate-800":"text-slate-700 hover:bg-slate-100",l&&"justify-center"),children:[e.jsx(Fu,{className:"h-4 w-4"}),!l&&e.jsx("span",{className:"text-xs font-medium",children:"Help & Support"})]})]})]})}function qB({item:t,active:s,onSelect:a,collapsed:l,theme:n}){var N,$;const r=s===t.id||((N=t.children)==null?void 0:N.some(T=>T.id===s)),i=s===t.id,o=!!(($=t.children)!=null&&$.length),[c,x]=d.useState(r),j=i?"text-white":n==="dark"?"text-slate-300 hover:bg-slate-800":"text-slate-700 hover:bg-slate-100",g=i?"text-white":n==="dark"?"text-slate-400":"text-slate-500";return e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>{o?x(T=>!T):a(t.id)},className:Hs("flex w-full items-center gap-2 rounded-xl px-2 py-1.5 text-left text-xs font-medium transition-all hover-lift",j,l&&"justify-center px-1"),style:i?{background:Li.green}:void 0,children:[e.jsx("div",{className:Hs("shrink-0",g),children:t.icon}),!l&&e.jsx("div",{className:"min-w-0 flex-1 truncate",children:t.label}),!l&&t.badge&&e.jsx("span",{className:Hs("rounded-full px-1.5 py-0.5 text-[10px] font-semibold",i?"bg-white/20 text-white":n==="dark"?"bg-slate-700 text-slate-300":"bg-slate-200 text-slate-600"),children:t.badge}),!l&&o&&e.jsx(li,{className:Hs("h-3 w-3 transition-transform",c?"rotate-0":"-rotate-90")})]}),!l&&o&&e.jsx(lt,{initial:!1,children:c&&e.jsx(We.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.12},className:"ml-4 mt-0.5 space-y-0.5 border-l border-slate-200 pl-2 dark:border-slate-700",children:t.children.map(T=>e.jsxs("button",{onClick:()=>a(T.id),className:Hs("flex w-full items-center justify-between rounded-lg px-2 py-1 text-left text-xs transition-colors hover-lift",s===T.id?"bg-emerald-50 font-semibold text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400":n==="dark"?"text-slate-400 hover:bg-slate-800":"text-slate-600 hover:bg-slate-100"),children:[e.jsx("span",{className:"truncate",children:T.label}),T.badge&&e.jsx("span",{className:Hs("ml-1 rounded-full px-1.5 py-0.5 text-[10px] font-semibold",n==="dark"?"bg-slate-700 text-slate-300":"bg-slate-200 text-slate-600"),children:T.badge})]},T.id))})})]})}function zB({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:Hs("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function WB({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="920px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(We.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[8vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(zB,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function HB({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(We.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Hs("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Mt,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Ye,{className:"h-4 w-4"})})]})},a.id))})})}function PC({title:t,subtitle:s,tier:a,bullets:l,onPrimary:n,primaryLabel:r}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Page"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:t}),e.jsx("div",{className:"mt-2 max-w-2xl text-sm text-slate-600",children:s}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsx(ql,{label:a,tone:a==="Premium"?"info":"neutral"}),e.jsx(ql,{label:"Shell ready",tone:"good"})]})]}),n?e.jsxs(Ci,{variant:"primary",onClick:n,children:[e.jsx(et,{className:"h-4 w-4"})," ",r||"Open"]}):null]}),l!=null&&l.length?e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Included features"}),e.jsx("ul",{className:"mt-3 space-y-2 text-sm text-slate-700",children:l.map(i=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:Li.green}}),e.jsx("span",{children:i})]},i))})]}):null,e.jsx("div",{className:"mt-4 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"This AppShell is designed so each route can be replaced with the full page component when you integrate files into your codebase."})]})}function XB({pageTitle:t,role:s,onRequest:a}){return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl bg-rose-50 text-rose-700",children:e.jsx(ra,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"Access denied"}),e.jsxs("div",{className:"mt-1 text-sm text-slate-600",children:["Your role ",e.jsx("span",{className:"font-semibold",children:s})," cannot access ",e.jsx("span",{className:"font-semibold",children:t}),"."]}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:[e.jsxs(Ci,{variant:"primary",onClick:a,children:[e.jsx(ni,{className:"h-4 w-4"})," Request access"]}),e.jsx("div",{className:"text-xs text-slate-500",children:"Requests should be auditable and time-bounded in production."})]})]})]})})}function KB({onLogin:t,orgs:s,roles:a}){const[l,n]=d.useState(s[0]||"Organization"),[r,i]=d.useState(a[0]||"Org Admin"),[o,c]=d.useState("admin@company.com"),[x,j]=d.useState("demo"),[g,N]=d.useState(!0);return e.jsx("div",{className:"min-h-screen bg-[radial-gradient(90%_60%_at_50%_0%,rgba(3,205,140,0.18),rgba(255,255,255,0))]",children:e.jsx("div",{className:"mx-auto max-w-[980px] px-4 py-10 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsx("div",{className:"border-b border-slate-200 bg-white px-6 py-5",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:Li.green},children:e.jsx(ht,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"CorporatePay"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Login and org selector"})]})]}),e.jsx(ql,{label:"SSO-ready",tone:"info"})]})}),e.jsxs("div",{className:"bg-slate-50 px-6 py-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Sign in"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Email and password. SSO buttons can be added in phase 2."}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("label",{className:"block",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Email"}),e.jsx("input",{value:o,onChange:$=>c($.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"})]}),e.jsxs("label",{className:"block",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Password"}),e.jsx("input",{type:"password",value:x,onChange:$=>j($.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"})]}),e.jsxs("label",{className:"flex items-start gap-3 rounded-3xl border border-slate-200 bg-slate-50 p-3",children:[e.jsx("input",{type:"checkbox",checked:g,onChange:$=>N($.target.checked),className:"mt-1 h-4 w-4 rounded border-slate-300"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Device trust notice"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Unusual logins may require step-up prompts (MFA)."})]})]}),e.jsxs(Ci,{variant:"primary",className:"w-full",onClick:()=>{!o.trim()||!x.trim()||g&&t(l,r)},disabled:!o.trim()||!x.trim()||!g,children:[e.jsx(ct,{className:"h-4 w-4"})," Sign in"]})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Select organization"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Shown when your user belongs to multiple orgs."}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("label",{className:"block",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Organization"}),e.jsx("select",{value:l,onChange:$=>n($.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",children:s.map($=>e.jsx("option",{value:$,children:$},$))})]}),e.jsxs("label",{className:"block",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Role (demo)"}),e.jsx("select",{value:r,onChange:$=>i($.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",children:a.map($=>e.jsx("option",{value:$,children:$},$))})]}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"In production, role and org membership is resolved from access policy and invites."}),e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs(Ci,{variant:"outline",onClick:()=>alert("Request access: creates ticket for org admin (demo)."),children:[" ",e.jsx(ni,{className:"h-4 w-4"})," Request access"]}),e.jsxs(Ci,{variant:"outline",onClick:()=>alert("MFA setup happens after login in X2 (demo)."),children:[" ",e.jsx(ra,{className:"h-4 w-4"})," MFA and device trust"]})]})]})]})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"EVzone Support sign-in entry"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Support role is embedded. Support sessions are always audited, visible, and watermarked."})]})]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 px-6 py-5 text-xs text-slate-500",children:"Access and onboarding screens are part of the complete system. This login page is a premium shell starter."})]})})})}function Mb(){const t=BB("(min-width: 1024px)"),{pageId:s}=XS(),a=Xd(),[l,n]=d.useState(!0),[r,i]=d.useState(!1),[o,c]=d.useState(!1),x=s||"dashboard",[j,g]=d.useState("Active"),[N,$]=d.useState("Org Admin"),[T,k]=d.useState("Acme Group Ltd"),[q,L]=d.useState([]),R=z=>{const Pe=_B("toast");L(Be=>[{id:Pe,...z},...Be].slice(0,4)),window.setTimeout(()=>L(Be=>Be.filter(xe=>xe.id!==Pe)),3200)},[U,ae]=d.useState(()=>typeof window<"u"&&localStorage.getItem("theme")||"light");d.useEffect(()=>{const z=window.document.documentElement;U==="dark"?z.classList.add("dark"):z.classList.remove("dark"),localStorage.setItem("theme",U)},[U]);const[ie,_]=d.useState(""),[W,J]=d.useState(!1),[we,G]=d.useState(!1),[be,Ge]=d.useState(!1),[Me,je]=d.useState(!1),[Ue,Oe]=d.useState(!1),[he,Y]=d.useState(!1),Ie=d.useRef(null),ce=d.useRef(null),me=d.useRef(null),pe=d.useRef(null),[de,ye]=d.useState(!1),[Qe,Fe]=d.useState(""),ke=d.useMemo(()=>({dashboard:{id:"dashboard",title:"Corporate Dashboard",subtitle:"KPIs, account health, issues, and next best admin actions.",tier:"Core",roles:["Org Owner","Org Admin","Manager","Accountant","Approver","Travel Coordinator","Employee","EVzone Support"],keywords:["kpi","spend","approvals","budget","health"],status:"Ready",bullets:["Spend today/week/month, approvals pending, budget remaining","Account health: wallet balance, credit usage, prepaid runway","Top issues: failed payments, breaches, overdue invoices","Quick actions: add funds, approve queue, create RFQ"]},notifications_activity:{id:"notifications_activity",title:"Notifications and Activity Center",subtitle:"Unified feed for approvals, reminders, alerts, and vendor updates with channel delivery logs.",tier:"Core",roles:["Org Owner","Org Admin","Manager","Accountant","Approver","Travel Coordinator","Employee","EVzone Support"],keywords:["alerts","reminders","activity","logs","whatsapp","wechat","sms"],status:"Ready"},command_center:{id:"command_center",title:"Global Search and Command Center",subtitle:"Search users, invoices, approvals, vendors and run quick admin actions.",tier:"Core",roles:["Org Owner","Org Admin","Manager","Accountant","Approver","Travel Coordinator","Employee","EVzone Support"],keywords:["search","command","operator","shortcuts"],status:"Ready"},org_setup:{id:"org_setup",title:"Organization Profile and Program Setup",subtitle:"Company profile, entities, branding, billing contacts, invoice groups, support toggle and go-live readiness.",tier:"Core",roles:["Org Owner","Org Admin"],keywords:["profile","entities","billing","branding","go-live"],status:"Ready"},modules_enablement:{id:"modules_enablement",title:"Modules and Marketplaces Enablement",subtitle:"Enable service modules and marketplaces including MyLiveDealz. Includes Other slots.",tier:"Core",roles:["Org Owner","Org Admin"],keywords:["modules","marketplaces","mylivedealz","enable"],status:"Planned",bullets:["Enable/disable service modules","Enable/disable marketplaces under E-Commerce","Controlled rollout: pilot group then expand","Change impact preview"]},users:{id:"users",title:"Users and Invitations",subtitle:"Invite users, assign roles, groups and spend limits. Bulk import and offboarding.",tier:"Core",roles:["Org Owner","Org Admin","Manager","Accountant"],keywords:["users","invites","csv","hris"],status:"Planned",bullets:["Users list: Invited/Active/Suspended/Offboarded","Bulk import CSV, HRIS import in phase 2","Offboarding: revoke CorporatePay immediately, keep audit"]},groups:{id:"groups",title:"Groups and Cost Centers",subtitle:"Departments (groups), cost centers, project tags and chargeback rules.",tier:"Core",roles:["Org Owner","Org Admin","Accountant"],keywords:["groups","cost center","tags"],status:"Planned"},roles_permissions:{id:"roles_permissions",title:"Roles, Permissions and Governance",subtitle:"RBAC, custom roles, approval delegation and two-admin model controls.",tier:"Core",roles:["Org Owner","Org Admin"],keywords:["rbac","permissions","governance"],status:"Planned"},policies:{id:"policies",title:"Policies",subtitle:"Ride, services and purchases policies with inheritance and simulator.",tier:"Core",roles:["Org Owner","Org Admin","Manager","Approver"],keywords:["policy","rides","purchases","services"],status:"Planned"},approval_workflows:{id:"approval_workflows",title:"Approval Workflow Builder",subtitle:"Rule engine and multi-level approvals per module and marketplace including RFQs.",tier:"Core",roles:["Org Owner","Org Admin","Approver"],keywords:["workflow","approvals","sla"],status:"Planned"},approvals_inbox:{id:"approvals_inbox",title:"Approvals Inbox",subtitle:"Unified queue for rides, purchases, services, RFQs and exceptions.",tier:"Core",roles:["Org Owner","Org Admin","Approver","Accountant","Manager"],keywords:["approve","queue","sla"],status:"Planned"},budgets:{id:"budgets",title:"Budgets, Spend Limits and Controls",subtitle:"Org, group, module and marketplace budgets with forecasting and emergency exceptions.",tier:"Core",roles:["Org Owner","Org Admin","Accountant"],keywords:["budget","cap","limits","exceptions"],status:"Ready"},wallet_billing:{id:"wallet_billing",title:"Corporate Wallet, Credit Line and Prepaid Funding",subtitle:"Pay-as-you-go wallet, credit with limit, and prepaid deposit with hard stop.",tier:"Core",roles:["Org Owner","Org Admin","Accountant"],keywords:["wallet","credit","prepaid"],status:"Planned"},billing_setup:{id:"billing_setup",title:"Billing Setup and Invoice Groups",subtitle:"Invoice frequency, invoice groups, tax settings, and billing simulations.",tier:"Core",roles:["Org Owner","Org Admin","Accountant"],keywords:["invoice groups","billing","tax"],status:"Planned"},invoices:{id:"invoices",title:"Invoices and Statements",subtitle:"Invoice list, line item explorer, disputes, exports.",tier:"Core",roles:["Org Owner","Org Admin","Accountant"],keywords:["invoice","statement","dispute"],status:"Planned"},collections:{id:"collections",title:"Collections, Reminders and Enforcement",subtitle:"Automated reminders and service suspension rules.",tier:"Core",roles:["Org Owner","Org Admin","Accountant"],keywords:["reminders","dunning","enforcement"],status:"Planned"},reconciliation:{id:"reconciliation",title:"Transactions and Reconciliation",subtitle:"Ledger, matching tools, exceptions queue, ERP mappings.",tier:"Core",roles:["Org Owner","Org Admin","Accountant"],keywords:["ledger","reconcile","erp"],status:"Planned"},vendors:{id:"vendors",title:"Vendor and Catalog Management",subtitle:"Allowlist/denylist vendors, risk scoring, rate cards and compliance docs.",tier:"Core",roles:["Org Owner","Org Admin","Manager","Accountant"],keywords:["vendors","catalog","allowlist"],status:"Planned"},rfq:{id:"rfq",title:"RFQ and Quote Requests",subtitle:"High value assets: request quote, compare quotes, convert to purchase order.",tier:"Core",roles:["Org Owner","Org Admin","Manager","Accountant","Approver"],keywords:["rfq","quote","assets"],status:"Planned"},fulfillment:{id:"fulfillment",title:"Orders, Service Requests and Fulfillment",subtitle:"Track purchase orders, service bookings, deliveries and schedules.",tier:"Core",roles:["Org Owner","Org Admin","Manager","Accountant"],keywords:["orders","fulfillment","sla"],status:"Planned"},travel:{id:"travel",title:"Corporate Travel and Scheduling",subtitle:"Pre-book rides, visitors, events, and recurring commutes.",tier:"Core",roles:["Org Owner","Org Admin","Manager","Travel Coordinator"],keywords:["travel","schedule","events"],status:"Planned"},reporting:{id:"reporting",title:"Reporting and Analytics",subtitle:"Spend reports, approvals performance, exports and scheduled reports.",tier:"Core",roles:["Org Owner","Org Admin","Manager","Accountant","Approver"],keywords:["reports","analytics","exports"],status:"Ready"},esg:{id:"esg",title:"Sustainability and ESG Reporting",subtitle:"EV usage, charging utilization, emissions estimates, and ESG template exports.",tier:"Premium",roles:["Org Owner","Org Admin","Accountant"],keywords:["esg","emissions","charging"],status:"Ready"},integrations:{id:"integrations",title:"Integrations and Developer Center",subtitle:"API keys, scopes, webhooks, ERP exports, sandbox and inspector.",tier:"Core",roles:["Org Owner","Org Admin","Accountant","EVzone Support"],keywords:["api","webhooks","sandbox","erp"],status:"Ready"},security:{id:"security",title:"Security, Audit and Compliance",subtitle:"Audit logs, MFA policy, retention, support mode gating, forensic exports, compliance center.",tier:"Core",roles:["Org Owner","Org Admin","Accountant","EVzone Support"],keywords:["audit","mfa","retention","dual control"],status:"Ready"},support_tools:{id:"support_tools",title:"Support and EVzone Admin Tools",subtitle:"Embedded EVzone support role with auditable sessions, scoped tools and incidents.",tier:"Premium",roles:["Org Owner","Org Admin","Accountant","EVzone Support"],keywords:["support","cases","sessions","incidents"],status:"Ready"},ev_charging:{id:"ev_charging",title:"EV Charging",subtitle:"Charging schedules, sites, credits, and utilization controls.",tier:"Core",roles:["Org Owner","Org Admin","Manager","Accountant","Approver","Travel Coordinator","Employee","EVzone Support"],keywords:["ev","charging","station","credits","utilization"],status:"Ready"},settings_hub:{id:"settings_hub",title:"Admin Settings Hub",subtitle:"Single settings umbrella linking to all configuration pages.",tier:"Core",roles:["Org Owner","Org Admin","Accountant","Manager","Approver","EVzone Support"],keywords:["settings","hub","config"],status:"Ready"}}),[]),fe=d.useMemo(()=>[{id:"n1",title:"Invoice due tomorrow",message:"INV-2026-0117 is due. Auto-reminders are enabled.",when:"2h ago",tone:"warning",channel:"Email"},{id:"n2",title:"7 approvals pending",message:"Purchases and RFQs waiting. SLA target: 8 hours.",when:"Now",tone:"info",channel:"WhatsApp"},{id:"n3",title:"Prepaid balance low",message:"Deposit runway estimated: 3 days. Top up to avoid service stop.",when:"30m ago",tone:"danger",channel:"SMS"},{id:"n4",title:"ERP sync healthy",message:"Last export delivered successfully. Webhook success: 99.2%.",when:"Today",tone:"success",channel:"WeChat"}],[]),Ve=d.useMemo(()=>({approvals:7,rfqs:3,users:128,alerts:fe.length,cases:2}),[fe.length]),ne=d.useMemo(()=>[{id:"dashboard",label:"Dashboard",icon:e.jsx(ox,{className:"h-4 w-4"})},{id:"notifications_activity",label:"Activity",icon:e.jsx($o,{className:"h-4 w-4"}),badge:`${Ve.alerts}`},{id:"command_center",label:"Command center",icon:e.jsx(ka,{className:"h-4 w-4"})},{id:"org",label:"Organization",icon:e.jsx(Xl,{className:"h-4 w-4"}),children:[{id:"org_setup",label:"Setup wizard",icon:e.jsx("div",{})},{id:"modules_enablement",label:"Modules and marketplaces",icon:e.jsx("div",{}),badge:"MyLiveDealz"}]},{id:"people",label:"People",icon:e.jsx(Us,{className:"h-4 w-4"}),badge:`${Ve.users}`,children:[{id:"users",label:"Users and invites",icon:e.jsx("div",{})},{id:"groups",label:"Groups and cost centers",icon:e.jsx("div",{})},{id:"roles_permissions",label:"Roles and permissions",icon:e.jsx("div",{})}]},{id:"controls",label:"Controls",icon:e.jsx(yt,{className:"h-4 w-4"}),children:[{id:"policies",label:"Policies",icon:e.jsx("div",{})},{id:"approval_workflows",label:"Approval workflows",icon:e.jsx("div",{})},{id:"approvals_inbox",label:"Approvals inbox",icon:e.jsx("div",{}),badge:`${Ve.approvals}`}]},{id:"money",label:"Budgets and billing",icon:e.jsx($a,{className:"h-4 w-4"}),children:[{id:"budgets",label:"Budgets and spend",icon:e.jsx("div",{}),badge:"Caps"},{id:"wallet_billing",label:"Wallet and funding",icon:e.jsx("div",{})},{id:"billing_setup",label:"Billing setup",icon:e.jsx("div",{})},{id:"invoices",label:"Invoices",icon:e.jsx("div",{})},{id:"collections",label:"Collections",icon:e.jsx("div",{}),badge:"Auto"},{id:"reconciliation",label:"Reconciliation",icon:e.jsx("div",{})}]},{id:"procurement",label:"Procurement",icon:e.jsx(wt,{className:"h-4 w-4"}),badge:"RFQ",children:[{id:"vendors",label:"Vendors and catalog",icon:e.jsx("div",{})},{id:"rfq",label:"RFQs and quotes",icon:e.jsx("div",{}),badge:`${Ve.rfqs}`},{id:"fulfillment",label:"Orders and fulfillment",icon:e.jsx("div",{})},{id:"travel",label:"Travel and scheduling",icon:e.jsx("div",{})}]},{id:"evs_charging",label:"EVs & Charging",icon:e.jsx(Ld,{className:"h-4 w-4"}),children:[{id:"ev_charging",label:"EV Charging",icon:e.jsx("div",{}),badge:"EV"}]},{id:"reports",label:"Reporting",icon:e.jsx(EE,{className:"h-4 w-4"}),children:[{id:"reporting",label:"Analytics",icon:e.jsx("div",{})},{id:"esg",label:"Sustainability and ESG",icon:e.jsx("div",{}),badge:"Premium"}]},{id:"integrations",label:"Integrations",icon:e.jsx(Ii,{className:"h-4 w-4"}),children:[{id:"integrations",label:"Developer center",icon:e.jsx("div",{})}]},{id:"security",label:"Security",icon:e.jsx(ra,{className:"h-4 w-4"}),children:[{id:"security",label:"Audit and compliance",icon:e.jsx("div",{})}]},{id:"support",label:"Support",icon:e.jsx($d,{className:"h-4 w-4"}),badge:`${Ve.cases}`,children:[{id:"support_tools",label:"Support tools",icon:e.jsx("div",{})}]},{id:"settings_hub",label:"Settings",icon:e.jsx(yi,{className:"h-4 w-4"})}],[Ve]),Te=ke[x]||ke.dashboard,Ee=j==="Active"?"good":j==="Past due"?"warn":"bad",Re=N==="EVzone Support",ze=d.useMemo(()=>{const z=[{k:"Approvals inbox",id:"approvals_inbox",kind:"page"},{k:"Create RFQ",id:"rfq",kind:"page"},{k:"Issue budget",id:"budgets",kind:"page"},{k:"Top up wallet",id:"wallet_billing",kind:"page"},{k:"Security: audit and compliance",id:"security",kind:"page"},{k:"Integrations: API keys and webhooks",id:"integrations",kind:"page"},{k:"Support tools",id:"support_tools",kind:"page"},{k:"EV Charging",id:"ev_charging",kind:"page"},{k:"Settings hub",id:"settings_hub",kind:"page"}],Pe=ie.trim().toLowerCase();return Pe?z.filter(Be=>Be.k.toLowerCase().includes(Pe)).slice(0,10):z.slice(0,8)},[ie]);d.useEffect(()=>{t&&c(!1)},[t]),d.useEffect(()=>{Ge(!1),je(!1),J(!1),G(!1)},[s]),d.useEffect(()=>{const z=Pe=>{(Pe.ctrlKey||Pe.metaKey)&&Pe.key.toLowerCase()==="k"&&(Pe.preventDefault(),Y(!0),a(`${is.CONSOLE.ROOT}/command_center`)),Pe.key==="Escape"&&Y(!1)};return window.addEventListener("keydown",z),()=>window.removeEventListener("keydown",z)},[]);const qe=z=>{const Pe=ke[z];return Pe?Pe.roles.includes(N):!0},He=()=>{const z=ke[x];if(!z)return e.jsx(PC,{title:"Not found",subtitle:"This route does not exist.",tier:"Core"});if(!qe(x))return e.jsx(XB,{pageTitle:z.title,role:N,onRequest:()=>{Fe(""),ye(!0)}});const Pe=Cf[x];return Pe?e.jsx(Pe,{}):e.jsx(PC,{title:z.title,subtitle:z.subtitle,tier:z.tier,bullets:z.bullets,onPrimary:()=>R({title:"Route",message:`Open ${z.id} (demo)`,kind:"info"}),primaryLabel:"Open"})},_e=z=>{$(z),R({title:"Role switched",message:z,kind:"info"}),qe(x)||a(`${is.CONSOLE.ROOT}/dashboard`)},le=z=>{k(z),R({title:"Organization",message:z,kind:"info"})};return l?e.jsxs("div",{className:"min-h-screen bg-white transition-colors duration-300 dark:bg-slate-950",children:[e.jsx(HB,{toasts:q,onDismiss:z=>L(Pe=>Pe.filter(Be=>Be.id!==z))}),Re?e.jsx("div",{className:"sticky top-0 z-30 border-b border-amber-200 bg-amber-50 px-4 py-2 text-xs text-amber-900",children:e.jsxs("div",{className:"mx-auto flex max-w-[1400px] items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(yt,{className:"h-4 w-4"})," Support role active. Sessions are visible and auditable. No silent actions."]}),e.jsx(ql,{label:"Support mode",tone:"warn"})]})}):null,j==="Suspended"?e.jsx("div",{className:"border-b border-rose-200 bg-rose-50 px-4 py-2 text-xs text-rose-900",children:e.jsxs("div",{className:"mx-auto flex max-w-[1400px] items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"})," Services are currently suspended due to payment non-compliance."]}),e.jsxs(Ci,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>a(`${is.CONSOLE.ROOT}/collections`),children:[e.jsx($o,{className:"h-4 w-4"})," Open collections"]})]})}):null,e.jsx("div",{className:"flex h-screen",children:e.jsxs("div",{className:"flex flex-1 overflow-hidden bg-white transition-colors dark:bg-slate-950",children:[e.jsx("div",{className:Hs("hidden h-full border-r border-slate-200 bg-slate-50 transition-colors lg:block dark:border-slate-800 dark:bg-slate-900",r?"w-[56px]":"w-[200px]"),children:e.jsx(MC,{nav:ne,active:x,onSelect:z=>a(`${is.CONSOLE.ROOT}/${z}`),collapsed:r,theme:U,onToggleTheme:()=>ae(z=>z==="light"?"dark":"light")})}),e.jsx(lt,{children:o?e.jsx(We.div,{className:"fixed inset-0 z-40 bg-black/30 lg:hidden",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsxs(We.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},exit:{x:-20,opacity:0},transition:{duration:.18},className:"h-full w-[86vw] max-w-[360px] bg-slate-50",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 px-4 py-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl text-white",style:{background:Li.green},children:e.jsx(ht,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"CorporatePay"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Navigation"})]})]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:()=>c(!1),"aria-label":"Close menu",children:e.jsx(Ye,{className:"h-5 w-5"})})]}),e.jsx(MC,{nav:ne,active:x,onSelect:z=>{a(`${is.CONSOLE.ROOT}/${z}`),c(!1)},collapsed:!1,theme:U,onToggleTheme:()=>ae(z=>z==="light"?"dark":"light")})]})}):null}),e.jsxs("div",{className:"flex h-full min-w-0 flex-1 flex-col",children:[e.jsxs("div",{className:"border-b border-emerald-700/30 transition-colors",style:{background:"linear-gradient(90deg, #03CD8C 0%, #F77F00 100%)"},children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 px-4 py-3 md:px-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"rounded-2xl border border-white/30 bg-white/20 p-2 text-white shadow-sm backdrop-blur hover:bg-white/30 lg:hidden",onClick:()=>c(!0),"aria-label":"Open menu",children:e.jsx(ay,{className:"h-5 w-5"})}),e.jsx("button",{className:"hidden rounded-2xl border border-white/30 bg-white/20 p-2 text-white shadow-sm backdrop-blur hover:bg-white/30 lg:inline-flex",onClick:()=>i(z=>!z),"aria-label":r?"Expand sidebar":"Collapse sidebar",children:r?e.jsx(et,{className:"h-5 w-5"}):e.jsx(GF,{className:"h-5 w-5"})}),e.jsxs("div",{className:"relative hidden md:block",children:[e.jsxs("button",{className:"flex items-center gap-2 rounded-2xl bg-white/20 px-3 py-2 text-xs font-semibold text-white backdrop-blur hover:bg-white/30",onClick:()=>{Oe(!Ue),je(!1),Ge(!1),G(!1),J(!1)},children:[e.jsx("span",{children:"Account"}),e.jsx(ql,{label:j,tone:Ee}),e.jsx(li,{className:"h-3 w-3 opacity-70"})]}),e.jsx(lt,{children:Ue&&e.jsxs(We.div,{initial:{opacity:0,y:8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:8,scale:.95},className:"absolute left-0 top-full z-50 mt-2 w-48 rounded-2xl border border-slate-200 bg-white p-2 shadow-xl",children:[e.jsx("div",{className:"px-2 py-1.5 text-xs font-semibold text-slate-500",children:"Account status"}),e.jsxs("button",{className:"flex w-full items-center justify-between rounded-xl px-2 py-2 text-sm font-medium hover:bg-slate-50",onClick:()=>{g("Active"),Oe(!1)},children:[e.jsx("span",{className:"text-emerald-700",children:"Active"}),j==="Active"&&e.jsx(tt,{className:"h-4 w-4 text-emerald-600"})]}),e.jsxs("button",{className:"flex w-full items-center justify-between rounded-xl px-2 py-2 text-sm font-medium hover:bg-slate-50",onClick:()=>{g("Past due"),Oe(!1)},children:[e.jsx("span",{className:"text-amber-700",children:"Past due"}),j==="Past due"&&e.jsx(tt,{className:"h-4 w-4 text-emerald-600"})]}),e.jsxs("button",{className:"flex w-full items-center justify-between rounded-xl px-2 py-2 text-sm font-medium hover:bg-slate-50",onClick:()=>{g("Suspended"),Oe(!1)},children:[e.jsx("span",{className:"text-rose-700",children:"Suspended"}),j==="Suspended"&&e.jsx(tt,{className:"h-4 w-4 text-emerald-600"})]})]})})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex w-[min(320px,35vw)] items-center gap-2 rounded-2xl border border-white/30 bg-white/95 px-3 py-2 shadow-sm focus-within:ring-4 focus-within:ring-white/30",children:[e.jsx(ka,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:ie,onChange:z=>_(z.target.value),onFocus:()=>Y(!0),placeholder:"Search users, invoices, approvals, vendors, RFQs...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"}),e.jsx("span",{className:"hidden rounded-xl bg-slate-100 px-2 py-1 text-xs font-semibold text-slate-600 md:inline",children:"Ctrl K"})]}),e.jsx(lt,{children:he?e.jsxs(We.div,{initial:{opacity:0,y:8,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:8,scale:.98},transition:{duration:.16},className:"absolute z-30 mt-2 w-full overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-[0_24px_70px_rgba(2,8,23,0.18)]",children:[e.jsx("div",{className:"px-4 py-3 text-xs font-semibold text-slate-600",children:"Suggestions"}),e.jsx("div",{className:"max-h-[260px] overflow-auto pb-2",children:ze.map(z=>e.jsxs("button",{className:"flex w-full items-center justify-between gap-3 px-4 py-2 text-left hover:bg-slate-50",onClick:()=>{a(`${is.CONSOLE.ROOT}/${z.id}`),Y(!1)},children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:z.k}),e.jsx("div",{className:"truncate text-xs text-slate-500",children:"Jump to page"})]}),e.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-1 text-xs font-semibold text-slate-600",children:"Open"})]},z.k))}),e.jsx("div",{className:"border-t border-slate-200 px-4 py-3 text-xs text-slate-500",children:"Tip: search is role-aware and should return only what you can access."})]}):null})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{ref:me,className:"hidden items-center gap-2 rounded-2xl border border-white/30 bg-white/20 px-3 py-2 text-sm font-semibold text-white shadow-sm backdrop-blur hover:bg-white/30 md:flex",onClick:()=>{je(z=>!z),Ge(!1),J(!1),G(!1)},title:"Switch organization",children:[e.jsx(Xl,{className:"h-4 w-4"}),e.jsx("span",{className:"max-w-[200px] truncate",children:T}),e.jsx(li,{className:"h-4 w-4 opacity-70"})]}),e.jsxs("button",{ref:ce,className:"hidden items-center gap-2 rounded-2xl border border-white/30 bg-white/20 px-3 py-2 text-sm font-semibold text-white shadow-sm backdrop-blur hover:bg-white/30 md:flex",onClick:()=>{Ge(z=>!z),je(!1),J(!1),G(!1)},title:"Switch role",children:[e.jsx(ct,{className:"h-4 w-4"}),e.jsx("span",{className:"max-w-[170px] truncate",children:N}),e.jsx(li,{className:"h-4 w-4 opacity-70"})]}),e.jsx("button",{ref:pe,className:"rounded-2xl border border-white/30 bg-white p-2 text-emerald-600 shadow-lg hover:bg-white/95",onClick:()=>{G(z=>!z),J(!1),Ge(!1),je(!1)},"aria-label":"Quick create",disabled:j==="Suspended",title:j==="Suspended"?"Disabled while suspended":"Quick create",children:e.jsx(pt,{className:"h-5 w-5"})}),e.jsxs("button",{ref:Ie,className:"relative rounded-2xl border border-white/30 bg-white/20 p-2 text-white shadow-sm backdrop-blur hover:bg-white/30",onClick:()=>{J(z=>!z),G(!1),Ge(!1),je(!1)},"aria-label":"Notifications",children:[e.jsx($o,{className:"h-5 w-5"}),e.jsx("span",{className:"absolute -right-1 -top-1 grid h-5 w-5 place-items-center rounded-full text-xs font-semibold text-white",style:{background:Li.orange},children:fe.length})]}),e.jsx("button",{className:"hidden rounded-2xl border border-white/30 bg-white/20 p-2 text-white shadow-sm backdrop-blur hover:bg-white/30 md:inline-flex","aria-label":"Settings",onClick:()=>a(`${is.CONSOLE.ROOT}/settings_hub`),children:e.jsx(yi,{className:"h-5 w-5"})}),e.jsx("button",{className:"hidden rounded-2xl border border-white/30 bg-white/20 p-2 text-white shadow-sm backdrop-blur hover:bg-white/30 md:inline-flex","aria-label":"Sign out",onClick:()=>{n(!1),R({title:"Signed out",message:"",kind:"info"})},children:e.jsx(bo,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3 px-4 pb-3 md:hidden",children:[e.jsx(ql,{label:`Account: ${j}`,tone:Ee}),e.jsxs("div",{className:"text-xs font-semibold text-white",children:["Role: ",N]})]})]}),e.jsxs(Kh,{open:W,onClose:()=>J(!1),anchorRef:Ie,width:420,children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 px-4 py-3",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Notifications"}),e.jsx("button",{className:"rounded-2xl px-3 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-100",onClick:()=>{J(!1),a(`${is.CONSOLE.ROOT}/notifications_activity`)},children:"View all"})]}),e.jsx("div",{className:"max-h-[420px] overflow-auto p-2",children:fe.map(z=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:z.title}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:z.message}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(ql,{label:z.when,tone:"neutral"}),z.channel?e.jsx(GB,{channel:z.channel}):null,z.tone==="success"?e.jsx(ql,{label:"OK",tone:"good"}):z.tone==="warning"?e.jsx(ql,{label:"Attention",tone:"warn"}):z.tone==="danger"?e.jsx(ql,{label:"Action",tone:"bad"}):e.jsx(ql,{label:"Info",tone:"info"})]})]}),e.jsx("button",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-50",onClick:()=>{J(!1),a(`${is.CONSOLE.ROOT}/notifications_activity`)},children:"Open"})]})},z.id))}),e.jsx("div",{className:"border-t border-slate-200 px-4 py-3 text-xs text-slate-500",children:"Reminders support Email, WhatsApp, WeChat, and SMS. Delivery logs are saved for audit."})]}),e.jsxs(Kh,{open:be,onClose:()=>Ge(!1),anchorRef:ce,width:320,children:[e.jsxs("div",{className:"border-b border-slate-200 px-4 py-3",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Switch role"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Role-aware views change navigation and permissions."})]}),e.jsx("div",{className:"p-2",children:["Org Owner","Org Admin","Manager","Accountant","Approver","Travel Coordinator","Employee","EVzone Support"].map(z=>e.jsxs("button",{className:Hs("flex w-full items-center justify-between rounded-2xl px-3 py-2 text-left text-sm hover:bg-slate-50",z===N&&"bg-emerald-50"),onClick:()=>{_e(z),Ge(!1)},children:[e.jsx("span",{className:Hs("font-semibold",z===N?"text-emerald-800":"text-slate-800"),children:z}),z===N?e.jsx(ct,{className:"h-4 w-4 text-emerald-700"}):null]},z))}),e.jsx("div",{className:"border-t border-slate-200 px-4 py-3 text-xs text-slate-500",children:"Support role is audited and can be disabled by organization policy."})]}),e.jsxs(Kh,{open:Me,onClose:()=>je(!1),anchorRef:me,width:340,children:[e.jsxs("div",{className:"border-b border-slate-200 px-4 py-3",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Organizations"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Switch admin view across organizations you manage."})]}),e.jsx("div",{className:"p-2",children:["Acme Group Ltd","EVzone Demo Org","Kampala Holdings"].map(z=>e.jsxs("button",{className:Hs("flex w-full items-center justify-between rounded-2xl px-3 py-2 text-left text-sm hover:bg-slate-50",z===T&&"bg-emerald-50"),onClick:()=>{le(z),je(!1)},children:[e.jsx("span",{className:Hs("font-semibold",z===T?"text-emerald-800":"text-slate-800"),children:z}),z===T?e.jsx(ct,{className:"h-4 w-4 text-emerald-700"}):null]},z))})]}),e.jsxs(Kh,{open:we,onClose:()=>G(!1),anchorRef:pe,width:360,children:[e.jsxs("div",{className:"border-b border-slate-200 px-4 py-3",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Quick create"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Fast actions that open the correct workflows."})]}),e.jsx("div",{className:"p-2",children:[{label:"Invite user",icon:e.jsx(Us,{className:"h-4 w-4"}),id:"users"},{label:"Create policy",icon:e.jsx(yt,{className:"h-4 w-4"}),id:"policies"},{label:"Create RFQ",icon:e.jsx(wt,{className:"h-4 w-4"}),id:"rfq"},{label:"Issue budget",icon:e.jsx(rg,{className:"h-4 w-4"}),id:"budgets"},{label:"Create webhook",icon:e.jsx(Ii,{className:"h-4 w-4"}),id:"integrations"},{label:"Open support case",icon:e.jsx(ni,{className:"h-4 w-4"}),id:"support_tools"}].map(z=>e.jsxs("button",{className:"flex w-full items-center justify-between rounded-2xl px-3 py-2 text-left text-sm hover:bg-slate-50",onClick:()=>{a(`${is.CONSOLE.ROOT}/${z.id}`),G(!1)},children:[e.jsxs("span",{className:"flex items-center gap-2 font-semibold text-slate-800",children:[e.jsx("span",{className:"text-slate-600",children:z.icon}),z.label]}),e.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-1 text-xs font-semibold text-slate-600",children:"Open"})]},z.label))}),e.jsx("div",{className:"border-t border-slate-200 px-4 py-3 text-xs text-slate-500",children:"All actions are permission checked and logged for audit."})]}),e.jsx("div",{className:"min-h-0 flex-1 overflow-auto bg-slate-50",children:e.jsxs("div",{className:"px-4 py-5 md:px-5",children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Current view"}),e.jsx("h1",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:Te.title}),e.jsx("p",{className:"mt-2 max-w-2xl text-sm text-slate-600",children:Te.subtitle})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ql,{label:Te.tier,tone:Te.tier==="Premium"?"info":(Te.tier==="Phase 2","neutral")}),Te.status?e.jsx(ql,{label:Te.status,tone:Te.status==="Ready"?"good":"warn"}):null,Re?e.jsx(ql,{label:"Support role",tone:"warn"}):e.jsx(ql,{label:"Org role",tone:"neutral"}),e.jsxs(Ci,{variant:"outline",onClick:()=>a(`${is.CONSOLE.ROOT}/settings_hub`),children:[e.jsx(yi,{className:"h-4 w-4"})," Settings"]})]})]})}),He()]})}),e.jsx("div",{className:"border-t border-slate-200 bg-white lg:hidden",children:e.jsxs("div",{className:"grid grid-cols-5 gap-2 px-3 py-2",children:[e.jsx(Fm,{active:x==="dashboard",label:"Home",icon:e.jsx(ox,{className:"h-5 w-5"}),onClick:()=>a(`${is.CONSOLE.ROOT}/dashboard`)}),e.jsx(Fm,{active:x==="approvals_inbox",label:"Approvals",icon:e.jsx(ig,{className:"h-5 w-5"}),badge:`${Ve.approvals}`,onClick:()=>a(`${is.CONSOLE.ROOT}/approvals_inbox`)}),e.jsx(Fm,{active:x==="budgets",label:"Spend",icon:e.jsx(rg,{className:"h-5 w-5"}),onClick:()=>a(`${is.CONSOLE.ROOT}/budgets`)}),e.jsx(Fm,{active:x==="wallet_billing",label:"Wallet",icon:e.jsx($a,{className:"h-5 w-5"}),onClick:()=>a(`${is.CONSOLE.ROOT}/wallet_billing`)}),e.jsx(Fm,{active:!1,label:"More",icon:e.jsx(ay,{className:"h-5 w-5"}),onClick:()=>c(!0)})]})})]})]})}),e.jsxs(WB,{open:de,title:"Request access",subtitle:"This creates a request for Org Admin to grant permissions.",onClose:()=>ye(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Ci,{variant:"outline",onClick:()=>ye(!1),children:"Cancel"}),e.jsxs(Ci,{variant:"primary",onClick:()=>{if(Qe.trim().length<8){R({title:"Reason required",message:"Explain why you need access.",kind:"warn"});return}R({title:"Requested",message:"Access request created.",kind:"success"}),ye(!1)},children:[e.jsx(ni,{className:"h-4 w-4"})," Submit"]})]}),children:[e.jsx("textarea",{value:Qe,onChange:z=>Fe(z.target.value),placeholder:"Explain why you need access and for how long",rows:4,className:"w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Requests should be auditable and time-bounded in production."})]}),e.jsx(QB,{onAway:()=>{Y(!1)}})]}):e.jsx(KB,{onLogin:(z,Pe)=>{k(z),$(Pe),n(!0),a(`${is.CONSOLE.ROOT}/dashboard`),R({title:"Signed in",message:`${z} - ${Pe}`,kind:"success"})},orgs:["Acme Group Ltd","EVzone Demo Org","Kampala Holdings"],roles:["Org Owner","Org Admin","Manager","Accountant","Approver","Travel Coordinator","Employee","EVzone Support"]})}function QB({onAway:t}){return d.useEffect(()=>{const s=a=>{const l=a.target;l&&(l.closest("[role='menu']")||l.closest("input")||t())};return window.addEventListener("mousedown",s),()=>window.removeEventListener("mousedown",s)},[t]),null}function Fm({label:t,icon:s,badge:a,active:l,onClick:n}){return e.jsxs("button",{onClick:n,className:Hs("relative flex flex-col items-center justify-center gap-1 rounded-2xl px-2 py-2 text-xs font-semibold",l?"text-white":"text-slate-700 hover:bg-slate-100"),style:l?{background:Li.green}:void 0,children:[e.jsx("div",{className:Hs("relative",l?"text-white":"text-slate-700"),children:s}),e.jsx("div",{className:"leading-none",children:t}),a?e.jsx("span",{className:"absolute right-2 top-1 rounded-full bg-rose-500 px-1.5 py-0.5 text-[10px] font-semibold text-white",children:a}):null]})}function YB(t){return Object.prototype.hasOwnProperty.call(Cf,t)}function JB(){const{id:t}=XS(),s=t||"";if(!s||!YB(s))return e.jsx("div",{className:"min-h-screen bg-slate-50 px-4 py-10",children:e.jsxs("div",{className:"mx-auto max-w-3xl rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Page not found"}),e.jsxs("div",{className:"mt-2 text-sm text-slate-600",children:["Unknown page id: ",e.jsx("span",{className:"font-mono",children:s||"(missing)"})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[e.jsx(Rp,{to:"/",className:"rounded-2xl border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-800 hover:bg-slate-50",children:"Go to landing"}),e.jsx(Rp,{to:"/console",className:"rounded-2xl bg-emerald-600 px-4 py-2 text-sm font-semibold text-white hover:bg-emerald-700",children:"Open console"})]}),e.jsxs("div",{className:"mt-6 text-xs text-slate-500",children:["Tip: valid ids include ",e.jsx("span",{className:"font-mono",children:"dashboard"}),", ",e.jsx("span",{className:"font-mono",children:"notifications_activity"}),","," ",e.jsx("span",{className:"font-mono",children:"rfq"}),", etc."]})]})});const a=Cf[s];return e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx("div",{className:"border-b border-slate-200 bg-white",children:e.jsxs("div",{className:"mx-auto flex max-w-[1200px] items-center justify-between px-4 py-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Standalone preview"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:s})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Rp,{to:"/console",className:"rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-800 hover:bg-slate-50",children:"Console"}),e.jsx(Rp,{to:"/",className:"rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-800 hover:bg-slate-50",children:"Landing"})]})]})}),e.jsx("div",{className:"mx-auto max-w-[1200px] px-4 py-6",children:e.jsx(a,{})})]})}const ZB=[{path:is.CONSOLE.ROOT,element:Xt.createElement(Mb)},{path:`${is.CONSOLE.ROOT}/:pageId`,element:Xt.createElement(Mb)},{path:`${is.CONSOLE.ROOT}/:pageId/:subPageId`,element:Xt.createElement(Mb)}],eG=[{path:is.PAGES_PREVIEW,element:Xt.createElement(JB)}];function tG(){return e.jsxs(wO,{children:[oU.map(t=>e.jsx(Ic,{path:t.path,element:t.element},t.path)),ZB.map(t=>e.jsx(Ic,{path:t.path,element:t.element},t.path)),SU.map(t=>e.jsx(Ic,{path:t.path,element:t.element},t.path)),eG.map(t=>e.jsx(Ic,{path:t.path,element:t.element},t.path)),e.jsx(Ic,{path:"*",element:e.jsx(yO,{to:is.HOME,replace:!0})})]})}class sG extends Xt.Component{constructor(){super(...arguments);kw(this,"state",{hasError:!1})}static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,l){console.error("ErrorBoundary caught:",a,l)}render(){var a;return this.state.hasError?e.jsx("div",{className:"min-h-screen bg-slate-50 px-4 py-10",children:e.jsx("div",{className:"mx-auto max-w-3xl",children:e.jsxs(F9,{severity:"error",variant:"outlined",children:[e.jsx(Q9,{children:"Something went wrong"}),e.jsx("div",{className:"mt-2 text-sm",children:((a=this.state.error)==null?void 0:a.message)||"An unexpected error occurred."}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[e.jsx(R1,{variant:"contained",color:"primary",onClick:()=>window.location.reload(),children:"Reload"}),e.jsx(R1,{variant:"outlined",onClick:()=>this.setState({hasError:!1,error:void 0}),children:"Dismiss"})]})]})})}):this.props.children}}const Pb={green:"#03CD8C",orange:"#F77F00",slate:"#0F172A"},aG=fI(W5({palette:{primary:{main:Pb.green},secondary:{main:Pb.orange},background:{default:"#F8FAFC",paper:"#FFFFFF"},text:{primary:Pb.slate}},shape:{borderRadius:16},typography:{fontFamily:["ui-sans-serif","system-ui","-apple-system","Segoe UI","Roboto","Helvetica","Arial","Apple Color Emoji","Segoe UI Emoji"].join(","),button:{textTransform:"none",fontWeight:700}},components:{MuiButton:{styleOverrides:{root:{borderRadius:18}}},MuiPaper:{styleOverrides:{root:{borderRadius:22}}}}}));Ob.createRoot(document.getElementById("root")).render(e.jsx(Xt.StrictMode,{children:e.jsx(sG,{children:e.jsx(b5,{injectFirst:!0,children:e.jsxs(_I,{theme:aG,children:[e.jsx(d$,{}),e.jsx(PO,{children:e.jsx(tG,{})})]})})})}));
