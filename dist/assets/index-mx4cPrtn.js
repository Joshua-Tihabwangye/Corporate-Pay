var rM=Object.defineProperty;var iM=(t,s,a)=>s in t?rM(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a;var Mw=(t,s,a)=>iM(t,typeof s!="symbol"?s+"":s,a);function oM(t,s){for(var a=0;a<s.length;a++){const l=s[a];if(typeof l!="string"&&!Array.isArray(l)){for(const n in l)if(n!=="default"&&!(n in t)){const r=Object.getOwnPropertyDescriptor(l,n);r&&Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:()=>l[n]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function a(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(n){if(n.ep)return;n.ep=!0;const r=a(n);fetch(n.href,r)}})();function dM(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function qo(t){if(t.__esModule)return t;var s=t.default;if(typeof s=="function"){var a=function l(){return this instanceof l?Reflect.construct(s,arguments,this.constructor):s.apply(this,arguments)};a.prototype=s.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(t).forEach(function(l){var n=Object.getOwnPropertyDescriptor(t,l);Object.defineProperty(a,l,n.get?n:{enumerable:!0,get:function(){return t[l]}})}),a}var $C={exports:{}},yg={},LC={exports:{}},Zt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jx=Symbol.for("react.element"),cM=Symbol.for("react.portal"),uM=Symbol.for("react.fragment"),mM=Symbol.for("react.strict_mode"),xM=Symbol.for("react.profiler"),pM=Symbol.for("react.provider"),hM=Symbol.for("react.context"),gM=Symbol.for("react.forward_ref"),fM=Symbol.for("react.suspense"),vM=Symbol.for("react.memo"),bM=Symbol.for("react.lazy"),Pw=Symbol.iterator;function jM(t){return t===null||typeof t!="object"?null:(t=Pw&&t[Pw]||t["@@iterator"],typeof t=="function"?t:null)}var FC={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},UC=Object.assign,VC={};function Au(t,s,a){this.props=t,this.context=s,this.refs=VC,this.updater=a||FC}Au.prototype.isReactComponent={};Au.prototype.setState=function(t,s){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,s,"setState")};Au.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function _C(){}_C.prototype=Au.prototype;function vy(t,s,a){this.props=t,this.context=s,this.refs=VC,this.updater=a||FC}var by=vy.prototype=new _C;by.constructor=vy;UC(by,Au.prototype);by.isPureReactComponent=!0;var Ow=Array.isArray,BC=Object.prototype.hasOwnProperty,jy={current:null},GC={key:!0,ref:!0,__self:!0,__source:!0};function qC(t,s,a){var l,n={},r=null,i=null;if(s!=null)for(l in s.ref!==void 0&&(i=s.ref),s.key!==void 0&&(r=""+s.key),s)BC.call(s,l)&&!GC.hasOwnProperty(l)&&(n[l]=s[l]);var o=arguments.length-2;if(o===1)n.children=a;else if(1<o){for(var c=Array(o),x=0;x<o;x++)c[x]=arguments[x+2];n.children=c}if(t&&t.defaultProps)for(l in o=t.defaultProps,o)n[l]===void 0&&(n[l]=o[l]);return{$$typeof:Jx,type:t,key:r,ref:i,props:n,_owner:jy.current}}function yM(t,s){return{$$typeof:Jx,type:t.type,key:s,ref:t.ref,props:t.props,_owner:t._owner}}function yy(t){return typeof t=="object"&&t!==null&&t.$$typeof===Jx}function NM(t){var s={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(a){return s[a]})}var Tw=/\/+/g;function Ef(t,s){return typeof t=="object"&&t!==null&&t.key!=null?NM(""+t.key):s.toString(36)}function Kh(t,s,a,l,n){var r=typeof t;(r==="undefined"||r==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(r){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case Jx:case cM:i=!0}}if(i)return i=t,n=n(i),t=l===""?"."+Ef(i,0):l,Ow(n)?(a="",t!=null&&(a=t.replace(Tw,"$&/")+"/"),Kh(n,s,a,"",function(x){return x})):n!=null&&(yy(n)&&(n=yM(n,a+(!n.key||i&&i.key===n.key?"":(""+n.key).replace(Tw,"$&/")+"/")+t)),s.push(n)),1;if(i=0,l=l===""?".":l+":",Ow(t))for(var o=0;o<t.length;o++){r=t[o];var c=l+Ef(r,o);i+=Kh(r,s,a,c,n)}else if(c=jM(t),typeof c=="function")for(t=c.call(t),o=0;!(r=t.next()).done;)r=r.value,c=l+Ef(r,o++),i+=Kh(r,s,a,c,n);else if(r==="object")throw s=String(t),Error("Objects are not valid as a React child (found: "+(s==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":s)+"). If you meant to render a collection of children, use an array instead.");return i}function hp(t,s,a){if(t==null)return t;var l=[],n=0;return Kh(t,l,"","",function(r){return s.call(a,r,n++)}),l}function wM(t){if(t._status===-1){var s=t._result;s=s(),s.then(function(a){(t._status===0||t._status===-1)&&(t._status=1,t._result=a)},function(a){(t._status===0||t._status===-1)&&(t._status=2,t._result=a)}),t._status===-1&&(t._status=0,t._result=s)}if(t._status===1)return t._result.default;throw t._result}var sn={current:null},Qh={transition:null},kM={ReactCurrentDispatcher:sn,ReactCurrentBatchConfig:Qh,ReactCurrentOwner:jy};function zC(){throw Error("act(...) is not supported in production builds of React.")}Zt.Children={map:hp,forEach:function(t,s,a){hp(t,function(){s.apply(this,arguments)},a)},count:function(t){var s=0;return hp(t,function(){s++}),s},toArray:function(t){return hp(t,function(s){return s})||[]},only:function(t){if(!yy(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Zt.Component=Au;Zt.Fragment=uM;Zt.Profiler=xM;Zt.PureComponent=vy;Zt.StrictMode=mM;Zt.Suspense=fM;Zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kM;Zt.act=zC;Zt.cloneElement=function(t,s,a){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var l=UC({},t.props),n=t.key,r=t.ref,i=t._owner;if(s!=null){if(s.ref!==void 0&&(r=s.ref,i=jy.current),s.key!==void 0&&(n=""+s.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(c in s)BC.call(s,c)&&!GC.hasOwnProperty(c)&&(l[c]=s[c]===void 0&&o!==void 0?o[c]:s[c])}var c=arguments.length-2;if(c===1)l.children=a;else if(1<c){o=Array(c);for(var x=0;x<c;x++)o[x]=arguments[x+2];l.children=o}return{$$typeof:Jx,type:t.type,key:n,ref:r,props:l,_owner:i}};Zt.createContext=function(t){return t={$$typeof:hM,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:pM,_context:t},t.Consumer=t};Zt.createElement=qC;Zt.createFactory=function(t){var s=qC.bind(null,t);return s.type=t,s};Zt.createRef=function(){return{current:null}};Zt.forwardRef=function(t){return{$$typeof:gM,render:t}};Zt.isValidElement=yy;Zt.lazy=function(t){return{$$typeof:bM,_payload:{_status:-1,_result:t},_init:wM}};Zt.memo=function(t,s){return{$$typeof:vM,type:t,compare:s===void 0?null:s}};Zt.startTransition=function(t){var s=Qh.transition;Qh.transition={};try{t()}finally{Qh.transition=s}};Zt.unstable_act=zC;Zt.useCallback=function(t,s){return sn.current.useCallback(t,s)};Zt.useContext=function(t){return sn.current.useContext(t)};Zt.useDebugValue=function(){};Zt.useDeferredValue=function(t){return sn.current.useDeferredValue(t)};Zt.useEffect=function(t,s){return sn.current.useEffect(t,s)};Zt.useId=function(){return sn.current.useId()};Zt.useImperativeHandle=function(t,s,a){return sn.current.useImperativeHandle(t,s,a)};Zt.useInsertionEffect=function(t,s){return sn.current.useInsertionEffect(t,s)};Zt.useLayoutEffect=function(t,s){return sn.current.useLayoutEffect(t,s)};Zt.useMemo=function(t,s){return sn.current.useMemo(t,s)};Zt.useReducer=function(t,s,a){return sn.current.useReducer(t,s,a)};Zt.useRef=function(t){return sn.current.useRef(t)};Zt.useState=function(t){return sn.current.useState(t)};Zt.useSyncExternalStore=function(t,s,a){return sn.current.useSyncExternalStore(t,s,a)};Zt.useTransition=function(){return sn.current.useTransition()};Zt.version="18.3.1";LC.exports=Zt;var d=LC.exports;const qt=dM(d),y0=oM({__proto__:null,default:qt},[d]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CM=d,SM=Symbol.for("react.element"),AM=Symbol.for("react.fragment"),EM=Object.prototype.hasOwnProperty,MM=CM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,PM={key:!0,ref:!0,__self:!0,__source:!0};function WC(t,s,a){var l,n={},r=null,i=null;a!==void 0&&(r=""+a),s.key!==void 0&&(r=""+s.key),s.ref!==void 0&&(i=s.ref);for(l in s)EM.call(s,l)&&!PM.hasOwnProperty(l)&&(n[l]=s[l]);if(t&&t.defaultProps)for(l in s=t.defaultProps,s)n[l]===void 0&&(n[l]=s[l]);return{$$typeof:SM,type:t,key:r,ref:i,props:n,_owner:MM.current}}yg.Fragment=AM;yg.jsx=WC;yg.jsxs=WC;$C.exports=yg;var e=$C.exports,Rb={},HC={exports:{}},Ln={},XC={exports:{}},KC={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function s(Q,Re){var ce=Q.length;Q.push(Re);e:for(;0<ce;){var xe=ce-1>>>1,he=Q[xe];if(0<n(he,Re))Q[xe]=Re,Q[ce]=he,ce=xe;else break e}}function a(Q){return Q.length===0?null:Q[0]}function l(Q){if(Q.length===0)return null;var Re=Q[0],ce=Q.pop();if(ce!==Re){Q[0]=ce;e:for(var xe=0,he=Q.length,de=he>>>1;xe<de;){var ye=2*(xe+1)-1,Ke=Q[ye],Le=ye+1,Ne=Q[Le];if(0>n(Ke,ce))Le<he&&0>n(Ne,Ke)?(Q[xe]=Ne,Q[Le]=ce,xe=Le):(Q[xe]=Ke,Q[ye]=ce,xe=ye);else if(Le<he&&0>n(Ne,ce))Q[xe]=Ne,Q[Le]=ce,xe=Le;else break e}}return Re}function n(Q,Re){var ce=Q.sortIndex-Re.sortIndex;return ce!==0?ce:Q.id-Re.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;t.unstable_now=function(){return r.now()}}else{var i=Date,o=i.now();t.unstable_now=function(){return i.now()-o}}var c=[],x=[],j=1,g=null,y=3,$=!1,T=!1,C=!1,W=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function F(Q){for(var Re=a(x);Re!==null;){if(Re.callback===null)l(x);else if(Re.startTime<=Q)l(x),Re.sortIndex=Re.expirationTime,s(c,Re);else break;Re=a(x)}}function te(Q){if(C=!1,F(Q),!T)if(a(c)!==null)T=!0,Pe(oe);else{var Re=a(x);Re!==null&&pe(te,Re.startTime-Q)}}function oe(Q,Re){T=!1,C&&(C=!1,L(Y),Y=-1),$=!0;var ce=y;try{for(F(Re),g=a(c);g!==null&&(!(g.expirationTime>Re)||Q&&!je());){var xe=g.callback;if(typeof xe=="function"){g.callback=null,y=g.priorityLevel;var he=xe(g.expirationTime<=Re);Re=t.unstable_now(),typeof he=="function"?g.callback=he:g===a(c)&&l(c),F(Re)}else l(c);g=a(c)}if(g!==null)var de=!0;else{var ye=a(x);ye!==null&&pe(te,ye.startTime-Re),de=!1}return de}finally{g=null,y=ce,$=!1}}var G=!1,H=null,Y=-1,we=5,q=-1;function je(){return!(t.unstable_now()-q<we)}function _e(){if(H!==null){var Q=t.unstable_now();q=Q;var Re=!0;try{Re=H(!0,Q)}finally{Re?Ee():(G=!1,H=null)}}else G=!1}var Ee;if(typeof R=="function")Ee=function(){R(_e)};else if(typeof MessageChannel<"u"){var be=new MessageChannel,Fe=be.port2;be.port1.onmessage=_e,Ee=function(){Fe.postMessage(null)}}else Ee=function(){W(_e,0)};function Pe(Q){H=Q,G||(G=!0,Ee())}function pe(Q,Re){Y=W(function(){Q(t.unstable_now())},Re)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Q){Q.callback=null},t.unstable_continueExecution=function(){T||$||(T=!0,Pe(oe))},t.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):we=0<Q?Math.floor(1e3/Q):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_getFirstCallbackNode=function(){return a(c)},t.unstable_next=function(Q){switch(y){case 1:case 2:case 3:var Re=3;break;default:Re=y}var ce=y;y=Re;try{return Q()}finally{y=ce}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Q,Re){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var ce=y;y=Q;try{return Re()}finally{y=ce}},t.unstable_scheduleCallback=function(Q,Re,ce){var xe=t.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?xe+ce:xe):ce=xe,Q){case 1:var he=-1;break;case 2:he=250;break;case 5:he=1073741823;break;case 4:he=1e4;break;default:he=5e3}return he=ce+he,Q={id:j++,callback:Re,priorityLevel:Q,startTime:ce,expirationTime:he,sortIndex:-1},ce>xe?(Q.sortIndex=ce,s(x,Q),a(c)===null&&Q===a(x)&&(C?(L(Y),Y=-1):C=!0,pe(te,ce-xe))):(Q.sortIndex=he,s(c,Q),T||$||(T=!0,Pe(oe))),Q},t.unstable_shouldYield=je,t.unstable_wrapCallback=function(Q){var Re=y;return function(){var ce=y;y=Re;try{return Q.apply(this,arguments)}finally{y=ce}}}})(KC);XC.exports=KC;var OM=XC.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TM=d,In=OM;function at(t){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+t,a=1;a<arguments.length;a++)s+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+t+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var QC=new Set,vx={};function Hd(t,s){pu(t,s),pu(t+"Capture",s)}function pu(t,s){for(vx[t]=s,t=0;t<s.length;t++)QC.add(s[t])}var Pi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Db=Object.prototype.hasOwnProperty,RM=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Rw={},Dw={};function DM(t){return Db.call(Dw,t)?!0:Db.call(Rw,t)?!1:RM.test(t)?Dw[t]=!0:(Rw[t]=!0,!1)}function IM(t,s,a,l){if(a!==null&&a.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return l?!1:a!==null?!a.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function $M(t,s,a,l){if(s===null||typeof s>"u"||IM(t,s,a,l))return!0;if(l)return!1;if(a!==null)switch(a.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function an(t,s,a,l,n,r,i){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=l,this.attributeNamespace=n,this.mustUseProperty=a,this.propertyName=t,this.type=s,this.sanitizeURL=r,this.removeEmptyString=i}var Cl={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Cl[t]=new an(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var s=t[0];Cl[s]=new an(s,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Cl[t]=new an(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Cl[t]=new an(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Cl[t]=new an(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Cl[t]=new an(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Cl[t]=new an(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Cl[t]=new an(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Cl[t]=new an(t,5,!1,t.toLowerCase(),null,!1,!1)});var Ny=/[\-:]([a-z])/g;function wy(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var s=t.replace(Ny,wy);Cl[s]=new an(s,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var s=t.replace(Ny,wy);Cl[s]=new an(s,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var s=t.replace(Ny,wy);Cl[s]=new an(s,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Cl[t]=new an(t,1,!1,t.toLowerCase(),null,!1,!1)});Cl.xlinkHref=new an("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Cl[t]=new an(t,1,!1,t.toLowerCase(),null,!0,!0)});function ky(t,s,a,l){var n=Cl.hasOwnProperty(s)?Cl[s]:null;(n!==null?n.type!==0:l||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&($M(s,a,n,l)&&(a=null),l||n===null?DM(s)&&(a===null?t.removeAttribute(s):t.setAttribute(s,""+a)):n.mustUseProperty?t[n.propertyName]=a===null?n.type===3?!1:"":a:(s=n.attributeName,l=n.attributeNamespace,a===null?t.removeAttribute(s):(n=n.type,a=n===3||n===4&&a===!0?"":""+a,l?t.setAttributeNS(l,s,a):t.setAttribute(s,a))))}var Ui=TM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,gp=Symbol.for("react.element"),Fc=Symbol.for("react.portal"),Uc=Symbol.for("react.fragment"),Cy=Symbol.for("react.strict_mode"),Ib=Symbol.for("react.profiler"),YC=Symbol.for("react.provider"),JC=Symbol.for("react.context"),Sy=Symbol.for("react.forward_ref"),$b=Symbol.for("react.suspense"),Lb=Symbol.for("react.suspense_list"),Ay=Symbol.for("react.memo"),po=Symbol.for("react.lazy"),ZC=Symbol.for("react.offscreen"),Iw=Symbol.iterator;function Gu(t){return t===null||typeof t!="object"?null:(t=Iw&&t[Iw]||t["@@iterator"],typeof t=="function"?t:null)}var xa=Object.assign,Mf;function Um(t){if(Mf===void 0)try{throw Error()}catch(a){var s=a.stack.trim().match(/\n( *(at )?)/);Mf=s&&s[1]||""}return`
`+Mf+t}var Pf=!1;function Of(t,s){if(!t||Pf)return"";Pf=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(x){var l=x}Reflect.construct(t,[],s)}else{try{s.call()}catch(x){l=x}t.call(s.prototype)}else{try{throw Error()}catch(x){l=x}t()}}catch(x){if(x&&l&&typeof x.stack=="string"){for(var n=x.stack.split(`
`),r=l.stack.split(`
`),i=n.length-1,o=r.length-1;1<=i&&0<=o&&n[i]!==r[o];)o--;for(;1<=i&&0<=o;i--,o--)if(n[i]!==r[o]){if(i!==1||o!==1)do if(i--,o--,0>o||n[i]!==r[o]){var c=`
`+n[i].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=i&&0<=o);break}}}finally{Pf=!1,Error.prepareStackTrace=a}return(t=t?t.displayName||t.name:"")?Um(t):""}function LM(t){switch(t.tag){case 5:return Um(t.type);case 16:return Um("Lazy");case 13:return Um("Suspense");case 19:return Um("SuspenseList");case 0:case 2:case 15:return t=Of(t.type,!1),t;case 11:return t=Of(t.type.render,!1),t;case 1:return t=Of(t.type,!0),t;default:return""}}function Fb(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Uc:return"Fragment";case Fc:return"Portal";case Ib:return"Profiler";case Cy:return"StrictMode";case $b:return"Suspense";case Lb:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case JC:return(t.displayName||"Context")+".Consumer";case YC:return(t._context.displayName||"Context")+".Provider";case Sy:var s=t.render;return t=t.displayName,t||(t=s.displayName||s.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ay:return s=t.displayName||null,s!==null?s:Fb(t.type)||"Memo";case po:s=t._payload,t=t._init;try{return Fb(t(s))}catch{}}return null}function FM(t){var s=t.type;switch(t.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=s.render,t=t.displayName||t.name||"",s.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Fb(s);case 8:return s===Cy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function Vo(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function e3(t){var s=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function UM(t){var s=e3(t)?"checked":"value",a=Object.getOwnPropertyDescriptor(t.constructor.prototype,s),l=""+t[s];if(!t.hasOwnProperty(s)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var n=a.get,r=a.set;return Object.defineProperty(t,s,{configurable:!0,get:function(){return n.call(this)},set:function(i){l=""+i,r.call(this,i)}}),Object.defineProperty(t,s,{enumerable:a.enumerable}),{getValue:function(){return l},setValue:function(i){l=""+i},stopTracking:function(){t._valueTracker=null,delete t[s]}}}}function fp(t){t._valueTracker||(t._valueTracker=UM(t))}function t3(t){if(!t)return!1;var s=t._valueTracker;if(!s)return!0;var a=s.getValue(),l="";return t&&(l=e3(t)?t.checked?"true":"false":t.value),t=l,t!==a?(s.setValue(t),!0):!1}function N0(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ub(t,s){var a=s.checked;return xa({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??t._wrapperState.initialChecked})}function $w(t,s){var a=s.defaultValue==null?"":s.defaultValue,l=s.checked!=null?s.checked:s.defaultChecked;a=Vo(s.value!=null?s.value:a),t._wrapperState={initialChecked:l,initialValue:a,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function s3(t,s){s=s.checked,s!=null&&ky(t,"checked",s,!1)}function Vb(t,s){s3(t,s);var a=Vo(s.value),l=s.type;if(a!=null)l==="number"?(a===0&&t.value===""||t.value!=a)&&(t.value=""+a):t.value!==""+a&&(t.value=""+a);else if(l==="submit"||l==="reset"){t.removeAttribute("value");return}s.hasOwnProperty("value")?_b(t,s.type,a):s.hasOwnProperty("defaultValue")&&_b(t,s.type,Vo(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(t.defaultChecked=!!s.defaultChecked)}function Lw(t,s,a){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var l=s.type;if(!(l!=="submit"&&l!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+t._wrapperState.initialValue,a||s===t.value||(t.value=s),t.defaultValue=s}a=t.name,a!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,a!==""&&(t.name=a)}function _b(t,s,a){(s!=="number"||N0(t.ownerDocument)!==t)&&(a==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+a&&(t.defaultValue=""+a))}var Vm=Array.isArray;function lu(t,s,a,l){if(t=t.options,s){s={};for(var n=0;n<a.length;n++)s["$"+a[n]]=!0;for(a=0;a<t.length;a++)n=s.hasOwnProperty("$"+t[a].value),t[a].selected!==n&&(t[a].selected=n),n&&l&&(t[a].defaultSelected=!0)}else{for(a=""+Vo(a),s=null,n=0;n<t.length;n++){if(t[n].value===a){t[n].selected=!0,l&&(t[n].defaultSelected=!0);return}s!==null||t[n].disabled||(s=t[n])}s!==null&&(s.selected=!0)}}function Bb(t,s){if(s.dangerouslySetInnerHTML!=null)throw Error(at(91));return xa({},s,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Fw(t,s){var a=s.value;if(a==null){if(a=s.children,s=s.defaultValue,a!=null){if(s!=null)throw Error(at(92));if(Vm(a)){if(1<a.length)throw Error(at(93));a=a[0]}s=a}s==null&&(s=""),a=s}t._wrapperState={initialValue:Vo(a)}}function a3(t,s){var a=Vo(s.value),l=Vo(s.defaultValue);a!=null&&(a=""+a,a!==t.value&&(t.value=a),s.defaultValue==null&&t.defaultValue!==a&&(t.defaultValue=a)),l!=null&&(t.defaultValue=""+l)}function Uw(t){var s=t.textContent;s===t._wrapperState.initialValue&&s!==""&&s!==null&&(t.value=s)}function l3(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Gb(t,s){return t==null||t==="http://www.w3.org/1999/xhtml"?l3(s):t==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var vp,n3=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,a,l,n){MSApp.execUnsafeLocalFunction(function(){return t(s,a,l,n)})}:t}(function(t,s){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=s;else{for(vp=vp||document.createElement("div"),vp.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=vp.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;s.firstChild;)t.appendChild(s.firstChild)}});function bx(t,s){if(s){var a=t.firstChild;if(a&&a===t.lastChild&&a.nodeType===3){a.nodeValue=s;return}}t.textContent=s}var Xm={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},VM=["Webkit","ms","Moz","O"];Object.keys(Xm).forEach(function(t){VM.forEach(function(s){s=s+t.charAt(0).toUpperCase()+t.substring(1),Xm[s]=Xm[t]})});function r3(t,s,a){return s==null||typeof s=="boolean"||s===""?"":a||typeof s!="number"||s===0||Xm.hasOwnProperty(t)&&Xm[t]?(""+s).trim():s+"px"}function i3(t,s){t=t.style;for(var a in s)if(s.hasOwnProperty(a)){var l=a.indexOf("--")===0,n=r3(a,s[a],l);a==="float"&&(a="cssFloat"),l?t.setProperty(a,n):t[a]=n}}var _M=xa({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function qb(t,s){if(s){if(_M[t]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(at(137,t));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(at(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(at(61))}if(s.style!=null&&typeof s.style!="object")throw Error(at(62))}}function zb(t,s){if(t.indexOf("-")===-1)return typeof s.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wb=null;function Ey(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Hb=null,nu=null,ru=null;function Vw(t){if(t=tp(t)){if(typeof Hb!="function")throw Error(at(280));var s=t.stateNode;s&&(s=Sg(s),Hb(t.stateNode,t.type,s))}}function o3(t){nu?ru?ru.push(t):ru=[t]:nu=t}function d3(){if(nu){var t=nu,s=ru;if(ru=nu=null,Vw(t),s)for(t=0;t<s.length;t++)Vw(s[t])}}function c3(t,s){return t(s)}function u3(){}var Tf=!1;function m3(t,s,a){if(Tf)return t(s,a);Tf=!0;try{return c3(t,s,a)}finally{Tf=!1,(nu!==null||ru!==null)&&(u3(),d3())}}function jx(t,s){var a=t.stateNode;if(a===null)return null;var l=Sg(a);if(l===null)return null;a=l[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(t=t.type,l=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!l;break e;default:t=!1}if(t)return null;if(a&&typeof a!="function")throw Error(at(231,s,typeof a));return a}var Xb=!1;if(Pi)try{var qu={};Object.defineProperty(qu,"passive",{get:function(){Xb=!0}}),window.addEventListener("test",qu,qu),window.removeEventListener("test",qu,qu)}catch{Xb=!1}function BM(t,s,a,l,n,r,i,o,c){var x=Array.prototype.slice.call(arguments,3);try{s.apply(a,x)}catch(j){this.onError(j)}}var Km=!1,w0=null,k0=!1,Kb=null,GM={onError:function(t){Km=!0,w0=t}};function qM(t,s,a,l,n,r,i,o,c){Km=!1,w0=null,BM.apply(GM,arguments)}function zM(t,s,a,l,n,r,i,o,c){if(qM.apply(this,arguments),Km){if(Km){var x=w0;Km=!1,w0=null}else throw Error(at(198));k0||(k0=!0,Kb=x)}}function Xd(t){var s=t,a=t;if(t.alternate)for(;s.return;)s=s.return;else{t=s;do s=t,s.flags&4098&&(a=s.return),t=s.return;while(t)}return s.tag===3?a:null}function x3(t){if(t.tag===13){var s=t.memoizedState;if(s===null&&(t=t.alternate,t!==null&&(s=t.memoizedState)),s!==null)return s.dehydrated}return null}function _w(t){if(Xd(t)!==t)throw Error(at(188))}function WM(t){var s=t.alternate;if(!s){if(s=Xd(t),s===null)throw Error(at(188));return s!==t?null:t}for(var a=t,l=s;;){var n=a.return;if(n===null)break;var r=n.alternate;if(r===null){if(l=n.return,l!==null){a=l;continue}break}if(n.child===r.child){for(r=n.child;r;){if(r===a)return _w(n),t;if(r===l)return _w(n),s;r=r.sibling}throw Error(at(188))}if(a.return!==l.return)a=n,l=r;else{for(var i=!1,o=n.child;o;){if(o===a){i=!0,a=n,l=r;break}if(o===l){i=!0,l=n,a=r;break}o=o.sibling}if(!i){for(o=r.child;o;){if(o===a){i=!0,a=r,l=n;break}if(o===l){i=!0,l=r,a=n;break}o=o.sibling}if(!i)throw Error(at(189))}}if(a.alternate!==l)throw Error(at(190))}if(a.tag!==3)throw Error(at(188));return a.stateNode.current===a?t:s}function p3(t){return t=WM(t),t!==null?h3(t):null}function h3(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var s=h3(t);if(s!==null)return s;t=t.sibling}return null}var g3=In.unstable_scheduleCallback,Bw=In.unstable_cancelCallback,HM=In.unstable_shouldYield,XM=In.unstable_requestPaint,Ta=In.unstable_now,KM=In.unstable_getCurrentPriorityLevel,My=In.unstable_ImmediatePriority,f3=In.unstable_UserBlockingPriority,C0=In.unstable_NormalPriority,QM=In.unstable_LowPriority,v3=In.unstable_IdlePriority,Ng=null,Zr=null;function YM(t){if(Zr&&typeof Zr.onCommitFiberRoot=="function")try{Zr.onCommitFiberRoot(Ng,t,void 0,(t.current.flags&128)===128)}catch{}}var Sr=Math.clz32?Math.clz32:eP,JM=Math.log,ZM=Math.LN2;function eP(t){return t>>>=0,t===0?32:31-(JM(t)/ZM|0)|0}var bp=64,jp=4194304;function _m(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function S0(t,s){var a=t.pendingLanes;if(a===0)return 0;var l=0,n=t.suspendedLanes,r=t.pingedLanes,i=a&268435455;if(i!==0){var o=i&~n;o!==0?l=_m(o):(r&=i,r!==0&&(l=_m(r)))}else i=a&~n,i!==0?l=_m(i):r!==0&&(l=_m(r));if(l===0)return 0;if(s!==0&&s!==l&&!(s&n)&&(n=l&-l,r=s&-s,n>=r||n===16&&(r&4194240)!==0))return s;if(l&4&&(l|=a&16),s=t.entangledLanes,s!==0)for(t=t.entanglements,s&=l;0<s;)a=31-Sr(s),n=1<<a,l|=t[a],s&=~n;return l}function tP(t,s){switch(t){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sP(t,s){for(var a=t.suspendedLanes,l=t.pingedLanes,n=t.expirationTimes,r=t.pendingLanes;0<r;){var i=31-Sr(r),o=1<<i,c=n[i];c===-1?(!(o&a)||o&l)&&(n[i]=tP(o,s)):c<=s&&(t.expiredLanes|=o),r&=~o}}function Qb(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function b3(){var t=bp;return bp<<=1,!(bp&4194240)&&(bp=64),t}function Rf(t){for(var s=[],a=0;31>a;a++)s.push(t);return s}function Zx(t,s,a){t.pendingLanes|=s,s!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,s=31-Sr(s),t[s]=a}function aP(t,s){var a=t.pendingLanes&~s;t.pendingLanes=s,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=s,t.mutableReadLanes&=s,t.entangledLanes&=s,s=t.entanglements;var l=t.eventTimes;for(t=t.expirationTimes;0<a;){var n=31-Sr(a),r=1<<n;s[n]=0,l[n]=-1,t[n]=-1,a&=~r}}function Py(t,s){var a=t.entangledLanes|=s;for(t=t.entanglements;a;){var l=31-Sr(a),n=1<<l;n&s|t[l]&s&&(t[l]|=s),a&=~n}}var ws=0;function j3(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var y3,Oy,N3,w3,k3,Yb=!1,yp=[],Mo=null,Po=null,Oo=null,yx=new Map,Nx=new Map,fo=[],lP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Gw(t,s){switch(t){case"focusin":case"focusout":Mo=null;break;case"dragenter":case"dragleave":Po=null;break;case"mouseover":case"mouseout":Oo=null;break;case"pointerover":case"pointerout":yx.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nx.delete(s.pointerId)}}function zu(t,s,a,l,n,r){return t===null||t.nativeEvent!==r?(t={blockedOn:s,domEventName:a,eventSystemFlags:l,nativeEvent:r,targetContainers:[n]},s!==null&&(s=tp(s),s!==null&&Oy(s)),t):(t.eventSystemFlags|=l,s=t.targetContainers,n!==null&&s.indexOf(n)===-1&&s.push(n),t)}function nP(t,s,a,l,n){switch(s){case"focusin":return Mo=zu(Mo,t,s,a,l,n),!0;case"dragenter":return Po=zu(Po,t,s,a,l,n),!0;case"mouseover":return Oo=zu(Oo,t,s,a,l,n),!0;case"pointerover":var r=n.pointerId;return yx.set(r,zu(yx.get(r)||null,t,s,a,l,n)),!0;case"gotpointercapture":return r=n.pointerId,Nx.set(r,zu(Nx.get(r)||null,t,s,a,l,n)),!0}return!1}function C3(t){var s=Md(t.target);if(s!==null){var a=Xd(s);if(a!==null){if(s=a.tag,s===13){if(s=x3(a),s!==null){t.blockedOn=s,k3(t.priority,function(){N3(a)});return}}else if(s===3&&a.stateNode.current.memoizedState.isDehydrated){t.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Yh(t){if(t.blockedOn!==null)return!1;for(var s=t.targetContainers;0<s.length;){var a=Jb(t.domEventName,t.eventSystemFlags,s[0],t.nativeEvent);if(a===null){a=t.nativeEvent;var l=new a.constructor(a.type,a);Wb=l,a.target.dispatchEvent(l),Wb=null}else return s=tp(a),s!==null&&Oy(s),t.blockedOn=a,!1;s.shift()}return!0}function qw(t,s,a){Yh(t)&&a.delete(s)}function rP(){Yb=!1,Mo!==null&&Yh(Mo)&&(Mo=null),Po!==null&&Yh(Po)&&(Po=null),Oo!==null&&Yh(Oo)&&(Oo=null),yx.forEach(qw),Nx.forEach(qw)}function Wu(t,s){t.blockedOn===s&&(t.blockedOn=null,Yb||(Yb=!0,In.unstable_scheduleCallback(In.unstable_NormalPriority,rP)))}function wx(t){function s(n){return Wu(n,t)}if(0<yp.length){Wu(yp[0],t);for(var a=1;a<yp.length;a++){var l=yp[a];l.blockedOn===t&&(l.blockedOn=null)}}for(Mo!==null&&Wu(Mo,t),Po!==null&&Wu(Po,t),Oo!==null&&Wu(Oo,t),yx.forEach(s),Nx.forEach(s),a=0;a<fo.length;a++)l=fo[a],l.blockedOn===t&&(l.blockedOn=null);for(;0<fo.length&&(a=fo[0],a.blockedOn===null);)C3(a),a.blockedOn===null&&fo.shift()}var iu=Ui.ReactCurrentBatchConfig,A0=!0;function iP(t,s,a,l){var n=ws,r=iu.transition;iu.transition=null;try{ws=1,Ty(t,s,a,l)}finally{ws=n,iu.transition=r}}function oP(t,s,a,l){var n=ws,r=iu.transition;iu.transition=null;try{ws=4,Ty(t,s,a,l)}finally{ws=n,iu.transition=r}}function Ty(t,s,a,l){if(A0){var n=Jb(t,s,a,l);if(n===null)Gf(t,s,l,E0,a),Gw(t,l);else if(nP(n,t,s,a,l))l.stopPropagation();else if(Gw(t,l),s&4&&-1<lP.indexOf(t)){for(;n!==null;){var r=tp(n);if(r!==null&&y3(r),r=Jb(t,s,a,l),r===null&&Gf(t,s,l,E0,a),r===n)break;n=r}n!==null&&l.stopPropagation()}else Gf(t,s,l,null,a)}}var E0=null;function Jb(t,s,a,l){if(E0=null,t=Ey(l),t=Md(t),t!==null)if(s=Xd(t),s===null)t=null;else if(a=s.tag,a===13){if(t=x3(s),t!==null)return t;t=null}else if(a===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;t=null}else s!==t&&(t=null);return E0=t,null}function S3(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(KM()){case My:return 1;case f3:return 4;case C0:case QM:return 16;case v3:return 536870912;default:return 16}default:return 16}}var yo=null,Ry=null,Jh=null;function A3(){if(Jh)return Jh;var t,s=Ry,a=s.length,l,n="value"in yo?yo.value:yo.textContent,r=n.length;for(t=0;t<a&&s[t]===n[t];t++);var i=a-t;for(l=1;l<=i&&s[a-l]===n[r-l];l++);return Jh=n.slice(t,1<l?1-l:void 0)}function Zh(t){var s=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&s===13&&(t=13)):t=s,t===10&&(t=13),32<=t||t===13?t:0}function Np(){return!0}function zw(){return!1}function Fn(t){function s(a,l,n,r,i){this._reactName=a,this._targetInst=n,this.type=l,this.nativeEvent=r,this.target=i,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(a=t[o],this[o]=a?a(r):r[o]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?Np:zw,this.isPropagationStopped=zw,this}return xa(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=Np)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=Np)},persist:function(){},isPersistent:Np}),s}var Eu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Dy=Fn(Eu),ep=xa({},Eu,{view:0,detail:0}),dP=Fn(ep),Df,If,Hu,wg=xa({},ep,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Iy,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Hu&&(Hu&&t.type==="mousemove"?(Df=t.screenX-Hu.screenX,If=t.screenY-Hu.screenY):If=Df=0,Hu=t),Df)},movementY:function(t){return"movementY"in t?t.movementY:If}}),Ww=Fn(wg),cP=xa({},wg,{dataTransfer:0}),uP=Fn(cP),mP=xa({},ep,{relatedTarget:0}),$f=Fn(mP),xP=xa({},Eu,{animationName:0,elapsedTime:0,pseudoElement:0}),pP=Fn(xP),hP=xa({},Eu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),gP=Fn(hP),fP=xa({},Eu,{data:0}),Hw=Fn(fP),vP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yP(t){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(t):(t=jP[t])?!!s[t]:!1}function Iy(){return yP}var NP=xa({},ep,{key:function(t){if(t.key){var s=vP[t.key]||t.key;if(s!=="Unidentified")return s}return t.type==="keypress"?(t=Zh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?bP[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Iy,charCode:function(t){return t.type==="keypress"?Zh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Zh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),wP=Fn(NP),kP=xa({},wg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xw=Fn(kP),CP=xa({},ep,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Iy}),SP=Fn(CP),AP=xa({},Eu,{propertyName:0,elapsedTime:0,pseudoElement:0}),EP=Fn(AP),MP=xa({},wg,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),PP=Fn(MP),OP=[9,13,27,32],$y=Pi&&"CompositionEvent"in window,Qm=null;Pi&&"documentMode"in document&&(Qm=document.documentMode);var TP=Pi&&"TextEvent"in window&&!Qm,E3=Pi&&(!$y||Qm&&8<Qm&&11>=Qm),Kw=" ",Qw=!1;function M3(t,s){switch(t){case"keyup":return OP.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function P3(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Vc=!1;function RP(t,s){switch(t){case"compositionend":return P3(s);case"keypress":return s.which!==32?null:(Qw=!0,Kw);case"textInput":return t=s.data,t===Kw&&Qw?null:t;default:return null}}function DP(t,s){if(Vc)return t==="compositionend"||!$y&&M3(t,s)?(t=A3(),Jh=Ry=yo=null,Vc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return E3&&s.locale!=="ko"?null:s.data;default:return null}}var IP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Yw(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s==="input"?!!IP[t.type]:s==="textarea"}function O3(t,s,a,l){o3(l),s=M0(s,"onChange"),0<s.length&&(a=new Dy("onChange","change",null,a,l),t.push({event:a,listeners:s}))}var Ym=null,kx=null;function $P(t){B3(t,0)}function kg(t){var s=Gc(t);if(t3(s))return t}function LP(t,s){if(t==="change")return s}var T3=!1;if(Pi){var Lf;if(Pi){var Ff="oninput"in document;if(!Ff){var Jw=document.createElement("div");Jw.setAttribute("oninput","return;"),Ff=typeof Jw.oninput=="function"}Lf=Ff}else Lf=!1;T3=Lf&&(!document.documentMode||9<document.documentMode)}function Zw(){Ym&&(Ym.detachEvent("onpropertychange",R3),kx=Ym=null)}function R3(t){if(t.propertyName==="value"&&kg(kx)){var s=[];O3(s,kx,t,Ey(t)),m3($P,s)}}function FP(t,s,a){t==="focusin"?(Zw(),Ym=s,kx=a,Ym.attachEvent("onpropertychange",R3)):t==="focusout"&&Zw()}function UP(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return kg(kx)}function VP(t,s){if(t==="click")return kg(s)}function _P(t,s){if(t==="input"||t==="change")return kg(s)}function BP(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var Pr=typeof Object.is=="function"?Object.is:BP;function Cx(t,s){if(Pr(t,s))return!0;if(typeof t!="object"||t===null||typeof s!="object"||s===null)return!1;var a=Object.keys(t),l=Object.keys(s);if(a.length!==l.length)return!1;for(l=0;l<a.length;l++){var n=a[l];if(!Db.call(s,n)||!Pr(t[n],s[n]))return!1}return!0}function e2(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function t2(t,s){var a=e2(t);t=0;for(var l;a;){if(a.nodeType===3){if(l=t+a.textContent.length,t<=s&&l>=s)return{node:a,offset:s-t};t=l}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=e2(a)}}function D3(t,s){return t&&s?t===s?!0:t&&t.nodeType===3?!1:s&&s.nodeType===3?D3(t,s.parentNode):"contains"in t?t.contains(s):t.compareDocumentPosition?!!(t.compareDocumentPosition(s)&16):!1:!1}function I3(){for(var t=window,s=N0();s instanceof t.HTMLIFrameElement;){try{var a=typeof s.contentWindow.location.href=="string"}catch{a=!1}if(a)t=s.contentWindow;else break;s=N0(t.document)}return s}function Ly(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s&&(s==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||s==="textarea"||t.contentEditable==="true")}function GP(t){var s=I3(),a=t.focusedElem,l=t.selectionRange;if(s!==a&&a&&a.ownerDocument&&D3(a.ownerDocument.documentElement,a)){if(l!==null&&Ly(a)){if(s=l.start,t=l.end,t===void 0&&(t=s),"selectionStart"in a)a.selectionStart=s,a.selectionEnd=Math.min(t,a.value.length);else if(t=(s=a.ownerDocument||document)&&s.defaultView||window,t.getSelection){t=t.getSelection();var n=a.textContent.length,r=Math.min(l.start,n);l=l.end===void 0?r:Math.min(l.end,n),!t.extend&&r>l&&(n=l,l=r,r=n),n=t2(a,r);var i=t2(a,l);n&&i&&(t.rangeCount!==1||t.anchorNode!==n.node||t.anchorOffset!==n.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(s=s.createRange(),s.setStart(n.node,n.offset),t.removeAllRanges(),r>l?(t.addRange(s),t.extend(i.node,i.offset)):(s.setEnd(i.node,i.offset),t.addRange(s)))}}for(s=[],t=a;t=t.parentNode;)t.nodeType===1&&s.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<s.length;a++)t=s[a],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var qP=Pi&&"documentMode"in document&&11>=document.documentMode,_c=null,Zb=null,Jm=null,ej=!1;function s2(t,s,a){var l=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;ej||_c==null||_c!==N0(l)||(l=_c,"selectionStart"in l&&Ly(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),Jm&&Cx(Jm,l)||(Jm=l,l=M0(Zb,"onSelect"),0<l.length&&(s=new Dy("onSelect","select",null,s,a),t.push({event:s,listeners:l}),s.target=_c)))}function wp(t,s){var a={};return a[t.toLowerCase()]=s.toLowerCase(),a["Webkit"+t]="webkit"+s,a["Moz"+t]="moz"+s,a}var Bc={animationend:wp("Animation","AnimationEnd"),animationiteration:wp("Animation","AnimationIteration"),animationstart:wp("Animation","AnimationStart"),transitionend:wp("Transition","TransitionEnd")},Uf={},$3={};Pi&&($3=document.createElement("div").style,"AnimationEvent"in window||(delete Bc.animationend.animation,delete Bc.animationiteration.animation,delete Bc.animationstart.animation),"TransitionEvent"in window||delete Bc.transitionend.transition);function Cg(t){if(Uf[t])return Uf[t];if(!Bc[t])return t;var s=Bc[t],a;for(a in s)if(s.hasOwnProperty(a)&&a in $3)return Uf[t]=s[a];return t}var L3=Cg("animationend"),F3=Cg("animationiteration"),U3=Cg("animationstart"),V3=Cg("transitionend"),_3=new Map,a2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zo(t,s){_3.set(t,s),Hd(s,[t])}for(var Vf=0;Vf<a2.length;Vf++){var _f=a2[Vf],zP=_f.toLowerCase(),WP=_f[0].toUpperCase()+_f.slice(1);zo(zP,"on"+WP)}zo(L3,"onAnimationEnd");zo(F3,"onAnimationIteration");zo(U3,"onAnimationStart");zo("dblclick","onDoubleClick");zo("focusin","onFocus");zo("focusout","onBlur");zo(V3,"onTransitionEnd");pu("onMouseEnter",["mouseout","mouseover"]);pu("onMouseLeave",["mouseout","mouseover"]);pu("onPointerEnter",["pointerout","pointerover"]);pu("onPointerLeave",["pointerout","pointerover"]);Hd("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Hd("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Hd("onBeforeInput",["compositionend","keypress","textInput","paste"]);Hd("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Hd("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Hd("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),HP=new Set("cancel close invalid load scroll toggle".split(" ").concat(Bm));function l2(t,s,a){var l=t.type||"unknown-event";t.currentTarget=a,zM(l,s,void 0,t),t.currentTarget=null}function B3(t,s){s=(s&4)!==0;for(var a=0;a<t.length;a++){var l=t[a],n=l.event;l=l.listeners;e:{var r=void 0;if(s)for(var i=l.length-1;0<=i;i--){var o=l[i],c=o.instance,x=o.currentTarget;if(o=o.listener,c!==r&&n.isPropagationStopped())break e;l2(n,o,x),r=c}else for(i=0;i<l.length;i++){if(o=l[i],c=o.instance,x=o.currentTarget,o=o.listener,c!==r&&n.isPropagationStopped())break e;l2(n,o,x),r=c}}}if(k0)throw t=Kb,k0=!1,Kb=null,t}function Gs(t,s){var a=s[nj];a===void 0&&(a=s[nj]=new Set);var l=t+"__bubble";a.has(l)||(G3(s,t,2,!1),a.add(l))}function Bf(t,s,a){var l=0;s&&(l|=4),G3(a,t,l,s)}var kp="_reactListening"+Math.random().toString(36).slice(2);function Sx(t){if(!t[kp]){t[kp]=!0,QC.forEach(function(a){a!=="selectionchange"&&(HP.has(a)||Bf(a,!1,t),Bf(a,!0,t))});var s=t.nodeType===9?t:t.ownerDocument;s===null||s[kp]||(s[kp]=!0,Bf("selectionchange",!1,s))}}function G3(t,s,a,l){switch(S3(s)){case 1:var n=iP;break;case 4:n=oP;break;default:n=Ty}a=n.bind(null,s,a,t),n=void 0,!Xb||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(n=!0),l?n!==void 0?t.addEventListener(s,a,{capture:!0,passive:n}):t.addEventListener(s,a,!0):n!==void 0?t.addEventListener(s,a,{passive:n}):t.addEventListener(s,a,!1)}function Gf(t,s,a,l,n){var r=l;if(!(s&1)&&!(s&2)&&l!==null)e:for(;;){if(l===null)return;var i=l.tag;if(i===3||i===4){var o=l.stateNode.containerInfo;if(o===n||o.nodeType===8&&o.parentNode===n)break;if(i===4)for(i=l.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===n||c.nodeType===8&&c.parentNode===n))return;i=i.return}for(;o!==null;){if(i=Md(o),i===null)return;if(c=i.tag,c===5||c===6){l=r=i;continue e}o=o.parentNode}}l=l.return}m3(function(){var x=r,j=Ey(a),g=[];e:{var y=_3.get(t);if(y!==void 0){var $=Dy,T=t;switch(t){case"keypress":if(Zh(a)===0)break e;case"keydown":case"keyup":$=wP;break;case"focusin":T="focus",$=$f;break;case"focusout":T="blur",$=$f;break;case"beforeblur":case"afterblur":$=$f;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":$=Ww;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":$=uP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":$=SP;break;case L3:case F3:case U3:$=pP;break;case V3:$=EP;break;case"scroll":$=dP;break;case"wheel":$=PP;break;case"copy":case"cut":case"paste":$=gP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":$=Xw}var C=(s&4)!==0,W=!C&&t==="scroll",L=C?y!==null?y+"Capture":null:y;C=[];for(var R=x,F;R!==null;){F=R;var te=F.stateNode;if(F.tag===5&&te!==null&&(F=te,L!==null&&(te=jx(R,L),te!=null&&C.push(Ax(R,te,F)))),W)break;R=R.return}0<C.length&&(y=new $(y,T,null,a,j),g.push({event:y,listeners:C}))}}if(!(s&7)){e:{if(y=t==="mouseover"||t==="pointerover",$=t==="mouseout"||t==="pointerout",y&&a!==Wb&&(T=a.relatedTarget||a.fromElement)&&(Md(T)||T[Oi]))break e;if(($||y)&&(y=j.window===j?j:(y=j.ownerDocument)?y.defaultView||y.parentWindow:window,$?(T=a.relatedTarget||a.toElement,$=x,T=T?Md(T):null,T!==null&&(W=Xd(T),T!==W||T.tag!==5&&T.tag!==6)&&(T=null)):($=null,T=x),$!==T)){if(C=Ww,te="onMouseLeave",L="onMouseEnter",R="mouse",(t==="pointerout"||t==="pointerover")&&(C=Xw,te="onPointerLeave",L="onPointerEnter",R="pointer"),W=$==null?y:Gc($),F=T==null?y:Gc(T),y=new C(te,R+"leave",$,a,j),y.target=W,y.relatedTarget=F,te=null,Md(j)===x&&(C=new C(L,R+"enter",T,a,j),C.target=F,C.relatedTarget=W,te=C),W=te,$&&T)t:{for(C=$,L=T,R=0,F=C;F;F=Jd(F))R++;for(F=0,te=L;te;te=Jd(te))F++;for(;0<R-F;)C=Jd(C),R--;for(;0<F-R;)L=Jd(L),F--;for(;R--;){if(C===L||L!==null&&C===L.alternate)break t;C=Jd(C),L=Jd(L)}C=null}else C=null;$!==null&&n2(g,y,$,C,!1),T!==null&&W!==null&&n2(g,W,T,C,!0)}}e:{if(y=x?Gc(x):window,$=y.nodeName&&y.nodeName.toLowerCase(),$==="select"||$==="input"&&y.type==="file")var oe=LP;else if(Yw(y))if(T3)oe=_P;else{oe=UP;var G=FP}else($=y.nodeName)&&$.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(oe=VP);if(oe&&(oe=oe(t,x))){O3(g,oe,a,j);break e}G&&G(t,y,x),t==="focusout"&&(G=y._wrapperState)&&G.controlled&&y.type==="number"&&_b(y,"number",y.value)}switch(G=x?Gc(x):window,t){case"focusin":(Yw(G)||G.contentEditable==="true")&&(_c=G,Zb=x,Jm=null);break;case"focusout":Jm=Zb=_c=null;break;case"mousedown":ej=!0;break;case"contextmenu":case"mouseup":case"dragend":ej=!1,s2(g,a,j);break;case"selectionchange":if(qP)break;case"keydown":case"keyup":s2(g,a,j)}var H;if($y)e:{switch(t){case"compositionstart":var Y="onCompositionStart";break e;case"compositionend":Y="onCompositionEnd";break e;case"compositionupdate":Y="onCompositionUpdate";break e}Y=void 0}else Vc?M3(t,a)&&(Y="onCompositionEnd"):t==="keydown"&&a.keyCode===229&&(Y="onCompositionStart");Y&&(E3&&a.locale!=="ko"&&(Vc||Y!=="onCompositionStart"?Y==="onCompositionEnd"&&Vc&&(H=A3()):(yo=j,Ry="value"in yo?yo.value:yo.textContent,Vc=!0)),G=M0(x,Y),0<G.length&&(Y=new Hw(Y,t,null,a,j),g.push({event:Y,listeners:G}),H?Y.data=H:(H=P3(a),H!==null&&(Y.data=H)))),(H=TP?RP(t,a):DP(t,a))&&(x=M0(x,"onBeforeInput"),0<x.length&&(j=new Hw("onBeforeInput","beforeinput",null,a,j),g.push({event:j,listeners:x}),j.data=H))}B3(g,s)})}function Ax(t,s,a){return{instance:t,listener:s,currentTarget:a}}function M0(t,s){for(var a=s+"Capture",l=[];t!==null;){var n=t,r=n.stateNode;n.tag===5&&r!==null&&(n=r,r=jx(t,a),r!=null&&l.unshift(Ax(t,r,n)),r=jx(t,s),r!=null&&l.push(Ax(t,r,n))),t=t.return}return l}function Jd(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function n2(t,s,a,l,n){for(var r=s._reactName,i=[];a!==null&&a!==l;){var o=a,c=o.alternate,x=o.stateNode;if(c!==null&&c===l)break;o.tag===5&&x!==null&&(o=x,n?(c=jx(a,r),c!=null&&i.unshift(Ax(a,c,o))):n||(c=jx(a,r),c!=null&&i.push(Ax(a,c,o)))),a=a.return}i.length!==0&&t.push({event:s,listeners:i})}var XP=/\r\n?/g,KP=/\u0000|\uFFFD/g;function r2(t){return(typeof t=="string"?t:""+t).replace(XP,`
`).replace(KP,"")}function Cp(t,s,a){if(s=r2(s),r2(t)!==s&&a)throw Error(at(425))}function P0(){}var tj=null,sj=null;function aj(t,s){return t==="textarea"||t==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var lj=typeof setTimeout=="function"?setTimeout:void 0,QP=typeof clearTimeout=="function"?clearTimeout:void 0,i2=typeof Promise=="function"?Promise:void 0,YP=typeof queueMicrotask=="function"?queueMicrotask:typeof i2<"u"?function(t){return i2.resolve(null).then(t).catch(JP)}:lj;function JP(t){setTimeout(function(){throw t})}function qf(t,s){var a=s,l=0;do{var n=a.nextSibling;if(t.removeChild(a),n&&n.nodeType===8)if(a=n.data,a==="/$"){if(l===0){t.removeChild(n),wx(s);return}l--}else a!=="$"&&a!=="$?"&&a!=="$!"||l++;a=n}while(a);wx(s)}function To(t){for(;t!=null;t=t.nextSibling){var s=t.nodeType;if(s===1||s===3)break;if(s===8){if(s=t.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return t}function o2(t){t=t.previousSibling;for(var s=0;t;){if(t.nodeType===8){var a=t.data;if(a==="$"||a==="$!"||a==="$?"){if(s===0)return t;s--}else a==="/$"&&s++}t=t.previousSibling}return null}var Mu=Math.random().toString(36).slice(2),Yr="__reactFiber$"+Mu,Ex="__reactProps$"+Mu,Oi="__reactContainer$"+Mu,nj="__reactEvents$"+Mu,ZP="__reactListeners$"+Mu,e6="__reactHandles$"+Mu;function Md(t){var s=t[Yr];if(s)return s;for(var a=t.parentNode;a;){if(s=a[Oi]||a[Yr]){if(a=s.alternate,s.child!==null||a!==null&&a.child!==null)for(t=o2(t);t!==null;){if(a=t[Yr])return a;t=o2(t)}return s}t=a,a=t.parentNode}return null}function tp(t){return t=t[Yr]||t[Oi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Gc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(at(33))}function Sg(t){return t[Ex]||null}var rj=[],qc=-1;function Wo(t){return{current:t}}function Ks(t){0>qc||(t.current=rj[qc],rj[qc]=null,qc--)}function Us(t,s){qc++,rj[qc]=t.current,t.current=s}var _o={},Fl=Wo(_o),xn=Wo(!1),Vd=_o;function hu(t,s){var a=t.type.contextTypes;if(!a)return _o;var l=t.stateNode;if(l&&l.__reactInternalMemoizedUnmaskedChildContext===s)return l.__reactInternalMemoizedMaskedChildContext;var n={},r;for(r in a)n[r]=s[r];return l&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=n),n}function pn(t){return t=t.childContextTypes,t!=null}function O0(){Ks(xn),Ks(Fl)}function d2(t,s,a){if(Fl.current!==_o)throw Error(at(168));Us(Fl,s),Us(xn,a)}function q3(t,s,a){var l=t.stateNode;if(s=s.childContextTypes,typeof l.getChildContext!="function")return a;l=l.getChildContext();for(var n in l)if(!(n in s))throw Error(at(108,FM(t)||"Unknown",n));return xa({},a,l)}function T0(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||_o,Vd=Fl.current,Us(Fl,t),Us(xn,xn.current),!0}function c2(t,s,a){var l=t.stateNode;if(!l)throw Error(at(169));a?(t=q3(t,s,Vd),l.__reactInternalMemoizedMergedChildContext=t,Ks(xn),Ks(Fl),Us(Fl,t)):Ks(xn),Us(xn,a)}var ji=null,Ag=!1,zf=!1;function z3(t){ji===null?ji=[t]:ji.push(t)}function t6(t){Ag=!0,z3(t)}function Ho(){if(!zf&&ji!==null){zf=!0;var t=0,s=ws;try{var a=ji;for(ws=1;t<a.length;t++){var l=a[t];do l=l(!0);while(l!==null)}ji=null,Ag=!1}catch(n){throw ji!==null&&(ji=ji.slice(t+1)),g3(My,Ho),n}finally{ws=s,zf=!1}}return null}var zc=[],Wc=0,R0=null,D0=0,Yn=[],Jn=0,_d=null,ki=1,Ci="";function jd(t,s){zc[Wc++]=D0,zc[Wc++]=R0,R0=t,D0=s}function W3(t,s,a){Yn[Jn++]=ki,Yn[Jn++]=Ci,Yn[Jn++]=_d,_d=t;var l=ki;t=Ci;var n=32-Sr(l)-1;l&=~(1<<n),a+=1;var r=32-Sr(s)+n;if(30<r){var i=n-n%5;r=(l&(1<<i)-1).toString(32),l>>=i,n-=i,ki=1<<32-Sr(s)+n|a<<n|l,Ci=r+t}else ki=1<<r|a<<n|l,Ci=t}function Fy(t){t.return!==null&&(jd(t,1),W3(t,1,0))}function Uy(t){for(;t===R0;)R0=zc[--Wc],zc[Wc]=null,D0=zc[--Wc],zc[Wc]=null;for(;t===_d;)_d=Yn[--Jn],Yn[Jn]=null,Ci=Yn[--Jn],Yn[Jn]=null,ki=Yn[--Jn],Yn[Jn]=null}var On=null,Pn=null,ra=!1,yr=null;function H3(t,s){var a=er(5,null,null,0);a.elementType="DELETED",a.stateNode=s,a.return=t,s=t.deletions,s===null?(t.deletions=[a],t.flags|=16):s.push(a)}function u2(t,s){switch(t.tag){case 5:var a=t.type;return s=s.nodeType!==1||a.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(t.stateNode=s,On=t,Pn=To(s.firstChild),!0):!1;case 6:return s=t.pendingProps===""||s.nodeType!==3?null:s,s!==null?(t.stateNode=s,On=t,Pn=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(a=_d!==null?{id:ki,overflow:Ci}:null,t.memoizedState={dehydrated:s,treeContext:a,retryLane:1073741824},a=er(18,null,null,0),a.stateNode=s,a.return=t,t.child=a,On=t,Pn=null,!0):!1;default:return!1}}function ij(t){return(t.mode&1)!==0&&(t.flags&128)===0}function oj(t){if(ra){var s=Pn;if(s){var a=s;if(!u2(t,s)){if(ij(t))throw Error(at(418));s=To(a.nextSibling);var l=On;s&&u2(t,s)?H3(l,a):(t.flags=t.flags&-4097|2,ra=!1,On=t)}}else{if(ij(t))throw Error(at(418));t.flags=t.flags&-4097|2,ra=!1,On=t}}}function m2(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;On=t}function Sp(t){if(t!==On)return!1;if(!ra)return m2(t),ra=!0,!1;var s;if((s=t.tag!==3)&&!(s=t.tag!==5)&&(s=t.type,s=s!=="head"&&s!=="body"&&!aj(t.type,t.memoizedProps)),s&&(s=Pn)){if(ij(t))throw X3(),Error(at(418));for(;s;)H3(t,s),s=To(s.nextSibling)}if(m2(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(at(317));e:{for(t=t.nextSibling,s=0;t;){if(t.nodeType===8){var a=t.data;if(a==="/$"){if(s===0){Pn=To(t.nextSibling);break e}s--}else a!=="$"&&a!=="$!"&&a!=="$?"||s++}t=t.nextSibling}Pn=null}}else Pn=On?To(t.stateNode.nextSibling):null;return!0}function X3(){for(var t=Pn;t;)t=To(t.nextSibling)}function gu(){Pn=On=null,ra=!1}function Vy(t){yr===null?yr=[t]:yr.push(t)}var s6=Ui.ReactCurrentBatchConfig;function Xu(t,s,a){if(t=a.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(at(309));var l=a.stateNode}if(!l)throw Error(at(147,t));var n=l,r=""+t;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===r?s.ref:(s=function(i){var o=n.refs;i===null?delete o[r]:o[r]=i},s._stringRef=r,s)}if(typeof t!="string")throw Error(at(284));if(!a._owner)throw Error(at(290,t))}return t}function Ap(t,s){throw t=Object.prototype.toString.call(s),Error(at(31,t==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":t))}function x2(t){var s=t._init;return s(t._payload)}function K3(t){function s(L,R){if(t){var F=L.deletions;F===null?(L.deletions=[R],L.flags|=16):F.push(R)}}function a(L,R){if(!t)return null;for(;R!==null;)s(L,R),R=R.sibling;return null}function l(L,R){for(L=new Map;R!==null;)R.key!==null?L.set(R.key,R):L.set(R.index,R),R=R.sibling;return L}function n(L,R){return L=$o(L,R),L.index=0,L.sibling=null,L}function r(L,R,F){return L.index=F,t?(F=L.alternate,F!==null?(F=F.index,F<R?(L.flags|=2,R):F):(L.flags|=2,R)):(L.flags|=1048576,R)}function i(L){return t&&L.alternate===null&&(L.flags|=2),L}function o(L,R,F,te){return R===null||R.tag!==6?(R=Jf(F,L.mode,te),R.return=L,R):(R=n(R,F),R.return=L,R)}function c(L,R,F,te){var oe=F.type;return oe===Uc?j(L,R,F.props.children,te,F.key):R!==null&&(R.elementType===oe||typeof oe=="object"&&oe!==null&&oe.$$typeof===po&&x2(oe)===R.type)?(te=n(R,F.props),te.ref=Xu(L,R,F),te.return=L,te):(te=r0(F.type,F.key,F.props,null,L.mode,te),te.ref=Xu(L,R,F),te.return=L,te)}function x(L,R,F,te){return R===null||R.tag!==4||R.stateNode.containerInfo!==F.containerInfo||R.stateNode.implementation!==F.implementation?(R=Zf(F,L.mode,te),R.return=L,R):(R=n(R,F.children||[]),R.return=L,R)}function j(L,R,F,te,oe){return R===null||R.tag!==7?(R=$d(F,L.mode,te,oe),R.return=L,R):(R=n(R,F),R.return=L,R)}function g(L,R,F){if(typeof R=="string"&&R!==""||typeof R=="number")return R=Jf(""+R,L.mode,F),R.return=L,R;if(typeof R=="object"&&R!==null){switch(R.$$typeof){case gp:return F=r0(R.type,R.key,R.props,null,L.mode,F),F.ref=Xu(L,null,R),F.return=L,F;case Fc:return R=Zf(R,L.mode,F),R.return=L,R;case po:var te=R._init;return g(L,te(R._payload),F)}if(Vm(R)||Gu(R))return R=$d(R,L.mode,F,null),R.return=L,R;Ap(L,R)}return null}function y(L,R,F,te){var oe=R!==null?R.key:null;if(typeof F=="string"&&F!==""||typeof F=="number")return oe!==null?null:o(L,R,""+F,te);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case gp:return F.key===oe?c(L,R,F,te):null;case Fc:return F.key===oe?x(L,R,F,te):null;case po:return oe=F._init,y(L,R,oe(F._payload),te)}if(Vm(F)||Gu(F))return oe!==null?null:j(L,R,F,te,null);Ap(L,F)}return null}function $(L,R,F,te,oe){if(typeof te=="string"&&te!==""||typeof te=="number")return L=L.get(F)||null,o(R,L,""+te,oe);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case gp:return L=L.get(te.key===null?F:te.key)||null,c(R,L,te,oe);case Fc:return L=L.get(te.key===null?F:te.key)||null,x(R,L,te,oe);case po:var G=te._init;return $(L,R,F,G(te._payload),oe)}if(Vm(te)||Gu(te))return L=L.get(F)||null,j(R,L,te,oe,null);Ap(R,te)}return null}function T(L,R,F,te){for(var oe=null,G=null,H=R,Y=R=0,we=null;H!==null&&Y<F.length;Y++){H.index>Y?(we=H,H=null):we=H.sibling;var q=y(L,H,F[Y],te);if(q===null){H===null&&(H=we);break}t&&H&&q.alternate===null&&s(L,H),R=r(q,R,Y),G===null?oe=q:G.sibling=q,G=q,H=we}if(Y===F.length)return a(L,H),ra&&jd(L,Y),oe;if(H===null){for(;Y<F.length;Y++)H=g(L,F[Y],te),H!==null&&(R=r(H,R,Y),G===null?oe=H:G.sibling=H,G=H);return ra&&jd(L,Y),oe}for(H=l(L,H);Y<F.length;Y++)we=$(H,L,Y,F[Y],te),we!==null&&(t&&we.alternate!==null&&H.delete(we.key===null?Y:we.key),R=r(we,R,Y),G===null?oe=we:G.sibling=we,G=we);return t&&H.forEach(function(je){return s(L,je)}),ra&&jd(L,Y),oe}function C(L,R,F,te){var oe=Gu(F);if(typeof oe!="function")throw Error(at(150));if(F=oe.call(F),F==null)throw Error(at(151));for(var G=oe=null,H=R,Y=R=0,we=null,q=F.next();H!==null&&!q.done;Y++,q=F.next()){H.index>Y?(we=H,H=null):we=H.sibling;var je=y(L,H,q.value,te);if(je===null){H===null&&(H=we);break}t&&H&&je.alternate===null&&s(L,H),R=r(je,R,Y),G===null?oe=je:G.sibling=je,G=je,H=we}if(q.done)return a(L,H),ra&&jd(L,Y),oe;if(H===null){for(;!q.done;Y++,q=F.next())q=g(L,q.value,te),q!==null&&(R=r(q,R,Y),G===null?oe=q:G.sibling=q,G=q);return ra&&jd(L,Y),oe}for(H=l(L,H);!q.done;Y++,q=F.next())q=$(H,L,Y,q.value,te),q!==null&&(t&&q.alternate!==null&&H.delete(q.key===null?Y:q.key),R=r(q,R,Y),G===null?oe=q:G.sibling=q,G=q);return t&&H.forEach(function(_e){return s(L,_e)}),ra&&jd(L,Y),oe}function W(L,R,F,te){if(typeof F=="object"&&F!==null&&F.type===Uc&&F.key===null&&(F=F.props.children),typeof F=="object"&&F!==null){switch(F.$$typeof){case gp:e:{for(var oe=F.key,G=R;G!==null;){if(G.key===oe){if(oe=F.type,oe===Uc){if(G.tag===7){a(L,G.sibling),R=n(G,F.props.children),R.return=L,L=R;break e}}else if(G.elementType===oe||typeof oe=="object"&&oe!==null&&oe.$$typeof===po&&x2(oe)===G.type){a(L,G.sibling),R=n(G,F.props),R.ref=Xu(L,G,F),R.return=L,L=R;break e}a(L,G);break}else s(L,G);G=G.sibling}F.type===Uc?(R=$d(F.props.children,L.mode,te,F.key),R.return=L,L=R):(te=r0(F.type,F.key,F.props,null,L.mode,te),te.ref=Xu(L,R,F),te.return=L,L=te)}return i(L);case Fc:e:{for(G=F.key;R!==null;){if(R.key===G)if(R.tag===4&&R.stateNode.containerInfo===F.containerInfo&&R.stateNode.implementation===F.implementation){a(L,R.sibling),R=n(R,F.children||[]),R.return=L,L=R;break e}else{a(L,R);break}else s(L,R);R=R.sibling}R=Zf(F,L.mode,te),R.return=L,L=R}return i(L);case po:return G=F._init,W(L,R,G(F._payload),te)}if(Vm(F))return T(L,R,F,te);if(Gu(F))return C(L,R,F,te);Ap(L,F)}return typeof F=="string"&&F!==""||typeof F=="number"?(F=""+F,R!==null&&R.tag===6?(a(L,R.sibling),R=n(R,F),R.return=L,L=R):(a(L,R),R=Jf(F,L.mode,te),R.return=L,L=R),i(L)):a(L,R)}return W}var fu=K3(!0),Q3=K3(!1),I0=Wo(null),$0=null,Hc=null,_y=null;function By(){_y=Hc=$0=null}function Gy(t){var s=I0.current;Ks(I0),t._currentValue=s}function dj(t,s,a){for(;t!==null;){var l=t.alternate;if((t.childLanes&s)!==s?(t.childLanes|=s,l!==null&&(l.childLanes|=s)):l!==null&&(l.childLanes&s)!==s&&(l.childLanes|=s),t===a)break;t=t.return}}function ou(t,s){$0=t,_y=Hc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&s&&(mn=!0),t.firstContext=null)}function sr(t){var s=t._currentValue;if(_y!==t)if(t={context:t,memoizedValue:s,next:null},Hc===null){if($0===null)throw Error(at(308));Hc=t,$0.dependencies={lanes:0,firstContext:t}}else Hc=Hc.next=t;return s}var Pd=null;function qy(t){Pd===null?Pd=[t]:Pd.push(t)}function Y3(t,s,a,l){var n=s.interleaved;return n===null?(a.next=a,qy(s)):(a.next=n.next,n.next=a),s.interleaved=a,Ti(t,l)}function Ti(t,s){t.lanes|=s;var a=t.alternate;for(a!==null&&(a.lanes|=s),a=t,t=t.return;t!==null;)t.childLanes|=s,a=t.alternate,a!==null&&(a.childLanes|=s),a=t,t=t.return;return a.tag===3?a.stateNode:null}var ho=!1;function zy(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function J3(t,s){t=t.updateQueue,s.updateQueue===t&&(s.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ai(t,s){return{eventTime:t,lane:s,tag:0,payload:null,callback:null,next:null}}function Ro(t,s,a){var l=t.updateQueue;if(l===null)return null;if(l=l.shared,os&2){var n=l.pending;return n===null?s.next=s:(s.next=n.next,n.next=s),l.pending=s,Ti(t,a)}return n=l.interleaved,n===null?(s.next=s,qy(l)):(s.next=n.next,n.next=s),l.interleaved=s,Ti(t,a)}function e0(t,s,a){if(s=s.updateQueue,s!==null&&(s=s.shared,(a&4194240)!==0)){var l=s.lanes;l&=t.pendingLanes,a|=l,s.lanes=a,Py(t,a)}}function p2(t,s){var a=t.updateQueue,l=t.alternate;if(l!==null&&(l=l.updateQueue,a===l)){var n=null,r=null;if(a=a.firstBaseUpdate,a!==null){do{var i={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};r===null?n=r=i:r=r.next=i,a=a.next}while(a!==null);r===null?n=r=s:r=r.next=s}else n=r=s;a={baseState:l.baseState,firstBaseUpdate:n,lastBaseUpdate:r,shared:l.shared,effects:l.effects},t.updateQueue=a;return}t=a.lastBaseUpdate,t===null?a.firstBaseUpdate=s:t.next=s,a.lastBaseUpdate=s}function L0(t,s,a,l){var n=t.updateQueue;ho=!1;var r=n.firstBaseUpdate,i=n.lastBaseUpdate,o=n.shared.pending;if(o!==null){n.shared.pending=null;var c=o,x=c.next;c.next=null,i===null?r=x:i.next=x,i=c;var j=t.alternate;j!==null&&(j=j.updateQueue,o=j.lastBaseUpdate,o!==i&&(o===null?j.firstBaseUpdate=x:o.next=x,j.lastBaseUpdate=c))}if(r!==null){var g=n.baseState;i=0,j=x=c=null,o=r;do{var y=o.lane,$=o.eventTime;if((l&y)===y){j!==null&&(j=j.next={eventTime:$,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var T=t,C=o;switch(y=s,$=a,C.tag){case 1:if(T=C.payload,typeof T=="function"){g=T.call($,g,y);break e}g=T;break e;case 3:T.flags=T.flags&-65537|128;case 0:if(T=C.payload,y=typeof T=="function"?T.call($,g,y):T,y==null)break e;g=xa({},g,y);break e;case 2:ho=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,y=n.effects,y===null?n.effects=[o]:y.push(o))}else $={eventTime:$,lane:y,tag:o.tag,payload:o.payload,callback:o.callback,next:null},j===null?(x=j=$,c=g):j=j.next=$,i|=y;if(o=o.next,o===null){if(o=n.shared.pending,o===null)break;y=o,o=y.next,y.next=null,n.lastBaseUpdate=y,n.shared.pending=null}}while(!0);if(j===null&&(c=g),n.baseState=c,n.firstBaseUpdate=x,n.lastBaseUpdate=j,s=n.shared.interleaved,s!==null){n=s;do i|=n.lane,n=n.next;while(n!==s)}else r===null&&(n.shared.lanes=0);Gd|=i,t.lanes=i,t.memoizedState=g}}function h2(t,s,a){if(t=s.effects,s.effects=null,t!==null)for(s=0;s<t.length;s++){var l=t[s],n=l.callback;if(n!==null){if(l.callback=null,l=a,typeof n!="function")throw Error(at(191,n));n.call(l)}}}var sp={},ei=Wo(sp),Mx=Wo(sp),Px=Wo(sp);function Od(t){if(t===sp)throw Error(at(174));return t}function Wy(t,s){switch(Us(Px,s),Us(Mx,t),Us(ei,sp),t=s.nodeType,t){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:Gb(null,"");break;default:t=t===8?s.parentNode:s,s=t.namespaceURI||null,t=t.tagName,s=Gb(s,t)}Ks(ei),Us(ei,s)}function vu(){Ks(ei),Ks(Mx),Ks(Px)}function Z3(t){Od(Px.current);var s=Od(ei.current),a=Gb(s,t.type);s!==a&&(Us(Mx,t),Us(ei,a))}function Hy(t){Mx.current===t&&(Ks(ei),Ks(Mx))}var da=Wo(0);function F0(t){for(var s=t;s!==null;){if(s.tag===13){var a=s.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Wf=[];function Xy(){for(var t=0;t<Wf.length;t++)Wf[t]._workInProgressVersionPrimary=null;Wf.length=0}var t0=Ui.ReactCurrentDispatcher,Hf=Ui.ReactCurrentBatchConfig,Bd=0,ma=null,tl=null,xl=null,U0=!1,Zm=!1,Ox=0,a6=0;function El(){throw Error(at(321))}function Ky(t,s){if(s===null)return!1;for(var a=0;a<s.length&&a<t.length;a++)if(!Pr(t[a],s[a]))return!1;return!0}function Qy(t,s,a,l,n,r){if(Bd=r,ma=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,t0.current=t===null||t.memoizedState===null?i6:o6,t=a(l,n),Zm){r=0;do{if(Zm=!1,Ox=0,25<=r)throw Error(at(301));r+=1,xl=tl=null,s.updateQueue=null,t0.current=d6,t=a(l,n)}while(Zm)}if(t0.current=V0,s=tl!==null&&tl.next!==null,Bd=0,xl=tl=ma=null,U0=!1,s)throw Error(at(300));return t}function Yy(){var t=Ox!==0;return Ox=0,t}function Hr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xl===null?ma.memoizedState=xl=t:xl=xl.next=t,xl}function ar(){if(tl===null){var t=ma.alternate;t=t!==null?t.memoizedState:null}else t=tl.next;var s=xl===null?ma.memoizedState:xl.next;if(s!==null)xl=s,tl=t;else{if(t===null)throw Error(at(310));tl=t,t={memoizedState:tl.memoizedState,baseState:tl.baseState,baseQueue:tl.baseQueue,queue:tl.queue,next:null},xl===null?ma.memoizedState=xl=t:xl=xl.next=t}return xl}function Tx(t,s){return typeof s=="function"?s(t):s}function Xf(t){var s=ar(),a=s.queue;if(a===null)throw Error(at(311));a.lastRenderedReducer=t;var l=tl,n=l.baseQueue,r=a.pending;if(r!==null){if(n!==null){var i=n.next;n.next=r.next,r.next=i}l.baseQueue=n=r,a.pending=null}if(n!==null){r=n.next,l=l.baseState;var o=i=null,c=null,x=r;do{var j=x.lane;if((Bd&j)===j)c!==null&&(c=c.next={lane:0,action:x.action,hasEagerState:x.hasEagerState,eagerState:x.eagerState,next:null}),l=x.hasEagerState?x.eagerState:t(l,x.action);else{var g={lane:j,action:x.action,hasEagerState:x.hasEagerState,eagerState:x.eagerState,next:null};c===null?(o=c=g,i=l):c=c.next=g,ma.lanes|=j,Gd|=j}x=x.next}while(x!==null&&x!==r);c===null?i=l:c.next=o,Pr(l,s.memoizedState)||(mn=!0),s.memoizedState=l,s.baseState=i,s.baseQueue=c,a.lastRenderedState=l}if(t=a.interleaved,t!==null){n=t;do r=n.lane,ma.lanes|=r,Gd|=r,n=n.next;while(n!==t)}else n===null&&(a.lanes=0);return[s.memoizedState,a.dispatch]}function Kf(t){var s=ar(),a=s.queue;if(a===null)throw Error(at(311));a.lastRenderedReducer=t;var l=a.dispatch,n=a.pending,r=s.memoizedState;if(n!==null){a.pending=null;var i=n=n.next;do r=t(r,i.action),i=i.next;while(i!==n);Pr(r,s.memoizedState)||(mn=!0),s.memoizedState=r,s.baseQueue===null&&(s.baseState=r),a.lastRenderedState=r}return[r,l]}function eS(){}function tS(t,s){var a=ma,l=ar(),n=s(),r=!Pr(l.memoizedState,n);if(r&&(l.memoizedState=n,mn=!0),l=l.queue,Jy(lS.bind(null,a,l,t),[t]),l.getSnapshot!==s||r||xl!==null&&xl.memoizedState.tag&1){if(a.flags|=2048,Rx(9,aS.bind(null,a,l,n,s),void 0,null),pl===null)throw Error(at(349));Bd&30||sS(a,s,n)}return n}function sS(t,s,a){t.flags|=16384,t={getSnapshot:s,value:a},s=ma.updateQueue,s===null?(s={lastEffect:null,stores:null},ma.updateQueue=s,s.stores=[t]):(a=s.stores,a===null?s.stores=[t]:a.push(t))}function aS(t,s,a,l){s.value=a,s.getSnapshot=l,nS(s)&&rS(t)}function lS(t,s,a){return a(function(){nS(s)&&rS(t)})}function nS(t){var s=t.getSnapshot;t=t.value;try{var a=s();return!Pr(t,a)}catch{return!0}}function rS(t){var s=Ti(t,1);s!==null&&Ar(s,t,1,-1)}function g2(t){var s=Hr();return typeof t=="function"&&(t=t()),s.memoizedState=s.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Tx,lastRenderedState:t},s.queue=t,t=t.dispatch=r6.bind(null,ma,t),[s.memoizedState,t]}function Rx(t,s,a,l){return t={tag:t,create:s,destroy:a,deps:l,next:null},s=ma.updateQueue,s===null?(s={lastEffect:null,stores:null},ma.updateQueue=s,s.lastEffect=t.next=t):(a=s.lastEffect,a===null?s.lastEffect=t.next=t:(l=a.next,a.next=t,t.next=l,s.lastEffect=t)),t}function iS(){return ar().memoizedState}function s0(t,s,a,l){var n=Hr();ma.flags|=t,n.memoizedState=Rx(1|s,a,void 0,l===void 0?null:l)}function Eg(t,s,a,l){var n=ar();l=l===void 0?null:l;var r=void 0;if(tl!==null){var i=tl.memoizedState;if(r=i.destroy,l!==null&&Ky(l,i.deps)){n.memoizedState=Rx(s,a,r,l);return}}ma.flags|=t,n.memoizedState=Rx(1|s,a,r,l)}function f2(t,s){return s0(8390656,8,t,s)}function Jy(t,s){return Eg(2048,8,t,s)}function oS(t,s){return Eg(4,2,t,s)}function dS(t,s){return Eg(4,4,t,s)}function cS(t,s){if(typeof s=="function")return t=t(),s(t),function(){s(null)};if(s!=null)return t=t(),s.current=t,function(){s.current=null}}function uS(t,s,a){return a=a!=null?a.concat([t]):null,Eg(4,4,cS.bind(null,s,t),a)}function Zy(){}function mS(t,s){var a=ar();s=s===void 0?null:s;var l=a.memoizedState;return l!==null&&s!==null&&Ky(s,l[1])?l[0]:(a.memoizedState=[t,s],t)}function xS(t,s){var a=ar();s=s===void 0?null:s;var l=a.memoizedState;return l!==null&&s!==null&&Ky(s,l[1])?l[0]:(t=t(),a.memoizedState=[t,s],t)}function pS(t,s,a){return Bd&21?(Pr(a,s)||(a=b3(),ma.lanes|=a,Gd|=a,t.baseState=!0),s):(t.baseState&&(t.baseState=!1,mn=!0),t.memoizedState=a)}function l6(t,s){var a=ws;ws=a!==0&&4>a?a:4,t(!0);var l=Hf.transition;Hf.transition={};try{t(!1),s()}finally{ws=a,Hf.transition=l}}function hS(){return ar().memoizedState}function n6(t,s,a){var l=Io(t);if(a={lane:l,action:a,hasEagerState:!1,eagerState:null,next:null},gS(t))fS(s,a);else if(a=Y3(t,s,a,l),a!==null){var n=Yl();Ar(a,t,l,n),vS(a,s,l)}}function r6(t,s,a){var l=Io(t),n={lane:l,action:a,hasEagerState:!1,eagerState:null,next:null};if(gS(t))fS(s,n);else{var r=t.alternate;if(t.lanes===0&&(r===null||r.lanes===0)&&(r=s.lastRenderedReducer,r!==null))try{var i=s.lastRenderedState,o=r(i,a);if(n.hasEagerState=!0,n.eagerState=o,Pr(o,i)){var c=s.interleaved;c===null?(n.next=n,qy(s)):(n.next=c.next,c.next=n),s.interleaved=n;return}}catch{}finally{}a=Y3(t,s,n,l),a!==null&&(n=Yl(),Ar(a,t,l,n),vS(a,s,l))}}function gS(t){var s=t.alternate;return t===ma||s!==null&&s===ma}function fS(t,s){Zm=U0=!0;var a=t.pending;a===null?s.next=s:(s.next=a.next,a.next=s),t.pending=s}function vS(t,s,a){if(a&4194240){var l=s.lanes;l&=t.pendingLanes,a|=l,s.lanes=a,Py(t,a)}}var V0={readContext:sr,useCallback:El,useContext:El,useEffect:El,useImperativeHandle:El,useInsertionEffect:El,useLayoutEffect:El,useMemo:El,useReducer:El,useRef:El,useState:El,useDebugValue:El,useDeferredValue:El,useTransition:El,useMutableSource:El,useSyncExternalStore:El,useId:El,unstable_isNewReconciler:!1},i6={readContext:sr,useCallback:function(t,s){return Hr().memoizedState=[t,s===void 0?null:s],t},useContext:sr,useEffect:f2,useImperativeHandle:function(t,s,a){return a=a!=null?a.concat([t]):null,s0(4194308,4,cS.bind(null,s,t),a)},useLayoutEffect:function(t,s){return s0(4194308,4,t,s)},useInsertionEffect:function(t,s){return s0(4,2,t,s)},useMemo:function(t,s){var a=Hr();return s=s===void 0?null:s,t=t(),a.memoizedState=[t,s],t},useReducer:function(t,s,a){var l=Hr();return s=a!==void 0?a(s):s,l.memoizedState=l.baseState=s,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:s},l.queue=t,t=t.dispatch=n6.bind(null,ma,t),[l.memoizedState,t]},useRef:function(t){var s=Hr();return t={current:t},s.memoizedState=t},useState:g2,useDebugValue:Zy,useDeferredValue:function(t){return Hr().memoizedState=t},useTransition:function(){var t=g2(!1),s=t[0];return t=l6.bind(null,t[1]),Hr().memoizedState=t,[s,t]},useMutableSource:function(){},useSyncExternalStore:function(t,s,a){var l=ma,n=Hr();if(ra){if(a===void 0)throw Error(at(407));a=a()}else{if(a=s(),pl===null)throw Error(at(349));Bd&30||sS(l,s,a)}n.memoizedState=a;var r={value:a,getSnapshot:s};return n.queue=r,f2(lS.bind(null,l,r,t),[t]),l.flags|=2048,Rx(9,aS.bind(null,l,r,a,s),void 0,null),a},useId:function(){var t=Hr(),s=pl.identifierPrefix;if(ra){var a=Ci,l=ki;a=(l&~(1<<32-Sr(l)-1)).toString(32)+a,s=":"+s+"R"+a,a=Ox++,0<a&&(s+="H"+a.toString(32)),s+=":"}else a=a6++,s=":"+s+"r"+a.toString(32)+":";return t.memoizedState=s},unstable_isNewReconciler:!1},o6={readContext:sr,useCallback:mS,useContext:sr,useEffect:Jy,useImperativeHandle:uS,useInsertionEffect:oS,useLayoutEffect:dS,useMemo:xS,useReducer:Xf,useRef:iS,useState:function(){return Xf(Tx)},useDebugValue:Zy,useDeferredValue:function(t){var s=ar();return pS(s,tl.memoizedState,t)},useTransition:function(){var t=Xf(Tx)[0],s=ar().memoizedState;return[t,s]},useMutableSource:eS,useSyncExternalStore:tS,useId:hS,unstable_isNewReconciler:!1},d6={readContext:sr,useCallback:mS,useContext:sr,useEffect:Jy,useImperativeHandle:uS,useInsertionEffect:oS,useLayoutEffect:dS,useMemo:xS,useReducer:Kf,useRef:iS,useState:function(){return Kf(Tx)},useDebugValue:Zy,useDeferredValue:function(t){var s=ar();return tl===null?s.memoizedState=t:pS(s,tl.memoizedState,t)},useTransition:function(){var t=Kf(Tx)[0],s=ar().memoizedState;return[t,s]},useMutableSource:eS,useSyncExternalStore:tS,useId:hS,unstable_isNewReconciler:!1};function vr(t,s){if(t&&t.defaultProps){s=xa({},s),t=t.defaultProps;for(var a in t)s[a]===void 0&&(s[a]=t[a]);return s}return s}function cj(t,s,a,l){s=t.memoizedState,a=a(l,s),a=a==null?s:xa({},s,a),t.memoizedState=a,t.lanes===0&&(t.updateQueue.baseState=a)}var Mg={isMounted:function(t){return(t=t._reactInternals)?Xd(t)===t:!1},enqueueSetState:function(t,s,a){t=t._reactInternals;var l=Yl(),n=Io(t),r=Ai(l,n);r.payload=s,a!=null&&(r.callback=a),s=Ro(t,r,n),s!==null&&(Ar(s,t,n,l),e0(s,t,n))},enqueueReplaceState:function(t,s,a){t=t._reactInternals;var l=Yl(),n=Io(t),r=Ai(l,n);r.tag=1,r.payload=s,a!=null&&(r.callback=a),s=Ro(t,r,n),s!==null&&(Ar(s,t,n,l),e0(s,t,n))},enqueueForceUpdate:function(t,s){t=t._reactInternals;var a=Yl(),l=Io(t),n=Ai(a,l);n.tag=2,s!=null&&(n.callback=s),s=Ro(t,n,l),s!==null&&(Ar(s,t,l,a),e0(s,t,l))}};function v2(t,s,a,l,n,r,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(l,r,i):s.prototype&&s.prototype.isPureReactComponent?!Cx(a,l)||!Cx(n,r):!0}function bS(t,s,a){var l=!1,n=_o,r=s.contextType;return typeof r=="object"&&r!==null?r=sr(r):(n=pn(s)?Vd:Fl.current,l=s.contextTypes,r=(l=l!=null)?hu(t,n):_o),s=new s(a,r),t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=Mg,t.stateNode=s,s._reactInternals=t,l&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=n,t.__reactInternalMemoizedMaskedChildContext=r),s}function b2(t,s,a,l){t=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(a,l),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(a,l),s.state!==t&&Mg.enqueueReplaceState(s,s.state,null)}function uj(t,s,a,l){var n=t.stateNode;n.props=a,n.state=t.memoizedState,n.refs={},zy(t);var r=s.contextType;typeof r=="object"&&r!==null?n.context=sr(r):(r=pn(s)?Vd:Fl.current,n.context=hu(t,r)),n.state=t.memoizedState,r=s.getDerivedStateFromProps,typeof r=="function"&&(cj(t,s,r,a),n.state=t.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(s=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),s!==n.state&&Mg.enqueueReplaceState(n,n.state,null),L0(t,a,n,l),n.state=t.memoizedState),typeof n.componentDidMount=="function"&&(t.flags|=4194308)}function bu(t,s){try{var a="",l=s;do a+=LM(l),l=l.return;while(l);var n=a}catch(r){n=`
Error generating stack: `+r.message+`
`+r.stack}return{value:t,source:s,stack:n,digest:null}}function Qf(t,s,a){return{value:t,source:null,stack:a??null,digest:s??null}}function mj(t,s){try{console.error(s.value)}catch(a){setTimeout(function(){throw a})}}var c6=typeof WeakMap=="function"?WeakMap:Map;function jS(t,s,a){a=Ai(-1,a),a.tag=3,a.payload={element:null};var l=s.value;return a.callback=function(){B0||(B0=!0,Nj=l),mj(t,s)},a}function yS(t,s,a){a=Ai(-1,a),a.tag=3;var l=t.type.getDerivedStateFromError;if(typeof l=="function"){var n=s.value;a.payload=function(){return l(n)},a.callback=function(){mj(t,s)}}var r=t.stateNode;return r!==null&&typeof r.componentDidCatch=="function"&&(a.callback=function(){mj(t,s),typeof l!="function"&&(Do===null?Do=new Set([this]):Do.add(this));var i=s.stack;this.componentDidCatch(s.value,{componentStack:i!==null?i:""})}),a}function j2(t,s,a){var l=t.pingCache;if(l===null){l=t.pingCache=new c6;var n=new Set;l.set(s,n)}else n=l.get(s),n===void 0&&(n=new Set,l.set(s,n));n.has(a)||(n.add(a),t=k6.bind(null,t,s,a),s.then(t,t))}function y2(t){do{var s;if((s=t.tag===13)&&(s=t.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return t;t=t.return}while(t!==null);return null}function N2(t,s,a,l,n){return t.mode&1?(t.flags|=65536,t.lanes=n,t):(t===s?t.flags|=65536:(t.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(s=Ai(-1,1),s.tag=2,Ro(a,s,1))),a.lanes|=1),t)}var u6=Ui.ReactCurrentOwner,mn=!1;function Wl(t,s,a,l){s.child=t===null?Q3(s,null,a,l):fu(s,t.child,a,l)}function w2(t,s,a,l,n){a=a.render;var r=s.ref;return ou(s,n),l=Qy(t,s,a,l,r,n),a=Yy(),t!==null&&!mn?(s.updateQueue=t.updateQueue,s.flags&=-2053,t.lanes&=~n,Ri(t,s,n)):(ra&&a&&Fy(s),s.flags|=1,Wl(t,s,l,n),s.child)}function k2(t,s,a,l,n){if(t===null){var r=a.type;return typeof r=="function"&&!iN(r)&&r.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(s.tag=15,s.type=r,NS(t,s,r,l,n)):(t=r0(a.type,null,l,s,s.mode,n),t.ref=s.ref,t.return=s,s.child=t)}if(r=t.child,!(t.lanes&n)){var i=r.memoizedProps;if(a=a.compare,a=a!==null?a:Cx,a(i,l)&&t.ref===s.ref)return Ri(t,s,n)}return s.flags|=1,t=$o(r,l),t.ref=s.ref,t.return=s,s.child=t}function NS(t,s,a,l,n){if(t!==null){var r=t.memoizedProps;if(Cx(r,l)&&t.ref===s.ref)if(mn=!1,s.pendingProps=l=r,(t.lanes&n)!==0)t.flags&131072&&(mn=!0);else return s.lanes=t.lanes,Ri(t,s,n)}return xj(t,s,a,l,n)}function wS(t,s,a){var l=s.pendingProps,n=l.children,r=t!==null?t.memoizedState:null;if(l.mode==="hidden")if(!(s.mode&1))s.memoizedState={baseLanes:0,cachePool:null,transitions:null},Us(Kc,Sn),Sn|=a;else{if(!(a&1073741824))return t=r!==null?r.baseLanes|a:a,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:t,cachePool:null,transitions:null},s.updateQueue=null,Us(Kc,Sn),Sn|=t,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},l=r!==null?r.baseLanes:a,Us(Kc,Sn),Sn|=l}else r!==null?(l=r.baseLanes|a,s.memoizedState=null):l=a,Us(Kc,Sn),Sn|=l;return Wl(t,s,n,a),s.child}function kS(t,s){var a=s.ref;(t===null&&a!==null||t!==null&&t.ref!==a)&&(s.flags|=512,s.flags|=2097152)}function xj(t,s,a,l,n){var r=pn(a)?Vd:Fl.current;return r=hu(s,r),ou(s,n),a=Qy(t,s,a,l,r,n),l=Yy(),t!==null&&!mn?(s.updateQueue=t.updateQueue,s.flags&=-2053,t.lanes&=~n,Ri(t,s,n)):(ra&&l&&Fy(s),s.flags|=1,Wl(t,s,a,n),s.child)}function C2(t,s,a,l,n){if(pn(a)){var r=!0;T0(s)}else r=!1;if(ou(s,n),s.stateNode===null)a0(t,s),bS(s,a,l),uj(s,a,l,n),l=!0;else if(t===null){var i=s.stateNode,o=s.memoizedProps;i.props=o;var c=i.context,x=a.contextType;typeof x=="object"&&x!==null?x=sr(x):(x=pn(a)?Vd:Fl.current,x=hu(s,x));var j=a.getDerivedStateFromProps,g=typeof j=="function"||typeof i.getSnapshotBeforeUpdate=="function";g||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==l||c!==x)&&b2(s,i,l,x),ho=!1;var y=s.memoizedState;i.state=y,L0(s,l,i,n),c=s.memoizedState,o!==l||y!==c||xn.current||ho?(typeof j=="function"&&(cj(s,a,j,l),c=s.memoizedState),(o=ho||v2(s,a,o,l,y,c,x))?(g||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(s.flags|=4194308)):(typeof i.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=l,s.memoizedState=c),i.props=l,i.state=c,i.context=x,l=o):(typeof i.componentDidMount=="function"&&(s.flags|=4194308),l=!1)}else{i=s.stateNode,J3(t,s),o=s.memoizedProps,x=s.type===s.elementType?o:vr(s.type,o),i.props=x,g=s.pendingProps,y=i.context,c=a.contextType,typeof c=="object"&&c!==null?c=sr(c):(c=pn(a)?Vd:Fl.current,c=hu(s,c));var $=a.getDerivedStateFromProps;(j=typeof $=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==g||y!==c)&&b2(s,i,l,c),ho=!1,y=s.memoizedState,i.state=y,L0(s,l,i,n);var T=s.memoizedState;o!==g||y!==T||xn.current||ho?(typeof $=="function"&&(cj(s,a,$,l),T=s.memoizedState),(x=ho||v2(s,a,x,l,y,T,c)||!1)?(j||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(l,T,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(l,T,c)),typeof i.componentDidUpdate=="function"&&(s.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&y===t.memoizedState||(s.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&y===t.memoizedState||(s.flags|=1024),s.memoizedProps=l,s.memoizedState=T),i.props=l,i.state=T,i.context=c,l=x):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&y===t.memoizedState||(s.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&y===t.memoizedState||(s.flags|=1024),l=!1)}return pj(t,s,a,l,r,n)}function pj(t,s,a,l,n,r){kS(t,s);var i=(s.flags&128)!==0;if(!l&&!i)return n&&c2(s,a,!1),Ri(t,s,r);l=s.stateNode,u6.current=s;var o=i&&typeof a.getDerivedStateFromError!="function"?null:l.render();return s.flags|=1,t!==null&&i?(s.child=fu(s,t.child,null,r),s.child=fu(s,null,o,r)):Wl(t,s,o,r),s.memoizedState=l.state,n&&c2(s,a,!0),s.child}function CS(t){var s=t.stateNode;s.pendingContext?d2(t,s.pendingContext,s.pendingContext!==s.context):s.context&&d2(t,s.context,!1),Wy(t,s.containerInfo)}function S2(t,s,a,l,n){return gu(),Vy(n),s.flags|=256,Wl(t,s,a,l),s.child}var hj={dehydrated:null,treeContext:null,retryLane:0};function gj(t){return{baseLanes:t,cachePool:null,transitions:null}}function SS(t,s,a){var l=s.pendingProps,n=da.current,r=!1,i=(s.flags&128)!==0,o;if((o=i)||(o=t!==null&&t.memoizedState===null?!1:(n&2)!==0),o?(r=!0,s.flags&=-129):(t===null||t.memoizedState!==null)&&(n|=1),Us(da,n&1),t===null)return oj(s),t=s.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(s.mode&1?t.data==="$!"?s.lanes=8:s.lanes=1073741824:s.lanes=1,null):(i=l.children,t=l.fallback,r?(l=s.mode,r=s.child,i={mode:"hidden",children:i},!(l&1)&&r!==null?(r.childLanes=0,r.pendingProps=i):r=Tg(i,l,0,null),t=$d(t,l,a,null),r.return=s,t.return=s,r.sibling=t,s.child=r,s.child.memoizedState=gj(a),s.memoizedState=hj,t):eN(s,i));if(n=t.memoizedState,n!==null&&(o=n.dehydrated,o!==null))return m6(t,s,i,l,o,n,a);if(r){r=l.fallback,i=s.mode,n=t.child,o=n.sibling;var c={mode:"hidden",children:l.children};return!(i&1)&&s.child!==n?(l=s.child,l.childLanes=0,l.pendingProps=c,s.deletions=null):(l=$o(n,c),l.subtreeFlags=n.subtreeFlags&14680064),o!==null?r=$o(o,r):(r=$d(r,i,a,null),r.flags|=2),r.return=s,l.return=s,l.sibling=r,s.child=l,l=r,r=s.child,i=t.child.memoizedState,i=i===null?gj(a):{baseLanes:i.baseLanes|a,cachePool:null,transitions:i.transitions},r.memoizedState=i,r.childLanes=t.childLanes&~a,s.memoizedState=hj,l}return r=t.child,t=r.sibling,l=$o(r,{mode:"visible",children:l.children}),!(s.mode&1)&&(l.lanes=a),l.return=s,l.sibling=null,t!==null&&(a=s.deletions,a===null?(s.deletions=[t],s.flags|=16):a.push(t)),s.child=l,s.memoizedState=null,l}function eN(t,s){return s=Tg({mode:"visible",children:s},t.mode,0,null),s.return=t,t.child=s}function Ep(t,s,a,l){return l!==null&&Vy(l),fu(s,t.child,null,a),t=eN(s,s.pendingProps.children),t.flags|=2,s.memoizedState=null,t}function m6(t,s,a,l,n,r,i){if(a)return s.flags&256?(s.flags&=-257,l=Qf(Error(at(422))),Ep(t,s,i,l)):s.memoizedState!==null?(s.child=t.child,s.flags|=128,null):(r=l.fallback,n=s.mode,l=Tg({mode:"visible",children:l.children},n,0,null),r=$d(r,n,i,null),r.flags|=2,l.return=s,r.return=s,l.sibling=r,s.child=l,s.mode&1&&fu(s,t.child,null,i),s.child.memoizedState=gj(i),s.memoizedState=hj,r);if(!(s.mode&1))return Ep(t,s,i,null);if(n.data==="$!"){if(l=n.nextSibling&&n.nextSibling.dataset,l)var o=l.dgst;return l=o,r=Error(at(419)),l=Qf(r,l,void 0),Ep(t,s,i,l)}if(o=(i&t.childLanes)!==0,mn||o){if(l=pl,l!==null){switch(i&-i){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(l.suspendedLanes|i)?0:n,n!==0&&n!==r.retryLane&&(r.retryLane=n,Ti(t,n),Ar(l,t,n,-1))}return rN(),l=Qf(Error(at(421))),Ep(t,s,i,l)}return n.data==="$?"?(s.flags|=128,s.child=t.child,s=C6.bind(null,t),n._reactRetry=s,null):(t=r.treeContext,Pn=To(n.nextSibling),On=s,ra=!0,yr=null,t!==null&&(Yn[Jn++]=ki,Yn[Jn++]=Ci,Yn[Jn++]=_d,ki=t.id,Ci=t.overflow,_d=s),s=eN(s,l.children),s.flags|=4096,s)}function A2(t,s,a){t.lanes|=s;var l=t.alternate;l!==null&&(l.lanes|=s),dj(t.return,s,a)}function Yf(t,s,a,l,n){var r=t.memoizedState;r===null?t.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:l,tail:a,tailMode:n}:(r.isBackwards=s,r.rendering=null,r.renderingStartTime=0,r.last=l,r.tail=a,r.tailMode=n)}function AS(t,s,a){var l=s.pendingProps,n=l.revealOrder,r=l.tail;if(Wl(t,s,l.children,a),l=da.current,l&2)l=l&1|2,s.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=s.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&A2(t,a,s);else if(t.tag===19)A2(t,a,s);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===s)break e;for(;t.sibling===null;){if(t.return===null||t.return===s)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}l&=1}if(Us(da,l),!(s.mode&1))s.memoizedState=null;else switch(n){case"forwards":for(a=s.child,n=null;a!==null;)t=a.alternate,t!==null&&F0(t)===null&&(n=a),a=a.sibling;a=n,a===null?(n=s.child,s.child=null):(n=a.sibling,a.sibling=null),Yf(s,!1,n,a,r);break;case"backwards":for(a=null,n=s.child,s.child=null;n!==null;){if(t=n.alternate,t!==null&&F0(t)===null){s.child=n;break}t=n.sibling,n.sibling=a,a=n,n=t}Yf(s,!0,a,null,r);break;case"together":Yf(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function a0(t,s){!(s.mode&1)&&t!==null&&(t.alternate=null,s.alternate=null,s.flags|=2)}function Ri(t,s,a){if(t!==null&&(s.dependencies=t.dependencies),Gd|=s.lanes,!(a&s.childLanes))return null;if(t!==null&&s.child!==t.child)throw Error(at(153));if(s.child!==null){for(t=s.child,a=$o(t,t.pendingProps),s.child=a,a.return=s;t.sibling!==null;)t=t.sibling,a=a.sibling=$o(t,t.pendingProps),a.return=s;a.sibling=null}return s.child}function x6(t,s,a){switch(s.tag){case 3:CS(s),gu();break;case 5:Z3(s);break;case 1:pn(s.type)&&T0(s);break;case 4:Wy(s,s.stateNode.containerInfo);break;case 10:var l=s.type._context,n=s.memoizedProps.value;Us(I0,l._currentValue),l._currentValue=n;break;case 13:if(l=s.memoizedState,l!==null)return l.dehydrated!==null?(Us(da,da.current&1),s.flags|=128,null):a&s.child.childLanes?SS(t,s,a):(Us(da,da.current&1),t=Ri(t,s,a),t!==null?t.sibling:null);Us(da,da.current&1);break;case 19:if(l=(a&s.childLanes)!==0,t.flags&128){if(l)return AS(t,s,a);s.flags|=128}if(n=s.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),Us(da,da.current),l)break;return null;case 22:case 23:return s.lanes=0,wS(t,s,a)}return Ri(t,s,a)}var ES,fj,MS,PS;ES=function(t,s){for(var a=s.child;a!==null;){if(a.tag===5||a.tag===6)t.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};fj=function(){};MS=function(t,s,a,l){var n=t.memoizedProps;if(n!==l){t=s.stateNode,Od(ei.current);var r=null;switch(a){case"input":n=Ub(t,n),l=Ub(t,l),r=[];break;case"select":n=xa({},n,{value:void 0}),l=xa({},l,{value:void 0}),r=[];break;case"textarea":n=Bb(t,n),l=Bb(t,l),r=[];break;default:typeof n.onClick!="function"&&typeof l.onClick=="function"&&(t.onclick=P0)}qb(a,l);var i;a=null;for(x in n)if(!l.hasOwnProperty(x)&&n.hasOwnProperty(x)&&n[x]!=null)if(x==="style"){var o=n[x];for(i in o)o.hasOwnProperty(i)&&(a||(a={}),a[i]="")}else x!=="dangerouslySetInnerHTML"&&x!=="children"&&x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(vx.hasOwnProperty(x)?r||(r=[]):(r=r||[]).push(x,null));for(x in l){var c=l[x];if(o=n!=null?n[x]:void 0,l.hasOwnProperty(x)&&c!==o&&(c!=null||o!=null))if(x==="style")if(o){for(i in o)!o.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(a||(a={}),a[i]="");for(i in c)c.hasOwnProperty(i)&&o[i]!==c[i]&&(a||(a={}),a[i]=c[i])}else a||(r||(r=[]),r.push(x,a)),a=c;else x==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(r=r||[]).push(x,c)):x==="children"?typeof c!="string"&&typeof c!="number"||(r=r||[]).push(x,""+c):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&(vx.hasOwnProperty(x)?(c!=null&&x==="onScroll"&&Gs("scroll",t),r||o===c||(r=[])):(r=r||[]).push(x,c))}a&&(r=r||[]).push("style",a);var x=r;(s.updateQueue=x)&&(s.flags|=4)}};PS=function(t,s,a,l){a!==l&&(s.flags|=4)};function Ku(t,s){if(!ra)switch(t.tailMode){case"hidden":s=t.tail;for(var a=null;s!==null;)s.alternate!==null&&(a=s),s=s.sibling;a===null?t.tail=null:a.sibling=null;break;case"collapsed":a=t.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?s||t.tail===null?t.tail=null:t.tail.sibling=null:l.sibling=null}}function Ml(t){var s=t.alternate!==null&&t.alternate.child===t.child,a=0,l=0;if(s)for(var n=t.child;n!==null;)a|=n.lanes|n.childLanes,l|=n.subtreeFlags&14680064,l|=n.flags&14680064,n.return=t,n=n.sibling;else for(n=t.child;n!==null;)a|=n.lanes|n.childLanes,l|=n.subtreeFlags,l|=n.flags,n.return=t,n=n.sibling;return t.subtreeFlags|=l,t.childLanes=a,s}function p6(t,s,a){var l=s.pendingProps;switch(Uy(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ml(s),null;case 1:return pn(s.type)&&O0(),Ml(s),null;case 3:return l=s.stateNode,vu(),Ks(xn),Ks(Fl),Xy(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(t===null||t.child===null)&&(Sp(s)?s.flags|=4:t===null||t.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,yr!==null&&(Cj(yr),yr=null))),fj(t,s),Ml(s),null;case 5:Hy(s);var n=Od(Px.current);if(a=s.type,t!==null&&s.stateNode!=null)MS(t,s,a,l,n),t.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!l){if(s.stateNode===null)throw Error(at(166));return Ml(s),null}if(t=Od(ei.current),Sp(s)){l=s.stateNode,a=s.type;var r=s.memoizedProps;switch(l[Yr]=s,l[Ex]=r,t=(s.mode&1)!==0,a){case"dialog":Gs("cancel",l),Gs("close",l);break;case"iframe":case"object":case"embed":Gs("load",l);break;case"video":case"audio":for(n=0;n<Bm.length;n++)Gs(Bm[n],l);break;case"source":Gs("error",l);break;case"img":case"image":case"link":Gs("error",l),Gs("load",l);break;case"details":Gs("toggle",l);break;case"input":$w(l,r),Gs("invalid",l);break;case"select":l._wrapperState={wasMultiple:!!r.multiple},Gs("invalid",l);break;case"textarea":Fw(l,r),Gs("invalid",l)}qb(a,r),n=null;for(var i in r)if(r.hasOwnProperty(i)){var o=r[i];i==="children"?typeof o=="string"?l.textContent!==o&&(r.suppressHydrationWarning!==!0&&Cp(l.textContent,o,t),n=["children",o]):typeof o=="number"&&l.textContent!==""+o&&(r.suppressHydrationWarning!==!0&&Cp(l.textContent,o,t),n=["children",""+o]):vx.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&Gs("scroll",l)}switch(a){case"input":fp(l),Lw(l,r,!0);break;case"textarea":fp(l),Uw(l);break;case"select":case"option":break;default:typeof r.onClick=="function"&&(l.onclick=P0)}l=n,s.updateQueue=l,l!==null&&(s.flags|=4)}else{i=n.nodeType===9?n:n.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=l3(a)),t==="http://www.w3.org/1999/xhtml"?a==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof l.is=="string"?t=i.createElement(a,{is:l.is}):(t=i.createElement(a),a==="select"&&(i=t,l.multiple?i.multiple=!0:l.size&&(i.size=l.size))):t=i.createElementNS(t,a),t[Yr]=s,t[Ex]=l,ES(t,s,!1,!1),s.stateNode=t;e:{switch(i=zb(a,l),a){case"dialog":Gs("cancel",t),Gs("close",t),n=l;break;case"iframe":case"object":case"embed":Gs("load",t),n=l;break;case"video":case"audio":for(n=0;n<Bm.length;n++)Gs(Bm[n],t);n=l;break;case"source":Gs("error",t),n=l;break;case"img":case"image":case"link":Gs("error",t),Gs("load",t),n=l;break;case"details":Gs("toggle",t),n=l;break;case"input":$w(t,l),n=Ub(t,l),Gs("invalid",t);break;case"option":n=l;break;case"select":t._wrapperState={wasMultiple:!!l.multiple},n=xa({},l,{value:void 0}),Gs("invalid",t);break;case"textarea":Fw(t,l),n=Bb(t,l),Gs("invalid",t);break;default:n=l}qb(a,n),o=n;for(r in o)if(o.hasOwnProperty(r)){var c=o[r];r==="style"?i3(t,c):r==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&n3(t,c)):r==="children"?typeof c=="string"?(a!=="textarea"||c!=="")&&bx(t,c):typeof c=="number"&&bx(t,""+c):r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&r!=="autoFocus"&&(vx.hasOwnProperty(r)?c!=null&&r==="onScroll"&&Gs("scroll",t):c!=null&&ky(t,r,c,i))}switch(a){case"input":fp(t),Lw(t,l,!1);break;case"textarea":fp(t),Uw(t);break;case"option":l.value!=null&&t.setAttribute("value",""+Vo(l.value));break;case"select":t.multiple=!!l.multiple,r=l.value,r!=null?lu(t,!!l.multiple,r,!1):l.defaultValue!=null&&lu(t,!!l.multiple,l.defaultValue,!0);break;default:typeof n.onClick=="function"&&(t.onclick=P0)}switch(a){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}}l&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return Ml(s),null;case 6:if(t&&s.stateNode!=null)PS(t,s,t.memoizedProps,l);else{if(typeof l!="string"&&s.stateNode===null)throw Error(at(166));if(a=Od(Px.current),Od(ei.current),Sp(s)){if(l=s.stateNode,a=s.memoizedProps,l[Yr]=s,(r=l.nodeValue!==a)&&(t=On,t!==null))switch(t.tag){case 3:Cp(l.nodeValue,a,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Cp(l.nodeValue,a,(t.mode&1)!==0)}r&&(s.flags|=4)}else l=(a.nodeType===9?a:a.ownerDocument).createTextNode(l),l[Yr]=s,s.stateNode=l}return Ml(s),null;case 13:if(Ks(da),l=s.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ra&&Pn!==null&&s.mode&1&&!(s.flags&128))X3(),gu(),s.flags|=98560,r=!1;else if(r=Sp(s),l!==null&&l.dehydrated!==null){if(t===null){if(!r)throw Error(at(318));if(r=s.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(at(317));r[Yr]=s}else gu(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;Ml(s),r=!1}else yr!==null&&(Cj(yr),yr=null),r=!0;if(!r)return s.flags&65536?s:null}return s.flags&128?(s.lanes=a,s):(l=l!==null,l!==(t!==null&&t.memoizedState!==null)&&l&&(s.child.flags|=8192,s.mode&1&&(t===null||da.current&1?ll===0&&(ll=3):rN())),s.updateQueue!==null&&(s.flags|=4),Ml(s),null);case 4:return vu(),fj(t,s),t===null&&Sx(s.stateNode.containerInfo),Ml(s),null;case 10:return Gy(s.type._context),Ml(s),null;case 17:return pn(s.type)&&O0(),Ml(s),null;case 19:if(Ks(da),r=s.memoizedState,r===null)return Ml(s),null;if(l=(s.flags&128)!==0,i=r.rendering,i===null)if(l)Ku(r,!1);else{if(ll!==0||t!==null&&t.flags&128)for(t=s.child;t!==null;){if(i=F0(t),i!==null){for(s.flags|=128,Ku(r,!1),l=i.updateQueue,l!==null&&(s.updateQueue=l,s.flags|=4),s.subtreeFlags=0,l=a,a=s.child;a!==null;)r=a,t=l,r.flags&=14680066,i=r.alternate,i===null?(r.childLanes=0,r.lanes=t,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=i.childLanes,r.lanes=i.lanes,r.child=i.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=i.memoizedProps,r.memoizedState=i.memoizedState,r.updateQueue=i.updateQueue,r.type=i.type,t=i.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),a=a.sibling;return Us(da,da.current&1|2),s.child}t=t.sibling}r.tail!==null&&Ta()>ju&&(s.flags|=128,l=!0,Ku(r,!1),s.lanes=4194304)}else{if(!l)if(t=F0(i),t!==null){if(s.flags|=128,l=!0,a=t.updateQueue,a!==null&&(s.updateQueue=a,s.flags|=4),Ku(r,!0),r.tail===null&&r.tailMode==="hidden"&&!i.alternate&&!ra)return Ml(s),null}else 2*Ta()-r.renderingStartTime>ju&&a!==1073741824&&(s.flags|=128,l=!0,Ku(r,!1),s.lanes=4194304);r.isBackwards?(i.sibling=s.child,s.child=i):(a=r.last,a!==null?a.sibling=i:s.child=i,r.last=i)}return r.tail!==null?(s=r.tail,r.rendering=s,r.tail=s.sibling,r.renderingStartTime=Ta(),s.sibling=null,a=da.current,Us(da,l?a&1|2:a&1),s):(Ml(s),null);case 22:case 23:return nN(),l=s.memoizedState!==null,t!==null&&t.memoizedState!==null!==l&&(s.flags|=8192),l&&s.mode&1?Sn&1073741824&&(Ml(s),s.subtreeFlags&6&&(s.flags|=8192)):Ml(s),null;case 24:return null;case 25:return null}throw Error(at(156,s.tag))}function h6(t,s){switch(Uy(s),s.tag){case 1:return pn(s.type)&&O0(),t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 3:return vu(),Ks(xn),Ks(Fl),Xy(),t=s.flags,t&65536&&!(t&128)?(s.flags=t&-65537|128,s):null;case 5:return Hy(s),null;case 13:if(Ks(da),t=s.memoizedState,t!==null&&t.dehydrated!==null){if(s.alternate===null)throw Error(at(340));gu()}return t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 19:return Ks(da),null;case 4:return vu(),null;case 10:return Gy(s.type._context),null;case 22:case 23:return nN(),null;case 24:return null;default:return null}}var Mp=!1,$l=!1,g6=typeof WeakSet=="function"?WeakSet:Set,bt=null;function Xc(t,s){var a=t.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(l){ja(t,s,l)}else a.current=null}function vj(t,s,a){try{a()}catch(l){ja(t,s,l)}}var E2=!1;function f6(t,s){if(tj=A0,t=I3(),Ly(t)){if("selectionStart"in t)var a={start:t.selectionStart,end:t.selectionEnd};else e:{a=(a=t.ownerDocument)&&a.defaultView||window;var l=a.getSelection&&a.getSelection();if(l&&l.rangeCount!==0){a=l.anchorNode;var n=l.anchorOffset,r=l.focusNode;l=l.focusOffset;try{a.nodeType,r.nodeType}catch{a=null;break e}var i=0,o=-1,c=-1,x=0,j=0,g=t,y=null;t:for(;;){for(var $;g!==a||n!==0&&g.nodeType!==3||(o=i+n),g!==r||l!==0&&g.nodeType!==3||(c=i+l),g.nodeType===3&&(i+=g.nodeValue.length),($=g.firstChild)!==null;)y=g,g=$;for(;;){if(g===t)break t;if(y===a&&++x===n&&(o=i),y===r&&++j===l&&(c=i),($=g.nextSibling)!==null)break;g=y,y=g.parentNode}g=$}a=o===-1||c===-1?null:{start:o,end:c}}else a=null}a=a||{start:0,end:0}}else a=null;for(sj={focusedElem:t,selectionRange:a},A0=!1,bt=s;bt!==null;)if(s=bt,t=s.child,(s.subtreeFlags&1028)!==0&&t!==null)t.return=s,bt=t;else for(;bt!==null;){s=bt;try{var T=s.alternate;if(s.flags&1024)switch(s.tag){case 0:case 11:case 15:break;case 1:if(T!==null){var C=T.memoizedProps,W=T.memoizedState,L=s.stateNode,R=L.getSnapshotBeforeUpdate(s.elementType===s.type?C:vr(s.type,C),W);L.__reactInternalSnapshotBeforeUpdate=R}break;case 3:var F=s.stateNode.containerInfo;F.nodeType===1?F.textContent="":F.nodeType===9&&F.documentElement&&F.removeChild(F.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(at(163))}}catch(te){ja(s,s.return,te)}if(t=s.sibling,t!==null){t.return=s.return,bt=t;break}bt=s.return}return T=E2,E2=!1,T}function ex(t,s,a){var l=s.updateQueue;if(l=l!==null?l.lastEffect:null,l!==null){var n=l=l.next;do{if((n.tag&t)===t){var r=n.destroy;n.destroy=void 0,r!==void 0&&vj(s,a,r)}n=n.next}while(n!==l)}}function Pg(t,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var a=s=s.next;do{if((a.tag&t)===t){var l=a.create;a.destroy=l()}a=a.next}while(a!==s)}}function bj(t){var s=t.ref;if(s!==null){var a=t.stateNode;switch(t.tag){case 5:t=a;break;default:t=a}typeof s=="function"?s(t):s.current=t}}function OS(t){var s=t.alternate;s!==null&&(t.alternate=null,OS(s)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(s=t.stateNode,s!==null&&(delete s[Yr],delete s[Ex],delete s[nj],delete s[ZP],delete s[e6])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function TS(t){return t.tag===5||t.tag===3||t.tag===4}function M2(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||TS(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function jj(t,s,a){var l=t.tag;if(l===5||l===6)t=t.stateNode,s?a.nodeType===8?a.parentNode.insertBefore(t,s):a.insertBefore(t,s):(a.nodeType===8?(s=a.parentNode,s.insertBefore(t,a)):(s=a,s.appendChild(t)),a=a._reactRootContainer,a!=null||s.onclick!==null||(s.onclick=P0));else if(l!==4&&(t=t.child,t!==null))for(jj(t,s,a),t=t.sibling;t!==null;)jj(t,s,a),t=t.sibling}function yj(t,s,a){var l=t.tag;if(l===5||l===6)t=t.stateNode,s?a.insertBefore(t,s):a.appendChild(t);else if(l!==4&&(t=t.child,t!==null))for(yj(t,s,a),t=t.sibling;t!==null;)yj(t,s,a),t=t.sibling}var bl=null,jr=!1;function qi(t,s,a){for(a=a.child;a!==null;)RS(t,s,a),a=a.sibling}function RS(t,s,a){if(Zr&&typeof Zr.onCommitFiberUnmount=="function")try{Zr.onCommitFiberUnmount(Ng,a)}catch{}switch(a.tag){case 5:$l||Xc(a,s);case 6:var l=bl,n=jr;bl=null,qi(t,s,a),bl=l,jr=n,bl!==null&&(jr?(t=bl,a=a.stateNode,t.nodeType===8?t.parentNode.removeChild(a):t.removeChild(a)):bl.removeChild(a.stateNode));break;case 18:bl!==null&&(jr?(t=bl,a=a.stateNode,t.nodeType===8?qf(t.parentNode,a):t.nodeType===1&&qf(t,a),wx(t)):qf(bl,a.stateNode));break;case 4:l=bl,n=jr,bl=a.stateNode.containerInfo,jr=!0,qi(t,s,a),bl=l,jr=n;break;case 0:case 11:case 14:case 15:if(!$l&&(l=a.updateQueue,l!==null&&(l=l.lastEffect,l!==null))){n=l=l.next;do{var r=n,i=r.destroy;r=r.tag,i!==void 0&&(r&2||r&4)&&vj(a,s,i),n=n.next}while(n!==l)}qi(t,s,a);break;case 1:if(!$l&&(Xc(a,s),l=a.stateNode,typeof l.componentWillUnmount=="function"))try{l.props=a.memoizedProps,l.state=a.memoizedState,l.componentWillUnmount()}catch(o){ja(a,s,o)}qi(t,s,a);break;case 21:qi(t,s,a);break;case 22:a.mode&1?($l=(l=$l)||a.memoizedState!==null,qi(t,s,a),$l=l):qi(t,s,a);break;default:qi(t,s,a)}}function P2(t){var s=t.updateQueue;if(s!==null){t.updateQueue=null;var a=t.stateNode;a===null&&(a=t.stateNode=new g6),s.forEach(function(l){var n=S6.bind(null,t,l);a.has(l)||(a.add(l),l.then(n,n))})}}function ir(t,s){var a=s.deletions;if(a!==null)for(var l=0;l<a.length;l++){var n=a[l];try{var r=t,i=s,o=i;e:for(;o!==null;){switch(o.tag){case 5:bl=o.stateNode,jr=!1;break e;case 3:bl=o.stateNode.containerInfo,jr=!0;break e;case 4:bl=o.stateNode.containerInfo,jr=!0;break e}o=o.return}if(bl===null)throw Error(at(160));RS(r,i,n),bl=null,jr=!1;var c=n.alternate;c!==null&&(c.return=null),n.return=null}catch(x){ja(n,s,x)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)DS(s,t),s=s.sibling}function DS(t,s){var a=t.alternate,l=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ir(s,t),Or(t),l&4){try{ex(3,t,t.return),Pg(3,t)}catch(C){ja(t,t.return,C)}try{ex(5,t,t.return)}catch(C){ja(t,t.return,C)}}break;case 1:ir(s,t),Or(t),l&512&&a!==null&&Xc(a,a.return);break;case 5:if(ir(s,t),Or(t),l&512&&a!==null&&Xc(a,a.return),t.flags&32){var n=t.stateNode;try{bx(n,"")}catch(C){ja(t,t.return,C)}}if(l&4&&(n=t.stateNode,n!=null)){var r=t.memoizedProps,i=a!==null?a.memoizedProps:r,o=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{o==="input"&&r.type==="radio"&&r.name!=null&&s3(n,r),zb(o,i);var x=zb(o,r);for(i=0;i<c.length;i+=2){var j=c[i],g=c[i+1];j==="style"?i3(n,g):j==="dangerouslySetInnerHTML"?n3(n,g):j==="children"?bx(n,g):ky(n,j,g,x)}switch(o){case"input":Vb(n,r);break;case"textarea":a3(n,r);break;case"select":var y=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!r.multiple;var $=r.value;$!=null?lu(n,!!r.multiple,$,!1):y!==!!r.multiple&&(r.defaultValue!=null?lu(n,!!r.multiple,r.defaultValue,!0):lu(n,!!r.multiple,r.multiple?[]:"",!1))}n[Ex]=r}catch(C){ja(t,t.return,C)}}break;case 6:if(ir(s,t),Or(t),l&4){if(t.stateNode===null)throw Error(at(162));n=t.stateNode,r=t.memoizedProps;try{n.nodeValue=r}catch(C){ja(t,t.return,C)}}break;case 3:if(ir(s,t),Or(t),l&4&&a!==null&&a.memoizedState.isDehydrated)try{wx(s.containerInfo)}catch(C){ja(t,t.return,C)}break;case 4:ir(s,t),Or(t);break;case 13:ir(s,t),Or(t),n=t.child,n.flags&8192&&(r=n.memoizedState!==null,n.stateNode.isHidden=r,!r||n.alternate!==null&&n.alternate.memoizedState!==null||(aN=Ta())),l&4&&P2(t);break;case 22:if(j=a!==null&&a.memoizedState!==null,t.mode&1?($l=(x=$l)||j,ir(s,t),$l=x):ir(s,t),Or(t),l&8192){if(x=t.memoizedState!==null,(t.stateNode.isHidden=x)&&!j&&t.mode&1)for(bt=t,j=t.child;j!==null;){for(g=bt=j;bt!==null;){switch(y=bt,$=y.child,y.tag){case 0:case 11:case 14:case 15:ex(4,y,y.return);break;case 1:Xc(y,y.return);var T=y.stateNode;if(typeof T.componentWillUnmount=="function"){l=y,a=y.return;try{s=l,T.props=s.memoizedProps,T.state=s.memoizedState,T.componentWillUnmount()}catch(C){ja(l,a,C)}}break;case 5:Xc(y,y.return);break;case 22:if(y.memoizedState!==null){T2(g);continue}}$!==null?($.return=y,bt=$):T2(g)}j=j.sibling}e:for(j=null,g=t;;){if(g.tag===5){if(j===null){j=g;try{n=g.stateNode,x?(r=n.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none"):(o=g.stateNode,c=g.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=r3("display",i))}catch(C){ja(t,t.return,C)}}}else if(g.tag===6){if(j===null)try{g.stateNode.nodeValue=x?"":g.memoizedProps}catch(C){ja(t,t.return,C)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===t)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===t)break e;for(;g.sibling===null;){if(g.return===null||g.return===t)break e;j===g&&(j=null),g=g.return}j===g&&(j=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:ir(s,t),Or(t),l&4&&P2(t);break;case 21:break;default:ir(s,t),Or(t)}}function Or(t){var s=t.flags;if(s&2){try{e:{for(var a=t.return;a!==null;){if(TS(a)){var l=a;break e}a=a.return}throw Error(at(160))}switch(l.tag){case 5:var n=l.stateNode;l.flags&32&&(bx(n,""),l.flags&=-33);var r=M2(t);yj(t,r,n);break;case 3:case 4:var i=l.stateNode.containerInfo,o=M2(t);jj(t,o,i);break;default:throw Error(at(161))}}catch(c){ja(t,t.return,c)}t.flags&=-3}s&4096&&(t.flags&=-4097)}function v6(t,s,a){bt=t,IS(t)}function IS(t,s,a){for(var l=(t.mode&1)!==0;bt!==null;){var n=bt,r=n.child;if(n.tag===22&&l){var i=n.memoizedState!==null||Mp;if(!i){var o=n.alternate,c=o!==null&&o.memoizedState!==null||$l;o=Mp;var x=$l;if(Mp=i,($l=c)&&!x)for(bt=n;bt!==null;)i=bt,c=i.child,i.tag===22&&i.memoizedState!==null?R2(n):c!==null?(c.return=i,bt=c):R2(n);for(;r!==null;)bt=r,IS(r),r=r.sibling;bt=n,Mp=o,$l=x}O2(t)}else n.subtreeFlags&8772&&r!==null?(r.return=n,bt=r):O2(t)}}function O2(t){for(;bt!==null;){var s=bt;if(s.flags&8772){var a=s.alternate;try{if(s.flags&8772)switch(s.tag){case 0:case 11:case 15:$l||Pg(5,s);break;case 1:var l=s.stateNode;if(s.flags&4&&!$l)if(a===null)l.componentDidMount();else{var n=s.elementType===s.type?a.memoizedProps:vr(s.type,a.memoizedProps);l.componentDidUpdate(n,a.memoizedState,l.__reactInternalSnapshotBeforeUpdate)}var r=s.updateQueue;r!==null&&h2(s,r,l);break;case 3:var i=s.updateQueue;if(i!==null){if(a=null,s.child!==null)switch(s.child.tag){case 5:a=s.child.stateNode;break;case 1:a=s.child.stateNode}h2(s,i,a)}break;case 5:var o=s.stateNode;if(a===null&&s.flags&4){a=o;var c=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&a.focus();break;case"img":c.src&&(a.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var x=s.alternate;if(x!==null){var j=x.memoizedState;if(j!==null){var g=j.dehydrated;g!==null&&wx(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(at(163))}$l||s.flags&512&&bj(s)}catch(y){ja(s,s.return,y)}}if(s===t){bt=null;break}if(a=s.sibling,a!==null){a.return=s.return,bt=a;break}bt=s.return}}function T2(t){for(;bt!==null;){var s=bt;if(s===t){bt=null;break}var a=s.sibling;if(a!==null){a.return=s.return,bt=a;break}bt=s.return}}function R2(t){for(;bt!==null;){var s=bt;try{switch(s.tag){case 0:case 11:case 15:var a=s.return;try{Pg(4,s)}catch(c){ja(s,a,c)}break;case 1:var l=s.stateNode;if(typeof l.componentDidMount=="function"){var n=s.return;try{l.componentDidMount()}catch(c){ja(s,n,c)}}var r=s.return;try{bj(s)}catch(c){ja(s,r,c)}break;case 5:var i=s.return;try{bj(s)}catch(c){ja(s,i,c)}}}catch(c){ja(s,s.return,c)}if(s===t){bt=null;break}var o=s.sibling;if(o!==null){o.return=s.return,bt=o;break}bt=s.return}}var b6=Math.ceil,_0=Ui.ReactCurrentDispatcher,tN=Ui.ReactCurrentOwner,tr=Ui.ReactCurrentBatchConfig,os=0,pl=null,Ka=null,wl=0,Sn=0,Kc=Wo(0),ll=0,Dx=null,Gd=0,Og=0,sN=0,tx=null,cn=null,aN=0,ju=1/0,bi=null,B0=!1,Nj=null,Do=null,Pp=!1,No=null,G0=0,sx=0,wj=null,l0=-1,n0=0;function Yl(){return os&6?Ta():l0!==-1?l0:l0=Ta()}function Io(t){return t.mode&1?os&2&&wl!==0?wl&-wl:s6.transition!==null?(n0===0&&(n0=b3()),n0):(t=ws,t!==0||(t=window.event,t=t===void 0?16:S3(t.type)),t):1}function Ar(t,s,a,l){if(50<sx)throw sx=0,wj=null,Error(at(185));Zx(t,a,l),(!(os&2)||t!==pl)&&(t===pl&&(!(os&2)&&(Og|=a),ll===4&&vo(t,wl)),hn(t,l),a===1&&os===0&&!(s.mode&1)&&(ju=Ta()+500,Ag&&Ho()))}function hn(t,s){var a=t.callbackNode;sP(t,s);var l=S0(t,t===pl?wl:0);if(l===0)a!==null&&Bw(a),t.callbackNode=null,t.callbackPriority=0;else if(s=l&-l,t.callbackPriority!==s){if(a!=null&&Bw(a),s===1)t.tag===0?t6(D2.bind(null,t)):z3(D2.bind(null,t)),YP(function(){!(os&6)&&Ho()}),a=null;else{switch(j3(l)){case 1:a=My;break;case 4:a=f3;break;case 16:a=C0;break;case 536870912:a=v3;break;default:a=C0}a=GS(a,$S.bind(null,t))}t.callbackPriority=s,t.callbackNode=a}}function $S(t,s){if(l0=-1,n0=0,os&6)throw Error(at(327));var a=t.callbackNode;if(du()&&t.callbackNode!==a)return null;var l=S0(t,t===pl?wl:0);if(l===0)return null;if(l&30||l&t.expiredLanes||s)s=q0(t,l);else{s=l;var n=os;os|=2;var r=FS();(pl!==t||wl!==s)&&(bi=null,ju=Ta()+500,Id(t,s));do try{N6();break}catch(o){LS(t,o)}while(!0);By(),_0.current=r,os=n,Ka!==null?s=0:(pl=null,wl=0,s=ll)}if(s!==0){if(s===2&&(n=Qb(t),n!==0&&(l=n,s=kj(t,n))),s===1)throw a=Dx,Id(t,0),vo(t,l),hn(t,Ta()),a;if(s===6)vo(t,l);else{if(n=t.current.alternate,!(l&30)&&!j6(n)&&(s=q0(t,l),s===2&&(r=Qb(t),r!==0&&(l=r,s=kj(t,r))),s===1))throw a=Dx,Id(t,0),vo(t,l),hn(t,Ta()),a;switch(t.finishedWork=n,t.finishedLanes=l,s){case 0:case 1:throw Error(at(345));case 2:yd(t,cn,bi);break;case 3:if(vo(t,l),(l&130023424)===l&&(s=aN+500-Ta(),10<s)){if(S0(t,0)!==0)break;if(n=t.suspendedLanes,(n&l)!==l){Yl(),t.pingedLanes|=t.suspendedLanes&n;break}t.timeoutHandle=lj(yd.bind(null,t,cn,bi),s);break}yd(t,cn,bi);break;case 4:if(vo(t,l),(l&4194240)===l)break;for(s=t.eventTimes,n=-1;0<l;){var i=31-Sr(l);r=1<<i,i=s[i],i>n&&(n=i),l&=~r}if(l=n,l=Ta()-l,l=(120>l?120:480>l?480:1080>l?1080:1920>l?1920:3e3>l?3e3:4320>l?4320:1960*b6(l/1960))-l,10<l){t.timeoutHandle=lj(yd.bind(null,t,cn,bi),l);break}yd(t,cn,bi);break;case 5:yd(t,cn,bi);break;default:throw Error(at(329))}}}return hn(t,Ta()),t.callbackNode===a?$S.bind(null,t):null}function kj(t,s){var a=tx;return t.current.memoizedState.isDehydrated&&(Id(t,s).flags|=256),t=q0(t,s),t!==2&&(s=cn,cn=a,s!==null&&Cj(s)),t}function Cj(t){cn===null?cn=t:cn.push.apply(cn,t)}function j6(t){for(var s=t;;){if(s.flags&16384){var a=s.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var l=0;l<a.length;l++){var n=a[l],r=n.getSnapshot;n=n.value;try{if(!Pr(r(),n))return!1}catch{return!1}}}if(a=s.child,s.subtreeFlags&16384&&a!==null)a.return=s,s=a;else{if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function vo(t,s){for(s&=~sN,s&=~Og,t.suspendedLanes|=s,t.pingedLanes&=~s,t=t.expirationTimes;0<s;){var a=31-Sr(s),l=1<<a;t[a]=-1,s&=~l}}function D2(t){if(os&6)throw Error(at(327));du();var s=S0(t,0);if(!(s&1))return hn(t,Ta()),null;var a=q0(t,s);if(t.tag!==0&&a===2){var l=Qb(t);l!==0&&(s=l,a=kj(t,l))}if(a===1)throw a=Dx,Id(t,0),vo(t,s),hn(t,Ta()),a;if(a===6)throw Error(at(345));return t.finishedWork=t.current.alternate,t.finishedLanes=s,yd(t,cn,bi),hn(t,Ta()),null}function lN(t,s){var a=os;os|=1;try{return t(s)}finally{os=a,os===0&&(ju=Ta()+500,Ag&&Ho())}}function qd(t){No!==null&&No.tag===0&&!(os&6)&&du();var s=os;os|=1;var a=tr.transition,l=ws;try{if(tr.transition=null,ws=1,t)return t()}finally{ws=l,tr.transition=a,os=s,!(os&6)&&Ho()}}function nN(){Sn=Kc.current,Ks(Kc)}function Id(t,s){t.finishedWork=null,t.finishedLanes=0;var a=t.timeoutHandle;if(a!==-1&&(t.timeoutHandle=-1,QP(a)),Ka!==null)for(a=Ka.return;a!==null;){var l=a;switch(Uy(l),l.tag){case 1:l=l.type.childContextTypes,l!=null&&O0();break;case 3:vu(),Ks(xn),Ks(Fl),Xy();break;case 5:Hy(l);break;case 4:vu();break;case 13:Ks(da);break;case 19:Ks(da);break;case 10:Gy(l.type._context);break;case 22:case 23:nN()}a=a.return}if(pl=t,Ka=t=$o(t.current,null),wl=Sn=s,ll=0,Dx=null,sN=Og=Gd=0,cn=tx=null,Pd!==null){for(s=0;s<Pd.length;s++)if(a=Pd[s],l=a.interleaved,l!==null){a.interleaved=null;var n=l.next,r=a.pending;if(r!==null){var i=r.next;r.next=n,l.next=i}a.pending=l}Pd=null}return t}function LS(t,s){do{var a=Ka;try{if(By(),t0.current=V0,U0){for(var l=ma.memoizedState;l!==null;){var n=l.queue;n!==null&&(n.pending=null),l=l.next}U0=!1}if(Bd=0,xl=tl=ma=null,Zm=!1,Ox=0,tN.current=null,a===null||a.return===null){ll=1,Dx=s,Ka=null;break}e:{var r=t,i=a.return,o=a,c=s;if(s=wl,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var x=c,j=o,g=j.tag;if(!(j.mode&1)&&(g===0||g===11||g===15)){var y=j.alternate;y?(j.updateQueue=y.updateQueue,j.memoizedState=y.memoizedState,j.lanes=y.lanes):(j.updateQueue=null,j.memoizedState=null)}var $=y2(i);if($!==null){$.flags&=-257,N2($,i,o,r,s),$.mode&1&&j2(r,x,s),s=$,c=x;var T=s.updateQueue;if(T===null){var C=new Set;C.add(c),s.updateQueue=C}else T.add(c);break e}else{if(!(s&1)){j2(r,x,s),rN();break e}c=Error(at(426))}}else if(ra&&o.mode&1){var W=y2(i);if(W!==null){!(W.flags&65536)&&(W.flags|=256),N2(W,i,o,r,s),Vy(bu(c,o));break e}}r=c=bu(c,o),ll!==4&&(ll=2),tx===null?tx=[r]:tx.push(r),r=i;do{switch(r.tag){case 3:r.flags|=65536,s&=-s,r.lanes|=s;var L=jS(r,c,s);p2(r,L);break e;case 1:o=c;var R=r.type,F=r.stateNode;if(!(r.flags&128)&&(typeof R.getDerivedStateFromError=="function"||F!==null&&typeof F.componentDidCatch=="function"&&(Do===null||!Do.has(F)))){r.flags|=65536,s&=-s,r.lanes|=s;var te=yS(r,o,s);p2(r,te);break e}}r=r.return}while(r!==null)}VS(a)}catch(oe){s=oe,Ka===a&&a!==null&&(Ka=a=a.return);continue}break}while(!0)}function FS(){var t=_0.current;return _0.current=V0,t===null?V0:t}function rN(){(ll===0||ll===3||ll===2)&&(ll=4),pl===null||!(Gd&268435455)&&!(Og&268435455)||vo(pl,wl)}function q0(t,s){var a=os;os|=2;var l=FS();(pl!==t||wl!==s)&&(bi=null,Id(t,s));do try{y6();break}catch(n){LS(t,n)}while(!0);if(By(),os=a,_0.current=l,Ka!==null)throw Error(at(261));return pl=null,wl=0,ll}function y6(){for(;Ka!==null;)US(Ka)}function N6(){for(;Ka!==null&&!HM();)US(Ka)}function US(t){var s=BS(t.alternate,t,Sn);t.memoizedProps=t.pendingProps,s===null?VS(t):Ka=s,tN.current=null}function VS(t){var s=t;do{var a=s.alternate;if(t=s.return,s.flags&32768){if(a=h6(a,s),a!==null){a.flags&=32767,Ka=a;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ll=6,Ka=null;return}}else if(a=p6(a,s,Sn),a!==null){Ka=a;return}if(s=s.sibling,s!==null){Ka=s;return}Ka=s=t}while(s!==null);ll===0&&(ll=5)}function yd(t,s,a){var l=ws,n=tr.transition;try{tr.transition=null,ws=1,w6(t,s,a,l)}finally{tr.transition=n,ws=l}return null}function w6(t,s,a,l){do du();while(No!==null);if(os&6)throw Error(at(327));a=t.finishedWork;var n=t.finishedLanes;if(a===null)return null;if(t.finishedWork=null,t.finishedLanes=0,a===t.current)throw Error(at(177));t.callbackNode=null,t.callbackPriority=0;var r=a.lanes|a.childLanes;if(aP(t,r),t===pl&&(Ka=pl=null,wl=0),!(a.subtreeFlags&2064)&&!(a.flags&2064)||Pp||(Pp=!0,GS(C0,function(){return du(),null})),r=(a.flags&15990)!==0,a.subtreeFlags&15990||r){r=tr.transition,tr.transition=null;var i=ws;ws=1;var o=os;os|=4,tN.current=null,f6(t,a),DS(a,t),GP(sj),A0=!!tj,sj=tj=null,t.current=a,v6(a),XM(),os=o,ws=i,tr.transition=r}else t.current=a;if(Pp&&(Pp=!1,No=t,G0=n),r=t.pendingLanes,r===0&&(Do=null),YM(a.stateNode),hn(t,Ta()),s!==null)for(l=t.onRecoverableError,a=0;a<s.length;a++)n=s[a],l(n.value,{componentStack:n.stack,digest:n.digest});if(B0)throw B0=!1,t=Nj,Nj=null,t;return G0&1&&t.tag!==0&&du(),r=t.pendingLanes,r&1?t===wj?sx++:(sx=0,wj=t):sx=0,Ho(),null}function du(){if(No!==null){var t=j3(G0),s=tr.transition,a=ws;try{if(tr.transition=null,ws=16>t?16:t,No===null)var l=!1;else{if(t=No,No=null,G0=0,os&6)throw Error(at(331));var n=os;for(os|=4,bt=t.current;bt!==null;){var r=bt,i=r.child;if(bt.flags&16){var o=r.deletions;if(o!==null){for(var c=0;c<o.length;c++){var x=o[c];for(bt=x;bt!==null;){var j=bt;switch(j.tag){case 0:case 11:case 15:ex(8,j,r)}var g=j.child;if(g!==null)g.return=j,bt=g;else for(;bt!==null;){j=bt;var y=j.sibling,$=j.return;if(OS(j),j===x){bt=null;break}if(y!==null){y.return=$,bt=y;break}bt=$}}}var T=r.alternate;if(T!==null){var C=T.child;if(C!==null){T.child=null;do{var W=C.sibling;C.sibling=null,C=W}while(C!==null)}}bt=r}}if(r.subtreeFlags&2064&&i!==null)i.return=r,bt=i;else e:for(;bt!==null;){if(r=bt,r.flags&2048)switch(r.tag){case 0:case 11:case 15:ex(9,r,r.return)}var L=r.sibling;if(L!==null){L.return=r.return,bt=L;break e}bt=r.return}}var R=t.current;for(bt=R;bt!==null;){i=bt;var F=i.child;if(i.subtreeFlags&2064&&F!==null)F.return=i,bt=F;else e:for(i=R;bt!==null;){if(o=bt,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Pg(9,o)}}catch(oe){ja(o,o.return,oe)}if(o===i){bt=null;break e}var te=o.sibling;if(te!==null){te.return=o.return,bt=te;break e}bt=o.return}}if(os=n,Ho(),Zr&&typeof Zr.onPostCommitFiberRoot=="function")try{Zr.onPostCommitFiberRoot(Ng,t)}catch{}l=!0}return l}finally{ws=a,tr.transition=s}}return!1}function I2(t,s,a){s=bu(a,s),s=jS(t,s,1),t=Ro(t,s,1),s=Yl(),t!==null&&(Zx(t,1,s),hn(t,s))}function ja(t,s,a){if(t.tag===3)I2(t,t,a);else for(;s!==null;){if(s.tag===3){I2(s,t,a);break}else if(s.tag===1){var l=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(Do===null||!Do.has(l))){t=bu(a,t),t=yS(s,t,1),s=Ro(s,t,1),t=Yl(),s!==null&&(Zx(s,1,t),hn(s,t));break}}s=s.return}}function k6(t,s,a){var l=t.pingCache;l!==null&&l.delete(s),s=Yl(),t.pingedLanes|=t.suspendedLanes&a,pl===t&&(wl&a)===a&&(ll===4||ll===3&&(wl&130023424)===wl&&500>Ta()-aN?Id(t,0):sN|=a),hn(t,s)}function _S(t,s){s===0&&(t.mode&1?(s=jp,jp<<=1,!(jp&130023424)&&(jp=4194304)):s=1);var a=Yl();t=Ti(t,s),t!==null&&(Zx(t,s,a),hn(t,a))}function C6(t){var s=t.memoizedState,a=0;s!==null&&(a=s.retryLane),_S(t,a)}function S6(t,s){var a=0;switch(t.tag){case 13:var l=t.stateNode,n=t.memoizedState;n!==null&&(a=n.retryLane);break;case 19:l=t.stateNode;break;default:throw Error(at(314))}l!==null&&l.delete(s),_S(t,a)}var BS;BS=function(t,s,a){if(t!==null)if(t.memoizedProps!==s.pendingProps||xn.current)mn=!0;else{if(!(t.lanes&a)&&!(s.flags&128))return mn=!1,x6(t,s,a);mn=!!(t.flags&131072)}else mn=!1,ra&&s.flags&1048576&&W3(s,D0,s.index);switch(s.lanes=0,s.tag){case 2:var l=s.type;a0(t,s),t=s.pendingProps;var n=hu(s,Fl.current);ou(s,a),n=Qy(null,s,l,t,n,a);var r=Yy();return s.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,pn(l)?(r=!0,T0(s)):r=!1,s.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,zy(s),n.updater=Mg,s.stateNode=n,n._reactInternals=s,uj(s,l,t,a),s=pj(null,s,l,!0,r,a)):(s.tag=0,ra&&r&&Fy(s),Wl(null,s,n,a),s=s.child),s;case 16:l=s.elementType;e:{switch(a0(t,s),t=s.pendingProps,n=l._init,l=n(l._payload),s.type=l,n=s.tag=E6(l),t=vr(l,t),n){case 0:s=xj(null,s,l,t,a);break e;case 1:s=C2(null,s,l,t,a);break e;case 11:s=w2(null,s,l,t,a);break e;case 14:s=k2(null,s,l,vr(l.type,t),a);break e}throw Error(at(306,l,""))}return s;case 0:return l=s.type,n=s.pendingProps,n=s.elementType===l?n:vr(l,n),xj(t,s,l,n,a);case 1:return l=s.type,n=s.pendingProps,n=s.elementType===l?n:vr(l,n),C2(t,s,l,n,a);case 3:e:{if(CS(s),t===null)throw Error(at(387));l=s.pendingProps,r=s.memoizedState,n=r.element,J3(t,s),L0(s,l,null,a);var i=s.memoizedState;if(l=i.element,r.isDehydrated)if(r={element:l,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},s.updateQueue.baseState=r,s.memoizedState=r,s.flags&256){n=bu(Error(at(423)),s),s=S2(t,s,l,a,n);break e}else if(l!==n){n=bu(Error(at(424)),s),s=S2(t,s,l,a,n);break e}else for(Pn=To(s.stateNode.containerInfo.firstChild),On=s,ra=!0,yr=null,a=Q3(s,null,l,a),s.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(gu(),l===n){s=Ri(t,s,a);break e}Wl(t,s,l,a)}s=s.child}return s;case 5:return Z3(s),t===null&&oj(s),l=s.type,n=s.pendingProps,r=t!==null?t.memoizedProps:null,i=n.children,aj(l,n)?i=null:r!==null&&aj(l,r)&&(s.flags|=32),kS(t,s),Wl(t,s,i,a),s.child;case 6:return t===null&&oj(s),null;case 13:return SS(t,s,a);case 4:return Wy(s,s.stateNode.containerInfo),l=s.pendingProps,t===null?s.child=fu(s,null,l,a):Wl(t,s,l,a),s.child;case 11:return l=s.type,n=s.pendingProps,n=s.elementType===l?n:vr(l,n),w2(t,s,l,n,a);case 7:return Wl(t,s,s.pendingProps,a),s.child;case 8:return Wl(t,s,s.pendingProps.children,a),s.child;case 12:return Wl(t,s,s.pendingProps.children,a),s.child;case 10:e:{if(l=s.type._context,n=s.pendingProps,r=s.memoizedProps,i=n.value,Us(I0,l._currentValue),l._currentValue=i,r!==null)if(Pr(r.value,i)){if(r.children===n.children&&!xn.current){s=Ri(t,s,a);break e}}else for(r=s.child,r!==null&&(r.return=s);r!==null;){var o=r.dependencies;if(o!==null){i=r.child;for(var c=o.firstContext;c!==null;){if(c.context===l){if(r.tag===1){c=Ai(-1,a&-a),c.tag=2;var x=r.updateQueue;if(x!==null){x=x.shared;var j=x.pending;j===null?c.next=c:(c.next=j.next,j.next=c),x.pending=c}}r.lanes|=a,c=r.alternate,c!==null&&(c.lanes|=a),dj(r.return,a,s),o.lanes|=a;break}c=c.next}}else if(r.tag===10)i=r.type===s.type?null:r.child;else if(r.tag===18){if(i=r.return,i===null)throw Error(at(341));i.lanes|=a,o=i.alternate,o!==null&&(o.lanes|=a),dj(i,a,s),i=r.sibling}else i=r.child;if(i!==null)i.return=r;else for(i=r;i!==null;){if(i===s){i=null;break}if(r=i.sibling,r!==null){r.return=i.return,i=r;break}i=i.return}r=i}Wl(t,s,n.children,a),s=s.child}return s;case 9:return n=s.type,l=s.pendingProps.children,ou(s,a),n=sr(n),l=l(n),s.flags|=1,Wl(t,s,l,a),s.child;case 14:return l=s.type,n=vr(l,s.pendingProps),n=vr(l.type,n),k2(t,s,l,n,a);case 15:return NS(t,s,s.type,s.pendingProps,a);case 17:return l=s.type,n=s.pendingProps,n=s.elementType===l?n:vr(l,n),a0(t,s),s.tag=1,pn(l)?(t=!0,T0(s)):t=!1,ou(s,a),bS(s,l,n),uj(s,l,n,a),pj(null,s,l,!0,t,a);case 19:return AS(t,s,a);case 22:return wS(t,s,a)}throw Error(at(156,s.tag))};function GS(t,s){return g3(t,s)}function A6(t,s,a,l){this.tag=t,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function er(t,s,a,l){return new A6(t,s,a,l)}function iN(t){return t=t.prototype,!(!t||!t.isReactComponent)}function E6(t){if(typeof t=="function")return iN(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Sy)return 11;if(t===Ay)return 14}return 2}function $o(t,s){var a=t.alternate;return a===null?(a=er(t.tag,s,t.key,t.mode),a.elementType=t.elementType,a.type=t.type,a.stateNode=t.stateNode,a.alternate=t,t.alternate=a):(a.pendingProps=s,a.type=t.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=t.flags&14680064,a.childLanes=t.childLanes,a.lanes=t.lanes,a.child=t.child,a.memoizedProps=t.memoizedProps,a.memoizedState=t.memoizedState,a.updateQueue=t.updateQueue,s=t.dependencies,a.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},a.sibling=t.sibling,a.index=t.index,a.ref=t.ref,a}function r0(t,s,a,l,n,r){var i=2;if(l=t,typeof t=="function")iN(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case Uc:return $d(a.children,n,r,s);case Cy:i=8,n|=8;break;case Ib:return t=er(12,a,s,n|2),t.elementType=Ib,t.lanes=r,t;case $b:return t=er(13,a,s,n),t.elementType=$b,t.lanes=r,t;case Lb:return t=er(19,a,s,n),t.elementType=Lb,t.lanes=r,t;case ZC:return Tg(a,n,r,s);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case YC:i=10;break e;case JC:i=9;break e;case Sy:i=11;break e;case Ay:i=14;break e;case po:i=16,l=null;break e}throw Error(at(130,t==null?t:typeof t,""))}return s=er(i,a,s,n),s.elementType=t,s.type=l,s.lanes=r,s}function $d(t,s,a,l){return t=er(7,t,l,s),t.lanes=a,t}function Tg(t,s,a,l){return t=er(22,t,l,s),t.elementType=ZC,t.lanes=a,t.stateNode={isHidden:!1},t}function Jf(t,s,a){return t=er(6,t,null,s),t.lanes=a,t}function Zf(t,s,a){return s=er(4,t.children!==null?t.children:[],t.key,s),s.lanes=a,s.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},s}function M6(t,s,a,l,n){this.tag=s,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Rf(0),this.expirationTimes=Rf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Rf(0),this.identifierPrefix=l,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function oN(t,s,a,l,n,r,i,o,c){return t=new M6(t,s,a,o,c),s===1?(s=1,r===!0&&(s|=8)):s=0,r=er(3,null,null,s),t.current=r,r.stateNode=t,r.memoizedState={element:l,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},zy(r),t}function P6(t,s,a){var l=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fc,key:l==null?null:""+l,children:t,containerInfo:s,implementation:a}}function qS(t){if(!t)return _o;t=t._reactInternals;e:{if(Xd(t)!==t||t.tag!==1)throw Error(at(170));var s=t;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(pn(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(at(171))}if(t.tag===1){var a=t.type;if(pn(a))return q3(t,a,s)}return s}function zS(t,s,a,l,n,r,i,o,c){return t=oN(a,l,!0,t,n,r,i,o,c),t.context=qS(null),a=t.current,l=Yl(),n=Io(a),r=Ai(l,n),r.callback=s??null,Ro(a,r,n),t.current.lanes=n,Zx(t,n,l),hn(t,l),t}function Rg(t,s,a,l){var n=s.current,r=Yl(),i=Io(n);return a=qS(a),s.context===null?s.context=a:s.pendingContext=a,s=Ai(r,i),s.payload={element:t},l=l===void 0?null:l,l!==null&&(s.callback=l),t=Ro(n,s,i),t!==null&&(Ar(t,n,i,r),e0(t,n,i)),i}function z0(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function $2(t,s){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var a=t.retryLane;t.retryLane=a!==0&&a<s?a:s}}function dN(t,s){$2(t,s),(t=t.alternate)&&$2(t,s)}function O6(){return null}var WS=typeof reportError=="function"?reportError:function(t){console.error(t)};function cN(t){this._internalRoot=t}Dg.prototype.render=cN.prototype.render=function(t){var s=this._internalRoot;if(s===null)throw Error(at(409));Rg(t,s,null,null)};Dg.prototype.unmount=cN.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var s=t.containerInfo;qd(function(){Rg(null,t,null,null)}),s[Oi]=null}};function Dg(t){this._internalRoot=t}Dg.prototype.unstable_scheduleHydration=function(t){if(t){var s=w3();t={blockedOn:null,target:t,priority:s};for(var a=0;a<fo.length&&s!==0&&s<fo[a].priority;a++);fo.splice(a,0,t),a===0&&C3(t)}};function uN(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ig(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function L2(){}function T6(t,s,a,l,n){if(n){if(typeof l=="function"){var r=l;l=function(){var x=z0(i);r.call(x)}}var i=zS(s,l,t,0,null,!1,!1,"",L2);return t._reactRootContainer=i,t[Oi]=i.current,Sx(t.nodeType===8?t.parentNode:t),qd(),i}for(;n=t.lastChild;)t.removeChild(n);if(typeof l=="function"){var o=l;l=function(){var x=z0(c);o.call(x)}}var c=oN(t,0,!1,null,null,!1,!1,"",L2);return t._reactRootContainer=c,t[Oi]=c.current,Sx(t.nodeType===8?t.parentNode:t),qd(function(){Rg(s,c,a,l)}),c}function $g(t,s,a,l,n){var r=a._reactRootContainer;if(r){var i=r;if(typeof n=="function"){var o=n;n=function(){var c=z0(i);o.call(c)}}Rg(s,i,t,n)}else i=T6(a,s,t,n,l);return z0(i)}y3=function(t){switch(t.tag){case 3:var s=t.stateNode;if(s.current.memoizedState.isDehydrated){var a=_m(s.pendingLanes);a!==0&&(Py(s,a|1),hn(s,Ta()),!(os&6)&&(ju=Ta()+500,Ho()))}break;case 13:qd(function(){var l=Ti(t,1);if(l!==null){var n=Yl();Ar(l,t,1,n)}}),dN(t,1)}};Oy=function(t){if(t.tag===13){var s=Ti(t,134217728);if(s!==null){var a=Yl();Ar(s,t,134217728,a)}dN(t,134217728)}};N3=function(t){if(t.tag===13){var s=Io(t),a=Ti(t,s);if(a!==null){var l=Yl();Ar(a,t,s,l)}dN(t,s)}};w3=function(){return ws};k3=function(t,s){var a=ws;try{return ws=t,s()}finally{ws=a}};Hb=function(t,s,a){switch(s){case"input":if(Vb(t,a),s=a.name,a.type==="radio"&&s!=null){for(a=t;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<a.length;s++){var l=a[s];if(l!==t&&l.form===t.form){var n=Sg(l);if(!n)throw Error(at(90));t3(l),Vb(l,n)}}}break;case"textarea":a3(t,a);break;case"select":s=a.value,s!=null&&lu(t,!!a.multiple,s,!1)}};c3=lN;u3=qd;var R6={usingClientEntryPoint:!1,Events:[tp,Gc,Sg,o3,d3,lN]},Qu={findFiberByHostInstance:Md,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},D6={bundleType:Qu.bundleType,version:Qu.version,rendererPackageName:Qu.rendererPackageName,rendererConfig:Qu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ui.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=p3(t),t===null?null:t.stateNode},findFiberByHostInstance:Qu.findFiberByHostInstance||O6,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Op=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Op.isDisabled&&Op.supportsFiber)try{Ng=Op.inject(D6),Zr=Op}catch{}}Ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R6;Ln.createPortal=function(t,s){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!uN(s))throw Error(at(200));return P6(t,s,null,a)};Ln.createRoot=function(t,s){if(!uN(t))throw Error(at(299));var a=!1,l="",n=WS;return s!=null&&(s.unstable_strictMode===!0&&(a=!0),s.identifierPrefix!==void 0&&(l=s.identifierPrefix),s.onRecoverableError!==void 0&&(n=s.onRecoverableError)),s=oN(t,1,!1,null,null,a,!1,l,n),t[Oi]=s.current,Sx(t.nodeType===8?t.parentNode:t),new cN(s)};Ln.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var s=t._reactInternals;if(s===void 0)throw typeof t.render=="function"?Error(at(188)):(t=Object.keys(t).join(","),Error(at(268,t)));return t=p3(s),t=t===null?null:t.stateNode,t};Ln.flushSync=function(t){return qd(t)};Ln.hydrate=function(t,s,a){if(!Ig(s))throw Error(at(200));return $g(null,t,s,!0,a)};Ln.hydrateRoot=function(t,s,a){if(!uN(t))throw Error(at(405));var l=a!=null&&a.hydratedSources||null,n=!1,r="",i=WS;if(a!=null&&(a.unstable_strictMode===!0&&(n=!0),a.identifierPrefix!==void 0&&(r=a.identifierPrefix),a.onRecoverableError!==void 0&&(i=a.onRecoverableError)),s=zS(s,null,t,1,a??null,n,!1,r,i),t[Oi]=s.current,Sx(t),l)for(t=0;t<l.length;t++)a=l[t],n=a._getVersion,n=n(a._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[a,n]:s.mutableSourceEagerHydrationData.push(a,n);return new Dg(s)};Ln.render=function(t,s,a){if(!Ig(s))throw Error(at(200));return $g(null,t,s,!1,a)};Ln.unmountComponentAtNode=function(t){if(!Ig(t))throw Error(at(40));return t._reactRootContainer?(qd(function(){$g(null,null,t,!1,function(){t._reactRootContainer=null,t[Oi]=null})}),!0):!1};Ln.unstable_batchedUpdates=lN;Ln.unstable_renderSubtreeIntoContainer=function(t,s,a,l){if(!Ig(a))throw Error(at(200));if(t==null||t._reactInternals===void 0)throw Error(at(38));return $g(t,s,a,!1,l)};Ln.version="18.3.1-next-f1338f8080-20240426";function HS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(HS)}catch(t){console.error(t)}}HS(),HC.exports=Ln;var Lg=HC.exports,F2=Lg;Rb.createRoot=F2.createRoot,Rb.hydrateRoot=F2.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ix(){return Ix=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(t[l]=a[l])}return t},Ix.apply(this,arguments)}var wo;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(wo||(wo={}));const U2="popstate";function I6(t){t===void 0&&(t={});function s(l,n){let{pathname:r,search:i,hash:o}=l.location;return Sj("",{pathname:r,search:i,hash:o},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function a(l,n){return typeof n=="string"?n:W0(n)}return L6(s,a,null,t)}function $a(t,s){if(t===!1||t===null||typeof t>"u")throw new Error(s)}function mN(t,s){if(!t){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function $6(){return Math.random().toString(36).substr(2,8)}function V2(t,s){return{usr:t.state,key:t.key,idx:s}}function Sj(t,s,a,l){return a===void 0&&(a=null),Ix({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof s=="string"?Pu(s):s,{state:a,key:s&&s.key||l||$6()})}function W0(t){let{pathname:s="/",search:a="",hash:l=""}=t;return a&&a!=="?"&&(s+=a.charAt(0)==="?"?a:"?"+a),l&&l!=="#"&&(s+=l.charAt(0)==="#"?l:"#"+l),s}function Pu(t){let s={};if(t){let a=t.indexOf("#");a>=0&&(s.hash=t.substr(a),t=t.substr(0,a));let l=t.indexOf("?");l>=0&&(s.search=t.substr(l),t=t.substr(0,l)),t&&(s.pathname=t)}return s}function L6(t,s,a,l){l===void 0&&(l={});let{window:n=document.defaultView,v5Compat:r=!1}=l,i=n.history,o=wo.Pop,c=null,x=j();x==null&&(x=0,i.replaceState(Ix({},i.state,{idx:x}),""));function j(){return(i.state||{idx:null}).idx}function g(){o=wo.Pop;let W=j(),L=W==null?null:W-x;x=W,c&&c({action:o,location:C.location,delta:L})}function y(W,L){o=wo.Push;let R=Sj(C.location,W,L);x=j()+1;let F=V2(R,x),te=C.createHref(R);try{i.pushState(F,"",te)}catch(oe){if(oe instanceof DOMException&&oe.name==="DataCloneError")throw oe;n.location.assign(te)}r&&c&&c({action:o,location:C.location,delta:1})}function $(W,L){o=wo.Replace;let R=Sj(C.location,W,L);x=j();let F=V2(R,x),te=C.createHref(R);i.replaceState(F,"",te),r&&c&&c({action:o,location:C.location,delta:0})}function T(W){let L=n.location.origin!=="null"?n.location.origin:n.location.href,R=typeof W=="string"?W:W0(W);return R=R.replace(/ $/,"%20"),$a(L,"No window.location.(origin|href) available to create URL for href: "+R),new URL(R,L)}let C={get action(){return o},get location(){return t(n,i)},listen(W){if(c)throw new Error("A history only accepts one active listener");return n.addEventListener(U2,g),c=W,()=>{n.removeEventListener(U2,g),c=null}},createHref(W){return s(n,W)},createURL:T,encodeLocation(W){let L=T(W);return{pathname:L.pathname,search:L.search,hash:L.hash}},push:y,replace:$,go(W){return i.go(W)}};return C}var _2;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(_2||(_2={}));function F6(t,s,a){return a===void 0&&(a="/"),U6(t,s,a)}function U6(t,s,a,l){let n=typeof s=="string"?Pu(s):s,r=xN(n.pathname||"/",a);if(r==null)return null;let i=XS(t);V6(i);let o=null;for(let c=0;o==null&&c<i.length;++c){let x=J6(r);o=K6(i[c],x)}return o}function XS(t,s,a,l){s===void 0&&(s=[]),a===void 0&&(a=[]),l===void 0&&(l="");let n=(r,i,o)=>{let c={relativePath:o===void 0?r.path||"":o,caseSensitive:r.caseSensitive===!0,childrenIndex:i,route:r};c.relativePath.startsWith("/")&&($a(c.relativePath.startsWith(l),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+l+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(l.length));let x=Lo([l,c.relativePath]),j=a.concat(c);r.children&&r.children.length>0&&($a(r.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+x+'".')),XS(r.children,s,j,x)),!(r.path==null&&!r.index)&&s.push({path:x,score:H6(x,r.index),routesMeta:j})};return t.forEach((r,i)=>{var o;if(r.path===""||!((o=r.path)!=null&&o.includes("?")))n(r,i);else for(let c of KS(r.path))n(r,i,c)}),s}function KS(t){let s=t.split("/");if(s.length===0)return[];let[a,...l]=s,n=a.endsWith("?"),r=a.replace(/\?$/,"");if(l.length===0)return n?[r,""]:[r];let i=KS(l.join("/")),o=[];return o.push(...i.map(c=>c===""?r:[r,c].join("/"))),n&&o.push(...i),o.map(c=>t.startsWith("/")&&c===""?"/":c)}function V6(t){t.sort((s,a)=>s.score!==a.score?a.score-s.score:X6(s.routesMeta.map(l=>l.childrenIndex),a.routesMeta.map(l=>l.childrenIndex)))}const _6=/^:[\w-]+$/,B6=3,G6=2,q6=1,z6=10,W6=-2,B2=t=>t==="*";function H6(t,s){let a=t.split("/"),l=a.length;return a.some(B2)&&(l+=W6),s&&(l+=G6),a.filter(n=>!B2(n)).reduce((n,r)=>n+(_6.test(r)?B6:r===""?q6:z6),l)}function X6(t,s){return t.length===s.length&&t.slice(0,-1).every((l,n)=>l===s[n])?t[t.length-1]-s[s.length-1]:0}function K6(t,s,a){let{routesMeta:l}=t,n={},r="/",i=[];for(let o=0;o<l.length;++o){let c=l[o],x=o===l.length-1,j=r==="/"?s:s.slice(r.length)||"/",g=Q6({path:c.relativePath,caseSensitive:c.caseSensitive,end:x},j),y=c.route;if(!g)return null;Object.assign(n,g.params),i.push({params:n,pathname:Lo([r,g.pathname]),pathnameBase:aO(Lo([r,g.pathnameBase])),route:y}),g.pathnameBase!=="/"&&(r=Lo([r,g.pathnameBase]))}return i}function Q6(t,s){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[a,l]=Y6(t.path,t.caseSensitive,t.end),n=s.match(a);if(!n)return null;let r=n[0],i=r.replace(/(.)\/+$/,"$1"),o=n.slice(1);return{params:l.reduce((x,j,g)=>{let{paramName:y,isOptional:$}=j;if(y==="*"){let C=o[g]||"";i=r.slice(0,r.length-C.length).replace(/(.)\/+$/,"$1")}const T=o[g];return $&&!T?x[y]=void 0:x[y]=(T||"").replace(/%2F/g,"/"),x},{}),pathname:r,pathnameBase:i,pattern:t}}function Y6(t,s,a){s===void 0&&(s=!1),a===void 0&&(a=!0),mN(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let l=[],n="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,c)=>(l.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(l.push({paramName:"*"}),n+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?n+="\\/*$":t!==""&&t!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,s?void 0:"i"),l]}function J6(t){try{return t.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return mN(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+s+").")),t}}function xN(t,s){if(s==="/")return t;if(!t.toLowerCase().startsWith(s.toLowerCase()))return null;let a=s.endsWith("/")?s.length-1:s.length,l=t.charAt(a);return l&&l!=="/"?null:t.slice(a)||"/"}const Z6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,eO=t=>Z6.test(t);function tO(t,s){s===void 0&&(s="/");let{pathname:a,search:l="",hash:n=""}=typeof t=="string"?Pu(t):t,r;if(a)if(eO(a))r=a;else{if(a.includes("//")){let i=a;a=a.replace(/\/\/+/g,"/"),mN(!1,"Pathnames cannot have embedded double slashes - normalizing "+(i+" -> "+a))}a.startsWith("/")?r=G2(a.substring(1),"/"):r=G2(a,s)}else r=s;return{pathname:r,search:lO(l),hash:nO(n)}}function G2(t,s){let a=s.replace(/\/+$/,"").split("/");return t.split("/").forEach(n=>{n===".."?a.length>1&&a.pop():n!=="."&&a.push(n)}),a.length>1?a.join("/"):"/"}function ev(t,s,a,l){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+s+"` field ["+JSON.stringify(l)+"].  Please separate it out to the ")+("`to."+a+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function sO(t){return t.filter((s,a)=>a===0||s.route.path&&s.route.path.length>0)}function pN(t,s){let a=sO(t);return s?a.map((l,n)=>n===a.length-1?l.pathname:l.pathnameBase):a.map(l=>l.pathnameBase)}function hN(t,s,a,l){l===void 0&&(l=!1);let n;typeof t=="string"?n=Pu(t):(n=Ix({},t),$a(!n.pathname||!n.pathname.includes("?"),ev("?","pathname","search",n)),$a(!n.pathname||!n.pathname.includes("#"),ev("#","pathname","hash",n)),$a(!n.search||!n.search.includes("#"),ev("#","search","hash",n)));let r=t===""||n.pathname==="",i=r?"/":n.pathname,o;if(i==null)o=a;else{let g=s.length-1;if(!l&&i.startsWith("..")){let y=i.split("/");for(;y[0]==="..";)y.shift(),g-=1;n.pathname=y.join("/")}o=g>=0?s[g]:"/"}let c=tO(n,o),x=i&&i!=="/"&&i.endsWith("/"),j=(r||i===".")&&a.endsWith("/");return!c.pathname.endsWith("/")&&(x||j)&&(c.pathname+="/"),c}const Lo=t=>t.join("/").replace(/\/\/+/g,"/"),aO=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),lO=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,nO=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function rO(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const QS=["post","put","patch","delete"];new Set(QS);const iO=["get",...QS];new Set(iO);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $x(){return $x=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(t[l]=a[l])}return t},$x.apply(this,arguments)}const gN=d.createContext(null),oO=d.createContext(null),Xo=d.createContext(null),Fg=d.createContext(null),Vi=d.createContext({outlet:null,matches:[],isDataRoute:!1}),YS=d.createContext(null);function dO(t,s){let{relative:a}=s===void 0?{}:s;Ou()||$a(!1);let{basename:l,navigator:n}=d.useContext(Xo),{hash:r,pathname:i,search:o}=e5(t,{relative:a}),c=i;return l!=="/"&&(c=i==="/"?l:Lo([l,i])),n.createHref({pathname:c,search:o,hash:r})}function Ou(){return d.useContext(Fg)!=null}function ap(){return Ou()||$a(!1),d.useContext(Fg).location}function JS(t){d.useContext(Xo).static||d.useLayoutEffect(t)}function Kd(){let{isDataRoute:t}=d.useContext(Vi);return t?NO():cO()}function cO(){Ou()||$a(!1);let t=d.useContext(gN),{basename:s,future:a,navigator:l}=d.useContext(Xo),{matches:n}=d.useContext(Vi),{pathname:r}=ap(),i=JSON.stringify(pN(n,a.v7_relativeSplatPath)),o=d.useRef(!1);return JS(()=>{o.current=!0}),d.useCallback(function(x,j){if(j===void 0&&(j={}),!o.current)return;if(typeof x=="number"){l.go(x);return}let g=hN(x,JSON.parse(i),r,j.relative==="path");t==null&&s!=="/"&&(g.pathname=g.pathname==="/"?s:Lo([s,g.pathname])),(j.replace?l.replace:l.push)(g,j.state,j)},[s,l,i,r,t])}function ZS(){let{matches:t}=d.useContext(Vi),s=t[t.length-1];return s?s.params:{}}function e5(t,s){let{relative:a}=s===void 0?{}:s,{future:l}=d.useContext(Xo),{matches:n}=d.useContext(Vi),{pathname:r}=ap(),i=JSON.stringify(pN(n,l.v7_relativeSplatPath));return d.useMemo(()=>hN(t,JSON.parse(i),r,a==="path"),[t,i,r,a])}function uO(t,s){return mO(t,s)}function mO(t,s,a,l){Ou()||$a(!1);let{navigator:n}=d.useContext(Xo),{matches:r}=d.useContext(Vi),i=r[r.length-1],o=i?i.params:{};i&&i.pathname;let c=i?i.pathnameBase:"/";i&&i.route;let x=ap(),j;if(s){var g;let W=typeof s=="string"?Pu(s):s;c==="/"||(g=W.pathname)!=null&&g.startsWith(c)||$a(!1),j=W}else j=x;let y=j.pathname||"/",$=y;if(c!=="/"){let W=c.replace(/^\//,"").split("/");$="/"+y.replace(/^\//,"").split("/").slice(W.length).join("/")}let T=F6(t,{pathname:$}),C=fO(T&&T.map(W=>Object.assign({},W,{params:Object.assign({},o,W.params),pathname:Lo([c,n.encodeLocation?n.encodeLocation(W.pathname).pathname:W.pathname]),pathnameBase:W.pathnameBase==="/"?c:Lo([c,n.encodeLocation?n.encodeLocation(W.pathnameBase).pathname:W.pathnameBase])})),r,a,l);return s&&C?d.createElement(Fg.Provider,{value:{location:$x({pathname:"/",search:"",hash:"",state:null,key:"default"},j),navigationType:wo.Pop}},C):C}function xO(){let t=yO(),s=rO(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),a=t instanceof Error?t.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return d.createElement(d.Fragment,null,d.createElement("h2",null,"Unexpected Application Error!"),d.createElement("h3",{style:{fontStyle:"italic"}},s),a?d.createElement("pre",{style:n},a):null,null)}const pO=d.createElement(xO,null);class hO extends d.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,a){return a.location!==s.location||a.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:a.error,location:a.location,revalidation:s.revalidation||a.revalidation}}componentDidCatch(s,a){console.error("React Router caught the following error during render",s,a)}render(){return this.state.error!==void 0?d.createElement(Vi.Provider,{value:this.props.routeContext},d.createElement(YS.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function gO(t){let{routeContext:s,match:a,children:l}=t,n=d.useContext(gN);return n&&n.static&&n.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=a.route.id),d.createElement(Vi.Provider,{value:s},l)}function fO(t,s,a,l){var n;if(s===void 0&&(s=[]),a===void 0&&(a=null),l===void 0&&(l=null),t==null){var r;if(!a)return null;if(a.errors)t=a.matches;else if((r=l)!=null&&r.v7_partialHydration&&s.length===0&&!a.initialized&&a.matches.length>0)t=a.matches;else return null}let i=t,o=(n=a)==null?void 0:n.errors;if(o!=null){let j=i.findIndex(g=>g.route.id&&(o==null?void 0:o[g.route.id])!==void 0);j>=0||$a(!1),i=i.slice(0,Math.min(i.length,j+1))}let c=!1,x=-1;if(a&&l&&l.v7_partialHydration)for(let j=0;j<i.length;j++){let g=i[j];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(x=j),g.route.id){let{loaderData:y,errors:$}=a,T=g.route.loader&&y[g.route.id]===void 0&&(!$||$[g.route.id]===void 0);if(g.route.lazy||T){c=!0,x>=0?i=i.slice(0,x+1):i=[i[0]];break}}}return i.reduceRight((j,g,y)=>{let $,T=!1,C=null,W=null;a&&($=o&&g.route.id?o[g.route.id]:void 0,C=g.route.errorElement||pO,c&&(x<0&&y===0?(wO("route-fallback"),T=!0,W=null):x===y&&(T=!0,W=g.route.hydrateFallbackElement||null)));let L=s.concat(i.slice(0,y+1)),R=()=>{let F;return $?F=C:T?F=W:g.route.Component?F=d.createElement(g.route.Component,null):g.route.element?F=g.route.element:F=j,d.createElement(gO,{match:g,routeContext:{outlet:j,matches:L,isDataRoute:a!=null},children:F})};return a&&(g.route.ErrorBoundary||g.route.errorElement||y===0)?d.createElement(hO,{location:a.location,revalidation:a.revalidation,component:C,error:$,children:R(),routeContext:{outlet:null,matches:L,isDataRoute:!0}}):R()},null)}var t5=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(t5||{}),s5=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(s5||{});function vO(t){let s=d.useContext(gN);return s||$a(!1),s}function bO(t){let s=d.useContext(oO);return s||$a(!1),s}function jO(t){let s=d.useContext(Vi);return s||$a(!1),s}function a5(t){let s=jO(),a=s.matches[s.matches.length-1];return a.route.id||$a(!1),a.route.id}function yO(){var t;let s=d.useContext(YS),a=bO(),l=a5();return s!==void 0?s:(t=a.errors)==null?void 0:t[l]}function NO(){let{router:t}=vO(t5.UseNavigateStable),s=a5(s5.UseNavigateStable),a=d.useRef(!1);return JS(()=>{a.current=!0}),d.useCallback(function(n,r){r===void 0&&(r={}),a.current&&(typeof n=="number"?t.navigate(n):t.navigate(n,$x({fromRouteId:s},r)))},[t,s])}const q2={};function wO(t,s,a){q2[t]||(q2[t]=!0)}function kO(t,s){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function CO(t){let{to:s,replace:a,state:l,relative:n}=t;Ou()||$a(!1);let{future:r,static:i}=d.useContext(Xo),{matches:o}=d.useContext(Vi),{pathname:c}=ap(),x=Kd(),j=hN(s,pN(o,r.v7_relativeSplatPath),c,n==="path"),g=JSON.stringify(j);return d.useEffect(()=>x(JSON.parse(g),{replace:a,state:l,relative:n}),[x,g,n,a,l]),null}function $c(t){$a(!1)}function SO(t){let{basename:s="/",children:a=null,location:l,navigationType:n=wo.Pop,navigator:r,static:i=!1,future:o}=t;Ou()&&$a(!1);let c=s.replace(/^\/*/,"/"),x=d.useMemo(()=>({basename:c,navigator:r,static:i,future:$x({v7_relativeSplatPath:!1},o)}),[c,o,r,i]);typeof l=="string"&&(l=Pu(l));let{pathname:j="/",search:g="",hash:y="",state:$=null,key:T="default"}=l,C=d.useMemo(()=>{let W=xN(j,c);return W==null?null:{location:{pathname:W,search:g,hash:y,state:$,key:T},navigationType:n}},[c,j,g,y,$,T,n]);return C==null?null:d.createElement(Xo.Provider,{value:x},d.createElement(Fg.Provider,{children:a,value:C}))}function AO(t){let{children:s,location:a}=t;return uO(Aj(s),a)}new Promise(()=>{});function Aj(t,s){s===void 0&&(s=[]);let a=[];return d.Children.forEach(t,(l,n)=>{if(!d.isValidElement(l))return;let r=[...s,n];if(l.type===d.Fragment){a.push.apply(a,Aj(l.props.children,r));return}l.type!==$c&&$a(!1),!l.props.index||!l.props.children||$a(!1);let i={id:l.props.id||r.join("-"),caseSensitive:l.props.caseSensitive,element:l.props.element,Component:l.props.Component,index:l.props.index,path:l.props.path,loader:l.props.loader,action:l.props.action,errorElement:l.props.errorElement,ErrorBoundary:l.props.ErrorBoundary,hasErrorBoundary:l.props.ErrorBoundary!=null||l.props.errorElement!=null,shouldRevalidate:l.props.shouldRevalidate,handle:l.props.handle,lazy:l.props.lazy};l.props.children&&(i.children=Aj(l.props.children,r)),a.push(i)}),a}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ej(){return Ej=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(t[l]=a[l])}return t},Ej.apply(this,arguments)}function EO(t,s){if(t==null)return{};var a={},l=Object.keys(t),n,r;for(r=0;r<l.length;r++)n=l[r],!(s.indexOf(n)>=0)&&(a[n]=t[n]);return a}function MO(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function PO(t,s){return t.button===0&&(!s||s==="_self")&&!MO(t)}const OO=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],TO="6";try{window.__reactRouterVersion=TO}catch{}const RO="startTransition",z2=y0[RO];function DO(t){let{basename:s,children:a,future:l,window:n}=t,r=d.useRef();r.current==null&&(r.current=I6({window:n,v5Compat:!0}));let i=r.current,[o,c]=d.useState({action:i.action,location:i.location}),{v7_startTransition:x}=l||{},j=d.useCallback(g=>{x&&z2?z2(()=>c(g)):c(g)},[c,x]);return d.useLayoutEffect(()=>i.listen(j),[i,j]),d.useEffect(()=>kO(l),[l]),d.createElement(SO,{basename:s,children:a,location:o.location,navigationType:o.action,navigator:i,future:l})}const IO=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",$O=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Tp=d.forwardRef(function(s,a){let{onClick:l,relative:n,reloadDocument:r,replace:i,state:o,target:c,to:x,preventScrollReset:j,viewTransition:g}=s,y=EO(s,OO),{basename:$}=d.useContext(Xo),T,C=!1;if(typeof x=="string"&&$O.test(x)&&(T=x,IO))try{let F=new URL(window.location.href),te=x.startsWith("//")?new URL(F.protocol+x):new URL(x),oe=xN(te.pathname,$);te.origin===F.origin&&oe!=null?x=oe+te.search+te.hash:C=!0}catch{}let W=dO(x,{relative:n}),L=LO(x,{replace:i,state:o,target:c,preventScrollReset:j,relative:n,viewTransition:g});function R(F){l&&l(F),F.defaultPrevented||L(F)}return d.createElement("a",Ej({},y,{href:T||W,onClick:C||r?l:R,ref:a,target:c}))});var W2;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(W2||(W2={}));var H2;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(H2||(H2={}));function LO(t,s){let{target:a,replace:l,state:n,preventScrollReset:r,relative:i,viewTransition:o}=s===void 0?{}:s,c=Kd(),x=ap(),j=e5(t,{relative:i});return d.useCallback(g=>{if(PO(g,a)){g.preventDefault();let y=l!==void 0?l:W0(x)===W0(j);c(t,{replace:y,state:n,preventScrollReset:r,relative:i,viewTransition:o})}},[x,c,j,l,n,a,t,r,i,o])}const Lx={black:"#000",white:"#fff"},Zd={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},ec={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},tc={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},sc={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},ac={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"},Yu={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},FO={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"};function yu(t){let s="https://mui.com/production-error/?code="+t;for(let a=1;a<arguments.length;a+=1)s+="&args[]="+encodeURIComponent(arguments[a]);return"Minified MUI error #"+t+"; visit "+s+" for the full message."}const UO=Object.freeze(Object.defineProperty({__proto__:null,default:yu},Symbol.toStringTag,{value:"Module"})),H0="$$material";function st(){return st=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var l in a)({}).hasOwnProperty.call(a,l)&&(t[l]=a[l])}return t},st.apply(null,arguments)}function wa(t,s){if(t==null)return{};var a={};for(var l in t)if({}.hasOwnProperty.call(t,l)){if(s.indexOf(l)!==-1)continue;a[l]=t[l]}return a}function VO(t){if(t.sheet)return t.sheet;for(var s=0;s<document.styleSheets.length;s++)if(document.styleSheets[s].ownerNode===t)return document.styleSheets[s]}function _O(t){var s=document.createElement("style");return s.setAttribute("data-emotion",t.key),t.nonce!==void 0&&s.setAttribute("nonce",t.nonce),s.appendChild(document.createTextNode("")),s.setAttribute("data-s",""),s}var BO=function(){function t(a){var l=this;this._insertTag=function(n){var r;l.tags.length===0?l.insertionPoint?r=l.insertionPoint.nextSibling:l.prepend?r=l.container.firstChild:r=l.before:r=l.tags[l.tags.length-1].nextSibling,l.container.insertBefore(n,r),l.tags.push(n)},this.isSpeedy=a.speedy===void 0?!0:a.speedy,this.tags=[],this.ctr=0,this.nonce=a.nonce,this.key=a.key,this.container=a.container,this.prepend=a.prepend,this.insertionPoint=a.insertionPoint,this.before=null}var s=t.prototype;return s.hydrate=function(l){l.forEach(this._insertTag)},s.insert=function(l){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(_O(this));var n=this.tags[this.tags.length-1];if(this.isSpeedy){var r=VO(n);try{r.insertRule(l,r.cssRules.length)}catch{}}else n.appendChild(document.createTextNode(l));this.ctr++},s.flush=function(){this.tags.forEach(function(l){var n;return(n=l.parentNode)==null?void 0:n.removeChild(l)}),this.tags=[],this.ctr=0},t}(),Tl="-ms-",X0="-moz-",hs="-webkit-",l5="comm",fN="rule",vN="decl",GO="@import",n5="@keyframes",qO="@layer",zO=Math.abs,Ug=String.fromCharCode,WO=Object.assign;function HO(t,s){return yl(t,0)^45?(((s<<2^yl(t,0))<<2^yl(t,1))<<2^yl(t,2))<<2^yl(t,3):0}function r5(t){return t.trim()}function XO(t,s){return(t=s.exec(t))?t[0]:t}function gs(t,s,a){return t.replace(s,a)}function Mj(t,s){return t.indexOf(s)}function yl(t,s){return t.charCodeAt(s)|0}function Fx(t,s,a){return t.slice(s,a)}function Xr(t){return t.length}function bN(t){return t.length}function Rp(t,s){return s.push(t),t}function KO(t,s){return t.map(s).join("")}var Vg=1,Nu=1,i5=0,fn=0,Xa=0,Tu="";function _g(t,s,a,l,n,r,i){return{value:t,root:s,parent:a,type:l,props:n,children:r,line:Vg,column:Nu,length:i,return:""}}function Ju(t,s){return WO(_g("",null,null,"",null,null,0),t,{length:-t.length},s)}function QO(){return Xa}function YO(){return Xa=fn>0?yl(Tu,--fn):0,Nu--,Xa===10&&(Nu=1,Vg--),Xa}function Tn(){return Xa=fn<i5?yl(Tu,fn++):0,Nu++,Xa===10&&(Nu=1,Vg++),Xa}function ti(){return yl(Tu,fn)}function i0(){return fn}function lp(t,s){return Fx(Tu,t,s)}function Ux(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function o5(t){return Vg=Nu=1,i5=Xr(Tu=t),fn=0,[]}function d5(t){return Tu="",t}function o0(t){return r5(lp(fn-1,Pj(t===91?t+2:t===40?t+1:t)))}function JO(t){for(;(Xa=ti())&&Xa<33;)Tn();return Ux(t)>2||Ux(Xa)>3?"":" "}function ZO(t,s){for(;--s&&Tn()&&!(Xa<48||Xa>102||Xa>57&&Xa<65||Xa>70&&Xa<97););return lp(t,i0()+(s<6&&ti()==32&&Tn()==32))}function Pj(t){for(;Tn();)switch(Xa){case t:return fn;case 34:case 39:t!==34&&t!==39&&Pj(Xa);break;case 40:t===41&&Pj(t);break;case 92:Tn();break}return fn}function eT(t,s){for(;Tn()&&t+Xa!==57;)if(t+Xa===84&&ti()===47)break;return"/*"+lp(s,fn-1)+"*"+Ug(t===47?t:Tn())}function tT(t){for(;!Ux(ti());)Tn();return lp(t,fn)}function sT(t){return d5(d0("",null,null,null,[""],t=o5(t),0,[0],t))}function d0(t,s,a,l,n,r,i,o,c){for(var x=0,j=0,g=i,y=0,$=0,T=0,C=1,W=1,L=1,R=0,F="",te=n,oe=r,G=l,H=F;W;)switch(T=R,R=Tn()){case 40:if(T!=108&&yl(H,g-1)==58){Mj(H+=gs(o0(R),"&","&\f"),"&\f")!=-1&&(L=-1);break}case 34:case 39:case 91:H+=o0(R);break;case 9:case 10:case 13:case 32:H+=JO(T);break;case 92:H+=ZO(i0()-1,7);continue;case 47:switch(ti()){case 42:case 47:Rp(aT(eT(Tn(),i0()),s,a),c);break;default:H+="/"}break;case 123*C:o[x++]=Xr(H)*L;case 125*C:case 59:case 0:switch(R){case 0:case 125:W=0;case 59+j:L==-1&&(H=gs(H,/\f/g,"")),$>0&&Xr(H)-g&&Rp($>32?K2(H+";",l,a,g-1):K2(gs(H," ","")+";",l,a,g-2),c);break;case 59:H+=";";default:if(Rp(G=X2(H,s,a,x,j,n,o,F,te=[],oe=[],g),r),R===123)if(j===0)d0(H,s,G,G,te,r,g,o,oe);else switch(y===99&&yl(H,3)===110?100:y){case 100:case 108:case 109:case 115:d0(t,G,G,l&&Rp(X2(t,G,G,0,0,n,o,F,n,te=[],g),oe),n,oe,g,o,l?te:oe);break;default:d0(H,G,G,G,[""],oe,0,o,oe)}}x=j=$=0,C=L=1,F=H="",g=i;break;case 58:g=1+Xr(H),$=T;default:if(C<1){if(R==123)--C;else if(R==125&&C++==0&&YO()==125)continue}switch(H+=Ug(R),R*C){case 38:L=j>0?1:(H+="\f",-1);break;case 44:o[x++]=(Xr(H)-1)*L,L=1;break;case 64:ti()===45&&(H+=o0(Tn())),y=ti(),j=g=Xr(F=H+=tT(i0())),R++;break;case 45:T===45&&Xr(H)==2&&(C=0)}}return r}function X2(t,s,a,l,n,r,i,o,c,x,j){for(var g=n-1,y=n===0?r:[""],$=bN(y),T=0,C=0,W=0;T<l;++T)for(var L=0,R=Fx(t,g+1,g=zO(C=i[T])),F=t;L<$;++L)(F=r5(C>0?y[L]+" "+R:gs(R,/&\f/g,y[L])))&&(c[W++]=F);return _g(t,s,a,n===0?fN:o,c,x,j)}function aT(t,s,a){return _g(t,s,a,l5,Ug(QO()),Fx(t,2,-2),0)}function K2(t,s,a,l){return _g(t,s,a,vN,Fx(t,0,l),Fx(t,l+1,-1),l)}function cu(t,s){for(var a="",l=bN(t),n=0;n<l;n++)a+=s(t[n],n,t,s)||"";return a}function lT(t,s,a,l){switch(t.type){case qO:if(t.children.length)break;case GO:case vN:return t.return=t.return||t.value;case l5:return"";case n5:return t.return=t.value+"{"+cu(t.children,l)+"}";case fN:t.value=t.props.join(",")}return Xr(a=cu(t.children,l))?t.return=t.value+"{"+a+"}":""}function nT(t){var s=bN(t);return function(a,l,n,r){for(var i="",o=0;o<s;o++)i+=t[o](a,l,n,r)||"";return i}}function rT(t){return function(s){s.root||(s=s.return)&&t(s)}}function c5(t){var s=Object.create(null);return function(a){return s[a]===void 0&&(s[a]=t(a)),s[a]}}var iT=function(s,a,l){for(var n=0,r=0;n=r,r=ti(),n===38&&r===12&&(a[l]=1),!Ux(r);)Tn();return lp(s,fn)},oT=function(s,a){var l=-1,n=44;do switch(Ux(n)){case 0:n===38&&ti()===12&&(a[l]=1),s[l]+=iT(fn-1,a,l);break;case 2:s[l]+=o0(n);break;case 4:if(n===44){s[++l]=ti()===58?"&\f":"",a[l]=s[l].length;break}default:s[l]+=Ug(n)}while(n=Tn());return s},dT=function(s,a){return d5(oT(o5(s),a))},Q2=new WeakMap,cT=function(s){if(!(s.type!=="rule"||!s.parent||s.length<1)){for(var a=s.value,l=s.parent,n=s.column===l.column&&s.line===l.line;l.type!=="rule";)if(l=l.parent,!l)return;if(!(s.props.length===1&&a.charCodeAt(0)!==58&&!Q2.get(l))&&!n){Q2.set(s,!0);for(var r=[],i=dT(a,r),o=l.props,c=0,x=0;c<i.length;c++)for(var j=0;j<o.length;j++,x++)s.props[x]=r[c]?i[c].replace(/&\f/g,o[j]):o[j]+" "+i[c]}}},uT=function(s){if(s.type==="decl"){var a=s.value;a.charCodeAt(0)===108&&a.charCodeAt(2)===98&&(s.return="",s.value="")}};function u5(t,s){switch(HO(t,s)){case 5103:return hs+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return hs+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return hs+t+X0+t+Tl+t+t;case 6828:case 4268:return hs+t+Tl+t+t;case 6165:return hs+t+Tl+"flex-"+t+t;case 5187:return hs+t+gs(t,/(\w+).+(:[^]+)/,hs+"box-$1$2"+Tl+"flex-$1$2")+t;case 5443:return hs+t+Tl+"flex-item-"+gs(t,/flex-|-self/,"")+t;case 4675:return hs+t+Tl+"flex-line-pack"+gs(t,/align-content|flex-|-self/,"")+t;case 5548:return hs+t+Tl+gs(t,"shrink","negative")+t;case 5292:return hs+t+Tl+gs(t,"basis","preferred-size")+t;case 6060:return hs+"box-"+gs(t,"-grow","")+hs+t+Tl+gs(t,"grow","positive")+t;case 4554:return hs+gs(t,/([^-])(transform)/g,"$1"+hs+"$2")+t;case 6187:return gs(gs(gs(t,/(zoom-|grab)/,hs+"$1"),/(image-set)/,hs+"$1"),t,"")+t;case 5495:case 3959:return gs(t,/(image-set\([^]*)/,hs+"$1$`$1");case 4968:return gs(gs(t,/(.+:)(flex-)?(.*)/,hs+"box-pack:$3"+Tl+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+hs+t+t;case 4095:case 3583:case 4068:case 2532:return gs(t,/(.+)-inline(.+)/,hs+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Xr(t)-1-s>6)switch(yl(t,s+1)){case 109:if(yl(t,s+4)!==45)break;case 102:return gs(t,/(.+:)(.+)-([^]+)/,"$1"+hs+"$2-$3$1"+X0+(yl(t,s+3)==108?"$3":"$2-$3"))+t;case 115:return~Mj(t,"stretch")?u5(gs(t,"stretch","fill-available"),s)+t:t}break;case 4949:if(yl(t,s+1)!==115)break;case 6444:switch(yl(t,Xr(t)-3-(~Mj(t,"!important")&&10))){case 107:return gs(t,":",":"+hs)+t;case 101:return gs(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+hs+(yl(t,14)===45?"inline-":"")+"box$3$1"+hs+"$2$3$1"+Tl+"$2box$3")+t}break;case 5936:switch(yl(t,s+11)){case 114:return hs+t+Tl+gs(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return hs+t+Tl+gs(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return hs+t+Tl+gs(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return hs+t+Tl+t+t}return t}var mT=function(s,a,l,n){if(s.length>-1&&!s.return)switch(s.type){case vN:s.return=u5(s.value,s.length);break;case n5:return cu([Ju(s,{value:gs(s.value,"@","@"+hs)})],n);case fN:if(s.length)return KO(s.props,function(r){switch(XO(r,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return cu([Ju(s,{props:[gs(r,/:(read-\w+)/,":"+X0+"$1")]})],n);case"::placeholder":return cu([Ju(s,{props:[gs(r,/:(plac\w+)/,":"+hs+"input-$1")]}),Ju(s,{props:[gs(r,/:(plac\w+)/,":"+X0+"$1")]}),Ju(s,{props:[gs(r,/:(plac\w+)/,Tl+"input-$1")]})],n)}return""})}},xT=[mT],m5=function(s){var a=s.key;if(a==="css"){var l=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(l,function(C){var W=C.getAttribute("data-emotion");W.indexOf(" ")!==-1&&(document.head.appendChild(C),C.setAttribute("data-s",""))})}var n=s.stylisPlugins||xT,r={},i,o=[];i=s.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+a+' "]'),function(C){for(var W=C.getAttribute("data-emotion").split(" "),L=1;L<W.length;L++)r[W[L]]=!0;o.push(C)});var c,x=[cT,uT];{var j,g=[lT,rT(function(C){j.insert(C)})],y=nT(x.concat(n,g)),$=function(W){return cu(sT(W),y)};c=function(W,L,R,F){j=R,$(W?W+"{"+L.styles+"}":L.styles),F&&(T.inserted[L.name]=!0)}}var T={key:a,sheet:new BO({key:a,container:i,nonce:s.nonce,speedy:s.speedy,prepend:s.prepend,insertionPoint:s.insertionPoint}),nonce:s.nonce,inserted:r,registered:{},insert:c};return T.sheet.hydrate(o),T},x5={exports:{}},ks={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hl=typeof Symbol=="function"&&Symbol.for,jN=hl?Symbol.for("react.element"):60103,yN=hl?Symbol.for("react.portal"):60106,Bg=hl?Symbol.for("react.fragment"):60107,Gg=hl?Symbol.for("react.strict_mode"):60108,qg=hl?Symbol.for("react.profiler"):60114,zg=hl?Symbol.for("react.provider"):60109,Wg=hl?Symbol.for("react.context"):60110,NN=hl?Symbol.for("react.async_mode"):60111,Hg=hl?Symbol.for("react.concurrent_mode"):60111,Xg=hl?Symbol.for("react.forward_ref"):60112,Kg=hl?Symbol.for("react.suspense"):60113,pT=hl?Symbol.for("react.suspense_list"):60120,Qg=hl?Symbol.for("react.memo"):60115,Yg=hl?Symbol.for("react.lazy"):60116,hT=hl?Symbol.for("react.block"):60121,gT=hl?Symbol.for("react.fundamental"):60117,fT=hl?Symbol.for("react.responder"):60118,vT=hl?Symbol.for("react.scope"):60119;function Un(t){if(typeof t=="object"&&t!==null){var s=t.$$typeof;switch(s){case jN:switch(t=t.type,t){case NN:case Hg:case Bg:case qg:case Gg:case Kg:return t;default:switch(t=t&&t.$$typeof,t){case Wg:case Xg:case Yg:case Qg:case zg:return t;default:return s}}case yN:return s}}}function p5(t){return Un(t)===Hg}ks.AsyncMode=NN;ks.ConcurrentMode=Hg;ks.ContextConsumer=Wg;ks.ContextProvider=zg;ks.Element=jN;ks.ForwardRef=Xg;ks.Fragment=Bg;ks.Lazy=Yg;ks.Memo=Qg;ks.Portal=yN;ks.Profiler=qg;ks.StrictMode=Gg;ks.Suspense=Kg;ks.isAsyncMode=function(t){return p5(t)||Un(t)===NN};ks.isConcurrentMode=p5;ks.isContextConsumer=function(t){return Un(t)===Wg};ks.isContextProvider=function(t){return Un(t)===zg};ks.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===jN};ks.isForwardRef=function(t){return Un(t)===Xg};ks.isFragment=function(t){return Un(t)===Bg};ks.isLazy=function(t){return Un(t)===Yg};ks.isMemo=function(t){return Un(t)===Qg};ks.isPortal=function(t){return Un(t)===yN};ks.isProfiler=function(t){return Un(t)===qg};ks.isStrictMode=function(t){return Un(t)===Gg};ks.isSuspense=function(t){return Un(t)===Kg};ks.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Bg||t===Hg||t===qg||t===Gg||t===Kg||t===pT||typeof t=="object"&&t!==null&&(t.$$typeof===Yg||t.$$typeof===Qg||t.$$typeof===zg||t.$$typeof===Wg||t.$$typeof===Xg||t.$$typeof===gT||t.$$typeof===fT||t.$$typeof===vT||t.$$typeof===hT)};ks.typeOf=Un;x5.exports=ks;var bT=x5.exports,h5=bT,jT={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},yT={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},g5={};g5[h5.ForwardRef]=jT;g5[h5.Memo]=yT;var NT=!0;function f5(t,s,a){var l="";return a.split(" ").forEach(function(n){t[n]!==void 0?s.push(t[n]+";"):n&&(l+=n+" ")}),l}var wN=function(s,a,l){var n=s.key+"-"+a.name;(l===!1||NT===!1)&&s.registered[n]===void 0&&(s.registered[n]=a.styles)},kN=function(s,a,l){wN(s,a,l);var n=s.key+"-"+a.name;if(s.inserted[a.name]===void 0){var r=a;do s.insert(a===r?"."+n:"",r,s.sheet,!0),r=r.next;while(r!==void 0)}};function wT(t){for(var s=0,a,l=0,n=t.length;n>=4;++l,n-=4)a=t.charCodeAt(l)&255|(t.charCodeAt(++l)&255)<<8|(t.charCodeAt(++l)&255)<<16|(t.charCodeAt(++l)&255)<<24,a=(a&65535)*1540483477+((a>>>16)*59797<<16),a^=a>>>24,s=(a&65535)*1540483477+((a>>>16)*59797<<16)^(s&65535)*1540483477+((s>>>16)*59797<<16);switch(n){case 3:s^=(t.charCodeAt(l+2)&255)<<16;case 2:s^=(t.charCodeAt(l+1)&255)<<8;case 1:s^=t.charCodeAt(l)&255,s=(s&65535)*1540483477+((s>>>16)*59797<<16)}return s^=s>>>13,s=(s&65535)*1540483477+((s>>>16)*59797<<16),((s^s>>>15)>>>0).toString(36)}var kT={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},CT=/[A-Z]|^ms/g,ST=/_EMO_([^_]+?)_([^]*?)_EMO_/g,v5=function(s){return s.charCodeAt(1)===45},Y2=function(s){return s!=null&&typeof s!="boolean"},tv=c5(function(t){return v5(t)?t:t.replace(CT,"-$&").toLowerCase()}),J2=function(s,a){switch(s){case"animation":case"animationName":if(typeof a=="string")return a.replace(ST,function(l,n,r){return Kr={name:n,styles:r,next:Kr},n})}return kT[s]!==1&&!v5(s)&&typeof a=="number"&&a!==0?a+"px":a};function Vx(t,s,a){if(a==null)return"";var l=a;if(l.__emotion_styles!==void 0)return l;switch(typeof a){case"boolean":return"";case"object":{var n=a;if(n.anim===1)return Kr={name:n.name,styles:n.styles,next:Kr},n.name;var r=a;if(r.styles!==void 0){var i=r.next;if(i!==void 0)for(;i!==void 0;)Kr={name:i.name,styles:i.styles,next:Kr},i=i.next;var o=r.styles+";";return o}return AT(t,s,a)}case"function":{if(t!==void 0){var c=Kr,x=a(t);return Kr=c,Vx(t,s,x)}break}}var j=a;if(s==null)return j;var g=s[j];return g!==void 0?g:j}function AT(t,s,a){var l="";if(Array.isArray(a))for(var n=0;n<a.length;n++)l+=Vx(t,s,a[n])+";";else for(var r in a){var i=a[r];if(typeof i!="object"){var o=i;s!=null&&s[o]!==void 0?l+=r+"{"+s[o]+"}":Y2(o)&&(l+=tv(r)+":"+J2(r,o)+";")}else if(Array.isArray(i)&&typeof i[0]=="string"&&(s==null||s[i[0]]===void 0))for(var c=0;c<i.length;c++)Y2(i[c])&&(l+=tv(r)+":"+J2(r,i[c])+";");else{var x=Vx(t,s,i);switch(r){case"animation":case"animationName":{l+=tv(r)+":"+x+";";break}default:l+=r+"{"+x+"}"}}}return l}var Z2=/label:\s*([^\s;{]+)\s*(;|$)/g,Kr;function np(t,s,a){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var l=!0,n="";Kr=void 0;var r=t[0];if(r==null||r.raw===void 0)l=!1,n+=Vx(a,s,r);else{var i=r;n+=i[0]}for(var o=1;o<t.length;o++)if(n+=Vx(a,s,t[o]),l){var c=r;n+=c[o]}Z2.lastIndex=0;for(var x="",j;(j=Z2.exec(n))!==null;)x+="-"+j[1];var g=wT(n)+x;return{name:g,styles:n,next:Kr}}var ET=function(s){return s()},b5=y0.useInsertionEffect?y0.useInsertionEffect:!1,j5=b5||ET,e1=b5||d.useLayoutEffect,y5=d.createContext(typeof HTMLElement<"u"?m5({key:"css"}):null),MT=y5.Provider,CN=function(s){return d.forwardRef(function(a,l){var n=d.useContext(y5);return s(a,n,l)})},Ru=d.createContext({}),SN={}.hasOwnProperty,Oj="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",PT=function(s,a){var l={};for(var n in a)SN.call(a,n)&&(l[n]=a[n]);return l[Oj]=s,l},OT=function(s){var a=s.cache,l=s.serialized,n=s.isStringTag;return wN(a,l,n),j5(function(){return kN(a,l,n)}),null},TT=CN(function(t,s,a){var l=t.css;typeof l=="string"&&s.registered[l]!==void 0&&(l=s.registered[l]);var n=t[Oj],r=[l],i="";typeof t.className=="string"?i=f5(s.registered,r,t.className):t.className!=null&&(i=t.className+" ");var o=np(r,void 0,d.useContext(Ru));i+=s.key+"-"+o.name;var c={};for(var x in t)SN.call(t,x)&&x!=="css"&&x!==Oj&&(c[x]=t[x]);return c.className=i,a&&(c.ref=a),d.createElement(d.Fragment,null,d.createElement(OT,{cache:s,serialized:o,isStringTag:typeof n=="string"}),d.createElement(n,c))}),RT=TT,sv={exports:{}},t1;function N5(){return t1||(t1=1,function(t){function s(){return t.exports=s=Object.assign?Object.assign.bind():function(a){for(var l=1;l<arguments.length;l++){var n=arguments[l];for(var r in n)({}).hasOwnProperty.call(n,r)&&(a[r]=n[r])}return a},t.exports.__esModule=!0,t.exports.default=t.exports,s.apply(null,arguments)}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports}(sv)),sv.exports}N5();var s1=function(s,a){var l=arguments;if(a==null||!SN.call(a,"css"))return d.createElement.apply(void 0,l);var n=l.length,r=new Array(n);r[0]=RT,r[1]=PT(s,a);for(var i=2;i<n;i++)r[i]=l[i];return d.createElement.apply(null,r)};(function(t){var s;s||(s=t.JSX||(t.JSX={}))})(s1||(s1={}));var DT=CN(function(t,s){var a=t.styles,l=np([a],void 0,d.useContext(Ru)),n=d.useRef();return e1(function(){var r=s.key+"-global",i=new s.sheet.constructor({key:r,nonce:s.sheet.nonce,container:s.sheet.container,speedy:s.sheet.isSpeedy}),o=!1,c=document.querySelector('style[data-emotion="'+r+" "+l.name+'"]');return s.sheet.tags.length&&(i.before=s.sheet.tags[0]),c!==null&&(o=!0,c.setAttribute("data-emotion",r),i.hydrate([c])),n.current=[i,o],function(){i.flush()}},[s]),e1(function(){var r=n.current,i=r[0],o=r[1];if(o){r[1]=!1;return}if(l.next!==void 0&&kN(s,l.next,!0),i.tags.length){var c=i.tags[i.tags.length-1].nextElementSibling;i.before=c,i.flush()}s.insert("",l,i,!1)},[s,l.name]),null});function w5(){for(var t=arguments.length,s=new Array(t),a=0;a<t;a++)s[a]=arguments[a];return np(s)}function Jg(){var t=w5.apply(void 0,arguments),s="animation-"+t.name;return{name:s,styles:"@keyframes "+s+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var IT=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|popover|popoverTarget|popoverTargetAction|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,$T=c5(function(t){return IT.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),LT=$T,FT=function(s){return s!=="theme"},a1=function(s){return typeof s=="string"&&s.charCodeAt(0)>96?LT:FT},l1=function(s,a,l){var n;if(a){var r=a.shouldForwardProp;n=s.__emotion_forwardProp&&r?function(i){return s.__emotion_forwardProp(i)&&r(i)}:r}return typeof n!="function"&&l&&(n=s.__emotion_forwardProp),n},UT=function(s){var a=s.cache,l=s.serialized,n=s.isStringTag;return wN(a,l,n),j5(function(){return kN(a,l,n)}),null},VT=function t(s,a){var l=s.__emotion_real===s,n=l&&s.__emotion_base||s,r,i;a!==void 0&&(r=a.label,i=a.target);var o=l1(s,a,l),c=o||a1(n),x=!c("as");return function(){var j=arguments,g=l&&s.__emotion_styles!==void 0?s.__emotion_styles.slice(0):[];if(r!==void 0&&g.push("label:"+r+";"),j[0]==null||j[0].raw===void 0)g.push.apply(g,j);else{var y=j[0];g.push(y[0]);for(var $=j.length,T=1;T<$;T++)g.push(j[T],y[T])}var C=CN(function(W,L,R){var F=x&&W.as||n,te="",oe=[],G=W;if(W.theme==null){G={};for(var H in W)G[H]=W[H];G.theme=d.useContext(Ru)}typeof W.className=="string"?te=f5(L.registered,oe,W.className):W.className!=null&&(te=W.className+" ");var Y=np(g.concat(oe),L.registered,G);te+=L.key+"-"+Y.name,i!==void 0&&(te+=" "+i);var we=x&&o===void 0?a1(F):c,q={};for(var je in W)x&&je==="as"||we(je)&&(q[je]=W[je]);return q.className=te,R&&(q.ref=R),d.createElement(d.Fragment,null,d.createElement(UT,{cache:L,serialized:Y,isStringTag:typeof F=="string"}),d.createElement(F,q))});return C.displayName=r!==void 0?r:"Styled("+(typeof n=="string"?n:n.displayName||n.name||"Component")+")",C.defaultProps=s.defaultProps,C.__emotion_real=C,C.__emotion_base=n,C.__emotion_styles=g,C.__emotion_forwardProp=o,Object.defineProperty(C,"toString",{value:function(){return"."+i}}),C.withComponent=function(W,L){var R=t(W,st({},a,L,{shouldForwardProp:l1(C,L,!0)}));return R.apply(void 0,g)},C}},_T=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],Tj=VT.bind(null);_T.forEach(function(t){Tj[t]=Tj(t)});function BT(t,s){const a=m5({key:"css",prepend:t});if(s){const l=a.insert;a.insert=(...n)=>(n[1].styles.match(/^@layer\s+[^{]*$/)||(n[1].styles=`@layer mui {${n[1].styles}}`),l(...n))}return a}const av=new Map;function k5(t){const{injectFirst:s,enableCssLayer:a,children:l}=t,n=d.useMemo(()=>{const r=`${s}-${a}`;if(typeof document=="object"&&av.has(r))return av.get(r);const i=BT(s,a);return av.set(r,i),i},[s,a]);return s||a?e.jsx(MT,{value:n,children:l}):l}function GT(t){return t==null||Object.keys(t).length===0}function C5(t){const{styles:s,defaultTheme:a={}}=t,l=typeof s=="function"?n=>s(GT(n)?a:n):s;return e.jsx(DT,{styles:l})}function qT(t,s){return Tj(t,s)}const zT=(t,s)=>{Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=s(t.__emotion_styles))},n1=[];function S5(t){return n1[0]=t,np(n1)}const WT=Object.freeze(Object.defineProperty({__proto__:null,GlobalStyles:C5,StyledEngineProvider:k5,ThemeContext:Ru,css:w5,default:qT,internal_processStyles:zT,internal_serializeStyles:S5,keyframes:Jg},Symbol.toStringTag,{value:"Module"}));function bo(t){if(typeof t!="object"||t===null)return!1;const s=Object.getPrototypeOf(t);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function A5(t){if(d.isValidElement(t)||!bo(t))return t;const s={};return Object.keys(t).forEach(a=>{s[a]=A5(t[a])}),s}function si(t,s,a={clone:!0}){const l=a.clone?st({},t):t;return bo(t)&&bo(s)&&Object.keys(s).forEach(n=>{d.isValidElement(s[n])?l[n]=s[n]:bo(s[n])&&Object.prototype.hasOwnProperty.call(t,n)&&bo(t[n])?l[n]=si(t[n],s[n],a):a.clone?l[n]=bo(s[n])?A5(s[n]):s[n]:l[n]=s[n]}),l}const HT=Object.freeze(Object.defineProperty({__proto__:null,default:si,isPlainObject:bo},Symbol.toStringTag,{value:"Module"})),XT=["values","unit","step"],KT=t=>{const s=Object.keys(t).map(a=>({key:a,val:t[a]}))||[];return s.sort((a,l)=>a.val-l.val),s.reduce((a,l)=>st({},a,{[l.key]:l.val}),{})};function E5(t){const{values:s={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:a="px",step:l=5}=t,n=wa(t,XT),r=KT(s),i=Object.keys(r);function o(y){return`@media (min-width:${typeof s[y]=="number"?s[y]:y}${a})`}function c(y){return`@media (max-width:${(typeof s[y]=="number"?s[y]:y)-l/100}${a})`}function x(y,$){const T=i.indexOf($);return`@media (min-width:${typeof s[y]=="number"?s[y]:y}${a}) and (max-width:${(T!==-1&&typeof s[i[T]]=="number"?s[i[T]]:$)-l/100}${a})`}function j(y){return i.indexOf(y)+1<i.length?x(y,i[i.indexOf(y)+1]):o(y)}function g(y){const $=i.indexOf(y);return $===0?o(i[1]):$===i.length-1?c(i[$]):x(y,i[i.indexOf(y)+1]).replace("@media","@media not all and")}return st({keys:i,values:r,up:o,down:c,between:x,only:j,not:g,unit:a},n)}const QT={borderRadius:4};function ax(t,s){return s?si(t,s,{clone:!1}):t}const AN={xs:0,sm:600,md:900,lg:1200,xl:1536},r1={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${AN[t]}px)`};function Di(t,s,a){const l=t.theme||{};if(Array.isArray(s)){const r=l.breakpoints||r1;return s.reduce((i,o,c)=>(i[r.up(r.keys[c])]=a(s[c]),i),{})}if(typeof s=="object"){const r=l.breakpoints||r1;return Object.keys(s).reduce((i,o)=>{if(Object.keys(r.values||AN).indexOf(o)!==-1){const c=r.up(o);i[c]=a(s[o],o)}else{const c=o;i[c]=s[c]}return i},{})}return a(s)}function YT(t={}){var s;return((s=t.keys)==null?void 0:s.reduce((l,n)=>{const r=t.up(n);return l[r]={},l},{}))||{}}function i1(t,s){return t.reduce((a,l)=>{const n=a[l];return(!n||Object.keys(n).length===0)&&delete a[l],a},s)}function Ns(t){if(typeof t!="string")throw new Error(yu(7));return t.charAt(0).toUpperCase()+t.slice(1)}const JT=Object.freeze(Object.defineProperty({__proto__:null,default:Ns},Symbol.toStringTag,{value:"Module"}));function Zg(t,s,a=!0){if(!s||typeof s!="string")return null;if(t&&t.vars&&a){const l=`vars.${s}`.split(".").reduce((n,r)=>n&&n[r]?n[r]:null,t);if(l!=null)return l}return s.split(".").reduce((l,n)=>l&&l[n]!=null?l[n]:null,t)}function K0(t,s,a,l=a){let n;return typeof t=="function"?n=t(a):Array.isArray(t)?n=t[a]||l:n=Zg(t,a)||l,s&&(n=s(n,l,t)),n}function Fa(t){const{prop:s,cssProperty:a=t.prop,themeKey:l,transform:n}=t,r=i=>{if(i[s]==null)return null;const o=i[s],c=i.theme,x=Zg(c,l)||{};return Di(i,o,g=>{let y=K0(x,n,g);return g===y&&typeof g=="string"&&(y=K0(x,n,`${s}${g==="default"?"":Ns(g)}`,g)),a===!1?y:{[a]:y}})};return r.propTypes={},r.filterProps=[s],r}function ZT(t){const s={};return a=>(s[a]===void 0&&(s[a]=t(a)),s[a])}const eR={m:"margin",p:"padding"},tR={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},o1={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},sR=ZT(t=>{if(t.length>2)if(o1[t])t=o1[t];else return[t];const[s,a]=t.split(""),l=eR[s],n=tR[a]||"";return Array.isArray(n)?n.map(r=>l+r):[l+n]}),EN=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],MN=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...EN,...MN];function rp(t,s,a,l){var n;const r=(n=Zg(t,s,!1))!=null?n:a;return typeof r=="number"?i=>typeof i=="string"?i:r*i:Array.isArray(r)?i=>typeof i=="string"?i:r[i]:typeof r=="function"?r:()=>{}}function M5(t){return rp(t,"spacing",8)}function ip(t,s){if(typeof s=="string"||s==null)return s;const a=Math.abs(s),l=t(a);return s>=0?l:typeof l=="number"?-l:`-${l}`}function aR(t,s){return a=>t.reduce((l,n)=>(l[n]=ip(s,a),l),{})}function lR(t,s,a,l){if(s.indexOf(a)===-1)return null;const n=sR(a),r=aR(n,l),i=t[a];return Di(t,i,r)}function P5(t,s){const a=M5(t.theme);return Object.keys(t).map(l=>lR(t,s,l,a)).reduce(ax,{})}function ga(t){return P5(t,EN)}ga.propTypes={};ga.filterProps=EN;function fa(t){return P5(t,MN)}fa.propTypes={};fa.filterProps=MN;function nR(t=8){if(t.mui)return t;const s=M5({spacing:t}),a=(...l)=>(l.length===0?[1]:l).map(r=>{const i=s(r);return typeof i=="number"?`${i}px`:i}).join(" ");return a.mui=!0,a}function ef(...t){const s=t.reduce((l,n)=>(n.filterProps.forEach(r=>{l[r]=n}),l),{}),a=l=>Object.keys(l).reduce((n,r)=>s[r]?ax(n,s[r](l)):n,{});return a.propTypes={},a.filterProps=t.reduce((l,n)=>l.concat(n.filterProps),[]),a}function Zn(t){return typeof t!="number"?t:`${t}px solid`}function nr(t,s){return Fa({prop:t,themeKey:"borders",transform:s})}const rR=nr("border",Zn),iR=nr("borderTop",Zn),oR=nr("borderRight",Zn),dR=nr("borderBottom",Zn),cR=nr("borderLeft",Zn),uR=nr("borderColor"),mR=nr("borderTopColor"),xR=nr("borderRightColor"),pR=nr("borderBottomColor"),hR=nr("borderLeftColor"),gR=nr("outline",Zn),fR=nr("outlineColor"),tf=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const s=rp(t.theme,"shape.borderRadius",4),a=l=>({borderRadius:ip(s,l)});return Di(t,t.borderRadius,a)}return null};tf.propTypes={};tf.filterProps=["borderRadius"];ef(rR,iR,oR,dR,cR,uR,mR,xR,pR,hR,tf,gR,fR);const sf=t=>{if(t.gap!==void 0&&t.gap!==null){const s=rp(t.theme,"spacing",8),a=l=>({gap:ip(s,l)});return Di(t,t.gap,a)}return null};sf.propTypes={};sf.filterProps=["gap"];const af=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const s=rp(t.theme,"spacing",8),a=l=>({columnGap:ip(s,l)});return Di(t,t.columnGap,a)}return null};af.propTypes={};af.filterProps=["columnGap"];const lf=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const s=rp(t.theme,"spacing",8),a=l=>({rowGap:ip(s,l)});return Di(t,t.rowGap,a)}return null};lf.propTypes={};lf.filterProps=["rowGap"];const vR=Fa({prop:"gridColumn"}),bR=Fa({prop:"gridRow"}),jR=Fa({prop:"gridAutoFlow"}),yR=Fa({prop:"gridAutoColumns"}),NR=Fa({prop:"gridAutoRows"}),wR=Fa({prop:"gridTemplateColumns"}),kR=Fa({prop:"gridTemplateRows"}),CR=Fa({prop:"gridTemplateAreas"}),SR=Fa({prop:"gridArea"});ef(sf,af,lf,vR,bR,jR,yR,NR,wR,kR,CR,SR);function uu(t,s){return s==="grey"?s:t}const AR=Fa({prop:"color",themeKey:"palette",transform:uu}),ER=Fa({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:uu}),MR=Fa({prop:"backgroundColor",themeKey:"palette",transform:uu});ef(AR,ER,MR);function Mn(t){return t<=1&&t!==0?`${t*100}%`:t}const PR=Fa({prop:"width",transform:Mn}),PN=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const s=a=>{var l,n;const r=((l=t.theme)==null||(l=l.breakpoints)==null||(l=l.values)==null?void 0:l[a])||AN[a];return r?((n=t.theme)==null||(n=n.breakpoints)==null?void 0:n.unit)!=="px"?{maxWidth:`${r}${t.theme.breakpoints.unit}`}:{maxWidth:r}:{maxWidth:Mn(a)}};return Di(t,t.maxWidth,s)}return null};PN.filterProps=["maxWidth"];const OR=Fa({prop:"minWidth",transform:Mn}),TR=Fa({prop:"height",transform:Mn}),RR=Fa({prop:"maxHeight",transform:Mn}),DR=Fa({prop:"minHeight",transform:Mn});Fa({prop:"size",cssProperty:"width",transform:Mn});Fa({prop:"size",cssProperty:"height",transform:Mn});const IR=Fa({prop:"boxSizing"});ef(PR,PN,OR,TR,RR,DR,IR);const op={border:{themeKey:"borders",transform:Zn},borderTop:{themeKey:"borders",transform:Zn},borderRight:{themeKey:"borders",transform:Zn},borderBottom:{themeKey:"borders",transform:Zn},borderLeft:{themeKey:"borders",transform:Zn},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Zn},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:tf},color:{themeKey:"palette",transform:uu},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:uu},backgroundColor:{themeKey:"palette",transform:uu},p:{style:fa},pt:{style:fa},pr:{style:fa},pb:{style:fa},pl:{style:fa},px:{style:fa},py:{style:fa},padding:{style:fa},paddingTop:{style:fa},paddingRight:{style:fa},paddingBottom:{style:fa},paddingLeft:{style:fa},paddingX:{style:fa},paddingY:{style:fa},paddingInline:{style:fa},paddingInlineStart:{style:fa},paddingInlineEnd:{style:fa},paddingBlock:{style:fa},paddingBlockStart:{style:fa},paddingBlockEnd:{style:fa},m:{style:ga},mt:{style:ga},mr:{style:ga},mb:{style:ga},ml:{style:ga},mx:{style:ga},my:{style:ga},margin:{style:ga},marginTop:{style:ga},marginRight:{style:ga},marginBottom:{style:ga},marginLeft:{style:ga},marginX:{style:ga},marginY:{style:ga},marginInline:{style:ga},marginInlineStart:{style:ga},marginInlineEnd:{style:ga},marginBlock:{style:ga},marginBlockStart:{style:ga},marginBlockEnd:{style:ga},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:sf},rowGap:{style:lf},columnGap:{style:af},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Mn},maxWidth:{style:PN},minWidth:{transform:Mn},height:{transform:Mn},maxHeight:{transform:Mn},minHeight:{transform:Mn},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function $R(...t){const s=t.reduce((l,n)=>l.concat(Object.keys(n)),[]),a=new Set(s);return t.every(l=>a.size===Object.keys(l).length)}function LR(t,s){return typeof t=="function"?t(s):t}function O5(){function t(a,l,n,r){const i={[a]:l,theme:n},o=r[a];if(!o)return{[a]:l};const{cssProperty:c=a,themeKey:x,transform:j,style:g}=o;if(l==null)return null;if(x==="typography"&&l==="inherit")return{[a]:l};const y=Zg(n,x)||{};return g?g(i):Di(i,l,T=>{let C=K0(y,j,T);return T===C&&typeof T=="string"&&(C=K0(y,j,`${a}${T==="default"?"":Ns(T)}`,T)),c===!1?C:{[c]:C}})}function s(a){var l;const{sx:n,theme:r={},nested:i}=a||{};if(!n)return null;const o=(l=r.unstable_sxConfig)!=null?l:op;function c(x){let j=x;if(typeof x=="function")j=x(r);else if(typeof x!="object")return x;if(!j)return null;const g=YT(r.breakpoints),y=Object.keys(g);let $=g;return Object.keys(j).forEach(T=>{const C=LR(j[T],r);if(C!=null)if(typeof C=="object")if(o[T])$=ax($,t(T,C,r,o));else{const W=Di({theme:r},C,L=>({[T]:L}));$R(W,C)?$[T]=s({sx:C,theme:r,nested:!0}):$=ax($,W)}else $=ax($,t(T,C,r,o))}),!i&&r.modularCssLayers?{"@layer sx":i1(y,$)}:i1(y,$)}return Array.isArray(n)?n.map(c):c(n)}return s}const nf=O5();nf.filterProps=["sx"];function T5(t,s){const a=this;return a.vars&&typeof a.getColorSchemeSelector=="function"?{[a.getColorSchemeSelector(t).replace(/(\[[^\]]+\])/,"*:where($1)")]:s}:a.palette.mode===t?s:{}}const FR=["breakpoints","palette","spacing","shape"];function ON(t={},...s){const{breakpoints:a={},palette:l={},spacing:n,shape:r={}}=t,i=wa(t,FR),o=E5(a),c=nR(n);let x=si({breakpoints:o,direction:"ltr",components:{},palette:st({mode:"light"},l),spacing:c,shape:st({},QT,r)},i);return x.applyStyles=T5,x=s.reduce((j,g)=>si(j,g),x),x.unstable_sxConfig=st({},op,i==null?void 0:i.unstable_sxConfig),x.unstable_sx=function(g){return nf({sx:g,theme:this})},x}const UR=Object.freeze(Object.defineProperty({__proto__:null,default:ON,private_createBreakpoints:E5,unstable_applyStyles:T5},Symbol.toStringTag,{value:"Module"}));function VR(t){return Object.keys(t).length===0}function TN(t=null){const s=d.useContext(Ru);return!s||VR(s)?t:s}const _R=ON();function BR(t=_R){return TN(t)}function lv(t){const s=S5(t);return t!==s&&s.styles?(s.styles.match(/^@layer\s+[^{]*$/)||(s.styles=`@layer global{${s.styles}}`),s):t}function R5({styles:t,themeId:s,defaultTheme:a={}}){const l=BR(a),n=s&&l[s]||l;let r=typeof t=="function"?t(n):t;return n.modularCssLayers&&(Array.isArray(r)?r=r.map(i=>lv(typeof i=="function"?i(n):i)):r=lv(r)),e.jsx(C5,{styles:r})}const GR=["sx"],qR=t=>{var s,a;const l={systemProps:{},otherProps:{}},n=(s=t==null||(a=t.theme)==null?void 0:a.unstable_sxConfig)!=null?s:op;return Object.keys(t).forEach(r=>{n[r]?l.systemProps[r]=t[r]:l.otherProps[r]=t[r]}),l};function D5(t){const{sx:s}=t,a=wa(t,GR),{systemProps:l,otherProps:n}=qR(a);let r;return Array.isArray(s)?r=[l,...s]:typeof s=="function"?r=(...i)=>{const o=s(...i);return bo(o)?st({},l,o):l}:r=st({},l,s),st({},n,{sx:r})}const zR=Object.freeze(Object.defineProperty({__proto__:null,default:nf,extendSxProp:D5,unstable_createStyleFunctionSx:O5,unstable_defaultSxConfig:op},Symbol.toStringTag,{value:"Module"})),d1=t=>t,WR=()=>{let t=d1;return{configure(s){t=s},generate(s){return t(s)},reset(){t=d1}}},HR=WR();function I5(t){var s,a,l="";if(typeof t=="string"||typeof t=="number")l+=t;else if(typeof t=="object")if(Array.isArray(t)){var n=t.length;for(s=0;s<n;s++)t[s]&&(a=I5(t[s]))&&(l&&(l+=" "),l+=a)}else for(a in t)t[a]&&(l&&(l+=" "),l+=a);return l}function Ha(){for(var t,s,a=0,l="",n=arguments.length;a<n;a++)(t=arguments[a])&&(s=I5(t))&&(l&&(l+=" "),l+=s);return l}const XR={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function _i(t,s,a="Mui"){const l=XR[s];return l?`${a}-${l}`:`${HR.generate(t)}-${s}`}function Bi(t,s,a="Mui"){const l={};return s.forEach(n=>{l[n]=_i(t,n,a)}),l}var $5={exports:{}},Ts={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RN=Symbol.for("react.transitional.element"),DN=Symbol.for("react.portal"),rf=Symbol.for("react.fragment"),of=Symbol.for("react.strict_mode"),df=Symbol.for("react.profiler"),cf=Symbol.for("react.consumer"),uf=Symbol.for("react.context"),mf=Symbol.for("react.forward_ref"),xf=Symbol.for("react.suspense"),pf=Symbol.for("react.suspense_list"),hf=Symbol.for("react.memo"),gf=Symbol.for("react.lazy"),KR=Symbol.for("react.view_transition"),QR=Symbol.for("react.client.reference");function rr(t){if(typeof t=="object"&&t!==null){var s=t.$$typeof;switch(s){case RN:switch(t=t.type,t){case rf:case df:case of:case xf:case pf:case KR:return t;default:switch(t=t&&t.$$typeof,t){case uf:case mf:case gf:case hf:return t;case cf:return t;default:return s}}case DN:return s}}}Ts.ContextConsumer=cf;Ts.ContextProvider=uf;Ts.Element=RN;Ts.ForwardRef=mf;Ts.Fragment=rf;Ts.Lazy=gf;Ts.Memo=hf;Ts.Portal=DN;Ts.Profiler=df;Ts.StrictMode=of;Ts.Suspense=xf;Ts.SuspenseList=pf;Ts.isContextConsumer=function(t){return rr(t)===cf};Ts.isContextProvider=function(t){return rr(t)===uf};Ts.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===RN};Ts.isForwardRef=function(t){return rr(t)===mf};Ts.isFragment=function(t){return rr(t)===rf};Ts.isLazy=function(t){return rr(t)===gf};Ts.isMemo=function(t){return rr(t)===hf};Ts.isPortal=function(t){return rr(t)===DN};Ts.isProfiler=function(t){return rr(t)===df};Ts.isStrictMode=function(t){return rr(t)===of};Ts.isSuspense=function(t){return rr(t)===xf};Ts.isSuspenseList=function(t){return rr(t)===pf};Ts.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===rf||t===df||t===of||t===xf||t===pf||typeof t=="object"&&t!==null&&(t.$$typeof===gf||t.$$typeof===hf||t.$$typeof===uf||t.$$typeof===cf||t.$$typeof===mf||t.$$typeof===QR||t.getModuleId!==void 0)};Ts.typeOf=rr;$5.exports=Ts;var c1=$5.exports;const YR=/^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^(\s/]*)\s*/;function L5(t){const s=`${t}`.match(YR);return s&&s[1]||""}function F5(t,s=""){return t.displayName||t.name||L5(t)||s}function u1(t,s,a){const l=F5(s);return t.displayName||(l!==""?`${a}(${l})`:a)}function JR(t){if(t!=null){if(typeof t=="string")return t;if(typeof t=="function")return F5(t,"Component");if(typeof t=="object")switch(t.$$typeof){case c1.ForwardRef:return u1(t,t.render,"ForwardRef");case c1.Memo:return u1(t,t.type,"memo");default:return}}}const ZR=Object.freeze(Object.defineProperty({__proto__:null,default:JR,getFunctionName:L5},Symbol.toStringTag,{value:"Module"}));function Q0(t,s){const a=st({},s);return Object.keys(t).forEach(l=>{if(l.toString().match(/^(components|slots)$/))a[l]=st({},t[l],a[l]);else if(l.toString().match(/^(componentsProps|slotProps)$/)){const n=t[l]||{},r=s[l];a[l]={},!r||!Object.keys(r)?a[l]=n:!n||!Object.keys(n)?a[l]=r:(a[l]=st({},r),Object.keys(n).forEach(i=>{a[l][i]=Q0(n[i],r[i])}))}else a[l]===void 0&&(a[l]=t[l])}),a}const U5=typeof window<"u"?d.useLayoutEffect:d.useEffect;function eD(t,s=Number.MIN_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER){return Math.max(s,Math.min(t,a))}const tD=Object.freeze(Object.defineProperty({__proto__:null,default:eD},Symbol.toStringTag,{value:"Module"}));function sD(t,s){typeof t=="function"?t(s):t&&(t.current=s)}let m1=0;function aD(t){const[s,a]=d.useState(t),l=t||s;return d.useEffect(()=>{s==null&&(m1+=1,a(`mui-${m1}`))},[s]),l}const x1=y0.useId;function lD(t){return x1!==void 0?x1():aD(t)}function Dp(t){const s=d.useRef(t);return U5(()=>{s.current=t}),d.useRef((...a)=>(0,s.current)(...a)).current}function Rj(...t){return d.useMemo(()=>t.every(s=>s==null)?null:s=>{t.forEach(a=>{sD(a,s)})},t)}const p1={};function nD(t,s){const a=d.useRef(p1);return a.current===p1&&(a.current=t(s)),a}const rD=[];function iD(t){d.useEffect(t,rD)}class ff{constructor(){this.currentId=null,this.clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new ff}start(s,a){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,a()},s)}}function oD(){const t=nD(ff.create).current;return iD(t.disposeEffect),t}let vf=!0,Dj=!1;const dD=new ff,cD={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function uD(t){const{type:s,tagName:a}=t;return!!(a==="INPUT"&&cD[s]&&!t.readOnly||a==="TEXTAREA"&&!t.readOnly||t.isContentEditable)}function mD(t){t.metaKey||t.altKey||t.ctrlKey||(vf=!0)}function nv(){vf=!1}function xD(){this.visibilityState==="hidden"&&Dj&&(vf=!0)}function pD(t){t.addEventListener("keydown",mD,!0),t.addEventListener("mousedown",nv,!0),t.addEventListener("pointerdown",nv,!0),t.addEventListener("touchstart",nv,!0),t.addEventListener("visibilitychange",xD,!0)}function hD(t){const{target:s}=t;try{return s.matches(":focus-visible")}catch{}return vf||uD(s)}function gD(){const t=d.useCallback(n=>{n!=null&&pD(n.ownerDocument)},[]),s=d.useRef(!1);function a(){return s.current?(Dj=!0,dD.start(100,()=>{Dj=!1}),s.current=!1,!0):!1}function l(n){return hD(n)?(s.current=!0,!0):!1}return{isFocusVisibleRef:s,onFocus:l,onBlur:a,ref:t}}function Ko(t,s,a=void 0){const l={};return Object.keys(t).forEach(n=>{l[n]=t[n].reduce((r,i)=>{if(i){const o=s(i);o!==""&&r.push(o),a&&a[i]&&r.push(a[i])}return r},[]).join(" ")}),l}function fD(t){return typeof t=="string"}function vD(t,s,a){return t===void 0||fD(t)?s:st({},s,{ownerState:st({},s.ownerState,a)})}function bD(t,s=[]){if(t===void 0)return{};const a={};return Object.keys(t).filter(l=>l.match(/^on[A-Z]/)&&typeof t[l]=="function"&&!s.includes(l)).forEach(l=>{a[l]=t[l]}),a}function h1(t){if(t===void 0)return{};const s={};return Object.keys(t).filter(a=>!(a.match(/^on[A-Z]/)&&typeof t[a]=="function")).forEach(a=>{s[a]=t[a]}),s}function jD(t){const{getSlotProps:s,additionalProps:a,externalSlotProps:l,externalForwardedProps:n,className:r}=t;if(!s){const $=Ha(a==null?void 0:a.className,r,n==null?void 0:n.className,l==null?void 0:l.className),T=st({},a==null?void 0:a.style,n==null?void 0:n.style,l==null?void 0:l.style),C=st({},a,n,l);return $.length>0&&(C.className=$),Object.keys(T).length>0&&(C.style=T),{props:C,internalRef:void 0}}const i=bD(st({},n,l)),o=h1(l),c=h1(n),x=s(i),j=Ha(x==null?void 0:x.className,a==null?void 0:a.className,r,n==null?void 0:n.className,l==null?void 0:l.className),g=st({},x==null?void 0:x.style,a==null?void 0:a.style,n==null?void 0:n.style,l==null?void 0:l.style),y=st({},x,a,c,o);return j.length>0&&(y.className=j),Object.keys(g).length>0&&(y.style=g),{props:y,internalRef:x.ref}}function yD(t,s,a){return typeof t=="function"?t(s,a):t}const V5=d.createContext(null);function _5(){return d.useContext(V5)}const ND=typeof Symbol=="function"&&Symbol.for,wD=ND?Symbol.for("mui.nested"):"__THEME_NESTED__";function kD(t,s){return typeof s=="function"?s(t):st({},t,s)}function CD(t){const{children:s,theme:a}=t,l=_5(),n=d.useMemo(()=>{const r=l===null?a:kD(l,a);return r!=null&&(r[wD]=l!==null),r},[a,l]);return e.jsx(V5.Provider,{value:n,children:s})}const SD=["value"],AD=d.createContext();function ED(t){let{value:s}=t,a=wa(t,SD);return e.jsx(AD.Provider,st({value:s??!0},a))}const B5=d.createContext(void 0);function MD({value:t,children:s}){return e.jsx(B5.Provider,{value:t,children:s})}function PD(t){const{theme:s,name:a,props:l}=t;if(!s||!s.components||!s.components[a])return l;const n=s.components[a];return n.defaultProps?Q0(n.defaultProps,l):!n.styleOverrides&&!n.variants?Q0(n,l):l}function OD({props:t,name:s}){const a=d.useContext(B5);return PD({props:t,name:s,theme:{components:a}})}function TD(t){const s=TN(),a=lD()||"",{modularCssLayers:l}=t;let n="mui.global, mui.components, mui.theme, mui.custom, mui.sx";return!l||s!==null?n="":typeof l=="string"?n=l.replace(/mui(?!\.)/g,n):n=`@layer ${n};`,U5(()=>{const r=document.querySelector("head");if(!r)return;const i=r.firstChild;if(n){var o;if(i&&(o=i.hasAttribute)!=null&&o.call(i,"data-mui-layer-order")&&i.getAttribute("data-mui-layer-order")===a)return;const x=document.createElement("style");x.setAttribute("data-mui-layer-order",a),x.textContent=n,r.prepend(x)}else{var c;(c=r.querySelector(`style[data-mui-layer-order="${a}"]`))==null||c.remove()}},[n,a]),n?e.jsx(R5,{styles:n}):null}const g1={};function f1(t,s,a,l=!1){return d.useMemo(()=>{const n=t&&s[t]||s;if(typeof a=="function"){const r=a(n),i=t?st({},s,{[t]:r}):r;return l?()=>i:i}return t?st({},s,{[t]:a}):st({},s,a)},[t,s,a,l])}function RD(t){const{children:s,theme:a,themeId:l}=t,n=TN(g1),r=_5()||g1,i=f1(l,n,a),o=f1(l,r,a,!0),c=i.direction==="rtl",x=TD(i);return e.jsx(CD,{theme:o,children:e.jsx(Ru.Provider,{value:i,children:e.jsx(ED,{value:c,children:e.jsxs(MD,{value:i==null?void 0:i.components,children:[x,s]})})})})}function DD(t,s){return st({toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}}},s)}var Ua={},G5={exports:{}};(function(t){function s(a){return a&&a.__esModule?a:{default:a}}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports})(G5);var q5=G5.exports;const ID=qo(UO),$D=qo(tD);var z5=q5;Object.defineProperty(Ua,"__esModule",{value:!0});var ko=Ua.alpha=K5;Ua.blend=HD;Ua.colorChannel=void 0;var Ij=Ua.darken=$N;Ua.decomposeColor=lr;Ua.emphasize=Q5;var LD=Ua.getContrastRatio=BD;Ua.getLuminance=Y0;Ua.hexToRgb=W5;Ua.hslToRgb=X5;var $j=Ua.lighten=LN;Ua.private_safeAlpha=GD;Ua.private_safeColorChannel=void 0;Ua.private_safeDarken=qD;Ua.private_safeEmphasize=WD;Ua.private_safeLighten=zD;Ua.recomposeColor=Du;Ua.rgbToHex=_D;var v1=z5(ID),FD=z5($D);function IN(t,s=0,a=1){return(0,FD.default)(t,s,a)}function W5(t){t=t.slice(1);const s=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let a=t.match(s);return a&&a[0].length===1&&(a=a.map(l=>l+l)),a?`rgb${a.length===4?"a":""}(${a.map((l,n)=>n<3?parseInt(l,16):Math.round(parseInt(l,16)/255*1e3)/1e3).join(", ")})`:""}function UD(t){const s=t.toString(16);return s.length===1?`0${s}`:s}function lr(t){if(t.type)return t;if(t.charAt(0)==="#")return lr(W5(t));const s=t.indexOf("("),a=t.substring(0,s);if(["rgb","rgba","hsl","hsla","color"].indexOf(a)===-1)throw new Error((0,v1.default)(9,t));let l=t.substring(s+1,t.length-1),n;if(a==="color"){if(l=l.split(" "),n=l.shift(),l.length===4&&l[3].charAt(0)==="/"&&(l[3]=l[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(n)===-1)throw new Error((0,v1.default)(10,n))}else l=l.split(",");return l=l.map(r=>parseFloat(r)),{type:a,values:l,colorSpace:n}}const H5=t=>{const s=lr(t);return s.values.slice(0,3).map((a,l)=>s.type.indexOf("hsl")!==-1&&l!==0?`${a}%`:a).join(" ")};Ua.colorChannel=H5;const VD=(t,s)=>{try{return H5(t)}catch{return t}};Ua.private_safeColorChannel=VD;function Du(t){const{type:s,colorSpace:a}=t;let{values:l}=t;return s.indexOf("rgb")!==-1?l=l.map((n,r)=>r<3?parseInt(n,10):n):s.indexOf("hsl")!==-1&&(l[1]=`${l[1]}%`,l[2]=`${l[2]}%`),s.indexOf("color")!==-1?l=`${a} ${l.join(" ")}`:l=`${l.join(", ")}`,`${s}(${l})`}function _D(t){if(t.indexOf("#")===0)return t;const{values:s}=lr(t);return`#${s.map((a,l)=>UD(l===3?Math.round(255*a):a)).join("")}`}function X5(t){t=lr(t);const{values:s}=t,a=s[0],l=s[1]/100,n=s[2]/100,r=l*Math.min(n,1-n),i=(x,j=(x+a/30)%12)=>n-r*Math.max(Math.min(j-3,9-j,1),-1);let o="rgb";const c=[Math.round(i(0)*255),Math.round(i(8)*255),Math.round(i(4)*255)];return t.type==="hsla"&&(o+="a",c.push(s[3])),Du({type:o,values:c})}function Y0(t){t=lr(t);let s=t.type==="hsl"||t.type==="hsla"?lr(X5(t)).values:t.values;return s=s.map(a=>(t.type!=="color"&&(a/=255),a<=.03928?a/12.92:((a+.055)/1.055)**2.4)),Number((.2126*s[0]+.7152*s[1]+.0722*s[2]).toFixed(3))}function BD(t,s){const a=Y0(t),l=Y0(s);return(Math.max(a,l)+.05)/(Math.min(a,l)+.05)}function K5(t,s){return t=lr(t),s=IN(s),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${s}`:t.values[3]=s,Du(t)}function GD(t,s,a){try{return K5(t,s)}catch{return t}}function $N(t,s){if(t=lr(t),s=IN(s),t.type.indexOf("hsl")!==-1)t.values[2]*=1-s;else if(t.type.indexOf("rgb")!==-1||t.type.indexOf("color")!==-1)for(let a=0;a<3;a+=1)t.values[a]*=1-s;return Du(t)}function qD(t,s,a){try{return $N(t,s)}catch{return t}}function LN(t,s){if(t=lr(t),s=IN(s),t.type.indexOf("hsl")!==-1)t.values[2]+=(100-t.values[2])*s;else if(t.type.indexOf("rgb")!==-1)for(let a=0;a<3;a+=1)t.values[a]+=(255-t.values[a])*s;else if(t.type.indexOf("color")!==-1)for(let a=0;a<3;a+=1)t.values[a]+=(1-t.values[a])*s;return Du(t)}function zD(t,s,a){try{return LN(t,s)}catch{return t}}function Q5(t,s=.15){return Y0(t)>.5?$N(t,s):LN(t,s)}function WD(t,s,a){try{return Q5(t,s)}catch{return t}}function HD(t,s,a,l=1){const n=(c,x)=>Math.round((c**(1/l)*(1-a)+x**(1/l)*a)**l),r=lr(t),i=lr(s),o=[n(r.values[0],i.values[0]),n(r.values[1],i.values[1]),n(r.values[2],i.values[2])];return Du({type:"rgb",values:o})}const XD=["mode","contrastThreshold","tonalOffset"],b1={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Lx.white,default:Lx.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},rv={text:{primary:Lx.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Lx.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function j1(t,s,a,l){const n=l.light||l,r=l.dark||l*1.5;t[s]||(t.hasOwnProperty(a)?t[s]=t[a]:s==="light"?t.light=$j(t.main,n):s==="dark"&&(t.dark=Ij(t.main,r)))}function KD(t="light"){return t==="dark"?{main:tc[200],light:tc[50],dark:tc[400]}:{main:tc[700],light:tc[400],dark:tc[800]}}function QD(t="light"){return t==="dark"?{main:ec[200],light:ec[50],dark:ec[400]}:{main:ec[500],light:ec[300],dark:ec[700]}}function YD(t="light"){return t==="dark"?{main:Zd[500],light:Zd[300],dark:Zd[700]}:{main:Zd[700],light:Zd[400],dark:Zd[800]}}function JD(t="light"){return t==="dark"?{main:sc[400],light:sc[300],dark:sc[700]}:{main:sc[700],light:sc[500],dark:sc[900]}}function ZD(t="light"){return t==="dark"?{main:ac[400],light:ac[300],dark:ac[700]}:{main:ac[800],light:ac[500],dark:ac[900]}}function eI(t="light"){return t==="dark"?{main:Yu[400],light:Yu[300],dark:Yu[700]}:{main:"#ed6c02",light:Yu[500],dark:Yu[900]}}function tI(t){const{mode:s="light",contrastThreshold:a=3,tonalOffset:l=.2}=t,n=wa(t,XD),r=t.primary||KD(s),i=t.secondary||QD(s),o=t.error||YD(s),c=t.info||JD(s),x=t.success||ZD(s),j=t.warning||eI(s);function g(C){return LD(C,rv.text.primary)>=a?rv.text.primary:b1.text.primary}const y=({color:C,name:W,mainShade:L=500,lightShade:R=300,darkShade:F=700})=>{if(C=st({},C),!C.main&&C[L]&&(C.main=C[L]),!C.hasOwnProperty("main"))throw new Error(yu(11,W?` (${W})`:"",L));if(typeof C.main!="string")throw new Error(yu(12,W?` (${W})`:"",JSON.stringify(C.main)));return j1(C,"light",R,l),j1(C,"dark",F,l),C.contrastText||(C.contrastText=g(C.main)),C},$={dark:rv,light:b1};return si(st({common:st({},Lx),mode:s,primary:y({color:r,name:"primary"}),secondary:y({color:i,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:y({color:o,name:"error"}),warning:y({color:j,name:"warning"}),info:y({color:c,name:"info"}),success:y({color:x,name:"success"}),grey:FO,contrastThreshold:a,getContrastText:g,augmentColor:y,tonalOffset:l},$[s]),n)}const sI=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function aI(t){return Math.round(t*1e5)/1e5}const y1={textTransform:"uppercase"},N1='"Roboto", "Helvetica", "Arial", sans-serif';function lI(t,s){const a=typeof s=="function"?s(t):s,{fontFamily:l=N1,fontSize:n=14,fontWeightLight:r=300,fontWeightRegular:i=400,fontWeightMedium:o=500,fontWeightBold:c=700,htmlFontSize:x=16,allVariants:j,pxToRem:g}=a,y=wa(a,sI),$=n/14,T=g||(L=>`${L/x*$}rem`),C=(L,R,F,te,oe)=>st({fontFamily:l,fontWeight:L,fontSize:T(R),lineHeight:F},l===N1?{letterSpacing:`${aI(te/R)}em`}:{},oe,j),W={h1:C(r,96,1.167,-1.5),h2:C(r,60,1.2,-.5),h3:C(i,48,1.167,0),h4:C(i,34,1.235,.25),h5:C(i,24,1.334,0),h6:C(o,20,1.6,.15),subtitle1:C(i,16,1.75,.15),subtitle2:C(o,14,1.57,.1),body1:C(i,16,1.5,.15),body2:C(i,14,1.43,.15),button:C(o,14,1.75,.4,y1),caption:C(i,12,1.66,.4),overline:C(i,12,2.66,1,y1),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return si(st({htmlFontSize:x,pxToRem:T,fontFamily:l,fontSize:n,fontWeightLight:r,fontWeightRegular:i,fontWeightMedium:o,fontWeightBold:c},W),y,{clone:!1})}const nI=.2,rI=.14,iI=.12;function Ys(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${nI})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${rI})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${iI})`].join(",")}const oI=["none",Ys(0,2,1,-1,0,1,1,0,0,1,3,0),Ys(0,3,1,-2,0,2,2,0,0,1,5,0),Ys(0,3,3,-2,0,3,4,0,0,1,8,0),Ys(0,2,4,-1,0,4,5,0,0,1,10,0),Ys(0,3,5,-1,0,5,8,0,0,1,14,0),Ys(0,3,5,-1,0,6,10,0,0,1,18,0),Ys(0,4,5,-2,0,7,10,1,0,2,16,1),Ys(0,5,5,-3,0,8,10,1,0,3,14,2),Ys(0,5,6,-3,0,9,12,1,0,3,16,2),Ys(0,6,6,-3,0,10,14,1,0,4,18,3),Ys(0,6,7,-4,0,11,15,1,0,4,20,3),Ys(0,7,8,-4,0,12,17,2,0,5,22,4),Ys(0,7,8,-4,0,13,19,2,0,5,24,4),Ys(0,7,9,-4,0,14,21,2,0,5,26,4),Ys(0,8,9,-5,0,15,22,2,0,6,28,5),Ys(0,8,10,-5,0,16,24,2,0,6,30,5),Ys(0,8,11,-5,0,17,26,2,0,6,32,5),Ys(0,9,11,-5,0,18,28,2,0,7,34,6),Ys(0,9,12,-6,0,19,29,2,0,7,36,6),Ys(0,10,13,-6,0,20,31,3,0,8,38,7),Ys(0,10,13,-6,0,21,33,3,0,8,40,7),Ys(0,10,14,-6,0,22,35,3,0,8,42,7),Ys(0,11,14,-7,0,23,36,3,0,9,44,8),Ys(0,11,15,-7,0,24,38,3,0,9,46,8)],dI=["duration","easing","delay"],cI={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},uI={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function w1(t){return`${Math.round(t)}ms`}function mI(t){if(!t)return 0;const s=t/36;return Math.round((4+15*s**.25+s/5)*10)}function xI(t){const s=st({},cI,t.easing),a=st({},uI,t.duration);return st({getAutoHeightDuration:mI,create:(n=["all"],r={})=>{const{duration:i=a.standard,easing:o=s.easeInOut,delay:c=0}=r;return wa(r,dI),(Array.isArray(n)?n:[n]).map(x=>`${x} ${typeof i=="string"?i:w1(i)} ${o} ${typeof c=="string"?c:w1(c)}`).join(",")}},t,{easing:s,duration:a})}const pI={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},hI=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function Y5(t={},...s){const{mixins:a={},palette:l={},transitions:n={},typography:r={}}=t,i=wa(t,hI);if(t.vars&&t.generateCssVars===void 0)throw new Error(yu(18));const o=tI(l),c=ON(t);let x=si(c,{mixins:DD(c.breakpoints,a),palette:o,shadows:oI.slice(),typography:lI(o,r),transitions:xI(n),zIndex:st({},pI)});return x=si(x,i),x=s.reduce((j,g)=>si(j,g),x),x.unstable_sxConfig=st({},op,i==null?void 0:i.unstable_sxConfig),x.unstable_sx=function(g){return nf({sx:g,theme:this})},x}function k1(t){return String(parseFloat(t)).length===String(t).length}function gI(t){return String(t).match(/[\d.\-+]*\s*(.*)/)[1]||""}function Zo(t){return parseFloat(t)}function fI(t){return(s,a)=>{const l=gI(s);if(l===a)return s;let n=Zo(s);l!=="px"&&(l==="em"||l==="rem")&&(n=Zo(s)*Zo(t));let r=n;if(a!=="px")if(a==="em")r=n/Zo(t);else if(a==="rem")r=n/Zo(t);else return s;return parseFloat(r.toFixed(5))+a}}function vI({size:t,grid:s}){const a=t-t%s,l=a+s;return t-a<l-t?a:l}function bI({lineHeight:t,pixels:s,htmlFontSize:a}){return s/(t*a)}function jI({cssProperty:t,min:s,max:a,unit:l="rem",breakpoints:n=[600,900,1200],transform:r=null}){const i={[t]:`${s}${l}`},o=(a-s)/n[n.length-1];return n.forEach(c=>{let x=s+o*c;r!==null&&(x=r(x)),i[`@media (min-width:${c}px)`]={[t]:`${Math.round(x*1e4)/1e4}${l}`}}),i}function yI(t,s={}){const{breakpoints:a=["sm","md","lg"],disableAlign:l=!1,factor:n=2,variants:r=["h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","caption","button","overline"]}=s,i=st({},t);i.typography=st({},i.typography);const o=i.typography,c=fI(o.htmlFontSize),x=a.map(j=>i.breakpoints.values[j]);return r.forEach(j=>{const g=o[j];if(!g)return;const y=parseFloat(c(g.fontSize,"rem"));if(y<=1)return;const $=y,T=1+($-1)/n;let{lineHeight:C}=g;if(!k1(C)&&!l)throw new Error(yu(6));k1(C)||(C=parseFloat(c(C,"rem"))/parseFloat(y));let W=null;l||(W=L=>vI({size:L,grid:bI({pixels:4,lineHeight:C,htmlFontSize:o.htmlFontSize})})),o[j]=st({},g,jI({cssProperty:"fontSize",min:T,max:$,unit:"rem",breakpoints:x,transform:W}))}),i}const J5=Y5();var dp={},iv={exports:{}},C1;function NI(){return C1||(C1=1,function(t){function s(a,l){if(a==null)return{};var n={};for(var r in a)if({}.hasOwnProperty.call(a,r)){if(l.indexOf(r)!==-1)continue;n[r]=a[r]}return n}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports}(iv)),iv.exports}const wI=qo(WT),kI=qo(HT),CI=qo(JT),SI=qo(ZR),AI=qo(UR),EI=qo(zR);var Iu=q5;Object.defineProperty(dp,"__esModule",{value:!0});var MI=dp.default=BI;dp.shouldForwardProp=c0;dp.systemDefaultTheme=void 0;var Kn=Iu(N5()),Lj=Iu(NI()),J0=$I(wI),PI=kI;Iu(CI);Iu(SI);var OI=Iu(AI),TI=Iu(EI);const RI=["ownerState"],DI=["variants"],II=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function Z5(t){if(typeof WeakMap!="function")return null;var s=new WeakMap,a=new WeakMap;return(Z5=function(l){return l?a:s})(t)}function $I(t,s){if(t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var a=Z5(s);if(a&&a.has(t))return a.get(t);var l={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)){var i=n?Object.getOwnPropertyDescriptor(t,r):null;i&&(i.get||i.set)?Object.defineProperty(l,r,i):l[r]=t[r]}return l.default=t,a&&a.set(t,l),l}function LI(t){return Object.keys(t).length===0}function FI(t){return typeof t=="string"&&t.charCodeAt(0)>96}function c0(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}function S1(t,s){return s&&t&&typeof t=="object"&&t.styles&&!t.styles.startsWith("@layer")&&(t.styles=`@layer ${s}{${String(t.styles)}}`),t}const UI=dp.systemDefaultTheme=(0,OI.default)(),VI=t=>t&&t.charAt(0).toLowerCase()+t.slice(1);function Ip({defaultTheme:t,theme:s,themeId:a}){return LI(s)?t:s[a]||s}function _I(t){return t?(s,a)=>a[t]:null}function u0(t,s,a){let{ownerState:l}=s,n=(0,Lj.default)(s,RI);const r=typeof t=="function"?t((0,Kn.default)({ownerState:l},n)):t;if(Array.isArray(r))return r.flatMap(i=>u0(i,(0,Kn.default)({ownerState:l},n),a));if(r&&typeof r=="object"&&Array.isArray(r.variants)){const{variants:i=[]}=r;let c=(0,Lj.default)(r,DI);return i.forEach(x=>{let j=!0;if(typeof x.props=="function"?j=x.props((0,Kn.default)({ownerState:l},n,l)):Object.keys(x.props).forEach(g=>{(l==null?void 0:l[g])!==x.props[g]&&n[g]!==x.props[g]&&(j=!1)}),j){Array.isArray(c)||(c=[c]);const g=typeof x.style=="function"?x.style((0,Kn.default)({ownerState:l},n,l)):x.style;c.push(a?S1((0,J0.internal_serializeStyles)(g),a):g)}}),c}return a?S1((0,J0.internal_serializeStyles)(r),a):r}function BI(t={}){const{themeId:s,defaultTheme:a=UI,rootShouldForwardProp:l=c0,slotShouldForwardProp:n=c0}=t,r=i=>(0,TI.default)((0,Kn.default)({},i,{theme:Ip((0,Kn.default)({},i,{defaultTheme:a,themeId:s}))}));return r.__mui_systemSx=!0,(i,o={})=>{(0,J0.internal_processStyles)(i,G=>G.filter(H=>!(H!=null&&H.__mui_systemSx)));const{name:c,slot:x,skipVariantsResolver:j,skipSx:g,overridesResolver:y=_I(VI(x))}=o,$=(0,Lj.default)(o,II),T=c&&c.startsWith("Mui")||x?"components":"custom",C=j!==void 0?j:x&&x!=="Root"&&x!=="root"||!1,W=g||!1;let L,R=c0;x==="Root"||x==="root"?R=l:x?R=n:FI(i)&&(R=void 0);const F=(0,J0.default)(i,(0,Kn.default)({shouldForwardProp:R,label:L},$)),te=G=>typeof G=="function"&&G.__emotion_real!==G||(0,PI.isPlainObject)(G)?H=>{const Y=Ip({theme:H.theme,defaultTheme:a,themeId:s});return u0(G,(0,Kn.default)({},H,{theme:Y}),Y.modularCssLayers?T:void 0)}:G,oe=(G,...H)=>{let Y=te(G);const we=H?H.map(te):[];c&&y&&we.push(_e=>{const Ee=Ip((0,Kn.default)({},_e,{defaultTheme:a,themeId:s}));if(!Ee.components||!Ee.components[c]||!Ee.components[c].styleOverrides)return null;const be=Ee.components[c].styleOverrides,Fe={};return Object.entries(be).forEach(([Pe,pe])=>{Fe[Pe]=u0(pe,(0,Kn.default)({},_e,{theme:Ee}),Ee.modularCssLayers?"theme":void 0)}),y(_e,Fe)}),c&&!C&&we.push(_e=>{var Ee;const be=Ip((0,Kn.default)({},_e,{defaultTheme:a,themeId:s})),Fe=be==null||(Ee=be.components)==null||(Ee=Ee[c])==null?void 0:Ee.variants;return u0({variants:Fe},(0,Kn.default)({},_e,{theme:be}),be.modularCssLayers?"theme":void 0)}),W||we.push(r);const q=we.length-H.length;if(Array.isArray(G)&&q>0){const _e=new Array(q).fill("");Y=[...G,..._e],Y.raw=[...G.raw,..._e]}const je=F(Y,...we);return i.muiName&&(je.muiName=i.muiName),je};return F.withConfig&&(oe.withConfig=F.withConfig),oe}}function GI(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const eA=t=>GI(t)&&t!=="classes",ln=MI({themeId:H0,defaultTheme:J5,rootShouldForwardProp:eA}),qI=["theme"];function zI(t){let{theme:s}=t,a=wa(t,qI);const l=s[H0];let n=l||s;return typeof s!="function"&&(l&&!l.vars?n=st({},l,{vars:null}):s&&!s.vars&&(n=st({},s,{vars:null}))),e.jsx(RD,st({},a,{themeId:l?H0:void 0,theme:n}))}const A1=t=>{let s;return t<1?s=5.11916*t**2:s=4.5*Math.log(t+1)+2,(s/100).toFixed(2)};function di(t){return OD(t)}function WI(t){return _i("MuiSvgIcon",t)}Bi("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const HI=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],XI=t=>{const{color:s,fontSize:a,classes:l}=t,n={root:["root",s!=="inherit"&&`color${Ns(s)}`,`fontSize${Ns(a)}`]};return Ko(n,WI,l)},KI=ln("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:a}=t;return[s.root,a.color!=="inherit"&&s[`color${Ns(a.color)}`],s[`fontSize${Ns(a.fontSize)}`]]}})(({theme:t,ownerState:s})=>{var a,l,n,r,i,o,c,x,j,g,y,$,T;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:s.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(a=t.transitions)==null||(l=a.create)==null?void 0:l.call(a,"fill",{duration:(n=t.transitions)==null||(n=n.duration)==null?void 0:n.shorter}),fontSize:{inherit:"inherit",small:((r=t.typography)==null||(i=r.pxToRem)==null?void 0:i.call(r,20))||"1.25rem",medium:((o=t.typography)==null||(c=o.pxToRem)==null?void 0:c.call(o,24))||"1.5rem",large:((x=t.typography)==null||(j=x.pxToRem)==null?void 0:j.call(x,35))||"2.1875rem"}[s.fontSize],color:(g=(y=(t.vars||t).palette)==null||(y=y[s.color])==null?void 0:y.main)!=null?g:{action:($=(t.vars||t).palette)==null||($=$.action)==null?void 0:$.active,disabled:(T=(t.vars||t).palette)==null||(T=T.action)==null?void 0:T.disabled,inherit:void 0}[s.color]}}),Fj=d.forwardRef(function(s,a){const l=di({props:s,name:"MuiSvgIcon"}),{children:n,className:r,color:i="inherit",component:o="svg",fontSize:c="medium",htmlColor:x,inheritViewBox:j=!1,titleAccess:g,viewBox:y="0 0 24 24"}=l,$=wa(l,HI),T=d.isValidElement(n)&&n.type==="svg",C=st({},l,{color:i,component:o,fontSize:c,instanceFontSize:s.fontSize,inheritViewBox:j,viewBox:y,hasSvgAsChild:T}),W={};j||(W.viewBox=y);const L=XI(C);return e.jsxs(KI,st({as:o,className:Ha(L.root,r),focusable:"false",color:x,"aria-hidden":g?void 0:!0,role:g?"img":void 0,ref:a},W,$,T&&n.props,{ownerState:C,children:[T?n.props.children:n,g?e.jsx("title",{children:g}):null]}))});Fj.muiName="SvgIcon";function cp(t,s){function a(l,n){return e.jsx(Fj,st({"data-testid":`${s}Icon`,ref:n},l,{children:t}))}return a.muiName=Fj.muiName,d.memo(d.forwardRef(a))}function Uj(t,s){return Uj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,l){return a.__proto__=l,a},Uj(t,s)}function QI(t,s){t.prototype=Object.create(s.prototype),t.prototype.constructor=t,Uj(t,s)}const E1=qt.createContext(null);function YI(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function FN(t,s){var a=function(r){return s&&d.isValidElement(r)?s(r):r},l=Object.create(null);return t&&d.Children.map(t,function(n){return n}).forEach(function(n){l[n.key]=a(n)}),l}function JI(t,s){t=t||{},s=s||{};function a(j){return j in s?s[j]:t[j]}var l=Object.create(null),n=[];for(var r in t)r in s?n.length&&(l[r]=n,n=[]):n.push(r);var i,o={};for(var c in s){if(l[c])for(i=0;i<l[c].length;i++){var x=l[c][i];o[l[c][i]]=a(x)}o[c]=a(c)}for(i=0;i<n.length;i++)o[n[i]]=a(n[i]);return o}function Td(t,s,a){return a[s]!=null?a[s]:t.props[s]}function ZI(t,s){return FN(t.children,function(a){return d.cloneElement(a,{onExited:s.bind(null,a),in:!0,appear:Td(a,"appear",t),enter:Td(a,"enter",t),exit:Td(a,"exit",t)})})}function e9(t,s,a){var l=FN(t.children),n=JI(s,l);return Object.keys(n).forEach(function(r){var i=n[r];if(d.isValidElement(i)){var o=r in s,c=r in l,x=s[r],j=d.isValidElement(x)&&!x.props.in;c&&(!o||j)?n[r]=d.cloneElement(i,{onExited:a.bind(null,i),in:!0,exit:Td(i,"exit",t),enter:Td(i,"enter",t)}):!c&&o&&!j?n[r]=d.cloneElement(i,{in:!1}):c&&o&&d.isValidElement(x)&&(n[r]=d.cloneElement(i,{onExited:a.bind(null,i),in:x.props.in,exit:Td(i,"exit",t),enter:Td(i,"enter",t)}))}}),n}var t9=Object.values||function(t){return Object.keys(t).map(function(s){return t[s]})},s9={component:"div",childFactory:function(s){return s}},UN=function(t){QI(s,t);function s(l,n){var r;r=t.call(this,l,n)||this;var i=r.handleExited.bind(YI(r));return r.state={contextValue:{isMounting:!0},handleExited:i,firstRender:!0},r}var a=s.prototype;return a.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},a.componentWillUnmount=function(){this.mounted=!1},s.getDerivedStateFromProps=function(n,r){var i=r.children,o=r.handleExited,c=r.firstRender;return{children:c?ZI(n,o):e9(n,i,o),firstRender:!1}},a.handleExited=function(n,r){var i=FN(this.props.children);n.key in i||(n.props.onExited&&n.props.onExited(r),this.mounted&&this.setState(function(o){var c=st({},o.children);return delete c[n.key],{children:c}}))},a.render=function(){var n=this.props,r=n.component,i=n.childFactory,o=wa(n,["component","childFactory"]),c=this.state.contextValue,x=t9(this.state.children).map(i);return delete o.appear,delete o.enter,delete o.exit,r===null?qt.createElement(E1.Provider,{value:c},x):qt.createElement(E1.Provider,{value:c},qt.createElement(r,o,x))},s}(qt.Component);UN.propTypes={};UN.defaultProps=s9;function a9(t){return _i("MuiPaper",t)}Bi("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const l9=["className","component","elevation","square","variant"],n9=t=>{const{square:s,elevation:a,variant:l,classes:n}=t,r={root:["root",l,!s&&"rounded",l==="elevation"&&`elevation${a}`]};return Ko(r,a9,n)},r9=ln("div",{name:"MuiPaper",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:a}=t;return[s.root,s[a.variant],!a.square&&s.rounded,a.variant==="elevation"&&s[`elevation${a.elevation}`]]}})(({theme:t,ownerState:s})=>{var a;return st({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow")},!s.square&&{borderRadius:t.shape.borderRadius},s.variant==="outlined"&&{border:`1px solid ${(t.vars||t).palette.divider}`},s.variant==="elevation"&&st({boxShadow:(t.vars||t).shadows[s.elevation]},!t.vars&&t.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${ko("#fff",A1(s.elevation))}, ${ko("#fff",A1(s.elevation))})`},t.vars&&{backgroundImage:(a=t.vars.overlays)==null?void 0:a[s.elevation]}))}),i9=d.forwardRef(function(s,a){const l=di({props:s,name:"MuiPaper"}),{className:n,component:r="div",elevation:i=1,square:o=!1,variant:c="elevation"}=l,x=wa(l,l9),j=st({},l,{component:r,elevation:i,square:o,variant:c}),g=n9(j);return e.jsx(r9,st({as:r,ownerState:j,className:Ha(g.root,n),ref:a},x))}),o9=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],d9=["component","slots","slotProps"],c9=["component"];function M1(t,s){const{className:a,elementType:l,ownerState:n,externalForwardedProps:r,getSlotOwnerState:i,internalForwardedProps:o}=s,c=wa(s,o9),{component:x,slots:j={[t]:void 0},slotProps:g={[t]:void 0}}=r,y=wa(r,d9),$=j[t]||l,T=yD(g[t],n),C=jD(st({className:a},c,{externalForwardedProps:t==="root"?y:void 0,externalSlotProps:T})),{props:{component:W},internalRef:L}=C,R=wa(C.props,c9),F=Rj(L,T==null?void 0:T.ref,s.ref),te=i?i(R):{},oe=st({},n,te),G=t==="root"?W||x:W,H=vD($,st({},t==="root"&&!x&&!j[t]&&o,t!=="root"&&!j[t]&&o,R,G&&{as:G},{ref:F}),oe);return Object.keys(te).forEach(Y=>{delete H[Y]}),[$,H]}function u9(t){const{className:s,classes:a,pulsate:l=!1,rippleX:n,rippleY:r,rippleSize:i,in:o,onExited:c,timeout:x}=t,[j,g]=d.useState(!1),y=Ha(s,a.ripple,a.rippleVisible,l&&a.ripplePulsate),$={width:i,height:i,top:-(i/2)+r,left:-(i/2)+n},T=Ha(a.child,j&&a.childLeaving,l&&a.childPulsate);return!o&&!j&&g(!0),d.useEffect(()=>{if(!o&&c!=null){const C=setTimeout(c,x);return()=>{clearTimeout(C)}}},[c,o,x]),e.jsx("span",{className:y,style:$,children:e.jsx("span",{className:T})})}const Qn=Bi("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),m9=["center","classes","className"];let bf=t=>t,P1,O1,T1,R1;const Vj=550,x9=80,p9=Jg(P1||(P1=bf`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),h9=Jg(O1||(O1=bf`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),g9=Jg(T1||(T1=bf`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),f9=ln("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),v9=ln(u9,{name:"MuiTouchRipple",slot:"Ripple"})(R1||(R1=bf`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),Qn.rippleVisible,p9,Vj,({theme:t})=>t.transitions.easing.easeInOut,Qn.ripplePulsate,({theme:t})=>t.transitions.duration.shorter,Qn.child,Qn.childLeaving,h9,Vj,({theme:t})=>t.transitions.easing.easeInOut,Qn.childPulsate,g9,({theme:t})=>t.transitions.easing.easeInOut),b9=d.forwardRef(function(s,a){const l=di({props:s,name:"MuiTouchRipple"}),{center:n=!1,classes:r={},className:i}=l,o=wa(l,m9),[c,x]=d.useState([]),j=d.useRef(0),g=d.useRef(null);d.useEffect(()=>{g.current&&(g.current(),g.current=null)},[c]);const y=d.useRef(!1),$=oD(),T=d.useRef(null),C=d.useRef(null),W=d.useCallback(te=>{const{pulsate:oe,rippleX:G,rippleY:H,rippleSize:Y,cb:we}=te;x(q=>[...q,e.jsx(v9,{classes:{ripple:Ha(r.ripple,Qn.ripple),rippleVisible:Ha(r.rippleVisible,Qn.rippleVisible),ripplePulsate:Ha(r.ripplePulsate,Qn.ripplePulsate),child:Ha(r.child,Qn.child),childLeaving:Ha(r.childLeaving,Qn.childLeaving),childPulsate:Ha(r.childPulsate,Qn.childPulsate)},timeout:Vj,pulsate:oe,rippleX:G,rippleY:H,rippleSize:Y},j.current)]),j.current+=1,g.current=we},[r]),L=d.useCallback((te={},oe={},G=()=>{})=>{const{pulsate:H=!1,center:Y=n||oe.pulsate,fakeElement:we=!1}=oe;if((te==null?void 0:te.type)==="mousedown"&&y.current){y.current=!1;return}(te==null?void 0:te.type)==="touchstart"&&(y.current=!0);const q=we?null:C.current,je=q?q.getBoundingClientRect():{width:0,height:0,left:0,top:0};let _e,Ee,be;if(Y||te===void 0||te.clientX===0&&te.clientY===0||!te.clientX&&!te.touches)_e=Math.round(je.width/2),Ee=Math.round(je.height/2);else{const{clientX:Fe,clientY:Pe}=te.touches&&te.touches.length>0?te.touches[0]:te;_e=Math.round(Fe-je.left),Ee=Math.round(Pe-je.top)}if(Y)be=Math.sqrt((2*je.width**2+je.height**2)/3),be%2===0&&(be+=1);else{const Fe=Math.max(Math.abs((q?q.clientWidth:0)-_e),_e)*2+2,Pe=Math.max(Math.abs((q?q.clientHeight:0)-Ee),Ee)*2+2;be=Math.sqrt(Fe**2+Pe**2)}te!=null&&te.touches?T.current===null&&(T.current=()=>{W({pulsate:H,rippleX:_e,rippleY:Ee,rippleSize:be,cb:G})},$.start(x9,()=>{T.current&&(T.current(),T.current=null)})):W({pulsate:H,rippleX:_e,rippleY:Ee,rippleSize:be,cb:G})},[n,W,$]),R=d.useCallback(()=>{L({},{pulsate:!0})},[L]),F=d.useCallback((te,oe)=>{if($.clear(),(te==null?void 0:te.type)==="touchend"&&T.current){T.current(),T.current=null,$.start(0,()=>{F(te,oe)});return}T.current=null,x(G=>G.length>0?G.slice(1):G),g.current=oe},[$]);return d.useImperativeHandle(a,()=>({pulsate:R,start:L,stop:F}),[R,L,F]),e.jsx(f9,st({className:Ha(Qn.root,r.root,i),ref:C},o,{children:e.jsx(UN,{component:null,exit:!0,children:c})}))});function j9(t){return _i("MuiButtonBase",t)}const y9=Bi("MuiButtonBase",["root","disabled","focusVisible"]),N9=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],w9=t=>{const{disabled:s,focusVisible:a,focusVisibleClassName:l,classes:n}=t,i=Ko({root:["root",s&&"disabled",a&&"focusVisible"]},j9,n);return a&&l&&(i.root+=` ${l}`),i},k9=ln("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(t,s)=>s.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${y9.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),tA=d.forwardRef(function(s,a){const l=di({props:s,name:"MuiButtonBase"}),{action:n,centerRipple:r=!1,children:i,className:o,component:c="button",disabled:x=!1,disableRipple:j=!1,disableTouchRipple:g=!1,focusRipple:y=!1,LinkComponent:$="a",onBlur:T,onClick:C,onContextMenu:W,onDragLeave:L,onFocus:R,onFocusVisible:F,onKeyDown:te,onKeyUp:oe,onMouseDown:G,onMouseLeave:H,onMouseUp:Y,onTouchEnd:we,onTouchMove:q,onTouchStart:je,tabIndex:_e=0,TouchRippleProps:Ee,touchRippleRef:be,type:Fe}=l,Pe=wa(l,N9),pe=d.useRef(null),Q=d.useRef(null),Re=Rj(Q,be),{isFocusVisibleRef:ce,onFocus:xe,onBlur:he,ref:de}=gD(),[ye,Ke]=d.useState(!1);x&&ye&&Ke(!1),d.useImperativeHandle(n,()=>({focusVisible:()=>{Ke(!0),pe.current.focus()}}),[]);const[Le,Ne]=d.useState(!1);d.useEffect(()=>{Ne(!0)},[]);const ge=Le&&!j&&!x;d.useEffect(()=>{ye&&y&&!j&&Le&&Q.current.pulsate()},[j,y,ye,Le]);function $e(De,fe,me=g){return Dp(Xe=>(fe&&fe(Xe),!me&&Q.current&&Q.current[De](Xe),!0))}const ie=$e("start",G),Oe=$e("stop",W),Se=$e("stop",L),Te=$e("stop",Y),Ge=$e("stop",De=>{ye&&De.preventDefault(),H&&H(De)}),We=$e("start",je),ze=$e("stop",we),Ue=$e("stop",q),le=$e("stop",De=>{he(De),ce.current===!1&&Ke(!1),T&&T(De)},!1),z=Dp(De=>{pe.current||(pe.current=De.currentTarget),xe(De),ce.current===!0&&(Ke(!0),F&&F(De)),R&&R(De)}),Ae=()=>{const De=pe.current;return c&&c!=="button"&&!(De.tagName==="A"&&De.href)},Ve=d.useRef(!1),Ye=Dp(De=>{y&&!Ve.current&&ye&&Q.current&&De.key===" "&&(Ve.current=!0,Q.current.stop(De,()=>{Q.current.start(De)})),De.target===De.currentTarget&&Ae()&&De.key===" "&&De.preventDefault(),te&&te(De),De.target===De.currentTarget&&Ae()&&De.key==="Enter"&&!x&&(De.preventDefault(),C&&C(De))}),Be=Dp(De=>{y&&De.key===" "&&Q.current&&ye&&!De.defaultPrevented&&(Ve.current=!1,Q.current.stop(De,()=>{Q.current.pulsate(De)})),oe&&oe(De),C&&De.target===De.currentTarget&&Ae()&&De.key===" "&&!De.defaultPrevented&&C(De)});let w=c;w==="button"&&(Pe.href||Pe.to)&&(w=$);const B={};w==="button"?(B.type=Fe===void 0?"button":Fe,B.disabled=x):(!Pe.href&&!Pe.to&&(B.role="button"),x&&(B["aria-disabled"]=x));const ue=Rj(a,de,pe),ne=st({},l,{centerRipple:r,component:c,disabled:x,disableRipple:j,disableTouchRipple:g,focusRipple:y,tabIndex:_e,focusVisible:ye}),Me=w9(ne);return e.jsxs(k9,st({as:w,className:Ha(Me.root,o),ownerState:ne,onBlur:le,onClick:C,onContextMenu:Oe,onFocus:z,onKeyDown:Ye,onKeyUp:Be,onMouseDown:ie,onMouseLeave:Ge,onMouseUp:Te,onDragLeave:Se,onTouchEnd:ze,onTouchMove:Ue,onTouchStart:We,ref:ue,tabIndex:x?-1:_e,type:Fe},B,Pe,{children:[i,ge?e.jsx(b9,st({ref:Re,center:r},Ee)):null]}))});function C9(t){return _i("MuiAlert",t)}const D1=Bi("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]);function S9(t){return _i("MuiIconButton",t)}const A9=Bi("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),E9=["edge","children","className","color","disabled","disableFocusRipple","size"],M9=t=>{const{classes:s,disabled:a,color:l,edge:n,size:r}=t,i={root:["root",a&&"disabled",l!=="default"&&`color${Ns(l)}`,n&&`edge${Ns(n)}`,`size${Ns(r)}`]};return Ko(i,S9,s)},P9=ln(tA,{name:"MuiIconButton",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:a}=t;return[s.root,a.color!=="default"&&s[`color${Ns(a.color)}`],a.edge&&s[`edge${Ns(a.edge)}`],s[`size${Ns(a.size)}`]]}})(({theme:t,ownerState:s})=>st({textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(t.vars||t).palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest})},!s.disableRipple&&{"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:ko(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},s.edge==="start"&&{marginLeft:s.size==="small"?-3:-12},s.edge==="end"&&{marginRight:s.size==="small"?-3:-12}),({theme:t,ownerState:s})=>{var a;const l=(a=(t.vars||t).palette)==null?void 0:a[s.color];return st({},s.color==="inherit"&&{color:"inherit"},s.color!=="inherit"&&s.color!=="default"&&st({color:l==null?void 0:l.main},!s.disableRipple&&{"&:hover":st({},l&&{backgroundColor:t.vars?`rgba(${l.mainChannel} / ${t.vars.palette.action.hoverOpacity})`:ko(l.main,t.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),s.size==="small"&&{padding:5,fontSize:t.typography.pxToRem(18)},s.size==="large"&&{padding:12,fontSize:t.typography.pxToRem(28)},{[`&.${A9.disabled}`]:{backgroundColor:"transparent",color:(t.vars||t).palette.action.disabled}})}),O9=d.forwardRef(function(s,a){const l=di({props:s,name:"MuiIconButton"}),{edge:n=!1,children:r,className:i,color:o="default",disabled:c=!1,disableFocusRipple:x=!1,size:j="medium"}=l,g=wa(l,E9),y=st({},l,{edge:n,color:o,disabled:c,disableFocusRipple:x,size:j}),$=M9(y);return e.jsx(P9,st({className:Ha($.root,i),centerRipple:!0,focusRipple:!x,disabled:c,ref:a},g,{ownerState:y,children:r}))}),T9=cp(e.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),R9=cp(e.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),D9=cp(e.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),I9=cp(e.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),$9=cp(e.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),L9=["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"],F9=t=>{const{variant:s,color:a,severity:l,classes:n}=t,r={root:["root",`color${Ns(a||l)}`,`${s}${Ns(a||l)}`,`${s}`],icon:["icon"],message:["message"],action:["action"]};return Ko(r,C9,n)},U9=ln(i9,{name:"MuiAlert",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:a}=t;return[s.root,s[a.variant],s[`${a.variant}${Ns(a.color||a.severity)}`]]}})(({theme:t})=>{const s=t.palette.mode==="light"?Ij:$j,a=t.palette.mode==="light"?$j:Ij;return st({},t.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(t.palette).filter(([,l])=>l.main&&l.light).map(([l])=>({props:{colorSeverity:l,variant:"standard"},style:{color:t.vars?t.vars.palette.Alert[`${l}Color`]:s(t.palette[l].light,.6),backgroundColor:t.vars?t.vars.palette.Alert[`${l}StandardBg`]:a(t.palette[l].light,.9),[`& .${D1.icon}`]:t.vars?{color:t.vars.palette.Alert[`${l}IconColor`]}:{color:t.palette[l].main}}})),...Object.entries(t.palette).filter(([,l])=>l.main&&l.light).map(([l])=>({props:{colorSeverity:l,variant:"outlined"},style:{color:t.vars?t.vars.palette.Alert[`${l}Color`]:s(t.palette[l].light,.6),border:`1px solid ${(t.vars||t).palette[l].light}`,[`& .${D1.icon}`]:t.vars?{color:t.vars.palette.Alert[`${l}IconColor`]}:{color:t.palette[l].main}}})),...Object.entries(t.palette).filter(([,l])=>l.main&&l.dark).map(([l])=>({props:{colorSeverity:l,variant:"filled"},style:st({fontWeight:t.typography.fontWeightMedium},t.vars?{color:t.vars.palette.Alert[`${l}FilledColor`],backgroundColor:t.vars.palette.Alert[`${l}FilledBg`]}:{backgroundColor:t.palette.mode==="dark"?t.palette[l].dark:t.palette[l].main,color:t.palette.getContrastText(t.palette[l].main)})}))]})}),V9=ln("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(t,s)=>s.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),_9=ln("div",{name:"MuiAlert",slot:"Message",overridesResolver:(t,s)=>s.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),I1=ln("div",{name:"MuiAlert",slot:"Action",overridesResolver:(t,s)=>s.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),$1={success:e.jsx(T9,{fontSize:"inherit"}),warning:e.jsx(R9,{fontSize:"inherit"}),error:e.jsx(D9,{fontSize:"inherit"}),info:e.jsx(I9,{fontSize:"inherit"})},B9=d.forwardRef(function(s,a){const l=di({props:s,name:"MuiAlert"}),{action:n,children:r,className:i,closeText:o="Close",color:c,components:x={},componentsProps:j={},icon:g,iconMapping:y=$1,onClose:$,role:T="alert",severity:C="success",slotProps:W={},slots:L={},variant:R="standard"}=l,F=wa(l,L9),te=st({},l,{color:c,severity:C,variant:R,colorSeverity:c||C}),oe=F9(te),G={slots:st({closeButton:x.CloseButton,closeIcon:x.CloseIcon},L),slotProps:st({},j,W)},[H,Y]=M1("closeButton",{elementType:O9,externalForwardedProps:G,ownerState:te}),[we,q]=M1("closeIcon",{elementType:$9,externalForwardedProps:G,ownerState:te});return e.jsxs(U9,st({role:T,elevation:0,ownerState:te,className:Ha(oe.root,i),ref:a},F,{children:[g!==!1?e.jsx(V9,{ownerState:te,className:oe.icon,children:g||y[C]||$1[C]}):null,e.jsx(_9,{ownerState:te,className:oe.message,children:r}),n!=null?e.jsx(I1,{ownerState:te,className:oe.action,children:n}):null,n==null&&$?e.jsx(I1,{ownerState:te,className:oe.action,children:e.jsx(H,st({size:"small","aria-label":o,title:o,color:"inherit",onClick:$},Y,{children:e.jsx(we,st({fontSize:"small"},q))}))}):null]}))});function G9(t){return _i("MuiTypography",t)}Bi("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const q9=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],z9=t=>{const{align:s,gutterBottom:a,noWrap:l,paragraph:n,variant:r,classes:i}=t,o={root:["root",r,t.align!=="inherit"&&`align${Ns(s)}`,a&&"gutterBottom",l&&"noWrap",n&&"paragraph"]};return Ko(o,G9,i)},W9=ln("span",{name:"MuiTypography",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:a}=t;return[s.root,a.variant&&s[a.variant],a.align!=="inherit"&&s[`align${Ns(a.align)}`],a.noWrap&&s.noWrap,a.gutterBottom&&s.gutterBottom,a.paragraph&&s.paragraph]}})(({theme:t,ownerState:s})=>st({margin:0},s.variant==="inherit"&&{font:"inherit"},s.variant!=="inherit"&&t.typography[s.variant],s.align!=="inherit"&&{textAlign:s.align},s.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},s.gutterBottom&&{marginBottom:"0.35em"},s.paragraph&&{marginBottom:16})),L1={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},H9={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},X9=t=>H9[t]||t,K9=d.forwardRef(function(s,a){const l=di({props:s,name:"MuiTypography"}),n=X9(l.color),r=D5(st({},l,{color:n})),{align:i="inherit",className:o,component:c,gutterBottom:x=!1,noWrap:j=!1,paragraph:g=!1,variant:y="body1",variantMapping:$=L1}=r,T=wa(r,q9),C=st({},r,{align:i,color:n,className:o,component:c,gutterBottom:x,noWrap:j,paragraph:g,variant:y,variantMapping:$}),W=c||(g?"p":$[y]||L1[y])||"span",L=z9(C);return e.jsx(W9,st({as:W,ref:a,ownerState:C,className:Ha(L.root,o)},T))});function Q9(t){return _i("MuiAlertTitle",t)}Bi("MuiAlertTitle",["root"]);const Y9=["className"],J9=t=>{const{classes:s}=t;return Ko({root:["root"]},Q9,s)},Z9=ln(K9,{name:"MuiAlertTitle",slot:"Root",overridesResolver:(t,s)=>s.root})(({theme:t})=>({fontWeight:t.typography.fontWeightMedium,marginTop:-2})),e$=d.forwardRef(function(s,a){const l=di({props:s,name:"MuiAlertTitle"}),{className:n}=l,r=wa(l,Y9),i=l,o=J9(i);return e.jsx(Z9,st({gutterBottom:!0,component:"div",ownerState:i,ref:a,className:Ha(o.root,n)},r))});function t$(t){return e.jsx(R5,st({},t,{defaultTheme:J5,themeId:H0}))}function s$(t){return _i("MuiButton",t)}const $p=Bi("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),a$=d.createContext({}),l$=d.createContext(void 0),n$=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],r$=t=>{const{color:s,disableElevation:a,fullWidth:l,size:n,variant:r,classes:i}=t,o={root:["root",r,`${r}${Ns(s)}`,`size${Ns(n)}`,`${r}Size${Ns(n)}`,`color${Ns(s)}`,a&&"disableElevation",l&&"fullWidth"],label:["label"],startIcon:["icon","startIcon",`iconSize${Ns(n)}`],endIcon:["icon","endIcon",`iconSize${Ns(n)}`]},c=Ko(o,s$,i);return st({},i,c)},sA=t=>st({},t.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},t.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},t.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),i$=ln(tA,{shouldForwardProp:t=>eA(t)||t==="classes",name:"MuiButton",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:a}=t;return[s.root,s[a.variant],s[`${a.variant}${Ns(a.color)}`],s[`size${Ns(a.size)}`],s[`${a.variant}Size${Ns(a.size)}`],a.color==="inherit"&&s.colorInherit,a.disableElevation&&s.disableElevation,a.fullWidth&&s.fullWidth]}})(({theme:t,ownerState:s})=>{var a,l;const n=t.palette.mode==="light"?t.palette.grey[300]:t.palette.grey[800],r=t.palette.mode==="light"?t.palette.grey.A100:t.palette.grey[700];return st({},t.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":st({textDecoration:"none",backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:ko(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},s.variant==="text"&&s.color!=="inherit"&&{backgroundColor:t.vars?`rgba(${t.vars.palette[s.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:ko(t.palette[s.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},s.variant==="outlined"&&s.color!=="inherit"&&{border:`1px solid ${(t.vars||t).palette[s.color].main}`,backgroundColor:t.vars?`rgba(${t.vars.palette[s.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:ko(t.palette[s.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},s.variant==="contained"&&{backgroundColor:t.vars?t.vars.palette.Button.inheritContainedHoverBg:r,boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2],backgroundColor:(t.vars||t).palette.grey[300]}},s.variant==="contained"&&s.color!=="inherit"&&{backgroundColor:(t.vars||t).palette[s.color].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[s.color].main}}),"&:active":st({},s.variant==="contained"&&{boxShadow:(t.vars||t).shadows[8]}),[`&.${$p.focusVisible}`]:st({},s.variant==="contained"&&{boxShadow:(t.vars||t).shadows[6]}),[`&.${$p.disabled}`]:st({color:(t.vars||t).palette.action.disabled},s.variant==="outlined"&&{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`},s.variant==="contained"&&{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground})},s.variant==="text"&&{padding:"6px 8px"},s.variant==="text"&&s.color!=="inherit"&&{color:(t.vars||t).palette[s.color].main},s.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},s.variant==="outlined"&&s.color!=="inherit"&&{color:(t.vars||t).palette[s.color].main,border:t.vars?`1px solid rgba(${t.vars.palette[s.color].mainChannel} / 0.5)`:`1px solid ${ko(t.palette[s.color].main,.5)}`},s.variant==="contained"&&{color:t.vars?t.vars.palette.text.primary:(a=(l=t.palette).getContrastText)==null?void 0:a.call(l,t.palette.grey[300]),backgroundColor:t.vars?t.vars.palette.Button.inheritContainedBg:n,boxShadow:(t.vars||t).shadows[2]},s.variant==="contained"&&s.color!=="inherit"&&{color:(t.vars||t).palette[s.color].contrastText,backgroundColor:(t.vars||t).palette[s.color].main},s.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},s.size==="small"&&s.variant==="text"&&{padding:"4px 5px",fontSize:t.typography.pxToRem(13)},s.size==="large"&&s.variant==="text"&&{padding:"8px 11px",fontSize:t.typography.pxToRem(15)},s.size==="small"&&s.variant==="outlined"&&{padding:"3px 9px",fontSize:t.typography.pxToRem(13)},s.size==="large"&&s.variant==="outlined"&&{padding:"7px 21px",fontSize:t.typography.pxToRem(15)},s.size==="small"&&s.variant==="contained"&&{padding:"4px 10px",fontSize:t.typography.pxToRem(13)},s.size==="large"&&s.variant==="contained"&&{padding:"8px 22px",fontSize:t.typography.pxToRem(15)},s.fullWidth&&{width:"100%"})},({ownerState:t})=>t.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${$p.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${$p.disabled}`]:{boxShadow:"none"}}),o$=ln("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(t,s)=>{const{ownerState:a}=t;return[s.startIcon,s[`iconSize${Ns(a.size)}`]]}})(({ownerState:t})=>st({display:"inherit",marginRight:8,marginLeft:-4},t.size==="small"&&{marginLeft:-2},sA(t))),d$=ln("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(t,s)=>{const{ownerState:a}=t;return[s.endIcon,s[`iconSize${Ns(a.size)}`]]}})(({ownerState:t})=>st({display:"inherit",marginRight:-4,marginLeft:8},t.size==="small"&&{marginRight:-2},sA(t))),F1=d.forwardRef(function(s,a){const l=d.useContext(a$),n=d.useContext(l$),r=Q0(l,s),i=di({props:r,name:"MuiButton"}),{children:o,color:c="primary",component:x="button",className:j,disabled:g=!1,disableElevation:y=!1,disableFocusRipple:$=!1,endIcon:T,focusVisibleClassName:C,fullWidth:W=!1,size:L="medium",startIcon:R,type:F,variant:te="text"}=i,oe=wa(i,n$),G=st({},i,{color:c,component:x,disabled:g,disableElevation:y,disableFocusRipple:$,fullWidth:W,size:L,type:F,variant:te}),H=r$(G),Y=R&&e.jsx(o$,{className:H.startIcon,ownerState:G,children:R}),we=T&&e.jsx(d$,{className:H.endIcon,ownerState:G,children:T}),q=n||"";return e.jsxs(i$,st({ownerState:G,className:Ha(l.className,H.root,j,q),component:x,disabled:g,focusRipple:!$,focusVisibleClassName:Ha(H.focusVisible,C),ref:a,type:F},oe,{classes:H,children:[Y,o,we]}))}),c$=(t,s)=>st({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},s&&!t.vars&&{colorScheme:t.palette.mode}),u$=t=>st({color:(t.vars||t).palette.text.primary},t.typography.body1,{backgroundColor:(t.vars||t).palette.background.default,"@media print":{backgroundColor:(t.vars||t).palette.common.white}}),m$=(t,s=!1)=>{var a;const l={};s&&t.colorSchemes&&Object.entries(t.colorSchemes).forEach(([i,o])=>{var c;l[t.getColorSchemeSelector(i).replace(/\s*&/,"")]={colorScheme:(c=o.palette)==null?void 0:c.mode}});let n=st({html:c$(t,s),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:t.typography.fontWeightBold},body:st({margin:0},u$(t),{"&::backdrop":{backgroundColor:(t.vars||t).palette.background.default}})},l);const r=(a=t.components)==null||(a=a.MuiCssBaseline)==null?void 0:a.styleOverrides;return r&&(n=[n,r]),n};function x$(t){const s=di({props:t,name:"MuiCssBaseline"}),{children:a,enableColorScheme:l=!1}=s;return e.jsxs(d.Fragment,{children:[e.jsx(t$,{styles:n=>m$(n,l)}),a]})}const is={HOME:"/",SIGNIN:"/signin",AUTH:{LOGIN:"/auth/login",MFA:"/auth/mfa",INVITE:"/auth/invite",INVITE_TOKEN:"/auth/invite/:token"},CONSOLE:{ROOT:"/console",DASHBOARD:"/console/dashboard"},PAGES_PREVIEW:"/pages/:id"},VN=d.createContext({});function _N(t){const s=d.useRef(null);return s.current===null&&(s.current=t()),s.current}const jf=d.createContext(null),BN=d.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class p$ extends d.Component{getSnapshotBeforeUpdate(s){const a=this.props.childRef.current;if(a&&s.isPresent&&!this.props.isPresent){const l=this.props.sizeRef.current;l.height=a.offsetHeight||0,l.width=a.offsetWidth||0,l.top=a.offsetTop,l.left=a.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function h$({children:t,isPresent:s}){const a=d.useId(),l=d.useRef(null),n=d.useRef({width:0,height:0,top:0,left:0}),{nonce:r}=d.useContext(BN);return d.useInsertionEffect(()=>{const{width:i,height:o,top:c,left:x}=n.current;if(s||!l.current||!i||!o)return;l.current.dataset.motionPopId=a;const j=document.createElement("style");return r&&(j.nonce=r),document.head.appendChild(j),j.sheet&&j.sheet.insertRule(`
          [data-motion-pop-id="${a}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${o}px !important;
            top: ${c}px !important;
            left: ${x}px !important;
          }
        `),()=>{document.head.removeChild(j)}},[s]),e.jsx(p$,{isPresent:s,childRef:l,sizeRef:n,children:d.cloneElement(t,{ref:l})})}const g$=({children:t,initial:s,isPresent:a,onExitComplete:l,custom:n,presenceAffectsLayout:r,mode:i})=>{const o=_N(f$),c=d.useId(),x=d.useCallback(g=>{o.set(g,!0);for(const y of o.values())if(!y)return;l&&l()},[o,l]),j=d.useMemo(()=>({id:c,initial:s,isPresent:a,custom:n,onExitComplete:x,register:g=>(o.set(g,!1),()=>o.delete(g))}),r?[Math.random(),x]:[a,x]);return d.useMemo(()=>{o.forEach((g,y)=>o.set(y,!1))},[a]),d.useEffect(()=>{!a&&!o.size&&l&&l()},[a]),i==="popLayout"&&(t=e.jsx(h$,{isPresent:a,children:t})),e.jsx(jf.Provider,{value:j,children:t})};function f$(){return new Map}function aA(t=!0){const s=d.useContext(jf);if(s===null)return[!0,null];const{isPresent:a,onExitComplete:l,register:n}=s,r=d.useId();d.useEffect(()=>{t&&n(r)},[t]);const i=d.useCallback(()=>t&&l&&l(r),[r,l,t]);return!a&&l?[!1,i]:[!0]}const Lp=t=>t.key||"";function U1(t){const s=[];return d.Children.forEach(t,a=>{d.isValidElement(a)&&s.push(a)}),s}const GN=typeof window<"u",lA=GN?d.useLayoutEffect:d.useEffect,lt=({children:t,custom:s,initial:a=!0,onExitComplete:l,presenceAffectsLayout:n=!0,mode:r="sync",propagate:i=!1})=>{const[o,c]=aA(i),x=d.useMemo(()=>U1(t),[t]),j=i&&!o?[]:x.map(Lp),g=d.useRef(!0),y=d.useRef(x),$=_N(()=>new Map),[T,C]=d.useState(x),[W,L]=d.useState(x);lA(()=>{g.current=!1,y.current=x;for(let te=0;te<W.length;te++){const oe=Lp(W[te]);j.includes(oe)?$.delete(oe):$.get(oe)!==!0&&$.set(oe,!1)}},[W,j.length,j.join("-")]);const R=[];if(x!==T){let te=[...x];for(let oe=0;oe<W.length;oe++){const G=W[oe],H=Lp(G);j.includes(H)||(te.splice(oe,0,G),R.push(G))}r==="wait"&&R.length&&(te=R),L(U1(te)),C(x);return}const{forceRender:F}=d.useContext(VN);return e.jsx(e.Fragment,{children:W.map(te=>{const oe=Lp(te),G=i&&!o?!1:x===W||j.includes(oe),H=()=>{if($.has(oe))$.set(oe,!0);else return;let Y=!0;$.forEach(we=>{we||(Y=!1)}),Y&&(F==null||F(),L(y.current),i&&(c==null||c()),l&&l())};return e.jsx(g$,{isPresent:G,initial:!g.current||a?void 0:!1,custom:G?void 0:s,presenceAffectsLayout:n,mode:r,onExitComplete:G?void 0:H,children:te},oe)})})},Rn=t=>t;let nA=Rn;function qN(t){let s;return()=>(s===void 0&&(s=t()),s)}const wu=(t,s,a)=>{const l=s-t;return l===0?1:(a-t)/l},Ei=t=>t*1e3,Mi=t=>t/1e3,v$={useManualTiming:!1};function b$(t){let s=new Set,a=new Set,l=!1,n=!1;const r=new WeakSet;let i={delta:0,timestamp:0,isProcessing:!1};function o(x){r.has(x)&&(c.schedule(x),t()),x(i)}const c={schedule:(x,j=!1,g=!1)=>{const $=g&&l?s:a;return j&&r.add(x),$.has(x)||$.add(x),x},cancel:x=>{a.delete(x),r.delete(x)},process:x=>{if(i=x,l){n=!0;return}l=!0,[s,a]=[a,s],s.forEach(o),s.clear(),l=!1,n&&(n=!1,c.process(x))}};return c}const Fp=["read","resolveKeyframes","update","preRender","render","postRender"],j$=40;function rA(t,s){let a=!1,l=!0;const n={delta:0,timestamp:0,isProcessing:!1},r=()=>a=!0,i=Fp.reduce((L,R)=>(L[R]=b$(r),L),{}),{read:o,resolveKeyframes:c,update:x,preRender:j,render:g,postRender:y}=i,$=()=>{const L=performance.now();a=!1,n.delta=l?1e3/60:Math.max(Math.min(L-n.timestamp,j$),1),n.timestamp=L,n.isProcessing=!0,o.process(n),c.process(n),x.process(n),j.process(n),g.process(n),y.process(n),n.isProcessing=!1,a&&s&&(l=!1,t($))},T=()=>{a=!0,l=!0,n.isProcessing||t($)};return{schedule:Fp.reduce((L,R)=>{const F=i[R];return L[R]=(te,oe=!1,G=!1)=>(a||T(),F.schedule(te,oe,G)),L},{}),cancel:L=>{for(let R=0;R<Fp.length;R++)i[Fp[R]].cancel(L)},state:n,steps:i}}const{schedule:Qs,cancel:Bo,state:jl,steps:ov}=rA(typeof requestAnimationFrame<"u"?requestAnimationFrame:Rn,!0),iA=d.createContext({strict:!1}),V1={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},ku={};for(const t in V1)ku[t]={isEnabled:s=>V1[t].some(a=>!!s[a])};function y$(t){for(const s in t)ku[s]={...ku[s],...t[s]}}const N$=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Z0(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||N$.has(t)}let oA=t=>!Z0(t);function w$(t){t&&(oA=s=>s.startsWith("on")?!Z0(s):t(s))}try{w$(require("@emotion/is-prop-valid").default)}catch{}function k$(t,s,a){const l={};for(const n in t)n==="values"&&typeof t.values=="object"||(oA(n)||a===!0&&Z0(n)||!s&&!Z0(n)||t.draggable&&n.startsWith("onDrag"))&&(l[n]=t[n]);return l}function C$(t){if(typeof Proxy>"u")return t;const s=new Map,a=(...l)=>t(...l);return new Proxy(a,{get:(l,n)=>n==="create"?t:(s.has(n)||s.set(n,t(n)),s.get(n))})}const yf=d.createContext({});function _x(t){return typeof t=="string"||Array.isArray(t)}function Nf(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const zN=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],WN=["initial",...zN];function wf(t){return Nf(t.animate)||WN.some(s=>_x(t[s]))}function dA(t){return!!(wf(t)||t.variants)}function S$(t,s){if(wf(t)){const{initial:a,animate:l}=t;return{initial:a===!1||_x(a)?a:void 0,animate:_x(l)?l:void 0}}return t.inherit!==!1?s:{}}function A$(t){const{initial:s,animate:a}=S$(t,d.useContext(yf));return d.useMemo(()=>({initial:s,animate:a}),[_1(s),_1(a)])}function _1(t){return Array.isArray(t)?t.join(" "):t}const E$=Symbol.for("motionComponentSymbol");function Qc(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function M$(t,s,a){return d.useCallback(l=>{l&&t.onMount&&t.onMount(l),s&&(l?s.mount(l):s.unmount()),a&&(typeof a=="function"?a(l):Qc(a)&&(a.current=l))},[s])}const HN=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),P$="framerAppearId",cA="data-"+HN(P$),{schedule:XN}=rA(queueMicrotask,!1),uA=d.createContext({});function O$(t,s,a,l,n){var r,i;const{visualElement:o}=d.useContext(yf),c=d.useContext(iA),x=d.useContext(jf),j=d.useContext(BN).reducedMotion,g=d.useRef(null);l=l||c.renderer,!g.current&&l&&(g.current=l(t,{visualState:s,parent:o,props:a,presenceContext:x,blockInitialAnimation:x?x.initial===!1:!1,reducedMotionConfig:j}));const y=g.current,$=d.useContext(uA);y&&!y.projection&&n&&(y.type==="html"||y.type==="svg")&&T$(g.current,a,n,$);const T=d.useRef(!1);d.useInsertionEffect(()=>{y&&T.current&&y.update(a,x)});const C=a[cA],W=d.useRef(!!C&&!(!((r=window.MotionHandoffIsComplete)===null||r===void 0)&&r.call(window,C))&&((i=window.MotionHasOptimisedAnimation)===null||i===void 0?void 0:i.call(window,C)));return lA(()=>{y&&(T.current=!0,window.MotionIsMounted=!0,y.updateFeatures(),XN.render(y.render),W.current&&y.animationState&&y.animationState.animateChanges())}),d.useEffect(()=>{y&&(!W.current&&y.animationState&&y.animationState.animateChanges(),W.current&&(queueMicrotask(()=>{var L;(L=window.MotionHandoffMarkAsComplete)===null||L===void 0||L.call(window,C)}),W.current=!1))}),y}function T$(t,s,a,l){const{layoutId:n,layout:r,drag:i,dragConstraints:o,layoutScroll:c,layoutRoot:x}=s;t.projection=new a(t.latestValues,s["data-framer-portal-id"]?void 0:mA(t.parent)),t.projection.setOptions({layoutId:n,layout:r,alwaysMeasureLayout:!!i||o&&Qc(o),visualElement:t,animationType:typeof r=="string"?r:"both",initialPromotionConfig:l,layoutScroll:c,layoutRoot:x})}function mA(t){if(t)return t.options.allowProjection!==!1?t.projection:mA(t.parent)}function R$({preloadedFeatures:t,createVisualElement:s,useRender:a,useVisualState:l,Component:n}){var r,i;t&&y$(t);function o(x,j){let g;const y={...d.useContext(BN),...x,layoutId:D$(x)},{isStatic:$}=y,T=A$(x),C=l(x,$);if(!$&&GN){I$();const W=$$(y);g=W.MeasureLayout,T.visualElement=O$(n,C,y,s,W.ProjectionNode)}return e.jsxs(yf.Provider,{value:T,children:[g&&T.visualElement?e.jsx(g,{visualElement:T.visualElement,...y}):null,a(n,x,M$(C,T.visualElement,j),C,$,T.visualElement)]})}o.displayName=`motion.${typeof n=="string"?n:`create(${(i=(r=n.displayName)!==null&&r!==void 0?r:n.name)!==null&&i!==void 0?i:""})`}`;const c=d.forwardRef(o);return c[E$]=n,c}function D$({layoutId:t}){const s=d.useContext(VN).id;return s&&t!==void 0?s+"-"+t:t}function I$(t,s){d.useContext(iA).strict}function $$(t){const{drag:s,layout:a}=ku;if(!s&&!a)return{};const l={...s,...a};return{MeasureLayout:s!=null&&s.isEnabled(t)||a!=null&&a.isEnabled(t)?l.MeasureLayout:void 0,ProjectionNode:l.ProjectionNode}}const L$=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function KN(t){return typeof t!="string"||t.includes("-")?!1:!!(L$.indexOf(t)>-1||/[A-Z]/u.test(t))}function B1(t){const s=[{},{}];return t==null||t.values.forEach((a,l)=>{s[0][l]=a.get(),s[1][l]=a.getVelocity()}),s}function QN(t,s,a,l){if(typeof s=="function"){const[n,r]=B1(l);s=s(a!==void 0?a:t.custom,n,r)}if(typeof s=="string"&&(s=t.variants&&t.variants[s]),typeof s=="function"){const[n,r]=B1(l);s=s(a!==void 0?a:t.custom,n,r)}return s}const _j=t=>Array.isArray(t),F$=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),U$=t=>_j(t)?t[t.length-1]||0:t,Ll=t=>!!(t&&t.getVelocity);function m0(t){const s=Ll(t)?t.get():t;return F$(s)?s.toValue():s}function V$({scrapeMotionValuesFromProps:t,createRenderState:s,onUpdate:a},l,n,r){const i={latestValues:_$(l,n,r,t),renderState:s()};return a&&(i.onMount=o=>a({props:l,current:o,...i}),i.onUpdate=o=>a(o)),i}const xA=t=>(s,a)=>{const l=d.useContext(yf),n=d.useContext(jf),r=()=>V$(t,s,l,n);return a?r():_N(r)};function _$(t,s,a,l){const n={},r=l(t,{});for(const y in r)n[y]=m0(r[y]);let{initial:i,animate:o}=t;const c=wf(t),x=dA(t);s&&x&&!c&&t.inherit!==!1&&(i===void 0&&(i=s.initial),o===void 0&&(o=s.animate));let j=a?a.initial===!1:!1;j=j||i===!1;const g=j?o:i;if(g&&typeof g!="boolean"&&!Nf(g)){const y=Array.isArray(g)?g:[g];for(let $=0;$<y.length;$++){const T=QN(t,y[$]);if(T){const{transitionEnd:C,transition:W,...L}=T;for(const R in L){let F=L[R];if(Array.isArray(F)){const te=j?F.length-1:0;F=F[te]}F!==null&&(n[R]=F)}for(const R in C)n[R]=C[R]}}}return n}const $u=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Qd=new Set($u),pA=t=>s=>typeof s=="string"&&s.startsWith(t),hA=pA("--"),B$=pA("var(--"),YN=t=>B$(t)?G$.test(t.split("/*")[0].trim()):!1,G$=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,gA=(t,s)=>s&&typeof t=="number"?s.transform(t):t,Ii=(t,s,a)=>a>s?s:a<t?t:a,Lu={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Bx={...Lu,transform:t=>Ii(0,1,t)},Up={...Lu,default:1},up=t=>({test:s=>typeof s=="string"&&s.endsWith(t)&&s.split(" ").length===1,parse:parseFloat,transform:s=>`${s}${t}`}),xo=up("deg"),ai=up("%"),Pt=up("px"),q$=up("vh"),z$=up("vw"),G1={...ai,parse:t=>ai.parse(t)/100,transform:t=>ai.transform(t*100)},W$={borderWidth:Pt,borderTopWidth:Pt,borderRightWidth:Pt,borderBottomWidth:Pt,borderLeftWidth:Pt,borderRadius:Pt,radius:Pt,borderTopLeftRadius:Pt,borderTopRightRadius:Pt,borderBottomRightRadius:Pt,borderBottomLeftRadius:Pt,width:Pt,maxWidth:Pt,height:Pt,maxHeight:Pt,top:Pt,right:Pt,bottom:Pt,left:Pt,padding:Pt,paddingTop:Pt,paddingRight:Pt,paddingBottom:Pt,paddingLeft:Pt,margin:Pt,marginTop:Pt,marginRight:Pt,marginBottom:Pt,marginLeft:Pt,backgroundPositionX:Pt,backgroundPositionY:Pt},H$={rotate:xo,rotateX:xo,rotateY:xo,rotateZ:xo,scale:Up,scaleX:Up,scaleY:Up,scaleZ:Up,skew:xo,skewX:xo,skewY:xo,distance:Pt,translateX:Pt,translateY:Pt,translateZ:Pt,x:Pt,y:Pt,z:Pt,perspective:Pt,transformPerspective:Pt,opacity:Bx,originX:G1,originY:G1,originZ:Pt},q1={...Lu,transform:Math.round},JN={...W$,...H$,zIndex:q1,size:Pt,fillOpacity:Bx,strokeOpacity:Bx,numOctaves:q1},X$={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},K$=$u.length;function Q$(t,s,a){let l="",n=!0;for(let r=0;r<K$;r++){const i=$u[r],o=t[i];if(o===void 0)continue;let c=!0;if(typeof o=="number"?c=o===(i.startsWith("scale")?1:0):c=parseFloat(o)===0,!c||a){const x=gA(o,JN[i]);if(!c){n=!1;const j=X$[i]||i;l+=`${j}(${x}) `}a&&(s[i]=x)}}return l=l.trim(),a?l=a(s,n?"":l):n&&(l="none"),l}function ZN(t,s,a){const{style:l,vars:n,transformOrigin:r}=t;let i=!1,o=!1;for(const c in s){const x=s[c];if(Qd.has(c)){i=!0;continue}else if(hA(c)){n[c]=x;continue}else{const j=gA(x,JN[c]);c.startsWith("origin")?(o=!0,r[c]=j):l[c]=j}}if(s.transform||(i||a?l.transform=Q$(s,t.transform,a):l.transform&&(l.transform="none")),o){const{originX:c="50%",originY:x="50%",originZ:j=0}=r;l.transformOrigin=`${c} ${x} ${j}`}}const Y$={offset:"stroke-dashoffset",array:"stroke-dasharray"},J$={offset:"strokeDashoffset",array:"strokeDasharray"};function Z$(t,s,a=1,l=0,n=!0){t.pathLength=1;const r=n?Y$:J$;t[r.offset]=Pt.transform(-l);const i=Pt.transform(s),o=Pt.transform(a);t[r.array]=`${i} ${o}`}function z1(t,s,a){return typeof t=="string"?t:Pt.transform(s+a*t)}function e7(t,s,a){const l=z1(s,t.x,t.width),n=z1(a,t.y,t.height);return`${l} ${n}`}function ew(t,{attrX:s,attrY:a,attrScale:l,originX:n,originY:r,pathLength:i,pathSpacing:o=1,pathOffset:c=0,...x},j,g){if(ZN(t,x,g),j){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:y,style:$,dimensions:T}=t;y.transform&&(T&&($.transform=y.transform),delete y.transform),T&&(n!==void 0||r!==void 0||$.transform)&&($.transformOrigin=e7(T,n!==void 0?n:.5,r!==void 0?r:.5)),s!==void 0&&(y.x=s),a!==void 0&&(y.y=a),l!==void 0&&(y.scale=l),i!==void 0&&Z$(y,i,o,c,!1)}const tw=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),fA=()=>({...tw(),attrs:{}}),sw=t=>typeof t=="string"&&t.toLowerCase()==="svg";function vA(t,{style:s,vars:a},l,n){Object.assign(t.style,s,n&&n.getProjectionStyles(l));for(const r in a)t.style.setProperty(r,a[r])}const bA=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function jA(t,s,a,l){vA(t,s,void 0,l);for(const n in s.attrs)t.setAttribute(bA.has(n)?n:HN(n),s.attrs[n])}const eg={};function t7(t){Object.assign(eg,t)}function yA(t,{layout:s,layoutId:a}){return Qd.has(t)||t.startsWith("origin")||(s||a!==void 0)&&(!!eg[t]||t==="opacity")}function aw(t,s,a){var l;const{style:n}=t,r={};for(const i in n)(Ll(n[i])||s.style&&Ll(s.style[i])||yA(i,t)||((l=a==null?void 0:a.getValue(i))===null||l===void 0?void 0:l.liveStyle)!==void 0)&&(r[i]=n[i]);return r}function NA(t,s,a){const l=aw(t,s,a);for(const n in t)if(Ll(t[n])||Ll(s[n])){const r=$u.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;l[r]=t[n]}return l}function s7(t,s){try{s.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{s.dimensions={x:0,y:0,width:0,height:0}}}const W1=["x","y","width","height","cx","cy","r"],a7={useVisualState:xA({scrapeMotionValuesFromProps:NA,createRenderState:fA,onUpdate:({props:t,prevProps:s,current:a,renderState:l,latestValues:n})=>{if(!a)return;let r=!!t.drag;if(!r){for(const o in n)if(Qd.has(o)){r=!0;break}}if(!r)return;let i=!s;if(s)for(let o=0;o<W1.length;o++){const c=W1[o];t[c]!==s[c]&&(i=!0)}i&&Qs.read(()=>{s7(a,l),Qs.render(()=>{ew(l,n,sw(a.tagName),t.transformTemplate),jA(a,l)})})}})},l7={useVisualState:xA({scrapeMotionValuesFromProps:aw,createRenderState:tw})};function wA(t,s,a){for(const l in s)!Ll(s[l])&&!yA(l,a)&&(t[l]=s[l])}function n7({transformTemplate:t},s){return d.useMemo(()=>{const a=tw();return ZN(a,s,t),Object.assign({},a.vars,a.style)},[s])}function r7(t,s){const a=t.style||{},l={};return wA(l,a,t),Object.assign(l,n7(t,s)),l}function i7(t,s){const a={},l=r7(t,s);return t.drag&&t.dragListener!==!1&&(a.draggable=!1,l.userSelect=l.WebkitUserSelect=l.WebkitTouchCallout="none",l.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(a.tabIndex=0),a.style=l,a}function o7(t,s,a,l){const n=d.useMemo(()=>{const r=fA();return ew(r,s,sw(l),t.transformTemplate),{...r.attrs,style:{...r.style}}},[s]);if(t.style){const r={};wA(r,t.style,t),n.style={...r,...n.style}}return n}function d7(t=!1){return(a,l,n,{latestValues:r},i)=>{const c=(KN(a)?o7:i7)(l,r,i,a),x=k$(l,typeof a=="string",t),j=a!==d.Fragment?{...x,...c,ref:n}:{},{children:g}=l,y=d.useMemo(()=>Ll(g)?g.get():g,[g]);return d.createElement(a,{...j,children:y})}}function c7(t,s){return function(l,{forwardMotionProps:n}={forwardMotionProps:!1}){const i={...KN(l)?a7:l7,preloadedFeatures:t,useRender:d7(n),createVisualElement:s,Component:l};return R$(i)}}function kA(t,s){if(!Array.isArray(s))return!1;const a=s.length;if(a!==t.length)return!1;for(let l=0;l<a;l++)if(s[l]!==t[l])return!1;return!0}function kf(t,s,a){const l=t.getProps();return QN(l,s,a!==void 0?a:l.custom,t)}const u7=qN(()=>window.ScrollTimeline!==void 0);class m7{constructor(s){this.stop=()=>this.runAll("stop"),this.animations=s.filter(Boolean)}get finished(){return Promise.all(this.animations.map(s=>"finished"in s?s.finished:s))}getAll(s){return this.animations[0][s]}setAll(s,a){for(let l=0;l<this.animations.length;l++)this.animations[l][s]=a}attachTimeline(s,a){const l=this.animations.map(n=>{if(u7()&&n.attachTimeline)return n.attachTimeline(s);if(typeof a=="function")return a(n)});return()=>{l.forEach((n,r)=>{n&&n(),this.animations[r].stop()})}}get time(){return this.getAll("time")}set time(s){this.setAll("time",s)}get speed(){return this.getAll("speed")}set speed(s){this.setAll("speed",s)}get startTime(){return this.getAll("startTime")}get duration(){let s=0;for(let a=0;a<this.animations.length;a++)s=Math.max(s,this.animations[a].duration);return s}runAll(s){this.animations.forEach(a=>a[s]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class x7 extends m7{then(s,a){return Promise.all(this.animations).then(s).catch(a)}}function lw(t,s){return t?t[s]||t.default||t:void 0}const Bj=2e4;function CA(t){let s=0;const a=50;let l=t.next(s);for(;!l.done&&s<Bj;)s+=a,l=t.next(s);return s>=Bj?1/0:s}function nw(t){return typeof t=="function"}function H1(t,s){t.timeline=s,t.onfinish=null}const rw=t=>Array.isArray(t)&&typeof t[0]=="number",p7={linearEasing:void 0};function h7(t,s){const a=qN(t);return()=>{var l;return(l=p7[s])!==null&&l!==void 0?l:a()}}const tg=h7(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),SA=(t,s,a=10)=>{let l="";const n=Math.max(Math.round(s/a),2);for(let r=0;r<n;r++)l+=t(wu(0,n-1,r))+", ";return`linear(${l.substring(0,l.length-2)})`};function AA(t){return!!(typeof t=="function"&&tg()||!t||typeof t=="string"&&(t in Gj||tg())||rw(t)||Array.isArray(t)&&t.every(AA))}const Gm=([t,s,a,l])=>`cubic-bezier(${t}, ${s}, ${a}, ${l})`,Gj={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Gm([0,.65,.55,1]),circOut:Gm([.55,0,1,.45]),backIn:Gm([.31,.01,.66,-.59]),backOut:Gm([.33,1.53,.69,.99])};function EA(t,s){if(t)return typeof t=="function"&&tg()?SA(t,s):rw(t)?Gm(t):Array.isArray(t)?t.map(a=>EA(a,s)||Gj.easeOut):Gj[t]}const gr={x:!1,y:!1};function MA(){return gr.x||gr.y}function g7(t,s,a){var l;if(t instanceof Element)return[t];if(typeof t=="string"){let n=document;const r=(l=void 0)!==null&&l!==void 0?l:n.querySelectorAll(t);return r?Array.from(r):[]}return Array.from(t)}function PA(t,s){const a=g7(t),l=new AbortController,n={passive:!0,...s,signal:l.signal};return[a,n,()=>l.abort()]}function X1(t){return s=>{s.pointerType==="touch"||MA()||t(s)}}function f7(t,s,a={}){const[l,n,r]=PA(t,a),i=X1(o=>{const{target:c}=o,x=s(o);if(typeof x!="function"||!c)return;const j=X1(g=>{x(g),c.removeEventListener("pointerleave",j)});c.addEventListener("pointerleave",j,n)});return l.forEach(o=>{o.addEventListener("pointerenter",i,n)}),r}const OA=(t,s)=>s?t===s?!0:OA(t,s.parentElement):!1,iw=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,v7=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function b7(t){return v7.has(t.tagName)||t.tabIndex!==-1}const qm=new WeakSet;function K1(t){return s=>{s.key==="Enter"&&t(s)}}function dv(t,s){t.dispatchEvent(new PointerEvent("pointer"+s,{isPrimary:!0,bubbles:!0}))}const j7=(t,s)=>{const a=t.currentTarget;if(!a)return;const l=K1(()=>{if(qm.has(a))return;dv(a,"down");const n=K1(()=>{dv(a,"up")}),r=()=>dv(a,"cancel");a.addEventListener("keyup",n,s),a.addEventListener("blur",r,s)});a.addEventListener("keydown",l,s),a.addEventListener("blur",()=>a.removeEventListener("keydown",l),s)};function Q1(t){return iw(t)&&!MA()}function y7(t,s,a={}){const[l,n,r]=PA(t,a),i=o=>{const c=o.currentTarget;if(!Q1(o)||qm.has(c))return;qm.add(c);const x=s(o),j=($,T)=>{window.removeEventListener("pointerup",g),window.removeEventListener("pointercancel",y),!(!Q1($)||!qm.has(c))&&(qm.delete(c),typeof x=="function"&&x($,{success:T}))},g=$=>{j($,a.useGlobalTarget||OA(c,$.target))},y=$=>{j($,!1)};window.addEventListener("pointerup",g,n),window.addEventListener("pointercancel",y,n)};return l.forEach(o=>{!b7(o)&&o.getAttribute("tabindex")===null&&(o.tabIndex=0),(a.useGlobalTarget?window:o).addEventListener("pointerdown",i,n),o.addEventListener("focus",x=>j7(x,n),n)}),r}function N7(t){return t==="x"||t==="y"?gr[t]?null:(gr[t]=!0,()=>{gr[t]=!1}):gr.x||gr.y?null:(gr.x=gr.y=!0,()=>{gr.x=gr.y=!1})}const TA=new Set(["width","height","top","left","right","bottom",...$u]);let x0;function w7(){x0=void 0}const li={now:()=>(x0===void 0&&li.set(jl.isProcessing||v$.useManualTiming?jl.timestamp:performance.now()),x0),set:t=>{x0=t,queueMicrotask(w7)}};function ow(t,s){t.indexOf(s)===-1&&t.push(s)}function dw(t,s){const a=t.indexOf(s);a>-1&&t.splice(a,1)}class cw{constructor(){this.subscriptions=[]}add(s){return ow(this.subscriptions,s),()=>dw(this.subscriptions,s)}notify(s,a,l){const n=this.subscriptions.length;if(n)if(n===1)this.subscriptions[0](s,a,l);else for(let r=0;r<n;r++){const i=this.subscriptions[r];i&&i(s,a,l)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function RA(t,s){return s?t*(1e3/s):0}const Y1=30,k7=t=>!isNaN(parseFloat(t));class C7{constructor(s,a={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(l,n=!0)=>{const r=li.now();this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(l),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),n&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(s),this.owner=a.owner}setCurrent(s){this.current=s,this.updatedAt=li.now(),this.canTrackVelocity===null&&s!==void 0&&(this.canTrackVelocity=k7(this.current))}setPrevFrameValue(s=this.current){this.prevFrameValue=s,this.prevUpdatedAt=this.updatedAt}onChange(s){return this.on("change",s)}on(s,a){this.events[s]||(this.events[s]=new cw);const l=this.events[s].add(a);return s==="change"?()=>{l(),Qs.read(()=>{this.events.change.getSize()||this.stop()})}:l}clearListeners(){for(const s in this.events)this.events[s].clear()}attach(s,a){this.passiveEffect=s,this.stopPassiveEffect=a}set(s,a=!0){!a||!this.passiveEffect?this.updateAndNotify(s,a):this.passiveEffect(s,this.updateAndNotify)}setWithVelocity(s,a,l){this.set(a),this.prev=void 0,this.prevFrameValue=s,this.prevUpdatedAt=this.updatedAt-l}jump(s,a=!0){this.updateAndNotify(s),this.prev=s,this.prevUpdatedAt=this.prevFrameValue=void 0,a&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const s=li.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||s-this.updatedAt>Y1)return 0;const a=Math.min(this.updatedAt-this.prevUpdatedAt,Y1);return RA(parseFloat(this.current)-parseFloat(this.prevFrameValue),a)}start(s){return this.stop(),new Promise(a=>{this.hasAnimated=!0,this.animation=s(a),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Gx(t,s){return new C7(t,s)}function S7(t,s,a){t.hasValue(s)?t.getValue(s).set(a):t.addValue(s,Gx(a))}function A7(t,s){const a=kf(t,s);let{transitionEnd:l={},transition:n={},...r}=a||{};r={...r,...l};for(const i in r){const o=U$(r[i]);S7(t,i,o)}}function E7(t){return!!(Ll(t)&&t.add)}function qj(t,s){const a=t.getValue("willChange");if(E7(a))return a.add(s)}function DA(t){return t.props[cA]}const IA=(t,s,a)=>(((1-3*a+3*s)*t+(3*a-6*s))*t+3*s)*t,M7=1e-7,P7=12;function O7(t,s,a,l,n){let r,i,o=0;do i=s+(a-s)/2,r=IA(i,l,n)-t,r>0?a=i:s=i;while(Math.abs(r)>M7&&++o<P7);return i}function mp(t,s,a,l){if(t===s&&a===l)return Rn;const n=r=>O7(r,0,1,t,a);return r=>r===0||r===1?r:IA(n(r),s,l)}const $A=t=>s=>s<=.5?t(2*s)/2:(2-t(2*(1-s)))/2,LA=t=>s=>1-t(1-s),FA=mp(.33,1.53,.69,.99),uw=LA(FA),UA=$A(uw),VA=t=>(t*=2)<1?.5*uw(t):.5*(2-Math.pow(2,-10*(t-1))),mw=t=>1-Math.sin(Math.acos(t)),_A=LA(mw),BA=$A(mw),GA=t=>/^0[^.\s]+$/u.test(t);function T7(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||GA(t):!0}const lx=t=>Math.round(t*1e5)/1e5,xw=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function R7(t){return t==null}const D7=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,pw=(t,s)=>a=>!!(typeof a=="string"&&D7.test(a)&&a.startsWith(t)||s&&!R7(a)&&Object.prototype.hasOwnProperty.call(a,s)),qA=(t,s,a)=>l=>{if(typeof l!="string")return l;const[n,r,i,o]=l.match(xw);return{[t]:parseFloat(n),[s]:parseFloat(r),[a]:parseFloat(i),alpha:o!==void 0?parseFloat(o):1}},I7=t=>Ii(0,255,t),cv={...Lu,transform:t=>Math.round(I7(t))},Rd={test:pw("rgb","red"),parse:qA("red","green","blue"),transform:({red:t,green:s,blue:a,alpha:l=1})=>"rgba("+cv.transform(t)+", "+cv.transform(s)+", "+cv.transform(a)+", "+lx(Bx.transform(l))+")"};function $7(t){let s="",a="",l="",n="";return t.length>5?(s=t.substring(1,3),a=t.substring(3,5),l=t.substring(5,7),n=t.substring(7,9)):(s=t.substring(1,2),a=t.substring(2,3),l=t.substring(3,4),n=t.substring(4,5),s+=s,a+=a,l+=l,n+=n),{red:parseInt(s,16),green:parseInt(a,16),blue:parseInt(l,16),alpha:n?parseInt(n,16)/255:1}}const zj={test:pw("#"),parse:$7,transform:Rd.transform},Yc={test:pw("hsl","hue"),parse:qA("hue","saturation","lightness"),transform:({hue:t,saturation:s,lightness:a,alpha:l=1})=>"hsla("+Math.round(t)+", "+ai.transform(lx(s))+", "+ai.transform(lx(a))+", "+lx(Bx.transform(l))+")"},Dl={test:t=>Rd.test(t)||zj.test(t)||Yc.test(t),parse:t=>Rd.test(t)?Rd.parse(t):Yc.test(t)?Yc.parse(t):zj.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Rd.transform(t):Yc.transform(t)},L7=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function F7(t){var s,a;return isNaN(t)&&typeof t=="string"&&(((s=t.match(xw))===null||s===void 0?void 0:s.length)||0)+(((a=t.match(L7))===null||a===void 0?void 0:a.length)||0)>0}const zA="number",WA="color",U7="var",V7="var(",J1="${}",_7=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function qx(t){const s=t.toString(),a=[],l={color:[],number:[],var:[]},n=[];let r=0;const o=s.replace(_7,c=>(Dl.test(c)?(l.color.push(r),n.push(WA),a.push(Dl.parse(c))):c.startsWith(V7)?(l.var.push(r),n.push(U7),a.push(c)):(l.number.push(r),n.push(zA),a.push(parseFloat(c))),++r,J1)).split(J1);return{values:a,split:o,indexes:l,types:n}}function HA(t){return qx(t).values}function XA(t){const{split:s,types:a}=qx(t),l=s.length;return n=>{let r="";for(let i=0;i<l;i++)if(r+=s[i],n[i]!==void 0){const o=a[i];o===zA?r+=lx(n[i]):o===WA?r+=Dl.transform(n[i]):r+=n[i]}return r}}const B7=t=>typeof t=="number"?0:t;function G7(t){const s=HA(t);return XA(t)(s.map(B7))}const Go={test:F7,parse:HA,createTransformer:XA,getAnimatableNone:G7},q7=new Set(["brightness","contrast","saturate","opacity"]);function z7(t){const[s,a]=t.slice(0,-1).split("(");if(s==="drop-shadow")return t;const[l]=a.match(xw)||[];if(!l)return t;const n=a.replace(l,"");let r=q7.has(s)?1:0;return l!==a&&(r*=100),s+"("+r+n+")"}const W7=/\b([a-z-]*)\(.*?\)/gu,Wj={...Go,getAnimatableNone:t=>{const s=t.match(W7);return s?s.map(z7).join(" "):t}},H7={...JN,color:Dl,backgroundColor:Dl,outlineColor:Dl,fill:Dl,stroke:Dl,borderColor:Dl,borderTopColor:Dl,borderRightColor:Dl,borderBottomColor:Dl,borderLeftColor:Dl,filter:Wj,WebkitFilter:Wj},hw=t=>H7[t];function KA(t,s){let a=hw(t);return a!==Wj&&(a=Go),a.getAnimatableNone?a.getAnimatableNone(s):void 0}const X7=new Set(["auto","none","0"]);function K7(t,s,a){let l=0,n;for(;l<t.length&&!n;){const r=t[l];typeof r=="string"&&!X7.has(r)&&qx(r).values.length&&(n=t[l]),l++}if(n&&a)for(const r of s)t[r]=KA(a,n)}const Z1=t=>t===Lu||t===Pt,ek=(t,s)=>parseFloat(t.split(", ")[s]),tk=(t,s)=>(a,{transform:l})=>{if(l==="none"||!l)return 0;const n=l.match(/^matrix3d\((.+)\)$/u);if(n)return ek(n[1],s);{const r=l.match(/^matrix\((.+)\)$/u);return r?ek(r[1],t):0}},Q7=new Set(["x","y","z"]),Y7=$u.filter(t=>!Q7.has(t));function J7(t){const s=[];return Y7.forEach(a=>{const l=t.getValue(a);l!==void 0&&(s.push([a,l.get()]),l.set(a.startsWith("scale")?1:0))}),s}const Cu={width:({x:t},{paddingLeft:s="0",paddingRight:a="0"})=>t.max-t.min-parseFloat(s)-parseFloat(a),height:({y:t},{paddingTop:s="0",paddingBottom:a="0"})=>t.max-t.min-parseFloat(s)-parseFloat(a),top:(t,{top:s})=>parseFloat(s),left:(t,{left:s})=>parseFloat(s),bottom:({y:t},{top:s})=>parseFloat(s)+(t.max-t.min),right:({x:t},{left:s})=>parseFloat(s)+(t.max-t.min),x:tk(4,13),y:tk(5,14)};Cu.translateX=Cu.x;Cu.translateY=Cu.y;const Ld=new Set;let Hj=!1,Xj=!1;function QA(){if(Xj){const t=Array.from(Ld).filter(l=>l.needsMeasurement),s=new Set(t.map(l=>l.element)),a=new Map;s.forEach(l=>{const n=J7(l);n.length&&(a.set(l,n),l.render())}),t.forEach(l=>l.measureInitialState()),s.forEach(l=>{l.render();const n=a.get(l);n&&n.forEach(([r,i])=>{var o;(o=l.getValue(r))===null||o===void 0||o.set(i)})}),t.forEach(l=>l.measureEndState()),t.forEach(l=>{l.suspendedScrollY!==void 0&&window.scrollTo(0,l.suspendedScrollY)})}Xj=!1,Hj=!1,Ld.forEach(t=>t.complete()),Ld.clear()}function YA(){Ld.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Xj=!0)})}function Z7(){YA(),QA()}class gw{constructor(s,a,l,n,r,i=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...s],this.onComplete=a,this.name=l,this.motionValue=n,this.element=r,this.isAsync=i}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Ld.add(this),Hj||(Hj=!0,Qs.read(YA),Qs.resolveKeyframes(QA))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:s,name:a,element:l,motionValue:n}=this;for(let r=0;r<s.length;r++)if(s[r]===null)if(r===0){const i=n==null?void 0:n.get(),o=s[s.length-1];if(i!==void 0)s[0]=i;else if(l&&a){const c=l.readValue(a,o);c!=null&&(s[0]=c)}s[0]===void 0&&(s[0]=o),n&&i===void 0&&n.set(s[0])}else s[r]=s[r-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Ld.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Ld.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const JA=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),e8=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function t8(t){const s=e8.exec(t);if(!s)return[,];const[,a,l,n]=s;return[`--${a??l}`,n]}function ZA(t,s,a=1){const[l,n]=t8(t);if(!l)return;const r=window.getComputedStyle(s).getPropertyValue(l);if(r){const i=r.trim();return JA(i)?parseFloat(i):i}return YN(n)?ZA(n,s,a+1):n}const eE=t=>s=>s.test(t),s8={test:t=>t==="auto",parse:t=>t},tE=[Lu,Pt,ai,xo,z$,q$,s8],sk=t=>tE.find(eE(t));class sE extends gw{constructor(s,a,l,n,r){super(s,a,l,n,r,!0)}readKeyframes(){const{unresolvedKeyframes:s,element:a,name:l}=this;if(!a||!a.current)return;super.readKeyframes();for(let c=0;c<s.length;c++){let x=s[c];if(typeof x=="string"&&(x=x.trim(),YN(x))){const j=ZA(x,a.current);j!==void 0&&(s[c]=j),c===s.length-1&&(this.finalKeyframe=x)}}if(this.resolveNoneKeyframes(),!TA.has(l)||s.length!==2)return;const[n,r]=s,i=sk(n),o=sk(r);if(i!==o)if(Z1(i)&&Z1(o))for(let c=0;c<s.length;c++){const x=s[c];typeof x=="string"&&(s[c]=parseFloat(x))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:s,name:a}=this,l=[];for(let n=0;n<s.length;n++)T7(s[n])&&l.push(n);l.length&&K7(s,l,a)}measureInitialState(){const{element:s,unresolvedKeyframes:a,name:l}=this;if(!s||!s.current)return;l==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Cu[l](s.measureViewportBox(),window.getComputedStyle(s.current)),a[0]=this.measuredOrigin;const n=a[a.length-1];n!==void 0&&s.getValue(l,n).jump(n,!1)}measureEndState(){var s;const{element:a,name:l,unresolvedKeyframes:n}=this;if(!a||!a.current)return;const r=a.getValue(l);r&&r.jump(this.measuredOrigin,!1);const i=n.length-1,o=n[i];n[i]=Cu[l](a.measureViewportBox(),window.getComputedStyle(a.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),!((s=this.removedTransforms)===null||s===void 0)&&s.length&&this.removedTransforms.forEach(([c,x])=>{a.getValue(c).set(x)}),this.resolveNoneKeyframes()}}const ak=(t,s)=>s==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Go.test(t)||t==="0")&&!t.startsWith("url("));function a8(t){const s=t[0];if(t.length===1)return!0;for(let a=0;a<t.length;a++)if(t[a]!==s)return!0}function l8(t,s,a,l){const n=t[0];if(n===null)return!1;if(s==="display"||s==="visibility")return!0;const r=t[t.length-1],i=ak(n,s),o=ak(r,s);return!i||!o?!1:a8(t)||(a==="spring"||nw(a))&&l}const n8=t=>t!==null;function Cf(t,{repeat:s,repeatType:a="loop"},l){const n=t.filter(n8),r=s&&a!=="loop"&&s%2===1?0:n.length-1;return!r||l===void 0?n[r]:l}const r8=40;class aE{constructor({autoplay:s=!0,delay:a=0,type:l="keyframes",repeat:n=0,repeatDelay:r=0,repeatType:i="loop",...o}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=li.now(),this.options={autoplay:s,delay:a,type:l,repeat:n,repeatDelay:r,repeatType:i,...o},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>r8?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&Z7(),this._resolved}onKeyframesResolved(s,a){this.resolvedAt=li.now(),this.hasAttemptedResolve=!0;const{name:l,type:n,velocity:r,delay:i,onComplete:o,onUpdate:c,isGenerator:x}=this.options;if(!x&&!l8(s,l,n,r))if(i)this.options.duration=0;else{c&&c(Cf(s,this.options,a)),o&&o(),this.resolveFinishedPromise();return}const j=this.initPlayback(s,a);j!==!1&&(this._resolved={keyframes:s,finalKeyframe:a,...j},this.onPostResolved())}onPostResolved(){}then(s,a){return this.currentFinishedPromise.then(s,a)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(s=>{this.resolveFinishedPromise=s})}}const ua=(t,s,a)=>t+(s-t)*a;function uv(t,s,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?t+(s-t)*6*a:a<1/2?s:a<2/3?t+(s-t)*(2/3-a)*6:t}function i8({hue:t,saturation:s,lightness:a,alpha:l}){t/=360,s/=100,a/=100;let n=0,r=0,i=0;if(!s)n=r=i=a;else{const o=a<.5?a*(1+s):a+s-a*s,c=2*a-o;n=uv(c,o,t+1/3),r=uv(c,o,t),i=uv(c,o,t-1/3)}return{red:Math.round(n*255),green:Math.round(r*255),blue:Math.round(i*255),alpha:l}}function sg(t,s){return a=>a>0?s:t}const mv=(t,s,a)=>{const l=t*t,n=a*(s*s-l)+l;return n<0?0:Math.sqrt(n)},o8=[zj,Rd,Yc],d8=t=>o8.find(s=>s.test(t));function lk(t){const s=d8(t);if(!s)return!1;let a=s.parse(t);return s===Yc&&(a=i8(a)),a}const nk=(t,s)=>{const a=lk(t),l=lk(s);if(!a||!l)return sg(t,s);const n={...a};return r=>(n.red=mv(a.red,l.red,r),n.green=mv(a.green,l.green,r),n.blue=mv(a.blue,l.blue,r),n.alpha=ua(a.alpha,l.alpha,r),Rd.transform(n))},c8=(t,s)=>a=>s(t(a)),xp=(...t)=>t.reduce(c8),Kj=new Set(["none","hidden"]);function u8(t,s){return Kj.has(t)?a=>a<=0?t:s:a=>a>=1?s:t}function m8(t,s){return a=>ua(t,s,a)}function fw(t){return typeof t=="number"?m8:typeof t=="string"?YN(t)?sg:Dl.test(t)?nk:h8:Array.isArray(t)?lE:typeof t=="object"?Dl.test(t)?nk:x8:sg}function lE(t,s){const a=[...t],l=a.length,n=t.map((r,i)=>fw(r)(r,s[i]));return r=>{for(let i=0;i<l;i++)a[i]=n[i](r);return a}}function x8(t,s){const a={...t,...s},l={};for(const n in a)t[n]!==void 0&&s[n]!==void 0&&(l[n]=fw(t[n])(t[n],s[n]));return n=>{for(const r in l)a[r]=l[r](n);return a}}function p8(t,s){var a;const l=[],n={color:0,var:0,number:0};for(let r=0;r<s.values.length;r++){const i=s.types[r],o=t.indexes[i][n[i]],c=(a=t.values[o])!==null&&a!==void 0?a:0;l[r]=c,n[i]++}return l}const h8=(t,s)=>{const a=Go.createTransformer(s),l=qx(t),n=qx(s);return l.indexes.var.length===n.indexes.var.length&&l.indexes.color.length===n.indexes.color.length&&l.indexes.number.length>=n.indexes.number.length?Kj.has(t)&&!n.values.length||Kj.has(s)&&!l.values.length?u8(t,s):xp(lE(p8(l,n),n.values),a):sg(t,s)};function nE(t,s,a){return typeof t=="number"&&typeof s=="number"&&typeof a=="number"?ua(t,s,a):fw(t)(t,s)}const g8=5;function rE(t,s,a){const l=Math.max(s-g8,0);return RA(a-t(l),s-l)}const va={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},xv=.001;function f8({duration:t=va.duration,bounce:s=va.bounce,velocity:a=va.velocity,mass:l=va.mass}){let n,r,i=1-s;i=Ii(va.minDamping,va.maxDamping,i),t=Ii(va.minDuration,va.maxDuration,Mi(t)),i<1?(n=x=>{const j=x*i,g=j*t,y=j-a,$=Qj(x,i),T=Math.exp(-g);return xv-y/$*T},r=x=>{const g=x*i*t,y=g*a+a,$=Math.pow(i,2)*Math.pow(x,2)*t,T=Math.exp(-g),C=Qj(Math.pow(x,2),i);return(-n(x)+xv>0?-1:1)*((y-$)*T)/C}):(n=x=>{const j=Math.exp(-x*t),g=(x-a)*t+1;return-xv+j*g},r=x=>{const j=Math.exp(-x*t),g=(a-x)*(t*t);return j*g});const o=5/t,c=b8(n,r,o);if(t=Ei(t),isNaN(c))return{stiffness:va.stiffness,damping:va.damping,duration:t};{const x=Math.pow(c,2)*l;return{stiffness:x,damping:i*2*Math.sqrt(l*x),duration:t}}}const v8=12;function b8(t,s,a){let l=a;for(let n=1;n<v8;n++)l=l-t(l)/s(l);return l}function Qj(t,s){return t*Math.sqrt(1-s*s)}const j8=["duration","bounce"],y8=["stiffness","damping","mass"];function rk(t,s){return s.some(a=>t[a]!==void 0)}function N8(t){let s={velocity:va.velocity,stiffness:va.stiffness,damping:va.damping,mass:va.mass,isResolvedFromDuration:!1,...t};if(!rk(t,y8)&&rk(t,j8))if(t.visualDuration){const a=t.visualDuration,l=2*Math.PI/(a*1.2),n=l*l,r=2*Ii(.05,1,1-(t.bounce||0))*Math.sqrt(n);s={...s,mass:va.mass,stiffness:n,damping:r}}else{const a=f8(t);s={...s,...a,mass:va.mass},s.isResolvedFromDuration=!0}return s}function iE(t=va.visualDuration,s=va.bounce){const a=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:s}:t;let{restSpeed:l,restDelta:n}=a;const r=a.keyframes[0],i=a.keyframes[a.keyframes.length-1],o={done:!1,value:r},{stiffness:c,damping:x,mass:j,duration:g,velocity:y,isResolvedFromDuration:$}=N8({...a,velocity:-Mi(a.velocity||0)}),T=y||0,C=x/(2*Math.sqrt(c*j)),W=i-r,L=Mi(Math.sqrt(c/j)),R=Math.abs(W)<5;l||(l=R?va.restSpeed.granular:va.restSpeed.default),n||(n=R?va.restDelta.granular:va.restDelta.default);let F;if(C<1){const oe=Qj(L,C);F=G=>{const H=Math.exp(-C*L*G);return i-H*((T+C*L*W)/oe*Math.sin(oe*G)+W*Math.cos(oe*G))}}else if(C===1)F=oe=>i-Math.exp(-L*oe)*(W+(T+L*W)*oe);else{const oe=L*Math.sqrt(C*C-1);F=G=>{const H=Math.exp(-C*L*G),Y=Math.min(oe*G,300);return i-H*((T+C*L*W)*Math.sinh(Y)+oe*W*Math.cosh(Y))/oe}}const te={calculatedDuration:$&&g||null,next:oe=>{const G=F(oe);if($)o.done=oe>=g;else{let H=0;C<1&&(H=oe===0?Ei(T):rE(F,oe,G));const Y=Math.abs(H)<=l,we=Math.abs(i-G)<=n;o.done=Y&&we}return o.value=o.done?i:G,o},toString:()=>{const oe=Math.min(CA(te),Bj),G=SA(H=>te.next(oe*H).value,oe,30);return oe+"ms "+G}};return te}function ik({keyframes:t,velocity:s=0,power:a=.8,timeConstant:l=325,bounceDamping:n=10,bounceStiffness:r=500,modifyTarget:i,min:o,max:c,restDelta:x=.5,restSpeed:j}){const g=t[0],y={done:!1,value:g},$=Y=>o!==void 0&&Y<o||c!==void 0&&Y>c,T=Y=>o===void 0?c:c===void 0||Math.abs(o-Y)<Math.abs(c-Y)?o:c;let C=a*s;const W=g+C,L=i===void 0?W:i(W);L!==W&&(C=L-g);const R=Y=>-C*Math.exp(-Y/l),F=Y=>L+R(Y),te=Y=>{const we=R(Y),q=F(Y);y.done=Math.abs(we)<=x,y.value=y.done?L:q};let oe,G;const H=Y=>{$(y.value)&&(oe=Y,G=iE({keyframes:[y.value,T(y.value)],velocity:rE(F,Y,y.value),damping:n,stiffness:r,restDelta:x,restSpeed:j}))};return H(0),{calculatedDuration:null,next:Y=>{let we=!1;return!G&&oe===void 0&&(we=!0,te(Y),H(Y)),oe!==void 0&&Y>=oe?G.next(Y-oe):(!we&&te(Y),y)}}}const w8=mp(.42,0,1,1),k8=mp(0,0,.58,1),oE=mp(.42,0,.58,1),C8=t=>Array.isArray(t)&&typeof t[0]!="number",S8={linear:Rn,easeIn:w8,easeInOut:oE,easeOut:k8,circIn:mw,circInOut:BA,circOut:_A,backIn:uw,backInOut:UA,backOut:FA,anticipate:VA},ok=t=>{if(rw(t)){nA(t.length===4);const[s,a,l,n]=t;return mp(s,a,l,n)}else if(typeof t=="string")return S8[t];return t};function A8(t,s,a){const l=[],n=a||nE,r=t.length-1;for(let i=0;i<r;i++){let o=n(t[i],t[i+1]);if(s){const c=Array.isArray(s)?s[i]||Rn:s;o=xp(c,o)}l.push(o)}return l}function E8(t,s,{clamp:a=!0,ease:l,mixer:n}={}){const r=t.length;if(nA(r===s.length),r===1)return()=>s[0];if(r===2&&s[0]===s[1])return()=>s[1];const i=t[0]===t[1];t[0]>t[r-1]&&(t=[...t].reverse(),s=[...s].reverse());const o=A8(s,l,n),c=o.length,x=j=>{if(i&&j<t[0])return s[0];let g=0;if(c>1)for(;g<t.length-2&&!(j<t[g+1]);g++);const y=wu(t[g],t[g+1],j);return o[g](y)};return a?j=>x(Ii(t[0],t[r-1],j)):x}function M8(t,s){const a=t[t.length-1];for(let l=1;l<=s;l++){const n=wu(0,s,l);t.push(ua(a,1,n))}}function P8(t){const s=[0];return M8(s,t.length-1),s}function O8(t,s){return t.map(a=>a*s)}function T8(t,s){return t.map(()=>s||oE).splice(0,t.length-1)}function ag({duration:t=300,keyframes:s,times:a,ease:l="easeInOut"}){const n=C8(l)?l.map(ok):ok(l),r={done:!1,value:s[0]},i=O8(a&&a.length===s.length?a:P8(s),t),o=E8(i,s,{ease:Array.isArray(n)?n:T8(s,n)});return{calculatedDuration:t,next:c=>(r.value=o(c),r.done=c>=t,r)}}const R8=t=>{const s=({timestamp:a})=>t(a);return{start:()=>Qs.update(s,!0),stop:()=>Bo(s),now:()=>jl.isProcessing?jl.timestamp:li.now()}},D8={decay:ik,inertia:ik,tween:ag,keyframes:ag,spring:iE},I8=t=>t/100;class vw extends aE{constructor(s){super(s),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:c}=this.options;c&&c()};const{name:a,motionValue:l,element:n,keyframes:r}=this.options,i=(n==null?void 0:n.KeyframeResolver)||gw,o=(c,x)=>this.onKeyframesResolved(c,x);this.resolver=new i(r,o,a,l,n),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(s){const{type:a="keyframes",repeat:l=0,repeatDelay:n=0,repeatType:r,velocity:i=0}=this.options,o=nw(a)?a:D8[a]||ag;let c,x;o!==ag&&typeof s[0]!="number"&&(c=xp(I8,nE(s[0],s[1])),s=[0,100]);const j=o({...this.options,keyframes:s});r==="mirror"&&(x=o({...this.options,keyframes:[...s].reverse(),velocity:-i})),j.calculatedDuration===null&&(j.calculatedDuration=CA(j));const{calculatedDuration:g}=j,y=g+n,$=y*(l+1)-n;return{generator:j,mirroredGenerator:x,mapPercentToKeyframes:c,calculatedDuration:g,resolvedDuration:y,totalDuration:$}}onPostResolved(){const{autoplay:s=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!s?this.pause():this.state=this.pendingPlayState}tick(s,a=!1){const{resolved:l}=this;if(!l){const{keyframes:Y}=this.options;return{done:!0,value:Y[Y.length-1]}}const{finalKeyframe:n,generator:r,mirroredGenerator:i,mapPercentToKeyframes:o,keyframes:c,calculatedDuration:x,totalDuration:j,resolvedDuration:g}=l;if(this.startTime===null)return r.next(0);const{delay:y,repeat:$,repeatType:T,repeatDelay:C,onUpdate:W}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,s):this.speed<0&&(this.startTime=Math.min(s-j/this.speed,this.startTime)),a?this.currentTime=s:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(s-this.startTime)*this.speed;const L=this.currentTime-y*(this.speed>=0?1:-1),R=this.speed>=0?L<0:L>j;this.currentTime=Math.max(L,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=j);let F=this.currentTime,te=r;if($){const Y=Math.min(this.currentTime,j)/g;let we=Math.floor(Y),q=Y%1;!q&&Y>=1&&(q=1),q===1&&we--,we=Math.min(we,$+1),!!(we%2)&&(T==="reverse"?(q=1-q,C&&(q-=C/g)):T==="mirror"&&(te=i)),F=Ii(0,1,q)*g}const oe=R?{done:!1,value:c[0]}:te.next(F);o&&(oe.value=o(oe.value));let{done:G}=oe;!R&&x!==null&&(G=this.speed>=0?this.currentTime>=j:this.currentTime<=0);const H=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&G);return H&&n!==void 0&&(oe.value=Cf(c,this.options,n)),W&&W(oe.value),H&&this.finish(),oe}get duration(){const{resolved:s}=this;return s?Mi(s.calculatedDuration):0}get time(){return Mi(this.currentTime)}set time(s){s=Ei(s),this.currentTime=s,this.holdTime!==null||this.speed===0?this.holdTime=s:this.driver&&(this.startTime=this.driver.now()-s/this.speed)}get speed(){return this.playbackSpeed}set speed(s){const a=this.playbackSpeed!==s;this.playbackSpeed=s,a&&(this.time=Mi(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:s=R8,onPlay:a,startTime:l}=this.options;this.driver||(this.driver=s(r=>this.tick(r))),a&&a();const n=this.driver.now();this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=n):this.startTime=l??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var s;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(s=this.currentTime)!==null&&s!==void 0?s:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:s}=this.options;s&&s()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(s){return this.startTime=0,this.tick(s,!0)}}const $8=new Set(["opacity","clipPath","filter","transform"]);function L8(t,s,a,{delay:l=0,duration:n=300,repeat:r=0,repeatType:i="loop",ease:o="easeInOut",times:c}={}){const x={[s]:a};c&&(x.offset=c);const j=EA(o,n);return Array.isArray(j)&&(x.easing=j),t.animate(x,{delay:l,duration:n,easing:Array.isArray(j)?"linear":j,fill:"both",iterations:r+1,direction:i==="reverse"?"alternate":"normal"})}const F8=qN(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),lg=10,U8=2e4;function V8(t){return nw(t.type)||t.type==="spring"||!AA(t.ease)}function _8(t,s){const a=new vw({...s,keyframes:t,repeat:0,delay:0,isGenerator:!0});let l={done:!1,value:t[0]};const n=[];let r=0;for(;!l.done&&r<U8;)l=a.sample(r),n.push(l.value),r+=lg;return{times:void 0,keyframes:n,duration:r-lg,ease:"linear"}}const dE={anticipate:VA,backInOut:UA,circInOut:BA};function B8(t){return t in dE}class dk extends aE{constructor(s){super(s);const{name:a,motionValue:l,element:n,keyframes:r}=this.options;this.resolver=new sE(r,(i,o)=>this.onKeyframesResolved(i,o),a,l,n),this.resolver.scheduleResolve()}initPlayback(s,a){let{duration:l=300,times:n,ease:r,type:i,motionValue:o,name:c,startTime:x}=this.options;if(!o.owner||!o.owner.current)return!1;if(typeof r=="string"&&tg()&&B8(r)&&(r=dE[r]),V8(this.options)){const{onComplete:g,onUpdate:y,motionValue:$,element:T,...C}=this.options,W=_8(s,C);s=W.keyframes,s.length===1&&(s[1]=s[0]),l=W.duration,n=W.times,r=W.ease,i="keyframes"}const j=L8(o.owner.current,c,s,{...this.options,duration:l,times:n,ease:r});return j.startTime=x??this.calcStartTime(),this.pendingTimeline?(H1(j,this.pendingTimeline),this.pendingTimeline=void 0):j.onfinish=()=>{const{onComplete:g}=this.options;o.set(Cf(s,this.options,a)),g&&g(),this.cancel(),this.resolveFinishedPromise()},{animation:j,duration:l,times:n,type:i,ease:r,keyframes:s}}get duration(){const{resolved:s}=this;if(!s)return 0;const{duration:a}=s;return Mi(a)}get time(){const{resolved:s}=this;if(!s)return 0;const{animation:a}=s;return Mi(a.currentTime||0)}set time(s){const{resolved:a}=this;if(!a)return;const{animation:l}=a;l.currentTime=Ei(s)}get speed(){const{resolved:s}=this;if(!s)return 1;const{animation:a}=s;return a.playbackRate}set speed(s){const{resolved:a}=this;if(!a)return;const{animation:l}=a;l.playbackRate=s}get state(){const{resolved:s}=this;if(!s)return"idle";const{animation:a}=s;return a.playState}get startTime(){const{resolved:s}=this;if(!s)return null;const{animation:a}=s;return a.startTime}attachTimeline(s){if(!this._resolved)this.pendingTimeline=s;else{const{resolved:a}=this;if(!a)return Rn;const{animation:l}=a;H1(l,s)}return Rn}play(){if(this.isStopped)return;const{resolved:s}=this;if(!s)return;const{animation:a}=s;a.playState==="finished"&&this.updateFinishedPromise(),a.play()}pause(){const{resolved:s}=this;if(!s)return;const{animation:a}=s;a.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:s}=this;if(!s)return;const{animation:a,keyframes:l,duration:n,type:r,ease:i,times:o}=s;if(a.playState==="idle"||a.playState==="finished")return;if(this.time){const{motionValue:x,onUpdate:j,onComplete:g,element:y,...$}=this.options,T=new vw({...$,keyframes:l,duration:n,type:r,ease:i,times:o,isGenerator:!0}),C=Ei(this.time);x.setWithVelocity(T.sample(C-lg).value,T.sample(C).value,lg)}const{onStop:c}=this.options;c&&c(),this.cancel()}complete(){const{resolved:s}=this;s&&s.animation.finish()}cancel(){const{resolved:s}=this;s&&s.animation.cancel()}static supports(s){const{motionValue:a,name:l,repeatDelay:n,repeatType:r,damping:i,type:o}=s;if(!a||!a.owner||!(a.owner.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:x}=a.owner.getProps();return F8()&&l&&$8.has(l)&&!c&&!x&&!n&&r!=="mirror"&&i!==0&&o!=="inertia"}}const G8={type:"spring",stiffness:500,damping:25,restSpeed:10},q8=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),z8={type:"keyframes",duration:.8},W8={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},H8=(t,{keyframes:s})=>s.length>2?z8:Qd.has(t)?t.startsWith("scale")?q8(s[1]):G8:W8;function X8({when:t,delay:s,delayChildren:a,staggerChildren:l,staggerDirection:n,repeat:r,repeatType:i,repeatDelay:o,from:c,elapsed:x,...j}){return!!Object.keys(j).length}const bw=(t,s,a,l={},n,r)=>i=>{const o=lw(l,t)||{},c=o.delay||l.delay||0;let{elapsed:x=0}=l;x=x-Ei(c);let j={keyframes:Array.isArray(a)?a:[null,a],ease:"easeOut",velocity:s.getVelocity(),...o,delay:-x,onUpdate:y=>{s.set(y),o.onUpdate&&o.onUpdate(y)},onComplete:()=>{i(),o.onComplete&&o.onComplete()},name:t,motionValue:s,element:r?void 0:n};X8(o)||(j={...j,...H8(t,j)}),j.duration&&(j.duration=Ei(j.duration)),j.repeatDelay&&(j.repeatDelay=Ei(j.repeatDelay)),j.from!==void 0&&(j.keyframes[0]=j.from);let g=!1;if((j.type===!1||j.duration===0&&!j.repeatDelay)&&(j.duration=0,j.delay===0&&(g=!0)),g&&!r&&s.get()!==void 0){const y=Cf(j.keyframes,o);if(y!==void 0)return Qs.update(()=>{j.onUpdate(y),j.onComplete()}),new x7([])}return!r&&dk.supports(j)?new dk(j):new vw(j)};function K8({protectedKeys:t,needsAnimating:s},a){const l=t.hasOwnProperty(a)&&s[a]!==!0;return s[a]=!1,l}function cE(t,s,{delay:a=0,transitionOverride:l,type:n}={}){var r;let{transition:i=t.getDefaultTransition(),transitionEnd:o,...c}=s;l&&(i=l);const x=[],j=n&&t.animationState&&t.animationState.getState()[n];for(const g in c){const y=t.getValue(g,(r=t.latestValues[g])!==null&&r!==void 0?r:null),$=c[g];if($===void 0||j&&K8(j,g))continue;const T={delay:a,...lw(i||{},g)};let C=!1;if(window.MotionHandoffAnimation){const L=DA(t);if(L){const R=window.MotionHandoffAnimation(L,g,Qs);R!==null&&(T.startTime=R,C=!0)}}qj(t,g),y.start(bw(g,y,$,t.shouldReduceMotion&&TA.has(g)?{type:!1}:T,t,C));const W=y.animation;W&&x.push(W)}return o&&Promise.all(x).then(()=>{Qs.update(()=>{o&&A7(t,o)})}),x}function Yj(t,s,a={}){var l;const n=kf(t,s,a.type==="exit"?(l=t.presenceContext)===null||l===void 0?void 0:l.custom:void 0);let{transition:r=t.getDefaultTransition()||{}}=n||{};a.transitionOverride&&(r=a.transitionOverride);const i=n?()=>Promise.all(cE(t,n,a)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(x=0)=>{const{delayChildren:j=0,staggerChildren:g,staggerDirection:y}=r;return Q8(t,s,j+x,g,y,a)}:()=>Promise.resolve(),{when:c}=r;if(c){const[x,j]=c==="beforeChildren"?[i,o]:[o,i];return x().then(()=>j())}else return Promise.all([i(),o(a.delay)])}function Q8(t,s,a=0,l=0,n=1,r){const i=[],o=(t.variantChildren.size-1)*l,c=n===1?(x=0)=>x*l:(x=0)=>o-x*l;return Array.from(t.variantChildren).sort(Y8).forEach((x,j)=>{x.notify("AnimationStart",s),i.push(Yj(x,s,{...r,delay:a+c(j)}).then(()=>x.notify("AnimationComplete",s)))}),Promise.all(i)}function Y8(t,s){return t.sortNodePosition(s)}function J8(t,s,a={}){t.notify("AnimationStart",s);let l;if(Array.isArray(s)){const n=s.map(r=>Yj(t,r,a));l=Promise.all(n)}else if(typeof s=="string")l=Yj(t,s,a);else{const n=typeof s=="function"?kf(t,s,a.custom):s;l=Promise.all(cE(t,n,a))}return l.then(()=>{t.notify("AnimationComplete",s)})}const Z8=WN.length;function uE(t){if(!t)return;if(!t.isControllingVariants){const a=t.parent?uE(t.parent)||{}:{};return t.props.initial!==void 0&&(a.initial=t.props.initial),a}const s={};for(let a=0;a<Z8;a++){const l=WN[a],n=t.props[l];(_x(n)||n===!1)&&(s[l]=n)}return s}const eL=[...zN].reverse(),tL=zN.length;function sL(t){return s=>Promise.all(s.map(({animation:a,options:l})=>J8(t,a,l)))}function aL(t){let s=sL(t),a=ck(),l=!0;const n=c=>(x,j)=>{var g;const y=kf(t,j,c==="exit"?(g=t.presenceContext)===null||g===void 0?void 0:g.custom:void 0);if(y){const{transition:$,transitionEnd:T,...C}=y;x={...x,...C,...T}}return x};function r(c){s=c(t)}function i(c){const{props:x}=t,j=uE(t.parent)||{},g=[],y=new Set;let $={},T=1/0;for(let W=0;W<tL;W++){const L=eL[W],R=a[L],F=x[L]!==void 0?x[L]:j[L],te=_x(F),oe=L===c?R.isActive:null;oe===!1&&(T=W);let G=F===j[L]&&F!==x[L]&&te;if(G&&l&&t.manuallyAnimateOnMount&&(G=!1),R.protectedKeys={...$},!R.isActive&&oe===null||!F&&!R.prevProp||Nf(F)||typeof F=="boolean")continue;const H=lL(R.prevProp,F);let Y=H||L===c&&R.isActive&&!G&&te||W>T&&te,we=!1;const q=Array.isArray(F)?F:[F];let je=q.reduce(n(L),{});oe===!1&&(je={});const{prevResolvedValues:_e={}}=R,Ee={..._e,...je},be=pe=>{Y=!0,y.has(pe)&&(we=!0,y.delete(pe)),R.needsAnimating[pe]=!0;const Q=t.getValue(pe);Q&&(Q.liveStyle=!1)};for(const pe in Ee){const Q=je[pe],Re=_e[pe];if($.hasOwnProperty(pe))continue;let ce=!1;_j(Q)&&_j(Re)?ce=!kA(Q,Re):ce=Q!==Re,ce?Q!=null?be(pe):y.add(pe):Q!==void 0&&y.has(pe)?be(pe):R.protectedKeys[pe]=!0}R.prevProp=F,R.prevResolvedValues=je,R.isActive&&($={...$,...je}),l&&t.blockInitialAnimation&&(Y=!1),Y&&(!(G&&H)||we)&&g.push(...q.map(pe=>({animation:pe,options:{type:L}})))}if(y.size){const W={};y.forEach(L=>{const R=t.getBaseTarget(L),F=t.getValue(L);F&&(F.liveStyle=!0),W[L]=R??null}),g.push({animation:W})}let C=!!g.length;return l&&(x.initial===!1||x.initial===x.animate)&&!t.manuallyAnimateOnMount&&(C=!1),l=!1,C?s(g):Promise.resolve()}function o(c,x){var j;if(a[c].isActive===x)return Promise.resolve();(j=t.variantChildren)===null||j===void 0||j.forEach(y=>{var $;return($=y.animationState)===null||$===void 0?void 0:$.setActive(c,x)}),a[c].isActive=x;const g=i(c);for(const y in a)a[y].protectedKeys={};return g}return{animateChanges:i,setActive:o,setAnimateFunction:r,getState:()=>a,reset:()=>{a=ck(),l=!0}}}function lL(t,s){return typeof s=="string"?s!==t:Array.isArray(s)?!kA(s,t):!1}function ed(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function ck(){return{animate:ed(!0),whileInView:ed(),whileHover:ed(),whileTap:ed(),whileDrag:ed(),whileFocus:ed(),exit:ed()}}class Qo{constructor(s){this.isMounted=!1,this.node=s}update(){}}class nL extends Qo{constructor(s){super(s),s.animationState||(s.animationState=aL(s))}updateAnimationControlsSubscription(){const{animate:s}=this.node.getProps();Nf(s)&&(this.unmountControls=s.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:s}=this.node.getProps(),{animate:a}=this.node.prevProps||{};s!==a&&this.updateAnimationControlsSubscription()}unmount(){var s;this.node.animationState.reset(),(s=this.unmountControls)===null||s===void 0||s.call(this)}}let rL=0;class iL extends Qo{constructor(){super(...arguments),this.id=rL++}update(){if(!this.node.presenceContext)return;const{isPresent:s,onExitComplete:a}=this.node.presenceContext,{isPresent:l}=this.node.prevPresenceContext||{};if(!this.node.animationState||s===l)return;const n=this.node.animationState.setActive("exit",!s);a&&!s&&n.then(()=>a(this.id))}mount(){const{register:s}=this.node.presenceContext||{};s&&(this.unmount=s(this.id))}unmount(){}}const oL={animation:{Feature:nL},exit:{Feature:iL}};function zx(t,s,a,l={passive:!0}){return t.addEventListener(s,a,l),()=>t.removeEventListener(s,a)}function pp(t){return{point:{x:t.pageX,y:t.pageY}}}const dL=t=>s=>iw(s)&&t(s,pp(s));function nx(t,s,a,l){return zx(t,s,dL(a),l)}const uk=(t,s)=>Math.abs(t-s);function cL(t,s){const a=uk(t.x,s.x),l=uk(t.y,s.y);return Math.sqrt(a**2+l**2)}class mE{constructor(s,a,{transformPagePoint:l,contextWindow:n,dragSnapToOrigin:r=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=hv(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,$=cL(g.offset,{x:0,y:0})>=3;if(!y&&!$)return;const{point:T}=g,{timestamp:C}=jl;this.history.push({...T,timestamp:C});const{onStart:W,onMove:L}=this.handlers;y||(W&&W(this.lastMoveEvent,g),this.startEvent=this.lastMoveEvent),L&&L(this.lastMoveEvent,g)},this.handlePointerMove=(g,y)=>{this.lastMoveEvent=g,this.lastMoveEventInfo=pv(y,this.transformPagePoint),Qs.update(this.updatePoint,!0)},this.handlePointerUp=(g,y)=>{this.end();const{onEnd:$,onSessionEnd:T,resumeAnimation:C}=this.handlers;if(this.dragSnapToOrigin&&C&&C(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const W=hv(g.type==="pointercancel"?this.lastMoveEventInfo:pv(y,this.transformPagePoint),this.history);this.startEvent&&$&&$(g,W),T&&T(g,W)},!iw(s))return;this.dragSnapToOrigin=r,this.handlers=a,this.transformPagePoint=l,this.contextWindow=n||window;const i=pp(s),o=pv(i,this.transformPagePoint),{point:c}=o,{timestamp:x}=jl;this.history=[{...c,timestamp:x}];const{onSessionStart:j}=a;j&&j(s,hv(o,this.history)),this.removeListeners=xp(nx(this.contextWindow,"pointermove",this.handlePointerMove),nx(this.contextWindow,"pointerup",this.handlePointerUp),nx(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(s){this.handlers=s}end(){this.removeListeners&&this.removeListeners(),Bo(this.updatePoint)}}function pv(t,s){return s?{point:s(t.point)}:t}function mk(t,s){return{x:t.x-s.x,y:t.y-s.y}}function hv({point:t},s){return{point:t,delta:mk(t,xE(s)),offset:mk(t,uL(s)),velocity:mL(s,.1)}}function uL(t){return t[0]}function xE(t){return t[t.length-1]}function mL(t,s){if(t.length<2)return{x:0,y:0};let a=t.length-1,l=null;const n=xE(t);for(;a>=0&&(l=t[a],!(n.timestamp-l.timestamp>Ei(s)));)a--;if(!l)return{x:0,y:0};const r=Mi(n.timestamp-l.timestamp);if(r===0)return{x:0,y:0};const i={x:(n.x-l.x)/r,y:(n.y-l.y)/r};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}const pE=1e-4,xL=1-pE,pL=1+pE,hE=.01,hL=0-hE,gL=0+hE;function $n(t){return t.max-t.min}function fL(t,s,a){return Math.abs(t-s)<=a}function xk(t,s,a,l=.5){t.origin=l,t.originPoint=ua(s.min,s.max,t.origin),t.scale=$n(a)/$n(s),t.translate=ua(a.min,a.max,t.origin)-t.originPoint,(t.scale>=xL&&t.scale<=pL||isNaN(t.scale))&&(t.scale=1),(t.translate>=hL&&t.translate<=gL||isNaN(t.translate))&&(t.translate=0)}function rx(t,s,a,l){xk(t.x,s.x,a.x,l?l.originX:void 0),xk(t.y,s.y,a.y,l?l.originY:void 0)}function pk(t,s,a){t.min=a.min+s.min,t.max=t.min+$n(s)}function vL(t,s,a){pk(t.x,s.x,a.x),pk(t.y,s.y,a.y)}function hk(t,s,a){t.min=s.min-a.min,t.max=t.min+$n(s)}function ix(t,s,a){hk(t.x,s.x,a.x),hk(t.y,s.y,a.y)}function bL(t,{min:s,max:a},l){return s!==void 0&&t<s?t=l?ua(s,t,l.min):Math.max(t,s):a!==void 0&&t>a&&(t=l?ua(a,t,l.max):Math.min(t,a)),t}function gk(t,s,a){return{min:s!==void 0?t.min+s:void 0,max:a!==void 0?t.max+a-(t.max-t.min):void 0}}function jL(t,{top:s,left:a,bottom:l,right:n}){return{x:gk(t.x,a,n),y:gk(t.y,s,l)}}function fk(t,s){let a=s.min-t.min,l=s.max-t.max;return s.max-s.min<t.max-t.min&&([a,l]=[l,a]),{min:a,max:l}}function yL(t,s){return{x:fk(t.x,s.x),y:fk(t.y,s.y)}}function NL(t,s){let a=.5;const l=$n(t),n=$n(s);return n>l?a=wu(s.min,s.max-l,t.min):l>n&&(a=wu(t.min,t.max-n,s.min)),Ii(0,1,a)}function wL(t,s){const a={};return s.min!==void 0&&(a.min=s.min-t.min),s.max!==void 0&&(a.max=s.max-t.min),a}const Jj=.35;function kL(t=Jj){return t===!1?t=0:t===!0&&(t=Jj),{x:vk(t,"left","right"),y:vk(t,"top","bottom")}}function vk(t,s,a){return{min:bk(t,s),max:bk(t,a)}}function bk(t,s){return typeof t=="number"?t:t[s]||0}const jk=()=>({translate:0,scale:1,origin:0,originPoint:0}),Jc=()=>({x:jk(),y:jk()}),yk=()=>({min:0,max:0}),Pa=()=>({x:yk(),y:yk()});function Xn(t){return[t("x"),t("y")]}function gE({top:t,left:s,right:a,bottom:l}){return{x:{min:s,max:a},y:{min:t,max:l}}}function CL({x:t,y:s}){return{top:s.min,right:t.max,bottom:s.max,left:t.min}}function SL(t,s){if(!s)return t;const a=s({x:t.left,y:t.top}),l=s({x:t.right,y:t.bottom});return{top:a.y,left:a.x,bottom:l.y,right:l.x}}function gv(t){return t===void 0||t===1}function Zj({scale:t,scaleX:s,scaleY:a}){return!gv(t)||!gv(s)||!gv(a)}function Nd(t){return Zj(t)||fE(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function fE(t){return Nk(t.x)||Nk(t.y)}function Nk(t){return t&&t!=="0%"}function ng(t,s,a){const l=t-a,n=s*l;return a+n}function wk(t,s,a,l,n){return n!==void 0&&(t=ng(t,n,l)),ng(t,a,l)+s}function ey(t,s=0,a=1,l,n){t.min=wk(t.min,s,a,l,n),t.max=wk(t.max,s,a,l,n)}function vE(t,{x:s,y:a}){ey(t.x,s.translate,s.scale,s.originPoint),ey(t.y,a.translate,a.scale,a.originPoint)}const kk=.999999999999,Ck=1.0000000000001;function AL(t,s,a,l=!1){const n=a.length;if(!n)return;s.x=s.y=1;let r,i;for(let o=0;o<n;o++){r=a[o],i=r.projectionDelta;const{visualElement:c}=r.options;c&&c.props.style&&c.props.style.display==="contents"||(l&&r.options.layoutScroll&&r.scroll&&r!==r.root&&eu(t,{x:-r.scroll.offset.x,y:-r.scroll.offset.y}),i&&(s.x*=i.x.scale,s.y*=i.y.scale,vE(t,i)),l&&Nd(r.latestValues)&&eu(t,r.latestValues))}s.x<Ck&&s.x>kk&&(s.x=1),s.y<Ck&&s.y>kk&&(s.y=1)}function Zc(t,s){t.min=t.min+s,t.max=t.max+s}function Sk(t,s,a,l,n=.5){const r=ua(t.min,t.max,n);ey(t,s,a,r,l)}function eu(t,s){Sk(t.x,s.x,s.scaleX,s.scale,s.originX),Sk(t.y,s.y,s.scaleY,s.scale,s.originY)}function bE(t,s){return gE(SL(t.getBoundingClientRect(),s))}function EL(t,s,a){const l=bE(t,a),{scroll:n}=s;return n&&(Zc(l.x,n.offset.x),Zc(l.y,n.offset.y)),l}const jE=({current:t})=>t?t.ownerDocument.defaultView:null,ML=new WeakMap;class PL{constructor(s){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Pa(),this.visualElement=s}start(s,{snapToCursor:a=!1}={}){const{presenceContext:l}=this.visualElement;if(l&&l.isPresent===!1)return;const n=j=>{const{dragSnapToOrigin:g}=this.getProps();g?this.pauseAnimation():this.stopAnimation(),a&&this.snapToCursor(pp(j).point)},r=(j,g)=>{const{drag:y,dragPropagation:$,onDragStart:T}=this.getProps();if(y&&!$&&(this.openDragLock&&this.openDragLock(),this.openDragLock=N7(y),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Xn(W=>{let L=this.getAxisMotionValue(W).get()||0;if(ai.test(L)){const{projection:R}=this.visualElement;if(R&&R.layout){const F=R.layout.layoutBox[W];F&&(L=$n(F)*(parseFloat(L)/100))}}this.originPoint[W]=L}),T&&Qs.postRender(()=>T(j,g)),qj(this.visualElement,"transform");const{animationState:C}=this.visualElement;C&&C.setActive("whileDrag",!0)},i=(j,g)=>{const{dragPropagation:y,dragDirectionLock:$,onDirectionLock:T,onDrag:C}=this.getProps();if(!y&&!this.openDragLock)return;const{offset:W}=g;if($&&this.currentDirection===null){this.currentDirection=OL(W),this.currentDirection!==null&&T&&T(this.currentDirection);return}this.updateAxis("x",g.point,W),this.updateAxis("y",g.point,W),this.visualElement.render(),C&&C(j,g)},o=(j,g)=>this.stop(j,g),c=()=>Xn(j=>{var g;return this.getAnimationState(j)==="paused"&&((g=this.getAxisMotionValue(j).animation)===null||g===void 0?void 0:g.play())}),{dragSnapToOrigin:x}=this.getProps();this.panSession=new mE(s,{onSessionStart:n,onStart:r,onMove:i,onSessionEnd:o,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:x,contextWindow:jE(this.visualElement)})}stop(s,a){const l=this.isDragging;if(this.cancel(),!l)return;const{velocity:n}=a;this.startAnimation(n);const{onDragEnd:r}=this.getProps();r&&Qs.postRender(()=>r(s,a))}cancel(){this.isDragging=!1;const{projection:s,animationState:a}=this.visualElement;s&&(s.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:l}=this.getProps();!l&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),a&&a.setActive("whileDrag",!1)}updateAxis(s,a,l){const{drag:n}=this.getProps();if(!l||!Vp(s,n,this.currentDirection))return;const r=this.getAxisMotionValue(s);let i=this.originPoint[s]+l[s];this.constraints&&this.constraints[s]&&(i=bL(i,this.constraints[s],this.elastic[s])),r.set(i)}resolveConstraints(){var s;const{dragConstraints:a,dragElastic:l}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(s=this.visualElement.projection)===null||s===void 0?void 0:s.layout,r=this.constraints;a&&Qc(a)?this.constraints||(this.constraints=this.resolveRefConstraints()):a&&n?this.constraints=jL(n.layoutBox,a):this.constraints=!1,this.elastic=kL(l),r!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&Xn(i=>{this.constraints!==!1&&this.getAxisMotionValue(i)&&(this.constraints[i]=wL(n.layoutBox[i],this.constraints[i]))})}resolveRefConstraints(){const{dragConstraints:s,onMeasureDragConstraints:a}=this.getProps();if(!s||!Qc(s))return!1;const l=s.current,{projection:n}=this.visualElement;if(!n||!n.layout)return!1;const r=EL(l,n.root,this.visualElement.getTransformPagePoint());let i=yL(n.layout.layoutBox,r);if(a){const o=a(CL(i));this.hasMutatedConstraints=!!o,o&&(i=gE(o))}return i}startAnimation(s){const{drag:a,dragMomentum:l,dragElastic:n,dragTransition:r,dragSnapToOrigin:i,onDragTransitionEnd:o}=this.getProps(),c=this.constraints||{},x=Xn(j=>{if(!Vp(j,a,this.currentDirection))return;let g=c&&c[j]||{};i&&(g={min:0,max:0});const y=n?200:1e6,$=n?40:1e7,T={type:"inertia",velocity:l?s[j]:0,bounceStiffness:y,bounceDamping:$,timeConstant:750,restDelta:1,restSpeed:10,...r,...g};return this.startAxisValueAnimation(j,T)});return Promise.all(x).then(o)}startAxisValueAnimation(s,a){const l=this.getAxisMotionValue(s);return qj(this.visualElement,s),l.start(bw(s,l,0,a,this.visualElement,!1))}stopAnimation(){Xn(s=>this.getAxisMotionValue(s).stop())}pauseAnimation(){Xn(s=>{var a;return(a=this.getAxisMotionValue(s).animation)===null||a===void 0?void 0:a.pause()})}getAnimationState(s){var a;return(a=this.getAxisMotionValue(s).animation)===null||a===void 0?void 0:a.state}getAxisMotionValue(s){const a=`_drag${s.toUpperCase()}`,l=this.visualElement.getProps(),n=l[a];return n||this.visualElement.getValue(s,(l.initial?l.initial[s]:void 0)||0)}snapToCursor(s){Xn(a=>{const{drag:l}=this.getProps();if(!Vp(a,l,this.currentDirection))return;const{projection:n}=this.visualElement,r=this.getAxisMotionValue(a);if(n&&n.layout){const{min:i,max:o}=n.layout.layoutBox[a];r.set(s[a]-ua(i,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:s,dragConstraints:a}=this.getProps(),{projection:l}=this.visualElement;if(!Qc(a)||!l||!this.constraints)return;this.stopAnimation();const n={x:0,y:0};Xn(i=>{const o=this.getAxisMotionValue(i);if(o&&this.constraints!==!1){const c=o.get();n[i]=NL({min:c,max:c},this.constraints[i])}});const{transformTemplate:r}=this.visualElement.getProps();this.visualElement.current.style.transform=r?r({},""):"none",l.root&&l.root.updateScroll(),l.updateLayout(),this.resolveConstraints(),Xn(i=>{if(!Vp(i,s,null))return;const o=this.getAxisMotionValue(i),{min:c,max:x}=this.constraints[i];o.set(ua(c,x,n[i]))})}addListeners(){if(!this.visualElement.current)return;ML.set(this.visualElement,this);const s=this.visualElement.current,a=nx(s,"pointerdown",c=>{const{drag:x,dragListener:j=!0}=this.getProps();x&&j&&this.start(c)}),l=()=>{const{dragConstraints:c}=this.getProps();Qc(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,r=n.addEventListener("measure",l);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),Qs.read(l);const i=zx(window,"resize",()=>this.scalePositionWithinConstraints()),o=n.addEventListener("didUpdate",({delta:c,hasLayoutChanged:x})=>{this.isDragging&&x&&(Xn(j=>{const g=this.getAxisMotionValue(j);g&&(this.originPoint[j]+=c[j].translate,g.set(g.get()+c[j].translate))}),this.visualElement.render())});return()=>{i(),a(),r(),o&&o()}}getProps(){const s=this.visualElement.getProps(),{drag:a=!1,dragDirectionLock:l=!1,dragPropagation:n=!1,dragConstraints:r=!1,dragElastic:i=Jj,dragMomentum:o=!0}=s;return{...s,drag:a,dragDirectionLock:l,dragPropagation:n,dragConstraints:r,dragElastic:i,dragMomentum:o}}}function Vp(t,s,a){return(s===!0||s===t)&&(a===null||a===t)}function OL(t,s=10){let a=null;return Math.abs(t.y)>s?a="y":Math.abs(t.x)>s&&(a="x"),a}class TL extends Qo{constructor(s){super(s),this.removeGroupControls=Rn,this.removeListeners=Rn,this.controls=new PL(s)}mount(){const{dragControls:s}=this.node.getProps();s&&(this.removeGroupControls=s.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Rn}unmount(){this.removeGroupControls(),this.removeListeners()}}const Ak=t=>(s,a)=>{t&&Qs.postRender(()=>t(s,a))};class RL extends Qo{constructor(){super(...arguments),this.removePointerDownListener=Rn}onPointerDown(s){this.session=new mE(s,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:jE(this.node)})}createPanHandlers(){const{onPanSessionStart:s,onPanStart:a,onPan:l,onPanEnd:n}=this.node.getProps();return{onSessionStart:Ak(s),onStart:Ak(a),onMove:l,onEnd:(r,i)=>{delete this.session,n&&Qs.postRender(()=>n(r,i))}}}mount(){this.removePointerDownListener=nx(this.node.current,"pointerdown",s=>this.onPointerDown(s))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const p0={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Ek(t,s){return s.max===s.min?0:t/(s.max-s.min)*100}const Zu={correct:(t,s)=>{if(!s.target)return t;if(typeof t=="string")if(Pt.test(t))t=parseFloat(t);else return t;const a=Ek(t,s.target.x),l=Ek(t,s.target.y);return`${a}% ${l}%`}},DL={correct:(t,{treeScale:s,projectionDelta:a})=>{const l=t,n=Go.parse(t);if(n.length>5)return l;const r=Go.createTransformer(t),i=typeof n[0]!="number"?1:0,o=a.x.scale*s.x,c=a.y.scale*s.y;n[0+i]/=o,n[1+i]/=c;const x=ua(o,c,.5);return typeof n[2+i]=="number"&&(n[2+i]/=x),typeof n[3+i]=="number"&&(n[3+i]/=x),r(n)}};class IL extends d.Component{componentDidMount(){const{visualElement:s,layoutGroup:a,switchLayoutGroup:l,layoutId:n}=this.props,{projection:r}=s;t7($L),r&&(a.group&&a.group.add(r),l&&l.register&&n&&l.register(r),r.root.didUpdate(),r.addEventListener("animationComplete",()=>{this.safeToRemove()}),r.setOptions({...r.options,onExitComplete:()=>this.safeToRemove()})),p0.hasEverUpdated=!0}getSnapshotBeforeUpdate(s){const{layoutDependency:a,visualElement:l,drag:n,isPresent:r}=this.props,i=l.projection;return i&&(i.isPresent=r,n||s.layoutDependency!==a||a===void 0?i.willUpdate():this.safeToRemove(),s.isPresent!==r&&(r?i.promote():i.relegate()||Qs.postRender(()=>{const o=i.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:s}=this.props.visualElement;s&&(s.root.didUpdate(),XN.postRender(()=>{!s.currentAnimation&&s.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:s,layoutGroup:a,switchLayoutGroup:l}=this.props,{projection:n}=s;n&&(n.scheduleCheckAfterUnmount(),a&&a.group&&a.group.remove(n),l&&l.deregister&&l.deregister(n))}safeToRemove(){const{safeToRemove:s}=this.props;s&&s()}render(){return null}}function yE(t){const[s,a]=aA(),l=d.useContext(VN);return e.jsx(IL,{...t,layoutGroup:l,switchLayoutGroup:d.useContext(uA),isPresent:s,safeToRemove:a})}const $L={borderRadius:{...Zu,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Zu,borderTopRightRadius:Zu,borderBottomLeftRadius:Zu,borderBottomRightRadius:Zu,boxShadow:DL};function LL(t,s,a){const l=Ll(t)?t:Gx(t);return l.start(bw("",l,s,a)),l.animation}function FL(t){return t instanceof SVGElement&&t.tagName!=="svg"}const UL=(t,s)=>t.depth-s.depth;class VL{constructor(){this.children=[],this.isDirty=!1}add(s){ow(this.children,s),this.isDirty=!0}remove(s){dw(this.children,s),this.isDirty=!0}forEach(s){this.isDirty&&this.children.sort(UL),this.isDirty=!1,this.children.forEach(s)}}function _L(t,s){const a=li.now(),l=({timestamp:n})=>{const r=n-a;r>=s&&(Bo(l),t(r-s))};return Qs.read(l,!0),()=>Bo(l)}const NE=["TopLeft","TopRight","BottomLeft","BottomRight"],BL=NE.length,Mk=t=>typeof t=="string"?parseFloat(t):t,Pk=t=>typeof t=="number"||Pt.test(t);function GL(t,s,a,l,n,r){n?(t.opacity=ua(0,a.opacity!==void 0?a.opacity:1,qL(l)),t.opacityExit=ua(s.opacity!==void 0?s.opacity:1,0,zL(l))):r&&(t.opacity=ua(s.opacity!==void 0?s.opacity:1,a.opacity!==void 0?a.opacity:1,l));for(let i=0;i<BL;i++){const o=`border${NE[i]}Radius`;let c=Ok(s,o),x=Ok(a,o);if(c===void 0&&x===void 0)continue;c||(c=0),x||(x=0),c===0||x===0||Pk(c)===Pk(x)?(t[o]=Math.max(ua(Mk(c),Mk(x),l),0),(ai.test(x)||ai.test(c))&&(t[o]+="%")):t[o]=x}(s.rotate||a.rotate)&&(t.rotate=ua(s.rotate||0,a.rotate||0,l))}function Ok(t,s){return t[s]!==void 0?t[s]:t.borderRadius}const qL=wE(0,.5,_A),zL=wE(.5,.95,Rn);function wE(t,s,a){return l=>l<t?0:l>s?1:a(wu(t,s,l))}function Tk(t,s){t.min=s.min,t.max=s.max}function Vn(t,s){Tk(t.x,s.x),Tk(t.y,s.y)}function Rk(t,s){t.translate=s.translate,t.scale=s.scale,t.originPoint=s.originPoint,t.origin=s.origin}function Dk(t,s,a,l,n){return t-=s,t=ng(t,1/a,l),n!==void 0&&(t=ng(t,1/n,l)),t}function WL(t,s=0,a=1,l=.5,n,r=t,i=t){if(ai.test(s)&&(s=parseFloat(s),s=ua(i.min,i.max,s/100)-i.min),typeof s!="number")return;let o=ua(r.min,r.max,l);t===r&&(o-=s),t.min=Dk(t.min,s,a,o,n),t.max=Dk(t.max,s,a,o,n)}function Ik(t,s,[a,l,n],r,i){WL(t,s[a],s[l],s[n],s.scale,r,i)}const HL=["x","scaleX","originX"],XL=["y","scaleY","originY"];function $k(t,s,a,l){Ik(t.x,s,HL,a?a.x:void 0,l?l.x:void 0),Ik(t.y,s,XL,a?a.y:void 0,l?l.y:void 0)}function Lk(t){return t.translate===0&&t.scale===1}function kE(t){return Lk(t.x)&&Lk(t.y)}function Fk(t,s){return t.min===s.min&&t.max===s.max}function KL(t,s){return Fk(t.x,s.x)&&Fk(t.y,s.y)}function Uk(t,s){return Math.round(t.min)===Math.round(s.min)&&Math.round(t.max)===Math.round(s.max)}function CE(t,s){return Uk(t.x,s.x)&&Uk(t.y,s.y)}function Vk(t){return $n(t.x)/$n(t.y)}function _k(t,s){return t.translate===s.translate&&t.scale===s.scale&&t.originPoint===s.originPoint}class QL{constructor(){this.members=[]}add(s){ow(this.members,s),s.scheduleRender()}remove(s){if(dw(this.members,s),s===this.prevLead&&(this.prevLead=void 0),s===this.lead){const a=this.members[this.members.length-1];a&&this.promote(a)}}relegate(s){const a=this.members.findIndex(n=>s===n);if(a===0)return!1;let l;for(let n=a;n>=0;n--){const r=this.members[n];if(r.isPresent!==!1){l=r;break}}return l?(this.promote(l),!0):!1}promote(s,a){const l=this.lead;if(s!==l&&(this.prevLead=l,this.lead=s,s.show(),l)){l.instance&&l.scheduleRender(),s.scheduleRender(),s.resumeFrom=l,a&&(s.resumeFrom.preserveOpacity=!0),l.snapshot&&(s.snapshot=l.snapshot,s.snapshot.latestValues=l.animationValues||l.latestValues),s.root&&s.root.isUpdating&&(s.isLayoutDirty=!0);const{crossfade:n}=s.options;n===!1&&l.hide()}}exitAnimationComplete(){this.members.forEach(s=>{const{options:a,resumingFrom:l}=s;a.onExitComplete&&a.onExitComplete(),l&&l.options.onExitComplete&&l.options.onExitComplete()})}scheduleRender(){this.members.forEach(s=>{s.instance&&s.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function YL(t,s,a){let l="";const n=t.x.translate/s.x,r=t.y.translate/s.y,i=(a==null?void 0:a.z)||0;if((n||r||i)&&(l=`translate3d(${n}px, ${r}px, ${i}px) `),(s.x!==1||s.y!==1)&&(l+=`scale(${1/s.x}, ${1/s.y}) `),a){const{transformPerspective:x,rotate:j,rotateX:g,rotateY:y,skewX:$,skewY:T}=a;x&&(l=`perspective(${x}px) ${l}`),j&&(l+=`rotate(${j}deg) `),g&&(l+=`rotateX(${g}deg) `),y&&(l+=`rotateY(${y}deg) `),$&&(l+=`skewX(${$}deg) `),T&&(l+=`skewY(${T}deg) `)}const o=t.x.scale*s.x,c=t.y.scale*s.y;return(o!==1||c!==1)&&(l+=`scale(${o}, ${c})`),l||"none"}const wd={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},zm=typeof window<"u"&&window.MotionDebug!==void 0,fv=["","X","Y","Z"],JL={visibility:"hidden"},Bk=1e3;let ZL=0;function vv(t,s,a,l){const{latestValues:n}=s;n[t]&&(a[t]=n[t],s.setStaticValue(t,0),l&&(l[t]=0))}function SE(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:s}=t.options;if(!s)return;const a=DA(s);if(window.MotionHasOptimisedAnimation(a,"transform")){const{layout:n,layoutId:r}=t.options;window.MotionCancelOptimisedAnimation(a,"transform",Qs,!(n||r))}const{parent:l}=t;l&&!l.hasCheckedOptimisedAppear&&SE(l)}function AE({attachResizeListener:t,defaultParent:s,measureScroll:a,checkIsScrollRoot:l,resetTransform:n}){return class{constructor(i={},o=s==null?void 0:s()){this.id=ZL++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,zm&&(wd.totalNodes=wd.resolvedTargetDeltas=wd.recalculatedProjection=0),this.nodes.forEach(sF),this.nodes.forEach(iF),this.nodes.forEach(oF),this.nodes.forEach(aF),zm&&window.MotionDebug.record(wd)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new VL)}addEventListener(i,o){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new cw),this.eventHandlers.get(i).add(o)}notifyListeners(i,...o){const c=this.eventHandlers.get(i);c&&c.notify(...o)}hasListeners(i){return this.eventHandlers.has(i)}mount(i,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=FL(i),this.instance=i;const{layoutId:c,layout:x,visualElement:j}=this.options;if(j&&!j.current&&j.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(x||c)&&(this.isLayoutDirty=!0),t){let g;const y=()=>this.root.updateBlockedByResize=!1;t(i,()=>{this.root.updateBlockedByResize=!0,g&&g(),g=_L(y,250),p0.hasAnimatedSinceResize&&(p0.hasAnimatedSinceResize=!1,this.nodes.forEach(qk))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&j&&(c||x)&&this.addEventListener("didUpdate",({delta:g,hasLayoutChanged:y,hasRelativeTargetChanged:$,layout:T})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const C=this.options.transition||j.getDefaultTransition()||xF,{onLayoutAnimationStart:W,onLayoutAnimationComplete:L}=j.getProps(),R=!this.targetLayout||!CE(this.targetLayout,T)||$,F=!y&&$;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||F||y&&(R||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(g,F);const te={...lw(C,"layout"),onPlay:W,onComplete:L};(j.shouldReduceMotion||this.options.layoutRoot)&&(te.delay=0,te.type=!1),this.startAnimation(te)}else y||qk(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=T})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Bo(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(dF),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&SE(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let j=0;j<this.path.length;j++){const g=this.path[j];g.shouldResetTransform=!0,g.updateScroll("snapshot"),g.options.layoutRoot&&g.willUpdate(!1)}const{layoutId:o,layout:c}=this.options;if(o===void 0&&!c)return;const x=this.getTransformTemplate();this.prevTransformTemplateValue=x?x(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Gk);return}this.isUpdating||this.nodes.forEach(nF),this.isUpdating=!1,this.nodes.forEach(rF),this.nodes.forEach(eF),this.nodes.forEach(tF),this.clearAllSnapshots();const o=li.now();jl.delta=Ii(0,1e3/60,o-jl.timestamp),jl.timestamp=o,jl.isProcessing=!0,ov.update.process(jl),ov.preRender.process(jl),ov.render.process(jl),jl.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,XN.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(lF),this.sharedNodes.forEach(cF)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Qs.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Qs.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Pa(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(o=!1),o){const c=l(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:c,offset:a(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!n)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!kE(this.projectionDelta),c=this.getTransformTemplate(),x=c?c(this.latestValues,""):void 0,j=x!==this.prevTransformTemplateValue;i&&(o||Nd(this.latestValues)||j)&&(n(this.instance,x),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const o=this.measurePageBox();let c=this.removeElementScroll(o);return i&&(c=this.removeTransform(c)),pF(c),{animationId:this.root.animationId,measuredBox:o,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var i;const{visualElement:o}=this.options;if(!o)return Pa();const c=o.measureViewportBox();if(!(((i=this.scroll)===null||i===void 0?void 0:i.wasRoot)||this.path.some(hF))){const{scroll:j}=this.root;j&&(Zc(c.x,j.offset.x),Zc(c.y,j.offset.y))}return c}removeElementScroll(i){var o;const c=Pa();if(Vn(c,i),!((o=this.scroll)===null||o===void 0)&&o.wasRoot)return c;for(let x=0;x<this.path.length;x++){const j=this.path[x],{scroll:g,options:y}=j;j!==this.root&&g&&y.layoutScroll&&(g.wasRoot&&Vn(c,i),Zc(c.x,g.offset.x),Zc(c.y,g.offset.y))}return c}applyTransform(i,o=!1){const c=Pa();Vn(c,i);for(let x=0;x<this.path.length;x++){const j=this.path[x];!o&&j.options.layoutScroll&&j.scroll&&j!==j.root&&eu(c,{x:-j.scroll.offset.x,y:-j.scroll.offset.y}),Nd(j.latestValues)&&eu(c,j.latestValues)}return Nd(this.latestValues)&&eu(c,this.latestValues),c}removeTransform(i){const o=Pa();Vn(o,i);for(let c=0;c<this.path.length;c++){const x=this.path[c];if(!x.instance||!Nd(x.latestValues))continue;Zj(x.latestValues)&&x.updateSnapshot();const j=Pa(),g=x.measurePageBox();Vn(j,g),$k(o,x.latestValues,x.snapshot?x.snapshot.layoutBox:void 0,j)}return Nd(this.latestValues)&&$k(o,this.latestValues),o}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==jl.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){var o;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const x=!!this.resumingFrom||this!==c;if(!(i||x&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:g,layoutId:y}=this.options;if(!(!this.layout||!(g||y))){if(this.resolvedRelativeTargetAt=jl.timestamp,!this.targetDelta&&!this.relativeTarget){const $=this.getClosestProjectingParent();$&&$.layout&&this.animationProgress!==1?(this.relativeParent=$,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Pa(),this.relativeTargetOrigin=Pa(),ix(this.relativeTargetOrigin,this.layout.layoutBox,$.layout.layoutBox),Vn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Pa(),this.targetWithTransforms=Pa()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),vL(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Vn(this.target,this.layout.layoutBox),vE(this.target,this.targetDelta)):Vn(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const $=this.getClosestProjectingParent();$&&!!$.resumingFrom==!!this.resumingFrom&&!$.options.layoutScroll&&$.target&&this.animationProgress!==1?(this.relativeParent=$,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Pa(),this.relativeTargetOrigin=Pa(),ix(this.relativeTargetOrigin,this.target,$.target),Vn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}zm&&wd.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Zj(this.parent.latestValues)||fE(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var i;const o=this.getLead(),c=!!this.resumingFrom||this!==o;let x=!0;if((this.isProjectionDirty||!((i=this.parent)===null||i===void 0)&&i.isProjectionDirty)&&(x=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(x=!1),this.resolvedRelativeTargetAt===jl.timestamp&&(x=!1),x)return;const{layout:j,layoutId:g}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(j||g))return;Vn(this.layoutCorrected,this.layout.layoutBox);const y=this.treeScale.x,$=this.treeScale.y;AL(this.layoutCorrected,this.treeScale,this.path,c),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=Pa());const{target:T}=o;if(!T){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(Rk(this.prevProjectionDelta.x,this.projectionDelta.x),Rk(this.prevProjectionDelta.y,this.projectionDelta.y)),rx(this.projectionDelta,this.layoutCorrected,T,this.latestValues),(this.treeScale.x!==y||this.treeScale.y!==$||!_k(this.projectionDelta.x,this.prevProjectionDelta.x)||!_k(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",T)),zm&&wd.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){var o;if((o=this.options.visualElement)===null||o===void 0||o.scheduleRender(),i){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Jc(),this.projectionDelta=Jc(),this.projectionDeltaWithTransform=Jc()}setAnimationOrigin(i,o=!1){const c=this.snapshot,x=c?c.latestValues:{},j={...this.latestValues},g=Jc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const y=Pa(),$=c?c.source:void 0,T=this.layout?this.layout.source:void 0,C=$!==T,W=this.getStack(),L=!W||W.members.length<=1,R=!!(C&&!L&&this.options.crossfade===!0&&!this.path.some(mF));this.animationProgress=0;let F;this.mixTargetDelta=te=>{const oe=te/1e3;zk(g.x,i.x,oe),zk(g.y,i.y,oe),this.setTargetDelta(g),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(ix(y,this.layout.layoutBox,this.relativeParent.layout.layoutBox),uF(this.relativeTarget,this.relativeTargetOrigin,y,oe),F&&KL(this.relativeTarget,F)&&(this.isProjectionDirty=!1),F||(F=Pa()),Vn(F,this.relativeTarget)),C&&(this.animationValues=j,GL(j,x,this.latestValues,oe,R,L)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=oe},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Bo(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Qs.update(()=>{p0.hasAnimatedSinceResize=!0,this.currentAnimation=LL(0,Bk,{...i,onUpdate:o=>{this.mixTargetDelta(o),i.onUpdate&&i.onUpdate(o)},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Bk),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:o,target:c,layout:x,latestValues:j}=i;if(!(!o||!c||!x)){if(this!==i&&this.layout&&x&&EE(this.options.animationType,this.layout.layoutBox,x.layoutBox)){c=this.target||Pa();const g=$n(this.layout.layoutBox.x);c.x.min=i.target.x.min,c.x.max=c.x.min+g;const y=$n(this.layout.layoutBox.y);c.y.min=i.target.y.min,c.y.max=c.y.min+y}Vn(o,c),eu(o,j),rx(this.projectionDeltaWithTransform,this.layoutCorrected,o,j)}}registerSharedNode(i,o){this.sharedNodes.has(i)||this.sharedNodes.set(i,new QL),this.sharedNodes.get(i).add(o);const x=o.options.initialPromotionConfig;o.promote({transition:x?x.transition:void 0,preserveFollowOpacity:x&&x.shouldPreserveFollowOpacity?x.shouldPreserveFollowOpacity(o):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){var i;const{layoutId:o}=this.options;return o?((i=this.getStack())===null||i===void 0?void 0:i.lead)||this:this}getPrevLead(){var i;const{layoutId:o}=this.options;return o?(i=this.getStack())===null||i===void 0?void 0:i.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:o,preserveFollowOpacity:c}={}){const x=this.getStack();x&&x.promote(this,c),i&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let o=!1;const{latestValues:c}=i;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(o=!0),!o)return;const x={};c.z&&vv("z",i,x,this.animationValues);for(let j=0;j<fv.length;j++)vv(`rotate${fv[j]}`,i,x,this.animationValues),vv(`skew${fv[j]}`,i,x,this.animationValues);i.render();for(const j in x)i.setStaticValue(j,x[j]),this.animationValues&&(this.animationValues[j]=x[j]);i.scheduleRender()}getProjectionStyles(i){var o,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return JL;const x={visibility:""},j=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,x.opacity="",x.pointerEvents=m0(i==null?void 0:i.pointerEvents)||"",x.transform=j?j(this.latestValues,""):"none",x;const g=this.getLead();if(!this.projectionDelta||!this.layout||!g.target){const C={};return this.options.layoutId&&(C.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,C.pointerEvents=m0(i==null?void 0:i.pointerEvents)||""),this.hasProjected&&!Nd(this.latestValues)&&(C.transform=j?j({},""):"none",this.hasProjected=!1),C}const y=g.animationValues||g.latestValues;this.applyTransformsToTarget(),x.transform=YL(this.projectionDeltaWithTransform,this.treeScale,y),j&&(x.transform=j(y,x.transform));const{x:$,y:T}=this.projectionDelta;x.transformOrigin=`${$.origin*100}% ${T.origin*100}% 0`,g.animationValues?x.opacity=g===this?(c=(o=y.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:y.opacityExit:x.opacity=g===this?y.opacity!==void 0?y.opacity:"":y.opacityExit!==void 0?y.opacityExit:0;for(const C in eg){if(y[C]===void 0)continue;const{correct:W,applyTo:L}=eg[C],R=x.transform==="none"?y[C]:W(y[C],g);if(L){const F=L.length;for(let te=0;te<F;te++)x[L[te]]=R}else x[C]=R}return this.options.layoutId&&(x.pointerEvents=g===this?m0(i==null?void 0:i.pointerEvents)||"":"none"),x}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>{var o;return(o=i.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(Gk),this.root.sharedNodes.clear()}}}function eF(t){t.updateLayout()}function tF(t){var s;const a=((s=t.resumeFrom)===null||s===void 0?void 0:s.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&a&&t.hasListeners("didUpdate")){const{layoutBox:l,measuredBox:n}=t.layout,{animationType:r}=t.options,i=a.source!==t.layout.source;r==="size"?Xn(g=>{const y=i?a.measuredBox[g]:a.layoutBox[g],$=$n(y);y.min=l[g].min,y.max=y.min+$}):EE(r,a.layoutBox,l)&&Xn(g=>{const y=i?a.measuredBox[g]:a.layoutBox[g],$=$n(l[g]);y.max=y.min+$,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[g].max=t.relativeTarget[g].min+$)});const o=Jc();rx(o,l,a.layoutBox);const c=Jc();i?rx(c,t.applyTransform(n,!0),a.measuredBox):rx(c,l,a.layoutBox);const x=!kE(o);let j=!1;if(!t.resumeFrom){const g=t.getClosestProjectingParent();if(g&&!g.resumeFrom){const{snapshot:y,layout:$}=g;if(y&&$){const T=Pa();ix(T,a.layoutBox,y.layoutBox);const C=Pa();ix(C,l,$.layoutBox),CE(T,C)||(j=!0),g.options.layoutRoot&&(t.relativeTarget=C,t.relativeTargetOrigin=T,t.relativeParent=g)}}}t.notifyListeners("didUpdate",{layout:l,snapshot:a,delta:c,layoutDelta:o,hasLayoutChanged:x,hasRelativeTargetChanged:j})}else if(t.isLead()){const{onExitComplete:l}=t.options;l&&l()}t.options.transition=void 0}function sF(t){zm&&wd.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function aF(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function lF(t){t.clearSnapshot()}function Gk(t){t.clearMeasurements()}function nF(t){t.isLayoutDirty=!1}function rF(t){const{visualElement:s}=t.options;s&&s.getProps().onBeforeLayoutMeasure&&s.notify("BeforeLayoutMeasure"),t.resetTransform()}function qk(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function iF(t){t.resolveTargetDelta()}function oF(t){t.calcProjection()}function dF(t){t.resetSkewAndRotation()}function cF(t){t.removeLeadSnapshot()}function zk(t,s,a){t.translate=ua(s.translate,0,a),t.scale=ua(s.scale,1,a),t.origin=s.origin,t.originPoint=s.originPoint}function Wk(t,s,a,l){t.min=ua(s.min,a.min,l),t.max=ua(s.max,a.max,l)}function uF(t,s,a,l){Wk(t.x,s.x,a.x,l),Wk(t.y,s.y,a.y,l)}function mF(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const xF={duration:.45,ease:[.4,0,.1,1]},Hk=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),Xk=Hk("applewebkit/")&&!Hk("chrome/")?Math.round:Rn;function Kk(t){t.min=Xk(t.min),t.max=Xk(t.max)}function pF(t){Kk(t.x),Kk(t.y)}function EE(t,s,a){return t==="position"||t==="preserve-aspect"&&!fL(Vk(s),Vk(a),.2)}function hF(t){var s;return t!==t.root&&((s=t.scroll)===null||s===void 0?void 0:s.wasRoot)}const gF=AE({attachResizeListener:(t,s)=>zx(t,"resize",s),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),bv={current:void 0},ME=AE({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!bv.current){const t=new gF({});t.mount(window),t.setOptions({layoutScroll:!0}),bv.current=t}return bv.current},resetTransform:(t,s)=>{t.style.transform=s!==void 0?s:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),fF={pan:{Feature:RL},drag:{Feature:TL,ProjectionNode:ME,MeasureLayout:yE}};function Qk(t,s,a){const{props:l}=t;t.animationState&&l.whileHover&&t.animationState.setActive("whileHover",a==="Start");const n="onHover"+a,r=l[n];r&&Qs.postRender(()=>r(s,pp(s)))}class vF extends Qo{mount(){const{current:s}=this.node;s&&(this.unmount=f7(s,a=>(Qk(this.node,a,"Start"),l=>Qk(this.node,l,"End"))))}unmount(){}}class bF extends Qo{constructor(){super(...arguments),this.isActive=!1}onFocus(){let s=!1;try{s=this.node.current.matches(":focus-visible")}catch{s=!0}!s||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=xp(zx(this.node.current,"focus",()=>this.onFocus()),zx(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Yk(t,s,a){const{props:l}=t;t.animationState&&l.whileTap&&t.animationState.setActive("whileTap",a==="Start");const n="onTap"+(a==="End"?"":a),r=l[n];r&&Qs.postRender(()=>r(s,pp(s)))}class jF extends Qo{mount(){const{current:s}=this.node;s&&(this.unmount=y7(s,a=>(Yk(this.node,a,"Start"),(l,{success:n})=>Yk(this.node,l,n?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const ty=new WeakMap,jv=new WeakMap,yF=t=>{const s=ty.get(t.target);s&&s(t)},NF=t=>{t.forEach(yF)};function wF({root:t,...s}){const a=t||document;jv.has(a)||jv.set(a,{});const l=jv.get(a),n=JSON.stringify(s);return l[n]||(l[n]=new IntersectionObserver(NF,{root:t,...s})),l[n]}function kF(t,s,a){const l=wF(s);return ty.set(t,a),l.observe(t),()=>{ty.delete(t),l.unobserve(t)}}const CF={some:0,all:1};class SF extends Qo{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:s={}}=this.node.getProps(),{root:a,margin:l,amount:n="some",once:r}=s,i={root:a?a.current:void 0,rootMargin:l,threshold:typeof n=="number"?n:CF[n]},o=c=>{const{isIntersecting:x}=c;if(this.isInView===x||(this.isInView=x,r&&!x&&this.hasEnteredView))return;x&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",x);const{onViewportEnter:j,onViewportLeave:g}=this.node.getProps(),y=x?j:g;y&&y(c)};return kF(this.node.current,i,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:s,prevProps:a}=this.node;["amount","margin","root"].some(AF(s,a))&&this.startObserver()}unmount(){}}function AF({viewport:t={}},{viewport:s={}}={}){return a=>t[a]!==s[a]}const EF={inView:{Feature:SF},tap:{Feature:jF},focus:{Feature:bF},hover:{Feature:vF}},MF={layout:{ProjectionNode:ME,MeasureLayout:yE}},sy={current:null},PE={current:!1};function PF(){if(PE.current=!0,!!GN)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),s=()=>sy.current=t.matches;t.addListener(s),s()}else sy.current=!1}const OF=[...tE,Dl,Go],TF=t=>OF.find(eE(t)),Jk=new WeakMap;function RF(t,s,a){for(const l in s){const n=s[l],r=a[l];if(Ll(n))t.addValue(l,n);else if(Ll(r))t.addValue(l,Gx(n,{owner:t}));else if(r!==n)if(t.hasValue(l)){const i=t.getValue(l);i.liveStyle===!0?i.jump(n):i.hasAnimated||i.set(n)}else{const i=t.getStaticValue(l);t.addValue(l,Gx(i!==void 0?i:n,{owner:t}))}}for(const l in a)s[l]===void 0&&t.removeValue(l);return s}const Zk=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class DF{scrapeMotionValuesFromProps(s,a,l){return{}}constructor({parent:s,props:a,presenceContext:l,reducedMotionConfig:n,blockInitialAnimation:r,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=gw,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const $=li.now();this.renderScheduledAt<$&&(this.renderScheduledAt=$,Qs.render(this.render,!1,!0))};const{latestValues:c,renderState:x,onUpdate:j}=i;this.onUpdate=j,this.latestValues=c,this.baseTarget={...c},this.initialValues=a.initial?{...c}:{},this.renderState=x,this.parent=s,this.props=a,this.presenceContext=l,this.depth=s?s.depth+1:0,this.reducedMotionConfig=n,this.options=o,this.blockInitialAnimation=!!r,this.isControllingVariants=wf(a),this.isVariantNode=dA(a),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(s&&s.current);const{willChange:g,...y}=this.scrapeMotionValuesFromProps(a,{},this);for(const $ in y){const T=y[$];c[$]!==void 0&&Ll(T)&&T.set(c[$],!1)}}mount(s){this.current=s,Jk.set(s,this),this.projection&&!this.projection.instance&&this.projection.mount(s),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((a,l)=>this.bindToMotionValue(l,a)),PE.current||PF(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:sy.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){Jk.delete(this.current),this.projection&&this.projection.unmount(),Bo(this.notifyUpdate),Bo(this.render),this.valueSubscriptions.forEach(s=>s()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const s in this.events)this.events[s].clear();for(const s in this.features){const a=this.features[s];a&&(a.unmount(),a.isMounted=!1)}this.current=null}bindToMotionValue(s,a){this.valueSubscriptions.has(s)&&this.valueSubscriptions.get(s)();const l=Qd.has(s),n=a.on("change",o=>{this.latestValues[s]=o,this.props.onUpdate&&Qs.preRender(this.notifyUpdate),l&&this.projection&&(this.projection.isTransformDirty=!0)}),r=a.on("renderRequest",this.scheduleRender);let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,s,a)),this.valueSubscriptions.set(s,()=>{n(),r(),i&&i(),a.owner&&a.stop()})}sortNodePosition(s){return!this.current||!this.sortInstanceNodePosition||this.type!==s.type?0:this.sortInstanceNodePosition(this.current,s.current)}updateFeatures(){let s="animation";for(s in ku){const a=ku[s];if(!a)continue;const{isEnabled:l,Feature:n}=a;if(!this.features[s]&&n&&l(this.props)&&(this.features[s]=new n(this)),this.features[s]){const r=this.features[s];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Pa()}getStaticValue(s){return this.latestValues[s]}setStaticValue(s,a){this.latestValues[s]=a}update(s,a){(s.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=s,this.prevPresenceContext=this.presenceContext,this.presenceContext=a;for(let l=0;l<Zk.length;l++){const n=Zk[l];this.propEventSubscriptions[n]&&(this.propEventSubscriptions[n](),delete this.propEventSubscriptions[n]);const r="on"+n,i=s[r];i&&(this.propEventSubscriptions[n]=this.on(n,i))}this.prevMotionValues=RF(this,this.scrapeMotionValuesFromProps(s,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(s){return this.props.variants?this.props.variants[s]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(s){const a=this.getClosestVariantNode();if(a)return a.variantChildren&&a.variantChildren.add(s),()=>a.variantChildren.delete(s)}addValue(s,a){const l=this.values.get(s);a!==l&&(l&&this.removeValue(s),this.bindToMotionValue(s,a),this.values.set(s,a),this.latestValues[s]=a.get())}removeValue(s){this.values.delete(s);const a=this.valueSubscriptions.get(s);a&&(a(),this.valueSubscriptions.delete(s)),delete this.latestValues[s],this.removeValueFromRenderState(s,this.renderState)}hasValue(s){return this.values.has(s)}getValue(s,a){if(this.props.values&&this.props.values[s])return this.props.values[s];let l=this.values.get(s);return l===void 0&&a!==void 0&&(l=Gx(a===null?void 0:a,{owner:this}),this.addValue(s,l)),l}readValue(s,a){var l;let n=this.latestValues[s]!==void 0||!this.current?this.latestValues[s]:(l=this.getBaseTargetFromProps(this.props,s))!==null&&l!==void 0?l:this.readValueFromInstance(this.current,s,this.options);return n!=null&&(typeof n=="string"&&(JA(n)||GA(n))?n=parseFloat(n):!TF(n)&&Go.test(a)&&(n=KA(s,a)),this.setBaseTarget(s,Ll(n)?n.get():n)),Ll(n)?n.get():n}setBaseTarget(s,a){this.baseTarget[s]=a}getBaseTarget(s){var a;const{initial:l}=this.props;let n;if(typeof l=="string"||typeof l=="object"){const i=QN(this.props,l,(a=this.presenceContext)===null||a===void 0?void 0:a.custom);i&&(n=i[s])}if(l&&n!==void 0)return n;const r=this.getBaseTargetFromProps(this.props,s);return r!==void 0&&!Ll(r)?r:this.initialValues[s]!==void 0&&n===void 0?void 0:this.baseTarget[s]}on(s,a){return this.events[s]||(this.events[s]=new cw),this.events[s].add(a)}notify(s,...a){this.events[s]&&this.events[s].notify(...a)}}class OE extends DF{constructor(){super(...arguments),this.KeyframeResolver=sE}sortInstanceNodePosition(s,a){return s.compareDocumentPosition(a)&2?1:-1}getBaseTargetFromProps(s,a){return s.style?s.style[a]:void 0}removeValueFromRenderState(s,{vars:a,style:l}){delete a[s],delete l[s]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:s}=this.props;Ll(s)&&(this.childSubscription=s.on("change",a=>{this.current&&(this.current.textContent=`${a}`)}))}}function IF(t){return window.getComputedStyle(t)}class $F extends OE{constructor(){super(...arguments),this.type="html",this.renderInstance=vA}readValueFromInstance(s,a){if(Qd.has(a)){const l=hw(a);return l&&l.default||0}else{const l=IF(s),n=(hA(a)?l.getPropertyValue(a):l[a])||0;return typeof n=="string"?n.trim():n}}measureInstanceViewportBox(s,{transformPagePoint:a}){return bE(s,a)}build(s,a,l){ZN(s,a,l.transformTemplate)}scrapeMotionValuesFromProps(s,a,l){return aw(s,a,l)}}class LF extends OE{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Pa}getBaseTargetFromProps(s,a){return s[a]}readValueFromInstance(s,a){if(Qd.has(a)){const l=hw(a);return l&&l.default||0}return a=bA.has(a)?a:HN(a),s.getAttribute(a)}scrapeMotionValuesFromProps(s,a,l){return NA(s,a,l)}build(s,a,l){ew(s,a,this.isSVGTag,l.transformTemplate)}renderInstance(s,a,l,n){jA(s,a,l,n)}mount(s){this.isSVGTag=sw(s.tagName),super.mount(s)}}const FF=(t,s)=>KN(t)?new LF(s):new $F(s,{allowProjection:t!==d.Fragment}),UF=c7({...oL,...EF,...fF,...MF},FF),qe=C$(UF);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VF=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),TE=(...t)=>t.filter((s,a,l)=>!!s&&s.trim()!==""&&l.indexOf(s)===a).join(" ").trim();/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var _F={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BF=d.forwardRef(({color:t="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:l,className:n="",children:r,iconNode:i,...o},c)=>d.createElement("svg",{ref:c,..._F,width:s,height:s,stroke:t,strokeWidth:l?Number(a)*24/Number(s):a,className:TE("lucide",n),...o},[...i.map(([x,j])=>d.createElement(x,j)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=(t,s)=>{const a=d.forwardRef(({className:l,...n},r)=>d.createElement(BF,{ref:r,iconNode:s,className:TE(`lucide-${VF(t)}`,l),...n}));return a.displayName=`${t}`,a};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RE=Ze("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e4=Ze("ArrowDownLeft",[["path",{d:"M17 7 7 17",key:"15tmo1"}],["path",{d:"M17 17H7V7",key:"1org7z"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _p=Ze("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=Ze("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wm=Ze("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yv=Ze("BatteryCharging",[["path",{d:"M15 7h1a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2h-2",key:"1sdynx"}],["path",{d:"M6 7H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h1",key:"1gkd3k"}],["path",{d:"m11 7-3 5h4l-3 5",key:"b4a64w"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GF=Ze("Battery",[["rect",{width:"16",height:"10",x:"2",y:"7",rx:"2",ry:"2",key:"1w10f2"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fo=Ze("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nv=Ze("BookMarked",[["path",{d:"M10 2v8l3-3 3 3V2",key:"sqw3rj"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xl=Ze("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dn=Ze("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.3V14",key:"akvzfd"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qF=Ze("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zF=Ze("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WF=Ze("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Er=Ze("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zd=Ze("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=Ze("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ni=Ze("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HF=Ze("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=Ze("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XF=Ze("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rg=Ze("CircleDollarSign",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 18V6",key:"zqpxq5"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fu=Ze("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ig=Ze("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h0=Ze("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KF=Ze("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bp=Ze("Command",[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3",key:"11bfej"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=Ze("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lc=Ze("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qr=Ze("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zi=Ze("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=Ze("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=Ze("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QF=Ze("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ay=Ze("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YF=Ze("FileCheck2",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m3 15 2 2 4-4",key:"1lhrkk"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JF=Ze("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kt=Ze("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vn=Ze("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Su=Ze("Fingerprint",[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wv=Ze("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Co=Ze("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $i=Ze("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZF=Ze("Group",[["path",{d:"M3 7V5c0-1.1.9-2 2-2h2",key:"adw53z"}],["path",{d:"M17 3h2c1.1 0 2 .9 2 2v2",key:"an4l38"}],["path",{d:"M21 17v2c0 1.1-.9 2-2 2h-2",key:"144t0e"}],["path",{d:"M7 21H5c-1.1 0-2-.9-2-2v-2",key:"rtnfgi"}],["rect",{width:"7",height:"5",x:"7",y:"7",rx:"1",key:"1eyiv7"}],["rect",{width:"7",height:"5",x:"10",y:"12",rx:"1",key:"1qlmkx"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jw=Ze("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mu=Ze("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eU=Ze("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const en=Ze("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xu=Ze("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kd=Ze("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const og=Ze("Laptop",[["path",{d:"M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9m16 0H4m16 0 1.28 2.55a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45L4 16",key:"tarvll"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const La=Ze("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ly=Ze("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fd=Ze("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ny=Ze("LifeBuoy",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ud=Ze("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t4=Ze("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const So=Ze("LockOpen",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=Ze("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jo=Ze("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=Ze("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wx=Ze("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ry=Ze("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DE=Ze("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yi=Ze("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g0=Ze("MessagesSquare",[["path",{d:"M14 9a2 2 0 0 1-2 2H6l-4 4V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2z",key:"p1xzt8"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v11l-4-4h-6a2 2 0 0 1-2-2v-1",key:"1cx29u"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tU=Ze("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yw=Ze("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s4=Ze("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nw=Ze("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sU=Ze("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uo=Ze("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gp=Ze("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ox=Ze("PiggyBank",[["path",{d:"M19 5c-1.5 0-2.8 1.4-3 2-3.5-1.5-11-.3-11 5 0 1.8 0 3 2 4.5V20h4v-2h3v2h4v-4c1-.5 1.7-1 2-2h2v-4h-2c0-1-.5-1.5-1-2V5z",key:"1ivx2i"}],["path",{d:"M2 9v1c0 1.1.9 2 2 2h1",key:"nm575m"}],["path",{d:"M16 11h.01",key:"xkw8gn"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qp=Ze("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=Ze("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=Ze("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IE=Ze("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kv=Ze("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Da=Ze("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=Ze("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kl=Ze("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ni=Ze("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hm=Ze("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ao=Ze("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=Ze("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a4=Ze("Siren",[["path",{d:"M7 18v-6a5 5 0 1 1 10 0v6",key:"pcx96s"}],["path",{d:"M5 21a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-1a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2z",key:"1b4s83"}],["path",{d:"M21 12h1",key:"jtio3y"}],["path",{d:"M18.5 4.5 18 5",key:"g5sp9y"}],["path",{d:"M2 12h1",key:"1uaihz"}],["path",{d:"M12 2v1",key:"11qlp1"}],["path",{d:"m4.929 4.929.707.707",key:"1i51kw"}],["path",{d:"M12 12v6",key:"3ahymv"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aU=Ze("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ww=Ze("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=Ze("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lU=Ze("Split",[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M8 3H3v5",key:"15dfkv"}],["path",{d:"M12 22v-8.3a4 4 0 0 0-1.172-2.872L3 3",key:"1qrqzj"}],["path",{d:"m15 9 6-6",key:"ko1vev"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Il=Ze("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kw=Ze("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12a2 2 0 0 1-2-2V7",key:"6c3vgh"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nU=Ze("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iy=Ze("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tu=Ze("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ri=Ze("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sl=Ze("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=Ze("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $E=Ze("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=Ze("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dg=Ze("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cv=Ze("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dx=Ze("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=Ze("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sv=Ze("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ia=Ze("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l4=Ze("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LE=Ze("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=Ze("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hx=Ze("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),Nr={green:"#03CD8C",orange:"#F77F00"};function Wd(...t){return t.filter(Boolean).join(" ")}function n4(t,s,a="text/plain"){const l=new Blob([s],{type:a}),n=URL.createObjectURL(l),r=document.createElement("a");r.href=n,r.download=t,r.click(),URL.revokeObjectURL(n)}function sa({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",accent:"bg-orange-50 text-orange-800 ring-orange-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Wd("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function _n({variant:t="outline",className:s,children:a,onClick:l,href:n}){const r="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",i={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200"},o=t==="primary"?{background:Nr.green}:t==="accent"?{background:Nr.orange}:void 0;return n?e.jsx("a",{href:n,onClick:c=>{l&&(c.preventDefault(),l())},className:Wd(r,i[t],s),style:o,children:a}):e.jsx("button",{type:"button",onClick:l,className:Wd(r,i[t],s),style:o,children:a})}function Wi({id:t,eyebrow:s,title:a,subtitle:l,right:n,children:r}){return e.jsxs("section",{id:t,className:"scroll-mt-28",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between",children:[e.jsxs("div",{children:[s?e.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:s}):null,e.jsx("h2",{className:"mt-2 text-2xl font-semibold tracking-tight text-slate-900 md:text-3xl",children:a}),l?e.jsx("p",{className:"mt-2 max-w-3xl text-sm text-slate-600 md:text-base",children:l}):null]}),n]}),e.jsx("div",{className:"mt-6",children:r})]})}function Ul({icon:t,title:s,desc:a,chips:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl bg-emerald-50 text-emerald-700",children:t}),l!=null&&l.length?e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:l.map(n=>e.jsx(sa,{label:n.label,tone:n.tone},n.label))}):null]}),e.jsx("div",{className:"mt-4 text-base font-semibold text-slate-900",children:s}),e.jsx("div",{className:"mt-2 text-sm text-slate-600",children:a})]})}function zp({value:t,label:s}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsx("div",{className:"text-2xl font-semibold tracking-tight text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s})]})}function rU({active:t,onJump:s}){const a=[{k:"product",label:"Product"},{k:"solutions",label:"Solutions"},{k:"how",label:"How it works"},{k:"modules",label:"Modules"},{k:"security",label:"Security"},{k:"integrations",label:"Integrations"},{k:"esg",label:"ESG"},{k:"faq",label:"FAQ"}];return e.jsx("nav",{className:"hidden items-center gap-1 lg:flex",children:a.map(l=>e.jsx("button",{type:"button",onClick:()=>s(l.k),className:Wd("rounded-full px-3 py-2 text-sm font-semibold ring-1 transition",t===l.k?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:t===l.k?{background:Nr.green}:void 0,children:l.label},l.k))})}function iU({items:t}){const[s,a]=d.useState(0);return e.jsx("div",{className:"space-y-2",children:t.map((l,n)=>{const r=s===n;return e.jsxs("div",{className:"overflow-hidden rounded-3xl border border-slate-200 bg-white",children:[e.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 px-5 py-4 text-left hover:bg-slate-50",onClick:()=>a(r?-1:n),children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:l.q}),e.jsx(ni,{className:Wd("h-5 w-5 text-slate-500 transition",r?"rotate-180":"rotate-0")})]}),e.jsx(lt,{initial:!1,children:r?e.jsx(qe.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.18},children:e.jsx("div",{className:"border-t border-slate-200 px-5 py-4 text-sm text-slate-700",children:l.a})}):null})]},l.q)})})}function oU(){const t=Kd(),s=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],a=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],l=[{q:"Do employees need a separate CorporatePay app?",a:"No. Employees use the normal EVzone user apps. At checkout, CorporatePay appears as a payment option when they are linked to an organization and eligible under policy."},{q:"How do approvals work?",a:"Approvals can be auto-approved under thresholds (when allowed), or routed to multi-level approvers based on amount, module, marketplace, vendor, or risk. Decisions are fully audited."},{q:"Can we buy high-value assets that exceed monthly budgets?",a:"Yes. Use RFQ/Quote Requests to request supplier quotes, compare offers, and convert to a purchase order. CapEx vs OpEx and milestone payments can be configured."},{q:"What payment models are supported?",a:"Three models: Pay-as-you-go through the corporate wallet, Credit line with a limit, and Prepaid deposit where services stop when the balance is depleted."},{q:"Can we export to our ERP?",a:"Yes. Export CSV/JSON or connect via secure APIs and webhooks (invoice created/paid, approval completed, limit breached)."},{q:"How is EVzone Support handled?",a:"Support is embedded as a role in your console. Support sessions are visible, watermarked, and auditable. No silent actions. Optional session recording is policy-controlled."}],[n,r]=d.useState(!1),[i,o]=d.useState("product"),[c,x]=d.useState({org:"",name:"",email:"",phone:"",note:""}),[j,g]=d.useState(!1),y=T=>{r(!1),o(T);const C=document.getElementById(T);C&&C.scrollIntoView({behavior:"smooth",block:"start"})};d.useEffect(()=>{const T=["product","solutions","how","modules","security","integrations","esg","faq"],C=()=>{const W=window.scrollY,L=T.map(F=>{const te=document.getElementById(F);if(!te)return null;const oe=te.getBoundingClientRect().top+window.scrollY;return{id:F,top:oe}}).filter(Boolean);let R="product";for(const F of L)W+160>=F.top&&(R=F.id);o(R)};return window.addEventListener("scroll",C,{passive:!0}),C(),()=>window.removeEventListener("scroll",C)},[]);const $=()=>{!c.org.trim()||!c.name.trim()||!/\S+@\S+\.\S+/.test(c.email)||g(!0)};return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsxs("header",{className:"sticky top-0 z-30 border-b border-slate-200 bg-white/80 backdrop-blur",children:[e.jsxs("div",{className:"mx-auto flex max-w-[1200px] items-center justify-between gap-3 px-4 py-3 md:px-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl text-white",style:{background:Nr.green},children:e.jsx(ht,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"CorporatePay"}),e.jsx("div",{className:"text-xs text-slate-500",children:"EVzone corporate admin console"})]})]}),e.jsx(rU,{active:i,onJump:y}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"hidden items-center gap-2 lg:flex",children:[e.jsxs(_n,{variant:"primary",onClick:()=>y("faq"),children:[e.jsx(kv,{className:"h-4 w-4"})," Request demo"]}),e.jsxs(_n,{variant:"outline",onClick:()=>{n4("corporatepay-one-pager.txt","CorporatePay one-pager (demo).","text/plain")},children:[e.jsx(pt,{className:"h-4 w-4"})," Download one-pager"]}),e.jsxs(_n,{variant:"ghost",onClick:()=>y("how"),children:[e.jsx(et,{className:"h-4 w-4"})," How it works"]}),e.jsx("button",{type:"button",onClick:()=>t(is.CONSOLE.DASHBOARD),className:"ml-1 text-xs font-semibold text-slate-600 underline-offset-4 hover:text-slate-900 hover:underline",children:"Already a customer? Launch console"})]}),e.jsx("button",{type:"button",className:"rounded-2xl border border-slate-200 bg-white p-2 text-slate-800 shadow-sm hover:bg-slate-50 lg:hidden",onClick:()=>r(T=>!T),"aria-label":"Open menu",children:n?e.jsx(Qe,{className:"h-5 w-5"}):e.jsx(ry,{className:"h-5 w-5"})})]})]}),e.jsx(lt,{children:n?e.jsx(qe.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.18},className:"border-t border-slate-200 bg-white lg:hidden",children:e.jsx("div",{className:"mx-auto max-w-[1200px] px-4 py-3 md:px-6",children:e.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{k:"product",label:"Product"},{k:"solutions",label:"Solutions"},{k:"how",label:"How it works"},{k:"modules",label:"Modules"},{k:"security",label:"Security"},{k:"integrations",label:"Integrations"},{k:"esg",label:"ESG"},{k:"faq",label:"FAQ"}].map(T=>e.jsx("button",{type:"button",onClick:()=>y(T.k),className:Wd("rounded-2xl border px-3 py-3 text-left text-sm font-semibold",i===T.k?"border-emerald-300 bg-emerald-50 text-emerald-800":"border-slate-200 bg-white text-slate-700 hover:bg-slate-50"),children:T.label},T.k))})})}):null})]}),e.jsxs("main",{children:[e.jsx("div",{className:"mx-auto max-w-[1200px] px-4 py-10 md:px-6 md:py-14",children:e.jsxs("div",{className:"grid grid-cols-1 gap-8 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-7",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(sa,{label:"Approvals-first",tone:"info"}),e.jsx(sa,{label:"Budget enforcement",tone:"good"}),e.jsx(sa,{label:"ERP-ready",tone:"neutral"}),e.jsx(sa,{label:"SSO-ready (coming soon)",tone:"neutral"})]}),e.jsxs("h1",{className:"mt-5 text-3xl font-semibold tracking-tight text-slate-900 md:text-5xl",children:["Approve, budget and invoice EVzone spend",e.jsx("span",{className:"text-emerald-700",children:" without slowing teams down"}),"."]}),e.jsx("p",{className:"mt-4 max-w-2xl text-base text-slate-600 md:text-lg",children:"CorporatePay centralizes budgets, approvals, invoicing and policy enforcement across the EVzone Super App, while employees keep using the standard EVzone apps."}),e.jsxs("ul",{className:"mt-4 max-w-2xl space-y-2 text-sm text-slate-700 md:text-base",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:Nr.green}}),e.jsx("span",{children:"Budgets by org/team/user + hard/soft caps"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:Nr.green}}),e.jsx("span",{children:"Multi-level approvals with audit trails"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:Nr.green}}),e.jsx("span",{children:"Invoicing + policy enforcement across EVzone spending groups + ERP exports"})]})]}),e.jsxs("div",{className:"mt-6 flex flex-col gap-2 sm:flex-row sm:items-center",children:[e.jsxs(_n,{variant:"primary",onClick:()=>y("faq"),children:[e.jsx(kv,{className:"h-4 w-4"})," Request demo"]}),e.jsxs(_n,{variant:"outline",onClick:()=>{n4("corporatepay-one-pager.txt","CorporatePay one-pager (demo).","text/plain")},children:[e.jsx(pt,{className:"h-4 w-4"})," Download one-pager"]}),e.jsxs(_n,{variant:"ghost",onClick:()=>y("how"),children:[e.jsx(et,{className:"h-4 w-4"})," How it works"]})]}),e.jsx("div",{className:"mt-3 text-sm text-slate-600",children:e.jsx("button",{type:"button",onClick:()=>t(is.CONSOLE.DASHBOARD),className:"font-semibold text-slate-700 underline-offset-4 hover:text-slate-900 hover:underline",children:"Already a customer? Launch console"})}),e.jsxs("div",{className:"mt-7 grid grid-cols-2 gap-3 md:grid-cols-4",children:[e.jsx(zp,{value:"3",label:"Payment models"}),e.jsx(zp,{value:"Daily",label:"Invoice options"}),e.jsx(zp,{value:"4",label:"Alert channels"}),e.jsx(zp,{value:"Audit",label:"Every action"})]}),e.jsx("div",{className:"mt-6 rounded-3xl border border-amber-200 bg-amber-50 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-white text-amber-800 ring-1 ring-amber-200",children:e.jsx(ct,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Best for organizations without fleets"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:"Hospitals, tour companies, and corporates can run company-paid mobility and procurement without owning vehicles."})]})]})})]}),e.jsx("div",{className:"lg:col-span-5",children:e.jsxs("div",{className:"relative overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsx("div",{className:"border-b border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"grid h-9 w-9 place-items-center rounded-2xl bg-emerald-50 text-emerald-700",children:e.jsx(ly,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Admin console preview"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Budgets  Approvals  Invoices"})]})]}),e.jsx(sa,{label:"Live",tone:"good"})]})}),e.jsxs("div",{className:"bg-slate-50 p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx(em,{icon:e.jsx(Ia,{className:"h-4 w-4"}),title:"Wallet + Credit + Prepaid",value:"Payment models"}),e.jsx(em,{icon:e.jsx(ig,{className:"h-4 w-4"}),title:"Approval workflows",value:"Auto + multi-level"}),e.jsx(em,{icon:e.jsx(kt,{className:"h-4 w-4"}),title:"Invoices",value:"Daily/Weekly/Monthly"}),e.jsx(em,{icon:e.jsx(Co,{className:"h-4 w-4"}),title:"Webhooks",value:"Invoice/Approvals/Limits"}),e.jsx(em,{icon:e.jsx(Ao,{className:"h-4 w-4"}),title:"Audit + Compliance",value:"Forensic exports"})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Go-live readiness"}),e.jsx("div",{className:"mt-1 text-lg font-semibold text-slate-900",children:"92%"})]}),e.jsx("div",{className:"h-2 w-28 overflow-hidden rounded-full bg-slate-100",children:e.jsx("div",{className:"h-full rounded-full",style:{width:"92%",background:Nr.green}})})]}),e.jsx("div",{className:"mt-3 text-xs text-slate-600",children:"Finish invoice group routing to unlock full automation."})]})]}),e.jsx("div",{className:"absolute -right-20 -top-24 h-72 w-72 rounded-full",style:{background:"rgba(3,205,140,0.18)"}}),e.jsx("div",{className:"absolute -bottom-24 -left-24 h-72 w-72 rounded-full",style:{background:"rgba(247,127,0,0.14)"}})]})})]})}),e.jsxs("div",{className:"mx-auto max-w-[1200px] px-4 pb-10 md:px-6 md:pb-14",children:[e.jsxs(Wi,{id:"product",eyebrow:"Product",title:"A single corporate control plane for EVzone",subtitle:"CorporatePay centralizes financial controls, policies, and approvals across rides, services, marketplaces, and high-value procurement.",right:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(sa,{label:"Role-based",tone:"neutral"}),e.jsx(sa,{label:"Audit-ready",tone:"info"}),e.jsx(sa,{label:"Policy-driven",tone:"good"})]}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(Ul,{icon:e.jsx(ig,{className:"h-6 w-6"}),title:"Approvals that scale",desc:"Auto-approve under thresholds (where allowed) and route higher-risk actions to multi-level approvers. All decisions are auditable.",chips:[{label:"Core",tone:"neutral"},{label:"SLA timers",tone:"info"}]}),e.jsx(Ul,{icon:e.jsx(Ia,{className:"h-6 w-6"}),title:"Budgets and spend controls",desc:"Org, group, user, module, and marketplace budgets. Hard vs soft caps, alerts, forecasting, and emergency exceptions.",chips:[{label:"Core",tone:"neutral"},{label:"Forecasting",tone:"info"}]}),e.jsx(Ul,{icon:e.jsx(kt,{className:"h-6 w-6"}),title:"Invoicing and reconciliation",desc:"Daily, weekly, monthly invoicing. Invoice groups for AP routing. Exports for ERP reconciliation with audit trails.",chips:[{label:"Core",tone:"neutral"},{label:"ERP-ready",tone:"neutral"}]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(Ul,{icon:e.jsx(yw,{className:"h-6 w-6"}),title:"RFQ for high-value assets",desc:"Request quotes for assets that exceed monthly budgets. Compare offers, convert to purchase orders, and manage milestone payments.",chips:[{label:"Core",tone:"neutral"},{label:"CapEx",tone:"info"}]}),e.jsx(Ul,{icon:e.jsx(g0,{className:"h-6 w-6"}),title:"Multi-channel reminders",desc:"Automated notifications for due invoices, overdue status, pending approvals, and limit breaches via Email, WhatsApp, WeChat, and SMS.",chips:[{label:"Core",tone:"neutral"},{label:"Delivery logs",tone:"info"}]}),e.jsx(Ul,{icon:e.jsx(Ao,{className:"h-6 w-6"}),title:"Security and compliance",desc:"Audit logs for every action, MFA policies, device trust, support mode gating, dual control, and forensic exports.",chips:[{label:"Core",tone:"neutral"},{label:"Forensics",tone:"info"}]})]})]}),e.jsx("div",{className:"mt-12",children:e.jsx(Wi,{id:"solutions",eyebrow:"Solutions",title:"Built for corporates, hospitals, and tour companies",subtitle:"Use the same control plane across industries, while applying policy templates and risk controls per program.",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(Av,{title:"Corporate",icon:e.jsx(Xl,{className:"h-5 w-5"}),bullets:["Group budgets and chargeback","Procurement approvals","Consolidated invoicing","ERP exports and mapping"]}),e.jsx(Av,{title:"Hospital",icon:e.jsx(Ao,{className:"h-5 w-5"}),bullets:["Stricter approvals and audit","24/7 exceptions","Emergency travel rules","Vendor compliance docs"]}),e.jsx(Av,{title:"Tour company",icon:e.jsx($i,{className:"h-5 w-5"}),bullets:["Airport routes and geo rules","Event manifests","Visitor scheduling","Approved vendor catalogs"]})]})})}),e.jsx("div",{className:"mt-12",children:e.jsx(Wi,{id:"how",eyebrow:"How it works",title:"Employees keep the normal EVzone apps",subtitle:"CorporatePay lives in your web admin console. For employees, CorporatePay appears as a payment option at checkout only when eligible under policy.",right:e.jsxs(_n,{variant:"outline",onClick:()=>y("modules"),children:[e.jsx(et,{className:"h-4 w-4"})," See supported modules"]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-7 space-y-3",children:[e.jsx(Wp,{n:1,title:"Create your organization",desc:"Add entities, billing contacts, invoice groups, and enable modules and marketplaces."}),e.jsx(Wp,{n:2,title:"Invite employees and assign groups",desc:"Assign roles, group membership, cost centers, spend limits, and auto-approval eligibility."}),e.jsx(Wp,{n:3,title:"Define budgets and approval rules",desc:"Set org, group, user, module, and marketplace budgets. Configure approval workflows per module and marketplace."}),e.jsx(Wp,{n:4,title:"Go live",desc:"Employees see CorporatePay at checkout. Invoices run on your chosen schedule and exports are audit-ready."})]}),e.jsx("div",{className:"lg:col-span-5",children:e.jsxs("div",{className:"rounded-[28px] border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Billing models"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Choose per organization"})]}),e.jsx(sa,{label:"Core",tone:"neutral"})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx(Ev,{title:"Pay-as-you-go wallet",desc:"Company-funded wallet used at checkout.",icon:e.jsx(Ia,{className:"h-4 w-4"})}),e.jsx(Ev,{title:"Credit line",desc:"Company credit limit with controls.",icon:e.jsx(Lc,{className:"h-4 w-4"})}),e.jsx(Ev,{title:"Prepaid deposit",desc:"Spend-down balance. Services stop when depleted.",icon:e.jsx(rg,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Invoicing frequency can be daily, weekly, monthly, or custom by invoice group."})]})})]})})}),e.jsx("div",{className:"mt-12",children:e.jsxs(Wi,{id:"modules",eyebrow:"Coverage",title:"Modules and marketplaces supported",subtitle:"CorporatePay can govern spending across service modules and marketplaces, with an expansion slot for future modules and marketplaces.",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-6",children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Service modules"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Enable/disable per org and pilot group"})]}),e.jsx(sa,{label:"Core",tone:"neutral"})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:s.map(T=>e.jsx(sa,{label:T,tone:T==="Other Service Module"?"neutral":"good"},T))})]})}),e.jsx("div",{className:"lg:col-span-6",children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Marketplaces"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Under E-Commerce (including MyLiveDealz)"})]}),e.jsx(sa,{label:"Core",tone:"neutral"})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:a.map(T=>e.jsx(sa,{label:T,tone:T==="MyLiveDealz"?"accent":T==="Other Marketplace"?"neutral":"good"},T))})]})})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"High-value procurement"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"RFQ flow for assets that do not fit within monthly budgets."})]}),e.jsx(sa,{label:"RFQ",tone:"info"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-4",children:[e.jsx(Hp,{n:1,title:"Create RFQ",desc:"Specs, quantities, delivery location"}),e.jsx(Hp,{n:2,title:"Get quotes",desc:"Invite vendors + Q&A thread"}),e.jsx(Hp,{n:3,title:"Compare",desc:"Table view + approvals"}),e.jsx(Hp,{n:4,title:"Convert",desc:"PO  invoice  payments"})]})]})]})}),e.jsx("div",{className:"mt-12",children:e.jsxs(Wi,{id:"security",eyebrow:"Trust & security",title:"Trust & security highlights",subtitle:"Enterprise controls designed for governance, auditability, and integrations.",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(Ul,{icon:e.jsx(Ao,{className:"h-6 w-6"}),title:"Audit-ready",desc:"Immutable logs + exports.",chips:[{label:"Audit-ready",tone:"info"}]}),e.jsx(Ul,{icon:e.jsx(Os,{className:"h-6 w-6"}),title:"Role-based access",desc:"Admins, approvers, viewers.",chips:[{label:"RBAC",tone:"neutral"}]}),e.jsx(Ul,{icon:e.jsx(Co,{className:"h-6 w-6"}),title:"Integrations",desc:"ERP export + webhooks.",chips:[{label:"ERP",tone:"neutral"},{label:"Webhooks",tone:"info"}]})]}),e.jsxs("div",{className:"mt-5 flex flex-wrap items-center gap-2",children:[e.jsxs(_n,{variant:"outline",onClick:()=>t("/console/security"),children:[e.jsx(kt,{className:"h-4 w-4"})," Security docs"]}),e.jsxs(_n,{variant:"outline",onClick:()=>y("integrations"),children:[e.jsx(kd,{className:"h-4 w-4"})," SSO / SAML"]}),e.jsxs(_n,{variant:"outline",onClick:()=>y("integrations"),children:[e.jsx(Co,{className:"h-4 w-4"})," Webhook events"]}),e.jsxs(_n,{variant:"outline",onClick:()=>t("/console/security"),children:[e.jsx(ia,{className:"h-4 w-4"})," Data retention"]})]})]})}),e.jsx("div",{className:"mt-12",children:e.jsxs(Wi,{id:"integrations",eyebrow:"Integrations",title:"ERP exports, APIs, and webhooks",subtitle:"Sync invoices and ledger data to your ERP with secure APIs, scoped keys, and operational webhooks.",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(Ul,{icon:e.jsx(kt,{className:"h-6 w-6"}),title:"CSV and JSON exports",desc:"Export transactions, invoices, and approvals. Use invoice group codes and GL mappings for clean accounting workflows.",chips:[{label:"Core",tone:"neutral"}]}),e.jsx(Ul,{icon:e.jsx(kd,{className:"h-6 w-6"}),title:"Secure API keys and scopes",desc:"Least-privilege scopes, rotation, revocation, IP allowlists, and audit trails for all access.",chips:[{label:"Core",tone:"neutral"}]}),e.jsx(Ul,{icon:e.jsx($i,{className:"h-6 w-6"}),title:"Webhooks",desc:"Invoice created/paid, approval completed, and limit breached events with delivery logs and retries.",chips:[{label:"Core",tone:"neutral"},{label:"Inspector",tone:"info"}]})]}),e.jsx("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Phase 2"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"SSO (Google/Microsoft) and HRIS imports to automate user provisioning."})]}),e.jsx(sa,{label:"Phase 2",tone:"neutral"})]})})]})}),e.jsx("div",{className:"mt-12",children:e.jsxs(Wi,{id:"esg",eyebrow:"Sustainability",title:"Sustainability and ESG reporting",subtitle:"Measure EV usage and charging utilization across your corporate activity, with emissions estimates and template-aligned exports.",right:e.jsx(sa,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(Ul,{icon:e.jsx(Fd,{className:"h-6 w-6"}),title:"EV usage metrics",desc:"Track EV share, charging sessions, off-peak ratio, and utilization by site or group."}),e.jsx(Ul,{icon:e.jsx(Er,{className:"h-6 w-6"}),title:"Scorecards",desc:"Simple, explainable scorecards that your team can adapt to internal sustainability programs."}),e.jsx(Ul,{icon:e.jsx(kt,{className:"h-6 w-6"}),title:"Template exports",desc:"CSV/JSON exports aligned to your internal ESG templates, plus Print-to-PDF packs."})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-emerald-50 p-3 text-xs text-emerald-900 ring-1 ring-emerald-200",children:"Tip: ESG reporting is strongest when purpose tags and cost centers are enforced in policies."})]})}),e.jsx("div",{className:"mt-12",children:e.jsx(Wi,{id:"faq",eyebrow:"FAQ",title:"Questions and demo request",subtitle:"Send your requirements and we will tailor policy templates for your organization.",right:e.jsx(sa,{label:"Fast setup",tone:"good"}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-7",children:e.jsx(iU,{items:l})}),e.jsx("div",{className:"lg:col-span-5",children:e.jsxs("div",{className:"rounded-[28px] border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Request a demo"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"We will reply with a tailored walkthrough."})]}),e.jsx(sa,{label:"Free",tone:"neutral"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3",children:[e.jsx(Xp,{label:"Organization",value:c.org,onChange:T=>x(C=>({...C,org:T})),placeholder:"Company name",required:!0}),e.jsx(Xp,{label:"Your name",value:c.name,onChange:T=>x(C=>({...C,name:T})),placeholder:"Full name",required:!0}),e.jsx(Xp,{label:"Work email",value:c.email,onChange:T=>x(C=>({...C,email:T})),placeholder:"name@company.com",required:!0}),e.jsx(Xp,{label:"Phone",value:c.phone,onChange:T=>x(C=>({...C,phone:T})),placeholder:"Optional"}),e.jsx(dU,{label:"What do you want to control?",value:c.note,onChange:T=>x(C=>({...C,note:T})),placeholder:"Example: approvals for rides, RFQ for vehicles, invoice groups for 3 departments",rows:4}),e.jsxs(_n,{variant:"primary",onClick:$,children:[e.jsx(kv,{className:"h-4 w-4"})," Submit request"]}),j?e.jsx("div",{className:"rounded-2xl bg-emerald-50 p-3 text-xs text-emerald-900 ring-1 ring-emerald-200",children:"Submitted. We will reach out soon."}):e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600 ring-1 ring-slate-200",children:"By submitting, you confirm you want CorporatePay onboarding. In production, this creates a ticket and onboarding checklist."})]})]})})]})})}),e.jsxs("footer",{className:"mt-12 rounded-[28px] border border-slate-200 bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-6 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl text-white",style:{background:Nr.green},children:e.jsx(ht,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"CorporatePay"}),e.jsx("div",{className:"text-xs text-slate-500",children:"EVzone Super App"})]})]}),e.jsx("div",{className:"mt-3 max-w-md text-sm text-slate-600",children:"CorporatePay is the corporate admin console that governs how organizations pay for rides, services, and purchases across EVzone."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsx(sa,{label:"Audit-ready",tone:"info"}),e.jsx(sa,{label:"Approvals-first",tone:"good"}),e.jsx(sa,{label:"ERP exports",tone:"neutral"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 sm:grid-cols-3",children:[e.jsx(Mv,{title:"Product",links:["Dashboard","Approvals","Budgets","Invoices","RFQ"]}),e.jsx(Mv,{title:"Security",links:["MFA","Device trust","Dual control","Forensic exports"]}),e.jsx(Mv,{title:"Integrations",links:["CSV/JSON","Webhooks","API keys","Sandbox"]})]})]}),e.jsxs("div",{className:"mt-6 border-t border-slate-200 pt-4 text-xs text-slate-500",children:[" ",new Date().getFullYear()," EVzone CorporatePay. All rights reserved."]})]})]})]})]})}function em({icon:t,title:s,value:a}){return e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-3xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"grid h-9 w-9 place-items-center rounded-2xl bg-slate-50 text-slate-700",children:t}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:s}),e.jsx("div",{className:"text-xs text-slate-500",children:a})]})]}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]})}function Av({title:t,icon:s,bullets:a}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsx("div",{className:"grid h-11 w-11 place-items-center rounded-2xl bg-slate-50 text-slate-700",children:s}),e.jsx(sa,{label:"Template",tone:"neutral"})]}),e.jsx("div",{className:"mt-4 text-base font-semibold text-slate-900",children:t}),e.jsx("ul",{className:"mt-3 space-y-2 text-sm text-slate-700",children:a.map(l=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:Nr.green}}),e.jsx("span",{children:l})]},l))})]})}function Wp({n:t,title:s,desc:a}){return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl text-white",style:{background:Nr.green},children:e.jsx("span",{className:"text-sm font-black",children:t})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:s}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a})]})]})})}function Ev({title:t,desc:s,icon:a}){return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:s})]}),e.jsx("div",{className:"grid h-9 w-9 place-items-center rounded-2xl bg-slate-50 text-slate-700",children:a})]})})}function Hp({n:t,title:s,desc:a}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsx(sa,{label:`Step ${t}`,tone:"neutral"}),e.jsx(et,{className:"h-4 w-4 text-slate-400"})]}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:s}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a})]})}function Xp({label:t,value:s,onChange:a,placeholder:l,required:n}){const r=!!n&&!s.trim();return e.jsxs("label",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-xs font-semibold text-slate-600",children:[t,n?e.jsx("span",{className:"text-rose-600",children:" *"}):null]}),r?e.jsx("div",{className:"text-xs font-semibold text-rose-600",children:"Required"}):null]}),e.jsx("input",{value:s,onChange:i=>a(i.target.value),placeholder:l,className:Wd("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-rose-300 bg-white text-slate-900 focus:ring-rose-100":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function dU({label:t,value:s,onChange:a,placeholder:l,rows:n=4}){return e.jsxs("label",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),e.jsx("textarea",{value:s,onChange:r=>a(r.target.value),placeholder:l,rows:n,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"})]})}function Mv({title:t,links:s}){return e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),e.jsx("ul",{className:"mt-3 space-y-2 text-sm text-slate-600",children:s.map(a=>e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-slate-900",children:a})},a))})]})}const r4={green:"#03CD8C"};function i4(...t){return t.filter(Boolean).join(" ")}function cU(){const t=Kd(),[s,a]=d.useState(""),[l,n]=d.useState(""),[r,i]=d.useState(!1),[o,c]=d.useState("Acme Group Ltd"),[x,j]=d.useState(!1),[g,y]=d.useState(!1),[$,T]=d.useState(""),C=["Acme Group Ltd","EVzone Demo Org","Kampala Holdings"],W=R=>{if(R.preventDefault(),T(""),!s||!l){T("Please enter email and password");return}y(!0),setTimeout(()=>{y(!1),t(is.CONSOLE.DASHBOARD)},1e3)},L=()=>{y(!0),setTimeout(()=>{y(!1),t(is.CONSOLE.DASHBOARD)},800)};return e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-br from-slate-50 via-white to-emerald-50 p-4",children:e.jsxs(qe.div,{initial:{opacity:0,y:20,scale:.98},animate:{opacity:1,y:0,scale:1},transition:{duration:.3},className:"w-full max-w-md",children:[e.jsxs("div",{className:"overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsx("div",{className:"border-b border-slate-100 bg-gradient-to-r from-slate-50 to-white px-6 py-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white shadow-lg",style:{background:r4.green},children:e.jsx(ht,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-slate-900",children:"CorporatePay"}),e.jsx("div",{className:"text-sm text-slate-500",children:"Sign in to your account"})]})]})}),e.jsxs("form",{onSubmit:W,className:"space-y-4 p-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-xs font-semibold text-slate-600",children:"Organization"}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>j(!x),className:"flex w-full items-center justify-between rounded-xl border border-slate-200 bg-white px-3 py-2.5 text-left text-sm font-medium text-slate-900 transition hover:border-slate-300 focus:outline-none focus:ring-2 focus:ring-emerald-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xl,{className:"h-4 w-4 text-slate-400"}),e.jsx("span",{children:o})]}),e.jsx(ni,{className:i4("h-4 w-4 text-slate-400 transition-transform",x&&"rotate-180")})]}),x&&e.jsx(qe.div,{initial:{opacity:0,y:-8},animate:{opacity:1,y:0},className:"absolute left-0 right-0 z-10 mt-1 overflow-hidden rounded-xl border border-slate-200 bg-white shadow-lg",children:C.map(R=>e.jsxs("button",{type:"button",onClick:()=>{c(R),j(!1)},className:i4("flex w-full items-center gap-2 px-3 py-2 text-left text-sm transition hover:bg-slate-50",o===R?"bg-emerald-50 font-medium text-emerald-700":"text-slate-700"),children:[e.jsx(Xl,{className:"h-4 w-4"}),R]},R))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-xs font-semibold text-slate-600",children:"Email address"}),e.jsxs("div",{className:"relative",children:[e.jsx(Xs,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"email",value:s,onChange:R=>a(R.target.value),placeholder:"you@company.com",className:"w-full rounded-xl border border-slate-200 bg-white py-2.5 pl-10 pr-3 text-sm text-slate-900 placeholder:text-slate-400 focus:border-emerald-300 focus:outline-none focus:ring-2 focus:ring-emerald-200"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1.5 block text-xs font-semibold text-slate-600",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(ia,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:r?"text":"password",value:l,onChange:R=>n(R.target.value),placeholder:"",className:"w-full rounded-xl border border-slate-200 bg-white py-2.5 pl-10 pr-10 text-sm text-slate-900 placeholder:text-slate-400 focus:border-emerald-300 focus:outline-none focus:ring-2 focus:ring-emerald-200"}),e.jsx("button",{type:"button",onClick:()=>i(!r),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600",children:r?e.jsx(QF,{className:"h-4 w-4"}):e.jsx(ay,{className:"h-4 w-4"})})]})]}),$&&e.jsx("div",{className:"rounded-lg bg-rose-50 px-3 py-2 text-xs font-medium text-rose-700",children:$}),e.jsx("div",{className:"text-right",children:e.jsx("button",{type:"button",className:"text-xs font-medium text-emerald-600 hover:text-emerald-700 hover:underline",children:"Forgot password?"})}),e.jsx("button",{type:"submit",disabled:g,className:"flex w-full items-center justify-center gap-2 rounded-xl px-4 py-3 text-sm font-semibold text-white shadow-lg transition hover:opacity-95 focus:outline-none focus:ring-4 focus:ring-emerald-200 disabled:opacity-60",style:{background:r4.green},children:g?e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent"}):"Sign in"}),e.jsxs("div",{className:"relative py-2",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-slate-200"})}),e.jsx("div",{className:"relative flex justify-center",children:e.jsx("span",{className:"bg-white px-3 text-xs text-slate-500",children:"or continue with"})})]}),e.jsxs("button",{type:"button",onClick:L,disabled:g,className:"flex w-full items-center justify-center gap-2 rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm font-semibold text-slate-700 shadow-sm transition hover:bg-slate-50 focus:outline-none focus:ring-4 focus:ring-slate-100 disabled:opacity-60",children:[e.jsxs("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),e.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),e.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),e.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Continue with Google SSO"]})]}),e.jsxs("div",{className:"border-t border-slate-100 bg-slate-50 px-6 py-4 text-center text-xs text-slate-500",children:["By signing in, you agree to our"," ",e.jsx("a",{href:"#",className:"font-medium text-emerald-600 hover:underline",children:"Terms of Service"})," ","and"," ",e.jsx("a",{href:"#",className:"font-medium text-emerald-600 hover:underline",children:"Privacy Policy"})]})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("button",{type:"button",onClick:()=>t(is.HOME),className:"text-sm font-medium text-slate-500 hover:text-slate-700",children:" Back to home"})})]})})}const uU=[{path:is.HOME,element:qt.createElement(oU)},{path:is.SIGNIN,element:qt.createElement(cU)}],su={green:"#03CD8C",orange:"#F77F00"};function Li(...t){return t.filter(Boolean).join(" ")}function mU(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function xU(t,s,a){return Math.max(s,Math.min(a,t))}function o4(t){if(!t)return"-";const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function Va({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Li("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Js({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:su.green}:t==="accent"?{background:su.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Li(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Kp({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:Li("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:Li("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function lc({icon:t,label:s,value:a,onChange:l,type:n="text",placeholder:r,hint:i,required:o,disabled:c}){const x=!!o&&!a.trim();return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"text-xs font-semibold text-slate-600",children:[s,o?e.jsx("span",{className:"text-rose-600",children:" *"}):null]}),i?e.jsx("div",{className:"text-xs text-slate-500",children:i}):null]}),e.jsxs("div",{className:Li("mt-2 flex items-center gap-2 rounded-2xl border bg-white px-3 py-2.5 shadow-sm focus-within:ring-4",c?"border-slate-200 bg-slate-50 text-slate-500":x?"border-rose-300 focus-within:ring-rose-100":"border-slate-200 focus-within:ring-emerald-100"),children:[e.jsx("span",{className:"text-slate-500",children:t}),e.jsx("input",{type:n,value:a,onChange:j=>l(j.target.value),placeholder:r,disabled:c,className:Li("w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400",c&&"text-slate-500")})]}),x?e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:"Required"}):null]})}function Pv({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="720px"}){return d.useEffect(()=>{const o=c=>c.key==="Escape"&&n();return t&&window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[10vh] z-50 mx-auto w-[min(820px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function pU({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Li("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function hU(){const t=Kd(),[s,a]=d.useState([]),l=b=>{const ae=mU("toast");a(ve=>[{id:ae,...b},...ve].slice(0,4)),window.setTimeout(()=>a(ve=>ve.filter(O=>O.id!==ae)),3200)},[n,r]=d.useState("login"),[i,o]=d.useState("admin@acme.com"),[c,x]=d.useState(""),[j,g]=d.useState(!0),[y,$]=d.useState(!0),[T,C]=d.useState(!1),[W,L]=d.useState(!1),[R,F]=d.useState("196.43.199.81"),[te,oe]=d.useState("Kampala, UG"),[G,H]=d.useState("Windows Chrome"),[Y,we]=d.useState({location:"Kampala, UG",ts:Date.now()-26*60*60*1e3}),q=d.useMemo(()=>{let b=5;y&&(b+=35),T&&(b+=25),W&&(b+=45);const ae=i.toLowerCase();return(ae.includes("finance")||ae.includes("account"))&&(b+=15),xU(b,0,100)},[y,T,W,i]),je=d.useMemo(()=>q>=70?{label:"High",tone:"bad"}:q>=40?{label:"Medium",tone:"warn"}:{label:"Low",tone:"good"},[q]),[_e,Ee]=d.useState(!1),[be,Fe]=d.useState(""),[Pe,pe]=d.useState(""),[Q,Re]=d.useState(null),[ce,xe]=d.useState(""),[he]=d.useState(["Acme Group Ltd","Kampala Holdings","EVzone Demo Org"]),[de,ye]=d.useState("Acme Group Ltd"),Ke=d.useMemo(()=>i.toLowerCase().includes("admin"),[i]),[Le,Ne]=d.useState(!1),[ge,$e]=d.useState("support@evzone.com"),[ie,Oe]=d.useState(""),[Se,Te]=d.useState(!1),[Ge,We]=d.useState(""),[ze,Ue]=d.useState(!0),le=d.useMemo(()=>ge.trim().toLowerCase().endsWith("@evzone.com")&&ie.trim().length>=6,[ge,ie]),[z,Ae]=d.useState(()=>[{id:"S-001",device:"Windows Chrome",location:"Kampala, UG",ip:"196.43.199.81",trusted:!1,lastSeenTs:Date.now()-2*60*1e3,current:!0},{id:"S-002",device:"Android App",location:"Kampala, UG",ip:"41.190.31.12",trusted:!0,lastSeenTs:Date.now()-6*60*60*1e3,current:!1},{id:"S-003",device:"Mac Safari",location:"Wuxi, CN",ip:"103.42.111.9",trusted:!1,lastSeenTs:Date.now()-6*24*60*60*1e3,current:!1}]),[Ve,Ye]=d.useState(!1),[Be,w]=d.useState(""),[B,ue]=d.useState(""),[ne,Me]=d.useState("Manager"),[De,fe]=d.useState(""),[me,Xe]=d.useState([]),V=["Org Admin","Manager","Accountant","Approver","Travel Coordinator","User"],E=d.useMemo(()=>{const b=i.toLowerCase();return b.includes("finance")||b.includes("account")?"Accountant":b.includes("approver")?"Approver":b.includes("travel")?"Travel Coordinator":b.includes("admin")?"Org Admin":"Manager"},[i]),u=d.useMemo(()=>{const b=E==="Accountant"||E==="Approver";return q>=40||b},[q,E]),P=()=>{if(!i.trim()||!c.trim()){l({title:"Missing details",message:"Enter your email and password to continue.",kind:"warn"});return}l({title:"Credentials verified",message:"Checking session risk...",kind:"success"});const b={email:i,role:E,isSupport:!1,needsOrgSelect:Ke};if(u){Re(b),Ee(!0);return}se(b)},se=b=>{if(b.needsOrgSelect){r("org");return}ye(de),r("ready"),l({title:"Signed in",message:`Role: ${b.role}`,kind:"success"})},D=()=>{if(Q){if(be.trim().length<6){l({title:"Invalid code",message:"Enter a 6-digit code.",kind:"warn"});return}if(Se&&!Pe.trim()){l({title:"Justification required",message:"Provide a reason for support session actions.",kind:"warn"});return}Ee(!1),Fe(""),l({title:"Step-up verified",message:"Security check passed. Continuing...",kind:"success"}),se(Q),Re(null)}},re=()=>{Ne(!0)},v=()=>{if(!le){l({title:"Not allowed",message:"Use an EVzone email and valid key.",kind:"warn"});return}const b=`SUP-${Math.floor(1e5+Math.random()*9e5)}`;We(b),Te(!0),Ne(!1),Re({email:ge,role:"EVzone Support",isSupport:!0,needsOrgSelect:!0}),pe("Troubleshooting request"),Ee(!0),l({title:"Support mode requested",message:"Step-up authentication required.",kind:"info"})},k=()=>{r("ready"),l({title:"Organization selected",message:`Opening ${de}.`,kind:"success"})},m=()=>{if(!Be.trim()||!B.trim()||!i.trim()){l({title:"Missing fields",message:"Organization, your name, and email are required.",kind:"warn"});return}const b=`TCK-${Math.floor(1e5+Math.random()*9e5)}`,ae={id:b,org:Be.trim(),requester:B.trim(),email:i.trim(),roleNeeded:ne,reason:De.trim(),createdAt:Date.now(),status:"Submitted"};Xe(ve=>[ae,...ve]),Ye(!1),w(""),ue(""),fe(""),l({title:"Request submitted",message:`Ticket created: ${b}. Org admin notified.`,kind:"success"})},S=b=>{Ae(ae=>ae.filter(ve=>ve.id!==b)),l({title:"Session revoked",message:`Device session ${b} revoked.`,kind:"success"})},f=()=>{Ae(b=>b.filter(ae=>ae.current)),l({title:"Sessions revoked",message:"All other sessions revoked.",kind:"success"})},U=()=>{Te(!1),We(""),l({title:"Support session ended",message:"Support mode disabled.",kind:"info"})},p=d.useMemo(()=>{const b=ce.trim().toLowerCase();return b?he.filter(ae=>ae.toLowerCase().includes(b)):he},[ce,he]),M=d.useMemo(()=>{const b=[];return b.push({label:"New device",on:y,tone:"warn"}),b.push({label:"New location",on:T,tone:"warn"}),b.push({label:"Impossible travel",on:W,tone:"bad"}),b},[y,T,W]),ee=d.useMemo(()=>Se?{label:`Support Session: ${Ge}`,tone:"warn"}:{label:`Risk: ${je.label} (${q})`,tone:je.tone},[Se,Ge,je,q]);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(pU,{toasts:s,onDismiss:b=>a(ae=>ae.filter(ve=>ve.id!==b))}),Se&&ze?e.jsxs("div",{className:"pointer-events-none fixed inset-0 z-0 opacity-[0.08]",children:[e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"repeating-linear-gradient(-22deg, rgba(2,6,23,1) 0, rgba(2,6,23,1) 1px, transparent 1px, transparent 240px)"}}),e.jsx("div",{className:"absolute inset-0 grid place-items-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl font-black tracking-tight text-slate-900",children:"EVzone Support Session"}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:"Audited  No silent actions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-700",children:Ge})]})})]}):null,Se?e.jsx("div",{className:"sticky top-0 z-20 border-b border-amber-200 bg-amber-50",children:e.jsxs("div",{className:"mx-auto flex max-w-7xl flex-col gap-2 px-4 py-3 md:flex-row md:items-center md:justify-between md:px-6",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-white text-amber-800 ring-1 ring-amber-200",children:e.jsx(yt,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Support mode active"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-700",children:["Session ",Ge,". View-only by default. Any write action requires justification and is audit logged."]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Js,{variant:"outline",className:"text-xs",onClick:()=>Ue(b=>!b),children:[e.jsx(Su,{className:"h-4 w-4"})," ",ze?"Hide":"Show"," watermark"]}),e.jsxs(Js,{variant:"danger",className:"text-xs",onClick:U,children:[e.jsx(jo,{className:"h-4 w-4"})," End session"]})]})]})}):null,e.jsxs("div",{className:"relative z-10 mx-auto max-w-7xl px-4 py-10 md:px-6",children:[e.jsxs("div",{className:"mb-6 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:su.green},children:e.jsx(La,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"EVzone CorporatePay"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Login and organization selection"})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Va,{label:ee.label,tone:ee.tone}),e.jsxs(Js,{variant:"outline",onClick:()=>Ye(!0),children:[e.jsx(ri,{className:"h-4 w-4"})," Request access"]}),e.jsxs(Js,{variant:"outline",onClick:re,children:[e.jsx(yt,{className:"h-4 w-4"})," EVzone Support"]})]})]}),e.jsxs(lt,{mode:"wait",children:[n==="login"?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},children:e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"rounded-[28px] border border-slate-200 bg-white p-6 shadow-[0_30px_90px_rgba(2,8,23,0.10)]",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Session security"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Risk-based step-up prompts, device trust, and audit visibility."})]}),e.jsx(Va,{label:`Risk: ${je.label}`,tone:je.tone})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Risk signals"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Toggle to preview step-up prompts."})]}),e.jsx(Va,{label:`Score ${q}/100`,tone:je.tone})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-3",children:[e.jsx(Kp,{enabled:y,onChange:$,label:"New device",description:"Unseen device"}),e.jsx(Kp,{enabled:T,onChange:C,label:"New geo",description:"New region"}),e.jsx(Kp,{enabled:W,onChange:L,label:"Impossible travel",description:"Too fast"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx(nc,{icon:e.jsx(Wx,{className:"h-4 w-4"}),label:"Current location",value:te}),e.jsx(nc,{icon:e.jsx($i,{className:"h-4 w-4"}),label:"IP",value:R}),e.jsx(nc,{icon:e.jsx(og,{className:"h-4 w-4"}),label:"Device",value:G})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-white p-3 text-xs text-slate-600",children:["Last sign-in: ",e.jsx("span",{className:"font-semibold text-slate-900",children:Y.location}),"  ",o4(Y.ts)]})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"What happens when risk is high"}),e.jsxs("ul",{className:"mt-3 space-y-2 text-sm text-slate-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-1 h-1.5 w-1.5 rounded-full",style:{background:su.green}}),"Step-up prompt (MFA code)"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-1 h-1.5 w-1.5 rounded-full",style:{background:su.orange}}),"Support sessions require justification and show a watermark"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-1 h-1.5 w-1.5 rounded-full",style:{background:su.green}}),"Active sessions can be revoked instantly"]})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Policy default: Finance and Approver roles require MFA."})]}),me.length?e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Recent access requests"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Tickets created from this login page."})]}),e.jsx(Va,{label:`${me.length}`,tone:"neutral"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:me.slice(0,2).map(b=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:b.id}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[b.org,"  Role: ",b.roleNeeded]})]}),e.jsx(Va,{label:b.status,tone:b.status==="Submitted"?"info":"neutral"})]})},b.id))})]}):null]}),e.jsxs("div",{className:"rounded-[28px] border border-slate-200 bg-white p-6 shadow-[0_30px_90px_rgba(2,8,23,0.10)]",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Sign in"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Email and password. SSO is Phase 2."})]}),e.jsx(Va,{label:`Role detected: ${E}`,tone:"info"})]}),e.jsxs("div",{className:"mt-5 grid grid-cols-1 gap-4",children:[e.jsx(lc,{icon:e.jsx(Xs,{className:"h-4 w-4"}),label:"Email",required:!0,value:i,onChange:o,placeholder:"you@company.com"}),e.jsx(lc,{icon:e.jsx(ia,{className:"h-4 w-4"}),label:"Password",required:!0,value:c,onChange:x,type:"password",placeholder:""}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700",children:[e.jsx("input",{type:"checkbox",checked:j,onChange:b=>g(b.target.checked),className:"h-4 w-4 rounded border-slate-300"}),"Remember me"]}),e.jsx("button",{className:"text-sm font-semibold text-emerald-700 hover:underline",onClick:()=>l({title:"Reset password",message:"Password reset flow opened (demo).",kind:"info"}),type:"button",children:"Forgot password?"})]}),e.jsxs(Js,{variant:"primary",className:"w-full",onClick:P,children:[e.jsx(xu,{className:"h-4 w-4"})," Sign in"]}),e.jsxs("div",{className:"relative py-2",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-slate-200"})}),e.jsx("div",{className:"relative flex justify-center",children:e.jsx("span",{className:"bg-white px-3 text-xs font-semibold text-slate-500",children:"OR"})})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2",children:[e.jsxs(Js,{variant:"outline",disabled:!0,title:"Phase 2",children:[e.jsx("span",{className:"grid h-6 w-6 place-items-center rounded-xl bg-slate-100 text-slate-700",children:"G"}),"Continue with Google"]}),e.jsxs(Js,{variant:"outline",disabled:!0,title:"Phase 2",children:[e.jsx("span",{className:"grid h-6 w-6 place-items-center rounded-xl bg-slate-100 text-slate-700",children:"M"}),"Continue with Microsoft"]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"EVzone Support entry"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Role-gated sign-in with watermark and audited session."})]}),e.jsx(Va,{label:"Support",tone:"warn"})]}),e.jsxs(Js,{variant:"outline",className:"mt-3 w-full",onClick:re,children:[e.jsx(yt,{className:"h-4 w-4"})," Sign in as EVzone Support"]}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Support mode actions are never silent and always logged."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Need access?"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Create a request ticket for your organization admin."}),e.jsxs(Js,{variant:"accent",className:"mt-3 w-full",onClick:()=>Ye(!0),children:[e.jsx(ri,{className:"h-4 w-4"})," Request access"]})]}),e.jsx("div",{className:"text-xs text-slate-500",children:"If your account belongs to multiple organizations, you will pick one after sign-in."})]})]})]})},"login"):null,n==="org"?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},children:e.jsxs("div",{className:"rounded-[28px] border border-slate-200 bg-white p-6 shadow-[0_30px_90px_rgba(2,8,23,0.10)]",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Select organization"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Your account belongs to multiple organizations. Choose one to continue."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Va,{label:`Signed in as ${Se?"EVzone Support":E}`,tone:Se?"warn":"info"}),e.jsxs(Js,{variant:"outline",onClick:()=>{r("login"),l({title:"Signed out",message:"Returned to login.",kind:"info"})},children:[e.jsx(jo,{className:"h-4 w-4"})," Sign out"]})]})]}),e.jsxs("div",{className:"mt-5 grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Search org"}),e.jsxs("div",{className:"mt-3 flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2 shadow-sm focus-within:ring-4 focus-within:ring-emerald-100",children:[e.jsx(pa,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:ce,onChange:b=>xe(b.target.value),placeholder:"Type to filter...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"})]}),e.jsx("div",{className:"mt-3 text-xs text-slate-600",children:"Support sessions display a banner and watermark after you enter the org."})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:p.map(b=>e.jsx("button",{type:"button",onClick:()=>ye(b),className:Li("rounded-3xl border p-4 text-left transition",de===b?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Li("grid h-11 w-11 place-items-center rounded-2xl",de===b?"bg-white text-emerald-700 ring-1 ring-emerald-200":"bg-slate-100 text-slate-700"),children:e.jsx(Xl,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:b}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Admin Console access"})]})]}),de===b?e.jsx(ct,{className:"h-5 w-5 text-emerald-700"}):e.jsx(et,{className:"h-5 w-5 text-slate-400"})]})},b))}),e.jsxs("div",{className:"mt-4 flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Js,{variant:"outline",onClick:()=>r("login"),children:"Back"}),e.jsxs(Js,{variant:"primary",onClick:k,children:[e.jsx(Xl,{className:"h-4 w-4"})," Continue"]})]})]})]})]})},"org"):null,n==="ready"?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},children:e.jsxs("div",{className:"rounded-[28px] border border-slate-200 bg-white p-6 shadow-[0_30px_90px_rgba(2,8,23,0.10)]",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Welcome"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Organization: ",de]}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(Va,{label:Se?"EVzone Support":E,tone:Se?"warn":"info"}),e.jsx(Va,{label:`Email: ${Se?ge:i}`,tone:"neutral"}),e.jsx(Va,{label:`Risk: ${je.label}`,tone:je.tone})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Js,{variant:"outline",onClick:f,children:[e.jsx(jo,{className:"h-4 w-4"})," Revoke other sessions"]}),e.jsxs(Js,{variant:"primary",onClick:()=>{l({title:"Continue",message:"Routing to Corporate Dashboard...",kind:"success"}),t(is.CONSOLE.DASHBOARD)},children:[e.jsx(et,{className:"h-4 w-4"})," Continue to dashboard"]})]})]}),e.jsxs("div",{className:"mt-5 grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Session badge"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Visibility and audit watermark for support sessions"})]}),e.jsx(Va,{label:Se?"Support":"Standard",tone:Se?"warn":"good"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:Se?e.jsxs(e.Fragment,{children:["Support session ",e.jsx("span",{className:"font-semibold",children:Ge})," is visible to organization admins. No silent actions."]}):e.jsx(e.Fragment,{children:"Standard admin session. Security events are still logged."})}),e.jsx(Kp,{enabled:Se?ze:!1,onChange:b=>Ue(b),label:"Audit watermark",description:"Shown when support mode is active"})]}),e.jsxs("div",{className:"lg:col-span-2 overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 px-4 py-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Active sessions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Revoke devices and manage trust settings."})]}),e.jsx(Va,{label:`${z.length}`,tone:"neutral"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Session"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Device"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Location"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"IP"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Trusted"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Last seen"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsx("tbody",{children:z.map(b=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:b.id}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:b.device}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:b.location}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:b.ip}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Va,{label:b.trusted?"Yes":"No",tone:b.trusted?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:o4(b.lastSeenTs)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Js,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{b.current?(Ae(ae=>ae.map(ve=>ve.id===b.id?{...ve,trusted:!ve.trusted}:ve)),l({title:"Updated",message:"Current device trust updated.",kind:"success"})):(Ae(ae=>ae.map(ve=>ve.id===b.id?{...ve,trusted:!ve.trusted}:ve)),l({title:"Updated",message:"Device trust updated.",kind:"success"}))},children:[e.jsx(Su,{className:"h-4 w-4"})," ",b.trusted?"Untrust":"Trust"]}),b.current?e.jsx(Va,{label:"Current",tone:"info"}):e.jsxs(Js,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>S(b.id),children:[e.jsx(jo,{className:"h-4 w-4"})," Revoke"]})]})})]},b.id))})]})}),e.jsx("div",{className:"border-t border-slate-200 px-4 py-3 text-xs text-slate-500",children:"In production, session actions require audit logging and may require step-up authentication."})]})]}),e.jsxs("div",{className:"mt-5 flex flex-wrap items-center justify-between gap-2 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Sign out"}),e.jsxs(Js,{variant:"outline",onClick:()=>{r("login"),l({title:"Signed out",message:"Returned to login.",kind:"info"})},children:[e.jsx(jo,{className:"h-4 w-4"})," Sign out"]})]})]})},"ready"):null]})]}),e.jsxs(Pv,{open:_e,title:"Step-up authentication",subtitle:"Risk-based prompt. Complete MFA to continue.",onClose:()=>{Ee(!1),Re(null)},footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Js,{variant:"outline",onClick:()=>{Ee(!1),Re(null),l({title:"Cancelled",message:"Step-up cancelled.",kind:"info"})},children:"Cancel"}),e.jsxs(Js,{variant:"primary",onClick:D,children:[e.jsx(tt,{className:"h-4 w-4"})," Verify"]})]}),maxW:"820px",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Risk summary"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Signals that triggered this prompt."})]}),e.jsx(Va,{label:`Risk ${q}/100`,tone:je.tone})]}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:M.map(b=>e.jsx(Va,{label:`${b.label}: ${b.on?"Yes":"No"}`,tone:b.on?b.tone:"neutral"},b.label))}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-3",children:[e.jsx(nc,{icon:e.jsx(Wx,{className:"h-4 w-4"}),label:"Location",value:te}),e.jsx(nc,{icon:e.jsx($i,{className:"h-4 w-4"}),label:"IP",value:R}),e.jsx(nc,{icon:e.jsx(og,{className:"h-4 w-4"}),label:"Device",value:G})]})]}),Q!=null&&Q.isSupport?e.jsxs("div",{className:"mt-4 rounded-3xl border border-amber-200 bg-amber-50 p-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-white text-amber-800 ring-1 ring-amber-200",children:e.jsx(yt,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Support session rules"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:"No silent actions. Any write action requires justification."}),e.jsxs("div",{className:"mt-3 text-xs text-slate-600",children:["Session ID: ",Ge]})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-700",children:"Justification (required)"}),e.jsx("textarea",{value:Pe,onChange:b=>pe(b.target.value),placeholder:"Example: troubleshooting an invoice delivery failure",className:"mt-2 w-full rounded-2xl border border-amber-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-amber-100",rows:3})]})]}):null,e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Authenticator code"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Enter a 6-digit code from your authenticator app."}),e.jsx("input",{value:be,onChange:b=>Fe(b.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"123456",className:"mt-3 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Demo: any 6 digits are accepted."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Help"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"If you cannot access your authenticator, use backup codes (X2 page)."}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Finance and Approver roles require MFA."}),e.jsxs(Js,{variant:"outline",className:"mt-3 w-full",onClick:()=>l({title:"Help",message:"Open MFA help article (demo).",kind:"info"}),children:[e.jsx(Fu,{className:"h-4 w-4"})," MFA help"]})]})]})]}),e.jsxs(Pv,{open:Le,title:"EVzone Support sign-in",subtitle:"Role-gated entry. Support sessions are visible and audited.",onClose:()=>Ne(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Js,{variant:"outline",onClick:()=>Ne(!1),children:"Cancel"}),e.jsxs(Js,{variant:"primary",disabled:!le,onClick:v,children:[e.jsx(yt,{className:"h-4 w-4"})," Continue"]})]}),maxW:"820px",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(lc,{icon:e.jsx(Xs,{className:"h-4 w-4"}),label:"EVzone email",value:ge,onChange:$e,placeholder:"support@evzone.com",required:!0}),e.jsx(lc,{icon:e.jsx(xu,{className:"h-4 w-4"}),label:"Support key",value:ie,onChange:Oe,placeholder:"Enter key",type:"password",required:!0,hint:"Demo: 6+ chars"})]}),e.jsx("div",{className:"mt-4 rounded-3xl border border-amber-200 bg-amber-50 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-white text-amber-800 ring-1 ring-amber-200",children:e.jsx(Et,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Support safety"}),e.jsxs("ul",{className:"mt-2 space-y-1 text-xs text-slate-700",children:[e.jsx("li",{children:"1) View-only by default"}),e.jsx("li",{children:"2) Step-up authentication required"}),e.jsx("li",{children:"3) Justification required for write actions"}),e.jsx("li",{children:"4) Visible banner and watermark"})]})]})]})})]}),e.jsxs(Pv,{open:Ve,title:"Request access",subtitle:"Creates a ticket for the organization admin and logs the request.",onClose:()=>Ye(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Js,{variant:"outline",onClick:()=>Ye(!1),children:"Cancel"}),e.jsxs(Js,{variant:"primary",onClick:m,children:[e.jsx(ri,{className:"h-4 w-4"})," Submit"]})]}),maxW:"820px",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4 text-sm text-slate-700",children:[e.jsx("span",{className:"font-semibold",children:"Email used"}),": ",i||"(enter email on login page)"]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(lc,{icon:e.jsx(Xl,{className:"h-4 w-4"}),label:"Organization",required:!0,value:Be,onChange:w,placeholder:"Example: Acme Group Ltd"}),e.jsx(lc,{icon:e.jsx(dx,{className:"h-4 w-4"}),label:"Your name",required:!0,value:B,onChange:ue,placeholder:"Full name"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Role needed"}),e.jsx("select",{value:ne,onChange:b=>Me(b.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",children:V.map(b=>e.jsx("option",{value:b,children:b},b))}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"The org admin will approve this request."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Delivery"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(Va,{label:"Email",tone:"neutral"}),e.jsx(Va,{label:"WhatsApp",tone:"good"}),e.jsx(Va,{label:"SMS",tone:"info"})]}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"In production, delivery logs appear in Notifications Center."})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Reason"}),e.jsx("textarea",{value:De,onChange:b=>fe(b.target.value),placeholder:"Explain why you need access",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100",rows:4}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Tip: include urgency and your responsibilities."})]})]})]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-7xl px-4 text-xs text-slate-500 md:px-6",children:"X1 Login: email/password, org selector, EVzone support entry, risk-based step-up prompts, session management, and support-mode banner + watermark."})})]})}function nc({icon:t,label:s,value:a}){return e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-600",children:t}),e.jsx("span",{className:"text-xs font-semibold text-slate-600",children:s})]}),e.jsx("span",{className:"text-xs font-semibold text-slate-900",children:a})]})})}const cx={green:"#03CD8C",orange:"#F77F00"};function kr(...t){return t.filter(Boolean).join(" ")}function d4(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function FE(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function Qp(t){if(!t)return"-";const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function ps({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:kr("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function fs({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:cx.green}:t==="accent"?{background:cx.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:kr(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Yp({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:kr("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:kr("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function gU({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:kr("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function fU({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="860px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[8vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(gU,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function vU({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:kr("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function Hi({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text"}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:i=>a(i.target.value),placeholder:l,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"})]})}function Ov(t=8){return Array.from({length:t}).map(()=>{const s=Math.random().toString(16).slice(2,6).toUpperCase(),a=Math.random().toString(16).slice(2,6).toUpperCase();return`${s}-${a}`})}function Jp(t,s){const a=new Blob([s],{type:"text/plain"}),l=URL.createObjectURL(a),n=document.createElement("a");n.href=l,n.download=t,n.click(),URL.revokeObjectURL(l)}function bU(t){const s=["id","timestamp","severity","actor","category","title","detail","status"],a=n=>{const r=String(n??"");return r.includes(",")||r.includes(`
`)||r.includes('"')?`"${r.replace(/"/g,'""')}"`:r},l=t.map(n=>[n.id,FE(n.ts),n.severity,n.actor,n.category,n.title,n.detail,n.status].map(a).join(","));return[s.join(","),...l].join(`
`)}function jU(t){return t==="Critical"?"bad":t==="Warning"?"warn":"info"}function yU(t){const s=[];if(t.ipEnabled&&(t.ipAllow.includes(t.ip)||s.push("IP not in allowlist")),t.geoEnabled&&(t.geoAllow.map(l=>l.toLowerCase()).includes(t.geo.toLowerCase())||s.push("Geo not in allowlist")),t.timeEnabled){t.timeDays.includes(t.day)||s.push("Day not allowed");const l=t.time;t.timeStart&&t.timeEnd&&(l<t.timeStart||l>t.timeEnd)&&s.push("Time outside allowed window")}return s.length?{status:"Step-up required",reasons:s}:{status:"Allowed",reasons:[]}}function NU(){const[t,s]=d.useState([]),a=b=>{const ae=d4("toast");s(ve=>[{id:ae,...b},...ve].slice(0,4)),window.setTimeout(()=>s(ve=>ve.filter(O=>O.id!==ae)),3200)},[l,n]=d.useState("setup"),[r]=d.useState("EVZ-CPAY-2FA-9X3D-7K1P"),[i,o]=d.useState(""),[c,x]=d.useState(!1),[j,g]=d.useState([]),[y,$]=d.useState(!0),[T,C]=d.useState(30),[W,L]=d.useState({Finance:!0,Approver:!0,Admin:!0,Manager:!1,User:!1,"Travel Coordinator":!1}),[R,F]=d.useState(()=>[{id:"S-001",device:"Windows Chrome",location:"Kampala, UG",ip:"196.43.199.81",trusted:!1,lastSeenTs:Date.now()-2*60*1e3,status:"Current"},{id:"S-002",device:"Android App",location:"Kampala, UG",ip:"41.190.31.12",trusted:!0,lastSeenTs:Date.now()-6*60*60*1e3,status:"Active"},{id:"S-003",device:"Mac Safari",location:"Wuxi, CN",ip:"103.42.111.9",trusted:!1,lastSeenTs:Date.now()-6*24*60*60*1e3,status:"Signed out"}]),[te,oe]=d.useState(!1),[G,H]=d.useState(["196.43.199.81","41.190.31.12"]),[Y,we]=d.useState(""),[q,je]=d.useState(!1),[_e,Ee]=d.useState(["Kampala, UG","Entebbe, UG"]),[be,Fe]=d.useState(""),[Pe,pe]=d.useState(!1),[Q,Re]=d.useState("06:00"),[ce,xe]=d.useState("22:00"),[he,de]=d.useState(["Mon","Tue","Wed","Thu","Fri"]),[ye,Ke]=d.useState("196.43.199.81"),[Le,Ne]=d.useState("Kampala, UG"),[ge,$e]=d.useState("Wed"),[ie,Oe]=d.useState("10:30"),[Se,Te]=d.useState(()=>[{id:"BG-001",email:"breakglass-admin@acme.com",enabled:!0,locked:!1,lastRotatedTs:Date.now()-60*24*60*60*1e3,lastUsedTs:null,notes:"Emergency-only. Dual-control recommended.",emergencyCodes:Ov(10)}]),[Ge,We]=d.useState(!1),[ze,Ue]=d.useState(null),[le,z]=d.useState(()=>[{id:"EVT-9001",ts:Date.now()-20*60*1e3,severity:"Warning",actor:"System",category:"Tamper",title:"MFA disable attempt blocked",detail:"A user attempted to disable MFA but policy requires MFA for Finance roles.",status:"Open"},{id:"EVT-9002",ts:Date.now()-2*60*60*1e3,severity:"Info",actor:"Org Admin",category:"Policy",title:"Updated MFA policy",detail:"Set MFA required for Approver and Admin roles.",status:"Resolved"},{id:"EVT-9003",ts:Date.now()-9*60*60*1e3,severity:"Critical",actor:"System",category:"Session",title:"Unusual login detected",detail:"Impossible travel signal. Step-up authentication required.",status:"Open"}]),[Ae,Ve]=d.useState("All"),[Ye,Be]=d.useState("All"),w=b=>{const ae={id:d4("EVT"),ts:Date.now(),status:b.status??"Open",...b};z(ve=>[ae,...ve])},B=d.useMemo(()=>yU({ip:ye,geo:Le,day:ge,time:ie,ipEnabled:te,ipAllow:G,geoEnabled:q,geoAllow:_e,timeEnabled:Pe,timeStart:Q,timeEnd:ce,timeDays:he}),[ye,Le,ge,ie,te,G,q,_e,Pe,Q,ce,he]),ue=d.useMemo(()=>le.filter(b=>b.status==="Open").length,[le]),ne=d.useMemo(()=>le.filter(b=>b.status==="Open"&&b.severity==="Critical").length,[le]),Me=d.useMemo(()=>le.filter(b=>!(Ae!=="All"&&b.status!==Ae||Ye!=="All"&&b.severity!==Ye)),[le,Ae,Ye]),De=b=>{if(b==="json"){Jp("corporatepay-security-events.json",JSON.stringify(le,null,2)),a({title:"Exported",message:"Security events exported as JSON.",kind:"success"});return}const ae=bU(le);Jp("corporatepay-security-events.csv",ae),a({title:"Exported",message:"Security events exported as CSV.",kind:"success"})},fe=async b=>{try{await navigator.clipboard.writeText(b),a({title:"Copied",message:"Copied to clipboard.",kind:"success"})}catch{a({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},me=()=>{if(i.trim().length<6){a({title:"Invalid code",message:"Enter a 6-digit code.",kind:"warn"});return}x(!0),w({severity:"Info",actor:"You",category:"MFA",title:"MFA enabled",detail:"Authenticator verified successfully."}),a({title:"MFA enabled",message:"Authenticator verified.",kind:"success"})},Xe=()=>{const b=Ov(10);g(b),w({severity:"Info",actor:"You",category:"MFA",title:"Backup codes generated",detail:"Generated 10 backup codes."}),a({title:"Generated",message:"Backup codes generated.",kind:"success"})},V=()=>{Jp("evzone-corporatepay-backup-codes.txt",j.join(`
`)),a({title:"Downloaded",message:"Backup codes downloaded.",kind:"success"})},E=b=>{L(ae=>{const ve={...ae,[b]:!ae[b]};return w({severity:"Info",actor:"Org Admin",category:"Policy",title:"MFA policy updated",detail:`Role ${b}: ${ve[b]?"required":"optional"}`}),ve})},u=()=>{F(b=>b.map(ae=>ae.status==="Current"?ae:{...ae,status:"Signed out"})),w({severity:"Warning",actor:"You",category:"Session",title:"Forced sign-out",detail:"Signed out all other active sessions."}),a({title:"Signed out",message:"All other sessions were signed out.",kind:"success"})},P=b=>{F(ae=>ae.map(ve=>ve.id===b?{...ve,status:"Signed out"}:ve)),w({severity:"Info",actor:"You",category:"Session",title:"Session signed out",detail:`Session ${b} signed out.`}),a({title:"Signed out",message:`Session ${b} signed out.",`,kind:"success"})},se=b=>{F(ae=>ae.map(ve=>ve.id===b?{...ve,trusted:!ve.trusted}:ve)),w({severity:"Info",actor:"You",category:"Device",title:"Device trust changed",detail:`Trust updated for ${b}.`}),a({title:"Updated",message:"Device trust updated.",kind:"success"})},D=()=>{const b=Y.trim();if(!b){a({title:"Missing IP",message:"Enter an IP address.",kind:"warn"});return}if(G.includes(b)){a({title:"Exists",message:"IP already in allowlist.",kind:"info"});return}H(ae=>[b,...ae]),we(""),w({severity:"Info",actor:"Org Admin",category:"Policy",title:"IP allowlist changed",detail:`Added ${b}.`}),a({title:"Added",message:"IP added to allowlist.",kind:"success"})},re=b=>{H(ae=>ae.filter(ve=>ve!==b)),w({severity:"Info",actor:"Org Admin",category:"Policy",title:"IP allowlist changed",detail:`Removed ${b}.`})},v=()=>{const b=be.trim();if(!b){a({title:"Missing geo",message:"Enter a location.",kind:"warn"});return}if(_e.map(ae=>ae.toLowerCase()).includes(b.toLowerCase())){a({title:"Exists",message:"Location already in allowlist.",kind:"info"});return}Ee(ae=>[b,...ae]),Fe(""),w({severity:"Info",actor:"Org Admin",category:"Policy",title:"Geo allowlist changed",detail:`Added ${b}.`}),a({title:"Added",message:"Location added to allowlist.",kind:"success"})},k=b=>{Ee(ae=>ae.filter(ve=>ve!==b)),w({severity:"Info",actor:"Org Admin",category:"Policy",title:"Geo allowlist changed",detail:`Removed ${b}.`})},m=b=>{de(ae=>{const O=ae.includes(b)?ae.filter(X=>X!==b):[...ae,b];return w({severity:"Info",actor:"Org Admin",category:"Policy",title:"Time restriction changed",detail:`Allowed days updated: ${O.join(", ")}`}),O})},S=b=>{z(ae=>ae.map(ve=>ve.id===b?{...ve,status:"Resolved"}:ve)),a({title:"Resolved",message:`Event ${b} marked resolved.",`,kind:"success"})},f=b=>{Ue(b),We(!0)},U=b=>{Te(ae=>ae.map(ve=>ve.id===b?{...ve,emergencyCodes:Ov(12),lastRotatedTs:Date.now()}:ve)),w({severity:"Warning",actor:"Org Admin",category:"Break-glass",title:"Emergency codes rotated",detail:`Rotated emergency codes for ${b}.`}),a({title:"Rotated",message:"Emergency codes rotated.",kind:"success"})},p=b=>{Te(ae=>ae.map(ve=>ve.id===b?{...ve,enabled:!ve.enabled}:ve)),w({severity:"Warning",actor:"Org Admin",category:"Break-glass",title:"Break-glass status changed",detail:`Toggled enabled state for ${b}.`})},M=b=>{Te(ae=>ae.map(ve=>ve.id===b?{...ve,locked:!ve.locked}:ve)),w({severity:"Critical",actor:"Org Admin",category:"Break-glass",title:"Break-glass lock changed",detail:`Toggled lock state for ${b}.`})},ee=d.useMemo(()=>({policy:`MFA required roles: ${Object.values(W).filter(Boolean).length}`,conditional:te||q||Pe?"Conditional access on":"Conditional access off"}),[W,te,q,Pe]);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(vU,{toasts:t,onDismiss:b=>s(ae=>ae.filter(ve=>ve.id!==b))}),e.jsx("div",{className:"mx-auto max-w-7xl px-4 py-10 md:px-6",children:e.jsxs("div",{className:"rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.10)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-6 py-5",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:cx.green},children:e.jsx(Su,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"MFA and Device Trust"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Secure access policies, trusted devices, and exportable security events."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(ps,{label:c?"MFA: Enabled":"MFA: Not enabled",tone:c?"good":"warn"}),e.jsx(ps,{label:y?`Trust: ${T} days`:"Trust: Off",tone:y?"info":"neutral"}),e.jsx(ps,{label:ee.conditional,tone:te||q||Pe?"warn":"neutral"}),e.jsx(ps,{label:`Open alerts: ${ue}`,tone:ue?"warn":"good"}),ne?e.jsx(ps,{label:`Critical: ${ne}`,tone:"bad"}):null]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(fs,{variant:"outline",onClick:()=>De("csv"),children:[e.jsx(pt,{className:"h-4 w-4"})," Export CSV"]}),e.jsxs(fs,{variant:"outline",onClick:()=>De("json"),children:[e.jsx(kt,{className:"h-4 w-4"})," Export JSON"]}),e.jsxs(fs,{variant:"primary",onClick:()=>a({title:"Saved",message:"Security settings saved (demo).",kind:"success"}),children:[e.jsx(tt,{className:"h-4 w-4"})," Save"]})]})]}),e.jsx("div",{className:"mt-5 flex flex-wrap gap-2",children:[{id:"setup",label:"MFA setup"},{id:"trust",label:"Device trust and sessions"},{id:"conditional",label:"Conditional access"},{id:"breakglass",label:"Break-glass"},{id:"events",label:"Tamper alerts and events"}].map(b=>e.jsx("button",{className:kr("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",l===b.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:l===b.id?{background:cx.green}:void 0,onClick:()=>n(b.id),children:b.label},b.id))})]}),e.jsx("div",{className:"bg-slate-50 px-6 py-6",children:e.jsxs(lt,{mode:"wait",children:[l==="setup"?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs(or,{title:"Authenticator",subtitle:"Scan QR and verify a code",right:e.jsx(ps,{label:c?"Enabled":"Setup",tone:c?"good":"warn"}),children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-700",children:"QR placeholder"}),e.jsx("div",{className:"mt-3 grid place-items-center rounded-3xl bg-white p-6 ring-1 ring-slate-200",children:e.jsx("div",{className:"grid h-40 w-40 place-items-center rounded-2xl border border-slate-200 bg-white",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"QR"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Authenticator setup"})]})})})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Secret key"}),e.jsxs("div",{className:"mt-2 flex items-center justify-between rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2",children:[e.jsx("span",{className:"font-mono text-sm font-semibold text-slate-900",children:r}),e.jsxs(fs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>fe(r),children:[e.jsx(ss,{className:"h-4 w-4"})," Copy"]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Verification code"}),e.jsx("input",{value:i,onChange:b=>o(b.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"123456",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Demo: any 6 digits enable MFA."})]}),e.jsxs("div",{className:"mt-4 flex flex-col gap-2 sm:flex-row sm:justify-end",children:[e.jsxs(fs,{variant:"outline",onClick:()=>a({title:"Help",message:"MFA setup help (demo).",kind:"info"}),children:[e.jsx(Fu,{className:"h-4 w-4"})," Help"]}),e.jsxs(fs,{variant:"primary",onClick:me,disabled:c,children:[e.jsx(tt,{className:"h-4 w-4"})," Verify"]})]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Admin policy can require MFA by role (Finance, Approver, Admin)."})]}),e.jsxs(or,{title:"Backup codes",subtitle:"Emergency access if phone is unavailable",right:e.jsx(ps,{label:j.length?"Generated":"Not generated",tone:j.length?"good":"warn"}),children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(fs,{variant:"primary",onClick:Xe,children:[e.jsx(xu,{className:"h-4 w-4"})," Generate"]}),e.jsxs(fs,{variant:"outline",disabled:!j.length,onClick:()=>fe(j.join(`
`)),children:[e.jsx(ss,{className:"h-4 w-4"})," Copy all"]}),e.jsxs(fs,{variant:"outline",disabled:!j.length,onClick:V,children:[e.jsx(pt,{className:"h-4 w-4"})," Download"]}),e.jsxs(fs,{variant:"outline",disabled:!j.length,onClick:()=>{g([]),w({severity:"Warning",actor:"You",category:"MFA",title:"Backup codes cleared",detail:"Backup codes cleared. Generate again if needed."}),a({title:"Cleared",message:"Backup codes cleared.",kind:"warn"})},children:[e.jsx(as,{className:"h-4 w-4"})," Clear"]})]}),e.jsx("div",{className:"mt-4 grid grid-cols-1 gap-2 sm:grid-cols-2",children:j.length?j.map(b=>e.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("span",{className:"font-mono text-sm font-semibold text-slate-900",children:b}),e.jsx(ps,{label:"One-time",tone:"neutral"})]},b)):e.jsxs("div",{className:"sm:col-span-2 rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(xu,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No backup codes"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Generate and store securely."})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: backup code use should create an audit event and trigger a security alert."})]}),e.jsxs(or,{title:"Admin MFA policies",subtitle:"Require MFA by role",right:e.jsx(ps,{label:ee.policy,tone:"info"}),children:[e.jsx("div",{className:"space-y-2",children:Object.keys(W).map(b=>e.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:b}),e.jsx("button",{type:"button",className:kr("relative h-7 w-12 rounded-full border transition",W[b]?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>E(b),"aria-label":`Toggle MFA required for ${b}`,children:e.jsx("span",{className:kr("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",W[b]?"left-[22px]":"left-1")})})]},b))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Recommendation: keep MFA required for Finance, Approver, and Admin roles."})]})]})},"setup"):null,l==="trust"?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs(or,{title:"Trust this device",subtitle:"Reduce repeated prompts",right:e.jsx(ps,{label:y?"Enabled":"Off",tone:y?"good":"neutral"}),children:[e.jsx(Yp,{enabled:y,onChange:b=>{$(b),w({severity:"Info",actor:"You",category:"Device",title:"Trust device toggled",detail:`Trust device ${b?"enabled":"disabled"}.`}),a({title:"Updated",message:"Trust device updated.",kind:"success"})},label:"Trust this device",description:"If enabled, step-up prompts are reduced for this device."}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Expiry"}),e.jsx("select",{value:String(T),onChange:b=>{C(Number(b.target.value)),w({severity:"Info",actor:"You",category:"Device",title:"Trust expiry changed",detail:`Trust expiry set to ${b.target.value} days.`})},disabled:!y,className:kr("mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",!y&&"bg-slate-50 text-slate-500"),children:[7,30,90].map(b=>e.jsxs("option",{value:b,children:[b," days"]},b))}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Admin policy can cap trust duration."})]}),e.jsxs(fs,{variant:"danger",className:"mt-4 w-full",onClick:()=>{$(!1),w({severity:"Warning",actor:"You",category:"Device",title:"Trusted device revoked",detail:"Trust revoked for current device."}),a({title:"Revoked",message:"Trusted device revoked.",kind:"warn"})},children:[e.jsx(as,{className:"h-4 w-4"})," Revoke trust"]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: trust revocation should trigger tamper alerts if unusual."})]}),e.jsxs("div",{className:"lg:col-span-2 overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-2 border-b border-slate-200 px-4 py-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Login history and sessions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Review devices, revoke access, and force sign-out."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(fs,{variant:"outline",className:"text-xs",onClick:u,children:[e.jsx(jo,{className:"h-4 w-4"})," Sign out others"]}),e.jsxs(fs,{variant:"danger",className:"text-xs",onClick:()=>{F(b=>b.map(ae=>({...ae,status:ae.status==="Current"?"Current":"Signed out"}))),w({severity:"Critical",actor:"You",category:"Session",title:"Global sign-out",detail:"All non-current sessions signed out."}),a({title:"Global sign-out",message:"All non-current sessions signed out.",kind:"warn"})},children:[e.jsx(yt,{className:"h-4 w-4"})," Force global sign-out"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Session"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Device"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Location"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"IP"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Trusted"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Last seen"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsx("tbody",{children:R.map(b=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:b.id}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:b.device}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:b.location}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:b.ip}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ps,{label:b.trusted?"Yes":"No",tone:b.trusted?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Qp(b.lastSeenTs)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ps,{label:b.status,tone:b.status==="Current"?"info":b.status==="Active"?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(fs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>se(b.id),children:[e.jsx(Su,{className:"h-4 w-4"})," ",b.trusted?"Untrust":"Trust"]}),b.status!=="Current"&&b.status!=="Signed out"?e.jsxs(fs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>P(b.id),children:[e.jsx(jo,{className:"h-4 w-4"})," Sign out"]}):null]})})]},b.id))})]})}),e.jsx("div",{className:"border-t border-slate-200 px-4 py-3 text-xs text-slate-500",children:"Forced sign-out controls should be audit logged and may require step-up auth."})]})]})},"trust"):null,l==="conditional"?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs(or,{title:"Conditional access policies",subtitle:"IP allowlist, geo allowlist, and time restrictions",right:e.jsx(ps,{label:te||q||Pe?"Enabled":"Off",tone:te||q||Pe?"warn":"neutral"}),children:[e.jsx(Yp,{enabled:te,onChange:b=>{oe(b),w({severity:"Info",actor:"Org Admin",category:"Policy",title:"IP allowlist toggled",detail:b?"Enabled":"Disabled"})},label:"IP allowlist",description:"If enabled, IPs outside allowlist trigger step-up authentication."}),e.jsx(Yp,{enabled:q,onChange:b=>{je(b),w({severity:"Info",actor:"Org Admin",category:"Policy",title:"Geo allowlist toggled",detail:b?"Enabled":"Disabled"})},label:"Geo allowlist",description:"If enabled, locations outside allowlist trigger step-up authentication."}),e.jsx(Yp,{enabled:Pe,onChange:b=>{pe(b),w({severity:"Info",actor:"Org Admin",category:"Policy",title:"Time restriction toggled",detail:b?"Enabled":"Disabled"})},label:"Time restrictions",description:"If enabled, access outside allowed hours triggers step-up authentication."}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: you can switch from step-up to block for specific modules (Billing, Security) later."})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs(or,{title:"IP allowlist",subtitle:"Manage allowed IP addresses",right:e.jsx(ps,{label:te?"On":"Off",tone:te?"warn":"neutral"}),children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[G.map(b=>e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-slate-50 px-3 py-2 text-xs font-semibold text-slate-700 ring-1 ring-slate-200",children:[b,e.jsx("button",{type:"button",className:"rounded-full p-1 hover:bg-slate-200",onClick:()=>re(b),"aria-label":`Remove ${b}`,children:e.jsx(Qe,{className:"h-3.5 w-3.5"})})]},b)),G.length?null:e.jsx(ps,{label:"No IPs",tone:"warn"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-3",children:[e.jsx("div",{className:"sm:col-span-2",children:e.jsx(Hi,{label:"Add IP",value:Y,onChange:we,placeholder:"196.43.199.81"})}),e.jsx("div",{className:"flex items-end",children:e.jsxs(fs,{variant:"outline",className:"w-full",onClick:D,children:[e.jsx(gt,{className:"h-4 w-4"})," Add"]})})]})]}),e.jsxs(or,{title:"Geo allowlist",subtitle:"Manage allowed locations",right:e.jsx(ps,{label:q?"On":"Off",tone:q?"warn":"neutral"}),children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[_e.map(b=>e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-slate-50 px-3 py-2 text-xs font-semibold text-slate-700 ring-1 ring-slate-200",children:[b,e.jsx("button",{type:"button",className:"rounded-full p-1 hover:bg-slate-200",onClick:()=>k(b),"aria-label":`Remove ${b}`,children:e.jsx(Qe,{className:"h-3.5 w-3.5"})})]},b)),_e.length?null:e.jsx(ps,{label:"No locations",tone:"warn"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-3",children:[e.jsx("div",{className:"sm:col-span-2",children:e.jsx(Hi,{label:"Add location",value:be,onChange:Fe,placeholder:"Kampala, UG"})}),e.jsx("div",{className:"flex items-end",children:e.jsxs(fs,{variant:"outline",className:"w-full",onClick:v,children:[e.jsx(gt,{className:"h-4 w-4"})," Add"]})})]})]}),e.jsxs(or,{title:"Time restrictions",subtitle:"Allowed days and hours",right:e.jsx(ps,{label:Pe?"On":"Off",tone:Pe?"warn":"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Hi,{label:"Start",value:Q,onChange:Re,type:"time"}),e.jsx(Hi,{label:"End",value:ce,onChange:xe,type:"time"})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Allowed days"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map(b=>{const ae=he.includes(b);return e.jsx("button",{type:"button",className:kr("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",ae?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:ae?{background:cx.green}:void 0,onClick:()=>m(b),children:b},b)})})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: keep restrictions strict for Billing and Security roles."})]}),e.jsxs(or,{title:"Policy preview",subtitle:"Evaluate the current session context",right:e.jsx(ps,{label:B.status,tone:B.status==="Allowed"?"good":"warn"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Hi,{label:"Current IP",value:ye,onChange:Ke,placeholder:"196.43.199.81"}),e.jsx(Hi,{label:"Current geo",value:Le,onChange:Ne,placeholder:"Kampala, UG"}),e.jsx(Hi,{label:"Day",value:ge,onChange:$e,placeholder:"Wed",hint:"Mon..Sun"}),e.jsx(Hi,{label:"Time",value:ie,onChange:Oe,type:"time"})]}),B.reasons.length?e.jsxs("div",{className:"mt-3 rounded-2xl border border-amber-200 bg-amber-50 p-3 text-xs text-amber-900",children:[e.jsx("div",{className:"font-semibold",children:"Reasons"}),e.jsx("ul",{className:"mt-2 space-y-1",children:B.reasons.map(b=>e.jsxs("li",{children:[" ",b]},b))})]}):e.jsx("div",{className:"mt-3 rounded-2xl border border-emerald-200 bg-emerald-50 p-3 text-xs text-emerald-900",children:"Allowed: no step-up required."})]})]})]})},"conditional"):null,l==="breakglass"?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs(or,{title:"Break-glass overview",subtitle:"Emergency-only admin accounts",right:e.jsx(ps,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:["Break-glass is for emergencies only. Recommended controls:",e.jsxs("ul",{className:"mt-2 space-y-1",children:[e.jsx("li",{children:"1) Dual-control approval to unlock"}),e.jsx("li",{children:"2) Step-up authentication always"}),e.jsx("li",{children:"3) Rotate emergency codes after any use"})]})]}),e.jsxs(fs,{variant:"outline",className:"mt-3 w-full",onClick:()=>{w({severity:"Critical",actor:"System",category:"Tamper",title:"Tamper alert test",detail:"Simulated tamper alert triggered."}),a({title:"Tamper test",message:"Created a simulated tamper alert.",kind:"warn"})},children:[e.jsx(Et,{className:"h-4 w-4"})," Trigger tamper test"]})]}),e.jsxs("div",{className:"lg:col-span-2 overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-sm",children:[e.jsxs("div",{className:"border-b border-slate-200 px-4 py-3",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Break-glass accounts"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"View codes, rotate, lock, and audit usage."})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Email"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Enabled"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Locked"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Last rotated"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Last used"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsx("tbody",{children:Se.map(b=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:b.email}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ps,{label:b.enabled?"Yes":"No",tone:b.enabled?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ps,{label:b.locked?"Locked":"Open",tone:b.locked?"bad":"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Qp(b.lastRotatedTs)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:b.lastUsedTs?Qp(b.lastUsedTs):"Never"}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(fs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>f(b.id),children:[e.jsx(xu,{className:"h-4 w-4"})," View codes"]}),e.jsxs(fs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>U(b.id),children:[e.jsx(ht,{className:"h-4 w-4"})," Rotate"]}),e.jsxs(fs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>p(b.id),children:[e.jsx(yt,{className:"h-4 w-4"})," Toggle enabled"]}),e.jsxs(fs,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>M(b.id),children:[e.jsx(ia,{className:"h-4 w-4"})," ",b.locked?"Unlock":"Lock"]})]})})]},b.id))})]})}),e.jsx("div",{className:"border-t border-slate-200 px-4 py-3 text-xs text-slate-500",children:"Premium: break-glass unlock should require dual approval and create tamper alerts."})]})]})},"breakglass"):null,l==="events"?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs(or,{title:"Tamper alerts",subtitle:"Detect and respond to unusual actions",right:e.jsx(ps,{label:`${ue} open`,tone:ue?"warn":"good"}),children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Tamper events include:",e.jsxs("ul",{className:"mt-2 space-y-1 text-xs text-slate-600",children:[e.jsx("li",{children:"1) MFA disable attempts"}),e.jsx("li",{children:"2) Break-glass changes"}),e.jsx("li",{children:"3) Conditional access bypass attempts"}),e.jsx("li",{children:"4) Forced sign-out anomalies"})]})]}),e.jsxs(fs,{variant:"outline",className:"mt-3 w-full",onClick:()=>{w({severity:"Critical",actor:"System",category:"Tamper",title:"Policy tamper detected",detail:"Attempt to modify allowlist without permission."}),a({title:"Tamper event",message:"Created a simulated tamper event.",kind:"warn"})},children:[e.jsx(Et,{className:"h-4 w-4"})," Simulate tamper"]})]}),e.jsxs("div",{className:"lg:col-span-2 overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-3 border-b border-slate-200 px-4 py-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Security events"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Exportable logs for audits and incident response."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("select",{value:Ae,onChange:b=>Ve(b.target.value),className:"rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none",children:["All","Open","Resolved"].map(b=>e.jsx("option",{value:b,children:b},b))}),e.jsx("select",{value:Ye,onChange:b=>Be(b.target.value),className:"rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none",children:["All","Info","Warning","Critical"].map(b=>e.jsx("option",{value:b,children:b},b))}),e.jsxs(fs,{variant:"outline",className:"text-xs",onClick:()=>De("csv"),children:[e.jsx(pt,{className:"h-4 w-4"})," CSV"]}),e.jsxs(fs,{variant:"outline",className:"text-xs",onClick:()=>De("json"),children:[e.jsx(kt,{className:"h-4 w-4"})," JSON"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Severity"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Category"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Title"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[Me.map(b=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:FE(b.ts)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ps,{label:b.severity,tone:jU(b.severity)})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:b.category}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:b.title}),e.jsx("div",{className:"mt-0.5 text-xs text-slate-500",children:b.detail}),e.jsx("div",{className:"mt-0.5 text-xs text-slate-400",children:b.id})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:b.actor}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ps,{label:b.status,tone:b.status==="Open"?"warn":"good"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[b.status==="Open"?e.jsxs(fs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>S(b.id),children:[e.jsx(tt,{className:"h-4 w-4"})," Resolve"]}):e.jsx(ps,{label:"Resolved",tone:"good"}),e.jsxs(fs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{a({title:"Details",message:"Open event detail panel (demo).",kind:"info"})},children:[e.jsx(en,{className:"h-4 w-4"})," Details"]})]})})]},b.id)),Me.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10",children:e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(yt,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No events"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Try changing filters."})]})})})]})]})}),e.jsx("div",{className:"border-t border-slate-200 px-4 py-3 text-xs text-slate-500",children:"Events are exportable and audit-friendly. Tamper alerts should be immutable in production."})]})]})},"events"):null]})})]})}),e.jsx(fU,{open:Ge,title:"Break-glass emergency codes",subtitle:"Emergency-only. Rotate after any use.",onClose:()=>We(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(fs,{variant:"outline",onClick:()=>We(!1),children:"Close"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(fs,{variant:"outline",onClick:()=>{const b=Se.find(ae=>ae.id===ze);b&&fe(b.emergencyCodes.join(`
`))},children:[e.jsx(ss,{className:"h-4 w-4"})," Copy"]}),e.jsxs(fs,{variant:"outline",onClick:()=>{const b=Se.find(ae=>ae.id===ze);b&&(Jp(`breakglass-${b.id}-codes.txt`,b.emergencyCodes.join(`
`)),a({title:"Downloaded",message:"Emergency codes downloaded.",kind:"success"}))},children:[e.jsx(pt,{className:"h-4 w-4"})," Download"]})]})]}),children:(()=>{const b=Se.find(ae=>ae.id===ze);return b?e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ps,{label:b.email,tone:"neutral"}),e.jsx(ps,{label:b.enabled?"Enabled":"Disabled",tone:b.enabled?"good":"neutral"}),e.jsx(ps,{label:b.locked?"Locked":"Open",tone:b.locked?"bad":"neutral"}),e.jsx(ps,{label:`Rotated: ${Qp(b.lastRotatedTs)}`,tone:"info"})]}),e.jsx("div",{className:"mt-4 grid grid-cols-1 gap-2 sm:grid-cols-2",children:b.emergencyCodes.map(ae=>e.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("span",{className:"font-mono text-sm font-semibold text-slate-900",children:ae}),e.jsx(ps,{label:"One-time",tone:"neutral"})]},ae))}),e.jsx("div",{className:"mt-4 rounded-2xl border border-amber-200 bg-amber-50 p-3 text-xs text-amber-900",children:"Do not store these in plain text. Rotate after any use."})]}):null})()}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-7xl px-4 text-xs text-slate-500 md:px-6",children:"X2 MFA page: authenticator setup, backup codes, device trust expiry, role-based MFA policies, session history + forced sign-out, conditional access policies, break-glass controls, tamper alerts, and exportable security events."})})]})}function or({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}const cg={green:"#03CD8C",orange:"#F77F00"};function Jl(...t){return t.filter(Boolean).join(" ")}function wU(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function kU(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function CU(t,s,a){return Math.max(s,Math.min(a,t))}function cl({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Jl("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Vl({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:cg.green}:t==="accent"?{background:cg.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Jl(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Tv({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:Jl("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:Jl("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function Tr({icon:t,label:s,value:a,onChange:l,type:n="text",placeholder:r,hint:i,required:o,disabled:c}){const x=!!o&&!a.trim();return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"text-xs font-semibold text-slate-600",children:[s,o?e.jsx("span",{className:"text-rose-600",children:" *"}):null]}),i?e.jsx("div",{className:"text-xs text-slate-500",children:i}):null]}),e.jsxs("div",{className:Jl("mt-2 flex items-center gap-2 rounded-2xl border bg-white px-3 py-2.5 shadow-sm focus-within:ring-4",c?"border-slate-200 bg-slate-50 text-slate-500":x?"border-rose-300 focus-within:ring-rose-100":"border-slate-200 focus-within:ring-emerald-100"),children:[e.jsx("span",{className:"text-slate-500",children:t}),e.jsx("input",{type:n,value:a,onChange:j=>l(j.target.value),placeholder:r,disabled:c,className:Jl("w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400",c&&"text-slate-500")})]}),x?e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:"Required"}):null]})}function SU({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Jl("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function tm({idx:t,active:s,done:a,label:l}){return e.jsxs("div",{className:Jl("flex items-center gap-2 rounded-full px-3 py-2 text-xs font-semibold ring-1",s?"bg-emerald-600 text-white ring-emerald-600":a?"bg-emerald-50 text-emerald-800 ring-emerald-200":"bg-white text-slate-700 ring-slate-200"),style:s?{background:cg.green}:void 0,children:[e.jsx("span",{className:Jl("grid h-6 w-6 place-items-center rounded-full",s?"bg-white/20":a?"bg-emerald-100":"bg-slate-100"),children:a?e.jsx(tt,{className:"h-4 w-4"}):e.jsx("span",{children:t})}),l]})}function td({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function AU(t){const s=t.trim().toLowerCase().split("@");return s.length===2?s[1]:""}function EU(t,s,a){var r;const l=AU(t),n=((r=t.split("@")[0])==null?void 0:r.toLowerCase())||"";return s?a==="Finance"?{group:"Finance",role:"Accountant",reason:"HRIS department = Finance"}:a==="Procurement"?{group:"Procurement",role:"Approver",reason:"HRIS department = Procurement"}:a==="Sales"?{group:"Sales",role:"User",reason:"HRIS department = Sales"}:a==="Operations"?{group:"Operations",role:"Manager",reason:"HRIS department = Operations"}:{group:"Admin",role:"User",reason:"HRIS department default"}:l.endsWith("acme.com")?n.includes("finance")||n.includes("account")?{group:"Finance",role:"Accountant",reason:"Matched email local-part pattern"}:n.includes("proc")?{group:"Procurement",role:"Approver",reason:"Matched email local-part pattern"}:n.includes("admin")?{group:"Admin",role:"Org Admin",reason:"Admin naming convention"}:{group:"Operations",role:"User",reason:"Corporate domain default"}:{group:"Operations",role:"User",reason:"Fallback rule"}}function c4(){const[t,s]=d.useState([]),a=V=>{const E=wU("toast");s(u=>[{id:E,...V},...u].slice(0,4)),window.setTimeout(()=>s(u=>u.filter(P=>P.id!==E)),3200)},[l,n]=d.useState(1),[r,i]=d.useState("INV-CPAY-8F2K-UG"),[o,c]=d.useState("finance@acme.com"),[x,j]=d.useState("+256 700 000 000"),[g]=d.useState(Date.now()+2*24*60*60*1e3),[y,$]=d.useState(!1),[T,C]=d.useState("finance@acme.com"),[W,L]=d.useState("+256 700 000 000"),[R,F]=d.useState("existing"),[te,oe]=d.useState("finance@acme.com"),[G,H]=d.useState(!1),[Y,we]=d.useState(""),[q,je]=d.useState(""),[_e,Ee]=d.useState("finance@acme.com"),[be,Fe]=d.useState("+256 700 000 000"),[Pe,pe]=d.useState(""),[Q,Re]=d.useState(!1),[ce,xe]=d.useState(""),he=d.useMemo(()=>({organization:"Acme Group Ltd",group:"Finance",role:"Accountant",spendLimits:{daily:"UGX 3,000,000",weekly:"UGX 12,000,000",monthly:"UGX 30,000,000"},autoApproval:{eligible:!1,under:"UGX 0"},defaultCostCenter:"FIN-OPS",defaultProjectTag:"Audit-2026",enforcedModules:["Rides & Logistics","E-Commerce","EVs & Charging","Finance & Payments","Other Service Module"],enforcedMarketplaces:["MyLiveDealz","EVmart","ServiceMart","GadgetMart","Other Marketplace"]}),[]),[de,ye]=d.useState(!0),[Ke,Le]=d.useState(!1),[Ne,ge]=d.useState("Finance"),$e=d.useMemo(()=>EU(R==="existing"?te:_e,Ke,Ne),[R,te,_e,Ke,Ne]),ie=d.useMemo(()=>de?{...he,group:$e.group,role:$e.role}:he,[he,de,$e]),[Oe,Se]=d.useState(!0),[Te,Ge]=d.useState({businessOnly:!1,noPersonalUse:!1,complyPolicy:!1,dataPrivacy:!1,antiBribery:!1}),We=d.useMemo(()=>Oe?Object.values(Te).every(Boolean):!0,[Oe,Te]),[ze,Ue]=d.useState(!1),[le,z]=d.useState(!1),[Ae,Ve]=d.useState(!1),Ye=d.useMemo(()=>ze&&le&&Ae,[ze,le,Ae]),Be=d.useMemo(()=>kU(g),[g]),w=d.useMemo(()=>r.trim()?!o.trim()||!x.trim()?{ok:!1,reason:"Missing invite email/phone"}:y||Date.now()>g?{ok:!1,reason:"Invite expired"}:T.trim().toLowerCase()!==o.trim().toLowerCase()?{ok:!1,reason:"Email does not match invite"}:W.trim()!==x.trim()?{ok:!1,reason:"Phone does not match invite"}:{ok:!0,reason:"Valid"}:{ok:!1,reason:"Missing token"},[r,o,x,y,g,T,W]),B=()=>{if(!w.ok){a({title:"Invite invalid",message:w.reason,kind:"warn"});return}a({title:"Invite validated",message:"Proceed to link your EVzone account.",kind:"success"}),n(2)},ue=()=>{if(!te.trim()){a({title:"Missing identifier",message:"Enter email or phone.",kind:"warn"});return}H(!0),a({title:"OTP sent",message:"Verification code sent (demo).",kind:"success"})},ne=()=>{if(!G){a({title:"Send OTP first",message:"Click Send OTP.",kind:"warn"});return}if(Y.trim().length<4){a({title:"Invalid OTP",message:"Enter the code you received.",kind:"warn"});return}const V=`EVZ-${Math.floor(1e5+Math.random()*9e5)}`;xe(V),Re(!0),a({title:"Account linked",message:`Linked to EVzone ID ${V}.`,kind:"success"}),n(3)},Me=()=>{if(!q.trim()||!_e.trim()||!be.trim()||!Pe.trim()){a({title:"Missing fields",message:"Name, email, phone and password are required.",kind:"warn"});return}const V=`EVZ-${Math.floor(1e5+Math.random()*9e5)}`;xe(V),Re(!0),a({title:"Account created",message:`EVzone account created: ${V}.`,kind:"success"}),n(3)},De=()=>{if(!Q){a({title:"Not linked",message:"Link or create your EVzone account first.",kind:"warn"});return}if(!We){a({title:"Checklist incomplete",message:"Complete required attestations to continue.",kind:"warn"});return}a({title:"Defaults applied",message:"Group, role, limits and tags have been applied.",kind:"success"}),n(4)},fe=()=>{if(!Ye){a({title:"Complete welcome",message:"Confirm the policy highlights first.",kind:"warn"});return}a({title:"Welcome",message:"CorporatePay is active for your EVzone account.",kind:"success"}),n(5)},me=async V=>{try{await navigator.clipboard.writeText(V),a({title:"Copied",message:V,kind:"success"})}catch{a({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},Xe=d.useMemo(()=>{const V=(l-1)/4;return Math.round(CU(V*100,0,100))},[l]);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(SU,{toasts:t,onDismiss:V=>s(E=>E.filter(u=>u.id!==V))}),e.jsx("div",{className:"mx-auto max-w-7xl px-4 py-10 md:px-6",children:e.jsxs("div",{className:"rounded-[28px] border border-slate-200 bg-white p-6 shadow-[0_30px_90px_rgba(2,8,23,0.10)]",children:[e.jsxs("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:cg.green},children:e.jsx(Ud,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Invite acceptance and EVzone account linking"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Validate invite, link/create EVzone account, apply defaults, then complete welcome wizard."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(cl,{label:`Completion: ${Xe}%`,tone:Xe>=75?"good":Xe>=40?"warn":"neutral"}),e.jsx(cl,{label:`Expires: ${Be}`,tone:y?"bad":"warn"}),e.jsxs(Vl,{variant:"outline",className:"text-xs",onClick:()=>$(V=>!V),children:[e.jsx(Et,{className:"h-4 w-4"})," Simulate expired"]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(cl,{label:`Org: ${ie.organization}`,tone:"neutral"}),e.jsx(cl,{label:`Role: ${ie.role}`,tone:"info"}),e.jsx(cl,{label:`Group: ${ie.group}`,tone:"neutral"})]})]}),e.jsxs("div",{className:"mt-5 flex flex-wrap gap-2",children:[e.jsx(tm,{idx:1,active:l===1,done:l>1,label:"Validate invite"}),e.jsx(tm,{idx:2,active:l===2,done:l>2,label:"Link account"}),e.jsx(tm,{idx:3,active:l===3,done:l>3,label:"Defaults and checklist"}),e.jsx(tm,{idx:4,active:l===4,done:l>4,label:"Welcome"}),e.jsx(tm,{idx:5,active:l===5,done:!1,label:"Done"})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 gap-6 lg:grid-cols-3",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs(td,{title:"Invite summary",subtitle:"The invite must match your email and phone",right:e.jsx(cl,{label:w.ok?"Valid":"Check",tone:w.ok?"good":"warn"}),children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Token"}),e.jsxs("div",{className:"mt-1 flex items-center justify-between gap-2",children:[e.jsx("span",{className:"font-mono text-sm font-semibold text-slate-900",children:r}),e.jsxs(Vl,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>me(r),children:[e.jsx(ss,{className:"h-4 w-4"})," Copy"]})]})]}),e.jsx(Rv,{icon:e.jsx(Xs,{className:"h-4 w-4"}),label:"Invite email",value:o}),e.jsx(Rv,{icon:e.jsx(Gp,{className:"h-4 w-4"}),label:"Invite phone",value:x}),e.jsx(Rv,{icon:e.jsx(ct,{className:"h-4 w-4"}),label:"Expires",value:Be})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"If your invite expires, request a new invite from your organization admin."})]}),e.jsxs(td,{title:"Just-in-time provisioning",subtitle:"Premium: auto role assignment based on domain/HRIS rules",right:e.jsx(cl,{label:de?"On":"Off",tone:de?"info":"neutral"}),children:[e.jsx(Tv,{enabled:de,onChange:ye,label:"Enable JIT provisioning",description:"Applies group and role from rules on acceptance."}),e.jsx(Tv,{enabled:Ke,onChange:Le,label:"HRIS rule (Phase 2)",description:"When enabled, HR department drives role assignment."}),e.jsxs("div",{className:Jl("mt-3",!Ke&&"opacity-60"),children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"HR department"}),e.jsx("select",{value:Ne,onChange:V=>ge(V.target.value),disabled:!Ke,className:Jl("mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",!Ke&&"bg-slate-50 text-slate-500"),children:["Finance","Procurement","Sales","Operations","Admin"].map(V=>e.jsx("option",{value:V,children:V},V))})]}),e.jsxs("div",{className:"mt-3 rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Matched rule"}),e.jsxs("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:[$e.group,"  ",$e.role]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:$e.reason})]}),e.jsx("div",{className:"mt-3 text-xs text-slate-500",children:"JIT provisioning modifies group and role only. Spend limits remain admin-defined."})]})]}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(lt,{mode:"wait",children:[l===1?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs(td,{title:"Validate invite",subtitle:"Token, email, and phone must match the invitation",right:e.jsx(cl,{label:w.ok?"Ready":"Needs match",tone:w.ok?"good":"warn"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Tr,{icon:e.jsx(Ud,{className:"h-4 w-4"}),label:"Invite token",value:r,onChange:i,placeholder:"INV-...",required:!0}),e.jsx(Tr,{icon:e.jsx(Xs,{className:"h-4 w-4"}),label:"Invite email",value:o,onChange:c,placeholder:"you@company.com",required:!0}),e.jsx(Tr,{icon:e.jsx(Gp,{className:"h-4 w-4"}),label:"Invite phone",value:x,onChange:j,placeholder:"+256 ...",required:!0}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Expiry"}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:Be}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Invite links expire for security."})]})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Match details"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"To simulate verification, enter the same email and phone as the invite."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Tr,{icon:e.jsx(Xs,{className:"h-4 w-4"}),label:"Your email",value:T,onChange:C,placeholder:"finance@acme.com",required:!0}),e.jsx(Tr,{icon:e.jsx(Gp,{className:"h-4 w-4"}),label:"Your phone",value:W,onChange:L,placeholder:"+256 700...",required:!0})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:["Status: ",e.jsx("span",{className:"font-semibold text-slate-900",children:w.ok?"Valid":w.reason})]})]}),e.jsxs("div",{className:"mt-4 flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsxs(Vl,{variant:"outline",onClick:()=>a({title:"Resend invite",message:"Admin resend flow opened (demo).",kind:"info"}),children:[e.jsx(ri,{className:"h-4 w-4"})," Request resend"]}),e.jsxs(Vl,{variant:"primary",onClick:B,children:[e.jsx(ct,{className:"h-4 w-4"})," Validate"]})]})]})},"s1"):null,l===2?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs(td,{title:"Link your EVzone account",subtitle:"Connect to an existing account or create a new one",right:e.jsx(cl,{label:Q?"Linked":"Not linked",tone:Q?"good":"warn"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(u4,{title:"Link existing",desc:"Use OTP to verify ownership of your EVzone account.",active:R==="existing",onClick:()=>F("existing"),icon:e.jsx(Ud,{className:"h-4 w-4"})}),e.jsx(u4,{title:"Create new",desc:"Create an EVzone account and link it to this organization.",active:R==="new",onClick:()=>F("new"),icon:e.jsx(dx,{className:"h-4 w-4"})})]}),R==="existing"?e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Verify existing account"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Enter email/phone and receive an OTP."})]}),Q?e.jsx(cl,{label:`Linked: ${ce}`,tone:"good"}):e.jsx(cl,{label:"OTP required",tone:"warn"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Tr,{icon:e.jsx(Xs,{className:"h-4 w-4"}),label:"Email or phone",value:te,onChange:oe,placeholder:"you@company.com or +256...",required:!0}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"OTP"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx("input",{value:Y,onChange:V=>we(V.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"123456",className:"w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"}),e.jsxs(Vl,{variant:"outline",className:"px-3 py-2 text-xs",onClick:ue,children:[e.jsx(xu,{className:"h-4 w-4"})," Send"]})]}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Demo: any 4+ digits verify."})]})]}),e.jsxs("div",{className:"mt-4 flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Vl,{variant:"outline",onClick:()=>n(1),children:"Back"}),e.jsxs(Vl,{variant:"primary",onClick:ne,children:[e.jsx(ct,{className:"h-4 w-4"})," Verify and link"]})]})]}):null,R==="new"?e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Create new EVzone account"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Account will be linked to the organization on acceptance."})]}),e.jsx(cl,{label:"New",tone:"info"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Tr,{icon:e.jsx(dx,{className:"h-4 w-4"}),label:"Full name",value:q,onChange:je,placeholder:"Your name",required:!0}),e.jsx(Tr,{icon:e.jsx(Xs,{className:"h-4 w-4"}),label:"Email",value:_e,onChange:Ee,placeholder:"you@company.com",required:!0}),e.jsx(Tr,{icon:e.jsx(Gp,{className:"h-4 w-4"}),label:"Phone",value:be,onChange:Fe,placeholder:"+256...",required:!0}),e.jsx(Tr,{icon:e.jsx(ia,{className:"h-4 w-4"}),label:"Password",value:Pe,onChange:pe,type:"password",placeholder:"",required:!0})]}),e.jsxs("div",{className:"mt-4 flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Vl,{variant:"outline",onClick:()=>n(1),children:"Back"}),e.jsxs(Vl,{variant:"primary",onClick:Me,children:[e.jsx(dx,{className:"h-4 w-4"})," Create and link"]})]})]}):null,e.jsx("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"After linking, the system applies admin defaults (group, role, limits, tags) to your CorporatePay profile."})]})},"s2"):null,l===3?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs(td,{title:"Review defaults and accept",subtitle:"Admin-defined defaults applied on acceptance",right:e.jsx(cl,{label:"Ready",tone:Q?"good":"warn"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(rc,{icon:e.jsx(Os,{className:"h-4 w-4"}),label:"Group",value:ie.group}),e.jsx(rc,{icon:e.jsx(yt,{className:"h-4 w-4"}),label:"Role",value:ie.role}),e.jsx(rc,{icon:e.jsx(Ia,{className:"h-4 w-4"}),label:"Spend limits",value:`${ie.spendLimits.daily} daily  ${ie.spendLimits.monthly} monthly`}),e.jsx(rc,{icon:e.jsx(ct,{className:"h-4 w-4"}),label:"Auto-approval",value:ie.autoApproval.eligible?`Eligible under ${ie.autoApproval.under}`:"Not eligible"}),e.jsx(rc,{icon:e.jsx(ht,{className:"h-4 w-4"}),label:"Default cost center",value:ie.defaultCostCenter}),e.jsx(rc,{icon:e.jsx(ht,{className:"h-4 w-4"}),label:"Default project tag",value:ie.defaultProjectTag})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Enabled modules and marketplaces"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"These are the default CorporatePay-enabled areas for your organization."}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:ie.enforcedModules.map(V=>e.jsx(cl,{label:V,tone:"neutral"},V))}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:ie.enforcedMarketplaces.map(V=>e.jsx(cl,{label:V,tone:V==="MyLiveDealz"?"info":"neutral"},V))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:'Note: "Other Service Module" and "Other Marketplace" slots allow future expansion without redesign.'})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Acceptance checklist"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: compliance attestations can be required by policy."})]}),e.jsx(Tv,{enabled:Oe,onChange:Se,label:"Require attestations",description:"If on, all boxes must be checked"})]}),e.jsxs("div",{className:Jl("mt-4 space-y-2",!Oe&&"opacity-70"),children:[e.jsx(Xi,{label:"I will use CorporatePay for business purposes only",checked:Te.businessOnly,onChange:V=>Ge(E=>({...E,businessOnly:V})),disabled:!Oe}),e.jsx(Xi,{label:"I will not use CorporatePay for personal spending",checked:Te.noPersonalUse,onChange:V=>Ge(E=>({...E,noPersonalUse:V})),disabled:!Oe}),e.jsx(Xi,{label:"I agree to follow corporate spending policies",checked:Te.complyPolicy,onChange:V=>Ge(E=>({...E,complyPolicy:V})),disabled:!Oe}),e.jsx(Xi,{label:"I understand data privacy and audit logging",checked:Te.dataPrivacy,onChange:V=>Ge(E=>({...E,dataPrivacy:V})),disabled:!Oe}),e.jsx(Xi,{label:"I will comply with anti-bribery and compliance rules",checked:Te.antiBribery,onChange:V=>Ge(E=>({...E,antiBribery:V})),disabled:!Oe})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:We?"Checklist complete.":"Complete the checklist to proceed."})]}),e.jsxs("div",{className:"mt-4 flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Vl,{variant:"outline",onClick:()=>n(2),children:"Back"}),e.jsxs(Vl,{variant:"primary",onClick:De,children:[e.jsx(ct,{className:"h-4 w-4"})," Accept invite"]})]})]})},"s3"):null,l===4?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs(td,{title:"Welcome wizard",subtitle:"Policy highlights, do/dont rules, and what changes in the app",right:e.jsx(cl,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"CorporatePay available in the EVzone app"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"You continue using the normal EVzone apps. Only the payment method changes."}),e.jsxs("div",{className:"mt-3 rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Checkout behavior"}),e.jsxs("ul",{className:"mt-2 space-y-1 text-xs text-slate-700",children:[e.jsx("li",{children:"1) You choose a ride/service/purchase as usual."}),e.jsxs("li",{children:["2) At checkout, select ",e.jsx("span",{className:"font-semibold text-slate-900",children:"CorporatePay"}),"."]}),e.jsx("li",{children:"3) Policies and approvals may apply."}),e.jsx("li",{children:"4) Spend maps to your group and cost center automatically."})]})]}),e.jsx("div",{className:"mt-3",children:e.jsx(Xi,{label:"I understand CorporatePay appears at checkout",checked:Ae,onChange:Ve})})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Policy highlights"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Key rules you should follow."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3",children:[e.jsx(m4,{kind:"do",title:"Do",items:["Use correct purpose tags (airport, client meeting, etc.)",`Stay within spend limits (${ie.spendLimits.daily} daily)`,"Use approved vendors and marketplaces"]}),e.jsx(m4,{kind:"dont",title:"Dont",items:["Use CorporatePay for personal purchases","Bypass approvals or split purchases to avoid thresholds","Buy restricted categories (example: alcohol)"]})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx(Xi,{label:"I understand the policy do/dont rules",checked:ze,onChange:Ue}),e.jsx(Xi,{label:"I understand approvals can be required above thresholds",checked:le,onChange:z})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: if you need an exception, request approval in-app. All actions are audited."})]})]}),e.jsxs("div",{className:"mt-4 flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Vl,{variant:"outline",onClick:()=>n(3),children:"Back"}),e.jsxs(Vl,{variant:"primary",onClick:fe,children:[e.jsx(et,{className:"h-4 w-4"})," Finish"]})]})]})},"s4"):null,l===5?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs(td,{title:"Youre all set",subtitle:"CorporatePay is now active for your EVzone account",right:e.jsx(cl,{label:"Completed",tone:"good"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Zp,{icon:e.jsx(Ia,{className:"h-5 w-5"}),title:"CorporatePay enabled",desc:"CorporatePay can now be selected at checkout for eligible transactions."}),e.jsx(Zp,{icon:e.jsx(yt,{className:"h-5 w-5"}),title:"Policies enforced",desc:"Some transactions will require approval depending on rules and thresholds."}),e.jsx(Zp,{icon:e.jsx(Os,{className:"h-5 w-5"}),title:"Org mapping",desc:`Spend maps to group ${ie.group} and cost center ${ie.defaultCostCenter}.`}),e.jsx(Zp,{icon:e.jsx(JF,{className:"h-5 w-5"}),title:"Audit ready",desc:"All approvals and changes are logged for compliance."})]}),e.jsx("div",{className:"mt-4 rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ht,{className:"mt-0.5 h-4 w-4 text-emerald-700"}),e.jsxs("div",{className:"text-xs text-slate-600",children:["EVzone ID: ",e.jsx("span",{className:"font-semibold text-slate-900",children:ce}),"  Organization: ",e.jsx("span",{className:"font-semibold text-slate-900",children:ie.organization})]})]})}),e.jsxs("div",{className:"mt-4 flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsxs(Vl,{variant:"outline",onClick:()=>a({title:"Guide",message:"Opening onboarding guide (demo).",kind:"info"}),children:[e.jsx(Fu,{className:"h-4 w-4"})," View guide"]}),e.jsxs(Vl,{variant:"primary",onClick:()=>a({title:"Dashboard",message:"Opening CorporatePay Admin Console (demo).",kind:"success"}),children:[e.jsx(et,{className:"h-4 w-4"})," Open dashboard"]})]})]})},"s5"):null]})})]}),e.jsx("div",{className:"mt-6 text-xs text-slate-500",children:"X3: validates invite token/email/phone/expiry, links or creates EVzone account, applies admin defaults (group/role/limits/auto-approval/cost center/project tags), and completes a premium welcome wizard."})]})}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-7xl px-4 text-xs text-slate-500 md:px-6",children:"X3 Invite Acceptance: includes JIT provisioning (domain/HRIS rules), compliance checklist, and welcome wizard for policy highlights."})})]})}function Rv({icon:t,label:s,value:a}){return e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-600",children:t}),e.jsx("span",{className:"text-xs font-semibold text-slate-600",children:s})]}),e.jsx("span",{className:"text-xs font-semibold text-slate-900",children:a})]})})}function u4({title:t,desc:s,icon:a,active:l,onClick:n}){return e.jsx("button",{type:"button",onClick:n,className:Jl("rounded-3xl border p-4 text-left transition",l?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-slate-900",children:[e.jsx("span",{className:"text-slate-600",children:a}),t]}),e.jsx("div",{className:"mt-2 text-sm text-slate-600",children:s})]}),l?e.jsx(ct,{className:"h-5 w-5 text-emerald-700"}):null]})})}function rc({icon:t,label:s,value:a}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-600",children:t}),e.jsx("span",{className:"text-xs font-semibold text-slate-600",children:s})]}),e.jsx(cl,{label:"Applied",tone:"good"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:a})]})}function Xi({label:t,checked:s,onChange:a,disabled:l}){return e.jsxs("label",{className:Jl("flex items-start gap-3 rounded-2xl border border-slate-200 bg-white p-3",l&&"opacity-60"),children:[e.jsx("input",{type:"checkbox",checked:s,disabled:l,onChange:n=>a(n.target.checked),className:"mt-1 h-4 w-4 rounded border-slate-300"}),e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:t})]})}function m4({kind:t,title:s,items:a}){const l=t==="do"?"border-emerald-200 bg-emerald-50":"border-rose-200 bg-rose-50",n=t==="do"?"#10B981":"#F43F5E";return e.jsxs("div",{className:Jl("rounded-3xl border p-4",l),children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:s}),e.jsx("ul",{className:"mt-2 space-y-1 text-sm text-slate-700",children:a.map(r=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:n}}),e.jsx("span",{children:r})]},r))})]})}function Zp({icon:t,title:s,desc:a}){return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"grid h-9 w-9 place-items-center rounded-2xl bg-emerald-50 text-emerald-700",children:t}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:s}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a})]})]})})}const MU=[{path:is.AUTH.LOGIN,element:qt.createElement(hU)},{path:is.AUTH.MFA,element:qt.createElement(NU)},{path:is.AUTH.INVITE,element:qt.createElement(c4)},{path:is.AUTH.INVITE_TOKEN,element:qt.createElement(c4)}],ug={green:"#03CD8C",orange:"#F77F00"};function ml(...t){return t.filter(Boolean).join(" ")}function PU(t,s,a){return Math.max(s,Math.min(a,t))}function As(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function x4(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function Rl({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200 dark:bg-emerald-900/40 dark:text-emerald-300 dark:ring-emerald-800",warn:"bg-amber-50 text-amber-800 ring-amber-200 dark:bg-amber-900/40 dark:text-amber-300 dark:ring-amber-800",bad:"bg-rose-50 text-rose-700 ring-rose-200 dark:bg-rose-900/40 dark:text-rose-300 dark:ring-rose-800",info:"bg-blue-50 text-blue-700 ring-blue-200 dark:bg-blue-900/40 dark:text-blue-300 dark:ring-blue-800",neutral:"bg-slate-50 text-slate-700 ring-slate-200 dark:bg-slate-800 dark:text-slate-300 dark:ring-slate-700"};return e.jsx("span",{className:ml("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function _l({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200 dark:shadow-none",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200 dark:shadow-none",outline:"border border-slate-200 bg-white text-slate-900 shadow-sm hover:bg-slate-50 focus:ring-slate-200 dark:border-slate-700 dark:bg-slate-800 dark:text-white dark:hover:bg-slate-700",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200 dark:text-slate-300 dark:hover:bg-slate-800",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100 dark:border-rose-900 dark:bg-rose-950 dark:text-rose-300"},c=t==="primary"?{background:ug.green}:t==="accent"?{background:ug.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:ml(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function OU({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:ml("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function eh({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="900px",actions:o}){return e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 bottom-4 top-4 z-50 mx-auto flex w-[min(980px,calc(100vw-2rem))] flex-col overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)] dark:border-slate-800 dark:bg-slate-900 dark:shadow-none",style:{maxWidth:i,maxHeight:"92vh"},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex shrink-0 items-start justify-between gap-3 border-b border-slate-200 px-5 py-4 dark:border-slate-800",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600 dark:text-slate-400",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(OU,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100 dark:text-slate-400 dark:hover:bg-slate-800",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"shrink-0 border-t border-slate-200 px-5 py-4 dark:border-slate-800",children:r}):null]})]}):null})}function TU({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur dark:border-slate-800 dark:bg-slate-900/90 dark:shadow-none",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:ml("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400",a.kind==="warn"&&"bg-amber-50 text-amber-800 dark:bg-amber-900/30 dark:text-amber-400",a.kind==="error"&&"bg-rose-50 text-rose-700 dark:bg-rose-900/30 dark:text-rose-400",a.kind==="info"&&"bg-blue-50 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600 dark:text-slate-400",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100 dark:text-slate-400 dark:hover:bg-slate-800",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function p4({title:t,rows:s,total:a}){return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 dark:border-slate-800 dark:bg-slate-900",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs font-semibold text-slate-700 dark:text-slate-300",children:[e.jsx("span",{children:t}),e.jsx("span",{children:As(a)})]}),e.jsx("div",{className:"mt-2 flex h-2 w-full overflow-hidden rounded-full bg-slate-100 dark:bg-slate-800",children:s.map((l,n)=>{const r=["bg-emerald-500","bg-blue-500","bg-amber-500","bg-indigo-500","bg-rose-500","bg-purple-500"],i=a>0?l.value/a*100:0;return e.jsx("div",{className:ml("h-full",r[n%r.length]),style:{width:`${i}%`},title:`${l.label}: ${As(l.value)}`},l.label)})}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2 text-xs text-slate-500",children:s.map((l,n)=>e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx("span",{className:ml("h-1.5 w-1.5 rounded-full",["bg-emerald-500","bg-blue-500","bg-amber-500","bg-indigo-500","bg-rose-500","bg-purple-500"][n%6])}),l.label]},l.label))})]})}function ic({title:t,value:s,sub:a,icon:l,trend:n,variant:r}){const i={green:"border-slate-200 bg-white hover:border-emerald-200 hover:shadow-emerald-500/10 dark:border-slate-800 dark:bg-slate-900 dark:hover:border-emerald-500/30",orange:"border-slate-200 bg-white hover:border-orange-200 hover:shadow-orange-500/10 dark:border-slate-800 dark:bg-slate-900 dark:hover:border-orange-500/30",gray:"border-slate-200 bg-white hover:border-slate-300 dark:border-slate-800 dark:bg-slate-900"},o={green:"bg-emerald-50 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400",orange:"bg-orange-50 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400",gray:"bg-slate-50 text-slate-700 dark:bg-slate-800 dark:text-slate-400"},c=r||"gray";return e.jsx("div",{className:ml("rounded-3xl border p-6 shadow-sm transition-all hover-lift dark:shadow-none",i[c]),children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-500 dark:text-slate-400",children:t}),e.jsx("div",{className:"mt-2 text-3xl font-semibold tracking-tight text-slate-900 dark:text-white",children:s}),e.jsx("div",{className:"mt-1 text-sm text-slate-600 dark:text-slate-400",children:a}),n?e.jsx("div",{className:"mt-3",children:e.jsx(Rl,{label:n.label,tone:n.tone})}):null]}),e.jsx("div",{className:ml("grid h-12 w-12 place-items-center rounded-2xl shrink-0",o[c]),children:l})]})})}function RU({value:t,labelLeft:s,labelRight:a}){const l=PU(t,0,100);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-600",children:[e.jsx("span",{className:"font-semibold",children:s}),e.jsx("span",{className:"font-semibold",children:a})]}),e.jsx("div",{className:"mt-2 h-2 w-full overflow-hidden rounded-full bg-slate-100",children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${l}%`,background:ug.green}})})]})}function DU({data:t,height:s=240}){if(!(t!=null&&t.length))return null;const a=Math.max(...t.map(o=>o.value))||1,l=s-40,n=t.map((o,c)=>{const x=c/(t.length-1)*100,j=100-o.value/a*100;return[x,j]}),i=(o=>{if(o.length===0)return"";let c=`M ${o[0][0]},${o[0][1]}`;for(let x=0;x<o.length-1;x++){const j=o[x],g=o[x+1],y=j[0]+(g[0]-j[0])*.5,$=j[1],T=j[0]+(g[0]-j[0])*.5,C=g[1];c+=` C ${y},${$} ${T},${C} ${g[0]},${g[1]}`}return c})(n);return e.jsxs("div",{className:"rounded-2xl border border-slate-800 bg-[#0B1120] p-4 text-white shadow-sm overflow-hidden relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 z-10 relative",children:[e.jsx("h3",{className:"text-sm font-semibold text-white",children:"Trip Trends"}),e.jsxs("div",{className:"flex rounded-lg bg-slate-800 p-0.5",children:[e.jsx("span",{className:"px-2 py-1 text-[10px] font-semibold text-slate-400",children:"RIDES"}),e.jsx("span",{className:"px-2 py-1 text-[10px] font-semibold text-slate-400",children:"DELIVERY"}),e.jsx("span",{className:"px-2 py-1 text-[10px] font-semibold text-slate-900 bg-[#03CD8C] rounded shadow",children:"BOTH"})]})]}),e.jsxs("div",{className:"relative",style:{height:l},children:[[0,25,50,75,100].map(o=>e.jsx("div",{className:"absolute left-0 right-0 border-t border-dashed border-slate-700/50",style:{top:`${o}%`}},o)),e.jsx("div",{className:"absolute inset-0 flex justify-between pointer-events-none",children:t.map((o,c)=>e.jsx("div",{className:"h-full border-r border-dashed border-slate-700/50 w-px first:border-l"},c))}),e.jsxs("svg",{viewBox:"0 0 100 100",preserveAspectRatio:"none",className:"absolute inset-0 h-full w-full overflow-visible",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"chartGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"#03CD8C",stopOpacity:"0.4"}),e.jsx("stop",{offset:"100%",stopColor:"#03CD8C",stopOpacity:"0"})]})}),e.jsx("path",{d:`${i} L 100,100 L 0,100 Z`,fill:"url(#chartGradient)"}),e.jsx("path",{d:i,fill:"none",stroke:"#03CD8C",strokeWidth:"1.5",className:"drop-shadow-[0_0_6px_rgba(3,205,140,0.5)]"})]})]}),e.jsx("div",{className:"mt-2 flex justify-between text-[10px] text-slate-400 font-medium",children:t.map((o,c)=>c%2===0||c===t.length-1?e.jsx("div",{children:o.label},c):null)})]})}function h4({title:t,subtitle:s,icon:a,items:l,actionLabel:n,onAction:r}){return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 dark:border-slate-800 dark:bg-slate-900",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:a}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-900 dark:text-white",children:t}),e.jsx("div",{className:"mt-0.5 text-xs text-slate-500 dark:text-slate-500",children:s})]})]}),n?e.jsx("button",{type:"button",className:"text-xs font-semibold text-emerald-700 hover:underline",onClick:r,children:n}):null]}),e.jsx("div",{className:"mt-3 space-y-2",children:l.map(i=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 dark:border-slate-800 dark:bg-slate-950",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900 dark:text-slate-200",children:i.title}),e.jsx("div",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:i.meta})]}),i.pill?e.jsx(Rl,{label:i.pill.label,tone:i.pill.tone}):null]})},i.title))})]})}function IU(){const t=Kd(),[s,a]=d.useState([]),l=w=>{const B=x4("toast");a(ue=>[{id:B,...w},...ue].slice(0,4)),window.setTimeout(()=>a(ue=>ue.filter(ne=>ne.id!==B)),3200)},n=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],r=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],i=["Operations","Sales","Finance","Admin","Procurement"],[o]=d.useState("Acme Group Ltd"),[c,x]=d.useState("This month"),[j,g]=d.useState(()=>{const w=new Date;return w.setMonth(w.getMonth()-1),w.toISOString().split("T")[0]}),[y,$]=d.useState(()=>new Date().toISOString().split("T")[0]),[T,C]=d.useState(68e5),[W,L]=d.useState("All"),[R,F]=d.useState("All"),[te,oe]=d.useState("All"),G=d.useMemo(()=>R==="All"||R==="E-Commerce",[R]),H=d.useMemo(()=>{let ue=1,ne=1,Me="This month";switch(c){case"Today":ue=.038,ne=.038,Me="Today";break;case"This week":ue=.21,ne=.21,Me="This week";break;case"This month":ue=1,ne=1,Me="This month";break;case"This year":ue=8.5,ne=12,Me="This year";break;case"Custom":const ae=new Date(j),ve=new Date(y),O=Math.max(1,Math.ceil((ve.getTime()-ae.getTime())/(1e3*60*60*24)));ue=O/30,ne=O/30,Me=`${O} days`;break}const De=Math.round(325e5*.038),fe=Math.round(325e5*.21),me=Math.round(325e5*ue),Xe=Math.round(325e5*8.5),V=Math.round(4e7*ne),E=Math.round(142e5*ue),u=Math.round(168e5*ue),P=Math.round(15e5*ue),se=T,D=82e5,re=3,v=c==="Today"?0:c==="This week"?1:2,k=c==="Today"?0:1,m=Math.round(4*ue),S=7,f=30,U=Math.round(me/Math.max(1,S*ue)*f*ue),p={"E-Commerce":Math.round(168e5*ue),"EVs & Charging":Math.round(42e5*ue),"Rides & Logistics":Math.round(142e5*ue),"School & E-Learning":Math.round(8e5*ue),"Medical & Health Care":Math.round(65e4*ue),"Travel & Tourism":Math.round(12e5*ue),"Green Investments":Math.round(5e5*ue),FaithHub:Math.round(12e4*ue),"Virtual Workspace":Math.round(9e5*ue),"Finance & Payments":Math.round(2e6*ue),"Other Service Module":0},M={MyLiveDealz:Math.round(52e5*ue),ServiceMart:Math.round(12e5*ue),EVmart:Math.round(34e5*ue),GadgetMart:Math.round(22e5*ue),LivingMart:Math.round(13e5*ue),StyleMart:Math.round(9e5*ue),EduMart:Math.round(6e5*ue),HealthMart:Math.round(75e4*ue),PropertyMart:Math.round(4e5*ue),GeneratMart:Math.round(7e5*ue),ExpressMart:Math.round(6e5*ue),FaithMart:Math.round(15e4*ue),"Other Marketplace":0},ee={Operations:Math.round(12e6*ue),Sales:Math.round(98e5*ue),Finance:Math.round(52e5*ue),Admin:Math.round(41e5*ue),Procurement:Math.round(34e5*ue)},b={Operations:Math.round(15e6*ne),Sales:Math.round(12e6*ne),Finance:Math.round(6e6*ne),Admin:Math.round(5e6*ne),Procurement:Math.round(5e6*ne)};return{spendToday:De,spendWeek:fe,spendMonth:me,spendYear:Xe,budgetMonth:V,budgetRemaining:Math.max(0,V-me),ridesMonth:E,purchasesMonth:u,servicesMonth:P,walletBalance:T,creditLimit:se,creditUsed:D,prepaidRunwayDays:re,failedPayments:v,overdueInvoices:k,policyBreaches:m,forecastMonthEnd:U,monthDay:S,daysInMonth:f,spendByModule:p,spendByMarketplace:M,spendByGroup:ee,budgetByGroup:b,periodLabel:Me,multiplier:ue}},[c,j,y,T]),[Y,we]=d.useState([]),[q,je]=d.useState(()=>[{id:"AP-1821",type:"Purchase",module:"E-Commerce",marketplace:"MyLiveDealz",requester:"Mary N.",group:"Operations",amount:654e4,slaHours:6,ageMinutes:120,status:"Pending",needsAttachment:!0},{id:"RFQ-390",type:"RFQ",module:"Rides & Logistics",marketplace:"-",requester:"Ronald I.",group:"Admin",amount:285e6,slaHours:2,ageMinutes:1440,status:"Escalated",needsAttachment:!0},{id:"RD-0442",type:"Ride",module:"Rides & Logistics",marketplace:"-",requester:"John S.",group:"Sales",amount:41500,slaHours:7,ageMinutes:15,status:"Pending",needsAttachment:!1},{id:"SV-2201",type:"Service",module:"EVs & Charging",marketplace:"-",requester:"Finance Desk",group:"Finance",amount:18e5,slaHours:12,ageMinutes:180,status:"Pending",needsAttachment:!1}]),[_e,Ee]=d.useState(null),[be,Fe]=d.useState("both"),Pe=q.filter(w=>w.status!=="Escalated").length,pe=q.filter(w=>w.status==="Escalated").length,[Q,Re]=d.useState(()=>{const w={};return n.forEach(B=>w[B]=B!=="Other Service Module"),w}),ce=d.useMemo(()=>[{title:"Failed payments",meta:`${H.failedPayments} failures  Risk of hold`,pill:{label:"Critical",tone:"bad"}},{title:"Overdue invoices",meta:`${H.overdueInvoices} invoice  Grace window active`,pill:{label:"Warning",tone:"warn"}},{title:"Policy breaches",meta:`${H.policyBreaches} events  Review policy rules`,pill:{label:"Review",tone:"info"}}],[H.failedPayments,H.overdueInvoices,H.policyBreaches]),xe=d.useMemo(()=>({rows:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],cols:["06-09","09-12","12-15","15-18","18-21","21-24"],matrix:[[6,10,8,9,14,3],[5,9,7,10,12,2],[7,11,9,12,16,4],[6,10,8,11,15,3],[8,13,10,14,18,5],[3,6,7,9,12,6],[2,4,5,7,9,4]]}),[]);d.useMemo(()=>[{title:"Unusual vendor spend",body:"Shenzhen Store spend is 3.1 higher than typical (MyLiveDealz).",severity:"warn",ctas:["Investigate","Create rule"]},{title:"User nearing cap",body:"3 users are above 80% of their monthly cap in Sales.",severity:"info",ctas:["Review users","Tighten policy"]}],[]),d.useMemo(()=>[{title:"Prefer standard rides for commute",body:`Estimated savings: ${As(42e4)} this month if premium is restricted for commute trips.`,tag:"Rides & Logistics"},{title:"Use preferred vendor catalog",body:`Estimated savings: ${As(9e5)} by routing purchases to negotiated vendors.`,tag:"E-Commerce"},{title:"Bundle EV charging credits",body:`Estimated savings: ${As(26e4)} by purchasing credits in bulk (EVs & Charging).`,tag:"EVs & Charging"}],[]),d.useMemo(()=>[{id:"NA-1",title:"Approve RFQ escalation",why:"RFQ-390 is escalated and past SLA.",impact:"Unblocks high-value asset procurement.",cta:"Open RFQ",tone:"warn"},{id:"NA-2",title:"Increase Operations budget or enforce hard cap",why:"Operations is projected to exceed budget by month-end.",impact:"Prevents service interruption.",cta:"Adjust budget",tone:"info"},{id:"NA-3",title:"Add Shenzhen Store to vendor rule",why:"Anomaly detected for vendor spend.",impact:"Reduces fraud risk and overspend.",cta:"Create rule",tone:"good"}],[]);const he=H.spendMonth/Math.max(1,H.budgetMonth)*100,de=H.creditUsed/Math.max(1,H.creditLimit)*100,ye=d.useMemo(()=>i.map(B=>{const ue=H.spendByGroup[B],ne=Math.round(ue/Math.max(1,H.monthDay)*H.daysInMonth),Me=H.budgetByGroup[B],De=ne>Me?"bad":ne>Me*.9?"warn":"good";return{group:B,mtd:ue,forecast:ne,budget:Me,risk:De}}),[H,i]),Ke=d.useMemo(()=>n.map(B=>{const ue=H.spendByModule[B]||0,ne=Math.round(ue/Math.max(1,H.monthDay)*H.daysInMonth);return{module:B,mtd:ue,forecast:ne}}).filter(B=>B.mtd>0||B.module==="Other Service Module"),[H,n]),Le=d.useMemo(()=>r.map(B=>{const ue=H.spendByMarketplace[B]||0,ne=Math.round(ue/Math.max(1,H.monthDay)*H.daysInMonth);return{marketplace:B,mtd:ue,forecast:ne}}).filter(B=>B.mtd>0||B.marketplace==="Other Marketplace"),[H,r]),[Ne,ge]=d.useState(!1),[$e,ie]=d.useState(!1),[Oe,Se]=d.useState(!1),[Te,Ge]=d.useState(!1),[We,ze]=d.useState({method:"Wallet top-up",amount:2e6,reference:""}),[Ue,le]=d.useState({group:"Operations",module:"All",marketplace:"All",period:"Monthly",amount:5e6,hardCap:!0}),[z,Ae]=d.useState({title:"Company vehicle purchase",module:"Rides & Logistics",marketplace:"All",estValue:285e6,neededBy:"2026-02-01",description:"Need a company vehicle. Include warranty, service plan, and delivery timeline.",attachments:!1}),Ve=Object.values(H.spendByModule).reduce((w,B)=>w+B,0),Ye=Object.values(H.spendByMarketplace).reduce((w,B)=>w+B,0),Be=d.useMemo(()=>{const w=[];return W!=="All"&&w.push(`Group: ${W}`),R!=="All"&&w.push(`Module: ${R}`),te!=="All"&&w.push(`Marketplace: ${te}`),w.length?w.join("  "):"All spend"},[W,R,te,T]);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(TU,{toasts:s,onDismiss:w=>a(B=>B.filter(ue=>ue.id!==w))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)] transition-colors dark:border-slate-800 dark:bg-slate-900 dark:shadow-none",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 transition-colors md:px-6 dark:border-slate-800 dark:bg-slate-900",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:ug.green},children:e.jsx(La,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:"CorporatePay Dashboard"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:["Organization: ",o,"  ",Be]}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(Rl,{label:`Approvals: ${Pe} pending`,tone:Pe?"warn":"good"}),pe?e.jsx(Rl,{label:`${pe} escalated`,tone:"bad"}):null,e.jsx(Rl,{label:`Budget used: ${Math.round(he)}%`,tone:he>90?"bad":he>75?"warn":"good"}),e.jsx(Rl,{label:`Forecast: ${As(H.forecastMonthEnd)}`,tone:H.forecastMonthEnd>H.budgetMonth?"warn":"good"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-2 py-2 shadow-sm dark:border-slate-800 dark:bg-slate-900",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400",children:"Time"}),e.jsxs("select",{value:c,onChange:w=>x(w.target.value),className:"rounded-xl border border-slate-200 bg-white px-2 py-1 text-xs font-semibold text-slate-700 outline-none dark:border-slate-700 dark:bg-slate-800 dark:text-slate-200",children:[e.jsx("option",{children:"Today"}),e.jsx("option",{children:"This week"}),e.jsx("option",{children:"This month"}),e.jsx("option",{children:"This year"}),e.jsx("option",{children:"Custom"})]})]}),c==="Custom"&&e.jsxs("div",{className:"flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2 shadow-sm dark:border-slate-800 dark:bg-slate-900",children:[e.jsx(zF,{className:"h-4 w-4 text-slate-500 dark:text-slate-400"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"date",value:j,onChange:w=>g(w.target.value),className:"rounded-lg border border-slate-200 bg-white px-2 py-1 text-xs font-semibold text-slate-700 outline-none focus:ring-2 focus:ring-orange-200 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-200"}),e.jsx("span",{className:"text-xs text-slate-500",children:"to"}),e.jsx("input",{type:"date",value:y,onChange:w=>$(w.target.value),className:"rounded-lg border border-slate-200 bg-white px-2 py-1 text-xs font-semibold text-slate-700 outline-none focus:ring-2 focus:ring-orange-200 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-200"})]}),e.jsxs("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:["(",H.periodLabel,")"]})]}),e.jsxs(_l,{variant:"primary",onClick:()=>Ge(!0),children:[e.jsx(ct,{className:"h-4 w-4"})," Approvals inbox"]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2 dark:border-slate-700 dark:bg-slate-800",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400",children:"Group"}),e.jsxs("select",{value:W,onChange:w=>L(w.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-2 py-2 text-sm font-semibold text-slate-900 outline-none dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100",children:[e.jsx("option",{value:"All",children:"All"}),i.map(w=>e.jsx("option",{value:w,children:w},w))]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2 dark:border-slate-700 dark:bg-slate-800",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400",children:"Service Module"}),e.jsxs("select",{value:R,onChange:w=>{const B=w.target.value;F(B),B!=="All"&&B!=="E-Commerce"&&oe("All")},className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-2 py-2 text-sm font-semibold text-slate-900 outline-none dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100",children:[e.jsx("option",{value:"All",children:"All"}),n.map(w=>e.jsx("option",{value:w,children:w},w))]})]}),e.jsxs("div",{className:ml("rounded-2xl border px-3 py-2",G?"border-slate-200 bg-white dark:border-slate-700 dark:bg-slate-800":"border-slate-200 bg-slate-50 opacity-70 dark:border-slate-700 dark:bg-slate-800/50"),children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400",children:"Marketplace"}),e.jsxs("select",{value:te,disabled:!G,onChange:w=>oe(w.target.value),className:ml("mt-1 w-full rounded-xl border px-2 py-2 text-sm font-semibold outline-none",G?"border-slate-200 bg-white text-slate-900 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100":"border-slate-200 bg-slate-50 text-slate-500 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-400"),children:[e.jsx("option",{value:"All",children:"All"}),r.map(w=>e.jsx("option",{value:w,children:w},w))]}),G?null:e.jsx("div",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:"Marketplace filters apply to E-Commerce only."})]})]})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-8 transition-colors md:px-8 dark:bg-slate-950",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsx(ic,{title:"Spend today",value:As(H.spendToday),sub:"All modules",icon:e.jsx(rg,{className:"h-5 w-5"}),trend:{label:"+12% vs yesterday",tone:"good"},variant:"green"}),e.jsx(ic,{title:"Spend this week",value:As(H.spendWeek),sub:"Week-to-date",icon:e.jsx($E,{className:"h-5 w-5"}),trend:{label:"Stable",tone:"neutral"},variant:"orange"}),e.jsx(ic,{title:"Spend this month",value:As(H.spendMonth),sub:`Budget: ${As(H.budgetMonth)}`,icon:e.jsx(Er,{className:"h-5 w-5"}),trend:{label:`${Math.round(he)}% used`,tone:he>90?"bad":"warn"},variant:"gray"}),e.jsx(ic,{title:"Budget remaining",value:As(H.budgetRemaining),sub:"Available this month",icon:e.jsx(ox,{className:"h-5 w-5"}),trend:{label:H.budgetRemaining<2e6?"Low":"OK",tone:H.budgetRemaining<2e6?"warn":"good"},variant:"orange"}),e.jsx(ic,{title:"Approvals pending",value:String(Pe),sub:pe?`${pe} escalated`:"No escalations",icon:e.jsx(ct,{className:"h-5 w-5"}),trend:{label:pe?"Escalation":"On track",tone:pe?"bad":"good"},variant:"green"}),e.jsx(ic,{title:"Forecast month-end",value:As(H.forecastMonthEnd),sub:H.forecastMonthEnd>H.budgetMonth?"Over budget":"Within budget",icon:e.jsx(zd,{className:"h-5 w-5"}),trend:{label:H.forecastMonthEnd>H.budgetMonth?"Risk":"OK",tone:H.forecastMonthEnd>H.budgetMonth?"warn":"good"},variant:"gray"})]}),e.jsxs("div",{className:"mt-8 rounded-[32px] border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-800 dark:bg-slate-900",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"Account Health"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Wallet, credit, and service status overview"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Rl,{label:`Wallet: ${As(H.walletBalance)}`,tone:H.walletBalance<1e6?"bad":"good"}),e.jsx(Rl,{label:`Credit: ${Math.round(de)}% used`,tone:de>80?"warn":"neutral"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[e.jsxs("div",{className:"rounded-3xl bg-slate-50 p-5 dark:bg-slate-800/50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-emerald-100 text-emerald-600 dark:bg-emerald-900/30 dark:text-emerald-400",children:e.jsx(Ia,{className:"h-5 w-5"})}),e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:"Wallet Balance"})]}),e.jsx("div",{className:"text-3xl font-bold text-slate-900 dark:text-white",children:As(H.walletBalance)}),e.jsx("div",{className:"mt-2 text-xs text-slate-600 dark:text-slate-300",children:"Budget is allowance; wallet is prepaid funds; credit is postpaid limit."}),e.jsx("div",{className:"mt-4",children:e.jsx(_l,{variant:"outline",className:"w-full justify-center bg-white dark:bg-slate-800",onClick:()=>ge(!0),children:"Top up"})})]}),e.jsxs("div",{className:"rounded-3xl bg-slate-50 p-5 dark:bg-slate-800/50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400",children:e.jsx(RE,{className:"h-5 w-5"})}),e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:"Credit Usage"})]}),e.jsxs("div",{className:"text-3xl font-bold text-slate-900 dark:text-white",children:[As(H.creditUsed)," ",e.jsxs("span",{className:"text-sm font-normal text-slate-500",children:["/ ",As(H.creditLimit)]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(RU,{value:de,labelLeft:"Used",labelRight:`${Math.round(de)}%`})}),H.creditUsed>H.creditLimit?e.jsxs("div",{className:"mt-3 rounded-2xl bg-rose-50 p-3 text-xs font-semibold text-rose-800 ring-1 ring-rose-200",children:["Credit over-limit: ",As(H.creditUsed-H.creditLimit)," above limit. Approvals and service access may be restricted."]}):null]}),e.jsxs("div",{className:"rounded-3xl bg-slate-50 p-5 dark:bg-slate-800/50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-purple-100 text-purple-600 dark:bg-purple-900/30 dark:text-purple-400",children:e.jsx(La,{className:"h-5 w-5"})}),e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:"Active Modules"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 mt-2",children:n.map(w=>e.jsx("button",{type:"button",className:ml("inline-flex items-center justify-center rounded-lg px-2 py-1.5 text-xs font-medium transition-colors cursor-pointer border",Q[w]?"bg-[#064e3b] text-emerald-100 border-[#065f46] hover:bg-[#065f46] shadow-sm":"bg-slate-100 text-slate-500 border-slate-200 hover:bg-slate-200 dark:bg-slate-800 dark:text-slate-500 dark:border-slate-700"),onClick:()=>{Re(B=>({...B,[w]:!B[w]})),l({title:"Module toggle",message:`${w} ${Q[w]?"disabled":"enabled"}`,kind:"info"})},children:w},w))})]})]})]}),e.jsxs("div",{className:"mt-8 grid grid-cols-1 gap-8 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-8",children:e.jsxs("div",{className:"rounded-[32px] border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-800 dark:bg-slate-900",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"Top Issues"}),e.jsx(Rl,{label:`${ce.length}`,tone:ce.some(w=>w.pill.tone==="bad")?"bad":"warn"})]}),e.jsx("div",{className:"space-y-3",children:ce.map(w=>e.jsx("button",{onClick:()=>t("/console/notifications_activity"),className:"w-full rounded-2xl border border-slate-100 bg-slate-50 p-4 text-left transition-all hover:bg-white hover:shadow-md hover:ring-1 hover:ring-slate-200 dark:border-slate-800 dark:bg-slate-800/50 dark:hover:bg-slate-800 dark:hover:ring-slate-700",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-white",children:w.title}),e.jsx("div",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:w.meta})]}),e.jsx(Rl,{label:w.pill.label,tone:w.pill.tone})]})},w.title))}),e.jsx(_l,{variant:"ghost",className:"mt-4 w-full text-xs",onClick:()=>t("/console/notifications_activity"),children:"View all notifications"})]})}),e.jsxs("div",{className:"lg:col-span-8 flex flex-col gap-8",children:[e.jsxs("div",{className:"rounded-[32px] border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-800 dark:bg-slate-900",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"Peak Ride Times"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Ride volume heat distribution"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"inline-flex rounded-2xl border border-slate-200 bg-white p-1 dark:border-slate-800 dark:bg-slate-950",children:[e.jsx("button",{type:"button",onClick:()=>Fe("rides"),className:ml("rounded-xl px-3 py-1.5 text-xs font-semibold transition",be==="rides"?"bg-emerald-600 text-white":"text-slate-600 hover:bg-slate-50 dark:text-slate-300 dark:hover:bg-slate-900"),children:"Rides"}),e.jsx("button",{type:"button",onClick:()=>Fe("delivery"),className:ml("rounded-xl px-3 py-1.5 text-xs font-semibold transition",be==="delivery"?"bg-emerald-600 text-white":"text-slate-600 hover:bg-slate-50 dark:text-slate-300 dark:hover:bg-slate-900"),children:"Delivery"}),e.jsx("button",{type:"button",onClick:()=>Fe("both"),className:ml("rounded-xl px-3 py-1.5 text-xs font-semibold transition",be==="both"?"bg-emerald-600 text-white":"text-slate-600 hover:bg-slate-50 dark:text-slate-300 dark:hover:bg-slate-900"),children:"Both"})]}),e.jsxs(_l,{variant:"outline",className:"h-8 text-xs",onClick:()=>l({title:"Updated",message:"Data refreshed",kind:"success"}),children:[e.jsx(pt,{className:"h-3 w-3 mr-2"}),"Import Data"]})]})]}),e.jsx("div",{className:"overflow-hidden rounded-2xl border border-slate-100 dark:border-slate-800",children:e.jsx("div",{className:"p-4 rounded-2xl border border-slate-100 dark:border-slate-800",children:e.jsx(DU,{data:xe.cols.map((w,B)=>{const ue=xe.matrix.reduce((De,fe)=>De+fe[B],0),ne=Math.round(ue*.65),Me=be==="rides"?ue:be==="delivery"?ne:ue+ne;return{label:w,value:Me}})})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(h4,{title:"Top Vendors",subtitle:"By spend volume",icon:e.jsx(kw,{className:"h-4 w-4"}),actionLabel:"View All",onAction:()=>t("/console/reporting"),items:[{title:"Shenzhen Store",meta:`UGX ${As(52e5)}`,pill:{label:"Anomaly",tone:"warn"}},{title:"Kampala Office Mart",meta:`UGX ${As(31e5)}`,pill:{label:"Preferred",tone:"good"}},{title:"City Courier",meta:`UGX ${As(82e4)}`,pill:{label:"OK",tone:"neutral"}}]}),e.jsx(h4,{title:"Top Routes",subtitle:"Most frequent trips",icon:e.jsx(Wx,{className:"h-4 w-4"}),actionLabel:"View All",onAction:()=>t("/console/travel"),items:[{title:"Office  Airport",meta:"36 trips  Avg UGX 82k",pill:{label:"Peak",tone:"warn"}},{title:"Office  Client HQ",meta:"29 trips  Avg UGX 41k",pill:{label:"OK",tone:"neutral"}},{title:"Office  Warehouse",meta:"18 trips  Avg UGX 35k",pill:{label:"OK",tone:"neutral"}}]})]})]}),e.jsxs("div",{className:"lg:col-span-12 rounded-[32px] border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-800 dark:bg-slate-900",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"Budget Forecast"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Projected month-end spend vs budget"})]}),e.jsx(Rl,{label:`Day ${H.monthDay} of ${H.daysInMonth}`,tone:"neutral"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-8 lg:grid-cols-3",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-100 dark:border-slate-800",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs font-semibold text-slate-600 dark:bg-slate-950 dark:text-slate-400",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-5 py-3",children:"Group"}),e.jsx("th",{className:"px-5 py-3 text-right",children:"MTD Spend"}),e.jsx("th",{className:"px-5 py-3 text-right",children:"Forecast"}),e.jsx("th",{className:"px-5 py-3 text-right",children:"Budget"}),e.jsx("th",{className:"px-5 py-3 text-center",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:ye.map(w=>e.jsxs("tr",{className:"hover:bg-slate-50/50",children:[e.jsx("td",{className:"px-5 py-3 font-medium text-slate-900 dark:text-white",children:w.group}),e.jsx("td",{className:"px-5 py-3 text-right text-slate-600 dark:text-slate-300",children:As(w.mtd)}),e.jsx("td",{className:"px-5 py-3 text-right font-medium text-slate-900 dark:text-white",children:As(w.forecast)}),e.jsx("td",{className:"px-5 py-3 text-right text-slate-500",children:As(w.budget)}),e.jsx("td",{className:"px-5 py-3 text-center",children:e.jsx(Rl,{label:w.risk==="bad"?"Over":w.risk==="warn"?"Risk":"OK",tone:w.risk})})]},w.group))})]})})}),e.jsx("div",{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(p4,{title:"Service Modules",total:Ve,rows:Ke.slice(0,5).map(w=>({label:w.module,value:w.mtd}))}),e.jsx(p4,{title:"Marketplaces",total:Ye,rows:Le.slice(0,5).map(w=>({label:w.marketplace,value:w.mtd}))})]})})]})]}),e.jsx("div",{className:"mt-8 text-center lg:col-span-12",children:e.jsx("div",{className:"inline-block rounded-full bg-slate-100 px-4 py-2 text-xs text-slate-500 dark:bg-slate-900 dark:text-slate-400",children:"CorporatePay v2.5  Everything is up to date"})}),e.jsx("div",{className:"mt-8 lg:col-span-12",children:e.jsx("div",{className:"rounded-[32px] border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-800 dark:bg-slate-900",children:e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"Quick Actions"}),e.jsx("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Fast paths to high-impact workflows"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs(_l,{variant:"primary",onClick:()=>ge(!0),className:"shadow-lg shadow-emerald-500/10",children:[e.jsx(Ia,{className:"h-4 w-4"})," Add funds"]}),e.jsxs(_l,{variant:"outline",onClick:()=>ie(!0),children:[e.jsx(ox,{className:"h-4 w-4"})," Issue budget"]}),e.jsxs(_l,{variant:"outline",onClick:()=>Ge(!0),children:[e.jsx(ct,{className:"h-4 w-4"})," Approve queue"]}),e.jsxs(_l,{variant:"outline",onClick:()=>Se(!0),children:[e.jsx(kt,{className:"h-4 w-4"})," Create RFQ"]})]})]})})})]})," "]})]})}),e.jsx(eh,{open:Ne,title:"Add funds",subtitle:"Top up wallet or add prepaid deposit. (Demo)",onClose:()=>ge(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(_l,{variant:"outline",onClick:()=>ge(!1),children:"Cancel"}),e.jsxs(_l,{variant:"primary",onClick:()=>{ge(!1),C(w=>w+We.amount),l({title:"Funds added",message:`${We.method}: ${As(We.amount)}`,kind:"success"})},children:[e.jsx(Ia,{className:"h-4 w-4"})," Confirm"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Method"}),e.jsxs("select",{value:We.method,onChange:w=>ze(B=>({...B,method:w.target.value})),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:[e.jsx("option",{children:"Wallet top-up"}),e.jsx("option",{children:"Prepaid deposit"}),e.jsx("option",{children:"Credit repayment"})]}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Payment rails configured under Finance & Payments."})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Amount (UGX)"}),e.jsx("input",{type:"number",min:0,onKeyDown:w=>(w.key==="-"||w.key==="e")&&w.preventDefault(),value:We.amount,onChange:w=>{const B=Number(w.target.value||0);B>=0&&ze(ue=>({...ue,amount:B}))},className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Preview: ",As(We.amount)]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Reference (optional)"}),e.jsx("input",{value:We.reference,onChange:w=>ze(B=>({...B,reference:w.target.value})),placeholder:"Bank/txn reference",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"})]}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Premium: large funding events can require approvals and are fully audit logged."})]})}),e.jsx(eh,{open:$e,title:"Issue budget",subtitle:"Allocate budget to a group (and optionally module/marketplace).",onClose:()=>ie(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(_l,{variant:"outline",onClick:()=>ie(!1),children:"Cancel"}),e.jsxs(_l,{variant:"primary",onClick:()=>{ie(!1),we(w=>[{id:x4("budget"),group:Ue.group,amount:Number(Ue.amount),period:Ue.period,timestamp:new Date},...w]),l({title:"Budget issued",message:`${Ue.group}: ${As(Ue.amount)} (${Ue.period})`,kind:"success"})},children:[e.jsx(ox,{className:"h-4 w-4"})," Issue"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Group"}),e.jsx("select",{value:Ue.group,onChange:w=>le(B=>({...B,group:w.target.value})),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:i.map(w=>e.jsx("option",{value:w,children:w},w))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Period"}),e.jsx("select",{value:Ue.period,onChange:w=>le(B=>({...B,period:w.target.value})),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:"Weekly,Monthly,Quarterly,Annual".split(",").map(w=>e.jsx("option",{value:w,children:w},w))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Service Module (optional)"}),e.jsxs("select",{value:Ue.module,onChange:w=>{const B=w.target.value;le(ue=>({...ue,module:B,marketplace:B==="E-Commerce"?ue.marketplace:"All"}))},className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:[e.jsx("option",{value:"All",children:"All"}),n.map(w=>e.jsx("option",{value:w,children:w},w))]})]}),e.jsxs("div",{className:ml("",Ue.module==="E-Commerce"?"":"opacity-60"),children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Marketplace (optional)"}),e.jsxs("select",{value:Ue.marketplace,disabled:Ue.module!=="E-Commerce"&&Ue.module!=="All",onChange:w=>le(B=>({...B,marketplace:w.target.value})),className:ml("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none",Ue.module==="E-Commerce"||Ue.module==="All"?"border-slate-200 bg-white text-slate-900":"border-slate-200 bg-slate-50 text-slate-500"),children:[e.jsx("option",{value:"All",children:"All"}),r.map(w=>e.jsx("option",{value:w,children:w},w))]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Amount (UGX)"}),e.jsx("input",{type:"number",min:0,onKeyDown:w=>(w.key==="-"||w.key==="e")&&w.preventDefault(),value:Ue.amount,onChange:w=>{const B=Number(w.target.value||0);B>=0&&le(ue=>({...ue,amount:B}))},className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"})]}),e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Hard cap"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Block spend when budget exceeded"})]}),e.jsx("button",{type:"button",className:ml("relative h-7 w-12 rounded-full border transition",Ue.hardCap?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>le(w=>({...w,hardCap:!w.hardCap})),"aria-label":"Toggle hard cap",children:e.jsx("span",{className:ml("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",Ue.hardCap?"left-[22px]":"left-1")})})]})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Premium: high budget increases can require multi-level approvals."})]})}),e.jsx(eh,{open:Oe,title:"Create RFQ / Quote request",subtitle:"High-value assets and quotes with approval-aware workflow.",onClose:()=>Se(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(_l,{variant:"outline",onClick:()=>Se(!1),children:"Cancel"}),e.jsxs(_l,{variant:"primary",onClick:()=>{Se(!1),l({title:"RFQ created",message:`${z.title}  ${As(z.estValue)}`,kind:"success"}),je(w=>[{id:`RFQ-${Math.floor(100+Math.random()*900)}`,type:"RFQ",module:z.module,marketplace:"-",requester:"You",group:Ue.group||"Admin",amount:z.estValue,slaHours:4,ageMinutes:1,status:"Pending",needsAttachment:!z.attachments},...w])},children:[e.jsx(kt,{className:"h-4 w-4"})," Create"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Title"}),e.jsx("input",{value:z.title,onChange:w=>Ae(B=>({...B,title:w.target.value})),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Service Module"}),e.jsx("select",{value:z.module,onChange:w=>Ae(B=>({...B,module:w.target.value})),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:n.map(w=>e.jsx("option",{value:w,children:w},w))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Needed by"}),e.jsx("input",{type:"date",value:z.neededBy,onChange:w=>Ae(B=>({...B,neededBy:w.target.value})),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Estimated value (UGX)"}),e.jsx("input",{type:"number",value:z.estValue,onChange:w=>Ae(B=>({...B,estValue:Number(w.target.value||0)})),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"This can be paid via milestones after quote approval."})]}),e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Attachments"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Specs, PDFs, drawings"})]}),e.jsx("input",{type:"file",multiple:!0,className:"w-full rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-sm text-slate-600 file:mr-4 file:rounded-full file:border-0 file:bg-emerald-50 file:px-4 file:py-2 file:text-sm file:font-semibold file:text-emerald-700 hover:file:bg-emerald-100",onChange:w=>{var B;(B=w.target.files)!=null&&B.length&&Ae(ue=>({...ue,attachments:!0}))}})]})}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Description"}),e.jsx("textarea",{value:z.description,onChange:w=>Ae(B=>({...B,description:w.target.value})),rows:5,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 outline-none"})]}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: RFQs can be routed to CFO/CEO approvals and converted to PO with milestone payments."})]})}),e.jsxs(eh,{open:Te,title:"Approvals inbox",subtitle:"Unified approvals: rides, purchases, services, and RFQs.",onClose:()=>Ge(!1),footer:e.jsx("div",{className:"flex justify-end",children:e.jsx(_l,{variant:"outline",onClick:()=>Ge(!1),children:"Close"})}),maxW:"95vw",children:[e.jsxs("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white shadow-md p-4",children:[" ",e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"ID"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Type"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Module"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Marketplace"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"SLA"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Required"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[q.map(w=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:w.id}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:w.type}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:w.module}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:w.marketplace}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:w.group}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:As(w.amount)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Rl,{label:`${w.slaHours}h`,tone:w.status==="Escalated"?"bad":"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Rl,{label:w.status,tone:w.status==="Escalated"?"bad":"warn"})}),e.jsx("td",{className:"px-4 py-3",children:w.needsAttachment?e.jsx(Rl,{label:"Attachment",tone:"warn"}):e.jsx(Rl,{label:"OK",tone:"good"})}),e.jsxs("td",{className:"px-4 py-3 relative",children:[e.jsx("button",{onClick:B=>{B.stopPropagation(),Ee(_e===w.id?null:w.id)},className:"p-1.5 text-slate-500 hover:bg-slate-100 rounded-full transition-colors",children:e.jsx(xs,{className:"h-4 w-4"})}),e.jsx(lt,{children:_e===w.id&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>Ee(null)}),e.jsxs(qe.div,{initial:{opacity:0,scale:.95,y:-5},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-5},className:"absolute right-8 top-1/2 -translate-y-1/2 z-20 w-32 bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden",children:[e.jsx("button",{className:"w-full text-left px-3 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-50",onClick:()=>{l({title:"Open",message:`Opening ${w.id}...`,kind:"info"}),Ee(null)},children:"Open details"}),e.jsx("button",{className:"w-full text-left px-3 py-2 text-xs font-semibold text-emerald-600 hover:bg-emerald-50",onClick:()=>{je(B=>B.filter(ue=>ue.id!==w.id)),l({title:"Approved",message:`${w.id} approved.`,kind:"success"}),Ee(null)},children:"Approve"}),e.jsx("button",{className:"w-full text-left px-3 py-2 text-xs font-semibold text-rose-600 hover:bg-rose-50",onClick:()=>{je(B=>B.filter(ue=>ue.id!==w.id)),l({title:"Rejected",message:`${w.id} rejected.`,kind:"warn"}),Ee(null)},children:"Reject"})]})]})})]})]},w.id)),q.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:10,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No approvals in queue."})})]})]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: SLA timers, delegation routing, and load balancing are configured in Approval Workflow Builder (Round 4J)."})]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"A Corporate Dashboard v2: KPIs, account health, issues, heatmaps, quick actions, and premium insights with forecasts by group/module/marketplace."})})]})}const oy={green:"#03CD8C",orange:"#F77F00"};function Hl(...t){return t.filter(Boolean).join(" ")}function g4(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function f4(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function $U(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function Ws({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Hl("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function aa({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:oy.green}:t==="accent"?{background:oy.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Hl(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function LU({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:Hl("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function sm({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="920px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-0 z-50 m-auto flex w-[min(980px,calc(100vw-2rem))] flex-col overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i,maxHeight:"90vh"},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex flex-none items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(LU,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"flex-1 overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"flex-none border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function FU({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Hl("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function UE(t){return t==="Critical"?"bad":t==="Warning"?"warn":"info"}function UU(t){return{pay_fail_gateway:"Payment gateway failures",policy_breach_hours:"Outside working hours policy breaches",vendor_anomaly_shenzhen:"Shenzhen Store anomaly cluster",rfq_sla_breach:"RFQ SLA breaches",budget_near_cap_sales:"Sales nearing budget cap",invoice_overdue:"Overdue invoices"}[t]||t}function VU(t,s){const a={};for(const l of t){const n=s(l);a[n]=a[n]||[],a[n].push(l)}return a}function _U(){const[t,s]=d.useState([]),a=ne=>{const Me=g4("toast");s(De=>[{id:Me,...ne},...De].slice(0,4)),window.setTimeout(()=>s(De=>De.filter(fe=>fe.id!==Me)),3200)},l=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],n=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],[r]=d.useState("Acme Group Ltd"),[i,o]=d.useState(""),[c,x]=d.useState("All"),[j,g]=d.useState("All"),[y,$]=d.useState("All"),[T,C]=d.useState("All"),[W,L]=d.useState(!0),R=d.useMemo(()=>y==="All"||y==="E-Commerce",[y]),[F,te]=d.useState("You"),[oe,G]=d.useState(!1),[H,Y]=d.useState(!0),[we,q]=d.useState(()=>{const ne=Date.now();return[{id:"EVT-1001",ts:ne-12*60*1e3,severity:"Critical",kind:"Payment",module:"Finance & Payments",marketplace:"-",title:"Failed payment attempts",body:"2 wallet top-ups failed due to gateway error. Risk of hold if unpaid invoices persist.",assignedTo:null,status:"Open",snoozeUntil:null,rootCauseKey:"pay_fail_gateway",deliveries:[{channel:"Email",status:"Delivered",detail:"Delivered to finance@acme.com"},{channel:"WhatsApp",status:"Failed",detail:"User not opted-in"},{channel:"SMS",status:"Sent",detail:"Sent to +256700..."},{channel:"WeChat",status:"Queued",detail:"Awaiting channel token"}],why:{rule:"Collections: payment failure alert",triggeredBy:"Payment gateway returned error code 502",audience:"Org Admin + Accountant",auditId:"AUD-90021"}},{id:"EVT-1002",ts:ne-2*60*60*1e3,severity:"Warning",kind:"Policy",module:"Rides & Logistics",marketplace:"-",title:"Policy breach: outside working hours",body:"4 rides requested outside allowed time window. Consider tightening policy or enabling approvals.",assignedTo:"You",status:"Open",snoozeUntil:null,rootCauseKey:"policy_breach_hours",deliveries:[{channel:"Email",status:"Delivered",detail:"Delivered to admin@acme.com"},{channel:"WhatsApp",status:"Delivered",detail:"Delivered to WhatsApp group"},{channel:"SMS",status:"Delivered",detail:"Delivered"},{channel:"WeChat",status:"Sent",detail:"Sent"}],why:{rule:"Policy engine: breach alert",triggeredBy:"Requests created outside Mon-Fri 06:00-22:00",audience:"Org Admin + Approver",auditId:"AUD-90042"}},{id:"EVT-1003",ts:ne-4*60*60*1e3,severity:"Warning",kind:"Vendor",module:"E-Commerce",marketplace:"MyLiveDealz",title:"Anomaly: Shenzhen Store spend",body:"Vendor spend is 3.1 typical in the last 24h. Review vendor rule or require approvals.",assignedTo:null,status:"Open",snoozeUntil:null,rootCauseKey:"vendor_anomaly_shenzhen",deliveries:[{channel:"Email",status:"Delivered",detail:"Delivered"},{channel:"WhatsApp",status:"Delivered",detail:"Delivered"},{channel:"WeChat",status:"Delivered",detail:"Delivered"},{channel:"SMS",status:"Delivered",detail:"Delivered"}],why:{rule:"Anomaly detection: vendor spike",triggeredBy:"Spend spike in MyLiveDealz orders",audience:"Org Admin + Accountant",auditId:"AUD-90110"}},{id:"EVT-1004",ts:ne-26*60*60*1e3,severity:"Critical",kind:"Quote",module:"Rides & Logistics",marketplace:"-",title:"RFQ escalation: past SLA",body:"RFQ-390 is escalated and past SLA. High-value asset requires action.",assignedTo:"Approver Desk",status:"Open",snoozeUntil:null,rootCauseKey:"rfq_sla_breach",deliveries:[{channel:"Email",status:"Delivered",detail:"Delivered"},{channel:"WhatsApp",status:"Delivered",detail:"Delivered"},{channel:"SMS",status:"Delivered",detail:"Delivered"},{channel:"WeChat",status:"Delivered",detail:"Delivered"}],why:{rule:"Approvals: SLA breach escalation",triggeredBy:"SLA timer reached 0",audience:"Approver + Org Admin",auditId:"AUD-90200"}},{id:"EVT-1005",ts:ne-3*24*60*60*1e3,severity:"Info",kind:"Budget",module:"Rides & Logistics",marketplace:"-",title:"Budget alert: Sales at 82%",body:"Sales group has reached 82% of monthly cap. Consider adjust or enforce.",assignedTo:"Finance Desk",status:"Open",snoozeUntil:null,rootCauseKey:"budget_near_cap_sales",deliveries:[{channel:"Email",status:"Delivered",detail:"Delivered"},{channel:"WhatsApp",status:"Sent",detail:"Sent"},{channel:"SMS",status:"Delivered",detail:"Delivered"},{channel:"WeChat",status:"Queued",detail:"Queued"}],why:{rule:"Budget monitor: threshold 80%",triggeredBy:"Spend ratio crossed 80%",audience:"Accountant + Manager",auditId:"AUD-90300"}},{id:"EVT-1006",ts:ne-6*24*60*60*1e3,severity:"Warning",kind:"Reminder",module:"Finance & Payments",marketplace:"-",title:"Invoice overdue reminder",body:"1 invoice overdue. Dunning schedule will escalate if unpaid.",assignedTo:null,status:"Open",snoozeUntil:null,rootCauseKey:"invoice_overdue",deliveries:[{channel:"Email",status:"Delivered",detail:"Delivered"},{channel:"WhatsApp",status:"Failed",detail:"Opt-out"},{channel:"SMS",status:"Delivered",detail:"Delivered"},{channel:"WeChat",status:"Sent",detail:"Sent"}],why:{rule:"Collections: overdue reminder",triggeredBy:"Invoice unpaid after due date",audience:"Accountant + Org Admin",auditId:"AUD-90410"}}]}),[je,_e]=d.useState(()=>[{id:"DG-01",enabled:!0,frequency:"Daily",role:"Accountant",includeSev:["Warning","Critical"],includeKinds:["Payment","Reminder","Budget"],channels:["Email","WhatsApp"],timeOfDay:"08:30"},{id:"DG-02",enabled:!0,frequency:"Daily",role:"Approver",includeSev:["Warning","Critical"],includeKinds:["Approval","Quote"],channels:["Email","SMS"],timeOfDay:"09:00"},{id:"DG-03",enabled:!0,frequency:"Weekly",role:"Org Admin",includeSev:["Info","Warning","Critical"],includeKinds:["Payment","Budget","Policy","Vendor","Quote"],channels:["Email"],timeOfDay:"08:00"}]),[Ee,be]=d.useState(()=>[{id:"RR-01",enabled:!0,name:"Finance alerts to Accountants",match:{kinds:["Payment","Reminder","Budget"],severities:["Warning","Critical","Info"],modules:["Finance & Payments"],marketplaces:["-"]},routeToRole:"Accountant"},{id:"RR-02",enabled:!0,name:"Approval reminders to Approvers",match:{kinds:["Approval","Quote"],severities:["Warning","Critical"],modules:["Rides & Logistics","E-Commerce"],marketplaces:["-","MyLiveDealz"]},routeToRole:"Approver"}]),[Fe,Pe]=d.useState(!1),[pe,Q]=d.useState(null),[Re,ce]=d.useState("You"),[xe,he]=d.useState(!1),[de,ye]=d.useState(null),[Ke,Le]=d.useState(!1),[Ne,ge]=d.useState(null),[$e,ie]=d.useState(!1),[Oe,Se]=d.useState(!1),Te=d.useMemo(()=>{const ne=i.trim().toLowerCase();return we.filter(Me=>{if(!W&&Me.kind==="Quote"||c!=="All"&&Me.severity!==c||j!=="All"&&Me.kind!==j||y!=="All"&&Me.module!==y)return!1;if(T!=="All"){if(R){if((Me.marketplace||"-")!==T)return!1}else if(T!=="-")return!1}return!(oe&&(Me.assignedTo||"")!==F||ne&&!`${Me.id} ${Me.title} ${Me.body} ${Me.kind} ${Me.severity} ${Me.module} ${Me.marketplace||"-"}`.toLowerCase().includes(ne))})},[we,i,c,j,y,T,W,oe,F,R]),Ge=d.useMemo(()=>Te.filter(ne=>ne.status==="Open").length,[Te]),We=d.useMemo(()=>Te.filter(ne=>ne.status==="Open"&&ne.severity==="Critical").length,[Te]),ze=d.useMemo(()=>{const ne=VU(Te,fe=>fe.rootCauseKey),Me=Object.keys(ne),De=fe=>{const me=E=>E==="Critical"?3:E==="Warning"?2:1,Xe=Math.max(...fe.map(E=>me(E.severity))),V=Math.max(...fe.map(E=>E.ts));return{maxSev:Xe,latest:V}};return Me.sort((fe,me)=>{const Xe=De(ne[fe]),V=De(ne[me]);return V.maxSev!==Xe.maxSev?V.maxSev-Xe.maxSev:V.latest-Xe.latest}),Me.map(fe=>({key:fe,label:UU(fe),items:ne[fe]}))},[Te]),Ue=d.useMemo(()=>y==="All"||y==="E-Commerce",[y]),le=(ne,Me)=>{const De=Date.now()+Me*60*1e3;q(fe=>fe.map(me=>me.id===ne.id?{...me,status:"Snoozed",snoozeUntil:De}:me)),a({title:"Snoozed",message:`${ne.id} snoozed for ${Me} minutes.`,kind:"info"})},z=ne=>{q(Me=>Me.map(De=>De.id===ne.id?{...De,status:"Resolved",snoozeUntil:null}:De)),a({title:"Resolved",message:`${ne.id} resolved.`,kind:"success"})},Ae=(ne,Me)=>{q(De=>De.map(fe=>fe.id===ne.id?{...fe,assignedTo:Me}:fe)),a({title:"Assigned",message:`${ne.id} assigned to ${Me}.`,kind:"success"})},Ve=ne=>{ge(ne),Le(!0)},Ye=()=>{a({title:"Digest preview",message:"Generating digest preview (demo).",kind:"info"})},Be=()=>{a({title:"Digest sent",message:"Digest sent to configured channels (demo).",kind:"success"})},w=ne=>{_e(Me=>Me.map(De=>De.id===ne?{...De,enabled:!De.enabled}:De))},B=ne=>{be(Me=>Me.map(De=>De.id===ne?{...De,enabled:!De.enabled}:De))},ue=()=>{const ne={id:g4("RR"),enabled:!0,name:"Policy breaches to Approvers",match:{kinds:["Policy"],severities:["Warning","Critical"],modules:["Rides & Logistics"],marketplaces:["-"]},routeToRole:"Approver"};be(Me=>[ne,...Me]),a({title:"Rule added",message:"Routing rule added from template.",kind:"success"})};return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(FU,{toasts:t,onDismiss:ne=>s(Me=>Me.filter(De=>De.id!==ne))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:oy.green},children:e.jsx(Fo,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Notifications and Activity Center"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Organization: ",r,"  Unified feed across approvals, billing, policies, budgets, vendors, and quotes."]}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(Ws,{label:`${Ge} open`,tone:Ge?"warn":"good"}),We?e.jsx(Ws,{label:`${We} critical`,tone:"bad"}):null,e.jsx(Ws,{label:H?`Clusters: ${ze.length}`:`Events: ${Te.length}`,tone:"info"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(aa,{variant:"outline",onClick:()=>ie(!0),children:[e.jsx(Dn,{className:"h-4 w-4"})," Digests"]}),e.jsxs(aa,{variant:"outline",onClick:()=>Se(!0),children:[e.jsx(b4,{})," Routing rules"]}),e.jsxs(aa,{variant:"outline",onClick:()=>a({title:"Export",message:"Exports are available in Reports and Audit (demo).",kind:"info"}),children:[e.jsx(kt,{className:"h-4 w-4"})," Export"]}),e.jsxs(aa,{variant:"primary",onClick:()=>a({title:"Refresh",message:"Feed refreshed (demo).",kind:"success"}),children:[e.jsx(Mr,{className:"h-4 w-4"})," Refresh"]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-4",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsxs("div",{className:"mt-1 flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-2 py-2",children:[e.jsx(pa,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:i,onChange:ne=>o(ne.target.value),placeholder:"Approvals, payments, policies...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"})]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Severity"}),e.jsxs("select",{value:c,onChange:ne=>x(ne.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-2 py-2 text-sm font-semibold text-slate-900 outline-none",children:[e.jsx("option",{value:"All",children:"All"}),e.jsx("option",{value:"Info",children:"Info"}),e.jsx("option",{value:"Warning",children:"Warning"}),e.jsx("option",{value:"Critical",children:"Critical"})]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Module"}),e.jsxs("select",{value:y,onChange:ne=>{const Me=ne.target.value;$(Me),Me!=="All"&&Me!=="E-Commerce"&&C("All")},className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-2 py-2 text-sm font-semibold text-slate-900 outline-none",children:[e.jsx("option",{value:"All",children:"All"}),l.map(ne=>e.jsx("option",{value:ne,children:ne},ne))]})]}),e.jsxs("div",{className:Hl("rounded-2xl border px-3 py-2",Ue?"border-slate-200 bg-white":"border-slate-200 bg-slate-50 opacity-70"),children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Marketplace / Quotes"}),e.jsxs("div",{className:"mt-1 grid grid-cols-2 gap-2",children:[e.jsxs("select",{value:T,disabled:!Ue,onChange:ne=>C(ne.target.value),className:Hl("w-full rounded-xl border px-2 py-2 text-sm font-semibold outline-none",Ue?"border-slate-200 bg-white text-slate-900":"border-slate-200 bg-slate-50 text-slate-500"),children:[e.jsx("option",{value:"All",children:"All"}),e.jsx("option",{value:"-",children:"(No marketplace)"}),n.map(ne=>e.jsx("option",{value:ne,children:ne},ne))]}),e.jsxs("label",{className:Hl("flex items-center justify-between gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold",!W&&"opacity-80"),children:[e.jsx("span",{className:"text-slate-700",children:"Quotes"}),e.jsx("input",{type:"checkbox",checked:W,onChange:ne=>L(ne.target.checked),className:"h-4 w-4 rounded border-slate-300"})]})]}),Ue?null:e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Marketplace applies to E-Commerce only."})]})]}),e.jsxs("div",{className:"mt-3 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("label",{className:"flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-700",children:[e.jsx("input",{type:"checkbox",checked:H,onChange:ne=>Y(ne.target.checked),className:"h-4 w-4 rounded border-slate-300"}),"Cluster mode",e.jsx(Ws,{label:"Premium",tone:"info"})]}),e.jsxs("label",{className:"flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-700",children:[e.jsx("input",{type:"checkbox",checked:oe,onChange:ne=>G(ne.target.checked),className:"h-4 w-4 rounded border-slate-300"}),"Assigned to me"]}),e.jsxs("div",{className:Hl("rounded-2xl border border-slate-200 bg-white px-3 py-2",!oe&&"opacity-70"),children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Assignee"}),e.jsxs("select",{value:F,disabled:!oe,onChange:ne=>te(ne.target.value),className:Hl("mt-1 w-full rounded-xl border border-slate-200 bg-white px-2 py-1 text-xs font-semibold text-slate-900 outline-none",!oe&&"bg-slate-50 text-slate-500"),children:[e.jsx("option",{children:"You"}),e.jsx("option",{children:"Finance Desk"}),e.jsx("option",{children:"Approver Desk"}),e.jsx("option",{children:"Org Admin"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(aa,{variant:"outline",onClick:()=>{o(""),x("All"),g("All"),$("All"),C("All"),L(!0),a({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(vn,{className:"h-4 w-4"})," Reset"]}),e.jsxs(aa,{variant:"outline",onClick:()=>a({title:"Bulk",message:"Bulk actions (demo).",kind:"info"}),children:[e.jsx(ht,{className:"h-4 w-4"})," Bulk actions"]})]})]})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[H?e.jsxs("div",{className:"space-y-4",children:[ze.map(ne=>e.jsx(BU,{clusterKey:ne.key,label:ne.label,items:ne.items,onOpen:Me=>{ye(Me),he(!0)},onAssign:Me=>{Q(Me),ce(Me.assignedTo||"You"),Pe(!0)},onResolve:Me=>z(Me),onSnooze:(Me,De)=>le(Me,De),onRule:Me=>Ve(Me)},ne.key)),ze.length?null:e.jsx(v4,{title:"No events",subtitle:"No notifications match your filters."})]}):e.jsxs("div",{className:"space-y-3",children:[Te.map(ne=>e.jsx(VE,{e:ne,onWhy:()=>{ye(ne),he(!0)},onAssign:()=>{Q(ne),ce(ne.assignedTo||"You"),Pe(!0)},onResolve:()=>z(ne),onSnooze:Me=>le(ne,Me),onRule:()=>Ve(ne)},ne.id)),Te.length?null:e.jsx(v4,{title:"No events",subtitle:"No notifications match your filters."})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Premium controls"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Digests and routing rules improve signal-to-noise."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(aa,{variant:"outline",onClick:()=>ie(!0),children:[e.jsx(Dn,{className:"h-4 w-4"})," Configure digests"]}),e.jsxs(aa,{variant:"outline",onClick:()=>Se(!0),children:[e.jsx(b4,{})," Configure routing"]}),e.jsxs(aa,{variant:"primary",onClick:()=>a({title:"Done",message:"Premium controls saved (demo).",kind:"success"}),children:[e.jsx(tt,{className:"h-4 w-4"})," Save"]})]})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsx("div",{className:"font-semibold",children:"Digests"}),e.jsx("div",{className:"mt-1 text-slate-600",children:"Daily/weekly summaries by role. Reduce notification fatigue."})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsx("div",{className:"font-semibold",children:"Routing rules"}),e.jsx("div",{className:"mt-1 text-slate-600",children:"Send finance alerts to Accountants, approval reminders to Approvers."})]})]})]}),e.jsx("div",{className:"mt-4 text-xs text-slate-500",children:"B Notifications v2: unified feed with filters, actions, delivery logs, audit-linked explanations, smart digests, routing rules, and logic-based clustering."})]})]})}),e.jsx(sm,{open:Fe,title:"Assign event",subtitle:"Assign an event to a person or desk (audit logged in production).",onClose:()=>Pe(!1),actions:[{label:"Assign",onClick:()=>{pe&&(Ae(pe,Re),Pe(!1))}}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(aa,{variant:"outline",onClick:()=>Pe(!1),children:"Cancel"}),e.jsxs(aa,{variant:"primary",onClick:()=>{pe&&(Ae(pe,Re),Pe(!1))},children:[e.jsx(Os,{className:"h-4 w-4"})," Assign"]})]}),children:pe?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsx("div",{className:"font-semibold",children:"Event"}),e.jsxs("div",{className:"mt-1 text-slate-600",children:[pe.id,"  ",pe.title]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Assign to"}),e.jsxs("select",{value:Re,onChange:ne=>ce(ne.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:[e.jsx("option",{children:"You"}),e.jsx("option",{children:"Finance Desk"}),e.jsx("option",{children:"Approver Desk"}),e.jsx("option",{children:"Org Admin"}),e.jsx("option",{children:"Support Desk"})]})]})]}):null}),e.jsx(sm,{open:xe,title:"Why did I get this?",subtitle:"Audit-linked explanation of rules and triggers.",onClose:()=>he(!1),actions:[{label:"Close",onClick:()=>he(!1)}],footer:e.jsx("div",{className:"flex justify-end",children:e.jsx(aa,{variant:"outline",onClick:()=>he(!1),children:"Close"})}),children:de?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Event"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[de.id,"  ",de.kind,"  ",de.severity]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:de.title}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:de.body})]}),e.jsx(Ws,{label:de.status,tone:de.status==="Resolved"?"good":de.status==="Snoozed"?"warn":"info"})]})}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Explanation"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(th,{label:"Rule",value:de.why.rule}),e.jsx(th,{label:"Triggered by",value:de.why.triggeredBy}),e.jsx(th,{label:"Audience",value:de.why.audience}),e.jsx(th,{label:"Audit ID",value:de.why.auditId})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-white p-3 text-xs text-slate-600",children:"Premium: This links to the immutable audit log record and policy version."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Delivery logs"}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:de.deliveries.map(ne=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:ne.channel}),e.jsx(Ws,{label:ne.status,tone:ne.status==="Failed"?"bad":ne.status==="Queued"?"warn":"good"})]}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:ne.detail})]},ne.channel))})]})]}):null}),e.jsx(sm,{open:Ke,title:"Create rule from this event",subtitle:"Generate a policy/routing rule draft based on the event.",onClose:()=>Le(!1),actions:[{label:"Create",onClick:()=>{Le(!1),a({title:"Rule created",message:"Rule draft created (demo).",kind:"success"})}}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(aa,{variant:"outline",onClick:()=>Le(!1),children:"Cancel"}),e.jsxs(aa,{variant:"primary",onClick:()=>{Le(!1),a({title:"Rule created",message:"Rule draft created (demo).",kind:"success"})},children:[e.jsx(gt,{className:"h-4 w-4"})," Create"]})]}),children:Ne?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsx("div",{className:"font-semibold",children:"Event"}),e.jsxs("div",{className:"mt-1 text-slate-600",children:[Ne.id,"  ",Ne.title]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Suggested rule"}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"This is a safe draft. Review before saving."}),e.jsx("pre",{className:"mt-3 overflow-auto rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-800",children:JSON.stringify({if:{kind:Ne.kind,severity:Ne.severity,module:Ne.module,marketplace:Ne.marketplace||"-",rootCause:Ne.rootCauseKey},then:{action:Ne.kind==="Vendor"?"Require approvals for vendor":"Route to role",routeTo:Ne.kind==="Payment"?"Accountant":"Approver",notify:["Email","WhatsApp"]},notes:"Generated from event. Audit logged."},null,2)})]})]}):null}),e.jsx(sm,{open:$e,title:"Smart digests",subtitle:"Daily/weekly summaries by role and channel.",onClose:()=>ie(!1),actions:[{label:"Send now",onClick:Be}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(aa,{variant:"outline",onClick:()=>ie(!1),children:"Close"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(aa,{variant:"outline",onClick:Ye,children:[e.jsx(kt,{className:"h-4 w-4"})," Preview"]}),e.jsxs(aa,{variant:"primary",onClick:Be,children:[e.jsx(Dn,{className:"h-4 w-4"})," Send now"]})]})]}),children:e.jsx("div",{className:"space-y-3",children:je.map(ne=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:[ne.frequency," digest"]}),e.jsx(Ws,{label:`Role: ${ne.role}`,tone:"info"}),e.jsx(Ws,{label:`Time: ${ne.timeOfDay}`,tone:"neutral"}),e.jsx(Ws,{label:ne.enabled?"Enabled":"Off",tone:ne.enabled?"good":"neutral"})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Include: ",ne.includeSev.join(", "),"  ",ne.includeKinds.join(", ")]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Channels: ",ne.channels.join(", ")]})]}),e.jsx("button",{type:"button",className:Hl("relative h-7 w-12 rounded-full transition",ne.enabled?"border-emerald-300 bg-emerald-200":"border-amber-300 bg-white"),onClick:()=>w(ne.id),"aria-label":"Toggle digest",style:{border:ne.enabled?"none":"2px solid #F77F00"},children:e.jsx("span",{className:Hl("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",ne.enabled?"left-[22px]":"left-1 ring-1 ring-slate-200")})})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: digests are generated from clustering and routing rules to reduce noise."})]},ne.id))})}),e.jsx(sm,{open:Oe,title:"Routing rules",subtitle:"Send finance alerts to Accountants, approvals to Approvers, etc.",onClose:()=>Se(!1),actions:[{label:"Save",onClick:()=>a({title:"Saved",message:"Routing rules saved (demo).",kind:"success"})}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(aa,{variant:"outline",onClick:()=>Se(!1),children:"Close"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(aa,{variant:"outline",onClick:ue,children:[e.jsx(gt,{className:"h-4 w-4"})," Add template"]}),e.jsxs(aa,{variant:"primary",onClick:()=>a({title:"Saved",message:"Routing rules saved (demo).",kind:"success"}),children:[e.jsx(tt,{className:"h-4 w-4"})," Save"]})]})]}),children:e.jsx("div",{className:"space-y-3",children:Ee.map(ne=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:ne.name}),e.jsx(Ws,{label:`Route to ${ne.routeToRole}`,tone:"info"}),e.jsx(Ws,{label:ne.enabled?"Enabled":"Off",tone:ne.enabled?"good":"neutral"})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Kinds: ",ne.match.kinds.join(", ")]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Severities: ",ne.match.severities.join(", ")]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Modules: ",ne.match.modules.join(", ")]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Marketplaces: ",ne.match.marketplaces.join(", ")]})]}),e.jsx("button",{type:"button",className:Hl("relative h-7 w-12 rounded-full border transition",ne.enabled?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>B(ne.id),"aria-label":"Toggle routing rule",style:ne.enabled?void 0:{border:"2px solid #F77F00"},children:e.jsx("span",{className:Hl("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",ne.enabled?"left-[22px]":"left-1 ring-1 ring-slate-200")})})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:'Premium: routing decisions are logged and visible in "Why did I get this?".'})]},ne.id))})}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"B Notifications & Activity Center v2: unified feed, severity/module/marketplace filters, actions (snooze/assign/resolve/create rule), channel delivery logs, audit explanations, smart digests, routing rules, and clustering."})})]})}function v4({title:t,subtitle:s}){return e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(Fo,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:s})]})}function VE({e:t,onWhy:s,onAssign:a,onResolve:l,onSnooze:n,onRule:r}){const i=UE(t.severity),o=t.status==="Snoozed";return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Ws,{label:t.severity,tone:i}),e.jsx(Ws,{label:t.kind,tone:"neutral"}),e.jsx(Ws,{label:t.module,tone:"neutral"}),t.marketplace&&t.marketplace!=="-"?e.jsx(Ws,{label:String(t.marketplace),tone:"info"}):e.jsx(Ws,{label:"No marketplace",tone:"neutral"}),e.jsx(Ws,{label:t.status,tone:t.status==="Resolved"?"good":t.status==="Snoozed"?"warn":"info"}),t.assignedTo?e.jsx(Ws,{label:`Assigned: ${t.assignedTo}`,tone:"info"}):e.jsx(Ws,{label:"Unassigned",tone:"warn"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900 truncate",children:t.title}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:t.body}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:[$U(t.ts),"  ",f4(t.ts),"  ",t.id,o&&t.snoozeUntil?e.jsxs("span",{className:"ml-2",children:[" Snoozed until ",f4(t.snoozeUntil)]}):null]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(aa,{variant:"outline",className:"text-xs",onClick:s,children:[e.jsx(Ud,{className:"h-4 w-4"})," Why?"]}),e.jsxs(aa,{variant:"outline",className:"text-xs",onClick:a,children:[e.jsx(Os,{className:"h-4 w-4"})," Assign"]}),e.jsx("div",{className:"relative",children:e.jsx(zU,{onSnooze:n})}),e.jsxs(aa,{variant:"outline",className:"text-xs",onClick:r,children:[e.jsx(ht,{className:"h-4 w-4"})," Create rule"]}),e.jsxs(aa,{variant:"primary",className:"text-xs",onClick:l,children:[e.jsx(tt,{className:"h-4 w-4"})," Resolve"]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(GU,{deliveries:t.deliveries}),e.jsx(qU,{why:t.why})]})]})}function BU({clusterKey:t,label:s,items:a,onOpen:l,onAssign:n,onResolve:r,onSnooze:i,onRule:o}){const c=a.reduce(($,T)=>{const C=W=>W==="Critical"?3:W==="Warning"?2:1;return C(T.severity)>C($)?T.severity:$},"Info"),x=UE(c),[j,g]=d.useState(!0),y=a.filter($=>$.status!=="Resolved");return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white shadow-sm",children:[e.jsxs("button",{type:"button",className:"flex w-full items-start justify-between gap-3 px-4 py-4 text-left",onClick:()=>g($=>!$),children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Ws,{label:s,tone:x}),e.jsx(Ws,{label:`${a.length} events`,tone:"neutral"}),e.jsx(Ws,{label:`${y.length} open`,tone:y.length?"warn":"good"})]}),e.jsxs("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:["Root cause: ",t]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Logic-based clustering groups similar alerts into one stack."})]}),e.jsx(ni,{className:Hl("h-5 w-5 text-slate-500 transition",j?"rotate-180":"rotate-0")})]}),e.jsx(lt,{initial:!1,children:j?e.jsx(qe.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.18},className:"border-t border-slate-200",children:e.jsx("div",{className:"space-y-3 p-4",children:a.map($=>e.jsx(VE,{e:$,onWhy:()=>l($),onAssign:()=>n($),onResolve:()=>r($),onSnooze:T=>i($,T),onRule:()=>o($)},$.id))})}):null})]})}function GU({deliveries:t}){return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Delivery status"}),e.jsx(Ws,{label:`${t.length} channels`,tone:"neutral"})]}),e.jsx("div",{className:"mt-3 grid grid-cols-2 gap-2",children:t.map(s=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:s.channel}),e.jsx(Ws,{label:s.status,tone:s.status==="Failed"?"bad":s.status==="Queued"?"warn":"good"})]}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:s.detail})]},s.channel))})]})}function qU({why:t}){return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Why did I get this?"}),e.jsx(Ws,{label:t.auditId,tone:"info"})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx(Dv,{label:"Rule",value:t.rule}),e.jsx(Dv,{label:"Triggered by",value:t.triggeredBy}),e.jsx(Dv,{label:"Audience",value:t.audience})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: audit ID links to immutable audit log."})]})}function Dv({label:t,value:s}){return e.jsxs("div",{className:"flex items-start justify-between gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),e.jsx("div",{className:"text-xs font-semibold text-slate-900 text-right",children:s})]})}function th({label:t,value:s}){return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:s})]})}function zU({onSnooze:t}){const[s,a]=d.useState(!1);return e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",className:"inline-flex items-center justify-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-50",onClick:()=>a(l=>!l),children:[e.jsx(KF,{className:"h-4 w-4"})," Snooze",e.jsx(ni,{className:Hl("h-4 w-4 transition",s?"rotate-180":"rotate-0")})]}),e.jsx(lt,{children:s?e.jsx(qe.div,{initial:{opacity:0,y:6,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:6,scale:.98},transition:{duration:.16},className:"absolute right-0 z-10 mt-2 w-48 overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-lg",children:[30,60,240,1440].map(l=>e.jsxs("button",{type:"button",className:"flex w-full items-center justify-between px-3 py-2 text-sm font-semibold text-slate-800 hover:bg-slate-50",onClick:()=>{t(l),a(!1)},children:[e.jsx("span",{children:l===1440?"1 day":`${l} min`}),e.jsx(sl,{className:"h-4 w-4 text-slate-500"})]},l))}):null})]})}function b4(){return e.jsx("span",{className:"grid h-4 w-4 place-items-center",children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M16 3h5v5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M4 20l6.5-6.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M14 10l7-7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M16 21h5v-5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M4 4l6.5 6.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M14 14l7 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})})}const Cd={green:"#03CD8C",orange:"#F77F00"};function Cr(...t){return t.filter(Boolean).join(" ")}function j4(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function Ki(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function y4(t,s,a){return Math.max(s,Math.min(a,t))}function N4(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function ul({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Cr("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Bl({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:Cd.green}:t==="accent"?{background:Cd.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Cr(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function WU({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Cr("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function HU({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:Cr("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function Iv({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="900px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[8vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(HU,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function XU({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r}){return d.useEffect(()=>{const i=o=>o.key==="Escape"&&n();return t&&window.addEventListener("keydown",i),()=>window.removeEventListener("keydown",i)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,x:16},animate:{opacity:1,x:0},exit:{opacity:0,x:16},transition:{duration:.18},className:Cr("fixed z-50 overflow-hidden border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]","left-2 right-2 bottom-2 top-[14vh] rounded-[28px]","lg:left-auto lg:right-4 lg:top-4 lg:bottom-4 lg:w-[560px]"),role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-base font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"h-full min-h-0 overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function KU(){const[t,s]=d.useState([]),a=fe=>{const me=j4("toast");s(Xe=>[{id:me,...fe},...Xe].slice(0,4)),window.setTimeout(()=>s(Xe=>Xe.filter(V=>V.id!==me)),3200)},l=["Org Admin","Accountant","Approver","Manager","Travel Coordinator"],n=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],r=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],i=["Users","Groups","Cost centers","Invoices","Trips","Purchases","Vendors","RFQs","Approvals"],[o,c]=d.useState(""),[x,j]=d.useState(()=>new Set(i)),[g,y]=d.useState("Org Admin"),[$,T]=d.useState(!0),[C,W]=d.useState(!1),[L,R]=d.useState(""),[F,te]=d.useState(0),oe=d.useRef(null),G=d.useRef(null),[H,Y]=d.useState(null),[we,q]=d.useState(!1),[je,_e]=d.useState(""),[Ee,be]=d.useState(null),[Fe,Pe]=d.useState(!1),[pe,Q]=d.useState(""),[Re,ce]=d.useState(!1),[xe,he]=d.useState({title:"Company vehicle purchase",module:"Rides & Logistics",marketplace:"All",estValue:285e6,neededBy:"2026-02-01",description:"Need a company vehicle. Include warranty and delivery timeline.",attachments:!0}),[de,ye]=d.useState({group:"Operations",period:"Monthly",amount:5e6,hardCap:!0}),[Ke,Le]=d.useState({mode:"Soft pause",scope:"CorporatePay only",notifyUsers:!0}),[Ne,ge]=d.useState({month:"2026-01",format:"CSV",breakdown:"Group + Module + Marketplace"}),$e=d.useMemo(()=>{const fe=Date.now();return{users:[{id:"U-1001",name:"Mary N.",email:"mary@acme.com",group:"Operations",role:"Manager"},{id:"U-1002",name:"Finance Desk",email:"finance@acme.com",group:"Finance",role:"Accountant"},{id:"U-1003",name:"John S.",email:"john@acme.com",group:"Sales",role:"User"}],groups:[{id:"G-OPS",name:"Operations",budget:15e6,usedPct:61},{id:"G-SALES",name:"Sales",budget:12e6,usedPct:82},{id:"G-FIN",name:"Finance",budget:6e6,usedPct:68}],costCenters:[{id:"CC-OPS-001",code:"OPS-001",name:"Operations core",group:"Operations"},{id:"CC-SALES-TR",code:"SALES-TRAVEL",name:"Travel",group:"Sales"},{id:"CC-FIN-OPS",code:"FIN-OPS",name:"Finance operations",group:"Finance"}],invoices:[{id:"INV-2026-0017",status:"Overdue",amount:24e5,group:"Admin",due:fe-2*24*60*60*1e3},{id:"INV-2026-0018",status:"Sent",amount:68e5,group:"Operations",due:fe+5*24*60*60*1e3}],trips:[{id:"TR-0442",route:"Office  Airport",rider:"John S.",amount:82e3,time:fe-45*60*1e3},{id:"TR-0443",route:"Office  Client HQ",rider:"Mary N.",amount:41500,time:fe-3*60*60*1e3}],purchases:[{id:"PO-9001",marketplace:"MyLiveDealz",vendor:"Shenzhen Store",amount:24e5,group:"Admin"},{id:"PO-9002",marketplace:"EVmart",vendor:"Kampala Office Mart",amount:12e5,group:"Operations"}],vendors:[{id:"VN-01",name:"Shenzhen Store",status:"Risk",marketplace:"MyLiveDealz"},{id:"VN-02",name:"Kampala Office Mart",status:"Preferred",marketplace:"EVmart"},{id:"VN-03",name:"City Courier",status:"OK",marketplace:"ServiceMart"}],rfqs:[{id:"RFQ-390",title:"Company vehicle",estValue:285e6,status:"Escalated",module:"Rides & Logistics"},{id:"RFQ-402",title:"Bulk EV charging credits",estValue:8e6,status:"Pending",module:"EVs & Charging"}],approvals:[{id:"AP-1821",type:"Purchase",amount:654e4,status:"Pending",module:"E-Commerce"},{id:"AP-1902",type:"Budget override",amount:18e6,status:"Pending",module:"Finance & Payments"}]}},[]),ie=d.useMemo(()=>{const fe=[];return $e.users.forEach(me=>fe.push({scope:"Users",id:me.id,title:me.name,subtitle:me.email,meta:`Group: ${me.group}  Role: ${me.role}`,tags:[me.group,me.role],raw:me})),$e.groups.forEach(me=>fe.push({scope:"Groups",id:me.id,title:me.name,subtitle:`Budget: ${Ki(me.budget)}`,meta:`Used: ${me.usedPct}%`,tags:["Budget"],raw:me})),$e.costCenters.forEach(me=>fe.push({scope:"Cost centers",id:me.id,title:`${me.code} - ${me.name}`,subtitle:`Group: ${me.group}`,meta:"Used in exports and chargeback",tags:[me.group,"Cost center"],raw:me})),$e.invoices.forEach(me=>fe.push({scope:"Invoices",id:me.id,title:me.id,subtitle:`Status: ${me.status}`,meta:`Amount: ${Ki(me.amount)}  Due: ${N4(me.due)}`,tags:[me.status,me.group],raw:me})),$e.trips.forEach(me=>fe.push({scope:"Trips",id:me.id,title:me.route,subtitle:`Rider: ${me.rider}`,meta:`Amount: ${Ki(me.amount)}  Time: ${N4(me.time)}`,tags:["Ride"],raw:me})),$e.purchases.forEach(me=>fe.push({scope:"Purchases",id:me.id,title:me.id,subtitle:`Marketplace: ${me.marketplace}`,meta:`Vendor: ${me.vendor}  Amount: ${Ki(me.amount)}  Group: ${me.group}`,tags:[me.marketplace,me.vendor,me.group],raw:me})),$e.vendors.forEach(me=>fe.push({scope:"Vendors",id:me.id,title:me.name,subtitle:`Marketplace: ${me.marketplace}`,meta:`Status: ${me.status}`,tags:[me.status,me.marketplace],raw:me})),$e.rfqs.forEach(me=>fe.push({scope:"RFQs",id:me.id,title:me.title,subtitle:`Status: ${me.status}`,meta:`Value: ${Ki(me.estValue)}  Module: ${me.module}`,tags:[me.status,me.module],raw:me})),$e.approvals.forEach(me=>fe.push({scope:"Approvals",id:me.id,title:me.id,subtitle:`Type: ${me.type}`,meta:`Amount: ${Ki(me.amount)}  Module: ${me.module}  Status: ${me.status}`,tags:[me.status,me.module],raw:me})),fe},[$e]),Oe=d.useMemo(()=>{const fe=o.trim().toLowerCase(),me=Array.from(x),Xe=E=>me.includes(E.scope)?fe?`${E.scope} ${E.id} ${E.title} ${E.subtitle} ${E.meta} ${(E.tags||[]).join(" ")}`.toLowerCase().includes(fe):!0:!1,V={Users:[],Groups:[],"Cost centers":[],Invoices:[],Trips:[],Purchases:[],Vendors:[],RFQs:[],Approvals:[]};return ie.filter(Xe).forEach(E=>V[E.scope].push(E)),Object.keys(V).forEach(E=>{V[E]=V[E].slice(0,8)}),V},[ie,o,x]),Se=d.useMemo(()=>Object.values(Oe).reduce((fe,me)=>fe+me.length,0),[Oe]),[Te,Ge]=d.useState(()=>[{id:"SS-001",role:"Accountant",name:"Overdue invoices",query:"overdue",scopes:["Invoices","Payments"].filter(Boolean)},{id:"SS-002",role:"Approver",name:"Pending approvals",query:"pending",scopes:["Approvals","RFQs"]},{id:"SS-003",role:"Org Admin",name:"Vendor risk",query:"risk",scopes:["Vendors","Purchases"]}]);d.useEffect(()=>{Ge(fe=>fe.map(me=>({...me,scopes:me.scopes.filter(Xe=>i.includes(Xe))})))},[]);const We=d.useMemo(()=>Te.filter(fe=>fe.role===g),[Te,g]),ze=()=>{const fe=o.trim()?`Search: ${o.trim()}`:"My search";_e(fe),q(!0)},Ue=()=>{const fe=je.trim();if(!fe){a({title:"Missing name",message:"Enter a name for the saved search.",kind:"warn"});return}const me={id:j4("SS"),role:g,name:fe,query:o,scopes:Array.from(x)};Ge(Xe=>[me,...Xe]),q(!1),a({title:"Saved",message:`Saved search for ${g}.`,kind:"success"})},le=fe=>{c(fe.query),j(new Set(fe.scopes)),a({title:"Applied",message:`Applied saved search: ${fe.name}`,kind:"success"})},z=fe=>{Ge(me=>me.filter(Xe=>Xe.id!==fe)),a({title:"Deleted",message:"Saved search removed.",kind:"info"})},Ae=fe=>{be(fe),Q(""),ce(!1),Pe(!0)},Ve=d.useMemo(()=>pe.trim().length>=8&&Re,[pe,Re]),Ye=()=>{if(Ee){if(!Ve){a({title:"Reason required",message:"Add a clear reason and confirm acknowledgement.",kind:"warn"});return}Ee==="rfq"&&a({title:"RFQ created",message:`${xe.title}  ${Ki(xe.estValue)}`,kind:"success"}),Ee==="budget"&&a({title:"Budget issued",message:`${de.group}: ${Ki(de.amount)} (${de.period})`,kind:"success"}),Ee==="freeze"&&a({title:"CorporatePay frozen",message:`${Ke.mode}  Notifications: ${Ke.notifyUsers?"On":"Off"}`,kind:"warn"}),Ee==="export"&&a({title:"Report exported",message:`${Ne.month}  ${Ne.format}`,kind:"success"}),Pe(!1)}},Be=async()=>{const fe={action:Ee,reason:pe,actorRole:g,createdAt:new Date().toISOString(),draft:Ee==="rfq"?xe:Ee==="budget"?de:Ee==="freeze"?Ke:Ne};try{await navigator.clipboard.writeText(JSON.stringify(fe,null,2)),a({title:"Copied",message:"Audit preview copied.",kind:"success"})}catch{a({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},w=d.useMemo(()=>[{id:"cmd_rfq",label:"Create RFQ",description:"Request a quote for high-value assets",shortcut:"A R",group:"Quick actions",run:()=>Ae("rfq")},{id:"cmd_budget",label:"Issue budget",description:"Allocate budget to a group",shortcut:"A B",group:"Quick actions",run:()=>Ae("budget")},{id:"cmd_freeze",label:"Freeze CorporatePay",description:"Pause CorporatePay at checkout",shortcut:"A F",group:"Quick actions",run:()=>Ae("freeze")},{id:"cmd_export",label:"Export month report",description:"Export spend and approvals report",shortcut:"A E",group:"Quick actions",run:()=>Ae("export")},{id:"nav_dashboard",label:"Go to Corporate Dashboard",description:"Open the dashboard",shortcut:"G D",group:"Navigate",run:()=>a({title:"Navigate",message:"Opening Corporate Dashboard (demo).",kind:"info"})},{id:"nav_approvals",label:"Go to Approvals Inbox",description:"Open approvals queue",shortcut:"G A",group:"Navigate",run:()=>a({title:"Navigate",message:"Opening Approvals Inbox (demo).",kind:"info"})},{id:"tool_save",label:"Save this search",description:"Save current query and scopes",shortcut:"S",group:"Tools",run:()=>ze()}],[g,Ee,pe,xe,de,Ke,Ne,o,x]),B=d.useMemo(()=>{const fe=L.trim().toLowerCase(),me=fe?w.filter(V=>`${V.label} ${V.description} ${V.group} ${V.shortcut}`.toLowerCase().includes(fe)):w,Xe=V=>V==="Quick actions"?0:V==="Navigate"?1:2;return[...me].sort((V,E)=>{const u=Xe(V.group),P=Xe(E.group);return u!==P?u-P:V.label.localeCompare(E.label)})},[w,L]);d.useEffect(()=>{const fe=me=>{var E;if((navigator.platform.toLowerCase().includes("mac")?me.metaKey:me.ctrlKey)&&me.key.toLowerCase()==="k"&&(me.preventDefault(),W(!0),R(""),te(0),window.setTimeout(()=>{var u;return(u=oe.current)==null?void 0:u.focus()},50)),!C&&me.key==="/"&&(me.preventDefault(),(E=G.current)==null||E.focus()),C&&(me.key==="ArrowDown"&&(me.preventDefault(),te(u=>y4(u+1,0,Math.max(0,B.length-1)))),me.key==="ArrowUp"&&(me.preventDefault(),te(u=>y4(u-1,0,Math.max(0,B.length-1)))),me.key==="Enter")){me.preventDefault();const u=B[F];u&&(W(!1),u.run())}};return window.addEventListener("keydown",fe),()=>window.removeEventListener("keydown",fe)},[C,B,F]);const ue=fe=>{j(me=>{const Xe=new Set(me);return Xe.has(fe)?Xe.delete(fe):Xe.add(fe),Xe})},ne=()=>{j(new Set(i)),a({title:"Scopes reset",message:"Searching across all entities.",kind:"info"})},Me=d.useMemo(()=>i.filter(me=>Oe[me].length>0).map(me=>({scope:me,items:Oe[me]})),[Oe]),De=fe=>{switch(fe){case"Users":return e.jsx(Os,{className:"h-4 w-4"});case"Groups":return e.jsx(La,{className:"h-4 w-4"});case"Cost centers":return e.jsx(jw,{className:"h-4 w-4"});case"Invoices":return e.jsx(kt,{className:"h-4 w-4"});case"Trips":return e.jsx(Wx,{className:"h-4 w-4"});case"Purchases":return e.jsx(yw,{className:"h-4 w-4"});case"Vendors":return e.jsx(kw,{className:"h-4 w-4"});case"RFQs":return e.jsx(ri,{className:"h-4 w-4"});case"Approvals":return e.jsx(ct,{className:"h-4 w-4"});default:return e.jsx(pa,{className:"h-4 w-4"})}};return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(WU,{toasts:t,onDismiss:fe=>s(me=>me.filter(Xe=>Xe.id!==fe))}),e.jsx(Iv,{open:C,title:"Command Center",subtitle:"Type to search commands. Use arrow keys and Enter.",onClose:()=>W(!1),footer:e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Tip: use Ctrl+K (or Cmd+K) to open. Use / to focus search."}),e.jsx(Bl,{variant:"outline",onClick:()=>W(!1),children:"Close"})]}),maxW:"760px",children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2 shadow-sm focus-within:ring-4 focus-within:ring-emerald-100",children:[e.jsx(Bp,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{ref:oe,value:L,onChange:fe=>{R(fe.target.value),te(0)},placeholder:"Search commands or pages...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"})]}),e.jsx("div",{className:"mt-4 overflow-hidden rounded-2xl border border-slate-200 bg-white",children:e.jsx("div",{className:"max-h-[420px] overflow-auto",children:B.length?e.jsx("div",{className:"divide-y divide-slate-100",children:B.map((fe,me)=>e.jsxs("button",{type:"button",onClick:()=>{W(!1),fe.run()},className:Cr("flex w-full items-start justify-between gap-3 px-4 py-3 text-left",me===F?"bg-emerald-50":"hover:bg-slate-50"),children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:fe.label}),e.jsx(ul,{label:fe.group,tone:fe.group==="Quick actions"?"info":"neutral"})]}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:fe.description})]}),e.jsx("div",{className:"shrink-0 rounded-xl border border-slate-200 bg-white px-2 py-1 text-xs font-semibold text-slate-700",children:fe.shortcut})]},fe.id))}):e.jsx("div",{className:"p-6 text-sm text-slate-600",children:"No commands found."})})})]})}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsx("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:Cd.green},children:e.jsx(Bp,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Global Search and Command Center"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Search users, invoices, vendors, RFQs, approvals and more. Run audited admin actions."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(ul,{label:`Role: ${g}`,tone:"info"}),e.jsx(ul,{label:`Hits: ${Se}`,tone:Se?"good":"neutral"}),e.jsx(ul,{label:$?"Operator mode: On":"Operator mode: Off",tone:$?"warn":"neutral"}),e.jsx(ul,{label:"Ctrl+K",tone:"neutral"}),e.jsx(ul,{label:"/",tone:"neutral"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Role"}),e.jsx("select",{value:g,onChange:fe=>y(fe.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-2 py-1 text-xs font-semibold text-slate-900 outline-none",children:l.map(fe=>e.jsx("option",{value:fe,children:fe},fe))})]}),e.jsxs("button",{type:"button",className:Cr("rounded-2xl border px-3 py-2 text-sm font-semibold",$?"border-amber-200 bg-amber-50 text-amber-900":"border-slate-200 bg-white text-slate-700 hover:bg-slate-50"),onClick:()=>{T(fe=>!fe),a({title:"Operator mode",message:$?"Disabled":"Enabled",kind:"info"})},children:[e.jsx(ht,{className:"h-4 w-4"})," Operator mode"]}),e.jsxs(Bl,{variant:"outline",onClick:()=>{W(!0),R(""),te(0),window.setTimeout(()=>{var fe;return(fe=oe.current)==null?void 0:fe.focus()},50)},children:[e.jsx(Bp,{className:"h-4 w-4"})," Open commands"]}),e.jsxs(Bl,{variant:"primary",onClick:ze,children:[e.jsx(Nv,{className:"h-4 w-4"})," Save search"]})]})]})}),e.jsx("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Saved searches"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: saved searches per role."})]}),e.jsx(ul,{label:`${We.length}`,tone:"neutral"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:We.length?We.map(fe=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("button",{type:"button",className:"min-w-0 text-left",onClick:()=>le(fe),children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:fe.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Query:"," ",fe.query||"(none)"]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[fe.scopes.slice(0,4).map(me=>e.jsx(ul,{label:me,tone:"neutral"},me)),fe.scopes.length>4?e.jsx(ul,{label:`+${fe.scopes.length-4}`,tone:"neutral"}):null]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(Bl,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>le(fe),children:"Apply"}),e.jsx(Bl,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>z(fe.id),children:e.jsx(as,{className:"h-4 w-4"})})]})]})},fe.id)):e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-6 text-center",children:[e.jsx("div",{className:"mx-auto grid h-10 w-10 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(Nv,{className:"h-5 w-5"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No saved searches"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Save your first search for this role."})]})})]})}),e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Search"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Users, groups, cost centers, invoices, trips, purchases, vendors, RFQs, approvals."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Bl,{variant:"outline",onClick:ne,children:[e.jsx(vn,{className:"h-4 w-4"})," ","Scopes: All"]}),e.jsxs(Bl,{variant:"outline",onClick:()=>{c(""),a({title:"Cleared",message:"Search cleared.",kind:"info"})},children:[e.jsx(Qe,{className:"h-4 w-4"})," Clear"]}),e.jsxs(Bl,{variant:"primary",onClick:()=>{W(!0),R(""),te(0),window.setTimeout(()=>{var fe;return(fe=oe.current)==null?void 0:fe.focus()},50)},children:[e.jsx(Bp,{className:"h-4 w-4"})," ","Commands"]})]})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2 shadow-sm focus-within:ring-4 focus-within:ring-emerald-100",children:[e.jsx(pa,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{ref:G,value:o,onChange:fe=>c(fe.target.value),placeholder:"Search across the whole corporate account...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"}),e.jsx("span",{className:"rounded-xl border border-slate-200 bg-slate-50 px-2 py-1 text-xs font-semibold text-slate-700",children:"/"})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:i.map(fe=>{const me=x.has(fe);return e.jsxs("button",{type:"button",onClick:()=>ue(fe),className:Cr("flex items-center gap-2 rounded-full px-3 py-2 text-xs font-semibold ring-1 transition",me?"bg-emerald-600 text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:me?{background:Cd.green}:void 0,children:[e.jsx("span",{className:Cr("text-white",!me&&"text-slate-600"),children:De(fe)}),fe]},fe)})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: use saved searches per role for common workflows. Use command center for actions."})]}),e.jsx("div",{className:"space-y-4",children:Me.length?Me.map(fe=>e.jsx(QU,{scope:fe.scope,items:fe.items,onOpen:me=>Y(me)},fe.scope)):e.jsx(YU,{title:"No results",subtitle:"Try a different query or enable more scopes."})}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Premium: audit-friendly actions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Every destructive action requires a reason and produces an audit preview."})]}),e.jsx(ul,{label:"Always on",tone:"good"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx($v,{title:"Reason",value:"Why are you performing this action?"}),e.jsx($v,{title:"Scope",value:"Which org, group, or module is affected?"}),e.jsx($v,{title:"Audit",value:"Audit ID is created and visible to Admins."})]})]}),e.jsx("div",{className:"text-xs text-slate-500",children:"C Global Search v2: unified search across all entities, premium saved searches per role, operator shortcuts, and audited quick actions."})]})]})})]})}),e.jsx(XU,{open:!!H,title:H?`${H.scope}: ${H.title}`:"",subtitle:H?`${H.id}  ${H.subtitle}`:"",onClose:()=>Y(null),footer:H?e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Tags:"," ",(H.tags||[]).slice(0,4).join(", ")||"-"]}),e.jsxs(Bl,{variant:"primary",onClick:()=>a({title:"Open",message:`Opening ${H.id} (demo).`,kind:"info"}),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]})]}):null,children:H?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Summary"}),e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:H.meta}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(ul,{label:H.scope,tone:"info"}),e.jsx(ul,{label:H.id,tone:"neutral"})]})]}),e.jsxs(Bl,{variant:"outline",onClick:()=>a({title:"Copy",message:"Copied ID (demo).",kind:"success"}),children:[e.jsx(ss,{className:"h-4 w-4"})," Copy ID"]})]})}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Raw data"}),e.jsx("pre",{className:"mt-3 max-h-[360px] overflow-auto rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-800",children:JSON.stringify(H.raw,null,2)}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"In production, this panel respects role permissions and redacts sensitive fields."})]})]}):null}),e.jsx(Iv,{open:we,title:"Save search",subtitle:"Premium: saved searches per role",onClose:()=>q(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Bl,{variant:"outline",onClick:()=>q(!1),children:"Cancel"}),e.jsxs(Bl,{variant:"primary",onClick:Ue,children:[e.jsx(Nv,{className:"h-4 w-4"})," Save"]})]}),maxW:"780px",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Name"}),e.jsx("input",{value:je,onChange:fe=>_e(fe.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Saved under role: ",g]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Preview"}),e.jsxs("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:["Query: ",o||"(none)"]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[Array.from(x).slice(0,6).map(fe=>e.jsx(ul,{label:fe,tone:"neutral"},fe)),x.size>6?e.jsx(ul,{label:`+${x.size-6}`,tone:"neutral"}):null]})]})]})}),e.jsx(Iv,{open:Fe,title:Ee==="rfq"?"Create RFQ":Ee==="budget"?"Issue budget":Ee==="freeze"?"Freeze CorporatePay":Ee==="export"?"Export month report":"Action",subtitle:"Audit-friendly confirmation and reason prompt",onClose:()=>Pe(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Bl,{variant:"outline",onClick:()=>Pe(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Bl,{variant:"outline",onClick:Be,children:[e.jsx(ss,{className:"h-4 w-4"})," Copy audit preview"]}),e.jsxs(Bl,{variant:Ee==="freeze"?"danger":"primary",onClick:Ye,disabled:!Ve,children:[e.jsx(tt,{className:"h-4 w-4"})," Confirm"]})]})]}),maxW:"980px",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[Ee==="rfq"?e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"RFQ details"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Lv,{label:"Title",value:xe.title,onChange:fe=>he(me=>({...me,title:fe})),placeholder:"RFQ title"}),e.jsx(Qi,{label:"Service Module",value:xe.module,onChange:fe=>he(me=>({...me,module:fe})),options:[...n]}),e.jsx(Qi,{label:"Marketplace",value:xe.marketplace,onChange:fe=>he(me=>({...me,marketplace:fe})),options:["All",...r]}),e.jsx(Lv,{label:"Needed by",value:xe.neededBy,onChange:fe=>he(me=>({...me,neededBy:fe})),placeholder:"YYYY-MM-DD"}),e.jsx(w4,{label:"Estimated value (UGX)",value:xe.estValue,onChange:fe=>he(me=>({...me,estValue:fe}))}),e.jsx(Fv,{label:"Attachments",value:xe.attachments,onChange:fe=>he(me=>({...me,attachments:fe}))}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Description"}),e.jsx("textarea",{value:xe.description,onChange:fe=>he(me=>({...me,description:fe.target.value})),rows:4,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 outline-none"})]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"RFQs are routed to approvals and can use milestone payments after quote approval."})]}):null,Ee==="budget"?e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Budget details"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Qi,{label:"Group",value:de.group,onChange:fe=>ye(me=>({...me,group:fe})),options:["Operations","Sales","Finance","Admin","Procurement"]}),e.jsx(Qi,{label:"Period",value:de.period,onChange:fe=>ye(me=>({...me,period:fe})),options:["Weekly","Monthly","Quarterly","Annual"]}),e.jsx(w4,{label:"Amount (UGX)",value:de.amount,onChange:fe=>ye(me=>({...me,amount:fe}))}),e.jsx(Fv,{label:"Hard cap",value:de.hardCap,onChange:fe=>ye(me=>({...me,hardCap:fe}))})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: large budget changes can require approvals."})]}):null,Ee==="freeze"?e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Freeze details"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Qi,{label:"Mode",value:Ke.mode,onChange:fe=>Le(me=>({...me,mode:fe})),options:["Soft pause","Full stop"]}),e.jsx(Qi,{label:"Scope",value:Ke.scope,onChange:fe=>Le(me=>({...me,scope:fe})),options:["CorporatePay only","All services and purchases"]}),e.jsx(Fv,{label:"Notify users",value:Ke.notifyUsers,onChange:fe=>Le(me=>({...me,notifyUsers:fe}))})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-rose-50 p-3 text-xs text-rose-800 ring-1 ring-rose-200",children:"Freeze is a sensitive action. Consider dual approval for full stop."})]}):null,Ee==="export"?e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Export details"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Lv,{label:"Month",value:Ne.month,onChange:fe=>ge(me=>({...me,month:fe})),placeholder:"YYYY-MM"}),e.jsx(Qi,{label:"Format",value:Ne.format,onChange:fe=>ge(me=>({...me,format:fe})),options:["CSV","PDF","JSON"]}),e.jsx(Qi,{label:"Breakdown",value:Ne.breakdown,onChange:fe=>ge(me=>({...me,breakdown:fe})),options:["Group + Module + Marketplace","Group only","Vendor only","Approvals only"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: scheduled exports can be configured in Integrations."})]}):null,e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Reason and acknowledgement"}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Reason is required for audit logs. Keep it specific."}),e.jsx("textarea",{value:pe,onChange:fe=>Q(fe.target.value),placeholder:"Example: RFQ needed for vehicle procurement; monthly budget not sufficient; CFO approval requested",rows:4,className:"mt-3 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"}),e.jsxs("label",{className:"mt-3 flex items-start gap-3 rounded-2xl border border-slate-200 bg-slate-50 p-3",children:[e.jsx("input",{type:"checkbox",checked:Re,onChange:fe=>ce(fe.target.checked),className:"mt-1 h-4 w-4 rounded border-slate-300"}),e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"I confirm this action is authorized and will be audit logged."})]}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Minimum reason length: 8 characters."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Audit preview"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"This is the record that would be stored."})]}),e.jsx(ul,{label:"Preview",tone:"info"})]}),e.jsx("pre",{className:"mt-3 max-h-[360px] overflow-auto rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-800",children:JSON.stringify({action:Ee,actorRole:g,at:new Date().toISOString(),reason:pe,draft:Ee==="rfq"?xe:Ee==="budget"?de:Ee==="freeze"?Ke:Ne},null,2)}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: map this to immutable audit log IDs and include policy version."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Safety tips"}),e.jsxs("ul",{className:"mt-3 space-y-2 text-sm text-slate-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:Cd.green}})," ","Use group-level budgets before user caps."]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:Cd.orange}})," ","For freezing, notify users to avoid disruptions."]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:Cd.green}})," ","For RFQs, attach specs and required documents."]})]})]})]})]})}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"C Global Search & Command Center v2: unified search + premium saved searches per role + operator shortcuts + audited quick actions."})})]})}function QU({scope:t,items:s,onOpen:a}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-600",children:l(t)}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Top matches"})]})]}),e.jsx(ul,{label:`${s.length}`,tone:"neutral"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:s.map(n=>e.jsxs("button",{type:"button",onClick:()=>a(n),className:"w-full rounded-2xl border border-slate-200 bg-white p-3 text-left hover:bg-slate-50",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:n.title}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:n.subtitle}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:n.meta})]}),e.jsx(et,{className:"mt-1 h-5 w-5 text-slate-400"})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[(n.tags||[]).slice(0,4).map(r=>e.jsx(ul,{label:r,tone:"neutral"},r)),(n.tags||[]).length>4?e.jsx(ul,{label:`+${(n.tags||[]).length-4}`,tone:"neutral"}):null]})]},n.id))})]});function l(n){switch(n){case"Users":return e.jsx(Os,{className:"h-4 w-4"});case"Groups":return e.jsx(La,{className:"h-4 w-4"});case"Cost centers":return e.jsx(jw,{className:"h-4 w-4"});case"Invoices":return e.jsx(kt,{className:"h-4 w-4"});case"Trips":return e.jsx(Wx,{className:"h-4 w-4"});case"Purchases":return e.jsx(yw,{className:"h-4 w-4"});case"Vendors":return e.jsx(kw,{className:"h-4 w-4"});case"RFQs":return e.jsx(ri,{className:"h-4 w-4"});case"Approvals":return e.jsx(ct,{className:"h-4 w-4"});default:return e.jsx(pa,{className:"h-4 w-4"})}}}function $v({title:t,value:s}){return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:s})]})}function YU({title:t,subtitle:s}){return e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-10 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(pa,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:s})]})}function Lv({label:t,value:s,onChange:a,placeholder:l}){return e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),e.jsx("input",{value:s,onChange:n=>a(n.target.value),placeholder:l,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"})]})}function w4({label:t,value:s,onChange:a}){return e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),e.jsx("input",{type:"number",value:s,onChange:l=>a(Number(l.target.value||0)),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"})]})}function Qi({label:t,value:s,onChange:a,options:l}){return e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),e.jsx("select",{value:s,onChange:n=>a(n.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:l.map(n=>e.jsx("option",{value:n,children:n},n))})]})}function Fv({label:t,value:s,onChange:a}){return e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:s?"On":"Off"})]}),e.jsx("button",{type:"button",className:Cr("relative h-7 w-12 rounded-full border transition",s?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>a(!s),"aria-label":t,children:e.jsx("span",{className:Cr("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",s?"left-[22px]":"left-1")})})]})})}const Xx={green:"#03CD8C",orange:"#F77F00"};function dn(...t){return t.filter(Boolean).join(" ")}function Rr(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function JU(t,s,a){return Math.max(s,Math.min(a,t))}function el({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:dn("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Yt({variant:t="outline",children:s,onClick:a,className:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:Xx.green}:t==="accent"?{background:Xx.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:a,style:c,className:dn(i,o[t],n&&"cursor-not-allowed opacity-60",l),children:s})}function ZU({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:dn("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:dn("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function js({label:t,value:s,onChange:a,placeholder:l,hint:n,required:r,type:i="text",disabled:o}){const c=!!r&&!s.trim();return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"text-xs font-semibold text-slate-600",children:[t,r?e.jsx("span",{className:"text-rose-600",children:" *"}):null]}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:i,value:s,onChange:x=>a(x.target.value),placeholder:l,disabled:o,className:dn("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold shadow-sm outline-none focus:ring-4",o?"border-slate-200 bg-slate-50 text-slate-500":c?"border-rose-300 bg-white text-slate-900 focus:ring-rose-100":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")}),c?e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:"Required"}):null]})}function sh({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:i=>a(i.target.value),placeholder:l,rows:r,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"})]})}function am({label:t,value:s,onChange:a,options:l,hint:n}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:r=>a(r.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",children:l.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]})}function eV({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:dn("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function lm({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="920px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[8vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(eV,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function tV({value:t}){const s=JU(t,0,100),a=76,l=10,n=(a-l)/2,r=2*Math.PI*n,i=s/100*r;return e.jsxs("div",{className:"relative grid place-items-center",children:[e.jsxs("svg",{width:a,height:a,className:"-rotate-90",children:[e.jsx("circle",{cx:a/2,cy:a/2,r:n,stroke:"#E2E8F0",strokeWidth:l,fill:"none"}),e.jsx("circle",{cx:a/2,cy:a/2,r:n,stroke:Xx.green,strokeWidth:l,fill:"none",strokeDasharray:`${i} ${r}`,strokeLinecap:"round"})]}),e.jsxs("div",{className:"absolute text-sm font-semibold text-slate-900",children:[Math.round(s),"%"]})]})}function sV({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:dn("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(en,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function Bn({title:t,subtitle:s,children:a,right:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),l]}),e.jsx("div",{className:"mt-4",children:a})]})}function Uv({title:t,subtitle:s}){return e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(La,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:s})]})}function jn({ok:t,label:s}){return e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:s}),t?e.jsx(el,{label:"Done",tone:"good"}):e.jsx(el,{label:"Pending",tone:"warn"})]})}function aV({label:t,onRemove:s}){return e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-slate-50 px-3 py-2 text-xs font-semibold text-slate-700 ring-1 ring-slate-200",children:[t,s?e.jsx("button",{type:"button",className:"rounded-full p-1 hover:bg-slate-200",onClick:s,"aria-label":`Remove ${t}`,children:e.jsx(Qe,{className:"h-3.5 w-3.5"})}):null]})}function ah(t){const s={};return t.forEach(a=>s[a]=!0),s}function lh(t){const s={};return t.forEach(a=>s[a]=a!=="Other Marketplace"),s}function lV(){const t=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],s=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],[a,l]=d.useState([]),n=k=>{const m=Rr("toast");l(S=>[{id:m,...k},...S].slice(0,4)),window.setTimeout(()=>l(S=>S.filter(f=>f.id!==m)),3200)},[r,i]=d.useState("profile"),o=[{id:"profile",label:"Company profile",subtitle:"Identity and basics"},{id:"entities",label:"Entities and branches",subtitle:"Multi-country setup"},{id:"billing",label:"Billing contacts",subtitle:"AP and finance distribution"},{id:"branding",label:"Branding and invoice",subtitle:"Logo and invoice text"},{id:"modules",label:"Modules and defaults",subtitle:"Enable modules and policy defaults"},{id:"invoiceGroups",label:"Invoice groups",subtitle:"AP codes and routing"},{id:"support",label:"EVzone support",subtitle:"Support mode toggle"},{id:"goLive",label:"Go-live",subtitle:"Readiness and publish"}],[c,x]=d.useState({displayName:"Acme Group Ltd",legalName:"Acme Group Limited",registrationNo:"80020012345678",website:"",industry:"Corporate",baseCurrency:"UGX"}),[j,g]=d.useState([{id:Rr("ENT"),name:"Uganda HQ",country:"Uganda",city:"Kampala",address1:"Plot 12, Nkrumah Road",address2:"Suite 5",postal:"P.O. Box 12345",currency:"UGX",taxId:"TIN-123-456-789",vatNo:"VAT-UG-00991",isPrimary:!0},{id:Rr("ENT"),name:"China Branch",country:"China",city:"Wuxi",address1:"Room 265, No. 3 Gaolang East Road",address2:"Xinwu District",postal:"214000",currency:"CNY",taxId:"CN-TAX-0001",vatNo:"CN-VAT-0001",isPrimary:!1}]),[y,$]=d.useState([{id:Rr("BC"),name:"Finance Desk",role:"Finance",email:"finance@acme.com",phone:"+256 700 000 000",channels:{email:!0,whatsapp:!0,wechat:!1,sms:!0}},{id:Rr("BC"),name:"Accounts Payable",role:"AP",email:"ap@acme.com",phone:"+256 701 000 000",channels:{email:!0,whatsapp:!1,wechat:!1,sms:!0}}]),T=d.useRef(null),[C,W]=d.useState(""),[L,R]=d.useState("Thank you for partnering with Acme Group Ltd."),[F,te]=d.useState("Net 7"),[oe,G]=d.useState("Pay via bank transfer to Acme Group Ltd. Bank: Example Bank, Account: 0123456789."),[H,Y]=d.useState(()=>{const k={};return t.forEach(m=>k[m]=m!=="Other Service Module"),k}),[we,q]=d.useState({allowedRegions:["Kampala","Entebbe","Wakiso"],workStart:"06:00",workEnd:"22:00",days:["Mon","Tue","Wed","Thu","Fri"],defaultTripCap:"UGX 250,000",defaultDailyCap:"UGX 1,200,000",defaultMonthlyCap:"UGX 12,000,000",autoApproveUnder:"UGX 200,000"}),[je,_e]=d.useState(""),[Ee,be]=d.useState(()=>{const k="All";return[{id:Rr("IG"),name:"Main corporate",entityScope:k,apEmail:"ap@acme.com",apCode:"ACME-MAIN",ccEmails:"finance@acme.com",frequency:"Weekly",prefix:"ACME",moduleScope:ah(t),marketplaceScope:lh(s),notes:"Consolidated invoice for all enabled modules."},{id:Rr("IG"),name:"Sales travel",entityScope:k,apEmail:"sales-ap@acme.com",apCode:"ACME-SALES",ccEmails:"sales@acme.com, finance@acme.com",frequency:"Monthly",prefix:"ACME-SALES",moduleScope:{...ah(t),"E-Commerce":!1,"EVs & Charging":!1,"School & E-Learning":!1,"Medical & Health Care":!1,"Travel & Tourism":!1,"Green Investments":!1,FaithHub:!1,"Virtual Workspace":!1,"Finance & Payments":!1,"Other Service Module":!1},marketplaceScope:lh(s),notes:"Rides only, charged to Sales travel cost center."}]}),[Fe,Pe]=d.useState(!0),[pe,Q]=d.useState(null),[Re,ce]=d.useState(""),[xe,he]=d.useState(!1),[de,ye]=d.useState(null),Ke=d.useMemo(()=>[{id:"corporate",name:"Corporate",desc:"General corporate spend: rides, e-commerce, services, approvals.",apply:()=>{x(k=>({...k,industry:"Corporate"})),Y(k=>({...k,"Rides & Logistics":!0,"E-Commerce":!0,"Finance & Payments":!0,"EVs & Charging":!0,"Medical & Health Care":!1,"Travel & Tourism":!0,"Green Investments":!1,FaithHub:!1,"Virtual Workspace":!0})),q(k=>({...k,allowedRegions:["Kampala","Entebbe"],workStart:"06:00",workEnd:"22:00",days:["Mon","Tue","Wed","Thu","Fri"],autoApproveUnder:"UGX 200,000"}))}},{id:"hospital",name:"Hospital",desc:"Medical operations: stronger controls, 24/7 exceptions, higher audit sensitivity.",apply:()=>{x(k=>({...k,industry:"Hospital"})),Y(k=>({...k,"Medical & Health Care":!0,"Rides & Logistics":!0,"E-Commerce":!0,"Finance & Payments":!0,"EVs & Charging":!1,"Travel & Tourism":!1,"Virtual Workspace":!0})),q(k=>({...k,allowedRegions:["Kampala","Entebbe"],workStart:"00:00",workEnd:"23:59",days:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],autoApproveUnder:"UGX 100,000"}))}},{id:"tour",name:"Tour Company",desc:"Travel heavy: airports and geo controls, stronger vendor rules, higher ride usage.",apply:()=>{x(k=>({...k,industry:"Tour Company"})),Y(k=>({...k,"Travel & Tourism":!0,"Rides & Logistics":!0,"E-Commerce":!0,"Finance & Payments":!0,"EVs & Charging":!1,"Medical & Health Care":!1,"Virtual Workspace":!0})),q(k=>({...k,allowedRegions:["Kampala","Entebbe","Jinja"],workStart:"05:00",workEnd:"23:00",days:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],autoApproveUnder:"UGX 250,000"}))}}],[x,Y,q]),[Le,Ne]=d.useState(!1),[ge,$e]=d.useState({id:"",name:"",country:"",city:"",address1:"",address2:"",postal:"",currency:"UGX",taxId:"",vatNo:"",isPrimary:!1}),[ie,Oe]=d.useState(!1),[Se,Te]=d.useState({id:"",name:"",role:"Finance",email:"",phone:"",channels:{email:!0,whatsapp:!1,wechat:!1,sms:!0}}),[Ge,We]=d.useState(!1),[ze,Ue]=d.useState({id:"",name:"",entityScope:"All",apEmail:"",apCode:"",ccEmails:"",frequency:"Weekly",prefix:"",moduleScope:ah(t),marketplaceScope:lh(s),notes:""}),le=d.useMemo(()=>{const k=!!c.displayName.trim()&&!!c.legalName.trim(),m=j.length>0&&j.some(ve=>ve.isPrimary),S=y.length>0,f=!!L.trim()&&!!F.trim()&&!!oe.trim(),U=Object.values(H).some(Boolean),p=we.allowedRegions.length>0&&!!we.workStart&&!!we.workEnd,M=Ee.length>0,ee=typeof Fe=="boolean",b=[k,m,S,f,U,p,M,ee];return{pct:b.filter(Boolean).length/b.length*100,profileOk:k,entityOk:m,billingOk:S,brandingOk:f,moduleOk:U,policyOk:p,invoiceOk:M,supportOk:ee}},[c,j,y,L,F,oe,H,we,Ee,Fe]),z=le.pct===100,Ae=()=>{const k={org:c,entities:j,billingContacts:y,branding:{logoUrl:!!C,invoiceFooter:L,paymentTerms:F,paymentInstructions:oe},modulesEnabled:H,policy:we,invoiceGroups:Ee,supportEnabled:Fe,exportedAt:new Date().toISOString()},m=JSON.stringify(k,null,2),S=new Blob([m],{type:"application/json"}),f=URL.createObjectURL(S),U=document.createElement("a");U.href=f,U.download="corporatepay-org-setup.json",U.click(),URL.revokeObjectURL(f),n({title:"Exported",message:"Downloaded JSON config.",kind:"success"})},Ve=()=>{n({title:"Saved",message:"Draft saved. Audit entry recorded (demo).",kind:"success"})},Ye=()=>{if(!z){n({title:"Not ready",message:"Complete the go-live checklist first.",kind:"warn"}),i("goLive");return}n({title:"Go-live",message:"Organization setup published. CorporatePay enabled.",kind:"success"})},Be=k=>{if(!k)return;const m=URL.createObjectURL(k);W(m),n({title:"Logo updated",message:"Logo preview refreshed.",kind:"success"})},w=()=>{$e({id:"",name:"",country:"",city:"",address1:"",address2:"",postal:"",currency:c.baseCurrency||"UGX",taxId:"",vatNo:"",isPrimary:j.length===0}),Ne(!0)},B=k=>{$e({...k}),Ne(!0)},ue=()=>{if(!ge.name.trim()||!ge.country.trim()||!ge.city.trim()||!ge.address1.trim()){n({title:"Missing fields",message:"Name, country, city, and address line 1 are required.",kind:"warn"});return}g(k=>(ge.isPrimary&&(k=k.map(m=>({...m,isPrimary:!1}))),ge.id?k.map(m=>m.id===ge.id?ge:m):[{...ge,id:Rr("ENT")},...k])),n({title:"Saved",message:"Entity saved.",kind:"success"}),Ne(!1)},ne=k=>{var S;if((S=j.find(f=>f.id===k))==null?void 0:S.isPrimary){n({title:"Blocked",message:"You cannot delete the primary entity. Set another as primary first.",kind:"warn"});return}g(f=>f.filter(U=>U.id!==k)),n({title:"Deleted",message:"Entity removed.",kind:"info"})},Me=()=>{Te({id:"",name:"",role:"Finance",email:"",phone:"",channels:{email:!0,whatsapp:!1,wechat:!1,sms:!0}}),Oe(!0)},De=()=>{if(!Se.name.trim()||!Se.email.trim()){n({title:"Missing fields",message:"Name and email are required.",kind:"warn"});return}$(k=>Se.id?k.map(m=>m.id===Se.id?Se:m):[{...Se,id:Rr("BC")},...k]),n({title:"Saved",message:"Billing contact saved.",kind:"success"}),Oe(!1)},fe=k=>{$(m=>m.filter(S=>S.id!==k)),n({title:"Deleted",message:"Contact removed.",kind:"info"})},me=()=>{Ue({id:"",name:"",entityScope:"All",apEmail:"",apCode:"",ccEmails:"",frequency:"Weekly",prefix:"",moduleScope:ah(t),marketplaceScope:lh(s),notes:""}),We(!0)},Xe=k=>{Ue(JSON.parse(JSON.stringify(k))),We(!0)},V=()=>{if(!ze.name.trim()||!ze.apEmail.trim()||!ze.apCode.trim()||!ze.prefix.trim()){n({title:"Missing fields",message:"Name, AP email, AP code, and prefix are required.",kind:"warn"});return}be(k=>ze.id?k.map(m=>m.id===ze.id?ze:m):[{...ze,id:Rr("IG")},...k]),n({title:"Saved",message:"Invoice group saved.",kind:"success"}),We(!1)},E=k=>{be(m=>m.filter(S=>S.id!==k)),n({title:"Deleted",message:"Invoice group removed.",kind:"info"})},u=()=>{if(!de)return;const k=Ke.find(m=>m.id===de);k&&(k.apply(),n({title:"Template applied",message:`${k.name} template applied.",`,kind:"success"}),he(!1))},P=k=>{ce(""),Q(k)},se=()=>{if(!Re.trim()){n({title:"Reason required",message:"Provide a reason for this change (audit).",kind:"warn"});return}const k=pe==="enable";Pe(k),Q(null),n({title:k?"Support enabled":"Support disabled",message:"Change recorded in audit log.",kind:"success"})},D=o.findIndex(k=>k.id===r),re=()=>{const k=o.findIndex(S=>S.id===r),m=o[Math.min(o.length-1,k+1)];i(m.id)},v=()=>{const k=o.findIndex(S=>S.id===r),m=o[Math.max(0,k-1)];i(m.id)};return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(sV,{toasts:a,onDismiss:k=>l(m=>m.filter(S=>S.id!==k))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white",children:[e.jsxs("div",{className:"flex flex-col gap-3 px-4 py-4 md:flex-row md:items-center md:justify-between md:px-6",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:Xx.green},children:e.jsx(Xl,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Organization Profile and Program Setup"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Configure profile, billing, modules, policy defaults, invoice routing, and EVzone support."})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 rounded-3xl border border-slate-200 bg-slate-50 px-3 py-2",children:[e.jsx(tV,{value:le.pct}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Go-live readiness"}),e.jsxs("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:[Math.round(le.pct),"%"]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:z?"Ready":"Complete checklist"})]})]}),e.jsxs(Yt,{variant:"outline",onClick:Ae,children:[e.jsx(pt,{className:"h-4 w-4"})," Export JSON"]}),e.jsxs(Yt,{variant:"outline",onClick:Ve,children:[e.jsx(Da,{className:"h-4 w-4"})," Save draft"]}),e.jsxs(Yt,{variant:"primary",disabled:!z,onClick:Ye,title:z?"Go live":"Complete readiness checklist",children:[e.jsx(ct,{className:"h-4 w-4"})," Go live"]})]})]}),e.jsxs("div",{className:"px-4 pb-4 md:px-6",children:[e.jsx("div",{className:"grid grid-cols-2 gap-2 md:grid-cols-4 lg:grid-cols-8",children:o.map((k,m)=>{const S=k.id===r,f=m<D;return e.jsx("button",{type:"button",onClick:()=>i(k.id),className:dn("rounded-2xl border px-3 py-3 text-left transition",S?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs font-semibold text-slate-600",children:["Step ",m+1]}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:k.label}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:k.subtitle})]}),f?e.jsx(ct,{className:"h-5 w-5 text-emerald-700"}):S?e.jsx(et,{className:"h-5 w-5 text-emerald-700"}):null]})},k.id)})}),e.jsxs("div",{className:"mt-3 flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Yt,{variant:"outline",onClick:v,disabled:D===0,children:"Back"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Yt,{variant:"outline",onClick:()=>{he(!0),ye("corporate")},children:[e.jsx(La,{className:"h-4 w-4"})," Templates"]}),e.jsxs(Yt,{variant:"primary",onClick:re,disabled:D===o.length-1,children:["Next",e.jsx(et,{className:"h-4 w-4"})]})]})]})]})]}),e.jsx("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(lt,{mode:"wait",children:[r==="profile"?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs(Bn,{title:"Company profile",subtitle:"Identity fields used for invoices, exports, and compliance.",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(js,{label:"Display name",required:!0,value:c.displayName,onChange:k=>x(m=>({...m,displayName:k})),placeholder:"Organization name"}),e.jsx(js,{label:"Legal name",required:!0,value:c.legalName,onChange:k=>x(m=>({...m,legalName:k})),placeholder:"Legal registered name"}),e.jsx(js,{label:"Registration number",value:c.registrationNo,onChange:k=>x(m=>({...m,registrationNo:k})),placeholder:"Business registration"}),e.jsx(js,{label:"Website",value:c.website,onChange:k=>x(m=>({...m,website:k})),placeholder:"https://"}),e.jsx(am,{label:"Industry",value:c.industry,onChange:k=>x(m=>({...m,industry:k})),options:["Corporate","Hospital","Tour Company","Other"].map(k=>({value:k,label:k})),hint:"Premium templates"}),e.jsx(am,{label:"Base currency",value:c.baseCurrency,onChange:k=>x(m=>({...m,baseCurrency:k})),options:["UGX","USD","EUR","CNY","KES","TZS"].map(k=>({value:k,label:k})),hint:"Can be per entity"})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: Use the industry templates to apply best-practice defaults for Hospital, Tour Company, or Corporate."})]})},"profile"):null,r==="entities"?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs(Bn,{title:"Entities and branches",subtitle:"Premium: multi-country entities under one organization. One must be primary.",right:e.jsxs(Yt,{variant:"primary",onClick:w,children:[e.jsx(gt,{className:"h-4 w-4"})," Add entity"]}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Name"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Country"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"City"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Currency"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Tax"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Primary"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[j.map(k=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:k.name}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:k.country}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:k.city}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:k.currency}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:k.taxId||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(el,{label:k.isPrimary?"Yes":"No",tone:k.isPrimary?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Yt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>B(k),children:[e.jsx(Uo,{className:"h-4 w-4"})," Edit"]}),e.jsxs(Yt,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>ne(k.id),children:[e.jsx(as,{className:"h-4 w-4"})," Delete"]})]})})]},k.id)),j.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10",children:e.jsx(Uv,{title:"No entities",subtitle:"Add at least one entity and mark it primary."})})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Best practice: invoice groups can route per entity using AP codes."})]})},"entities"):null,r==="billing"?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs(Bn,{title:"Billing contacts and AP distribution",subtitle:"Used for invoice delivery, reminders, and billing escalation.",right:e.jsxs(Yt,{variant:"primary",onClick:Me,children:[e.jsx(gt,{className:"h-4 w-4"})," Add contact"]}),children:[e.jsxs("div",{className:"space-y-2",children:[y.map(k=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:k.name}),e.jsx(el,{label:k.role,tone:"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[k.email,"  ",k.phone]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(el,{label:k.channels.email?"Email":"Email off",tone:k.channels.email?"good":"neutral"}),e.jsx(el,{label:k.channels.whatsapp?"WhatsApp":"WhatsApp off",tone:k.channels.whatsapp?"good":"neutral"}),e.jsx(el,{label:k.channels.wechat?"WeChat":"WeChat off",tone:k.channels.wechat?"good":"neutral"}),e.jsx(el,{label:k.channels.sms?"SMS":"SMS off",tone:k.channels.sms?"good":"neutral"})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Yt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Te(k),Oe(!0)},children:[e.jsx(Uo,{className:"h-4 w-4"})," Edit"]}),e.jsxs(Yt,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>fe(k.id),children:[e.jsx(as,{className:"h-4 w-4"})," Remove"]})]})]})},k.id)),y.length?null:e.jsx(Uv,{title:"No billing contacts",subtitle:"Add at least one contact for invoice delivery."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: routing rules can send finance alerts to Accountants and approval reminders to Approvers."})]})},"billing"):null,r==="branding"?e.jsxs(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:[e.jsx(Bn,{title:"Branding",subtitle:"Logo and invoice styling.",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Logo"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Displayed on invoices and PDF exports."})]}),e.jsx("input",{ref:T,type:"file",accept:"image/*",className:"hidden",onChange:k=>{var m;return Be(((m=k.target.files)==null?void 0:m[0])||null)}}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Yt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{var k;return(k=T.current)==null?void 0:k.click()},children:[e.jsx(dg,{className:"h-4 w-4"})," Upload"]}),e.jsxs(Yt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{W(""),n({title:"Logo cleared",message:"Using placeholder.",kind:"info"})},children:[e.jsx(as,{className:"h-4 w-4"})," Clear"]})]})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Preview"}),e.jsxs("div",{className:"mt-3 flex items-center gap-3 rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center overflow-hidden rounded-2xl bg-slate-100 text-slate-700",children:C?e.jsx("img",{src:C,alt:"Logo",className:"h-full w-full object-cover"}):e.jsx(eU,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:c.displayName||"Organization"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Invoice header"})]})]}),e.jsx("div",{className:"mt-3 text-xs text-slate-600",children:"Logos are stored securely in production."})]})]}),e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsx(sh,{label:"Invoice footer",value:L,onChange:R,hint:"Shown on all invoices",rows:5})})]})}),e.jsxs(Bn,{title:"Payment terms and instructions",subtitle:"What appears on invoices and statements.",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(js,{label:"Payment terms",value:F,onChange:te,placeholder:"Net 7",hint:"Net 7, Net 14, Due on receipt"}),e.jsx(js,{label:"Invoice subject prefix",value:c.displayName?c.displayName.split(" ")[0].toUpperCase():"ORG",onChange:()=>{},placeholder:"ACME",disabled:!0,hint:"Derived"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(sh,{label:"Payment instructions",value:oe,onChange:G,hint:"Bank transfer, mobile money, etc",rows:5})})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: invoice templates can be customized per invoice group."})]})]},"branding"):null,r==="modules"?e.jsxs(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:[e.jsxs(Bn,{title:"Module enablement",subtitle:"High-level toggles. Detailed marketplace controls are on the next page (E).",children:[e.jsx("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:t.map(k=>e.jsx(ZU,{enabled:H[k],onChange:m=>Y(S=>({...S,[k]:m})),label:k,description:k==="E-Commerce"?"Includes marketplaces like MyLiveDealz and marts.":"Enable CorporatePay for this service module."},k))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:'Note: "Other Service Module" is a future expansion slot. You can label it later.'})]}),e.jsxs(Bn,{title:"Policy defaults",subtitle:"Regions, working hours, and default spend caps applied to new users and groups.",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Allowed regions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Used for default geo restrictions."})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(Yt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>n({title:"Tip",message:"Advanced geo-fences live in Policy Builder (I).",kind:"info"}),children:[e.jsx(en,{className:"h-4 w-4"})," Geo-fences"]})})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[we.allowedRegions.map(k=>e.jsx(aV,{label:k,onRemove:()=>q(m=>({...m,allowedRegions:m.allowedRegions.filter(S=>S!==k)}))},k)),we.allowedRegions.length?null:e.jsx(el,{label:"No regions",tone:"warn"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx(js,{label:"Add region",value:je,onChange:_e,placeholder:"Example: Jinja"})}),e.jsx("div",{className:"flex items-end",children:e.jsxs(Yt,{variant:"outline",className:"w-full",onClick:()=>{const k=je.trim();if(!k){n({title:"Missing",message:"Enter a region.",kind:"warn"});return}if(we.allowedRegions.map(m=>m.toLowerCase()).includes(k.toLowerCase())){n({title:"Exists",message:"Region already listed.",kind:"info"});return}q(m=>({...m,allowedRegions:[k,...m.allowedRegions]})),_e("")},children:[e.jsx(gt,{className:"h-4 w-4"})," Add"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs(Bn,{title:"Working hours",subtitle:"Default time window for eligible transactions.",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(js,{label:"Start",value:we.workStart,onChange:k=>q(m=>({...m,workStart:k})),type:"time"}),e.jsx(js,{label:"End",value:we.workEnd,onChange:k=>q(m=>({...m,workEnd:k})),type:"time"})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Allowed days"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:"Mon,Tue,Wed,Thu,Fri,Sat,Sun".split(",").map(k=>{const m=we.days.includes(k);return e.jsx("button",{type:"button",className:dn("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",m?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:m?{background:Xx.green}:void 0,onClick:()=>{q(S=>({...S,days:m?S.days.filter(f=>f!==k):[...S.days,k]}))},children:k},k)})})]})]}),e.jsx(Bn,{title:"Default spend caps",subtitle:"Baseline limits applied to new users.",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx(js,{label:"Default trip cap",value:we.defaultTripCap,onChange:k=>q(m=>({...m,defaultTripCap:k})),placeholder:"UGX 250,000"}),e.jsx(js,{label:"Default daily cap",value:we.defaultDailyCap,onChange:k=>q(m=>({...m,defaultDailyCap:k})),placeholder:"UGX 1,200,000"}),e.jsx(js,{label:"Default monthly cap",value:we.defaultMonthlyCap,onChange:k=>q(m=>({...m,defaultMonthlyCap:k})),placeholder:"UGX 12,000,000"}),e.jsx(js,{label:"Auto-approve under",value:we.autoApproveUnder,onChange:k=>q(m=>({...m,autoApproveUnder:k})),placeholder:"UGX 200,000",hint:"Above this routes to approval chain"})]})})]})]})]},"modules"):null,r==="invoiceGroups"?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs(Bn,{title:"Invoice groups",subtitle:"Enterprise billing distribution: route invoices to different AP emails and codes.",right:e.jsxs(Yt,{variant:"primary",onClick:me,children:[e.jsx(gt,{className:"h-4 w-4"})," Add invoice group"]}),children:[e.jsxs("div",{className:"space-y-2",children:[Ee.map(k=>{var m;return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:k.name}),e.jsx(el,{label:k.frequency,tone:"neutral"}),e.jsx(el,{label:k.apCode,tone:"info"}),e.jsx(el,{label:`Prefix: ${k.prefix}`,tone:"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["AP: ",k.apEmail,"  CC: ",k.ccEmails||"-"]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Entity: ",k.entityScope==="All"?"All entities":((m=j.find(S=>S.id===k.entityScope))==null?void 0:m.name)||"Entity"]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[Object.entries(k.moduleScope).filter(([,S])=>S).slice(0,6).map(([S])=>e.jsx(el,{label:S,tone:"neutral"},S)),Object.entries(k.moduleScope).filter(([,S])=>S).length>6?e.jsx(el,{label:"+more",tone:"neutral"}):null]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Yt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Xe(k),children:[e.jsx(Uo,{className:"h-4 w-4"})," Edit"]}),e.jsxs(Yt,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>E(k.id),children:[e.jsx(as,{className:"h-4 w-4"})," Delete"]})]})]}),k.notes?e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:k.notes}):null]},k.id)}),Ee.length?null:e.jsx(Uv,{title:"No invoice groups",subtitle:"Create at least one invoice group for AP distribution."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Best practice: create invoice groups by department, region, or entity. Use AP codes for ERP mapping."})]})},"invoiceGroups"):null,r==="support"?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsx(Bn,{title:"EVzone support access",subtitle:"Enable or disable support mode for this organization.",children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Support mode"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"When enabled, EVzone support can sign in with a role-gated account."})]}),e.jsx(el,{label:Fe?"Enabled":"Disabled",tone:Fe?"good":"neutral"})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:["Support safety:",e.jsxs("ul",{className:"mt-2 space-y-1",children:[e.jsx("li",{children:"1) View-only by default"}),e.jsx("li",{children:"2) No silent actions"}),e.jsx("li",{children:"3) Step-up authentication for write actions"}),e.jsx("li",{children:"4) Always audited and visible to org admins"})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs(Yt,{variant:"primary",disabled:Fe,onClick:()=>P("enable"),children:[e.jsx(yt,{className:"h-4 w-4"})," Enable support"]}),e.jsxs(Yt,{variant:"danger",disabled:!Fe,onClick:()=>P("disable"),children:[e.jsx(yt,{className:"h-4 w-4"})," Disable support"]})]})]})})},"support"):null,r==="goLive"?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsx(Bn,{title:"Go-live readiness",subtitle:"Premium: setup wizard and readiness checklist.",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Checklist"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Complete all items to enable go-live."})]}),e.jsx(el,{label:`${Math.round(le.pct)}%`,tone:z?"good":"warn"})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx(jn,{ok:le.profileOk,label:"Company profile"}),e.jsx(jn,{ok:le.entityOk,label:"Primary entity"}),e.jsx(jn,{ok:le.billingOk,label:"Billing contacts"}),e.jsx(jn,{ok:le.brandingOk,label:"Branding and payment instructions"}),e.jsx(jn,{ok:le.moduleOk,label:"At least one module enabled"}),e.jsx(jn,{ok:le.policyOk,label:"Policy defaults"}),e.jsx(jn,{ok:le.invoiceOk,label:"Invoice groups"}),e.jsx(jn,{ok:le.supportOk,label:"Support mode set"})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Go-live actions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Publish to enable CorporatePay at checkout."}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Before go-live:",e.jsxs("ul",{className:"mt-2 space-y-1 text-xs text-slate-600",children:[e.jsx("li",{children:"1) Confirm invoice groups and AP emails"}),e.jsx("li",{children:"2) Confirm module enablement and policy defaults"}),e.jsx("li",{children:"3) Confirm support mode preference"})]})]}),e.jsxs("div",{className:"mt-3 flex flex-col gap-2",children:[e.jsxs(Yt,{variant:"outline",onClick:Ae,children:[e.jsx(pt,{className:"h-4 w-4"})," Export JSON"]}),e.jsxs(Yt,{variant:"outline",onClick:Ve,children:[e.jsx(Da,{className:"h-4 w-4"})," Save draft"]}),e.jsxs(Yt,{variant:"primary",disabled:!z,onClick:Ye,children:[e.jsx(ct,{className:"h-4 w-4"})," Go live"]})]}),z?e.jsx("div",{className:"mt-3 rounded-2xl bg-emerald-50 p-3 text-xs text-emerald-900 ring-1 ring-emerald-200",children:"Ready. CorporatePay can be enabled for employees at checkout."}):e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Some items are pending. Use the wizard steps above to complete setup."})]})]})})},"goLive"):null]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Go-live readiness"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Quick view"})]}),e.jsx(el,{label:z?"Ready":"Pending",tone:z?"good":"warn"})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx(jn,{ok:le.profileOk,label:"Profile"}),e.jsx(jn,{ok:le.entityOk,label:"Entities"}),e.jsx(jn,{ok:le.billingOk,label:"Billing"}),e.jsx(jn,{ok:le.brandingOk,label:"Branding"}),e.jsx(jn,{ok:le.invoiceOk,label:"Invoice groups"})]}),e.jsxs(Yt,{variant:"outline",className:"mt-3 w-full",onClick:()=>i("goLive"),children:[e.jsx(ct,{className:"h-4 w-4"})," Open checklist"]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Template library"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: Hospital, Tour, Corporate"})]}),e.jsx(el,{label:"Premium",tone:"info"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:Ke.map(k=>e.jsx("button",{type:"button",className:"w-full rounded-3xl border border-slate-200 bg-white p-4 text-left hover:bg-slate-50",onClick:()=>{ye(k.id),he(!0)},children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:k.name}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:k.desc})]}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]})},k.id))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Applying a template updates industry, module enablement, and policy defaults."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Help"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Setup guidance"})]}),e.jsx(el,{label:"Docs",tone:"neutral"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2",children:[e.jsxs(Yt,{variant:"outline",onClick:()=>n({title:"Help Center",message:"Opening help center (demo).",kind:"info"}),children:[e.jsx(Fu,{className:"h-4 w-4"})," Help Center"]}),e.jsxs(Yt,{variant:"outline",onClick:()=>n({title:"Support",message:"Creating a support ticket (demo).",kind:"info"}),children:[e.jsx(Xs,{className:"h-4 w-4"})," Contact support"]})]})]})]})]})}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"D Organization Profile and Program Setup v2: includes setup wizard, multi-entity branches, billing contacts, branding, module enablement, policy defaults, invoice groups, and EVzone support toggle."})})]})}),e.jsx(lm,{open:Le,title:ge.id?"Edit entity":"New entity",subtitle:"Add a legal entity or branch. One entity must be primary.",onClose:()=>Ne(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Yt,{variant:"outline",onClick:()=>Ne(!1),children:"Cancel"}),e.jsxs(Yt,{variant:"primary",onClick:ue,children:[e.jsx(Da,{className:"h-4 w-4"})," Save"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(js,{label:"Entity name",required:!0,value:ge.name,onChange:k=>$e(m=>({...m,name:k})),placeholder:"Uganda HQ"}),e.jsx(am,{label:"Currency",value:ge.currency,onChange:k=>$e(m=>({...m,currency:k})),options:["UGX","USD","EUR","CNY","KES","TZS"].map(k=>({value:k,label:k}))}),e.jsx(js,{label:"Country",required:!0,value:ge.country,onChange:k=>$e(m=>({...m,country:k})),placeholder:"Uganda"}),e.jsx(js,{label:"City",required:!0,value:ge.city,onChange:k=>$e(m=>({...m,city:k})),placeholder:"Kampala"}),e.jsx(js,{label:"Address line 1",required:!0,value:ge.address1,onChange:k=>$e(m=>({...m,address1:k})),placeholder:"Street, building"}),e.jsx(js,{label:"Address line 2",value:ge.address2,onChange:k=>$e(m=>({...m,address2:k})),placeholder:"Suite, floor"}),e.jsx(js,{label:"Postal / P.O. Box",value:ge.postal,onChange:k=>$e(m=>({...m,postal:k})),placeholder:"P.O. Box"}),e.jsx(js,{label:"Tax ID",value:ge.taxId,onChange:k=>$e(m=>({...m,taxId:k})),placeholder:"TIN..."}),e.jsx(js,{label:"VAT number",value:ge.vatNo,onChange:k=>$e(m=>({...m,vatNo:k})),placeholder:"VAT..."}),e.jsx("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Primary entity"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Primary is used as default for invoices."})]}),e.jsx("button",{type:"button",className:dn("relative h-7 w-12 rounded-full border transition",ge.isPrimary?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>$e(k=>({...k,isPrimary:!k.isPrimary})),"aria-label":"Toggle primary",children:e.jsx("span",{className:dn("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",ge.isPrimary?"left-[22px]":"left-1")})})]})})]})}),e.jsx(lm,{open:ie,title:Se.id?"Edit billing contact":"Add billing contact",subtitle:"Configure invoice recipients and reminder channels.",onClose:()=>Oe(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Yt,{variant:"outline",onClick:()=>Oe(!1),children:"Cancel"}),e.jsxs(Yt,{variant:"primary",onClick:De,children:[e.jsx(Da,{className:"h-4 w-4"})," Save"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(js,{label:"Name",required:!0,value:Se.name,onChange:k=>Te(m=>({...m,name:k})),placeholder:"Finance Desk"}),e.jsx(am,{label:"Role",value:Se.role,onChange:k=>Te(m=>({...m,role:k})),options:["Finance","AP","CFO","Procurement","Ops","Other"].map(k=>({value:k,label:k}))}),e.jsx(js,{label:"Email",required:!0,value:Se.email,onChange:k=>Te(m=>({...m,email:k})),placeholder:"finance@company.com"}),e.jsx(js,{label:"Phone",value:Se.phone,onChange:k=>Te(m=>({...m,phone:k})),placeholder:"+256..."}),e.jsxs("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Delivery channels"}),e.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2 sm:grid-cols-4",children:[{k:"email",label:"Email"},{k:"whatsapp",label:"WhatsApp"},{k:"wechat",label:"WeChat"},{k:"sms",label:"SMS"}].map(k=>e.jsxs("label",{className:"flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-700",children:[e.jsx("input",{type:"checkbox",checked:Se.channels[k.k],onChange:m=>Te(S=>({...S,channels:{...S.channels,[k.k]:m.target.checked}})),className:"h-4 w-4 rounded border-slate-300"}),k.label]},k.k))}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Delivery logs appear in Notifications Center (B)."})]})]})}),e.jsx(lm,{open:Ge,title:ze.id?"Edit invoice group":"New invoice group",subtitle:"Route invoices to AP recipients with codes and module scopes.",onClose:()=>We(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Yt,{variant:"outline",onClick:()=>We(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[ze.id?e.jsxs(Yt,{variant:"danger",onClick:()=>{E(ze.id),We(!1)},children:[e.jsx(as,{className:"h-4 w-4"})," Delete"]}):null,e.jsxs(Yt,{variant:"primary",onClick:V,children:[e.jsx(Da,{className:"h-4 w-4"})," Save"]})]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(js,{label:"Group name",required:!0,value:ze.name,onChange:k=>Ue(m=>({...m,name:k})),placeholder:"Sales travel"}),e.jsx(am,{label:"Entity scope",value:ze.entityScope,onChange:k=>Ue(m=>({...m,entityScope:k})),options:[{value:"All",label:"All entities"},...j.map(k=>({value:k.id,label:k.name}))]}),e.jsx(js,{label:"AP email",required:!0,value:ze.apEmail,onChange:k=>Ue(m=>({...m,apEmail:k})),placeholder:"ap@company.com"}),e.jsx(js,{label:"AP code",required:!0,value:ze.apCode,onChange:k=>Ue(m=>({...m,apCode:k})),placeholder:"ACME-SALES",hint:"ERP mapping"}),e.jsx(js,{label:"Invoice prefix",required:!0,value:ze.prefix,onChange:k=>Ue(m=>({...m,prefix:k})),placeholder:"ACME-SALES"}),e.jsx(js,{label:"CC emails",value:ze.ccEmails,onChange:k=>Ue(m=>({...m,ccEmails:k})),placeholder:"finance@company.com",hint:"Comma separated"}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Frequency"}),e.jsx("select",{value:ze.frequency,onChange:k=>Ue(m=>({...m,frequency:k.target.value})),className:"mt-2 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none",children:["Daily","Weekly","Monthly","Custom"].map(k=>e.jsx("option",{value:k,children:k},k))}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Invoice cycle can be independent of budget periods."})]}),e.jsxs("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Module scope"}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Select which modules are included in this invoice group."}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-3",children:t.map(k=>e.jsxs("button",{type:"button",className:dn("rounded-2xl border px-3 py-3 text-left",ze.moduleScope[k]?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),onClick:()=>Ue(m=>({...m,moduleScope:{...m.moduleScope,[k]:!m.moduleScope[k]}})),children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:k}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:ze.moduleScope[k]?"Included":"Excluded"})]},k))}),e.jsxs("div",{className:dn("mt-4",ze.moduleScope["E-Commerce"]?"":"opacity-60"),children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Marketplace scope"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Applies when E-Commerce is included."}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-3",children:s.map(k=>e.jsxs("button",{type:"button",disabled:!ze.moduleScope["E-Commerce"],className:dn("rounded-2xl border px-3 py-3 text-left",ze.marketplaceScope[k]?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50",!ze.moduleScope["E-Commerce"]&&"cursor-not-allowed"),onClick:()=>{ze.moduleScope["E-Commerce"]&&Ue(m=>({...m,marketplaceScope:{...m.marketplaceScope,[k]:!m.marketplaceScope[k]}}))},children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:k}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:ze.marketplaceScope[k]?"Included":"Excluded"})]},k))}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:'"Other Marketplace" is a future expansion slot.'})]})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(sh,{label:"Notes",value:ze.notes,onChange:k=>Ue(m=>({...m,notes:k})),placeholder:"Explain how this invoice group is used",rows:4})})]})}),e.jsxs(lm,{open:pe!==null,title:pe==="enable"?"Enable EVzone support mode":"Disable EVzone support mode",subtitle:"Provide a reason. This change is audit logged.",onClose:()=>Q(null),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Yt,{variant:"outline",onClick:()=>Q(null),children:"Cancel"}),e.jsxs(Yt,{variant:pe==="disable"?"danger":"primary",onClick:se,children:[e.jsx(yt,{className:"h-4 w-4"})," Confirm"]})]}),children:[e.jsx(sh,{label:"Reason",value:Re,onChange:ce,placeholder:"Example: enable support for troubleshooting invoice delivery",rows:4}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Support sessions are visible to org admins and never silent."})]}),e.jsx(lm,{open:xe,title:"Apply industry template",subtitle:"This updates industry, module toggles, and policy defaults.",onClose:()=>he(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Yt,{variant:"outline",onClick:()=>he(!1),children:"Cancel"}),e.jsxs(Yt,{variant:"primary",onClick:u,children:[e.jsx(La,{className:"h-4 w-4"})," Apply"]})]}),children:(()=>{const k=Ke.find(m=>m.id===de);return k?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:k.name}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:k.desc})]}),e.jsx("div",{className:"rounded-3xl border border-amber-200 bg-amber-50 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-white text-amber-800 ring-1 ring-amber-200",children:e.jsx(en,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"What changes"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:"Industry, module enablement, working hours, regions, and auto-approval threshold."}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"You can edit everything after applying."})]})]})})]}):null})()})]})}const mg={green:"#03CD8C",orange:"#F77F00"};function ba(...t){return t.filter(Boolean).join(" ")}function nV(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function dr(t){return JSON.parse(JSON.stringify(t))}function Xt({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:ba("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Rs({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:mg.green}:t==="accent"?{background:mg.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:ba(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Vv({enabled:t,onChange:s,label:a,disabled:l}){return e.jsxs("button",{type:"button",disabled:l,onClick:()=>!l&&s(!t),className:ba("flex items-center justify-between gap-3 rounded-2xl border px-3 py-2 text-left text-sm font-semibold transition",t?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50",l&&"opacity-60 cursor-not-allowed"),children:[e.jsx("span",{children:a}),e.jsx("span",{className:ba("relative h-6 w-10 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),children:e.jsx("span",{className:ba("absolute top-0.5 h-5 w-5 rounded-full bg-white shadow-sm transition",t?"left-[18px]":"left-1")})})]})}function oc({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:ba(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:ba("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i,children:i},i))})]})}function nh({label:t,value:s,onChange:a,placeholder:l,hint:n,disabled:r}){return e.jsxs("div",{className:ba(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{value:s,onChange:i=>a(i.target.value),placeholder:l,disabled:r,className:ba("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function _E({actions:t}){const[s,a]=qt.useState(!1),l=qt.useRef(null);return qt.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:ba("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function k4({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="920px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[8vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(_E,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function rV({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,actions:i}){return d.useEffect(()=>{const o=c=>c.key==="Escape"&&n();return t&&window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,x:16},animate:{opacity:1,x:0},exit:{opacity:0,x:16},transition:{duration:.18},className:ba("fixed z-50 overflow-hidden border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]","left-2 right-2 bottom-2 top-[14vh] rounded-[28px]","lg:left-auto lg:right-4 lg:top-4 lg:bottom-4 lg:w-[560px]"),role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-base font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i&&e.jsx(_E,{actions:i}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"h-full min-h-0 overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function iV({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:ba("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function sd(t){return t==="High"?"bad":t==="Medium"?"warn":"good"}function BE(t){return t==="High"?90:t==="Medium"?55:20}function oV(t){const a=t.reduce((n,r)=>n+BE(r),0)/Math.max(1,t.length),l=a>=70?"High":a>=40?"Medium":"Low";return{avg:a,label:l}}function dV(t,s){const a=[...t].sort().join("|"),l=[...s].sort().join("|");return a===l}function C4(){const t=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],s=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],a={"E-Commerce":"Medium","EVs & Charging":"Medium","Rides & Logistics":"Medium","School & E-Learning":"Medium","Medical & Health Care":"High","Travel & Tourism":"Medium","Green Investments":"High",FaithHub:"Medium","Virtual Workspace":"Low","Finance & Payments":"High","Other Service Module":"Medium"},l={};t.forEach(r=>{l[r]={enabled:r!=="Other Service Module"&&r!=="Green Investments",risk:a[r],policy:r==="Finance & Payments"||r==="Medical & Health Care"?"Strict compliance":"Balanced",approval:r==="Finance & Payments"?"Finance approval":r==="Medical & Health Care"?"Manager approval":"Auto under threshold"}});const n={};return s.forEach(r=>{n[r]={enabled:r==="MyLiveDealz"||r==="EVmart"||r==="ServiceMart"||r==="GadgetMart"||r==="ExpressMart"||r==="Other Marketplace",inheritFromModule:!0,policy:"Org default",approval:"Org default"}}),{modules:l,marketplaces:n,labels:{otherModuleLabel:"Other Service Module",otherMarketplaceLabel:"Other Marketplace"},rollout:{stage:"Pilot",pilotGroups:["Operations","Finance"],plannedGoAllDate:"2026-01-14",notes:"Pilot with Operations and Finance, then expand to all groups."}}}function cV(){const t=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],s=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],a=[{id:"Operations",users:34},{id:"Sales",users:22},{id:"Finance",users:10},{id:"Admin",users:8},{id:"Procurement",users:6}],l=[{id:"U-1001",name:"Mary N.",group:"Operations",title:"Operations Manager"},{id:"U-1002",name:"Finance Desk",group:"Finance",title:"Accountant"},{id:"U-1003",name:"John S.",group:"Sales",title:"Sales Executive"},{id:"U-1004",name:"Admin Team",group:"Admin",title:"Org Admin"},{id:"U-1005",name:"Procurement Desk",group:"Procurement",title:"Approver"},{id:"U-1006",name:"Irene K.",group:"Operations",title:"Travel Coordinator"},{id:"U-1007",name:"Samuel A.",group:"Sales",title:"Manager"},{id:"U-1008",name:"Daisy O.",group:"Finance",title:"Finance Officer"}],n=["Org default","Conservative","Balanced","Flexible","Strict compliance"],r=["Org default","Auto under threshold","Manager approval","Finance approval","CFO approval","Multi-level escalation"],[i,o]=d.useState([]),c=le=>{const z=nV("toast");o(Ae=>[{id:z,...le},...Ae].slice(0,4)),window.setTimeout(()=>o(Ae=>Ae.filter(Ve=>Ve.id!==z)),3200)},[x,j]=d.useState("enablement"),[g,y]=d.useState(()=>C4()),[$,T]=d.useState(()=>dr(C4())),[C,W]=d.useState({kind:"module",key:"E-Commerce"}),[L,R]=d.useState(!1),[F,te]=d.useState(""),[oe,G]=d.useState(!1),[H,Y]=d.useState(!1);d.useMemo(()=>a.reduce((le,z)=>le+z.users,0),[a]);const we=d.useMemo(()=>(C==null?void 0:C.kind)==="module"?C.key:null,[C]),q=d.useMemo(()=>(C==null?void 0:C.kind)==="marketplace"?C.key:null,[C]),je=le=>le==="Other Marketplace"?g.labels.otherMarketplaceLabel||"Other Marketplace":le,_e=le=>le==="Other Service Module"?g.labels.otherModuleLabel||"Other Service Module":le,Ee=g.modules["E-Commerce"].enabled,be=d.useMemo(()=>{const le=[];return t.forEach(z=>{g.modules[z].enabled&&le.push(g.modules[z].risk)}),le},[g,t]),Fe=d.useMemo(()=>oV(be),[be]),Pe=g.rollout,pe=le=>Pe.stage==="All"?!0:Pe.pilotGroups.includes(le.group),Q=(le,z,Ae)=>le.modules[Ae].enabled?le.rollout.stage==="All"?!0:le.rollout.pilotGroups.includes(z.group):!1,Re=(le,z,Ae)=>!le.modules["E-Commerce"].enabled||!le.marketplaces[Ae].enabled?!1:le.rollout.stage==="All"?!0:le.rollout.pilotGroups.includes(z.group),ce=d.useMemo(()=>{let le=0;return t.forEach(z=>{const Ae=g.modules[z],Ve=$.modules[z];Ae.enabled!==Ve.enabled&&(le+=1),Ae.risk!==Ve.risk&&(le+=1),Ae.policy!==Ve.policy&&(le+=1),Ae.approval!==Ve.approval&&(le+=1)}),s.forEach(z=>{const Ae=g.marketplaces[z],Ve=$.marketplaces[z];Ae.enabled!==Ve.enabled&&(le+=1),Ae.inheritFromModule!==Ve.inheritFromModule&&(le+=1),Ae.policy!==Ve.policy&&(le+=1),Ae.approval!==Ve.approval&&(le+=1)}),g.labels.otherModuleLabel!==$.labels.otherModuleLabel&&(le+=1),g.labels.otherMarketplaceLabel!==$.labels.otherMarketplaceLabel&&(le+=1),g.rollout.stage!==$.rollout.stage&&(le+=1),dV(g.rollout.pilotGroups,$.rollout.pilotGroups)||(le+=1),g.rollout.plannedGoAllDate!==$.rollout.plannedGoAllDate&&(le+=1),le},[g,$,t,s]),xe=d.useMemo(()=>{const le=[];l.forEach(Ve=>{const Ye=[],Be=[];t.forEach(w=>{const B=Q($,Ve,w),ue=Q(g,Ve,w);!B&&ue&&Ye.push(`Module: ${_e(w)}`),B&&!ue&&Be.push(`Module: ${_e(w)}`)}),s.forEach(w=>{const B=Re($,Ve,w),ue=Re(g,Ve,w);!B&&ue&&Ye.push(`Marketplace: ${je(w)}`),B&&!ue&&Be.push(`Marketplace: ${je(w)}`)}),(Ye.length||Be.length)&&le.push({user:Ve,gained:Ye,lost:Be})});const z=le.reduce((Ve,Ye)=>Ve+Ye.gained.length,0),Ae=le.reduce((Ve,Ye)=>Ve+Ye.lost.length,0);return{changedUsers:le,gains:z,losses:Ae,changedCount:le.length}},[g,$,l,t,s]),he=d.useMemo(()=>{const le=l.filter(Ae=>pe(Ae)),z=l.filter(Ae=>!pe(Ae));return{pilotUsers:le,nonPilot:z}},[l,pe]),de=()=>{y(dr($)),c({title:"Reverted",message:"Draft reverted to last published settings.",kind:"info"})},ye=()=>{c({title:"Saved",message:"Draft saved (demo).",kind:"success"})},Ke=()=>{te(""),G(!1),R(!0)},Le=()=>{if(F.trim().length<8||!oe){c({title:"Publish blocked",message:"Add a clear reason and confirm acknowledgement.",kind:"warn"});return}T(dr(g)),R(!1),c({title:"Published",message:"Enablement settings published.",kind:"success"})},Ne=async()=>{const le={draft:g,exportedAt:new Date().toISOString()},z=JSON.stringify(le,null,2);try{await navigator.clipboard.writeText(z),c({title:"Copied",message:"Config JSON copied to clipboard.",kind:"success"})}catch{c({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},ge=()=>{if(!we){c({title:"Select module",message:"Select a module first.",kind:"warn"});return}y(le=>{const z=dr(le),Ae=z.modules[we];return t.forEach(Ve=>{z.modules[Ve].policy=Ae.policy,z.modules[Ve].approval=Ae.approval}),z}),c({title:"Applied",message:"Module defaults applied to all modules.",kind:"success"})},$e=()=>{y(le=>{const z=dr(le);return s.forEach(Ae=>{z.marketplaces[Ae].inheritFromModule=!0,z.marketplaces[Ae].policy="Org default",z.marketplaces[Ae].approval="Org default"}),z}),c({title:"Applied",message:"Marketplaces set to inherit from E-Commerce defaults.",kind:"success"})},ie=!!C,Oe=we?`Module: ${_e(we)}`:q?`Marketplace: ${je(q)}`:"",Se=we?`Risk: ${g.modules[we].risk}  Enabled: ${g.modules[we].enabled?"Yes":"No"}`:q?`Enabled: ${g.marketplaces[q].enabled?"Yes":"No"}  Inherit: ${g.marketplaces[q].inheritFromModule?"Yes":"No"}`:"",Te={"E-Commerce":["High vendor variability","Category restrictions may apply","Marketplace-specific rules"],"EVs & Charging":["Energy transactions","Station policies and credits","Operational fraud risk"],"Rides & Logistics":["High volume","Policy breaches (time/geo)","Safety and chargeback"],"School & E-Learning":["Payments and subscriptions","Youth safety policies","Refund rules"],"Medical & Health Care":["Sensitive categories","Compliance requirements","Higher audit expectations"],"Travel & Tourism":["High variability","Airport rules","Large bookings"],"Green Investments":["Regulatory sensitivity","Large amounts","Enhanced approvals"],FaithHub:["Content sensitivity","Donations/refunds","Policy controls"],"Virtual Workspace":["Low monetary risk","Mostly operational","Permissions sensitive"],"Finance & Payments":["Direct money movement","Fraud risk","Always audited"],"Other Service Module":["Unknown risk","Default to Medium","Review before enabling"]},Ge=t.filter(le=>g.modules[le].enabled).length,We=s.filter(le=>g.marketplaces[le].enabled).length;return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(iV,{toasts:i,onDismiss:le=>o(z=>z.filter(Ae=>Ae.id!==le))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:mg.green},children:e.jsx(La,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Modules and Marketplaces Enablement"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Enable services and marketplaces. Map default policies and approval flows. Use pilot rollout before enabling for everyone."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(Xt,{label:`Modules enabled: ${Ge}/${t.length}`,tone:"neutral"}),e.jsx(Xt,{label:`Marketplaces enabled: ${We}/${s.length}`,tone:Ee?"neutral":"warn"}),e.jsx(Xt,{label:`Rollout: ${g.rollout.stage}`,tone:g.rollout.stage==="Pilot"?"warn":"good"}),e.jsx(Xt,{label:`Org risk: ${Fe.label}`,tone:sd(Fe.label)}),ce?e.jsx(Xt,{label:`Draft changes: ${ce}`,tone:"info"}):e.jsx(Xt,{label:"No draft changes",tone:"good"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Rs,{variant:"outline",onClick:()=>Y(!0),children:[e.jsx(pt,{className:"h-4 w-4"})," Export"]}),e.jsxs(Rs,{variant:"outline",onClick:de,disabled:!ce,children:[e.jsx(Qe,{className:"h-4 w-4"})," Revert"]}),e.jsxs(Rs,{variant:"outline",onClick:ye,children:[e.jsx(Da,{className:"h-4 w-4"})," Save draft"]}),e.jsxs(Rs,{variant:"primary",onClick:Ke,disabled:!ce,children:[e.jsx(ct,{className:"h-4 w-4"})," Publish"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"enablement",label:"Enablement"},{id:"defaults",label:"Default policies and approvals"},{id:"rollout",label:"Controlled rollout"},{id:"impact",label:"Change impact"}].map(le=>e.jsx("button",{className:ba("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",x===le.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:x===le.id?{background:mg.green}:void 0,onClick:()=>j(le.id),children:le.label},le.id))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[x==="enablement"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Service modules"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Enable or disable modules. Click to edit defaults."})]}),e.jsx(Xt,{label:"Core",tone:"neutral"})]}),e.jsx("div",{className:"mt-4 space-y-2",children:t.map(le=>{const z=g.modules[le],Ae=we===le,Ve=_e(le);return e.jsx("button",{type:"button",onClick:()=>W({kind:"module",key:le}),className:ba("w-full rounded-3xl border p-4 text-left transition",Ae?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:Ve}),e.jsx(Xt,{label:z.enabled?"Enabled":"Off",tone:z.enabled?"good":"neutral"}),e.jsx(Xt,{label:`Risk: ${z.risk}`,tone:sd(z.risk)})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Policy: ",z.policy,"  Approval: ",z.approval]})]}),e.jsx(et,{className:"mt-0.5 h-4 w-4 text-slate-500"})]})},le)})}),e.jsx("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: risk profile scoring is shown per module and aggregated for the org."}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Other labels"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Optional: rename the Other slots."}),e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsx(nh,{label:"Other Service Module label",value:g.labels.otherModuleLabel,onChange:le=>y(z=>({...z,labels:{...z.labels,otherModuleLabel:le}})),placeholder:"Other Service Module"}),e.jsx(nh,{label:"Other Marketplace label",value:g.labels.otherMarketplaceLabel,onChange:le=>y(z=>({...z,labels:{...z.labels,otherMarketplaceLabel:le}})),placeholder:"Other Marketplace"})]})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Marketplaces (within E-Commerce)"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Enable or disable marketplaces. Applies when E-Commerce is enabled."})]}),e.jsx(Xt,{label:Ee?"E-Commerce enabled":"E-Commerce off",tone:Ee?"good":"warn"})]}),e.jsx("div",{className:ba("mt-4 grid grid-cols-1 gap-2 md:grid-cols-2",!Ee&&"opacity-70"),children:s.map(le=>{const z=g.marketplaces[le],Ae=q===le,Ve=je(le);return e.jsx("button",{type:"button",disabled:!Ee,onClick:()=>W({kind:"marketplace",key:le}),className:ba("rounded-3xl border p-4 text-left transition",Ae?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50",!Ee&&"cursor-not-allowed"),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:Ve}),e.jsx(Xt,{label:z.enabled?"Enabled":"Off",tone:z.enabled?"good":"neutral"}),e.jsx(Xt,{label:z.inheritFromModule?"Inherit":"Override",tone:z.inheritFromModule?"neutral":"info"})]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:z.inheritFromModule?"Uses E-Commerce defaults":`Policy: ${z.policy}  Approval: ${z.approval}`})]}),e.jsx(et,{className:"mt-0.5 h-4 w-4 text-slate-500"})]})},le)})}),Ee?null:e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Enable E-Commerce to use marketplace toggles."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Rs,{variant:"outline",onClick:$e,disabled:!Ee,children:[e.jsx(ht,{className:"h-4 w-4"})," Set all to inherit"]}),e.jsxs(Rs,{variant:"outline",onClick:()=>{y(le=>{const z=dr(le);return s.forEach(Ae=>z.marketplaces[Ae].enabled=!0),z}),c({title:"Enabled",message:"All marketplaces enabled (demo).",kind:"success"})},disabled:!Ee,children:[e.jsx(gt,{className:"h-4 w-4"})," Enable all"]}),e.jsxs(Rs,{variant:"outline",onClick:()=>{y(le=>{const z=dr(le);return s.forEach(Ae=>z.marketplaces[Ae].enabled=!1),z.marketplaces["Other Marketplace"].enabled=!0,z}),c({title:"Disabled",message:"All marketplaces disabled (except Other).",kind:"info"})},disabled:!Ee,children:[e.jsx(Qe,{className:"h-4 w-4"})," Disable all"]})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Module risk profile scoring"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"High sensitivity modules should have stricter policies and approvals."})]}),e.jsx(Xt,{label:`Org risk: ${Fe.label}`,tone:sd(Fe.label)})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx(ze,{title:"Enabled modules",value:`${Ge}`,icon:e.jsx(La,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(ze,{title:"Avg risk score",value:`${Math.round(Fe.avg)}/100`,icon:e.jsx(Et,{className:"h-5 w-5"}),tone:sd(Fe.label)}),e.jsx(ze,{title:"Stage",value:g.rollout.stage,icon:e.jsx(Os,{className:"h-5 w-5"}),tone:g.rollout.stage==="Pilot"?"warn":"good"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: risk score influences recommended approval flows and alert routing."})]})]})]}):null,x==="defaults"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Bulk tools"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Apply defaults quickly."})]}),e.jsx(Xt,{label:"Premium",tone:"info"})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs(Rs,{variant:"outline",className:"w-full",onClick:ge,children:[e.jsx(ht,{className:"h-4 w-4"})," Apply selected module defaults to all"]}),e.jsxs(Rs,{variant:"outline",className:"w-full",onClick:$e,disabled:!Ee,children:[e.jsx(ht,{className:"h-4 w-4"})," Set all marketplaces to inherit"]}),e.jsxs(Rs,{variant:"outline",className:"w-full",onClick:()=>{y(le=>{const z=dr(le);return t.forEach(Ae=>{z.modules[Ae].policy="Balanced",z.modules[Ae].approval="Auto under threshold"}),z.modules["Finance & Payments"].policy="Strict compliance",z.modules["Finance & Payments"].approval="Finance approval",z}),c({title:"Template",message:"Balanced defaults applied (demo).",kind:"success"})},children:[e.jsx(La,{className:"h-4 w-4"})," Apply Balanced template"]})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Defaults are used when users do not have group or user overrides."})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Per-module defaults"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Default policy template and approval flow mapping."})]}),e.jsx(Xt,{label:"Core",tone:"neutral"})]}),e.jsx("div",{className:"mt-4 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Module"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Enabled"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Risk"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Default policy"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Default approval"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Edit"})]})}),e.jsx("tbody",{children:t.map(le=>{const z=g.modules[le];return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:_e(le)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Xt,{label:z.enabled?"Yes":"No",tone:z.enabled?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Xt,{label:z.risk,tone:sd(z.risk)})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:z.policy}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:z.approval}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Rs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>W({kind:"module",key:le}),children:"Edit"})})]},le)})})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Best practice: Finance & Payments and Medical & Health Care should use strict compliance defaults."})]}),e.jsxs("div",{className:ba("rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",!Ee&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Per-marketplace overrides"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"If not inheriting, set marketplace-specific policy and approvals."})]}),e.jsx(Xt,{label:Ee?"E-Commerce on":"E-Commerce off",tone:Ee?"good":"warn"})]}),e.jsx("div",{className:"mt-4 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Marketplace"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Enabled"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Inherit"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Policy"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Approval"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Edit"})]})}),e.jsx("tbody",{children:s.map(le=>{const z=g.marketplaces[le];return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:je(le)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Xt,{label:z.enabled?"Yes":"No",tone:z.enabled?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Xt,{label:z.inheritFromModule?"Yes":"No",tone:z.inheritFromModule?"neutral":"info"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:z.inheritFromModule?"(inherits)":z.policy}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:z.inheritFromModule?"(inherits)":z.approval}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Rs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>W({kind:"marketplace",key:le}),disabled:!Ee,children:"Edit"})})]},le)})})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: set MyLiveDealz to stricter approvals if you allow high-value deals."})]})]})]}):null,x==="rollout"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Controlled rollout"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Pilot group first, then expand to all."})]}),e.jsx(Xt,{label:"Premium",tone:"info"})]}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsx(oc,{label:"Stage",value:g.rollout.stage,onChange:le=>y(z=>({...z,rollout:{...z.rollout,stage:le}})),options:["Pilot","All"],hint:"Pilot limits access"}),e.jsx(nh,{label:"Planned go-all date",value:g.rollout.plannedGoAllDate,onChange:le=>y(z=>({...z,rollout:{...z.rollout,plannedGoAllDate:le}})),placeholder:"YYYY-MM-DD",hint:"Roadmap"}),e.jsx(nh,{label:"Notes",value:g.rollout.notes,onChange:le=>y(z=>({...z,rollout:{...z.rollout,notes:le}})),placeholder:"Explain rollout plan"}),e.jsxs("div",{className:ba("rounded-3xl border border-slate-200 bg-white p-4",g.rollout.stage==="All"&&"opacity-70"),children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Pilot groups"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Select groups to receive access during pilot stage."}),e.jsx("div",{className:"mt-3 space-y-2",children:a.map(le=>{const z=g.rollout.pilotGroups.includes(le.id);return e.jsxs("button",{type:"button",disabled:g.rollout.stage==="All",onClick:()=>{g.rollout.stage!=="All"&&y(Ae=>{const Ve=dr(Ae),Ye=new Set(Ve.rollout.pilotGroups);return Ye.has(le.id)?Ye.delete(le.id):Ye.add(le.id),Ve.rollout.pilotGroups=Array.from(Ye),Ve})},className:ba("flex w-full items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm font-semibold",z?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50",g.rollout.stage==="All"&&"cursor-not-allowed"),children:[e.jsx("span",{children:le.id}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xt,{label:`${le.users} users`,tone:"neutral"}),e.jsx(Xt,{label:z?"Pilot":"Off",tone:z?"good":"neutral"})]})]},le.id)})})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Rs,{variant:"primary",onClick:()=>{y(le=>({...le,rollout:{...le.rollout,stage:"All"}})),c({title:"Expanded",message:"Rollout expanded to all groups (draft).",kind:"success"})},children:[e.jsx(Os,{className:"h-4 w-4"})," Expand to all"]}),e.jsxs(Rs,{variant:"outline",onClick:()=>{y(le=>({...le,rollout:{...le.rollout,stage:"Pilot"}})),c({title:"Pilot",message:"Returned to pilot stage (draft).",kind:"info"})},children:[e.jsx(et,{className:"h-4 w-4"})," Pilot stage"]})]}),e.jsx("div",{className:"mt-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: pilot rollout is recommended for high-risk modules like Finance & Payments."})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Pilot preview"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Who has access now under draft rollout settings."})]}),e.jsx(Xt,{label:`Pilot users: ${he.pilotUsers.length}`,tone:g.rollout.stage==="Pilot"?"warn":"neutral"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Allowed groups"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:(g.rollout.stage==="All"?a.map(le=>le.id):g.rollout.pilotGroups).map(le=>e.jsx(Xt,{label:le,tone:"neutral"},le))})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Pilot coverage"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:g.rollout.stage==="All"?"100%":`${Math.round(he.pilotUsers.length/Math.max(1,l.length)*100)}%`}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Sample users list, full list in production"})]})]}),e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"User"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Rollout access"})]})}),e.jsx("tbody",{children:l.map(le=>{const z=pe(le);return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:le.name}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:le.group}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Xt,{label:g.rollout.stage==="All"?"Allowed":z?"Pilot":"Not yet",tone:g.rollout.stage==="All"?"good":z?"warn":"neutral"})})]},le.id)})})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Controlled rollout does not remove individual permissions. It limits availability until pilot is complete."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Recommended rollout strategy"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Based on enabled modules risk."})]}),e.jsx(Xt,{label:`Org risk: ${Fe.label}`,tone:sd(Fe.label)})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Suggested:",e.jsxs("ul",{className:"mt-2 space-y-1 text-xs text-slate-600",children:[e.jsx("li",{children:"1) Pilot Finance & Payments with Finance group only"}),e.jsx("li",{children:"2) Pilot MyLiveDealz purchases with Procurement approvals"}),e.jsx("li",{children:"3) Expand to all when approval SLAs stabilize"})]})]})]})]})]}):null,x==="impact"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Change impact preview"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Compares draft against last published configuration."})]}),e.jsx(Xt,{label:ce?"Draft has changes":"No changes",tone:ce?"warn":"good"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3",children:[e.jsx(Ue,{title:"Users affected",value:`${xe.changedCount}`,tone:xe.changedCount?"warn":"good",icon:e.jsx(Os,{className:"h-5 w-5"})}),e.jsx(Ue,{title:"Access gains",value:`${xe.gains}`,tone:xe.gains?"good":"neutral",icon:e.jsx(ht,{className:"h-5 w-5"})}),e.jsx(Ue,{title:"Access losses",value:`${xe.losses}`,tone:xe.losses?"warn":"neutral",icon:e.jsx(ia,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: publish changes after reviewing impact. Use pilot rollout to reduce disruption."}),e.jsxs(Rs,{variant:"primary",className:"mt-4 w-full",disabled:!ce,onClick:Ke,children:[e.jsx(ct,{className:"h-4 w-4"})," Publish changes"]}),e.jsxs(Rs,{variant:"outline",className:"mt-2 w-full",disabled:!ce,onClick:de,children:[e.jsx(Qe,{className:"h-4 w-4"})," Revert"]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Users impacted"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Sample list (demo). In production, this lists all users."})]}),e.jsx(Xt,{label:`${xe.changedUsers.length}`,tone:xe.changedUsers.length?"warn":"good"})]}),xe.changedUsers.length?e.jsx("div",{className:"mt-4 space-y-3",children:xe.changedUsers.map(le=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:le.user.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[le.user.title,"  Group: ",le.user.group,"  ",le.user.id]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[le.gained.length?e.jsx(Xt,{label:`Gains: ${le.gained.length}`,tone:"good"}):null,le.lost.length?e.jsx(Xt,{label:`Losses: ${le.lost.length}`,tone:"warn"}):null]})]}),le.gained.length?e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Gained access"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[le.gained.slice(0,8).map(z=>e.jsx(Xt,{label:z,tone:"good"},z)),le.gained.length>8?e.jsx(Xt,{label:`+${le.gained.length-8}`,tone:"good"}):null]})]}):null,le.lost.length?e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Lost access"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[le.lost.slice(0,8).map(z=>e.jsx(Xt,{label:z,tone:"warn"},z)),le.lost.length>8?e.jsx(Xt,{label:`+${le.lost.length-8}`,tone:"warn"}):null]})]}):null,e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: impact preview can include historical spend risk scoring for each user."})]},le.user.id))}):e.jsxs("div",{className:"mt-4 rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(tt,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No impact"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Draft matches last published configuration."})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"What changes in the apps"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Employees use normal EVzone apps. CorporatePay appears at checkout based on enablement."})]}),e.jsx(Xt,{label:"Explanation",tone:"info"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:e.jsxs("ul",{className:"space-y-1 text-xs text-slate-600",children:[e.jsx("li",{children:"1) If a module is disabled, CorporatePay is not available for that module at checkout."}),e.jsx("li",{children:"2) For E-Commerce, marketplaces must be enabled for CorporatePay to appear on those purchases."}),e.jsx("li",{children:"3) Controlled rollout limits access to pilot groups until expanded."})]})})]})]})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"E Modules & Marketplaces Enablement v2: module toggles, marketplace toggles, per-module and per-marketplace defaults, risk scoring, controlled rollout, and impact preview."})})]})}),e.jsxs(rV,{open:ie,title:Oe,subtitle:Se,onClose:()=>W(null),footer:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Edit is draft-only until published."}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Rs,{variant:"outline",onClick:()=>W(null),children:"Close"}),e.jsxs(Rs,{variant:"primary",onClick:ye,children:[e.jsx(Da,{className:"h-4 w-4"})," Save"]})]})]}),children:[we?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Enablement"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Toggle availability for this module at checkout."})]}),e.jsx(Xt,{label:g.modules[we].enabled?"Enabled":"Off",tone:g.modules[we].enabled?"good":"neutral"})]}),e.jsx("div",{className:"mt-3",children:e.jsx(Vv,{enabled:g.modules[we].enabled,onChange:le=>y(z=>({...z,modules:{...z.modules,[we]:{...z.modules[we],enabled:le}}})),label:g.modules[we].enabled?"Disable module":"Enable module"})}),we==="E-Commerce"&&!g.modules[we].enabled?e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Disabling E-Commerce disables all marketplace purchases via CorporatePay."}):null]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Risk profile"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: scoring guides defaults and rollout strategy."})]}),e.jsx(Xt,{label:`Score ${BE(g.modules[we].risk)}/100`,tone:sd(g.modules[we].risk)})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx(oc,{label:"Risk rating",value:g.modules[we].risk,onChange:le=>y(z=>({...z,modules:{...z.modules,[we]:{...z.modules[we],risk:le}}})),options:["Low","Medium","High"],hint:"Override if needed"}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Signals:",e.jsx("ul",{className:"mt-2 space-y-1 text-xs text-slate-600",children:Te[we].map(le=>e.jsxs("li",{children:[" ",le]},le))})]})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Default mappings"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Applied unless overridden by group/user policies."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4",children:[e.jsx(oc,{label:"Default policy template",value:g.modules[we].policy,onChange:le=>y(z=>({...z,modules:{...z.modules,[we]:{...z.modules[we],policy:le}}})),options:n}),e.jsx(oc,{label:"Default approval flow",value:g.modules[we].approval,onChange:le=>y(z=>({...z,modules:{...z.modules,[we]:{...z.modules[we],approval:le}}})),options:r})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Recommendation: high risk modules should use Finance approval or Multi-level escalation."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Quick apply"}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Rs,{variant:"outline",onClick:ge,children:[e.jsx(ht,{className:"h-4 w-4"})," Apply to all modules"]}),e.jsxs(Rs,{variant:"outline",onClick:()=>{y(le=>{const z=dr(le);return z.modules[we].policy="Strict compliance",z.modules[we].approval="Multi-level escalation",z}),c({title:"Applied",message:"Strict defaults set for this module.",kind:"success"})},children:[e.jsx(yt,{className:"h-4 w-4"})," Strict preset"]})]})]})]}):null,q?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Enablement"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Availability for this marketplace at checkout."})]}),e.jsx(Xt,{label:g.marketplaces[q].enabled?"Enabled":"Off",tone:g.marketplaces[q].enabled?"good":"neutral"})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx(Vv,{enabled:g.marketplaces[q].enabled,onChange:le=>y(z=>({...z,marketplaces:{...z.marketplaces,[q]:{...z.marketplaces[q],enabled:le}}})),label:g.marketplaces[q].enabled?"Disable marketplace":"Enable marketplace",disabled:!g.modules["E-Commerce"].enabled}),e.jsx(Vv,{enabled:g.marketplaces[q].inheritFromModule,onChange:le=>y(z=>({...z,marketplaces:{...z.marketplaces,[q]:{...z.marketplaces[q],inheritFromModule:le}}})),label:g.marketplaces[q].inheritFromModule?"Inheriting from E-Commerce":"Override defaults",disabled:!g.modules["E-Commerce"].enabled})]}),g.modules["E-Commerce"].enabled?null:e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Enable E-Commerce module first."})]}),e.jsx("div",{className:ba(g.marketplaces[q].inheritFromModule?"opacity-70":""),children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Marketplace defaults"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Only applies when overrides are enabled."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4",children:[e.jsx(oc,{label:"Policy template",value:g.marketplaces[q].policy,onChange:le=>y(z=>({...z,marketplaces:{...z.marketplaces,[q]:{...z.marketplaces[q],policy:le}}})),options:n,disabled:g.marketplaces[q].inheritFromModule}),e.jsx(oc,{label:"Approval flow",value:g.marketplaces[q].approval,onChange:le=>y(z=>({...z,marketplaces:{...z.marketplaces,[q]:{...z.marketplaces[q],approval:le}}})),options:r,disabled:g.marketplaces[q].inheritFromModule})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: use stricter approvals for marketplaces that allow high-value assets or services."})]})}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Shortcuts"}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Rs,{variant:"outline",onClick:$e,children:[e.jsx(ht,{className:"h-4 w-4"})," Set all to inherit"]}),e.jsxs(Rs,{variant:"outline",onClick:()=>{y(le=>{const z=dr(le);return z.marketplaces[q].inheritFromModule=!1,z.marketplaces[q].policy="Strict compliance",z.marketplaces[q].approval="Multi-level escalation",z}),c({title:"Applied",message:"Strict marketplace overrides set.",kind:"success"})},disabled:!g.modules["E-Commerce"].enabled,children:[e.jsx(yt,{className:"h-4 w-4"})," Strict override"]})]})]})]}):null]}),e.jsxs(k4,{open:L,title:"Publish enablement changes",subtitle:"Provide a reason. This will be audit logged in production.",onClose:()=>R(!1),actions:[{label:"Publish",onClick:Le,disabled:F.trim().length<8||!oe}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Rs,{variant:"outline",onClick:()=>R(!1),children:"Cancel"}),e.jsxs(Rs,{variant:"primary",onClick:Le,disabled:F.trim().length<8||!oe,children:[e.jsx(ct,{className:"h-4 w-4"})," Publish"]})]}),children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Draft changes: ",e.jsx("span",{className:"font-semibold text-slate-900",children:ce}),"  Users impacted: ",e.jsx("span",{className:"font-semibold text-slate-900",children:xe.changedCount})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Reason"}),e.jsx("textarea",{value:F,onChange:le=>te(le.target.value),placeholder:"Example: enable MyLiveDealz for pilot groups; keep Finance & Payments strict; approvals routed to Finance Desk",rows:4,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"}),e.jsxs("label",{className:"mt-3 flex items-start gap-3 rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("input",{type:"checkbox",checked:oe,onChange:le=>G(le.target.checked),className:"mt-1 h-4 w-4 rounded border-slate-300"}),e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"I confirm this change is authorized and should be logged."})]}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Minimum reason length: 8 characters."})]})]}),e.jsxs(k4,{open:H,title:"Export configuration",subtitle:"Copy JSON to clipboard (demo).",onClose:()=>Y(!1),actions:[{label:"Copy JSON",onClick:Ne}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Rs,{variant:"outline",onClick:()=>Y(!1),children:"Close"}),e.jsxs(Rs,{variant:"primary",onClick:Ne,children:[e.jsx(ss,{className:"h-4 w-4"})," Copy JSON"]})]}),children:[e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-700",children:"This export includes modules, marketplaces, labels, and rollout settings."}),e.jsx("pre",{className:"mt-3 max-h-[360px] overflow-auto rounded-2xl border border-slate-200 bg-white p-3 text-xs text-slate-800",children:JSON.stringify(g,null,2)})]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"E Modules & Marketplaces Enablement v2: enablement, default mappings, risk scoring, controlled rollout, and change impact preview."})})]});function ze({title:le,value:z,icon:Ae,tone:Ve}){const Ye=Ve==="bad"?"bg-rose-50 text-rose-700":Ve==="warn"?"bg-amber-50 text-amber-800":Ve==="good"?"bg-emerald-50 text-emerald-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:le}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:z})]}),e.jsx("div",{className:ba("grid h-10 w-10 place-items-center rounded-2xl",Ye),children:Ae})]})})}function Ue({title:le,value:z,icon:Ae,tone:Ve}){const Ye=Ve==="bad"?"bg-rose-50 text-rose-700":Ve==="warn"?"bg-amber-50 text-amber-800":Ve==="good"?"bg-emerald-50 text-emerald-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:le}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:z})]}),e.jsx("div",{className:ba("grid h-10 w-10 place-items-center rounded-2xl",Ye),children:Ae})]})})}}const Sd={green:"#03CD8C",orange:"#F77F00"};function Zl(...t){return t.filter(Boolean).join(" ")}function GE({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null);return d.useEffect(()=>{function n(r){l.current&&!l.current.contains(r.target)&&a(!1)}return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"flex h-8 w-8 items-center justify-center rounded-full text-slate-500 hover:bg-slate-100",children:e.jsx(xs,{className:"h-4 w-4"})}),s&&e.jsx("div",{className:"absolute right-0 top-full z-50 mt-1 w-48 origin-top-right overflow-hidden rounded-2xl border border-slate-100 bg-white p-1 shadow-lg ring-1 ring-slate-200",children:t.map((n,r)=>e.jsx("button",{onClick:()=>{n.onClick(),a(!1)},className:Zl("flex w-full items-center px-3 py-2 text-sm font-medium transition-colors hover:bg-slate-50",n.variant==="danger"?"text-rose-600":"text-slate-700"),children:n.label},r))})]})}function uV(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function mV(t,s,a){return Math.max(s,Math.min(a,t))}function nl(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function _v(t){if(!t)return"-";const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function S4(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function _s({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Zl("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]||a.neutral),children:t})}function ds({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:Sd.green}:t==="accent"?{background:Sd.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Zl(i,o[t]||o.outline,n&&"cursor-not-allowed opacity-60",s),children:a})}function rh({enabled:t,onChange:s,label:a,description:l,disabled:n}){return e.jsxs("div",{className:Zl("flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",n&&"opacity-60"),children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",disabled:n,className:Zl("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white",n&&"cursor-not-allowed"),onClick:()=>!n&&s(!t),"aria-label":a,children:e.jsx("span",{className:Zl("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function ih({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",required:i,disabled:o}){const c=!!i&&!String(s||"").trim();return e.jsxs("div",{className:Zl(o&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"text-xs font-semibold text-slate-600",children:[t,i?e.jsx("span",{className:"text-rose-600",children:" *"}):null]}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,disabled:o,onChange:x=>a(x.target.value),placeholder:l,className:Zl("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold shadow-sm outline-none focus:ring-4",o?"border-slate-200 bg-slate-50 text-slate-500":c?"border-rose-300 bg-white text-slate-900 focus:ring-rose-100":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")}),c?e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:"Required"}):null]})}function Yi({label:t,value:s,onChange:a,hint:l,disabled:n}){return e.jsxs("div",{className:Zl(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",min:0,onKeyDown:r=>(r.key==="-"||r.key==="e")&&r.preventDefault(),value:s,disabled:n,onChange:r=>{const i=Number(r.target.value||0);i>=0&&a(i)},className:Zl("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold shadow-sm outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function A4({label:t,value:s,onChange:a,placeholder:l,rows:n=4,hint:r}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),r?e.jsx("div",{className:"text-xs text-slate-500",children:r}):null]}),e.jsx("textarea",{value:s,onChange:i=>a(i.target.value),placeholder:l,rows:n,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"})]})}function ad({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:Zl(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,disabled:r,onChange:i=>a(i.target.value),className:Zl("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function nm({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="900px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 bottom-4 top-4 z-50 mx-auto flex w-[min(980px,calc(100vw-2rem))] flex-col overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i,maxHeight:"92vh"},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex shrink-0 items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-1",children:[o?e.jsx(GE,{actions:o}):null,e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"shrink-0 border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function xV({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,actions:i}){return d.useEffect(()=>{const o=c=>c.key==="Escape"&&n();return t&&window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,x:16},animate:{opacity:1,x:0},exit:{opacity:0,x:16},transition:{duration:.18},className:Zl("fixed z-50 flex flex-col overflow-hidden border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]","bottom-2 left-2 right-2 top-2 rounded-[28px]","lg:bottom-4 lg:left-auto lg:right-4 lg:top-4 lg:w-[560px]"),style:{maxHeight:"calc(100vh - 32px)"},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex shrink-0 items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-base font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-1",children:[i?e.jsx(GE,{actions:i}):null,e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"shrink-0 border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function pV({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Zl("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function hV(t){return t>=70?{label:"High",tone:"bad"}:t>=40?{label:"Medium",tone:"warn"}:{label:"Low",tone:"good"}}function rm(t){const s=Number(t.policyBreaches||0),a=Number(t.anomalySignals||0),l=Number(t.spendMonth||0),n=Math.max(1,Number(t.limitMonth||1)),r=l/n;let i=8;i+=s*10,i+=a*15,i+=r>1?35:r>.85?20:r>.6?10:0,t.role==="Approver"&&(t.daysSinceApprovalAction||0)>=14&&(i+=25),t.status==="Suspended"&&(i+=10),i=mV(i,0,100);const o=hV(i);return{score:i,...o}}function E4(t){const s=Number(t.spendMonth||0),a=Math.max(1,Number(t.limitMonth||1)),l=s/a;return l>=.9?{title:"Consider raising monthly cap",body:"User consistently near cap. If legitimate, raise cap or enforce approvals above threshold.",tone:"warn",suggestedLimit:Math.round(a*1.25)}:l<=.2&&s>0?{title:"Consider lowering monthly cap",body:"Low utilization. You can tighten cap or move budget to higher-need users.",tone:"info",suggestedLimit:Math.round(a*.7)}:{title:"Limits look reasonable",body:"No recommendation based on current patterns.",tone:"good",suggestedLimit:null}}function oh(t){const s=t.split(/\r?\n/).map(n=>n.trim()).filter(Boolean);if(s.length<2)return{headers:[],rows:[]};const a=s[0].split(",").map(n=>n.trim()),l=s.slice(1).map(n=>{const r=n.split(",").map(o=>o.trim()),i={};return a.forEach((o,c)=>i[o]=r[c]||""),i});return{headers:a,rows:l}}function gV(){var se;const t=["Org Admin","Manager","Accountant","Approver","Travel Coordinator","User"],s=["Operations","Sales","Finance","Admin","Procurement"],a=[{id:"FIN-OPS",group:"Finance",name:"Finance ops"},{id:"OPS-CORE",group:"Operations",name:"Operations core"},{id:"SALES-TRAVEL",group:"Sales",name:"Sales travel"},{id:"ADMIN-CORE",group:"Admin",name:"Admin core"},{id:"PROC-001",group:"Procurement",name:"Procurement"}],[l,n]=d.useState([]),r=D=>{const re=uV("toast");n(v=>[{id:re,...D},...v].slice(0,4)),window.setTimeout(()=>n(v=>v.filter(k=>k.id!==re)),3200)},[i,o]=d.useState("All"),[c,x]=d.useState(""),[j,g]=d.useState("All"),[y,$]=d.useState("All"),[T,C]=d.useState("All"),[W,L]=d.useState(null),[R,F]=d.useState(()=>{const D=Date.now();return[{id:"U-1001",name:"Mary N.",email:"mary@acme.com",phone:"+256 700 111 111",status:"Active",role:"Manager",group:"Operations",costCenter:"OPS-CORE",autoApproval:!1,autoApproveUnder:0,limitDay:12e5,limitWeek:48e5,limitMonth:12e6,spendDay:18e4,spendWeek:132e4,spendMonth:94e5,policyBreaches:1,anomalySignals:0,daysSinceApprovalAction:999,lastActiveAt:D-2*60*60*1e3,createdAt:D-38*24*60*60*1e3,audit:[{ts:D-38*24*60*60*1e3,actor:"Org Admin",action:"Created",detail:"User created and activated"}]},{id:"U-1002",name:"Finance Desk",email:"finance@acme.com",phone:"+256 700 222 222",status:"Active",role:"Accountant",group:"Finance",costCenter:"FIN-OPS",autoApproval:!1,autoApproveUnder:0,limitDay:25e5,limitWeek:12e6,limitMonth:3e7,spendDay:42e4,spendWeek:22e5,spendMonth:82e5,policyBreaches:0,anomalySignals:0,daysSinceApprovalAction:2,lastActiveAt:D-45*60*1e3,createdAt:D-60*24*60*60*1e3,audit:[{ts:D-60*24*60*60*1e3,actor:"Org Admin",action:"Created",detail:"Finance role created"}]},{id:"U-1003",name:"John S.",email:"john@acme.com",phone:"+256 700 333 333",status:"Active",role:"User",group:"Sales",costCenter:"SALES-TRAVEL",autoApproval:!0,autoApproveUnder:2e5,limitDay:8e5,limitWeek:42e5,limitMonth:12e6,spendDay:92e3,spendWeek:76e4,spendMonth:118e5,policyBreaches:2,anomalySignals:1,daysSinceApprovalAction:999,lastActiveAt:D-15*60*1e3,createdAt:D-22*24*60*60*1e3,audit:[{ts:D-22*24*60*60*1e3,actor:"Org Admin",action:"Created",detail:"User invited and activated"},{ts:D-6*24*60*60*1e3,actor:"System",action:"Policy breach",detail:"Ride request outside hours"}]},{id:"U-1004",name:"Approver Desk",email:"approver@acme.com",phone:"+256 700 444 444",status:"Active",role:"Approver",group:"Procurement",costCenter:"PROC-001",autoApproval:!1,autoApproveUnder:0,limitDay:5e6,limitWeek:2e7,limitMonth:5e7,spendDay:0,spendWeek:0,spendMonth:0,policyBreaches:0,anomalySignals:0,daysSinceApprovalAction:21,lastActiveAt:D-22*24*60*60*1e3,createdAt:D-120*24*60*60*1e3,audit:[{ts:D-120*24*60*60*1e3,actor:"Org Admin",action:"Created",detail:"Approver role created"},{ts:D-21*24*60*60*1e3,actor:"Approver Desk",action:"Approved",detail:"Approved PO-9002"}]},{id:"U-1005",name:"New Hire",email:"newhire@acme.com",phone:"+256 700 555 555",status:"Invited",role:"User",group:"Operations",costCenter:"OPS-CORE",autoApproval:!1,autoApproveUnder:0,limitDay:6e5,limitWeek:3e6,limitMonth:8e6,spendDay:0,spendWeek:0,spendMonth:0,policyBreaches:0,anomalySignals:0,daysSinceApprovalAction:999,lastActiveAt:null,createdAt:D-2*24*60*60*1e3,audit:[{ts:D-2*24*60*60*1e3,actor:"Org Admin",action:"Invited",detail:"Invite sent"}]},{id:"U-1006",name:"Former Staff",email:"former@acme.com",phone:"+256 700 666 666",status:"Offboarded",role:"User",group:"Admin",costCenter:"ADMIN-CORE",autoApproval:!1,autoApproveUnder:0,limitDay:0,limitWeek:0,limitMonth:0,spendDay:0,spendWeek:0,spendMonth:0,policyBreaches:0,anomalySignals:0,daysSinceApprovalAction:999,lastActiveAt:D-200*24*60*60*1e3,createdAt:D-420*24*60*60*1e3,audit:[{ts:D-18*24*60*60*1e3,actor:"Org Admin",action:"Offboarded",detail:"CorporatePay revoked immediately"}]}]}),te=d.useMemo(()=>R.filter(D=>D.role==="Approver"&&D.status==="Active").map(D=>({user:D,risk:rm(D)})).filter(D=>D.user.daysSinceApprovalAction>=14),[R]),oe=d.useMemo(()=>{const D=c.trim().toLowerCase();return R.filter(re=>i==="All"?!0:re.status===i).filter(re=>j==="All"?!0:re.group===j).filter(re=>y==="All"?!0:re.role===y).filter(re=>T==="All"?!0:rm(re).label===T).filter(re=>D?`${re.id} ${re.name} ${re.email} ${re.phone} ${re.status} ${re.role} ${re.group} ${re.costCenter}`.toLowerCase().includes(D):!0).map(re=>({user:re,risk:rm(re)}))},[R,i,c,j,y,T]),G=d.useMemo(()=>{const D={All:R.length,Invited:0,Active:0,Suspended:0,Offboarded:0};return R.forEach(re=>{D[re.status]=(D[re.status]||0)+1}),D},[R]),H=d.useMemo(()=>[...R].filter(D=>D.status==="Active").sort((D,re)=>(re.spendMonth||0)-(D.spendMonth||0)).slice(0,5).map(D=>({user:D,suggestion:E4(D),risk:rm(D)})),[R]),[Y,we]=d.useState(!1),[q,je]=d.useState({name:"",email:"",phone:"",role:"User",group:"Operations",costCenter:"OPS-CORE",autoApproval:!1,autoApproveUnder:0,limitDay:6e5,limitWeek:3e6,limitMonth:8e6,sendInviteNow:!0}),_e=()=>{je({name:"",email:"",phone:"",role:"User",group:"Operations",costCenter:"OPS-CORE",autoApproval:!1,autoApproveUnder:0,limitDay:6e5,limitWeek:3e6,limitMonth:8e6,sendInviteNow:!0}),we(!0)},Ee=()=>{if(!q.name.trim()||!q.email.trim()){r({title:"Missing fields",message:"Name and email are required.",kind:"warn"});return}const D=Date.now(),re=`U-${Math.floor(1e3+Math.random()*9e3)}`,v=q.sendInviteNow?"Invited":"Active",k=[{ts:D,actor:"Org Admin",action:q.sendInviteNow?"Invited":"Created",detail:`Role ${q.role}, Group ${q.group}, Cost center ${q.costCenter}`}];F(m=>[{id:re,name:q.name,email:q.email,phone:q.phone,status:v,role:q.role,group:q.group,costCenter:q.costCenter,autoApproval:q.autoApproval,autoApproveUnder:q.autoApproval?q.autoApproveUnder:0,limitDay:q.limitDay,limitWeek:q.limitWeek,limitMonth:q.limitMonth,spendDay:0,spendWeek:0,spendMonth:0,policyBreaches:0,anomalySignals:0,daysSinceApprovalAction:999,lastActiveAt:null,createdAt:D,audit:k},...m]),we(!1),r({title:"User created",message:`${re}  ${v}`,kind:"success"})},be=d.useRef(null),[Fe,Pe]=d.useState(!1),[pe,Q]=d.useState(""),[Re,ce]=d.useState({headers:[],rows:[]}),xe=d.useMemo(()=>["name,email,phone,role,group,costCenter","Jane Doe,jane@acme.com,+256700000001,User,Operations,OPS-CORE","Mark P.,mark@acme.com,+256700000002,Approver,Procurement,PROC-001"].join(`
`),[]),he=()=>{Q(xe),ce(oh(xe)),Pe(!0)},de=async D=>{if(!D)return;const re=await D.text();Q(re),ce(oh(re))},ye=()=>{const D=new Blob([xe],{type:"text/csv"}),re=URL.createObjectURL(D),v=document.createElement("a");v.href=re,v.download="corporatepay-users-template.csv",v.click(),URL.revokeObjectURL(re)},Ke=()=>{if(!Re.rows.length){r({title:"No rows",message:"Upload or paste a CSV with at least one row.",kind:"warn"});return}const D=Date.now(),re=Re.rows.slice(0,50).map(v=>{const k=`U-${Math.floor(1e3+Math.random()*9e3)}`,m=(v.role||"User").trim(),S=(v.group||"Operations").trim(),f=(v.costCenter||"OPS-CORE").trim();return{id:k,name:(v.name||"Unnamed").trim(),email:(v.email||"").trim(),phone:(v.phone||"").trim(),status:"Invited",role:t.includes(m)?m:"User",group:s.includes(S)?S:"Operations",costCenter:f,autoApproval:!1,autoApproveUnder:0,limitDay:6e5,limitWeek:3e6,limitMonth:8e6,spendDay:0,spendWeek:0,spendMonth:0,policyBreaches:0,anomalySignals:0,daysSinceApprovalAction:999,lastActiveAt:null,createdAt:D,audit:[{ts:D,actor:"Org Admin",action:"Bulk invited",detail:"Imported via CSV"}]}});F(v=>[...re,...v]),Pe(!1),r({title:"Bulk import",message:`Created ${re.length} invited users.`,kind:"success"})},[Le,Ne]=d.useState(!1),[ge,$e]=d.useState(null),ie=ge?rm(ge):null,[Oe,Se]=d.useState(!1),[Te,Ge]=d.useState(""),[We,ze]=d.useState(!0),[Ue,le]=d.useState(!1),[z,Ae]=d.useState(null),[Ve,Ye]=d.useState("Finance Desk"),[Be,w]=d.useState("2026-01-21"),[B,ue]=d.useState("Approver inactivity coverage"),ne=D=>$e(D),Me=(D,re)=>{F(v=>v.map(k=>k.id===D?{...k,audit:[{ts:Date.now(),...re},...k.audit||[]]}:k))},De=D=>{if(D.status!=="Active"){r({title:"Not active",message:"Only active users can be suspended.",kind:"warn"});return}F(re=>re.map(v=>v.id===D.id?{...v,status:"Suspended"}:v)),Me(D.id,{actor:"Org Admin",action:"Suspended",detail:"CorporatePay blocked at checkout"}),r({title:"Suspended",message:`${D.name} suspended.`,kind:"info"})},fe=D=>{if(D.status!=="Suspended"){r({title:"Not suspended",message:"User is not suspended.",kind:"warn"});return}F(re=>re.map(v=>v.id===D.id?{...v,status:"Active"}:v)),Me(D.id,{actor:"Org Admin",action:"Reactivated",detail:"CorporatePay restored"}),r({title:"Reactivated",message:`${D.name} active again.`,kind:"success"})},me=D=>{if(D.status!=="Invited"){r({title:"Not invited",message:"User is not in invited status.",kind:"warn"});return}Me(D.id,{actor:"System",action:"Invite resent",detail:"Invite resent to email/SMS"}),r({title:"Invite resent",message:`Invite resent to ${D.email}.`,kind:"success"})},Xe=D=>{Ge(""),ze(!0),Se(!0)},V=()=>{if(ge){if(Te.trim().length<8){r({title:"Reason required",message:"Provide a clear offboarding reason.",kind:"warn"});return}F(D=>D.map(re=>re.id!==ge.id?re:{...re,status:"Offboarded",limitDay:0,limitWeek:0,limitMonth:0,autoApproval:!1,autoApproveUnder:0})),Me(ge.id,{actor:"Org Admin",action:"Offboarded",detail:`${We?"CorporatePay revoked immediately":"CorporatePay revoked"}  Reason: ${Te}`}),Se(!1),$e(D=>D&&{...D,status:"Offboarded"}),r({title:"Offboarded",message:`${ge.name} offboarded.`,kind:"success"})}},E=D=>{Ae(D),Ye("Finance Desk"),w("2026-01-21"),ue("Approver inactivity coverage"),le(!0)},u=()=>{if(z){if(!B.trim()){r({title:"Reason required",message:"Provide a reason for delegation.",kind:"warn"});return}Me(z.id,{actor:"Org Admin",action:"Delegation set",detail:`Delegated approvals to ${Ve} until ${Be}. Reason: ${B}`}),le(!1),r({title:"Delegation set",message:`${z.name} delegated to ${Ve}.`,kind:"success"})}},P=["All","Invited","Active","Suspended","Offboarded"];return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(pV,{toasts:l,onDismiss:D=>n(re=>re.filter(v=>v.id!==D))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:Sd.green},children:e.jsx(Os,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Users and Invitations"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Manage access, limits, and risk. Offboarding revokes CorporatePay instantly and preserves audit history."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(_s,{label:`Total: ${G.All}`,tone:"neutral"}),e.jsx(_s,{label:`Active: ${G.Active}`,tone:G.Active?"good":"neutral"}),e.jsx(_s,{label:`Invited: ${G.Invited}`,tone:G.Invited?"info":"neutral"}),e.jsx(_s,{label:`Suspended: ${G.Suspended}`,tone:G.Suspended?"warn":"neutral"}),e.jsx(_s,{label:`Offboarded: ${G.Offboarded}`,tone:(G.Offboarded,"neutral")})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ds,{variant:"outline",onClick:he,children:[e.jsx(h0,{className:"h-4 w-4"})," Bulk import"]}),e.jsxs(ds,{variant:"outline",onClick:()=>Ne(!0),children:[e.jsx(Xl,{className:"h-4 w-4"})," HRIS import"]}),e.jsxs(ds,{variant:"primary",onClick:_e,children:[e.jsx(Cv,{className:"h-4 w-4"})," Add user"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:P.map(D=>e.jsxs("button",{type:"button",onClick:()=>o(D),className:Zl("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",i===D?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:i===D?{background:Sd.green}:void 0,children:[D," ",D==="All"?`(${G.All})`:`(${G[D]||0})`]},D))}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-4",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsxs("div",{className:"mt-1 flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-2 py-2",children:[e.jsx(pa,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:c,onChange:D=>x(D.target.value),placeholder:"Name, email, ID, group...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"})]})]}),e.jsx(ad,{label:"Group",value:j,onChange:g,options:[{value:"All",label:"All"},...s.map(D=>({value:D,label:D}))]}),e.jsx(ad,{label:"Role",value:y,onChange:$,options:[{value:"All",label:"All"},...t.map(D=>({value:D,label:D}))]}),e.jsx(ad,{label:"Risk",value:T,onChange:C,options:[{value:"All",label:"All"},{value:"Low",label:"Low"},{value:"Medium",label:"Medium"},{value:"High",label:"High"}],hint:"Premium"})]})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 mb-6",children:[te.length?e.jsxs("div",{className:"rounded-3xl border border-amber-200 bg-amber-50 p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Delegation needed"}),e.jsx("div",{className:"mt-1 text-xs text-slate-700",children:"Approver inactivity detected. Set a delegate to avoid approval bottlenecks."})]}),e.jsx(_s,{label:"Premium",tone:"info"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:te.slice(0,2).map(D=>e.jsx("div",{className:"rounded-2xl border border-amber-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:D.user.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Inactive approvals: ",D.user.daysSinceApprovalAction," days  Risk: ",D.risk.label]})]}),e.jsxs(ds,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>E(D.user),children:[e.jsx(et,{className:"h-4 w-4"})," Set delegate"]})]})},D.user.id))}),e.jsx("div",{className:"mt-3 text-xs text-slate-700",children:"This creates an audit log entry and routes approvals to a delegate."})]}):e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Approvals health"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"No inactive approvers detected in this demo."})]}),e.jsx(_s,{label:"OK",tone:"good"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: delegation prompts appear when an approver is inactive or SLA breaches spike."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Top spenders"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium insights and limit suggestions"})]}),e.jsx(_s,{label:"Premium",tone:"info"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:H.map(D=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("button",{className:"min-w-0 text-left",onClick:()=>ne(D.user),children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:D.user.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[D.user.group,"  ",D.user.role]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-700",children:["Spend: ",e.jsx("span",{className:"font-semibold text-slate-900",children:nl(D.user.spendMonth)})," / ",nl(D.user.limitMonth)]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsx(_s,{label:D.risk.label,tone:D.risk.tone}),e.jsx(_s,{label:D.suggestion.title,tone:D.suggestion.tone})]})]}),D.suggestion.suggestedLimit?e.jsxs("div",{className:"mt-2 flex flex-wrap items-center justify-between gap-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsxs("div",{children:["Suggested monthly cap: ",e.jsx("span",{className:"font-semibold text-slate-900",children:nl(D.suggestion.suggestedLimit)})]}),e.jsxs(ds,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{F(re=>re.map(v=>v.id===D.user.id?{...v,limitMonth:D.suggestion.suggestedLimit}:v)),Me(D.user.id,{actor:"Org Admin",action:"Limit adjusted",detail:`Monthly cap set to ${nl(D.suggestion.suggestedLimit)}`}),r({title:"Applied",message:"Limit suggestion applied (demo).",kind:"success"})},children:[e.jsx(ht,{className:"h-4 w-4"})," Apply"]})]}):e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:D.suggestion.body})]},D.user.id))})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Onboarding tools"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"CSV bulk import and HRIS (Phase 2)"})]}),e.jsx(_s,{label:"Core",tone:"neutral"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2",children:[e.jsxs(ds,{variant:"outline",onClick:he,children:[e.jsx(h0,{className:"h-4 w-4"})," Bulk import CSV"]}),e.jsxs(ds,{variant:"outline",onClick:()=>Ne(!0),children:[e.jsx(Xl,{className:"h-4 w-4"})," HRIS import (Phase 2)"]})]})]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-3 border-b border-slate-200 px-4 py-3 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Users"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Click a row to open details and audit history."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ds,{variant:"outline",className:"text-xs",onClick:()=>{x(""),g("All"),$("All"),C("All"),r({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(Qe,{className:"h-4 w-4"})," Reset filters"]}),e.jsxs(ds,{variant:"primary",className:"text-xs",onClick:_e,children:[e.jsx(Cv,{className:"h-4 w-4"})," Add user"]})]})]}),e.jsx("div",{className:"hidden md:block",children:e.jsxs("table",{className:"w-full text-left text-sm table-fixed",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold w-[18%]",children:"User"}),e.jsx("th",{className:"px-4 py-3 font-semibold w-[10%]",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold w-[10%]",children:"Role"}),e.jsx("th",{className:"px-4 py-3 font-semibold w-[10%]",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold w-[10%]",children:"Risk"}),e.jsx("th",{className:"px-4 py-3 font-semibold w-[16%]",children:"Spend MTD"}),e.jsx("th",{className:"px-4 py-3 font-semibold w-[10%]",children:"Auto-approve"}),e.jsx("th",{className:"px-4 py-3 font-semibold w-[10%]",children:"Last active"}),e.jsx("th",{className:"px-4 py-3 font-semibold w-[6%]",children:"Actions"})]})}),e.jsxs("tbody",{children:[oe.map(({user:D,risk:re})=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("button",{className:"text-left truncate max-w-full",onClick:()=>ne(D),children:[e.jsx("div",{className:"font-semibold text-slate-900 truncate",children:D.name}),e.jsx("div",{className:"mt-1 text-xs text-slate-500 truncate",children:D.email})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(_s,{label:D.status,tone:D.status==="Active"?"good":D.status==="Invited"?"info":D.status==="Suspended"?"warn":"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700 truncate",children:D.role}),e.jsx("td",{className:"px-4 py-3 text-slate-700 truncate",children:D.group}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(_s,{label:`${re.label}`,tone:re.tone})}),e.jsxs("td",{className:"px-4 py-3 text-slate-700 text-xs",children:[nl(D.spendMonth)," / ",nl(D.limitMonth)]}),e.jsx("td",{className:"px-4 py-3",children:D.autoApproval?e.jsx(_s,{label:"Yes",tone:"info"}):e.jsx(_s,{label:"No",tone:"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700 text-xs",children:D.lastActiveAt?_v(D.lastActiveAt):"-"}),e.jsxs("td",{className:"px-4 py-3 relative",children:[e.jsx("button",{onClick:v=>{v.stopPropagation(),L(W===D.id?null:D.id)},className:"p-1.5 text-slate-500 hover:bg-slate-100 rounded-full transition-colors",children:e.jsx(xs,{className:"h-4 w-4"})}),e.jsx(lt,{children:W===D.id&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>L(null)}),e.jsxs(qe.div,{initial:{opacity:0,scale:.95,y:-5},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-5},className:"absolute right-8 top-1/2 -translate-y-1/2 z-20 w-36 bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden",children:[e.jsxs("button",{className:"w-full text-left px-3 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-50 flex items-center gap-2",onClick:()=>{ne(D),L(null)},children:[e.jsx(et,{className:"h-3 w-3"})," Open details"]}),D.status==="Invited"&&e.jsxs("button",{className:"w-full text-left px-3 py-2 text-xs font-semibold text-blue-600 hover:bg-blue-50 flex items-center gap-2",onClick:()=>{me(D),L(null)},children:[e.jsx(Xs,{className:"h-3 w-3"})," Resend invite"]}),D.status==="Active"&&e.jsxs("button",{className:"w-full text-left px-3 py-2 text-xs font-semibold text-amber-600 hover:bg-amber-50 flex items-center gap-2",onClick:()=>{De(D),L(null)},children:[e.jsx(yt,{className:"h-3 w-3"})," Suspend"]}),D.status==="Suspended"&&e.jsxs("button",{className:"w-full text-left px-3 py-2 text-xs font-semibold text-emerald-600 hover:bg-emerald-50 flex items-center gap-2",onClick:()=>{fe(D),L(null)},children:[e.jsx(tt,{className:"h-3 w-3"})," Reactivate"]})]})]})})]})]},D.id)),oe.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-4 py-12",children:e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(Os,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No users found"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Try adjusting filters or search."})]})})})]})]})}),e.jsxs("div",{className:"space-y-3 p-4 md:hidden",children:[oe.map(({user:D,risk:re})=>e.jsxs("button",{type:"button",onClick:()=>ne(D),className:"w-full rounded-3xl border border-slate-200 bg-white p-4 text-left",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:D.name}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:D.email}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(_s,{label:D.status,tone:D.status==="Active"?"good":D.status==="Invited"?"info":D.status==="Suspended"?"warn":"neutral"}),e.jsx(_s,{label:D.group,tone:"neutral"}),e.jsx(_s,{label:D.role,tone:"neutral"}),e.jsx(_s,{label:`${re.label} (${re.score})`,tone:re.tone})]})]}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Spend: ",nl(D.spendMonth)," / ",nl(D.limitMonth)]})]},D.id)),oe.length?null:e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(Os,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No users found"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Try adjusting filters or add a user."})]})]}),e.jsx("div",{className:"border-t border-slate-200 px-4 py-3 text-xs text-slate-500",children:"Premium: risk scoring is explainable and based on policy breaches, anomalies, utilization, and approver inactivity."})]})}),e.jsx("div",{className:"mt-4 text-xs text-slate-500",children:"F Users & Invitations v2: add users with role/group/cost center, auto-approval eligibility, spend limits, bulk CSV import, HRIS (phase 2), offboarding workflow, risk scoring, top spenders insights, and delegation prompts."})]})]})}),e.jsx(nm,{open:Y,title:"Add user",subtitle:"Create a user, set role, group, cost center, spend limits, and auto-approval eligibility.",onClose:()=>we(!1),actions:[{label:"Cancel",onClick:()=>we(!1),variant:"outline"},{label:"Preview invite",onClick:()=>r({title:"Preview",message:"Preview invite message (demo).",kind:"info"}),variant:"outline"},{label:"Create",onClick:Ee,variant:"default"}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(ds,{variant:"outline",onClick:()=>we(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ds,{variant:"outline",onClick:()=>r({title:"Preview",message:"Preview invite message (demo).",kind:"info"}),children:[e.jsx(Xs,{className:"h-4 w-4"})," Preview invite"]}),e.jsxs(ds,{variant:"primary",onClick:Ee,children:[e.jsx(Cv,{className:"h-4 w-4"})," Create"]})]})]}),maxW:"980px",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Identity"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(ih,{label:"Full name",required:!0,value:q.name,onChange:D=>je(re=>({...re,name:D})),placeholder:"Full name"}),e.jsx(ih,{label:"Email",required:!0,value:q.email,onChange:D=>je(re=>({...re,email:D})),placeholder:"name@company.com"}),e.jsx(ih,{label:"Phone",value:q.phone,onChange:D=>je(re=>({...re,phone:D})),placeholder:"+256..."}),e.jsx(ad,{label:"Role",value:q.role,onChange:D=>je(re=>({...re,role:D})),options:t.map(D=>({value:D,label:D}))}),e.jsx(ad,{label:"Group",value:q.group,onChange:D=>{var v;const re=((v=a.find(k=>k.group===D))==null?void 0:v.id)||"OPS-CORE";je(k=>({...k,group:D,costCenter:re}))},options:s.map(D=>({value:D,label:D}))}),e.jsx(ad,{label:"Cost center",value:q.costCenter,onChange:D=>je(re=>({...re,costCenter:D})),options:a.filter(D=>D.group===q.group).map(D=>({value:D.id,label:`${D.id} - ${D.name}`}))})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Spend limits"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Daily, weekly, monthly caps for CorporatePay."})]}),e.jsx(_s,{label:"Core",tone:"neutral"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(Yi,{label:"Daily cap (UGX)",value:q.limitDay,onChange:D=>je(re=>({...re,limitDay:D})),hint:nl(q.limitDay)}),e.jsx(Yi,{label:"Weekly cap (UGX)",value:q.limitWeek,onChange:D=>je(re=>({...re,limitWeek:D})),hint:nl(q.limitWeek)}),e.jsx(Yi,{label:"Monthly cap (UGX)",value:q.limitMonth,onChange:D=>je(re=>({...re,limitMonth:D})),hint:nl(q.limitMonth)})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: limits can be suggested automatically based on peer usage."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Auto-approval eligibility"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Set by the admin creating this user."})]}),e.jsx(_s,{label:"Core",tone:"neutral"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(rh,{enabled:q.autoApproval,onChange:D=>je(re=>({...re,autoApproval:D})),label:"Allow auto-approval",description:"If on, transactions under the threshold can auto-approve."}),e.jsx(Yi,{label:"Auto-approve under (UGX)",value:q.autoApproveUnder,onChange:D=>je(re=>({...re,autoApproveUnder:D})),hint:"Requires allow toggle",disabled:!q.autoApproval})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Best practice: auto-approval should be disabled for high-risk roles or high-value marketplaces."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Invite"}),e.jsxs("div",{className:"mt-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Create as:",e.jsxs("ul",{className:"mt-2 space-y-1 text-xs text-slate-600",children:[e.jsx("li",{children:"1) Invited (recommended) or"}),e.jsx("li",{children:"2) Active immediately (for admins)"})]})]}),e.jsx(rh,{enabled:q.sendInviteNow,onChange:D=>je(re=>({...re,sendInviteNow:D})),label:q.sendInviteNow?"Send invite now":"Activate immediately",description:"Invite acceptance happens on X3."}),e.jsx("div",{className:"mt-3 text-xs text-slate-500",children:"In production, invite delivery logs appear in Notifications Center."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Audit preview"}),e.jsx("pre",{className:"mt-3 max-h-[260px] overflow-auto rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-800",children:JSON.stringify({action:"Create user",actor:"Org Admin",role:q.role,group:q.group,costCenter:q.costCenter,limits:{daily:q.limitDay,weekly:q.limitWeek,monthly:q.limitMonth},autoApproval:q.autoApproval?{eligible:!0,under:q.autoApproveUnder}:{eligible:!1},status:q.sendInviteNow?"Invited":"Active"},null,2)}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"This would be stored in the audit log (immutable in production)."})]})]})]})}),e.jsx(nm,{open:Fe,title:"Bulk import users",subtitle:"Upload a CSV or paste contents. Users are created as Invited by default.",onClose:()=>Pe(!1),actions:[{label:"Cancel",onClick:()=>Pe(!1),variant:"outline"},{label:"Download template",onClick:ye,variant:"outline"},{label:"Import",onClick:Ke,variant:"default"}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(ds,{variant:"outline",onClick:()=>Pe(!1),children:"Close"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ds,{variant:"outline",onClick:ye,children:[e.jsx(pt,{className:"h-4 w-4"})," Download template"]}),e.jsxs(ds,{variant:"primary",onClick:Ke,children:[e.jsx(h0,{className:"h-4 w-4"})," Import"]})]})]}),maxW:"980px",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"CSV"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Header: name,email,phone,role,group,costCenter"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{ref:be,type:"file",accept:".csv,text/csv",className:"hidden",onChange:D=>{var re;return de(((re=D.target.files)==null?void 0:re[0])||null)}}),e.jsxs(ds,{variant:"outline",onClick:()=>{var D;return(D=be.current)==null?void 0:D.click()},children:[e.jsx(gt,{className:"h-4 w-4"})," Upload"]}),e.jsxs(ds,{variant:"outline",onClick:()=>{ce(oh(pe)),r({title:"Parsed",message:"Preview refreshed.",kind:"success"})},children:[e.jsx(tt,{className:"h-4 w-4"})," Parse"]})]})]}),e.jsx("textarea",{value:pe,onChange:D=>{Q(D.target.value),ce(oh(D.target.value))},rows:10,className:"mt-3 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Preview"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Showing up to 10 rows"}),e.jsx("div",{className:"mt-3 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsx("tr",{children:(Re.headers.length?Re.headers:["name","email","phone","role","group","costCenter"]).map(D=>e.jsx("th",{className:"px-4 py-3 font-semibold",children:D},D))})}),e.jsxs("tbody",{children:[Re.rows.slice(0,10).map((D,re)=>e.jsx("tr",{className:"border-t border-slate-100",children:(Re.headers.length?Re.headers:["name","email","phone","role","group","costCenter"]).map(v=>e.jsx("td",{className:"px-4 py-3 text-slate-700",children:D[v]||""},v))},re)),Re.rows.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No rows parsed."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Imported users are created as Invited by default. Admin can set initial limits later."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Bulk import rules"}),e.jsxs("ul",{className:"mt-2 space-y-2 text-sm text-slate-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:Sd.green}})," Max 50 users per import (demo)"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:Sd.orange}})," Invalid roles default to User"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:Sd.green}})," All actions are audit logged"]})]})]}),e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-amber-50 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-white text-amber-800 ring-1 ring-amber-200",children:e.jsx(Et,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"HRIS import (Phase 2)"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:"Workday/BambooHR/Microsoft Entra sync can be added later."})]})]})})]})]})}),e.jsx(nm,{open:Le,title:"HRIS import",subtitle:"Phase 2: sync users and groups from HRIS.",onClose:()=>Ne(!1),actions:[{label:"Close",onClick:()=>Ne(!1),variant:"outline"}],footer:e.jsx("div",{className:"flex justify-end",children:e.jsx(ds,{variant:"outline",onClick:()=>Ne(!1),children:"Close"})}),maxW:"860px",children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Connect HRIS"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Planned: SSO + HRIS to provision users automatically."})]}),e.jsx(_s,{label:"Phase 2",tone:"info"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs(ds,{variant:"outline",onClick:()=>r({title:"Workday",message:"Connector coming in Phase 2.",kind:"info"}),children:[e.jsx(Xl,{className:"h-4 w-4"})," Workday"]}),e.jsxs(ds,{variant:"outline",onClick:()=>r({title:"BambooHR",message:"Connector coming in Phase 2.",kind:"info"}),children:[e.jsx(Xl,{className:"h-4 w-4"})," BambooHR"]}),e.jsxs(ds,{variant:"outline",onClick:()=>r({title:"Entra",message:"Connector coming in Phase 2.",kind:"info"}),children:[e.jsx(yt,{className:"h-4 w-4"})," Microsoft Entra"]}),e.jsxs(ds,{variant:"outline",onClick:()=>r({title:"CSV sync",message:"Scheduled CSV sync (Phase 2).",kind:"info"}),children:[e.jsx(kt,{className:"h-4 w-4"})," Scheduled CSV sync"]})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: HRIS rules can auto-assign group, role, and default limits (see X3 JIT provisioning)."})]})}),e.jsx(xV,{open:!!ge,title:ge?ge.name:"",subtitle:ge?`${ge.email}  ${ge.id}`:"",onClose:()=>{$e(null),Se(!1)},actions:ge?[...ge.status==="Invited"?[{label:"Resend invite",onClick:()=>me(ge),variant:"outline"}]:[],...ge.status==="Active"?[{label:"Suspend",onClick:()=>De(ge),variant:"outline"}]:[],...ge.status==="Suspended"?[{label:"Reactivate",onClick:()=>fe(ge),variant:"outline"}]:[],...ge.status!=="Offboarded"?[{label:"Offboard",onClick:()=>Xe(),variant:"danger"}]:[]]:[],footer:ge?e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Status: ",ge.status,"  Group: ",ge.group]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[ge.status==="Invited"?e.jsxs(ds,{variant:"outline",onClick:()=>me(ge),children:[e.jsx(Xs,{className:"h-4 w-4"})," Resend invite"]}):null,ge.status==="Active"?e.jsxs(ds,{variant:"outline",onClick:()=>De(ge),children:[e.jsx(yt,{className:"h-4 w-4"})," Suspend"]}):null,ge.status==="Suspended"?e.jsxs(ds,{variant:"outline",onClick:()=>fe(ge),children:[e.jsx(tt,{className:"h-4 w-4"})," Reactivate"]}):null,ge.status!=="Offboarded"?e.jsxs(ds,{variant:"danger",onClick:()=>Xe(),children:[e.jsx(as,{className:"h-4 w-4"})," Offboard"]}):null]})]}):null,children:ge?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Overview"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"User settings and risk"})]}),ie?e.jsx(_s,{label:`Risk: ${ie.label} (${ie.score})`,tone:ie.tone}):null]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(dh,{label:"Role",value:ge.role}),e.jsx(dh,{label:"Group",value:ge.group}),e.jsx(dh,{label:"Cost center",value:ge.costCenter}),e.jsx(dh,{label:"Last active",value:ge.lastActiveAt?`${S4(ge.lastActiveAt)} (${_v(ge.lastActiveAt)})`:"-"})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Spend month-to-date: ",e.jsx("span",{className:"font-semibold text-slate-900",children:nl(ge.spendMonth)})," / ",nl(ge.limitMonth)]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Limits"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx(Yi,{label:"Daily cap",value:ge.limitDay,onChange:D=>{F(re=>re.map(v=>v.id===ge.id?{...v,limitDay:D}:v)),$e(re=>re?{...re,limitDay:D}:null)},hint:nl(ge.limitDay),disabled:ge.status==="Offboarded"}),e.jsx(Yi,{label:"Weekly cap",value:ge.limitWeek,onChange:D=>{F(re=>re.map(v=>v.id===ge.id?{...v,limitWeek:D}:v)),$e(re=>re?{...re,limitWeek:D}:null)},hint:nl(ge.limitWeek),disabled:ge.status==="Offboarded"}),e.jsx(Yi,{label:"Monthly cap",value:ge.limitMonth,onChange:D=>{F(re=>re.map(v=>v.id===ge.id?{...v,limitMonth:D}:v)),$e(re=>re?{...re,limitMonth:D}:null)},hint:nl(ge.limitMonth),disabled:ge.status==="Offboarded"})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(ds,{variant:"outline",onClick:()=>{Me(ge.id,{actor:"Org Admin",action:"Limits updated",detail:"Updated spend limits"}),r({title:"Saved",message:"Limits saved (demo).",kind:"success"})},children:[e.jsx(Da,{className:"h-4 w-4"})," Save limits"]}),e.jsxs(ds,{variant:"outline",onClick:()=>{const D=E4(ge);if(!D.suggestedLimit){r({title:"No suggestion",message:"No limit change recommended.",kind:"info"});return}F(re=>re.map(v=>v.id===ge.id?{...v,limitMonth:D.suggestedLimit}:v)),$e(re=>re?{...re,limitMonth:D.suggestedLimit}:null),Me(ge.id,{actor:"System",action:"Suggestion applied",detail:`Monthly cap set to ${nl(D.suggestedLimit)}`}),r({title:"Applied",message:"Suggestion applied.",kind:"success"})},children:[e.jsx(ht,{className:"h-4 w-4"})," Apply suggestion"]})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Auto-approval"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Set by admin. Use carefully."})]}),e.jsx(_s,{label:ge.autoApproval?"Enabled":"Off",tone:ge.autoApproval?"info":"neutral"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(rh,{enabled:!!ge.autoApproval,onChange:D=>{F(re=>re.map(v=>v.id===ge.id?{...v,autoApproval:D,autoApproveUnder:D?v.autoApproveUnder:0}:v)),$e(re=>re?{...re,autoApproval:D,autoApproveUnder:D?re.autoApproveUnder:0}:null)},label:"Allow auto-approval",description:"Auto-approve under threshold",disabled:ge.status==="Offboarded"}),e.jsx(Yi,{label:"Auto-approve under",value:ge.autoApproveUnder,onChange:D=>{F(re=>re.map(v=>v.id===ge.id?{...v,autoApproveUnder:D}:v)),$e(re=>re?{...re,autoApproveUnder:D}:null)},hint:nl(ge.autoApproveUnder),disabled:!ge.autoApproval||ge.status==="Offboarded"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Auto-approval should be disabled for high-risk users or when anomalies occur."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Audit log"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"All changes are recorded (immutable in production)."}),e.jsxs("div",{className:"mt-3 space-y-2",children:[(ge.audit||[]).slice(0,10).map((D,re)=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:D.action}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[D.actor,"  ",S4(D.ts)]}),e.jsx("div",{className:"mt-1 text-xs text-slate-700",children:D.detail})]}),e.jsx(_s,{label:_v(D.ts),tone:"neutral"})]})},re)),(se=ge.audit)!=null&&se.length?null:e.jsx("div",{className:"text-sm text-slate-600",children:"No audit entries."})]})]})]}):null}),e.jsx(nm,{open:Oe,title:"Offboard user",subtitle:"Revokes CorporatePay instantly and preserves audit history.",onClose:()=>Se(!1),actions:[{label:"Cancel",onClick:()=>Se(!1),variant:"outline"},{label:"Confirm offboard",onClick:V,variant:"danger"}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(ds,{variant:"outline",onClick:()=>Se(!1),children:"Cancel"}),e.jsxs(ds,{variant:"danger",onClick:V,children:[e.jsx(as,{className:"h-4 w-4"})," Confirm offboard"]})]}),maxW:"860px",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Offboarding immediately blocks CorporatePay at checkout for this user."}),e.jsx(rh,{enabled:We,onChange:ze,label:"Revoke CorporatePay immediately",description:"Recommended"}),e.jsx(A4,{label:"Reason",value:Te,onChange:Ge,placeholder:"Example: employee left the company; access revoked",rows:4,hint:"Minimum 8 characters"}),e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Audit logs remain visible to admins. Offboarded users can be reinstated by re-inviting."})]})}),e.jsx(nm,{open:Ue,title:"Set approver delegation",subtitle:"Route approvals to a delegate when the approver is inactive.",onClose:()=>le(!1),actions:[{label:"Cancel",onClick:()=>le(!1),variant:"outline"},{label:"Save delegation",onClick:u,variant:"default"}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(ds,{variant:"outline",onClick:()=>le(!1),children:"Cancel"}),e.jsxs(ds,{variant:"primary",onClick:u,children:[e.jsx(ct,{className:"h-4 w-4"})," Save delegation"]})]}),maxW:"920px",children:e.jsxs("div",{className:"space-y-4",children:[z?e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Approver: ",e.jsx("span",{className:"font-semibold text-slate-900",children:z.name}),"  ",z.id]}):null,e.jsx(ad,{label:"Delegate to",value:Ve,onChange:Ye,options:["Finance Desk","Org Admin","Procurement Desk"].map(D=>({value:D,label:D}))}),e.jsx(ih,{label:"Delegation until",value:Be,onChange:w,placeholder:"YYYY-MM-DD",hint:"Date"}),e.jsx(A4,{label:"Reason",value:B,onChange:ue,placeholder:"Reason",rows:3}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: delegation rules integrate with Approval Workflow Builder (J) and Approvals Inbox (K)."})]})}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"F Users & Invitations v2: users list, add user, bulk import, HRIS placeholder, offboarding workflow, risk scoring, top spenders insights, and delegation prompts."})})]})}function dh({label:t,value:s}){return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:s})]})}const wr={green:"#03CD8C",orange:"#F77F00"};function on(...t){return t.filter(Boolean).join(" ")}function ch(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function fV(t,s,a){return Math.max(s,Math.min(a,t))}function rl(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function uh(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function Wt({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:on("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function es({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:wr.green}:t==="accent"?{background:wr.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:on(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function vV({actions:t=[]}){const[s,a]=d.useState(!1);return t.length?e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>a(!s),className:"grid h-8 w-8 place-items-center rounded-full text-slate-500 hover:bg-slate-100",children:e.jsx(xs,{className:"h-5 w-5"})}),s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-50",onClick:()=>a(!1)}),e.jsx("div",{className:"absolute right-0 top-full z-50 mt-1 w-48 overflow-hidden rounded-xl border border-slate-200 bg-white shadow-xl",children:t.map((l,n)=>e.jsx("button",{onClick:()=>{l.onClick(),a(!1)},className:on("block w-full px-4 py-2.5 text-left text-sm font-medium hover:bg-slate-50",l.variant==="danger"?"text-rose-600":"text-slate-700"),children:l.label},n))})]}):null]}):null}function im({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,actions:i,maxW:o="920px"}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[8vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:o},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(vV,{actions:i}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function bV({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:on("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="warn"||a.kind==="error"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function M4({values:t}){var o;const l=Math.max(1,...t),n=Math.min(...t),r=Math.max(1,l-n),i=t.map((c,x)=>{const j=x/Math.max(1,t.length-1)*132+4,g=38-(c-n)/r*32;return`${j.toFixed(1)},${g.toFixed(1)}`}).join(" ");return e.jsxs("svg",{width:140,height:44,className:"overflow-visible",children:[e.jsx("polyline",{points:i,fill:"none",stroke:wr.green,strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("circle",{cx:136,cy:Number(((o=i.split(" ").pop())==null?void 0:o.split(",")[1])||44/2),r:3.5,fill:wr.orange})]})}function Bv({label:t,value:s,total:a,hint:l}){const n=fV(s/Math.max(1,a)*100,0,100);return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-700",children:t}),e.jsx("div",{className:"text-xs font-semibold text-slate-900",children:l??`${Math.round(n)}%`})]}),e.jsx("div",{className:"mt-2 h-2 w-full overflow-hidden rounded-full bg-slate-100",children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${n}%`,background:wr.green}})})]})}function dc(t){return Math.round(t.reduce((s,a)=>s+Number(a.percent||0),0))}function om(t,s,a){return Math.round(t/Math.max(1,s)*a)}function cc(t,s){return t>s?{label:"Over",tone:"bad"}:t>s*.9?{label:"At risk",tone:"warn"}:{label:"OK",tone:"good"}}function jV(t,s){return s<=0?t>0?100:0:(t-s)/s*100}function Gv(t){const s=Object.keys(t.weeklyBreakdown),a=t.weeklySeries[t.weeklySeries.length-1]||0,l=t.weeklySeries[t.weeklySeries.length-2]||0,n=jV(a,l);let r="Rides",i=-1/0;for(const g of s){const y=t.weeklyBreakdown[g],$=y[y.length-1]||0,T=y[y.length-2]||0,C=$-T;C>i&&(i=C,r=g)}const o={Rides:"Ride volume and airport routes",Purchases:"Marketplace purchases and vendor activity",Services:"Service bookings and add-ons",RFQs:"High-value RFQs and procurement cycles"},c=n>=0?"up":"down",x=Math.abs(n),j=Math.round(x);return{title:`Week over week is ${c} ${j}%`,body:`Main driver: ${r}. ${o[String(r)]}.`,tone:n>15?"warn":n<-15?"good":"neutral"}}function yV(){var k;const[a,l]=d.useState([]),n=m=>{const S=ch("toast");l(f=>[{id:S,...m},...f].slice(0,4)),window.setTimeout(()=>l(f=>f.filter(U=>U.id!==S)),3200)},[r,i]=d.useState("Groups"),[o,c]=d.useState(()=>{const m=Date.now(),S=(f,U,p,M,ee,b,ae,ve,O,X,A)=>({id:f,budgetMonth:U,spendMTD:p,hardCap:M,priority:ee,manager:b,updatedAt:m-Math.floor(Math.random()*6)*24*60*60*1e3,weeklySeries:ae,weeklyBreakdown:{Rides:ve,Purchases:O,Services:X,RFQs:A}});return[S("Operations",15e6,12e6,!0,1,"Mary N.",[36e5,39e5,41e5,44e5,52e5,56e5],[18e5,19e5,2e6,22e5,24e5,26e5],[12e5,13e5,14e5,15e5,17e5,19e5],[25e4,26e4,3e5,31e4,35e4,42e4],[35e4,44e4,4e5,39e4,45e4,51e4]),S("Sales",12e6,98e5,!0,2,"Samuel A.",[22e5,25e5,27e5,3e6,36e5,41e5],[12e5,13e5,14e5,15e5,17e5,19e5],[8e5,9e5,95e4,11e5,14e5,16e5],[14e4,15e4,16e4,18e4,26e4,28e4],[6e4,7e4,9e4,11e4,24e4,32e4]),S("Finance",6e6,52e5,!0,3,"Finance Desk",[11e5,12e5,125e4,13e5,15e5,165e4],[24e4,26e4,28e4,3e5,36e4,38e4],[52e4,54e4,56e4,59e4,62e4,74e4],[12e4,14e4,15e4,16e4,18e4,2e5],[22e4,26e4,26e4,25e4,34e4,37e4]),S("Admin",5e6,41e5,!1,4,"Admin Team",[9e5,95e4,98e4,102e4,11e5,118e4],[19e4,2e5,21e4,22e4,24e4,28e4],[42e4,45e4,46e4,47e4,52e4,56e4],[12e4,14e4,14e4,15e4,16e4,17e4],[17e4,16e4,17e4,18e4,18e4,17e4]),S("Procurement",5e6,34e5,!1,5,"Procurement Desk",[72e4,76e4,79e4,82e4,88e4,92e4],[1e5,12e4,13e4,14e4,15e4,16e4],[32e4,34e4,35e4,36e4,38e4,4e5],[8e4,9e4,11e4,12e4,14e4,15e4],[22e4,21e4,2e5,2e5,21e4,21e4])]}),[x,j]=d.useState(()=>{const m=Date.now();return[{id:"CC-OPS-CORE",code:"OPS-CORE",name:"Operations core",group:"Operations",active:!0,defaultTags:["Event: FieldOps"],invoiceGroup:"ACME-MAIN",updatedAt:m-12*24*60*60*1e3},{id:"CC-OPS-DEL",code:"OPS-DELIVERY",name:"Courier and delivery",group:"Operations",active:!0,defaultTags:["Campaign: QuickShip"],invoiceGroup:"ACME-MAIN",updatedAt:m-7*24*60*60*1e3},{id:"CC-SALES-TR",code:"SALES-TRAVEL",name:"Sales travel",group:"Sales",active:!0,defaultTags:["Client: ABC"],invoiceGroup:"ACME-SALES",updatedAt:m-20*24*60*60*1e3},{id:"CC-FIN-OPS",code:"FIN-OPS",name:"Finance ops",group:"Finance",active:!0,defaultTags:["Project: Audit-2026"],invoiceGroup:"ACME-MAIN",updatedAt:m-16*24*60*60*1e3},{id:"CC-ADMIN-CORE",code:"ADMIN-CORE",name:"Admin core",group:"Admin",active:!0,defaultTags:["Event: Conference"],invoiceGroup:"ACME-MAIN",updatedAt:m-35*24*60*60*1e3},{id:"CC-PROC-001",code:"PROC-001",name:"Procurement",group:"Procurement",active:!0,defaultTags:["Campaign: VendorOnboarding"],invoiceGroup:"ACME-MAIN",updatedAt:m-10*24*60*60*1e3}]}),[g,y]=d.useState(()=>{const m=Date.now();return[{id:"T-CL-ABC",type:"Client",key:"ABC",label:"Client ABC Ltd",active:!0,updatedAt:m-30*24*60*60*1e3},{id:"T-EV-EXPO",type:"Event",key:"Expo2026",label:"Expo 2026",active:!0,updatedAt:m-4*24*60*60*1e3},{id:"T-CM-Q1",type:"Campaign",key:"Q1Launch",label:"Q1 Launch",active:!0,updatedAt:m-8*24*60*60*1e3},{id:"T-PJ-AUD",type:"Project",key:"Audit-2026",label:"Audit 2026",active:!0,updatedAt:m-18*24*60*60*1e3},{id:"T-OT-OPS",type:"Other",key:"FieldOps",label:"Field operations",active:!0,updatedAt:m-12*24*60*60*1e3}]}),[$,T]=d.useState(()=>{const m=Date.now();return[{id:"CB-001",name:"Client ABC meetings",enabled:!0,priority:1,match:{type:"Client",key:"ABC"},splits:[{costCenterId:"CC-SALES-TR",percent:70},{costCenterId:"CC-OPS-CORE",percent:30}],notes:"Split customer-facing travel between Sales and Operations.",updatedAt:m-9*24*60*60*1e3},{id:"CB-002",name:"Expo 2026 event",enabled:!0,priority:2,match:{type:"Event",key:"Expo2026"},splits:[{costCenterId:"CC-ADMIN-CORE",percent:100}],notes:"All event spend billed to Admin core.",updatedAt:m-3*24*60*60*1e3},{id:"CB-003",name:"Q1 launch campaign",enabled:!0,priority:3,match:{type:"Campaign",key:"Q1Launch"},splits:[{costCenterId:"CC-SALES-TR",percent:50},{costCenterId:"CC-ADMIN-CORE",percent:50}],notes:"Marketing-style campaign split between Sales and Admin.",updatedAt:m-6*24*60*60*1e3}]}),[C,W]=d.useState(""),[L,R]=d.useState(""),[F,te]=d.useState(""),[oe,G]=d.useState(""),[H,Y]=d.useState(!1),[we,q]=d.useState(null),[je,_e]=d.useState(!1),[Ee,be]=d.useState(null),[Fe,Pe]=d.useState(!1),[pe,Q]=d.useState(null),[Re,ce]=d.useState(!1),[xe,he]=d.useState(null),[de,ye]=d.useState(!1),[Ke,Le]=d.useState(25e5),[Ne,ge]=d.useState("Client"),[$e,ie]=d.useState("ABC"),[Oe,Se]=d.useState("Operations"),[Te,Ge]=d.useState(10),We=d.useMemo(()=>{const m={};return o.forEach(S=>m[S.id]=S),m},[o]),ze=d.useMemo(()=>o.reduce((m,S)=>m+S.budgetMonth,0),[o]),Ue=d.useMemo(()=>o.reduce((m,S)=>m+S.spendMTD,0),[o]),le=d.useMemo(()=>o.reduce((m,S)=>m+om(S.spendMTD,7,30),0),[o]),z=d.useMemo(()=>cc(le,ze),[le,ze]),Ae=d.useMemo(()=>{const m=C.trim().toLowerCase(),S=[...o].sort((f,U)=>f.priority-U.priority);return m?S.filter(f=>`${f.id} ${f.manager}`.toLowerCase().includes(m)):S},[o,C]),Ve=d.useMemo(()=>{const m=L.trim().toLowerCase();return m?x.filter(S=>`${S.code} ${S.name} ${S.group} ${S.invoiceGroup}`.toLowerCase().includes(m)):x},[x,L]),Ye=d.useMemo(()=>{const m=F.trim().toLowerCase();return m?g.filter(S=>`${S.type} ${S.key} ${S.label}`.toLowerCase().includes(m)):g},[g,F]),Be=d.useMemo(()=>{const m=oe.trim().toLowerCase(),S=[...$].sort((f,U)=>f.priority-U.priority);return m?S.filter(f=>`${f.name} ${f.match.type} ${f.match.key} ${f.id}`.toLowerCase().includes(m)):S},[$,oe]),w=(m,S)=>{const f=[...o].sort((ve,O)=>ve.priority-O.priority),U=f.findIndex(ve=>ve.id===m),p=U+S;if(U<0||p<0||p>=f.length)return;const M=f[U],ee=f[p],b=Date.now(),ae=f.map(ve=>ve.id===M.id?{...ve,priority:ee.priority,updatedAt:b}:ve.id===ee.id?{...ve,priority:M.priority,updatedAt:b}:ve);c(ae),n({title:"Priority updated",message:"Enforcement priority updated.",kind:"success"})},B=m=>{if(m)q(JSON.parse(JSON.stringify(m)));else{const S=Math.max(...o.map(U=>U.priority)),f=Date.now();q({id:"Operations",budgetMonth:0,spendMTD:0,hardCap:!0,priority:S+1,manager:"",updatedAt:f,weeklySeries:[0,0,0,0,0,0],weeklyBreakdown:{Rides:[0,0,0,0,0,0],Purchases:[0,0,0,0,0,0],Services:[0,0,0,0,0,0],RFQs:[0,0,0,0,0,0]}})}Y(!0)},ue=()=>{if(!we)return;if(!we.manager.trim()){n({title:"Missing manager",message:"Add a manager name.",kind:"warn"});return}const m=Date.now();if(!o.some(f=>f.id===we.id)){n({title:"Demo limitation",message:"This demo edits existing groups. New groups can be added in production.",kind:"info"}),Y(!1);return}c(f=>f.map(U=>U.id===we.id?{...we,updatedAt:m}:U)),Y(!1),n({title:"Saved",message:"Group updated.",kind:"success"})},ne=m=>{if(m)be(JSON.parse(JSON.stringify(m)));else{const S=Date.now();be({id:"",code:"",name:"",group:"Operations",active:!0,defaultTags:[],invoiceGroup:"ACME-MAIN",updatedAt:S})}_e(!0)},Me=()=>{if(!Ee)return;if(!Ee.code.trim()||!Ee.name.trim()){n({title:"Missing fields",message:"Cost center code and name are required.",kind:"warn"});return}const m=Date.now();Ee.id?j(S=>S.map(f=>f.id===Ee.id?{...Ee,updatedAt:m}:f)):j(S=>[{...Ee,id:ch("CC"),updatedAt:m},...S]),_e(!1),n({title:"Saved",message:"Cost center saved.",kind:"success"})},De=m=>{j(S=>S.filter(f=>f.id!==m)),n({title:"Deleted",message:"Cost center removed.",kind:"info"})},fe=m=>{if(m)Q(JSON.parse(JSON.stringify(m)));else{const S=Date.now();Q({id:"",type:"Client",key:"",label:"",active:!0,updatedAt:S})}Pe(!0)},me=()=>{if(!pe)return;if(!pe.key.trim()||!pe.label.trim()){n({title:"Missing fields",message:"Tag key and label are required.",kind:"warn"});return}const m=Date.now();pe.id?y(S=>S.map(f=>f.id===pe.id?{...pe,updatedAt:m}:f)):y(S=>[{...pe,id:ch("T"),updatedAt:m},...S]),Pe(!1),n({title:"Saved",message:"Tag saved.",kind:"success"})},Xe=m=>{y(S=>S.filter(f=>f.id!==m)),n({title:"Deleted",message:"Tag removed.",kind:"info"})},V=m=>{if(m)he(JSON.parse(JSON.stringify(m)));else{const S=Date.now();he({id:"",name:"",enabled:!0,priority:Math.max(1,...$.map(f=>f.priority))+1,match:{type:"Client",key:""},splits:[{costCenterId:"CC-OPS-CORE",percent:100}],notes:"",updatedAt:S})}ce(!0)},E=()=>{if(!xe)return;if(!xe.name.trim()||!xe.match.key.trim()){n({title:"Missing fields",message:"Rule name and match tag key are required.",kind:"warn"});return}const m=dc(xe.splits);if(m!==100){n({title:"Split must equal 100%",message:`Current sum is ${m}%.`,kind:"warn"});return}const S=Date.now();xe.id?T(f=>f.map(U=>U.id===xe.id?{...xe,updatedAt:S}:U)):T(f=>[{...xe,id:ch("CB"),updatedAt:S},...f]),ce(!1),n({title:"Saved",message:"Chargeback rule saved.",kind:"success"})},u=m=>{T(S=>S.filter(f=>f.id!==m)),n({title:"Deleted",message:"Chargeback rule removed.",kind:"info"})},P=d.useMemo(()=>$.filter(f=>f.enabled).filter(f=>f.match.type===Ne&&f.match.key.toLowerCase()===$e.toLowerCase()).sort((f,U)=>f.priority-U.priority),[$,Ne,$e]),se=P[0]||null,D=d.useMemo(()=>se?se.splits.map(m=>({costCenter:x.find(f=>f.id===m.costCenterId)||null,percent:m.percent,amount:Math.round(Ke*m.percent/100)})):[],[se,x,Ke]),re=d.useMemo(()=>{const m=We[Oe],S=om(m.spendMTD,7,30),f=Math.round(m.budgetMonth*(1-Te/100)),U=Math.max(0,S-f),p=cc(S,m.budgetMonth),M=cc(S,f);return{g:m,forecast:S,newBudget:f,potentialSavings:U,tone:p,newTone:M}},[We,Oe,Te]),v=async()=>{const m={groups:o,costCenters:x,tags:g,chargebackRules:$,exportedAt:new Date().toISOString()},S=JSON.stringify(m,null,2);try{await navigator.clipboard.writeText(S),n({title:"Copied",message:"Config JSON copied to clipboard.",kind:"success"})}catch{n({title:"Copy failed",message:"Copy manually.",kind:"warn"})}};return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(bV,{toasts:a,onDismiss:m=>l(S=>S.filter(f=>f.id!==m))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:wr.green},children:e.jsx(La,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Groups and Cost Centers"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Budgets, cost centers, project tags, enforcement priority, and chargeback rules."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(Wt,{label:`Groups: ${o.length}`,tone:"neutral"}),e.jsx(Wt,{label:`Cost centers: ${x.length}`,tone:"neutral"}),e.jsx(Wt,{label:`Tags: ${g.length}`,tone:"neutral"}),e.jsx(Wt,{label:`Budget: ${rl(ze)}`,tone:"neutral"}),e.jsx(Wt,{label:`Spend MTD: ${rl(Ue)}`,tone:"info"}),e.jsx(Wt,{label:`Forecast: ${rl(le)}`,tone:z.tone}),e.jsx(Wt,{label:`Org status: ${z.label}`,tone:z.tone})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(es,{variant:"outline",onClick:()=>ye(!0),children:[e.jsx(ht,{className:"h-4 w-4"})," Simulate chargeback"]}),e.jsxs(es,{variant:"outline",onClick:v,children:[e.jsx(pt,{className:"h-4 w-4"})," Export JSON"]}),r==="Groups"?e.jsxs(es,{variant:"primary",onClick:()=>B(o[0]),children:[e.jsx(Ni,{className:"h-4 w-4"})," Edit group"]}):r==="Cost centers"?e.jsxs(es,{variant:"primary",onClick:()=>ne(),children:[e.jsx(gt,{className:"h-4 w-4"})," Add cost center"]}):r==="Chargeback"?e.jsxs(es,{variant:"primary",onClick:()=>V(),children:[e.jsx(gt,{className:"h-4 w-4"})," Add rule"]}):e.jsxs(es,{variant:"primary",onClick:()=>n({title:"Saved",message:"Forecast settings saved (demo).",kind:"success"}),children:[e.jsx(Da,{className:"h-4 w-4"})," Save"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:["Groups","Cost centers","Chargeback","Forecast"].map(m=>e.jsx("button",{className:on("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",r===m?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:r===m?{background:wr.green}:void 0,onClick:()=>i(m),children:m},m))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[e.jsxs(lt,{mode:"wait",children:[r==="Groups"?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Budget forecasting"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: month-end forecast per group"})]}),e.jsx(Wt,{label:"Premium",tone:"info"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:Ae.slice(0,5).map(m=>{const S=om(m.spendMTD,7,30),f=cc(S,m.budgetMonth);return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:m.id}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Forecast: ",rl(S)," / Budget: ",rl(m.budgetMonth)]})]}),e.jsx(Wt,{label:f.label,tone:f.tone})]}),e.jsx("div",{className:"mt-2",children:e.jsx(Bv,{label:"Forecast vs budget",value:S,total:Math.max(1,m.budgetMonth),hint:`${Math.round(S/Math.max(1,m.budgetMonth)*100)}%`})})]},m.id)})})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"What changed?"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: trend explanations"})]}),e.jsx(Wt,{label:"Premium",tone:"info"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:Ae.slice(0,4).map(m=>{const S=Gv(m);return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:m.id}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:S.title})]}),e.jsx(Wt,{label:"Trend",tone:S.tone})]}),e.jsx("div",{className:"mt-2 text-xs text-slate-700",children:S.body}),e.jsx("div",{className:"mt-2",children:e.jsx(M4,{values:m.weeklySeries})})]},m.id)})})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Groups and budgets"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Groups are departments. Each group has a budget and enforcement priority."})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"w-[260px]",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsx("input",{value:C,onChange:m=>W(m.target.value),placeholder:"Operations, Sales...",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"})]})})]}),e.jsx("div",{className:"mt-4 rounded-2xl border border-slate-200 bg-white",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Priority"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Manager"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Budget"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Spend MTD"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Forecast"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Cap"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Updated"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Actions"})]})}),e.jsx("tbody",{children:Ae.map(m=>{const S=om(m.spendMTD,7,30),f=cc(S,m.budgetMonth);return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Wt,{label:`#${m.priority}`,tone:"neutral"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("button",{className:"rounded-xl border border-slate-200 bg-white px-2 py-1 text-xs font-semibold text-slate-700 hover:bg-slate-50",onClick:()=>w(m.id,-1),children:""}),e.jsx("button",{className:"mt-1 rounded-xl border border-slate-200 bg-white px-2 py-1 text-xs font-semibold text-slate-700 hover:bg-slate-50",onClick:()=>w(m.id,1),children:""})]})]})}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900 whitespace-nowrap",children:m.id}),e.jsx("td",{className:"px-4 py-3 text-slate-700 whitespace-nowrap",children:m.manager}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900 whitespace-nowrap",children:rl(m.budgetMonth)}),e.jsx("td",{className:"px-4 py-3 text-slate-700 whitespace-nowrap",children:rl(m.spendMTD)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-slate-900 whitespace-nowrap",children:rl(S)}),e.jsx(Wt,{label:f.label,tone:f.tone})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Wt,{label:m.hardCap?"Hard":"Soft",tone:m.hardCap?"warn":"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-600 whitespace-nowrap",children:uh(m.updatedAt)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(es,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>B(m),children:[e.jsx(Ni,{className:"h-4 w-4"})," Edit"]}),e.jsxs(es,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Se(m.id),i("Forecast"),n({title:"Scenario",message:"Opened scenario planner.",kind:"info"})},children:[e.jsx(zd,{className:"h-4 w-4"})," Scenario"]})]})})]},m.id)})})]})})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Enforcement priority decides which group budget applies first when rules overlap (chargeback or multi-tag mapping)."})]})]})},"groups"):null,r==="Cost centers"?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Project tags"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Client, event, campaign, project"})]}),e.jsxs(es,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>fe(),children:[e.jsx(gt,{className:"h-4 w-4"})," Add"]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsx("input",{value:F,onChange:m=>te(m.target.value),placeholder:"Client ABC, Expo2026...",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"})]}),e.jsxs("div",{className:"mt-3 space-y-2 max-h-[400px] overflow-y-auto",children:[Ye.slice(0,8).map(m=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:m.label}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[m.type,": ",m.key]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(Wt,{label:m.active?"Active":"Inactive",tone:m.active?"good":"neutral"}),e.jsx(Wt,{label:uh(m.updatedAt),tone:"neutral"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(es,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>fe(m),children:e.jsx(Ni,{className:"h-4 w-4"})}),e.jsx(es,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>Xe(m.id),children:e.jsx(as,{className:"h-4 w-4"})})]})]})},m.id)),Ye.length?null:e.jsx("div",{className:"text-sm text-slate-600",children:"No tags found."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tags are used in chargeback rules and for reporting."})]}),e.jsx("div",{className:"rounded-3xl border border-amber-200 bg-amber-50 p-4 shadow-sm h-fit",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-white text-amber-800 ring-1 ring-amber-200",children:e.jsx(ht,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Premium note"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:"Chargeback rules can split billing by tag and route to invoice groups automatically."})]})]})})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Cost centers"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Cost centers connect spending to invoices, AP codes, and chargeback rules."})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("div",{className:"w-[260px]",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsx("input",{value:L,onChange:m=>R(m.target.value),placeholder:"OPS-CORE, SALES-TRAVEL...",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"})]}),e.jsxs(es,{variant:"primary",onClick:()=>ne(),children:[e.jsx(gt,{className:"h-4 w-4"})," Add"]})]})]}),e.jsx("div",{className:"mt-4 rounded-2xl border border-slate-200 bg-white",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Code"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Name"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Invoice group"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Default tags"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Updated"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Actions"})]})}),e.jsx("tbody",{children:Ve.map(m=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900 whitespace-nowrap",children:m.code}),e.jsx("td",{className:"px-4 py-3 text-slate-700 whitespace-nowrap",children:m.name}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Wt,{label:m.group,tone:"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700 whitespace-nowrap",children:m.invoiceGroup}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[(m.defaultTags||[]).slice(0,3).map(S=>e.jsx(Wt,{label:S,tone:"neutral"},S)),(m.defaultTags||[]).length>3?e.jsx(Wt,{label:`+${(m.defaultTags||[]).length-3}`,tone:"neutral"}):null]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Wt,{label:m.active?"Active":"Inactive",tone:m.active?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-600 whitespace-nowrap",children:uh(m.updatedAt)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(es,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ne(m),children:[e.jsx(Ni,{className:"h-4 w-4"})," Edit"]}),e.jsxs(es,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>De(m.id),children:[e.jsx(as,{className:"h-4 w-4"})," Delete"]})]})})]},m.id))})]})})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Chargeback rules can split billing across cost centers using tag mapping."})]})]})},"cc"):null,r==="Chargeback"?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Simulation"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Test a transaction against chargeback rules."})]}),e.jsx(Wt,{label:"Premium",tone:"info"})]}),e.jsxs(es,{variant:"primary",className:"mt-3 w-full",onClick:()=>ye(!0),children:[e.jsx(ht,{className:"h-4 w-4"})," Open simulator"]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Tip: if multiple rules match, the lowest priority number wins."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Chargeback best practices"}),e.jsxs("ul",{className:"mt-3 space-y-2 text-sm text-slate-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:wr.green}})," Keep rules simple and tag-driven."]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:wr.orange}})," Use priority to avoid ambiguity."]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:wr.green}})," Ensure splits always sum to 100%."]})]})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Chargeback rules"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Split billing by tag mapping. Rules are evaluated by priority."})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("div",{className:"w-[260px]",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsx("input",{value:oe,onChange:m=>G(m.target.value),placeholder:"Client ABC, Expo...",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"})]}),e.jsxs(es,{variant:"primary",onClick:()=>V(),children:[e.jsx(gt,{className:"h-4 w-4"})," Add"]})]})]}),e.jsx("div",{className:"mt-4 rounded-2xl border border-slate-200 bg-white",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Priority"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Rule"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Match"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Split"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Updated"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Actions"})]})}),e.jsx("tbody",{children:Be.map(m=>{const S=dc(m.splits);return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx(Wt,{label:`#${m.priority}`,tone:"neutral"})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900 whitespace-nowrap",children:m.name}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:m.id})]}),e.jsxs("td",{className:"px-4 py-3 text-slate-700 whitespace-nowrap",children:[m.match.type,": ",m.match.key]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(Wt,{label:`${S}%`,tone:S===100?"good":"warn"}),m.splits.slice(0,2).map((f,U)=>{const p=x.find(M=>M.id===f.costCenterId);return e.jsx(Wt,{label:`${(p==null?void 0:p.code)||"CC"}: ${f.percent}%`,tone:"neutral"},U)}),m.splits.length>2?e.jsx(Wt,{label:`+${m.splits.length-2}`,tone:"neutral"}):null]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Wt,{label:m.enabled?"Enabled":"Off",tone:m.enabled?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-600 whitespace-nowrap",children:uh(m.updatedAt)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(es,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>V(m),children:[e.jsx(Ni,{className:"h-4 w-4"})," Edit"]}),e.jsx(es,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{T(f=>f.map(U=>U.id===m.id?{...U,enabled:!U.enabled,updatedAt:Date.now()}:U)),n({title:"Updated",message:`Rule ${m.enabled?"disabled":"enabled"}.`,kind:"success"})},children:m.enabled?"Disable":"Enable"}),e.jsxs(es,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>u(m.id),children:[e.jsx(as,{className:"h-4 w-4"})," Delete"]})]})})]},m.id)})})]})})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Chargeback enforcement is applied at invoicing time. Splits can also be shown live during checkout (Premium)."})]})]})},"chargeback"):null,r==="Forecast"?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Scenario planner"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"If we lower cap by X%, savings estimate"})]}),e.jsx(Wt,{label:"Premium",tone:"info"})]}),e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Group"}),e.jsx("select",{value:Oe,onChange:m=>Se(m.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",children:o.slice().sort((m,S)=>m.priority-S.priority).map(m=>e.jsx("option",{value:m.id,children:m.id},m.id))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Lower cap by"}),e.jsx(Wt,{label:`${Te}%`,tone:"neutral"})]}),e.jsx("input",{type:"range",min:0,max:40,step:5,value:Te,onChange:m=>Ge(Number(m.target.value)),className:"mt-2 w-full"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"This estimates savings as forecast minus new cap (if forecast exceeds cap)."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Current"}),e.jsxs("div",{className:"mt-2 grid grid-cols-1 gap-2",children:[e.jsx(Bv,{label:"Budget",value:re.g.budgetMonth,total:re.g.budgetMonth,hint:rl(re.g.budgetMonth)}),e.jsx(Bv,{label:"Forecast",value:re.forecast,total:Math.max(1,re.g.budgetMonth),hint:rl(re.forecast)})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsx(Wt,{label:`Status: ${re.tone.label}`,tone:re.tone.tone}),e.jsx(Wt,{label:`Hard cap: ${re.g.hardCap?"Yes":"No"}`,tone:re.g.hardCap?"warn":"neutral"})]})]}),e.jsxs("div",{className:"rounded-3xl border border-emerald-200 bg-emerald-50 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-emerald-900",children:"Scenario"}),e.jsxs("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:["New cap: ",rl(re.newBudget)]}),e.jsxs("div",{className:"mt-1 text-sm text-slate-700",children:["Potential savings: ",e.jsx("span",{className:"font-semibold text-slate-900",children:rl(re.potentialSavings)})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsx(Wt,{label:`New status: ${re.newTone.label}`,tone:re.newTone.tone}),e.jsxs(es,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{c(m=>m.map(S=>S.id===Oe?{...S,budgetMonth:re.newBudget,updatedAt:Date.now()}:S)),n({title:"Applied",message:"Scenario cap applied to group budget (demo).",kind:"success"})},children:[e.jsx(ht,{className:"h-4 w-4"})," Apply"]})]})]}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Note: lowering caps can reduce spend but may also block legitimate operations. Consider approvals instead of hard blocks."})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm h-fit",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"What changed"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: driver explanations per group"}),e.jsx("div",{className:"mt-3 space-y-2",children:o.slice().sort((m,S)=>m.priority-S.priority).slice(0,3).map(m=>{const S=Gv(m);return e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:m.id}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:S.body})]}),e.jsx(Wt,{label:"Driver",tone:S.tone})]})},m.id)})})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Budget forecasting per group"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: forecast to month-end using MTD spend."})]}),e.jsx(Wt,{label:"Day 7/30",tone:"neutral"})]}),e.jsx("div",{className:"mt-4 rounded-2xl border border-slate-200 bg-white",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Budget"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Spend MTD"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Forecast"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold whitespace-nowrap",children:"Trend"})]})}),e.jsx("tbody",{children:o.slice().sort((m,S)=>m.priority-S.priority).map(m=>{const S=om(m.spendMTD,7,30),f=cc(S,m.budgetMonth),U=Gv(m);return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900 whitespace-nowrap",children:m.id}),e.jsx("td",{className:"px-4 py-3 text-slate-700 whitespace-nowrap",children:rl(m.budgetMonth)}),e.jsx("td",{className:"px-4 py-3 text-slate-700 whitespace-nowrap",children:rl(m.spendMTD)}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900 whitespace-nowrap",children:rl(S)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Wt,{label:f.label,tone:f.tone})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"text-xs text-slate-600",children:U.title}),e.jsx(M4,{values:m.weeklySeries})]})})]},m.id)})})]})})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Forecasting is a simple extrapolation in this demo. In production, it uses historical patterns per group and seasonality."})]})]})},"forecast"):null]}),e.jsx("div",{className:"mt-4 text-xs text-slate-500",children:"G Groups & Cost Centers v2: groups and budgets, enforcement priority, cost centers, project tags, chargeback rules, forecasting, trend explanations, and scenario planner."})]})]})}),e.jsx(im,{open:H,title:"Edit group",subtitle:"Update group budget, enforcement priority, and manager details.",onClose:()=>Y(!1),actions:[{label:"Save",onClick:ue}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(es,{variant:"outline",onClick:()=>Y(!1),children:"Cancel"}),e.jsxs(es,{variant:"primary",onClick:ue,children:[e.jsx(Da,{className:"h-4 w-4"})," Save"]})]}),children:we?e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Group"}),e.jsx("select",{value:we.id,onChange:m=>q(S=>S&&{...S,id:m.target.value}),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:["Operations","Sales","Finance","Admin","Procurement"].map(m=>e.jsx("option",{value:m,children:m},m))}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Demo: editing existing groups only."})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Manager"}),e.jsx("input",{value:we.manager,onChange:m=>q(S=>S&&{...S,manager:m.target.value}),placeholder:"Manager name",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Monthly budget (UGX)"}),e.jsx("input",{type:"number",value:we.budgetMonth,onChange:m=>q(S=>S&&{...S,budgetMonth:Number(m.target.value||0)}),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Preview: ",rl(we.budgetMonth)]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Enforcement priority"}),e.jsx("input",{type:"number",value:we.priority,onChange:m=>q(S=>S&&{...S,priority:Number(m.target.value||1)}),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Lower number means higher priority."})]}),e.jsxs("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Hard cap"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Block spend when the group budget is exceeded."})]}),e.jsx("button",{type:"button",className:on("relative h-7 w-12 rounded-full border transition",we.hardCap?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>q(m=>m&&{...m,hardCap:!m.hardCap}),"aria-label":"Toggle hard cap",children:e.jsx("span",{className:on("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",we.hardCap?"left-[22px]":"left-1")})})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-white p-3 text-xs text-slate-600",children:"Premium: use scenario planner to estimate savings before applying hard caps."})]})]}):null}),e.jsx(im,{open:je,title:Ee!=null&&Ee.id?"Edit cost center":"Add cost center",subtitle:"Cost centers map spend to invoices, tags, and chargeback rules.",onClose:()=>_e(!1),actions:[{label:"Save",onClick:Me},...Ee!=null&&Ee.id?[{label:"Delete",onClick:()=>{De(Ee.id),_e(!1)},variant:"danger"}]:[]],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(es,{variant:"outline",onClick:()=>_e(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[Ee!=null&&Ee.id?e.jsxs(es,{variant:"danger",onClick:()=>{De(Ee.id),_e(!1)},children:[e.jsx(as,{className:"h-4 w-4"})," Delete"]}):null,e.jsxs(es,{variant:"primary",onClick:Me,children:[e.jsx(Da,{className:"h-4 w-4"})," Save"]})]})]}),maxW:"980px",children:Ee?e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Code"}),e.jsx("input",{value:Ee.code,onChange:m=>be(S=>S&&{...S,code:m.target.value}),placeholder:"OPS-CORE",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Name"}),e.jsx("input",{value:Ee.name,onChange:m=>be(S=>S&&{...S,name:m.target.value}),placeholder:"Operations core",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Group"}),e.jsx("select",{value:Ee.group,onChange:m=>be(S=>S&&{...S,group:m.target.value}),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:["Operations","Sales","Finance","Admin","Procurement"].map(m=>e.jsx("option",{value:m,children:m},m))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Invoice group"}),e.jsx("select",{value:Ee.invoiceGroup,onChange:m=>be(S=>S&&{...S,invoiceGroup:m.target.value}),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:["ACME-MAIN","ACME-SALES","ACME-FIN"].map(m=>e.jsx("option",{value:m,children:m},m))})]}),e.jsx("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Active"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Inactive cost centers are not used for new chargeback splits."})]}),e.jsx("button",{type:"button",className:on("relative h-7 w-12 rounded-full border transition",Ee.active?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>be(m=>m&&{...m,active:!m.active}),"aria-label":"Toggle active",children:e.jsx("span",{className:on("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",Ee.active?"left-[22px]":"left-1")})})]})}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Default tags"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[(Ee.defaultTags||[]).map(m=>e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-slate-50 px-3 py-2 text-xs font-semibold text-slate-700 ring-1 ring-slate-200",children:[m,e.jsx("button",{type:"button",className:"rounded-full p-1 hover:bg-slate-200",onClick:()=>be(S=>S&&{...S,defaultTags:(S.defaultTags||[]).filter(f=>f!==m)}),children:e.jsx(Qe,{className:"h-3.5 w-3.5"})})]},m)),(k=Ee.defaultTags)!=null&&k.length?null:e.jsx(Wt,{label:"No default tags",tone:"neutral"})]}),e.jsxs("div",{className:"mt-3 rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Add from tag library"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:g.filter(m=>m.active).slice(0,8).map(m=>{const S=`${m.type}: ${m.key}`,f=(Ee.defaultTags||[]).includes(S);return e.jsx("button",{type:"button",className:on("rounded-full px-3 py-2 text-xs font-semibold ring-1 transition",f?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:f?{background:wr.green}:void 0,onClick:()=>{be(U=>{if(!U)return U;const p=new Set(U.defaultTags||[]);return p.has(S)?p.delete(S):p.add(S),{...U,defaultTags:Array.from(p)}})},children:S},m.id)})})]}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Default tags are applied when users forget to tag a transaction."})]})]}):null}),e.jsx(im,{open:Fe,title:pe!=null&&pe.id?"Edit tag":"Add tag",subtitle:"Tags power reporting, budgets, and chargeback rules.",onClose:()=>Pe(!1),actions:[{label:"Save",onClick:me},...pe!=null&&pe.id?[{label:"Delete",onClick:()=>{Xe(pe.id),Pe(!1)},variant:"danger"}]:[]],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(es,{variant:"outline",onClick:()=>Pe(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[pe!=null&&pe.id?e.jsxs(es,{variant:"danger",onClick:()=>{Xe(pe.id),Pe(!1)},children:[e.jsx(as,{className:"h-4 w-4"})," Delete"]}):null,e.jsxs(es,{variant:"primary",onClick:me,children:[e.jsx(Da,{className:"h-4 w-4"})," Save"]})]})]}),maxW:"860px",children:pe?e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Type"}),e.jsx("select",{value:pe.type,onChange:m=>Q(S=>S&&{...S,type:m.target.value}),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:["Client","Event","Campaign","Project","Other"].map(m=>e.jsx("option",{value:m,children:m},m))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Key"}),e.jsx("input",{value:pe.key,onChange:m=>Q(S=>S&&{...S,key:m.target.value}),placeholder:"ABC",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Used in chargeback match rules."})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Label"}),e.jsx("input",{value:pe.label,onChange:m=>Q(S=>S&&{...S,label:m.target.value}),placeholder:"Client ABC Ltd",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"})]}),e.jsx("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Active"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Inactive tags do not appear in dropdowns."})]}),e.jsx("button",{type:"button",className:on("relative h-7 w-12 rounded-full border transition",pe.active?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>Q(m=>m&&{...m,active:!m.active}),"aria-label":"Toggle active",children:e.jsx("span",{className:on("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",pe.active?"left-[22px]":"left-1")})})]})})]}):null}),e.jsx(im,{open:Re,title:xe!=null&&xe.id?"Edit chargeback rule":"Add chargeback rule",subtitle:"Split billing by tag mapping. Splits must sum to 100%.",onClose:()=>ce(!1),actions:[{label:"Save",onClick:E},...xe!=null&&xe.id?[{label:"Delete",onClick:()=>{u(xe.id),ce(!1)},variant:"danger"}]:[]],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(es,{variant:"outline",onClick:()=>ce(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[xe!=null&&xe.id?e.jsxs(es,{variant:"danger",onClick:()=>{u(xe.id),ce(!1)},children:[e.jsx(as,{className:"h-4 w-4"})," Delete"]}):null,e.jsxs(es,{variant:"primary",onClick:E,children:[e.jsx(Da,{className:"h-4 w-4"})," Save"]})]})]}),maxW:"980px",children:xe?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Name"}),e.jsx("input",{value:xe.name,onChange:m=>he(S=>S&&{...S,name:m.target.value}),placeholder:"Client ABC meetings",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Priority"}),e.jsx("input",{type:"number",value:xe.priority,onChange:m=>he(S=>S&&{...S,priority:Number(m.target.value||1)}),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Lower number means higher priority."})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Match type"}),e.jsx("select",{value:xe.match.type,onChange:m=>he(S=>S&&{...S,match:{...S.match,type:m.target.value}}),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:["Client","Event","Campaign","Project","Other"].map(m=>e.jsx("option",{value:m,children:m},m))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Match key"}),e.jsx("input",{value:xe.match.key,onChange:m=>he(S=>S&&{...S,match:{...S.match,key:m.target.value}}),placeholder:"ABC",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Split billing"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Percent must sum to 100%."})]}),e.jsx(Wt,{label:`Sum: ${dc(xe.splits)}%`,tone:dc(xe.splits)===100?"good":"warn"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:xe.splits.map((m,S)=>{const f=x.find(U=>U.id===m.costCenterId);return e.jsxs("div",{className:"grid grid-cols-1 gap-3 rounded-2xl border border-slate-200 bg-white p-3 md:grid-cols-12",children:[e.jsxs("div",{className:"md:col-span-7",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Cost center"}),e.jsx("select",{value:m.costCenterId,onChange:U=>{const p=U.target.value;he(M=>{if(!M)return M;const ee={...M};return ee.splits=ee.splits.map((b,ae)=>ae===S?{...b,costCenterId:p}:b),ee})},className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none",children:x.map(U=>e.jsxs("option",{value:U.id,children:[U.code," - ",U.name]},U.id))}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Group: ",f==null?void 0:f.group,"  Invoice group: ",f==null?void 0:f.invoiceGroup]})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Percent"}),e.jsx("input",{type:"number",value:m.percent,onChange:U=>{const p=Number(U.target.value||0);he(M=>{if(!M)return M;const ee={...M};return ee.splits=ee.splits.map((b,ae)=>ae===S?{...b,percent:p}:b),ee})},className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none"})]}),e.jsx("div",{className:"md:col-span-2 flex items-end justify-end",children:e.jsx(es,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>{he(U=>{var M;if(!U)return U;const p={...U};return p.splits=p.splits.filter((ee,b)=>b!==S),p.splits.length||(p.splits=[{costCenterId:((M=x[0])==null?void 0:M.id)||"",percent:100}]),p})},children:e.jsx(as,{className:"h-4 w-4"})})})]},S)})}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(es,{variant:"outline",onClick:()=>{he(m=>{var S;return m&&{...m,splits:[...m.splits,{costCenterId:((S=x[0])==null?void 0:S.id)||"",percent:0}]}})},children:[e.jsx(gt,{className:"h-4 w-4"})," Add split"]}),e.jsxs(es,{variant:"outline",onClick:()=>{he(m=>{if(!m)return m;const S=m.splits.reduce((p,M)=>p+Number(M.percent||0),0);if(!S)return m;const f={...m};f.splits=f.splits.map(p=>({...p,percent:Math.round(p.percent/S*100)}));const U=100-dc(f.splits);return f.splits[0]={...f.splits[0],percent:f.splits[0].percent+U},f}),n({title:"Normalized",message:"Split normalized to 100%.",kind:"success"})},children:[e.jsx(ht,{className:"h-4 w-4"})," Normalize to 100%"]}),e.jsxs(es,{variant:"outline",onClick:()=>ye(!0),children:[e.jsx(ht,{className:"h-4 w-4"})," Test"]})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Notes"}),e.jsx("textarea",{value:xe.notes,onChange:m=>he(S=>S&&{...S,notes:m.target.value}),rows:4,placeholder:"Explain how this rule is used",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 outline-none"}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Best practice: keep a short business reason for every chargeback rule."})]}),e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Enabled"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Disable without deleting to preserve history."})]}),e.jsx("button",{type:"button",className:on("relative h-7 w-12 rounded-full border transition",xe.enabled?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>he(m=>m&&{...m,enabled:!m.enabled}),"aria-label":"Toggle enabled",children:e.jsx("span",{className:on("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",xe.enabled?"left-[22px]":"left-1")})})]})})]}):null}),e.jsx(im,{open:de,title:"Chargeback simulator",subtitle:"Test a tagged transaction and see how it splits across cost centers.",onClose:()=>ye(!1),footer:e.jsx("div",{className:"flex justify-end",children:e.jsx(es,{variant:"outline",onClick:()=>ye(!1),children:"Close"})}),maxW:"980px",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"space-y-4 lg:col-span-1",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Transaction"}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Amount (UGX)"}),e.jsx("input",{type:"number",value:Ke,onChange:m=>Le(Number(m.target.value||0)),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none"}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Preview: ",rl(Ke)]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Tag type"}),e.jsx("select",{value:Ne,onChange:m=>ge(m.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:["Client","Event","Campaign","Project","Other"].map(m=>e.jsx("option",{value:m,children:m},m))})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Tag key"}),e.jsxs("select",{value:$e,onChange:m=>ie(m.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none",children:[g.filter(m=>m.type===Ne&&m.active).map(m=>e.jsxs("option",{value:m.key,children:[m.key," - ",m.label]},m.id)),g.filter(m=>m.type===Ne&&m.active).length===0?e.jsx("option",{value:$e,children:$e}):null]}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Rules match on type and key."})]})]}),e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-amber-50 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-white text-amber-800 ring-1 ring-amber-200",children:e.jsx(ht,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"How this works"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:"The simulator selects the highest priority matching rule and applies the split."})]})]})})]}),e.jsxs("div",{className:"space-y-4 lg:col-span-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Matched rule"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"If none match, the transaction uses the users default cost center (not shown in this demo)."})]}),se?e.jsx(Wt,{label:`#${se.priority}`,tone:"neutral"}):e.jsx(Wt,{label:"No match",tone:"warn"})]}),se?e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsx("div",{className:"font-semibold",children:se.name}),e.jsxs("div",{className:"mt-1 text-slate-600",children:["Match: ",se.match.type,": ",se.match.key]}),e.jsxs("div",{className:"mt-1 text-slate-600",children:["Rule ID: ",se.id]})]}):e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"No enabled chargeback rule matches this tag. Create a rule or change the tag."}),P.length>1?e.jsxs("div",{className:"mt-3 rounded-2xl border border-slate-200 bg-white p-3 text-xs text-slate-600",children:["Multiple matches found. Using highest priority rule.",e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:P.slice(0,6).map(m=>e.jsx(Wt,{label:`#${m.priority} ${m.name}`,tone:"neutral"},m.id))})]}):null]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Split result"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Amounts per cost center (and their invoice group)."})]}),e.jsx(Wt,{label:se?`${dc(se.splits)}%`:"-",tone:se?"good":"neutral"})]}),se?e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Cost center"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Invoice group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Percent"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"})]})}),e.jsx("tbody",{children:D.map((m,S)=>{var f,U,p;return e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:((f=m.costCenter)==null?void 0:f.code)||"Unknown"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Wt,{label:((U=m.costCenter)==null?void 0:U.group)||"-",tone:"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:((p=m.costCenter)==null?void 0:p.invoiceGroup)||"-"}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[m.percent,"%"]}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:rl(m.amount)})]},S)})})]})}):e.jsx("div",{className:"mt-3 text-sm text-slate-600",children:"No split to show."}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: split preview can be displayed at checkout before purchase confirmation."})]})]})]})}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"G Groups & Cost Centers v2 includes groups, budgets, enforcement priority, cost centers, tags, chargeback rules, forecasting, trend explanations, and scenario planning."})})]})}const Ad={green:"#03CD8C",orange:"#F77F00"};function gn(...t){return t.filter(Boolean).join(" ")}function mh(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function P4(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function NV(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function wV(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function dy(t){return JSON.parse(JSON.stringify(t))}function Kt({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:gn("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function cs({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:Ad.green}:t==="accent"?{background:Ad.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:gn(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Sa({enabled:t,onChange:s,label:a,description:l,disabled:n}){return e.jsxs("div",{className:gn("flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",n&&"opacity-60"),children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",disabled:n,className:gn("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white",n&&"cursor-not-allowed"),onClick:()=>!n&&s(!t),"aria-label":a,children:e.jsx("span",{className:gn("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function ci({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",required:i,disabled:o}){const c=!!i&&!s.trim();return e.jsxs("div",{className:gn(o&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"text-xs font-semibold text-slate-600",children:[t,i?e.jsx("span",{className:"text-rose-600",children:" *"}):null]}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,disabled:o,onChange:x=>a(x.target.value),placeholder:l,className:gn("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold shadow-sm outline-none focus:ring-4",o?"border-slate-200 bg-slate-50 text-slate-500":c?"border-rose-300 bg-white text-slate-900 focus:ring-rose-100":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")}),c?e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:"Required"}):null]})}function Dr({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:gn(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,disabled:r,onChange:i=>a(i.target.value),className:gn("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function kV({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700 disabled:opacity-50",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:gn("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function dm({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="920px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[8vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(kV,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function CV({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:gn("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="warn"||a.kind==="error"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function SV(t,s){const a={};t.forEach(n=>a[n]=!1);const l={};return s.forEach(n=>l[n]=!1),{modules:a,marketplaces:l,areas:{dashboard:!0,users:!1,groups:!1,orgSetup:!1,policies:!1,approvals:!1,billing:!1,invoices:!1,integrations:!1,reports:!1,security:!1},actions:{createRFQ:!1,issueBudget:!1,approveSpend:!1,exportReports:!1,toggleSupportMode:!1,adjustInvoice:"none",changeCreditLimit:"none"}}}function uc(t,s){const a=dy(t);return s.modules&&(a.modules={...a.modules,...s.modules}),s.marketplaces&&(a.marketplaces={...a.marketplaces,...s.marketplaces}),s.areas&&(a.areas={...a.areas,...s.areas}),s.actions&&(a.actions={...a.actions,...s.actions}),a}function AV(t,s,a,l){const n=[];return a.forEach(r=>{t.modules[r]!==s.modules[r]&&n.push(`Module ${r}: ${t.modules[r]?"On":"Off"}  ${s.modules[r]?"On":"Off"}`)}),l.forEach(r=>{t.marketplaces[r]!==s.marketplaces[r]&&n.push(`Marketplace ${r}: ${t.marketplaces[r]?"On":"Off"}  ${s.marketplaces[r]?"On":"Off"}`)}),Object.keys(t.areas).forEach(r=>{t.areas[r]!==s.areas[r]&&n.push(`Area ${r}: ${t.areas[r]?"On":"Off"}  ${s.areas[r]?"On":"Off"}`)}),Object.keys(t.actions).forEach(r=>{t.actions[r]!==s.actions[r]&&n.push(`Action ${r}: ${String(t.actions[r])}  ${String(s.actions[r])}`)}),n}function ui(t,s,a){const l={};s.forEach(o=>l[o]=!0);const n={};a.forEach(o=>n[o]=!0);const r={};a.forEach(o=>r[o]=!1);const i={dashboard:!0,users:!0,groups:!0,orgSetup:!0,policies:!0,approvals:!0,billing:!0,invoices:!0,integrations:!0,reports:!0,security:!0};switch(t){case"admin_full":return{name:"Admin full access",description:"Full access across modules, billing, integrations, and security.",permsPatch:{modules:l,marketplaces:n,areas:i,actions:{createRFQ:!0,issueBudget:!0,approveSpend:!0,exportReports:!0,toggleSupportMode:!0,adjustInvoice:"approve",changeCreditLimit:"approve"}},scopePatch:{orgAdminScope:!0,evzoneSupportScope:!1,noSilentActions:!0}};case"manager_ops":return{name:"Manager (operations)",description:"Operational access, approvals, and reporting. No sensitive finance adjustments.",permsPatch:{modules:{...Object.fromEntries(s.map(o=>[o,!1])),"Rides & Logistics":!0,"Travel & Tourism":!0,"Virtual Workspace":!0,"E-Commerce":!0},marketplaces:{...r,MyLiveDealz:!0,ServiceMart:!0,EVmart:!0,ExpressMart:!0},areas:{dashboard:!0,users:!1,groups:!1,orgSetup:!1,policies:!0,approvals:!0,billing:!1,invoices:!1,integrations:!1,reports:!0,security:!1},actions:{createRFQ:!0,issueBudget:!0,approveSpend:!0,exportReports:!0,toggleSupportMode:!1,adjustInvoice:"none",changeCreditLimit:"none"}}};case"accountant_strict":return{name:"Accountant (strict)",description:"Billing, invoices, and reports. Finance adjustments require dual-control.",permsPatch:{modules:{...Object.fromEntries(s.map(o=>[o,!1])),"Finance & Payments":!0,"E-Commerce":!0,"Rides & Logistics":!0,"EVs & Charging":!0},marketplaces:{...r,MyLiveDealz:!0,ServiceMart:!0,EVmart:!0},areas:{dashboard:!0,users:!1,groups:!0,orgSetup:!1,policies:!1,approvals:!0,billing:!0,invoices:!0,integrations:!0,reports:!0,security:!1},actions:{createRFQ:!1,issueBudget:!1,approveSpend:!1,exportReports:!0,toggleSupportMode:!1,adjustInvoice:"request",changeCreditLimit:"request"}}};case"approver_min":return{name:"Approver minimal",description:"Approvals inbox only plus limited reporting.",permsPatch:{modules:{...Object.fromEntries(s.map(o=>[o,!1])),"Rides & Logistics":!0,"E-Commerce":!0,"Finance & Payments":!0},marketplaces:{...r,MyLiveDealz:!0,ServiceMart:!0},areas:{dashboard:!0,users:!1,groups:!1,orgSetup:!1,policies:!1,approvals:!0,billing:!1,invoices:!1,integrations:!1,reports:!0,security:!1},actions:{createRFQ:!1,issueBudget:!1,approveSpend:!0,exportReports:!1,toggleSupportMode:!1,adjustInvoice:"none",changeCreditLimit:"none"}}};case"travel_coordinator":return{name:"Travel coordinator",description:"Book and manage rides, create RFQs for travel services, limited purchases.",permsPatch:{modules:{...Object.fromEntries(s.map(o=>[o,!1])),"Rides & Logistics":!0,"Travel & Tourism":!0,"E-Commerce":!0},marketplaces:{...r,ServiceMart:!0,ExpressMart:!0},areas:{dashboard:!0,users:!1,groups:!1,orgSetup:!1,policies:!1,approvals:!0,billing:!1,invoices:!1,integrations:!1,reports:!1,security:!1},actions:{createRFQ:!0,issueBudget:!1,approveSpend:!1,exportReports:!1,toggleSupportMode:!1,adjustInvoice:"none",changeCreditLimit:"none"}}};case"support_view_only":return{name:"Support view-only",description:"EVzone support can view. No silent actions. Write actions must be requested and visible.",permsPatch:{modules:l,marketplaces:n,areas:{dashboard:!0,users:!0,groups:!0,orgSetup:!0,policies:!0,approvals:!0,billing:!0,invoices:!0,integrations:!0,reports:!0,security:!0},actions:{createRFQ:!1,issueBudget:!1,approveSpend:!1,exportReports:!0,toggleSupportMode:!1,adjustInvoice:"request",changeCreditLimit:"request"}},scopePatch:{orgAdminScope:!1,evzoneSupportScope:!0,noSilentActions:!0}};case"hospital_compliance":return{name:"Hospital compliance pack",description:"Stricter access for health care related spend. More approvals required.",permsPatch:{modules:{...Object.fromEntries(s.map(o=>[o,!1])),"Medical & Health Care":!0,"Rides & Logistics":!0,"Finance & Payments":!0,"Virtual Workspace":!0,"E-Commerce":!0},marketplaces:{...r,HealthMart:!0,ServiceMart:!0,MyLiveDealz:!0},areas:{dashboard:!0,users:!0,groups:!0,orgSetup:!0,policies:!0,approvals:!0,billing:!0,invoices:!0,integrations:!1,reports:!0,security:!0},actions:{createRFQ:!0,issueBudget:!0,approveSpend:!0,exportReports:!0,toggleSupportMode:!1,adjustInvoice:"request",changeCreditLimit:"request"}}};default:return{name:"Template",description:"",permsPatch:{}}}}function qv(t){return t.scope.evzoneSupportScope&&t.scope.noSilentActions}function EV(t,s){const a=t.perms.actions[s];return typeof a=="boolean"?a:a!=="none"}function O4(t,s){return!!t.perms.areas[s]}function zv(t,s){return!!t.perms.modules[s]}function Wv(t,s){return!!t.perms.marketplaces[s]}function xh(t,s,a){return t.filter(l=>l.active&&l.perms.actions[s]===a)}function MV(){var ve,O,X,A;const t=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],s=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],a=["Admin","Manager","Accountant","User","Approver","Travel Coordinator","EVzone Support"],[l,n]=d.useState([]),r=N=>{const h=mh("toast");n(K=>[{id:h,...N},...K].slice(0,4)),window.setTimeout(()=>n(K=>K.filter(_=>_.id!==h)),3200)},[i,o]=d.useState("Roles"),[c,x]=d.useState(!0),[j,g]=d.useState(null),[y,$]=d.useState(""),T=d.useMemo(()=>SV(t,s),[t,s]),C=d.useMemo(()=>{const N=Date.now(),h=(K,_,ke,I,Z,Ce)=>({id:mh("role"),name:K,type:_,base:Ce,description:ke,active:!0,scope:Z,perms:uc(T,I),updatedAt:N-Math.floor(Math.random()*14)*24*60*60*1e3});return[h("Admin","System","Org admin role with broad access.",ui("admin_full",t,s).permsPatch,{orgAdminScope:!0,evzoneSupportScope:!1,noSilentActions:!0},"Admin"),h("Manager","System","Manager role for operational oversight.",ui("manager_ops",t,s).permsPatch,{orgAdminScope:!1,evzoneSupportScope:!1,noSilentActions:!0},"Manager"),h("Accountant","System","Finance role for billing and reporting.",ui("accountant_strict",t,s).permsPatch,{orgAdminScope:!1,evzoneSupportScope:!1,noSilentActions:!0},"Accountant"),h("Approver","System","Approver role for approvals and escalations.",ui("approver_min",t,s).permsPatch,{orgAdminScope:!1,evzoneSupportScope:!1,noSilentActions:!0},"Approver"),h("Travel Coordinator","System","Books travel and coordinates rides.",ui("travel_coordinator",t,s).permsPatch,{orgAdminScope:!1,evzoneSupportScope:!1,noSilentActions:!0},"Travel Coordinator"),h("User","System","Standard user. Uses EVzone apps, CorporatePay appears at checkout.",{modules:{"Rides & Logistics":!0,"E-Commerce":!0,"Finance & Payments":!0},marketplaces:{MyLiveDealz:!0,ServiceMart:!0},areas:{dashboard:!0,approvals:!1,reports:!1},actions:{createRFQ:!1,issueBudget:!1,approveSpend:!1,exportReports:!1,toggleSupportMode:!1,adjustInvoice:"none",changeCreditLimit:"none"}},{orgAdminScope:!1,evzoneSupportScope:!1,noSilentActions:!0},"User"),h("EVzone Support","System","Support-only role. No silent actions.",ui("support_view_only",t,s).permsPatch,{orgAdminScope:!1,evzoneSupportScope:!0,noSilentActions:!0},"EVzone Support"),h("Senior Accountant","Custom","Custom role. Can approve invoice adjustments under dual-control.",{areas:{dashboard:!0,invoices:!0,billing:!0,reports:!0,approvals:!0},actions:{exportReports:!0,adjustInvoice:"approve",changeCreditLimit:"request"},modules:{"Finance & Payments":!0,"E-Commerce":!0},marketplaces:{MyLiveDealz:!0,EVmart:!0}},{orgAdminScope:!1,evzoneSupportScope:!1,noSilentActions:!0},"Accountant"),h("Procurement Approver","Custom","Approver focused on RFQs and purchases.",{areas:{dashboard:!0,approvals:!0,reports:!0},actions:{approveSpend:!0,createRFQ:!0},modules:{"E-Commerce":!0,"Rides & Logistics":!0},marketplaces:{MyLiveDealz:!0,ServiceMart:!0}},{orgAdminScope:!1,evzoneSupportScope:!1,noSilentActions:!0},"Approver")]},[T,t,s]),[W,L]=d.useState(C),[R,F]=d.useState(""),[te,oe]=d.useState(((ve=C[0])==null?void 0:ve.id)||""),G=d.useMemo(()=>W.find(N=>N.id===te)||null,[W,te]),H=d.useMemo(()=>[{id:"admin_full",name:"Admin full access",description:"Full access across modules and security."},{id:"manager_ops",name:"Manager operations",description:"Operational access with approvals and reporting."},{id:"accountant_strict",name:"Accountant strict",description:"Billing and invoices. Sensitive actions require dual-control."},{id:"approver_min",name:"Approver minimal",description:"Approvals focused."},{id:"travel_coordinator",name:"Travel coordinator",description:"Rides and travel programs."},{id:"support_view_only",name:"Support view-only",description:"Support-only. No silent actions."},{id:"hospital_compliance",name:"Hospital compliance pack",description:"More approvals for sensitive categories."}],[]),[Y,we]=d.useState("manager_ops"),[q,je]=d.useState(!1),[_e,Ee]=d.useState([]),[be,Fe]=d.useState(((O=C[0])==null?void 0:O.id)||""),Pe=d.useMemo(()=>W.find(N=>N.id===be)||null,[W,be]),[pe,Q]=d.useState("E-Commerce"),[Re,ce]=d.useState("MyLiveDealz"),[xe,he]=d.useState(()=>({enabled:!0,requireReason:!0,creditChange:{enabled:!0,thresholdUGX:5e6,requireTwoApprovers:!0,requesterRoles:["Accountant","Admin"],approverRoles:["Admin","Senior Accountant"]},invoiceAdjust:{enabled:!0,thresholdUGX:1e6,requireTwoApprovers:!0,requesterRoles:["Accountant","Admin"],approverRoles:["Admin","Senior Accountant"]}})),[de,ye]=d.useState(()=>{const N=Date.now();return[{id:"DL-001",enabled:!0,fromRole:"Approver",delegateRole:"Procurement Approver",startDate:"2026-01-07",endDate:"2026-01-21",appliesTo:{approvals:!0,rfqs:!0,invoices:!1},reason:"Out-of-office coverage for procurement approvals.",createdAt:N-4*24*60*60*1e3}]}),[Ke,Le]=d.useState(!1),[Ne,ge]=d.useState(null),[$e,ie]=d.useState(!1),[Oe,Se]=d.useState(null),[Te,Ge]=d.useState(!1),[We,ze]=d.useState(""),[Ue,le]=d.useState(""),[z,Ae]=d.useState(!1),[Ve,Ye]=d.useState(!1),[Be,w]=d.useState(""),[B,ue]=d.useState(null),ne=N=>{ze(N.title),le(""),Ae(!1),Ye(!!N.secondRequired),w(N.defaultSecondRole||""),ue(()=>N.action),Ge(!0)},Me=()=>{if(Ue.trim().length<8||!z){r({title:"Reason required",message:"Provide a clear reason and confirm acknowledgement.",kind:"warn"});return}if(Ve&&!Be){r({title:"Second approver required",message:"Select a second approver role.",kind:"warn"});return}B==null||B(),Ge(!1)},De=d.useMemo(()=>{const N=R.trim().toLowerCase();return W.filter(h=>N?`${h.name} ${h.type} ${h.base||""}`.toLowerCase().includes(N):!0).sort((h,K)=>{const _=h.type==="System"?0:1,ke=K.type==="System"?0:1;return _!==ke?_-ke:h.name.localeCompare(K.name)})},[W,R]),fe=d.useMemo(()=>W.map(N=>N.name),[W]),me=()=>{if(!G)return;const N=ui(Y,t,s),h=uc(G.perms,N.permsPatch),K=AV(G.perms,h,t,s);Ee(K),je(!0)},Xe=()=>{if(!G)return;const N=ui(Y,t,s),h=uc(G.perms,N.permsPatch),K=N.scopePatch?{...G.scope,...N.scopePatch}:G.scope;ne({title:`Apply template: ${N.name}`,secondRequired:!1,action:()=>{L(_=>_.map(ke=>ke.id===G.id?{...ke,perms:h,scope:K,updatedAt:Date.now()}:ke)),r({title:"Template applied",message:N.name,kind:"success"})}}),je(!1)},V=()=>{const N=Date.now(),h={id:mh("role"),name:"",type:"Custom",base:"User",description:"",active:!0,scope:{orgAdminScope:!1,evzoneSupportScope:!1,noSilentActions:!0},perms:uc(T,{areas:{dashboard:!0},modules:{"Rides & Logistics":!0,"E-Commerce":!0},marketplaces:{ServiceMart:!0}}),updatedAt:N};Se(h),ie(!0)},E=N=>{Se(dy(N)),ie(!0)},u=()=>{if(!Oe)return;const N=Oe.name.trim();if(!N){r({title:"Missing name",message:"Role name is required.",kind:"warn"});return}if(Oe.type==="Custom"&&fe.some(h=>h.toLowerCase()===N.toLowerCase()&&te!==Oe.id)){r({title:"Name exists",message:"Choose a unique role name.",kind:"warn"});return}ne({title:fe.includes(Oe.name)?"Update role":"Create role",action:()=>{L(h=>h.some(_=>_.id===Oe.id)?h.map(_=>_.id===Oe.id?{...Oe,updatedAt:Date.now()}:_):[{...Oe,updatedAt:Date.now()},...h]),oe(Oe.id),r({title:"Saved",message:"Role saved.",kind:"success"})}}),ie(!1)},P=N=>{if(N.type!=="Custom"){r({title:"Blocked",message:"System roles cannot be deleted.",kind:"warn"});return}ne({title:"Delete role",action:()=>{var h;L(K=>K.filter(_=>_.id!==N.id)),te===N.id&&oe(((h=W.find(K=>K.type==="System"))==null?void 0:h.id)||""),r({title:"Deleted",message:"Role removed.",kind:"info"})}})},se=N=>{ge(N?dy(N):{id:mh("DL"),enabled:!0,fromRole:"Approver",delegateRole:"Manager",startDate:"2026-01-07",endDate:"2026-01-14",appliesTo:{approvals:!0,rfqs:!0,invoices:!1},reason:"Coverage",createdAt:Date.now()}),Le(!0)},D=()=>{if(Ne){if(!Ne.reason.trim()){r({title:"Reason required",message:"Add a reason for delegation.",kind:"warn"});return}ne({title:"Save delegation",action:()=>{ye(N=>N.some(K=>K.id===Ne.id)?N.map(K=>K.id===Ne.id?{...Ne}:K):[{...Ne},...N]),r({title:"Saved",message:"Delegation saved.",kind:"success"})}}),Le(!1)}},re=N=>{ne({title:"Delete delegation",action:()=>{ye(h=>h.filter(K=>K.id!==N)),r({title:"Deleted",message:"Delegation removed.",kind:"info"})}})},v=N=>{$(""),g(N)},k=()=>{if(y.trim().length<8){r({title:"Reason required",message:"Provide a clear reason for support mode change.",kind:"warn"});return}ne({title:j==="enable"?"Enable support mode":"Disable support mode",action:()=>{x(j==="enable"),r({title:j==="enable"?"Support enabled":"Support disabled",message:"Audit log updated.",kind:"success"})}}),g(null)},m=d.useMemo(()=>Pe?[{key:"dashboard",label:"Dashboard"},{key:"users",label:"Users"},{key:"groups",label:"Groups"},{key:"orgSetup",label:"Org setup"},{key:"policies",label:"Policy builder"},{key:"approvals",label:"Approvals"},{key:"billing",label:"Billing"},{key:"invoices",label:"Invoices"},{key:"integrations",label:"Integrations"},{key:"reports",label:"Reports"},{key:"security",label:"Security"}]:[],[Pe]),S=d.useMemo(()=>[{key:"createRFQ",label:"Create RFQ"},{key:"issueBudget",label:"Issue budget"},{key:"approveSpend",label:"Approve spend"},{key:"exportReports",label:"Export reports"},{key:"adjustInvoice",label:"Adjust invoice"},{key:"changeCreditLimit",label:"Change credit limit"}],[]),f=N=>{if(!Pe)return;if(Pe.name==="EVzone Support"&&!c){r({title:"Blocked",message:"Support mode is disabled for this organization.",kind:"warn"});return}if(N!=="exportReports"&&N!=="toggleSupportMode"){if(!zv(Pe,pe)){r({title:"Blocked",message:`Module disabled for role: ${pe}`,kind:"warn"});return}if(pe==="E-Commerce"&&!Wv(Pe,Re)){r({title:"Blocked",message:`Marketplace disabled for role: ${Re}`,kind:"warn"});return}}if(qv(Pe)&&N!=="exportReports"){if(N==="adjustInvoice"||N==="changeCreditLimit"){if(Pe.perms.actions[N]==="none"){r({title:"Blocked",message:"Support cannot perform this action. Only request is allowed.",kind:"warn"});return}ne({title:`Support request: ${N}`,secondRequired:!1,action:()=>{r({title:"Ticket created",message:"Support request logged and visible to org admins.",kind:"success"})}});return}r({title:"Blocked",message:"Support cannot perform write actions. Create a ticket instead.",kind:"warn"});return}if(!EV(Pe,N)){r({title:"Denied",message:"Role lacks permission for this action.",kind:"warn"});return}if((N==="adjustInvoice"||N==="changeCreditLimit")&&xe.enabled&&xe.requireReason){const K=N==="adjustInvoice"?xe.invoiceAdjust:xe.creditChange,_=Pe.perms.actions[N],ke=K.enabled&&K.requireTwoApprovers&&_==="approve",I=W.filter(Z=>Z.active).filter(Z=>Z.perms.actions[N]==="approve").map(Z=>Z.name).filter(Z=>Z!==Pe.name);ne({title:`Confirm ${N}`,secondRequired:ke,defaultSecondRole:I[0]||"",action:()=>{r({title:"Submitted",message:ke?"Dual-control: second approval required.":"Action submitted.",kind:"success"})}});return}r({title:"Allowed",message:"Action allowed (demo).",kind:"success"})},U=N=>{G&&L(h=>h.map(K=>K.id===G.id?{...K,...N,updatedAt:Date.now()}:K))},p=N=>{G&&U({perms:uc(G.perms,N)})},M=N=>{G&&U({scope:{...G.scope,...N}})},ee=d.useMemo(()=>W.some(N=>N.name==="EVzone Support"),[W]),b=d.useMemo(()=>{if(!G)return null;const N=t.filter(ke=>G.perms.modules[ke]).length,h=s.filter(ke=>G.perms.marketplaces[ke]).length,K=Object.values(G.perms.areas).filter(Boolean).length,_=Object.entries(G.perms.actions).filter(([,ke])=>typeof ke=="boolean"?ke:ke!=="none").length;return{enabledModules:N,enabledMk:h,enabledAreas:K,actions:_}},[G,t,s]),ae=d.useMemo(()=>W.find(h=>h.name==="Approver")?{title:"Approver inactivity detected",body:"An approver has been inactive. Consider enabling out-of-office delegation to avoid SLA breaches."}:null,[W]);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(CV,{toasts:l,onDismiss:N=>n(h=>h.filter(K=>K.id!==N))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:Ad.green},children:e.jsx(yt,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Roles, Permissions and Admin Governance"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"System roles, custom roles, two-admin model, delegation, templates, simulations, and dual-control."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(Kt,{label:`Roles: ${W.length}`,tone:"neutral"}),e.jsx(Kt,{label:`Support mode: ${c?"Enabled":"Disabled"}`,tone:c?"good":"warn"}),e.jsx(Kt,{label:`Dual-control: ${xe.enabled?"On":"Off"}`,tone:xe.enabled?"info":"neutral"}),e.jsx(Kt,{label:"No silent actions",tone:"neutral"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(cs,{variant:"outline",onClick:()=>o("Simulation"),children:[e.jsx(ay,{className:"h-4 w-4"})," View as role"]}),e.jsxs(cs,{variant:"outline",onClick:V,children:[e.jsx(gt,{className:"h-4 w-4"})," New custom role"]}),e.jsxs(cs,{variant:"primary",onClick:()=>r({title:"Saved",message:"Governance settings saved (demo).",kind:"success"}),children:[e.jsx(Da,{className:"h-4 w-4"})," Save"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:["Roles","Delegation","Dual-control","Simulation"].map(N=>e.jsx("button",{className:gn("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",i===N?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:i===N?{background:Ad.green}:void 0,onClick:()=>o(N),children:N},N))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[i==="Roles"?e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Roles"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"System and custom roles"})]}),e.jsx(Kt,{label:"Core",tone:"neutral"})]}),e.jsxs("div",{className:"mt-3 flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[e.jsx(pa,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:R,onChange:N=>F(N.target.value),placeholder:"Search roles",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:De.map(N=>{const h=N.id===te;return e.jsx("button",{type:"button",onClick:()=>oe(N.id),className:gn("w-full rounded-3xl border p-4 text-left transition",h?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:N.name}),e.jsx(Kt,{label:N.type,tone:N.type==="System"?"neutral":"info"}),N.active?null:e.jsx(Kt,{label:"Disabled",tone:"warn"}),N.scope.evzoneSupportScope?e.jsx(Kt,{label:"Support",tone:"info"}):null]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[N.base?`Base: ${N.base}`:"Custom","  Updated ",wV(N.updatedAt)]})]}),e.jsx(et,{className:"mt-0.5 h-5 w-5 text-slate-400"})]})},N.id)})}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2",children:[e.jsxs(cs,{variant:"outline",onClick:V,children:[e.jsx(gt,{className:"h-4 w-4"})," Create custom role"]}),e.jsxs(cs,{variant:"outline",onClick:()=>{G&&E(G)},disabled:!G||G.type!=="Custom",children:[e.jsx(Da,{className:"h-4 w-4"})," Edit selected role"]}),e.jsxs(cs,{variant:"danger",onClick:()=>G&&P(G),disabled:!G||G.type!=="Custom",children:[e.jsx(as,{className:"h-4 w-4"})," Delete selected role"]})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Two-admin model"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Org admins vs EVzone support scope"})]}),e.jsx(Kt,{label:"Core",tone:"neutral"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Support mode must be enabled for EVzone support to sign in. Support is support-only and has no silent actions."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2",children:[e.jsxs(cs,{variant:c?"danger":"primary",onClick:()=>v(c?"disable":"enable"),children:[e.jsx(yt,{className:"h-4 w-4"})," ",c?"Disable support mode":"Enable support mode"]}),ee?null:e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"EVzone Support role is missing. Add it as a system role in production."})]})]}),ae?e.jsxs("div",{className:"rounded-3xl border border-amber-200 bg-amber-50 p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Governance alert"}),e.jsx("div",{className:"mt-1 text-xs text-slate-700",children:ae.title})]}),e.jsx(Kt,{label:"Premium",tone:"info"})]}),e.jsx("div",{className:"mt-3 text-sm text-slate-700",children:ae.body}),e.jsxs(cs,{variant:"outline",className:"mt-3 w-full",onClick:()=>o("Delegation"),children:[e.jsx(et,{className:"h-4 w-4"})," Open delegation"]})]}):null]}),e.jsx("div",{className:"space-y-4",children:G?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-base font-semibold text-slate-900",children:G.name}),e.jsx(Kt,{label:G.type,tone:G.type==="System"?"neutral":"info"}),G.scope.evzoneSupportScope?e.jsx(Kt,{label:"EVzone Support scope",tone:"info"}):null,G.scope.orgAdminScope?e.jsx(Kt,{label:"Org admin scope",tone:"neutral"}):null,G.scope.noSilentActions?e.jsx(Kt,{label:"No silent actions",tone:"neutral"}):null]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Updated ",NV(G.updatedAt)]}),e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:G.description||"-"}),b?e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsx(Kt,{label:`Modules: ${b.enabledModules}`,tone:"neutral"}),e.jsx(Kt,{label:`Marketplaces: ${b.enabledMk}`,tone:"neutral"}),e.jsx(Kt,{label:`Areas: ${b.enabledAreas}`,tone:"neutral"}),e.jsx(Kt,{label:`Actions: ${b.actions}`,tone:"neutral"})]}):null]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(cs,{variant:"outline",onClick:()=>U({active:!G.active}),children:G.active?"Disable role":"Enable role"}),e.jsxs(cs,{variant:"outline",onClick:me,children:[e.jsx(La,{className:"h-4 w-4"})," Apply template"]}),e.jsxs(cs,{variant:"primary",onClick:()=>r({title:"Saved",message:"Role permissions saved (demo).",kind:"success"}),children:[e.jsx(Da,{className:"h-4 w-4"})," Save"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Scopes"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Two-admin model and safety"})]}),e.jsx(Kt,{label:"Core",tone:"neutral"})]}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsx(Sa,{enabled:G.scope.orgAdminScope,onChange:N=>M({orgAdminScope:N}),label:"Org admin scope",description:"Allows organization-wide configuration actions.",disabled:G.type==="System"&&G.name==="EVzone Support"}),e.jsx(Sa,{enabled:G.scope.evzoneSupportScope,onChange:N=>M({evzoneSupportScope:N}),label:"EVzone support scope",description:"Support-only access. Must not be used by regular org admins.",disabled:G.type==="System"&&G.name!=="EVzone Support"}),e.jsx(Sa,{enabled:G.scope.noSilentActions,onChange:N=>M({noSilentActions:N}),label:"No silent actions",description:"Write actions require visible confirmation and audit."}),qv(G)?e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Support scope with no silent actions: support can view and create requests, but cannot silently change billing."}):null]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Policy-driven templates"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: apply a permission preset"})]}),e.jsx(Kt,{label:"Premium",tone:"info"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3",children:[e.jsx(Dr,{label:"Template",value:Y,onChange:N=>we(N),options:H.map(N=>({value:N.id,label:N.name})),hint:"Preview available"}),e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:(X=H.find(N=>N.id===Y))==null?void 0:X.description}),e.jsxs(cs,{variant:"outline",onClick:me,children:[e.jsx(ay,{className:"h-4 w-4"})," Preview and apply"]})]})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Permissions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Service Modules, Marketplaces, areas, and actions"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(cs,{variant:"outline",onClick:()=>{const N={};t.forEach(h=>N[h]=!0),p({modules:N}),r({title:"Updated",message:"All modules enabled (draft).",kind:"success"})},children:[e.jsx(gt,{className:"h-4 w-4"})," Enable all modules"]}),e.jsxs(cs,{variant:"outline",onClick:()=>{const N={};t.forEach(h=>N[h]=!1),p({modules:N}),r({title:"Updated",message:"All modules disabled (draft).",kind:"info"})},children:[e.jsx(Qe,{className:"h-4 w-4"})," Disable all modules"]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 lg:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Service Modules"}),e.jsx("div",{className:"mt-2 grid grid-cols-1 gap-2 sm:grid-cols-2",children:t.map(N=>e.jsx(Sa,{enabled:G.perms.modules[N],onChange:h=>p({modules:{[N]:h}}),label:N},N))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Marketplaces (E-Commerce)"}),e.jsx(Kt,{label:G.perms.modules["E-Commerce"]?"E-Commerce enabled":"E-Commerce off",tone:G.perms.modules["E-Commerce"]?"good":"warn"})]}),e.jsx("div",{className:gn("mt-2 grid grid-cols-1 gap-2 sm:grid-cols-2",!G.perms.modules["E-Commerce"]&&"opacity-60"),children:s.map(N=>e.jsx(Sa,{enabled:G.perms.marketplaces[N],onChange:h=>p({marketplaces:{[N]:h}}),label:N,disabled:!G.perms.modules["E-Commerce"]},N))}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Marketplace permissions apply only if E-Commerce module is enabled."})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 lg:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Areas"}),e.jsx("div",{className:"mt-2 grid grid-cols-1 gap-2 sm:grid-cols-2",children:Object.keys(G.perms.areas).map(N=>e.jsx(Sa,{enabled:G.perms.areas[N],onChange:h=>p({areas:{[N]:h}}),label:N},N))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Actions"}),e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsx(Sa,{enabled:G.perms.actions.createRFQ,onChange:N=>p({actions:{createRFQ:N}}),label:"Create RFQ"}),e.jsx(Sa,{enabled:G.perms.actions.issueBudget,onChange:N=>p({actions:{issueBudget:N}}),label:"Issue budget"}),e.jsx(Sa,{enabled:G.perms.actions.approveSpend,onChange:N=>p({actions:{approveSpend:N}}),label:"Approve spend"}),e.jsx(Sa,{enabled:G.perms.actions.exportReports,onChange:N=>p({actions:{exportReports:N}}),label:"Export reports"}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Sensitive actions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Premium: dual-control (4-eyes) may apply."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(Dr,{label:"Adjust invoice",value:G.perms.actions.adjustInvoice,onChange:N=>p({actions:{adjustInvoice:N}}),options:[{value:"none",label:"No access"},{value:"request",label:"Request"},{value:"approve",label:"Approve"}],hint:"Dual-control"}),e.jsx(Dr,{label:"Change credit limit",value:G.perms.actions.changeCreditLimit,onChange:N=>p({actions:{changeCreditLimit:N}}),options:[{value:"none",label:"No access"},{value:"request",label:"Request"},{value:"approve",label:"Approve"}],hint:"Dual-control"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Best practice: set these to Request for most roles, and use dual-control to approve."})]})]})]})]})]}),e.jsx("div",{className:"text-xs text-slate-500",children:"Premium: use Simulation tab to see exactly what this role can access."})]}):e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-10 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(yt,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No role selected"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Select a role from the left."})]})})]}):null,i==="Delegation"?e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Approval delegation and out-of-office"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Route approvals when approvers are unavailable."})]}),e.jsx(Kt,{label:"Core",tone:"neutral"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Delegation can apply to approvals, RFQs, and invoice approvals."}),e.jsxs(cs,{variant:"primary",className:"mt-3 w-full",onClick:()=>se(),children:[e.jsx(gt,{className:"h-4 w-4"})," New delegation"]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: show prompts when approver goes inactive, or when SLAs breach."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Suggested policies"}),e.jsxs("ul",{className:"mt-3 space-y-2 text-sm text-slate-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:Ad.green}})," Require reason for every delegation."]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:Ad.orange}})," Avoid delegating to EVzone Support."]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:Ad.green}})," Use end dates and review regularly."]})]})]})]}),e.jsx("div",{children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-4 py-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Delegations"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Active and scheduled delegations"})]}),e.jsxs(cs,{variant:"outline",onClick:()=>se(),children:[e.jsx(gt,{className:"h-4 w-4"})," Add"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"From"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Delegate"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Dates"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Applies to"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsx("tbody",{children:de.map(N=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:N.fromRole}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:N.delegateRole}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[N.startDate," to ",N.endDate]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[N.appliesTo.approvals?e.jsx(Kt,{label:"Approvals",tone:"neutral"}):null,N.appliesTo.rfqs?e.jsx(Kt,{label:"RFQs",tone:"neutral"}):null,N.appliesTo.invoices?e.jsx(Kt,{label:"Invoices",tone:"neutral"}):null]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Kt,{label:N.enabled?"Enabled":"Off",tone:N.enabled?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(cs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>se(N),children:"Edit"}),e.jsx(cs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{ye(h=>h.map(K=>K.id===N.id?{...K,enabled:!K.enabled}:K)),r({title:"Updated",message:`Delegation ${N.enabled?"disabled":"enabled"}.`,kind:"success"})},children:N.enabled?"Disable":"Enable"}),e.jsx(cs,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>re(N.id),children:e.jsx(as,{className:"h-4 w-4"})})]})})]},N.id))})]})}),e.jsx("div",{className:"border-t border-slate-200 px-4 py-3 text-xs text-slate-500",children:"Premium: delegations can be linked to Approval Workflow Builder SLAs."})]})})]}):null,i==="Dual-control"?e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Dual-control (4-eyes)"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: protect sensitive actions"})]}),e.jsx(Kt,{label:"Premium",tone:"info"})]}),e.jsx(Sa,{enabled:xe.enabled,onChange:N=>he(h=>({...h,enabled:N})),label:"Enable dual-control",description:"Apply to invoice adjustments and credit limit changes."}),e.jsx(Sa,{enabled:xe.requireReason,onChange:N=>he(h=>({...h,requireReason:N})),label:"Require reason",description:"Always prompt for a reason in audit logs.",disabled:!xe.enabled}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Best practice: enable dual-control for credit changes and invoice adjustments."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Who can approve?"}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Roles with Approve level for sensitive actions"}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Credit limit approvers"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[xh(W,"changeCreditLimit","approve").map(N=>e.jsx(Kt,{label:N.name,tone:"neutral"},N.id)),xh(W,"changeCreditLimit","approve").length?null:e.jsx(Kt,{label:"None",tone:"warn"})]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Invoice adjust approvers"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[xh(W,"adjustInvoice","approve").map(N=>e.jsx(Kt,{label:N.name,tone:"neutral"},N.id)),xh(W,"adjustInvoice","approve").length?null:e.jsx(Kt,{label:"None",tone:"warn"})]})]})]}),e.jsx("div",{className:"mt-3 text-xs text-slate-500",children:"Tune these in Roles tab under Sensitive actions."})]})]}),e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Credit limit changes"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Configure thresholds and who can request and approve."})]}),e.jsx(Kt,{label:xe.creditChange.enabled?"Enabled":"Off",tone:xe.creditChange.enabled?"good":"neutral"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Sa,{enabled:xe.creditChange.enabled,onChange:N=>he(h=>({...h,creditChange:{...h.creditChange,enabled:N}})),label:"Enable",description:"Enforce dual-control for credit changes",disabled:!xe.enabled}),e.jsx(Sa,{enabled:xe.creditChange.requireTwoApprovers,onChange:N=>he(h=>({...h,creditChange:{...h.creditChange,requireTwoApprovers:N}})),label:"Require 2 approvers",description:"4-eyes for approve-level actions",disabled:!xe.enabled||!xe.creditChange.enabled}),e.jsx(ci,{label:"Threshold (UGX)",value:String(xe.creditChange.thresholdUGX),onChange:N=>he(h=>({...h,creditChange:{...h.creditChange,thresholdUGX:Number(N||0)}})),type:"number",hint:`Example: ${P4(xe.creditChange.thresholdUGX)}`,disabled:!xe.enabled||!xe.creditChange.enabled}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Notes"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"In production, requests above threshold require dual approval and are audit logged."})]})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Invoice adjustments"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Protect invoice edits, credits, and line item corrections."})]}),e.jsx(Kt,{label:xe.invoiceAdjust.enabled?"Enabled":"Off",tone:xe.invoiceAdjust.enabled?"good":"neutral"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Sa,{enabled:xe.invoiceAdjust.enabled,onChange:N=>he(h=>({...h,invoiceAdjust:{...h.invoiceAdjust,enabled:N}})),label:"Enable",description:"Enforce dual-control for invoice adjustments",disabled:!xe.enabled}),e.jsx(Sa,{enabled:xe.invoiceAdjust.requireTwoApprovers,onChange:N=>he(h=>({...h,invoiceAdjust:{...h.invoiceAdjust,requireTwoApprovers:N}})),label:"Require 2 approvers",description:"4-eyes for approve-level actions",disabled:!xe.enabled||!xe.invoiceAdjust.enabled}),e.jsx(ci,{label:"Threshold (UGX)",value:String(xe.invoiceAdjust.thresholdUGX),onChange:N=>he(h=>({...h,invoiceAdjust:{...h.invoiceAdjust,thresholdUGX:Number(N||0)}})),type:"number",hint:`Example: ${P4(xe.invoiceAdjust.thresholdUGX)}`,disabled:!xe.enabled||!xe.invoiceAdjust.enabled}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Notes"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Use invoice group policies to restrict who can request edits."})]})]})]}),e.jsx("div",{className:"rounded-3xl border border-amber-200 bg-amber-50 p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-white text-amber-800 ring-1 ring-amber-200",children:e.jsx(Et,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Dual-control guidance"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:"Grant Approve level only to a small set of roles. Most roles should Request only."})]})]})})]})]}):null,i==="Simulation"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"View as role"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: permission simulation"})]}),e.jsx(Kt,{label:"Premium",tone:"info"})]}),e.jsx(Dr,{label:"Role",value:be,onChange:N=>Fe(N),options:W.map(N=>({value:N.id,label:`${N.name} (${N.type})`}))}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3",children:[e.jsx(Dr,{label:"Module context",value:pe,onChange:N=>Q(N),options:t.map(N=>({value:N,label:N}))}),e.jsx(Dr,{label:"Marketplace context",value:Re,onChange:N=>ce(N),options:s.map(N=>({value:N,label:N})),disabled:pe!=="E-Commerce",hint:pe!=="E-Commerce"?"Applies to E-Commerce":void 0})]}),(Pe==null?void 0:Pe.name)==="EVzone Support"?e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Support role is gated by Support mode. No silent actions. Sensitive actions are requests."}):null,e.jsxs("div",{className:"mt-3 rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-700",children:["Support mode: ",e.jsx("span",{className:"font-semibold text-slate-900",children:c?"Enabled":"Disabled"}),e.jsx("div",{className:"mt-2",children:e.jsxs(cs,{variant:c?"danger":"primary",className:"w-full",onClick:()=>v(c?"disable":"enable"),children:[e.jsx(yt,{className:"h-4 w-4"})," ",c?"Disable support":"Enable support"]})})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Try actions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Attempt actions under current role and context."}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2",children:S.map(N=>e.jsxs(cs,{variant:"outline",onClick:()=>f(N.key),children:[e.jsx(et,{className:"h-4 w-4"})," ",N.label]},N.key))}),e.jsx("div",{className:"mt-3 text-xs text-slate-500",children:"Sensitive actions may require audit reason and a second approver."})]})]}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Access preview"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Pages and modules visible to this role."})]}),e.jsx(Kt,{label:"Simulation",tone:"info"})]}),Pe?e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 lg:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Pages"}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2",children:m.map(N=>e.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:N.label}),e.jsx(Kt,{label:O4(Pe,N.key)?"Allowed":"Hidden",tone:O4(Pe,N.key)?"good":"neutral"})]},String(N.key)))})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Modules"}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2",children:t.map(N=>e.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:N}),e.jsx(Kt,{label:zv(Pe,N)?"On":"Off",tone:zv(Pe,N)?"good":"neutral"})]},N))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"For E-Commerce, marketplace toggles further restrict access."})]})]}):e.jsx("div",{className:"mt-4 text-sm text-slate-600",children:"Select a role."}),Pe&&pe==="E-Commerce"?e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Marketplaces"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Marketplace access for this role"})]}),e.jsx(Kt,{label:"E-Commerce",tone:"neutral"})]}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2 sm:grid-cols-2",children:s.map(N=>e.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:N}),e.jsx(Kt,{label:Wv(Pe,N)?"On":"Off",tone:Wv(Pe,N)?"good":"neutral"})]},N))})]}):null,Pe&&qv(Pe)?e.jsx("div",{className:"mt-4 rounded-3xl border border-amber-200 bg-amber-50 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-white text-amber-800 ring-1 ring-amber-200",children:e.jsx(Et,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Support safety"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:"Support can never perform silent actions. All requests create visible tickets and audit logs."})]})]})}):null]})})]}):null]}),e.jsx("div",{className:"mt-4 text-xs text-slate-500",children:"H Roles, Permissions & Admin Governance v2: system roles, custom roles, module and marketplace permissions, two-admin model, delegation, permission simulation, templates, and dual-control."})]})}),e.jsxs(dm,{open:q,title:"Template preview",subtitle:"See what changes before applying.",onClose:()=>je(!1),actions:[{label:"Apply",onClick:Xe}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(cs,{variant:"outline",onClick:()=>je(!1),children:"Cancel"}),e.jsxs(cs,{variant:"primary",onClick:Xe,children:[e.jsx(La,{className:"h-4 w-4"})," Apply"]})]}),maxW:"980px",children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Template: ",e.jsx("span",{className:"font-semibold text-slate-900",children:(A=H.find(N=>N.id===Y))==null?void 0:A.name})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Changes"}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Showing up to 60 items"}),e.jsxs("div",{className:"mt-3 space-y-2",children:[_e.slice(0,60).map((N,h)=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 text-sm text-slate-700",children:N},h)),_e.length?null:e.jsx("div",{className:"rounded-2xl bg-emerald-50 p-3 text-sm text-emerald-900 ring-1 ring-emerald-200",children:"No changes detected."})]})]})]}),e.jsx(dm,{open:$e,title:(Oe==null?void 0:Oe.type)==="Custom"?fe.includes((Oe==null?void 0:Oe.name)||"")?"Edit custom role":"Create custom role":"Role",subtitle:"Custom roles can be scoped by modules, marketplaces, areas, and actions.",onClose:()=>ie(!1),actions:[{label:"Save",onClick:u}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(cs,{variant:"outline",onClick:()=>ie(!1),children:"Cancel"}),e.jsxs(cs,{variant:"primary",onClick:u,children:[e.jsx(Da,{className:"h-4 w-4"})," Save"]})]}),maxW:"980px",children:Oe?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(ci,{label:"Role name",required:!0,value:Oe.name,onChange:N=>Se(h=>h&&{...h,name:N}),placeholder:"Role name"}),e.jsx(Dr,{label:"Base",value:Oe.base||"User",onChange:N=>Se(h=>h&&{...h,base:N}),options:a.filter(N=>N!=="EVzone Support").map(N=>({value:N,label:N})),hint:"Starter"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(ci,{label:"Description",value:Oe.description,onChange:N=>Se(h=>h&&{...h,description:N}),placeholder:"Description"})})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Quick setup"}),e.jsx("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:["manager_ops","accountant_strict","approver_min","travel_coordinator","hospital_compliance"].map(N=>{var h;return e.jsxs(cs,{variant:"outline",onClick:()=>{const K=ui(N,t,s);Se(_=>_&&{..._,perms:uc(_.perms,K.permsPatch),scope:K.scopePatch?{..._.scope,...K.scopePatch}:_.scope}),r({title:"Template applied",message:K.name,kind:"success"})},children:[e.jsx(ht,{className:"h-4 w-4"})," ",((h=H.find(K=>K.id===N))==null?void 0:h.name)||N]},N)})}),e.jsx("div",{className:"mt-3 text-xs text-slate-600",children:"You can adjust details after applying."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Safety scope"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(Sa,{enabled:Oe.scope.orgAdminScope,onChange:N=>Se(h=>h&&{...h,scope:{...h.scope,orgAdminScope:N}}),label:"Org admin scope"}),e.jsx(Sa,{enabled:Oe.scope.noSilentActions,onChange:N=>Se(h=>h&&{...h,scope:{...h.scope,noSilentActions:N}}),label:"No silent actions"}),e.jsx(Sa,{enabled:Oe.scope.evzoneSupportScope,onChange:N=>Se(h=>h&&{...h,scope:{...h.scope,evzoneSupportScope:N}}),label:"EVzone support scope",description:"Use only for support accounts"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Avoid giving both Org admin scope and EVzone support scope to the same role."})]})]}):null}),e.jsx(dm,{open:Ke,title:Ne!=null&&Ne.id?"Delegation":"New delegation",subtitle:"Approval delegation and out-of-office coverage.",onClose:()=>Le(!1),actions:[{label:"Save",onClick:D}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(cs,{variant:"outline",onClick:()=>Le(!1),children:"Cancel"}),e.jsxs(cs,{variant:"primary",onClick:D,children:[e.jsx(Da,{className:"h-4 w-4"})," Save"]})]}),maxW:"980px",children:Ne?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Dr,{label:"From role",value:Ne.fromRole,onChange:N=>ge(h=>h&&{...h,fromRole:N}),options:W.map(N=>({value:N.name,label:N.name}))}),e.jsx(Dr,{label:"Delegate role",value:Ne.delegateRole,onChange:N=>ge(h=>h&&{...h,delegateRole:N}),options:W.map(N=>({value:N.name,label:N.name}))}),e.jsx(ci,{label:"Start date",value:Ne.startDate,onChange:N=>ge(h=>h&&{...h,startDate:N}),type:"date"}),e.jsx(ci,{label:"End date",value:Ne.endDate,onChange:N=>ge(h=>h&&{...h,endDate:N}),type:"date"})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Applies to"}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-3",children:[{k:"approvals",label:"Approvals"},{k:"rfqs",label:"RFQs"},{k:"invoices",label:"Invoices"}].map(N=>e.jsx(Sa,{enabled:Ne.appliesTo[N.k],onChange:h=>ge(K=>K&&{...K,appliesTo:{...K.appliesTo,[N.k]:h}}),label:N.label},N.k))})]}),e.jsx(ci,{label:"Reason",value:Ne.reason,onChange:N=>ge(h=>h&&{...h,reason:N}),placeholder:"Reason",required:!0}),e.jsx(Sa,{enabled:Ne.enabled,onChange:N=>ge(h=>h&&{...h,enabled:N}),label:Ne.enabled?"Enabled":"Off",description:"Disable without deleting to preserve history"}),e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: this can be connected to out-of-office status in user profiles."})]}):null}),e.jsxs(dm,{open:j!==null,title:j==="enable"?"Enable support mode":"Disable support mode",subtitle:"This change is audited and visible to org admins.",onClose:()=>g(null),actions:[{label:"Confirm",onClick:k,variant:j==="enable"?"default":"danger"}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(cs,{variant:"outline",onClick:()=>g(null),children:"Cancel"}),e.jsxs(cs,{variant:j==="enable"?"primary":"danger",onClick:k,children:[e.jsx(yt,{className:"h-4 w-4"})," Confirm"]})]}),maxW:"860px",children:[e.jsx(ci,{label:"Reason",value:y,onChange:$,placeholder:"Example: allow EVzone to troubleshoot invoice delivery",required:!0,hint:"Minimum 8 characters"}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Support sessions are always audited. No silent actions."})]}),e.jsx(dm,{open:Te,title:We||"Confirm action",subtitle:"Audit-friendly confirmation and reason prompt.",onClose:()=>Ge(!1),actions:[{label:"Confirm",onClick:Me,disabled:Ue.trim().length<8||!z||Ve&&!Be}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(cs,{variant:"outline",onClick:()=>Ge(!1),children:"Cancel"}),e.jsxs(cs,{variant:"primary",onClick:Me,disabled:Ue.trim().length<8||!z||Ve&&!Be,children:[e.jsx(ct,{className:"h-4 w-4"})," Confirm"]})]}),maxW:"980px",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(ci,{label:"Reason",value:Ue,onChange:le,placeholder:"Explain why you are making this change",required:!0,hint:"Minimum 8 characters"}),Ve?e.jsx(Dr,{label:"Second approver role",value:Be,onChange:w,options:W.filter(N=>N.active).map(N=>({value:N.name,label:N.name})),hint:"Dual-control"}):null,e.jsxs("label",{className:"flex items-start gap-3 rounded-2xl border border-slate-200 bg-slate-50 p-3",children:[e.jsx("input",{type:"checkbox",checked:z,onChange:N=>Ae(N.target.checked),className:"mt-1 h-4 w-4 rounded border-slate-300"}),e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"I confirm this action is authorized and will be audit logged."})]}),e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 text-xs text-slate-600",children:"Premium: audit log includes policy versions, role, IP, device, and support watermark."})]})}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"H Roles, Permissions & Admin Governance v2: roles, permissions, templates, simulations, delegation, two-admin model, and dual-control."})})]})}const go={green:"#03CD8C",orange:"#F77F00"};function vs(...t){return t.filter(Boolean).join(" ")}function PV(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function la(t){return JSON.parse(JSON.stringify(t))}function ux(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function ea({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:vs("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Qa({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:go.green}:t==="accent"?{background:go.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:vs(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Gn({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:vs(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:vs("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold shadow-sm outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function Hv({label:t,value:s,onChange:a,hint:l,disabled:n}){return e.jsxs("div",{className:vs(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",value:s,onChange:r=>a(Number(r.target.value||0)),disabled:n,className:vs("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold shadow-sm outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function T4({enabled:t,onChange:s,label:a,description:l,disabled:n}){return e.jsxs("div",{className:vs("flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",n&&"opacity-70"),children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",disabled:n,className:vs("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white",n&&"cursor-not-allowed"),onClick:()=>!n&&s(!t),"aria-label":a,children:e.jsx("span",{className:vs("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function cm({label:t,onRemove:s,tone:a="neutral"}){const l={neutral:"bg-slate-50 text-slate-700 ring-slate-200",good:"bg-emerald-50 text-emerald-800 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200"};return e.jsxs("span",{className:vs("inline-flex items-center gap-2 rounded-full px-3 py-2 text-xs font-semibold ring-1",l[a]),children:[t,s?e.jsx("button",{type:"button",className:"rounded-full p-1 hover:bg-black/5",onClick:s,"aria-label":`Remove ${t}`,children:e.jsx(Qe,{className:"h-3.5 w-3.5"})}):null]})}function mi({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function Ir({enabled:t,onToggle:s}){return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ea,{label:t?"Override":"Inherited",tone:t?"warn":"neutral"}),e.jsx("button",{type:"button",className:vs("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":"Toggle override",children:e.jsx("span",{className:vs("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function OV({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:vs("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function um(t,s,a){const l=la(t),n=r=>{r&&(r.rides&&Object.keys(r.rides).forEach(i=>{l.rides[i]=la(r.rides[i])}),r.purchases&&Object.keys(r.purchases).forEach(i=>{l.purchases[i]=la(r.purchases[i])}))};return n(s),n(a),l}function cy(t,s,a){return!!(t!=null&&t[s])&&Object.prototype.hasOwnProperty.call(t[s],a)}function Xv(t,s,a,l){const n=la(t||{});return n[s]=n[s]||{},n[s][a]=la(l),n}function TV(t,s,a){const l=la(t||{});return l[s]&&Object.prototype.hasOwnProperty.call(l[s],a)&&delete l[s][a],l}function RV(t,s,a,l,n){return a&&cy(a,l,n)?"User":s&&cy(s,l,n)?"Group":(t&&Object.prototype.hasOwnProperty.call(t[l],n),"Org")}function DV(t){const s=[];t.rides.categories.premium&&s.push({title:"Premium rides are enabled",body:"Consider requiring approvals for premium rides or restricting premium to Managers to reduce cost.",tone:"info"}),t.rides.purpose.required||s.push({title:"Purpose tags are not required",body:"Enable purpose tags to improve reconciliation and chargeback reporting.",tone:"info"}),t.rides.geofences.length===0&&s.push({title:"No geofences configured",body:"Add allowed cities, office zones, and airports to prevent unauthorized trips.",tone:"warn"}),Object.entries(t.purchases.allowedModules).filter(([,r])=>r).map(([r])=>r).length===0&&s.push({title:"No service modules allowed",body:"Enable at least one module for purchases/services to use CorporatePay.",tone:"warn"});const l=t.purchases.allowedModules["E-Commerce"],n=Object.entries(t.purchases.allowedMarketplaces).filter(([,r])=>r).map(([r])=>r);return l&&n.length===0&&s.push({title:"E-Commerce is allowed but no marketplaces are allowed",body:"Enable MyLiveDealz and the marts you want to allow, or disable E-Commerce in purchase policy.",tone:"warn"}),l&&t.purchases.vendorAllow.length===0&&s.push({title:"No vendor allowlist",body:"Add preferred vendors to an allowlist for better control and negotiated pricing.",tone:"info"}),t.purchases.maxBasket>5e6&&s.push({title:"High max basket size",body:"Consider lowering max basket size or routing baskets above threshold to approvals.",tone:"warn"}),t.purchases.attachments.required&&t.purchases.attachments.threshold<=0&&s.push({title:"Attachments required but threshold is not set",body:"Set a threshold amount above which attachments are required.",tone:"warn"}),s.length===0&&s.push({title:"Policy looks strong",body:"No critical recommendations right now. Use the simulator to test edge cases.",tone:"good"}),s}function Kv(t,s){const a=(c,x)=>({status:"Allowed",reason:c,nextStep:x}),l=(c,x)=>({status:"Blocked",reason:c,nextStep:x}),n=(c,x)=>({status:"Requires approval",reason:c,nextStep:x});if(s.type==="Ride"){if(!t.rides.categories[s.rideCategory])return l("Ride category is not allowed by policy.","Choose an allowed category or request an exception.");if(t.rides.geofences.length){const y=t.rides.geofences.map(C=>C.name.toLowerCase()),$=y.includes(String(s.origin).toLowerCase()),T=y.includes(String(s.destination).toLowerCase());if(!$||!T)return l("Origin or destination is outside allowed geofences.","Update geofences or use personal payment.")}const c=t.rides.time.days||[];if(c.length&&!c.includes(s.day))return n("Ride is outside allowed days.","Route to manager approval or reschedule.");const x=s.time,j=t.rides.time.start,g=t.rides.time.end;return j&&g&&(x<j||x>g)?n("Ride is outside allowed working hours.","Route to approval or reschedule."):t.rides.purpose.required&&!String(s.purpose||"").trim()?l("Purpose tag is required.","Select a purpose tag and try again."):a("Ride meets policy requirements.","Proceed to checkout.")}if(s.type==="Purchase"){if(!t.purchases.allowedModules[s.module])return l("Service module is not allowed.","Choose an allowed module or use personal payment.");if(s.module==="E-Commerce"){if(s.marketplace==="-")return l("Marketplace is required for E-Commerce purchases.","Select a marketplace.");if(!t.purchases.allowedMarketplaces[s.marketplace])return l("Marketplace is not allowed.","Choose an allowed marketplace or request an exception.")}const c=String(s.vendor||"").trim();if(!c)return l("Vendor is required.","Select a vendor.");if(t.purchases.vendorDeny.map(g=>g.toLowerCase()).includes(c.toLowerCase()))return l("Vendor is denied by policy.","Choose an approved vendor.");if(t.purchases.vendorAllow.length>0&&!t.purchases.vendorAllow.map(y=>y.toLowerCase()).includes(c.toLowerCase()))return l("Vendor is not in allowlist.","Choose an allowlisted vendor or request vendor approval.");const x=String(s.category||"").trim();if(x&&t.purchases.categoriesDeny.map(g=>g.toLowerCase()).includes(x.toLowerCase()))return l("Category is restricted.","Remove restricted items or request exception.");const j=Number(s.total||0);return t.purchases.attachments.required&&j>=t.purchases.attachments.threshold&&!s.attachmentsProvided?l("Attachments are required above threshold.","Attach required documents then retry."):j>t.purchases.maxBasket?n("Basket total exceeds max basket size.","Route to approvals or reduce basket size."):a("Purchase meets policy requirements.","Proceed to checkout.")}if(!t.purchases.allowedModules[s.module])return l("Service module is not allowed.","Choose an allowed module or use personal payment.");const r=String(s.vendor||"").trim();if(!r)return l("Vendor is required.","Select a vendor.");if(t.purchases.vendorDeny.map(c=>c.toLowerCase()).includes(r.toLowerCase()))return l("Vendor is denied by policy.","Choose an approved vendor.");if(t.purchases.vendorAllow.length>0&&!t.purchases.vendorAllow.map(x=>x.toLowerCase()).includes(r.toLowerCase()))return l("Vendor is not in allowlist.","Choose an allowlisted vendor or request vendor approval.");const i=String(s.category||"").trim();if(i&&t.purchases.categoriesDeny.map(c=>c.toLowerCase()).includes(i.toLowerCase()))return l("Category is restricted.","Remove restricted items or request exception.");const o=Number(s.total||0);return t.purchases.attachments.required&&o>=t.purchases.attachments.threshold&&!s.attachmentsProvided?l("Attachments are required above threshold.","Attach required documents then retry."):o>t.purchases.maxBasket?n("Amount exceeds max basket size.","Route to approvals or reduce scope."):a("Service booking meets policy requirements.","Proceed to booking.")}function IV(){const[t,s]=d.useState([]),a=_=>{const ke=PV("toast");s(I=>[{id:ke,..._},...I].slice(0,4)),window.setTimeout(()=>s(I=>I.filter(Z=>Z.id!==ke)),3200)},l=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],n=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],r=[{id:"Operations",name:"Operations"},{id:"Sales",name:"Sales"},{id:"Finance",name:"Finance"},{id:"Admin",name:"Admin"},{id:"Procurement",name:"Procurement"}],i=[{id:"U-1001",name:"Mary N.",email:"mary@acme.com",groupId:"Operations"},{id:"U-1002",name:"Finance Desk",email:"finance@acme.com",groupId:"Finance"},{id:"U-1003",name:"John S.",email:"john@acme.com",groupId:"Sales"},{id:"U-1004",name:"Admin Team",email:"admin@acme.com",groupId:"Admin"},{id:"U-1005",name:"Procurement Desk",email:"procurement@acme.com",groupId:"Procurement"}],[o,c]=d.useState("builder"),[x,j]=d.useState("Org"),[g,y]=d.useState("Operations"),[$,T]=d.useState(i[0].id);d.useEffect(()=>{if(x==="User"){const _=i.find(ke=>ke.id===$);_&&y(_.groupId)}},[x,$,i]);const[C,W]=d.useState(()=>{const _={};l.forEach(I=>_[I]=I!=="Green Investments");const ke={};return n.forEach(I=>ke[I]=I!=="Other Marketplace"),{rides:{categories:{standard:!0,premium:!0},geofences:[{type:"City",name:"Kampala"},{type:"Airport",name:"Entebbe Airport"},{type:"Office Zone",name:"HQ"}],time:{start:"06:00",end:"22:00",days:["Mon","Tue","Wed","Thu","Fri"]},purpose:{required:!0,tags:["Airport","Client meeting","Office commute","Site visit"]}},purchases:{allowedModules:_,allowedMarketplaces:ke,vendorAllow:["Kampala Office Mart","Shenzhen Store","City Courier"],vendorDeny:["Unknown Vendor"],categoriesDeny:["Alcohol"],maxBasket:5e6,attachments:{required:!0,threshold:2e6}}}}),[L,R]=d.useState(()=>({Sales:{rides:{categories:{standard:!0,premium:!1}}}})),[F,te]=d.useState(()=>({"U-1002":{purchases:{maxBasket:12e6,attachments:{required:!0,threshold:5e6}}}})),oe=d.useRef({orgPolicy:la(C),groupOverrides:la(L),userOverrides:la(F),publishedAt:new Date().toISOString()});d.useEffect(()=>{oe.current={orgPolicy:la(C),groupOverrides:la(L),userOverrides:la(F),publishedAt:oe.current.publishedAt||new Date().toISOString(),note:oe.current.note}},[]);const G=d.useMemo(()=>r.find(_=>_.id===g)||r[0],[r,g]),H=d.useMemo(()=>i.find(_=>_.id===$)||i[0],[i,$]),Y=d.useMemo(()=>(x==="Group"||x==="User")&&L[g]||null,[x,g,L]),we=d.useMemo(()=>x==="User"&&F[$]||null,[x,$,F]),q=d.useMemo(()=>um(C,Y,we),[C,Y,we]),je=x!=="Org",_e=d.useMemo(()=>x==="Org"?"Organization policy":x==="Group"?`Group override: ${G.name}`:`User override: ${H.name}`,[x,G,H]),Ee=d.useMemo(()=>x==="Org"?null:x==="Group"?L[g]||{}:F[$]||{},[x,L,g,F,$]),be=(_,ke)=>x==="Org"?!0:cy(Ee||{},_,ke),Fe=(_,ke,I)=>{if(x==="Org")return;const Z=(Ce,He)=>{He(mt=>{const ot=la(mt),Nt=ot[Ce]||{};if(I){const nt=q[_][ke];ot[Ce]=Xv(Nt,_,ke,nt)}else ot[Ce]=TV(Nt,_,ke);return ot})};x==="Group"?Z(g,R):x==="User"&&Z($,te)},Pe=(_,ke,I)=>{if(x==="Org"){W(_==="rides"?Z=>({...Z,rides:{...Z.rides,[ke]:la(I)}}):Z=>({...Z,purchases:{...Z.purchases,[ke]:la(I)}}));return}be(_,ke)&&(x==="Group"&&R(Z=>({...Z,[g]:Xv(Z[g],_,ke,I)})),x==="User"&&te(Z=>({...Z,[$]:Xv(Z[$],_,ke,I)})))},pe=d.useRef(""),Q=()=>{oe.current={orgPolicy:la(C),groupOverrides:la(L),userOverrides:la(F),publishedAt:new Date().toISOString(),note:pe.current},pe.current="",a({title:"Published",message:"Policy published. Impact compares against last published.",kind:"success"})},Re=()=>{const _=oe.current;W(la(_.orgPolicy)),R(la(_.groupOverrides)),te(la(_.userOverrides)),a({title:"Reverted",message:"Reverted to last published version.",kind:"info"})},[ce,xe]=d.useState("City"),[he,de]=d.useState(""),[ye,Ke]=d.useState(""),[Le,Ne]=d.useState(""),[ge,$e]=d.useState("allow"),[ie,Oe]=d.useState(""),[Se,Te]=d.useState(i[0].id),Ge=d.useMemo(()=>i.find(_=>_.id===Se)||i[0],[i,Se]),We=d.useMemo(()=>L[Ge.groupId]||null,[L,Ge]),ze=d.useMemo(()=>F[Ge.id]||null,[F,Ge]),Ue=d.useMemo(()=>um(C,We,ze),[C,We,ze]),[le,z]=d.useState("Ride"),[Ae,Ve]=d.useState("standard"),[Ye,Be]=d.useState("Mon"),[w,B]=d.useState("09:00"),[ue,ne]=d.useState("Kampala"),[Me,De]=d.useState("HQ"),[fe,me]=d.useState("Client meeting"),[Xe,V]=d.useState("E-Commerce"),[E,u]=d.useState("MyLiveDealz"),[P,se]=d.useState("Kampala Office Mart"),[D,re]=d.useState("Office supplies"),[v,k]=d.useState(12e5),[m,S]=d.useState(!1),f=d.useMemo(()=>le==="Ride"?{type:"Ride",rideCategory:Ae,day:Ye,time:w,origin:ue,destination:Me,purpose:fe}:le==="Purchase"?{type:"Purchase",module:Xe,marketplace:Xe==="E-Commerce"?E:"-",vendor:P,category:D,total:v,attachmentsProvided:m}:{type:"Service",module:Xe,vendor:P,category:D,total:v,attachmentsProvided:m},[le,Ae,Ye,w,ue,Me,fe,Xe,E,P,D,v,m]),U=d.useMemo(()=>Kv(Ue,f),[Ue,f]),p=d.useMemo(()=>DV(q),[q]),M=d.useMemo(()=>{const _=oe.current,ke=x==="Org"?i:x==="Group"?i.filter(ot=>ot.groupId===g):i.filter(ot=>ot.id===$),I=[["rides","categories"],["rides","geofences"],["rides","time"],["rides","purpose"],["purchases","allowedModules"],["purchases","allowedMarketplaces"],["purchases","vendorAllow"],["purchases","vendorDeny"],["purchases","categoriesDeny"],["purchases","maxBasket"],["purchases","attachments"]],Z=[],Ce=[{type:"Ride",rideCategory:"premium",day:"Tue",time:"20:00",origin:"Kampala",destination:"HQ",purpose:"Client meeting"},{type:"Ride",rideCategory:"standard",day:"Sun",time:"09:00",origin:"Kampala",destination:"HQ",purpose:"Office commute"},{type:"Purchase",module:"E-Commerce",marketplace:"MyLiveDealz",vendor:"Shenzhen Store",category:"Office supplies",total:8e6,attachmentsProvided:!0},{type:"Purchase",module:"E-Commerce",marketplace:"ServiceMart",vendor:"Unknown Vendor",category:"Alcohol",total:2e5,attachmentsProvided:!1},{type:"Service",module:"EVs & Charging",vendor:"City Courier",category:"Service",total:25e5,attachmentsProvided:!1}],He=[];ke.forEach(ot=>{const Nt=um(_.orgPolicy,_.groupOverrides[ot.groupId]||null,_.userOverrides[ot.id]||null),nt=um(C,L[ot.groupId]||null,F[ot.id]||null),Vs=I.map(([ka,Ot])=>{const Ca=JSON.stringify(Nt[ka][Ot]),Ft=JSON.stringify(nt[ka][Ot]);return Ca!==Ft?`${ka}.${Ot}`:null}).filter(Boolean);Vs.length&&Z.push({user:ot,changed:Vs});let Es=0;Ce.forEach(ka=>{const Ot=Kv(Nt,ka).status,Ca=Kv(nt,ka).status;Ot!==Ca&&(Es+=1)}),He.push({user:ot,changedDecisions:Es})});const mt=He.reduce((ot,Nt)=>ot+Nt.changedDecisions,0);return{totalAffected:ke.length,changedUsers:Z.length,totalChangedDecisions:mt,diffs:Z,behavior:He,publishedAt:_.publishedAt,note:_.note||""}},[x,g,$,i,C,L,F]),[ee,b]=d.useState(i[0].id),ae=d.useMemo(()=>i.find(_=>_.id===ee)||i[0],[i,ee]),ve=d.useMemo(()=>L[ae.groupId]||null,[L,ae]),O=d.useMemo(()=>F[ae.id]||null,[F,ae]),X=d.useMemo(()=>um(C,ve,O),[C,ve,O]),A=[["rides","categories"],["rides","geofences"],["rides","time"],["rides","purpose"],["purchases","allowedModules"],["purchases","allowedMarketplaces"],["purchases","vendorAllow"],["purchases","vendorDeny"],["purchases","categoriesDeny"],["purchases","maxBasket"],["purchases","attachments"]],N=Object.entries(q.purchases.allowedModules).filter(([,_])=>_).map(([_])=>_),h=Object.entries(q.purchases.allowedMarketplaces).filter(([,_])=>_).map(([_])=>_);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(OV,{toasts:t,onDismiss:_=>s(ke=>ke.filter(I=>I.id!==_))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white",children:[e.jsxs("div",{className:"flex flex-col gap-3 px-4 py-4 md:flex-row md:items-start md:justify-between md:px-6",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:go.green},children:e.jsx(yt,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Policy Builder (Rides, Services and Purchases)"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Inheritance: Org  Group  User. Simulator, recommendations, and impact preview included."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(ea,{label:_e,tone:x==="Org"?"info":"warn"}),e.jsx(ea,{label:`Allowed modules: ${N.length}`,tone:"neutral"}),e.jsx(ea,{label:`Allowed marketplaces: ${h.length}`,tone:"neutral"}),e.jsx(ea,{label:`Published: ${new Date(oe.current.publishedAt).toLocaleDateString()}`,tone:"neutral"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Qa,{variant:"outline",onClick:Re,children:[e.jsx(as,{className:"h-4 w-4"})," Revert"]}),e.jsxs(Qa,{variant:"outline",onClick:()=>a({title:"Saved",message:"Draft saved (demo).",kind:"success"}),children:[e.jsx(tt,{className:"h-4 w-4"})," Save draft"]}),e.jsxs(Qa,{variant:"primary",onClick:Q,children:[e.jsx(ct,{className:"h-4 w-4"})," Publish"]})]})]}),e.jsx("div",{className:"px-4 pb-4 md:px-6",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:[{id:"builder",label:"Builder"},{id:"inheritance",label:"Inheritance"},{id:"simulator",label:"Simulator"},{id:"recommendations",label:"Recommendations"},{id:"impact",label:"Impact"}].map(_=>e.jsx("button",{className:vs("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",o===_.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:o===_.id?{background:go.green}:void 0,onClick:()=>c(_.id),children:_.label},_.id))})})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[o==="builder"?e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm h-fit",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Policy scope"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Edit org policy or apply group/user overrides."})]}),e.jsx(ea,{label:x,tone:x==="Org"?"info":"warn"})]}),e.jsx("div",{className:"mt-4 grid grid-cols-3 gap-2 rounded-2xl bg-white p-1 ring-1 ring-slate-200",children:["Org","Group","User"].map(_=>e.jsx("button",{className:vs("rounded-xl px-3 py-2 text-sm font-semibold",x===_?"text-white":"text-slate-700 hover:bg-slate-50"),style:x===_?{background:go.green}:void 0,onClick:()=>j(_),children:_},_))}),x!=="Org"?e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Group"}),e.jsx("select",{value:g,disabled:x==="User",onChange:_=>y(_.target.value),className:vs("mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",x==="User"&&"bg-slate-50 text-slate-500"),children:r.map(_=>e.jsx("option",{value:_.id,children:_.name},_.id))}),x==="User"?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Group is derived from selected user."}):null]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"User"}),e.jsx("select",{value:$,disabled:x!=="User",onChange:_=>T(_.target.value),className:vs("mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",x!=="User"&&"bg-slate-50 text-slate-500"),children:i.map(_=>e.jsxs("option",{value:_.id,children:[_.name," (",_.email,")"]},_.id))}),x!=="User"?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Switch to User scope to override user policy."}):null]}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsx("div",{className:"font-semibold",children:"Inheritance"}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"User overrides override Group overrides override Org policy."})]})]}):e.jsx("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Organization policy is the default for all users unless overridden."}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Publish note (optional)"}),e.jsx("textarea",{defaultValue:"",onChange:_=>pe.current=_.target.value,placeholder:"Example: restrict premium rides for Sales; require attachments above 2M.",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100",rows:3})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Tip: enable overrides only where needed. Keep most rules at Org or Group for consistency."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(mi,{title:"Rides and Logistics policy",subtitle:"Categories, geofences, time windows, and purpose tags.",right:e.jsx(ea,{label:_e,tone:x==="Org"?"info":"warn"}),children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Allowed ride categories"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Standard and Premium."})]}),je?e.jsx(Ir,{enabled:be("rides","categories"),onToggle:_=>Fe("rides","categories",_)}):null]}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:[{key:"standard",label:"Standard"},{key:"premium",label:"Premium"}].map(_=>{const ke=q.rides.categories[_.key],I=je&&!be("rides","categories");return e.jsx("button",{type:"button",disabled:I,className:vs("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",ke?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50",I&&"opacity-60 cursor-not-allowed"),style:ke?{background:go.green}:void 0,onClick:()=>{const Z=la(q.rides.categories);Z[_.key]=!Z[_.key],Pe("rides","categories",Z)},children:_.label},_.key)})}),je&&!be("rides","categories")?e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Enable override to edit."}):null]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Geofences"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Allowed cities, office zones, and airports."})]}),je?e.jsx(Ir,{enabled:be("rides","geofences"),onToggle:_=>Fe("rides","geofences",_)}):null]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[q.rides.geofences.map((_,ke)=>{const I=je&&!be("rides","geofences");return e.jsx(cm,{label:`${_.type}: ${_.name}`,tone:_.type==="Airport"?"info":_.type==="Office Zone"?"good":"neutral",onRemove:I?void 0:()=>{const Z=q.rides.geofences.filter((Ce,He)=>He!==ke);Pe("rides","geofences",Z)}},`${_.type}-${_.name}-${ke}`)}),q.rides.geofences.length?null:e.jsx(ea,{label:"No geofences",tone:"warn"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Type"}),e.jsx("select",{value:ce,disabled:je&&!be("rides","geofences"),onChange:_=>xe(_.target.value),className:vs("mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",je&&!be("rides","geofences")&&"bg-slate-50 text-slate-500"),children:["City","Office Zone","Airport"].map(_=>e.jsx("option",{value:_,children:_},_))})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Gn,{label:"Name",value:he,onChange:de,placeholder:"Example: Kampala",disabled:je&&!be("rides","geofences")})})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Qa,{variant:"outline",onClick:()=>{if(je&&!be("rides","geofences"))return;const ke=he.trim();if(!ke){a({title:"Missing name",message:"Enter a geofence name.",kind:"warn"});return}Pe("rides","geofences",[...q.rides.geofences,{type:ce,name:ke}]),de("")},children:[e.jsx(gt,{className:"h-4 w-4"})," Add"]}),e.jsxs(Qa,{variant:"ghost",onClick:()=>{je&&!be("rides","geofences")||(Pe("rides","geofences",[{type:"City",name:"Kampala"},{type:"City",name:"Entebbe"},{type:"Airport",name:"Entebbe Airport"},{type:"Office Zone",name:"HQ"}]),a({title:"Presets",message:"Geofences presets applied.",kind:"info"}))},children:[e.jsx(ht,{className:"h-4 w-4"})," Presets"]})]}),je&&!be("rides","geofences")?e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Enable override to edit."}):null]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Time windows"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Working hours and allowed days."})]}),je?e.jsx(Ir,{enabled:be("rides","time"),onToggle:_=>Fe("rides","time",_)}):null]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Gn,{label:"Start",value:q.rides.time.start,onChange:_=>Pe("rides","time",{...q.rides.time,start:_}),type:"time",disabled:je&&!be("rides","time")}),e.jsx(Gn,{label:"End",value:q.rides.time.end,onChange:_=>Pe("rides","time",{...q.rides.time,end:_}),type:"time",disabled:je&&!be("rides","time")})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Allowed days"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:"Mon,Tue,Wed,Thu,Fri,Sat,Sun".split(",").map(_=>{const ke=q.rides.time.days.includes(_),I=je&&!be("rides","time");return e.jsx("button",{type:"button",disabled:I,className:vs("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",ke?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50",I&&"opacity-60 cursor-not-allowed"),style:ke?{background:go.green}:void 0,onClick:()=>{const Z=ke?q.rides.time.days.filter(Ce=>Ce!==_):[...q.rides.time.days,_];Pe("rides","time",{...q.rides.time,days:Z})},children:_},_)})}),je&&!be("rides","time")?e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Enable override to edit."}):null]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Purpose tags"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Require purpose and define allowed tags."})]}),je?e.jsx(Ir,{enabled:be("rides","purpose"),onToggle:_=>Fe("rides","purpose",_)}):null]}),e.jsx("div",{className:"mt-3",children:e.jsx(T4,{enabled:q.rides.purpose.required,disabled:je&&!be("rides","purpose"),onChange:_=>Pe("rides","purpose",{...q.rides.purpose,required:_}),label:"Require purpose at checkout",description:"Improves reconciliation and chargeback attribution."})}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Allowed purposes"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[q.rides.purpose.tags.map((_,ke)=>e.jsx(cm,{label:_,onRemove:je&&!be("rides","purpose")?void 0:()=>{const I=q.rides.purpose.tags.filter((Z,Ce)=>Ce!==ke);Pe("rides","purpose",{...q.rides.purpose,tags:I})}},`${_}-${ke}`)),q.rides.purpose.tags.length?null:e.jsx(ea,{label:"No purposes",tone:"warn"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx(Gn,{label:"Add purpose",value:ye,onChange:Ke,placeholder:"Example: Airport",disabled:je&&!be("rides","purpose")})}),e.jsx("div",{className:"flex items-end",children:e.jsxs(Qa,{variant:"outline",className:"w-full",onClick:()=>{if(je&&!be("rides","purpose"))return;const ke=ye.trim();if(!ke){a({title:"Missing purpose",message:"Enter a purpose tag.",kind:"warn"});return}Pe("rides","purpose",{...q.rides.purpose,tags:[...q.rides.purpose.tags,ke]}),Ke("")},children:[e.jsx(gt,{className:"h-4 w-4"})," Add"]})})]}),je&&!be("rides","purpose")?e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Enable override to edit."}):null]})]})]})}),e.jsx(mi,{title:"Purchases and Services policy",subtitle:"Cross-module controls: modules, marketplaces, vendors, categories, basket size, and attachments.",right:e.jsx(ea,{label:_e,tone:x==="Org"?"info":"warn"}),children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Allowed Service Modules"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Where CorporatePay can be used for purchases and services."})]}),je?e.jsx(Ir,{enabled:be("purchases","allowedModules"),onToggle:_=>Fe("purchases","allowedModules",_)}):null]}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2 md:grid-cols-2",children:l.map(_=>{const ke=q.purchases.allowedModules[_],I=je&&!be("purchases","allowedModules");return e.jsx("button",{type:"button",disabled:I,className:vs("rounded-3xl border p-4 text-left transition",ke?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50",I&&"opacity-60 cursor-not-allowed"),onClick:()=>{const Z=la(q.purchases.allowedModules);Z[_]=!Z[_],Pe("purchases","allowedModules",Z)},children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:_}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:ke?"Allowed":"Not allowed"})]}),e.jsx(ea,{label:ke?"On":"Off",tone:ke?"good":"neutral"})]})},_)})}),je&&!be("purchases","allowedModules")?e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Enable override to edit."}):null]}),e.jsxs("div",{className:vs("rounded-3xl border border-slate-200 bg-white p-4",!q.purchases.allowedModules["E-Commerce"]&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Allowed Marketplaces (E-Commerce)"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"MyLiveDealz and marts, plus Other Marketplace."})]}),je?e.jsx(Ir,{enabled:be("purchases","allowedMarketplaces"),onToggle:_=>Fe("purchases","allowedMarketplaces",_)}):null]}),q.purchases.allowedModules["E-Commerce"]?e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2 md:grid-cols-2",children:n.map(_=>{const ke=q.purchases.allowedMarketplaces[_],I=je&&!be("purchases","allowedMarketplaces");return e.jsx("button",{type:"button",disabled:I,className:vs("rounded-3xl border p-4 text-left transition",ke?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50",I&&"opacity-60 cursor-not-allowed"),onClick:()=>{const Z=la(q.purchases.allowedMarketplaces);Z[_]=!Z[_],Pe("purchases","allowedMarketplaces",Z)},children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:_}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:ke?"Allowed":"Not allowed"})]}),e.jsx(ea,{label:ke?"On":"Off",tone:ke?"good":"neutral"})]})},_)})}):e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Enable E-Commerce in Allowed Service Modules to use marketplace controls."}),je&&!be("purchases","allowedMarketplaces")?e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Enable override to edit."}):null]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Vendor allowlist and denylist"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Allow preferred vendors and block risky ones."})]}),je?e.jsx(Ir,{enabled:be("purchases","vendorAllow")||be("purchases","vendorDeny"),onToggle:_=>{Fe("purchases","vendorAllow",_),Fe("purchases","vendorDeny",_)}}):null]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Allowlist"}),e.jsx(ea,{label:q.purchases.vendorAllow.length?`${q.purchases.vendorAllow.length}`:"None",tone:q.purchases.vendorAllow.length?"good":"neutral"})]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:q.purchases.vendorAllow.map((_,ke)=>{const I=je&&!(be("purchases","vendorAllow")||be("purchases","vendorDeny"));return e.jsx(cm,{label:_,tone:"good",onRemove:I?void 0:()=>{const Z=q.purchases.vendorAllow.filter((Ce,He)=>He!==ke);Pe("purchases","vendorAllow",Z)}},`${_}-${ke}`)})})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Denylist"}),e.jsx(ea,{label:q.purchases.vendorDeny.length?`${q.purchases.vendorDeny.length}`:"None",tone:q.purchases.vendorDeny.length?"warn":"neutral"})]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:q.purchases.vendorDeny.map((_,ke)=>{const I=je&&!(be("purchases","vendorAllow")||be("purchases","vendorDeny"));return e.jsx(cm,{label:_,tone:"warn",onRemove:I?void 0:()=>{const Z=q.purchases.vendorDeny.filter((Ce,He)=>He!==ke);Pe("purchases","vendorDeny",Z)}},`${_}-${ke}`)})})]})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Add mode"}),e.jsxs("select",{value:ge,onChange:_=>$e(_.target.value),disabled:je&&!(be("purchases","vendorAllow")||be("purchases","vendorDeny")),className:vs("mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",je&&!(be("purchases","vendorAllow")||be("purchases","vendorDeny"))&&"bg-slate-50 text-slate-500"),children:[e.jsx("option",{value:"allow",children:"Allowlist"}),e.jsx("option",{value:"deny",children:"Denylist"})]})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Gn,{label:"Vendor name",value:Le,onChange:Ne,placeholder:"Example: Shenzhen Store",disabled:je&&!(be("purchases","vendorAllow")||be("purchases","vendorDeny"))})})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Qa,{variant:"outline",onClick:()=>{if(je&&!(be("purchases","vendorAllow")||be("purchases","vendorDeny")))return;const ke=Le.trim();if(!ke){a({title:"Missing vendor",message:"Enter a vendor name.",kind:"warn"});return}ge==="allow"?Pe("purchases","vendorAllow",[...q.purchases.vendorAllow,ke]):Pe("purchases","vendorDeny",[...q.purchases.vendorDeny,ke]),Ne("")},children:[e.jsx(gt,{className:"h-4 w-4"})," Add vendor"]}),e.jsxs(Qa,{variant:"ghost",onClick:()=>{je&&!(be("purchases","vendorAllow")||be("purchases","vendorDeny"))||(Pe("purchases","vendorAllow",["Kampala Office Mart","Shenzhen Store","City Courier"]),a({title:"Presets",message:"Preferred vendors applied.",kind:"info"}))},children:[e.jsx(ht,{className:"h-4 w-4"})," Preferred presets"]})]}),je&&!(be("purchases","vendorAllow")||be("purchases","vendorDeny"))?e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Enable override to edit."}):null]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Category restrictions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Block categories like Alcohol."})]}),je?e.jsx(Ir,{enabled:be("purchases","categoriesDeny"),onToggle:_=>Fe("purchases","categoriesDeny",_)}):null]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[q.purchases.categoriesDeny.map((_,ke)=>e.jsx(cm,{label:_,tone:"warn",onRemove:je&&!be("purchases","categoriesDeny")?void 0:()=>{const I=q.purchases.categoriesDeny.filter((Z,Ce)=>Ce!==ke);Pe("purchases","categoriesDeny",I)}},`${_}-${ke}`)),q.purchases.categoriesDeny.length?null:e.jsx(ea,{label:"No restrictions",tone:"neutral"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx(Gn,{label:"Add restricted category",value:ie,onChange:Oe,placeholder:"Example: Alcohol",disabled:je&&!be("purchases","categoriesDeny")})}),e.jsx("div",{className:"flex items-end",children:e.jsxs(Qa,{variant:"outline",className:"w-full",onClick:()=>{if(je&&!be("purchases","categoriesDeny"))return;const ke=ie.trim();if(!ke){a({title:"Missing category",message:"Enter a category.",kind:"warn"});return}Pe("purchases","categoriesDeny",[...q.purchases.categoriesDeny,ke]),Oe("")},children:[e.jsx(gt,{className:"h-4 w-4"})," Add"]})})]}),je&&!be("purchases","categoriesDeny")?e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Enable override to edit."}):null]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Max basket size"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Amounts above this require approval."})]}),je?e.jsx(Ir,{enabled:be("purchases","maxBasket"),onToggle:_=>Fe("purchases","maxBasket",_)}):null]}),e.jsxs("div",{className:"mt-3",children:[e.jsx(Hv,{label:"Max basket (UGX)",value:q.purchases.maxBasket,onChange:_=>Pe("purchases","maxBasket",_),hint:`Current: ${ux(q.purchases.maxBasket)}`,disabled:je&&!be("purchases","maxBasket")}),je&&!be("purchases","maxBasket")?e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Enable override to edit."}):null]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Attachments requirement"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Require attachments above threshold."})]}),je?e.jsx(Ir,{enabled:be("purchases","attachments"),onToggle:_=>Fe("purchases","attachments",_)}):null]}),e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsx(T4,{enabled:q.purchases.attachments.required,onChange:_=>Pe("purchases","attachments",{...q.purchases.attachments,required:_}),label:"Require attachments",description:"Applies to purchases and services above threshold",disabled:je&&!be("purchases","attachments")}),e.jsx(Hv,{label:"Threshold amount (UGX)",value:q.purchases.attachments.threshold,onChange:_=>Pe("purchases","attachments",{...q.purchases.attachments,threshold:_}),hint:"If total  threshold, attachments are required",disabled:je&&!be("purchases","attachments")}),je&&!be("purchases","attachments")?e.jsx("div",{className:"text-xs text-slate-500",children:"Enable override to edit."}):null]})]})]}),e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Use the Simulator tab to test edge cases: denied vendors, restricted categories, and missing attachments."})]})})]})]}):null,o==="inheritance"?e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Pick a user to inspect"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Shows effective values and source (Org/Group/User)."}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"User"}),e.jsx("select",{value:ee,onChange:_=>b(_.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",children:i.map(_=>e.jsxs("option",{value:_.id,children:[_.name," (",_.email,")"]},_.id))}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Group: ",ae.groupId]})]}),e.jsxs("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Chain: Org  Group (",ae.groupId,")  User"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(mi,{title:"Inheritance summary",subtitle:"Source of each effective field",right:e.jsx(ea,{label:"Explainable",tone:"info"}),children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Field"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Effective"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Source"})]})}),e.jsx("tbody",{children:A.map(([_,ke])=>{const I=RV(C,ve,O,_,ke),Z=X[_][ke],Ce=$V(ke,Z);return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3 font-semibold text-slate-900",children:[_,".",ke]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Ce}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ea,{label:I,tone:I==="Org"?"neutral":I==="Group"?"warn":"info"})})]},`${_}.${ke}`)})})]})})}),e.jsx(mi,{title:"Effective policy JSON",subtitle:"Computed policy used for enforcement",right:e.jsxs(Qa,{variant:"outline",onClick:()=>a({title:"Export",message:"Export policy (demo).",kind:"info"}),children:[e.jsx(kt,{className:"h-4 w-4"})," Export"]}),children:e.jsx("pre",{className:"max-h-[360px] overflow-auto rounded-2xl border border-slate-200 bg-white p-3 text-xs text-slate-800",children:JSON.stringify(X,null,2)})})]})]}):null,o==="simulator"?e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Simulation context"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Choose a user to simulate with their effective policy."}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"User"}),e.jsx("select",{value:Se,onChange:_=>Te(_.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",children:i.map(_=>e.jsxs("option",{value:_.id,children:[_.name," (",_.email,")"]},_.id))}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Group: ",Ge.groupId]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Type"}),e.jsx("div",{className:"mt-2 grid grid-cols-3 gap-2 rounded-2xl bg-white p-1 ring-1 ring-slate-200",children:["Ride","Purchase","Service"].map(_=>e.jsx("button",{className:vs("rounded-xl px-3 py-2 text-sm font-semibold",le===_?"text-white":"text-slate-700 hover:bg-slate-50"),style:le===_?{background:go.green}:void 0,onClick:()=>z(_),children:_},_))})]}),e.jsxs("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Simulator rules:",e.jsxs("ul",{className:"mt-2 space-y-1 text-xs text-slate-600",children:[e.jsx("li",{children:"1) Denied vendor or restricted category is blocked"}),e.jsx("li",{children:"2) Missing attachments above threshold is blocked"}),e.jsx("li",{children:"3) Over max basket requires approval"}),e.jsx("li",{children:"4) Outside working hours may require approval"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(mi,{title:"Scenario inputs",subtitle:"Set inputs and run the simulator",right:e.jsxs(Qa,{variant:"primary",onClick:()=>a({title:"Simulated",message:`Result: ${U.status}`,kind:U.status==="Allowed"?"success":U.status==="Blocked"?"warn":"info"}),children:[e.jsx(qp,{className:"h-4 w-4"})," Run"]}),children:[le==="Ride"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Ride category"}),e.jsxs("select",{value:Ae,onChange:_=>Ve(_.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",children:[e.jsx("option",{value:"standard",children:"Standard"}),e.jsx("option",{value:"premium",children:"Premium"})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Day"}),e.jsx("select",{value:Ye,onChange:_=>Be(_.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",children:"Mon,Tue,Wed,Thu,Fri,Sat,Sun".split(",").map(_=>e.jsx("option",{value:_,children:_},_))})]}),e.jsx(Gn,{label:"Time",value:w,onChange:B,type:"time"}),e.jsx(Gn,{label:"Origin",value:ue,onChange:ne,placeholder:"Kampala",hint:"Match geofence names"}),e.jsx(Gn,{label:"Destination",value:Me,onChange:De,placeholder:"HQ",hint:"Match geofence names"}),e.jsx(Gn,{label:"Purpose",value:fe,onChange:me,placeholder:"Client meeting",hint:"Required if policy requires"})]}):null,le!=="Ride"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Service module"}),e.jsx("select",{value:Xe,onChange:_=>{const ke=_.target.value;V(ke),ke!=="E-Commerce"&&u("MyLiveDealz")},className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",children:l.map(_=>e.jsx("option",{value:_,children:_},_))})]}),e.jsxs("div",{className:vs(Xe!=="E-Commerce"&&"opacity-70"),children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Marketplace"}),e.jsx("select",{value:E,onChange:_=>u(_.target.value),disabled:Xe!=="E-Commerce",className:vs("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none",Xe==="E-Commerce"?"border-slate-200 bg-white text-slate-900 focus:ring-4 focus:ring-emerald-100":"border-slate-200 bg-slate-50 text-slate-500"),children:n.map(_=>e.jsx("option",{value:_,children:_},_))})]}),e.jsx(Gn,{label:"Vendor",value:P,onChange:se,placeholder:"Kampala Office Mart"}),e.jsx(Gn,{label:"Category",value:D,onChange:re,placeholder:"Office supplies",hint:"Restricted categories are blocked"}),e.jsx(Hv,{label:"Total amount (UGX)",value:v,onChange:k,hint:`Max basket: ${ux(Ue.purchases.maxBasket)}`}),e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 md:col-span-2",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Attachments provided"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Required above ",ux(Ue.purchases.attachments.threshold)," when enabled."]})]}),e.jsx("button",{type:"button",className:vs("relative h-7 w-12 rounded-full border transition",m?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>S(_=>!_),"aria-label":"Toggle attachments",children:e.jsx("span",{className:vs("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",m?"left-[22px]":"left-1")})})]})})]}):null]}),e.jsxs(mi,{title:"Simulation result",subtitle:"Decision, reason, and next step",right:e.jsx(ea,{label:U.status,tone:U.status==="Allowed"?"good":U.status==="Blocked"?"bad":"warn"}),children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Reason"}),e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:U.reason}),e.jsx("div",{className:"mt-4 text-sm font-semibold text-slate-900",children:"Next step"}),e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:U.nextStep})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Simulator is a preview tool. Real enforcement uses policy engine and approvals workflow."})]}),e.jsx(mi,{title:"Effective policy snapshot",subtitle:"Policy used for this simulation",right:e.jsxs(Qa,{variant:"outline",onClick:()=>c("inheritance"),children:[e.jsx(La,{className:"h-4 w-4"})," Inheritance"]}),children:e.jsx("pre",{className:"max-h-[320px] overflow-auto rounded-2xl border border-slate-200 bg-white p-3 text-xs text-slate-800",children:JSON.stringify(Ue,null,2)})})]})]}):null,o==="recommendations"?e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Recommendations"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Generated from current effective policy for the selected scope."}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Apply changes in Builder and validate in Simulator."}),e.jsxs(Qa,{variant:"primary",className:"mt-4 w-full",onClick:()=>c("builder"),children:[e.jsx(yt,{className:"h-4 w-4"})," Open builder"]})]}),e.jsx("div",{className:"space-y-3",children:p.map((_,ke)=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:_.title}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:_.body})]}),e.jsx(ea,{label:_.tone==="good"?"OK":_.tone==="warn"?"Warning":"Info",tone:_.tone})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Qa,{variant:"outline",className:"text-xs",onClick:()=>c("builder"),children:[e.jsx(et,{className:"h-4 w-4"})," Adjust policy"]}),e.jsxs(Qa,{variant:"outline",className:"text-xs",onClick:()=>c("simulator"),children:[e.jsx(qp,{className:"h-4 w-4"})," Test"]}),e.jsxs(Qa,{variant:"outline",className:"text-xs",onClick:()=>c("impact"),children:[e.jsx(kt,{className:"h-4 w-4"})," Preview impact"]})]})]},ke))})]}):null,o==="impact"?e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Impact preview"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Compares current draft against last published version."}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3",children:[e.jsx(K,{title:"Affected users",value:String(M.totalAffected),icon:e.jsx(Os,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(K,{title:"Users with changes",value:String(M.changedUsers),icon:e.jsx(ht,{className:"h-5 w-5"}),tone:M.changedUsers?"warn":"good"}),e.jsx(K,{title:"Changed decisions",value:String(M.totalChangedDecisions),icon:e.jsx(qp,{className:"h-5 w-5"}),tone:M.totalChangedDecisions?"warn":"good"})]}),e.jsxs("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Published at: ",new Date(M.publishedAt).toLocaleString(),M.note?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Last note: ",M.note]}):null]}),e.jsxs(Qa,{variant:"primary",className:"mt-4 w-full",onClick:Q,children:[e.jsx(ct,{className:"h-4 w-4"})," Publish"]}),e.jsxs(Qa,{variant:"outline",className:"mt-2 w-full",onClick:Re,children:[e.jsx(as,{className:"h-4 w-4"})," Revert"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(mi,{title:"Changed users",subtitle:"Who is affected and which fields changed",right:e.jsx(ea,{label:`${M.changedUsers} users`,tone:M.changedUsers?"warn":"good"}),children:M.diffs.length?e.jsx("div",{className:"space-y-2",children:M.diffs.map(_=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:_.user.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[_.user.email,"  Group: ",_.user.groupId]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[_.changed.slice(0,8).map(ke=>e.jsx(ea,{label:ke,tone:"neutral"},ke)),_.changed.length>8?e.jsx(ea,{label:`+${_.changed.length-8}`,tone:"neutral"}):null]})]}),e.jsxs(Qa,{variant:"outline",className:"text-xs",onClick:()=>{Te(_.user.id),c("simulator")},children:[e.jsx(qp,{className:"h-4 w-4"})," Simulate"]})]})},_.user.id))}):e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(tt,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No impact"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Your draft matches the last published version for this scope."})]})}),e.jsxs(mi,{title:"Behavior preview",subtitle:"How many simulated decisions changed",right:e.jsx(ea,{label:`${M.totalChangedDecisions} changed`,tone:M.totalChangedDecisions?"warn":"good"}),children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"User"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Changed decisions"})]})}),e.jsx("tbody",{children:M.behavior.map(_=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:_.user.name}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:_.user.groupId}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ea,{label:String(_.changedDecisions),tone:_.changedDecisions?"warn":"good"})})]},_.user.id))})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"This preview uses a small test set. For production, run impact analysis on real historical transactions."})]})]})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"I Policy Builder v2: inheritance (Org  Group  User), rides and purchase/service policies, required attachments above threshold, simulator, recommendations, and change impact preview."})})]})})]});function K({title:_,value:ke,icon:I,tone:Z}){const Ce=Z==="bad"?"bg-rose-50 text-rose-700":Z==="warn"?"bg-amber-50 text-amber-800":Z==="good"?"bg-emerald-50 text-emerald-700":Z==="info"?"bg-blue-50 text-blue-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:_}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:ke})]}),e.jsx("div",{className:vs("grid h-10 w-10 place-items-center rounded-2xl",Ce),children:I})]})})}}function $V(t,s){try{return t==="maxBasket"?ux(s):t==="attachments"?`${s.required?"Required":"Optional"} ( ${ux(s.threshold)})`:t==="vendorAllow"||t==="vendorDeny"||t==="categoriesDeny"?Array.isArray(s)?`${s.length} items`:"-":t==="geofences"?Array.isArray(s)?`${s.length} fences`:"-":t==="categories"?JSON.stringify(s):t==="allowedModules"||t==="allowedMarketplaces"?`${Object.keys(s||{}).filter(l=>s[l]).length} enabled`:t==="time"?`${s.start}-${s.end} (${(s.days||[]).length} days)`:t==="purpose"?`${s.required?"Required":"Optional"} (${(s.tags||[]).length} tags)`:JSON.stringify(s)}catch{return String(s)}}const mx={green:"#03CD8C",orange:"#F77F00"};function ya(...t){return t.filter(Boolean).join(" ")}function An(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function R4(t,s,a){return Math.max(s,Math.min(a,t))}function mc(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function mm(t){return JSON.parse(JSON.stringify(t))}function ns({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:ya("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Ds({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:mx.green}:t==="accent"?{background:mx.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:ya(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Ji({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4 transition-colors hover:border-slate-300",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:ya("relative h-7 w-12 rounded-full border transition-all duration-200 ease-in-out",t?"border-emerald-500 bg-emerald-500 shadow-[0_0_0_3px_rgba(3,205,140,0.2)]":"border-slate-300 bg-slate-100"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:ya("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition-all duration-200",t?"left-[22px]":"left-1")})})]})}function xc({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:ya(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:ya("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function $r({label:t,value:s,onChange:a,hint:l,disabled:n}){return e.jsxs("div",{className:ya(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",min:0,onKeyDown:r=>(r.key==="-"||r.key==="e")&&r.preventDefault(),value:s,onChange:r=>{const i=Number(r.target.value||0);i>=0&&a(i)},disabled:n,className:ya("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function _a({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:ya(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:ya("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i,children:i},i))})]})}function LV({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function Gl({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function qE({actions:t}){const[s,a]=d.useState(!1);return e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 focus:bg-slate-100 focus:outline-none",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>a(!1)}),e.jsx("div",{className:"absolute right-0 top-full z-40 mt-1 w-48 overflow-hidden rounded-xl border border-slate-200 bg-white shadow-xl ring-1 ring-slate-200",children:t.map((l,n)=>e.jsx("button",{onClick:()=>{l.onClick(),a(!1)},className:ya("block w-full px-4 py-2.5 text-left text-sm font-medium transition hover:bg-slate-50",l.variant==="danger"?"text-rose-700 hover:bg-rose-50":"text-slate-700"),children:l.label},n))})]})]})}function ph({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="920px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 bottom-4 top-4 z-50 mx-auto flex w-[min(980px,calc(100vw-2rem))] flex-col overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i,maxHeight:"92vh"},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex shrink-0 items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-1",children:[o?e.jsx(qE,{actions:o}):null,e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"shrink-0 border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function FV({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,actions:i}){return d.useEffect(()=>{const o=c=>c.key==="Escape"&&n();return t&&window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,x:16},animate:{opacity:1,x:0},exit:{opacity:0,x:16},transition:{duration:.18},className:ya("fixed z-50 flex flex-col overflow-hidden border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]","bottom-2 left-2 right-2 top-2 rounded-[28px]","lg:bottom-4 lg:left-auto lg:right-4 lg:top-4 lg:w-[560px]"),style:{maxHeight:"calc(100vh - 32px)"},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex shrink-0 items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-base font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-1",children:[i?e.jsx(qE,{actions:i}):null,e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"shrink-0 border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function UV({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:ya("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function VV(t){return t==="CFO"||t==="Org Admin"?"warn":t==="Finance"||t==="Accountant"?"info":t==="EVzone Support"?"bad":"neutral"}function _V(t){return t==="Email"?e.jsx(Xs,{className:"h-4 w-4"}):t==="WhatsApp"?e.jsx(DE,{className:"h-4 w-4"}):t==="WeChat"?e.jsx($i,{className:"h-4 w-4"}):e.jsx(ww,{className:"h-4 w-4"})}function D4(t,s){if(t.assignment==="Specific user"&&t.specificUser)return t.specificUser;const a=s.filter(i=>i.role===t.role);if(!a.length)return"(No approver pool)";if(t.assignment==="First available"){const i=a.find(o=>!o.ooo);return i?i.name:a[0].name}if(t.assignment==="Least load"){const i=[...a].sort((c,x)=>c.load-x.load);return(i.find(c=>!c.ooo)||i[0]).name}const l=Math.abs(BV(t.id))%a.length,n=a[(l+0)%a.length];return(n.ooo&&a.find(i=>!i.ooo)||n).name}function BV(t){let s=0;for(let a=0;a<t.length;a++)s=(s<<5)-s+t.charCodeAt(a);return s|0}function GV(t,s,a){if(!t.enabled)return{status:"Blocked",reasons:["Flow is disabled"],stages:[]};const l=[];if(t.scopeType==="Module"&&t.module&&t.module!==s.module)return{status:"Blocked",reasons:["Scenario module does not match flow scope"],stages:[]};if(t.scopeType==="Marketplace"){if(t.module!=="E-Commerce")return{status:"Blocked",reasons:["Marketplace flow must be under E-Commerce"],stages:[]};if((s.marketplace||"-")==="-")return{status:"Blocked",reasons:["Scenario has no marketplace"],stages:[]};if(t.marketplace&&t.marketplace!==s.marketplace)return{status:"Blocked",reasons:["Scenario marketplace does not match flow scope"],stages:[]}}if(t.scopeType,s.amountUGX>=t.rule.requireAttachmentsOverUGX&&!s.attachmentsProvided)return{status:"Blocked",reasons:["Attachments required above threshold"],stages:[]};if(s.amountUGX>=t.rule.requireCommentOverUGX&&!s.commentProvided)return{status:"Blocked",reasons:["Comment required above threshold"],stages:[]};if(t.rule.autoApprove.enabled&&s.amountUGX<=t.rule.autoApprove.thresholdUGX){if(!t.rule.autoApprove.eligibleOnly||s.userAutoApprovalEligible)return l.push("Auto-approved under threshold"),t.rule.autoApprove.eligibleOnly&&l.push("Auto-approval eligibility satisfied"),{status:"Auto-approved",reasons:l,stages:[]};l.push("Auto-approve blocked: user not eligible")}if(s.amountUGX<=t.rule.requireApprovalOverUGX)return l.push("Under approval trigger. Allowed without approval."),{status:"Auto-approved",reasons:l,stages:[]};const n=[...t.stages].filter(i=>s.amountUGX>=i.minAmountUGX).sort((i,o)=>i.minAmountUGX-o.minAmountUGX);if(!n.length)return l.push("No stages configured for this amount"),{status:"Requires approval",reasons:l,stages:[]};const r=n.map((i,o)=>{const c=D4(i,a),x=s.oooRoles.includes(i.role);let j=c,g=i.escalation.enabled?i.escalation.target==="Next stage"?o<n.length-1?n[o+1].role:"Org Admin":i.escalation.target:"(none)";if(x&&i.delegation.enabled)if(i.delegation.mode==="Delegate user"&&i.delegation.delegateUser)j=i.delegation.delegateUser,g="(delegate)";else if(i.delegation.mode==="Role pool"){const T=i.delegation.delegateRole||i.role,C={...i,role:T,assignment:"Least load"};j=D4(C,a),g="(role pool)"}else i.delegation.mode==="Skip to next stage"&&(j="(skipped)",g="Next stage");const y=Math.max(0,i.slaHours-s.elapsedHours),$=s.elapsedHours>i.slaHours;return{stage:i,assignedTo:j,slaDueInHours:y,breached:$,escalationTo:String(g)}});return r.some(i=>i.assignedTo==="(skipped)")&&l.push("Out-of-office delegation skipped one or more stages"),{status:"Requires approval",reasons:l,stages:r}}function zs(t){return{id:An("STG"),name:t.name,minAmountUGX:t.minAmountUGX??0,role:t.role??"Manager",assignment:t.assignment??"Least load",specificUser:t.specificUser,slaHours:t.slaHours??8,escalation:t.escalation??{enabled:!0,afterHours:8,target:"Next stage"},delegation:t.delegation??{enabled:!0,mode:"Role pool",delegateRole:t.role??"Manager"}}}function f0(){const t=[];return t.push({id:An("FLOW"),name:"Rides & Logistics approvals",enabled:!0,scopeType:"Module",module:"Rides & Logistics",rule:{autoApprove:{enabled:!0,thresholdUGX:2e5,eligibleOnly:!0},requireApprovalOverUGX:2e5,requireAttachmentsOverUGX:2e6,requireCommentOverUGX:8e5},stages:[zs({name:"Manager approval",minAmountUGX:2e5,role:"Manager",slaHours:6,assignment:"First available"}),zs({name:"Finance approval",minAmountUGX:1e6,role:"Finance",slaHours:8,assignment:"Least load"}),zs({name:"CFO approval",minAmountUGX:5e6,role:"CFO",slaHours:12,assignment:"Least load"})],defaults:{policyTemplate:"Balanced",approvalFlowKind:"Multi-level escalation"},sla:{breachAlertsEnabled:!0,breachNotifyChannels:["Email","WhatsApp"],remindBeforeMinutes:30},loadBalancing:{enabled:!0,strategy:"Least load"},meta:{industryTemplate:"Corporate",notes:"Default ride approvals. Tighten for premium rides in Policy Builder."}}),t.push({id:An("FLOW"),name:"EVs & Charging approvals",enabled:!0,scopeType:"Module",module:"EVs & Charging",rule:{autoApprove:{enabled:!0,thresholdUGX:3e5,eligibleOnly:!0},requireApprovalOverUGX:3e5,requireAttachmentsOverUGX:3e6,requireCommentOverUGX:1e6},stages:[zs({name:"Manager approval",minAmountUGX:3e5,role:"Manager",slaHours:8,assignment:"Least load"}),zs({name:"Finance approval",minAmountUGX:2e6,role:"Finance",slaHours:12,assignment:"Least load"})],defaults:{policyTemplate:"Balanced",approvalFlowKind:"Manager approval"},sla:{breachAlertsEnabled:!0,breachNotifyChannels:["Email"],remindBeforeMinutes:45},loadBalancing:{enabled:!0,strategy:"Least load"},meta:{industryTemplate:"Corporate",notes:"Credits and station services. Consider stricter policy for refunds."}}),t.push({id:An("FLOW"),name:"Medical & Health Care approvals",enabled:!0,scopeType:"Module",module:"Medical & Health Care",rule:{autoApprove:{enabled:!0,thresholdUGX:1e5,eligibleOnly:!0},requireApprovalOverUGX:1e5,requireAttachmentsOverUGX:5e5,requireCommentOverUGX:25e4},stages:[zs({name:"Manager approval",minAmountUGX:1e5,role:"Manager",slaHours:4,assignment:"First available"}),zs({name:"Finance approval",minAmountUGX:8e5,role:"Finance",slaHours:8,assignment:"Least load"})],defaults:{policyTemplate:"Strict compliance",approvalFlowKind:"Multi-level escalation"},sla:{breachAlertsEnabled:!0,breachNotifyChannels:["Email","SMS"],remindBeforeMinutes:20},loadBalancing:{enabled:!0,strategy:"First available"},meta:{industryTemplate:"Hospital",notes:"Higher sensitivity. Keep attachments and comments strict."}}),t.push({id:An("FLOW"),name:"Travel & Tourism approvals",enabled:!0,scopeType:"Module",module:"Travel & Tourism",rule:{autoApprove:{enabled:!0,thresholdUGX:25e4,eligibleOnly:!0},requireApprovalOverUGX:25e4,requireAttachmentsOverUGX:2e6,requireCommentOverUGX:8e5},stages:[zs({name:"Manager approval",minAmountUGX:25e4,role:"Manager",slaHours:8,assignment:"Least load"}),zs({name:"Finance approval",minAmountUGX:2e6,role:"Finance",slaHours:12,assignment:"Least load"})],defaults:{policyTemplate:"Balanced",approvalFlowKind:"Manager approval"},sla:{breachAlertsEnabled:!0,breachNotifyChannels:["Email","WhatsApp"],remindBeforeMinutes:30},loadBalancing:{enabled:!0,strategy:"Least load"},meta:{industryTemplate:"Tour Company",notes:"Airport and hotel bookings. Consider vendor allowlist."}}),t.push({id:An("FLOW"),name:"Finance & Payments approvals",enabled:!0,scopeType:"Module",module:"Finance & Payments",rule:{autoApprove:{enabled:!1,thresholdUGX:0,eligibleOnly:!0},requireApprovalOverUGX:0,requireAttachmentsOverUGX:0,requireCommentOverUGX:0},stages:[zs({name:"Finance approval",minAmountUGX:0,role:"Finance",slaHours:6,assignment:"Least load"}),zs({name:"CFO approval",minAmountUGX:1e7,role:"CFO",slaHours:12,assignment:"Least load"})],defaults:{policyTemplate:"Strict compliance",approvalFlowKind:"Finance approval"},sla:{breachAlertsEnabled:!0,breachNotifyChannels:["Email","SMS"],remindBeforeMinutes:15},loadBalancing:{enabled:!0,strategy:"Least load"},meta:{industryTemplate:"Corporate",notes:"Direct money movement. Always audited."}}),t.push({id:An("FLOW"),name:"E-Commerce default approvals",enabled:!0,scopeType:"Module",module:"E-Commerce",rule:{autoApprove:{enabled:!0,thresholdUGX:15e4,eligibleOnly:!0},requireApprovalOverUGX:15e4,requireAttachmentsOverUGX:3e6,requireCommentOverUGX:9e5},stages:[zs({name:"Procurement approval",minAmountUGX:15e4,role:"Procurement",slaHours:10,assignment:"Least load"}),zs({name:"Finance approval",minAmountUGX:2e6,role:"Finance",slaHours:12,assignment:"Least load"}),zs({name:"CFO approval",minAmountUGX:12e6,role:"CFO",slaHours:24,assignment:"Least load"})],defaults:{policyTemplate:"Balanced",approvalFlowKind:"Multi-level escalation"},sla:{breachAlertsEnabled:!0,breachNotifyChannels:["Email"],remindBeforeMinutes:45},loadBalancing:{enabled:!0,strategy:"Least load"},meta:{industryTemplate:"Corporate",notes:"Marketplace specifics can override, e.g., MyLiveDealz."}}),t.push({id:An("FLOW"),name:"MyLiveDealz approvals (override)",enabled:!0,scopeType:"Marketplace",module:"E-Commerce",marketplace:"MyLiveDealz",rule:{autoApprove:{enabled:!0,thresholdUGX:1e5,eligibleOnly:!0},requireApprovalOverUGX:1e5,requireAttachmentsOverUGX:1e6,requireCommentOverUGX:5e5},stages:[zs({name:"Procurement approval",minAmountUGX:1e5,role:"Procurement",slaHours:8,assignment:"Least load"}),zs({name:"Finance approval",minAmountUGX:15e5,role:"Finance",slaHours:10,assignment:"Least load"}),zs({name:"CFO approval",minAmountUGX:5e6,role:"CFO",slaHours:16,assignment:"Least load"})],defaults:{policyTemplate:"Conservative",approvalFlowKind:"Multi-level escalation"},sla:{breachAlertsEnabled:!0,breachNotifyChannels:["Email","WhatsApp"],remindBeforeMinutes:30},loadBalancing:{enabled:!0,strategy:"Least load"},meta:{industryTemplate:"Corporate",notes:"Deal pages can have high-value assets. Keep stricter approvals."}}),t.push({id:An("FLOW"),name:"RFQ / High-value assets approvals",enabled:!0,scopeType:"RFQ",rule:{autoApprove:{enabled:!1,thresholdUGX:0,eligibleOnly:!0},requireApprovalOverUGX:0,requireAttachmentsOverUGX:0,requireCommentOverUGX:0},stages:[zs({name:"Manager approval",minAmountUGX:0,role:"Manager",slaHours:6,assignment:"First available"}),zs({name:"Finance approval",minAmountUGX:0,role:"Finance",slaHours:8,assignment:"Least load"}),zs({name:"CFO approval",minAmountUGX:0,role:"CFO",slaHours:12,assignment:"Least load"})],defaults:{policyTemplate:"Strict compliance",approvalFlowKind:"Multi-level escalation"},sla:{breachAlertsEnabled:!0,breachNotifyChannels:["Email","SMS"],remindBeforeMinutes:20},loadBalancing:{enabled:!0,strategy:"Least load"},meta:{industryTemplate:"Corporate",notes:"RFQs always require approvals and are tracked by SLA."}}),t}function I4(t){const a=f0().map(l=>({...l,id:An("FLOW"),meta:{...l.meta,industryTemplate:t}}));return t==="Hospital"&&a.forEach(l=>{l.module==="Medical & Health Care"&&(l.rule.autoApprove.thresholdUGX=8e4,l.rule.requireAttachmentsOverUGX=3e5,l.sla.remindBeforeMinutes=15,l.sla.breachNotifyChannels=["Email","SMS","WhatsApp"],l.stages.forEach(n=>n.slaHours=Math.max(2,Math.min(8,n.slaHours-2)))),l.module==="Finance & Payments"&&(l.sla.remindBeforeMinutes=10,l.sla.breachNotifyChannels=["Email","SMS"])}),t==="Tour Company"&&a.forEach(l=>{l.module==="Travel & Tourism"&&(l.rule.autoApprove.thresholdUGX=3e5,l.rule.requireCommentOverUGX=5e5,l.sla.breachNotifyChannels=["Email","WhatsApp"])}),a}function qV(){var k,m,S,f,U;const t=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],s=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],a=["Org default","Conservative","Balanced","Flexible","Strict compliance"],l=["Org default","Auto under threshold","Manager approval","Finance approval","CFO approval","Multi-level escalation"],n=["Manager","Approver","Procurement","Accountant","Finance","CFO","Org Admin","Travel Coordinator","EVzone Support","Custom"],r=["Round robin","Least load","First available","Specific user"],i=["Next stage","Org Admin","CFO","Finance Desk","Approver Desk"],o=["Delegate user","Role pool","Skip to next stage"],c=["Email","WhatsApp","WeChat","SMS"],[x,j]=d.useState([]),g=p=>{const M=An("toast");j(ee=>[{id:M,...p},...ee].slice(0,4)),window.setTimeout(()=>j(ee=>ee.filter(b=>b.id!==M)),3200)},[y,$]=d.useState("builder"),[T,C]=d.useState(()=>f0()),[W,L]=d.useState(()=>mm(f0())),[R,F]=d.useState(""),[te,oe]=d.useState("All"),[G,H]=d.useState(()=>{var p;return((p=f0()[0])==null?void 0:p.id)||""}),Y=d.useMemo(()=>T.find(p=>p.id===G)||null,[T,G]),[we,q]=d.useState(()=>[{id:"AP-1",name:"Ops Manager",role:"Manager",load:2,ooo:!1},{id:"AP-2",name:"Sales Manager",role:"Manager",load:5,ooo:!1},{id:"AP-3",name:"Procurement Desk",role:"Procurement",load:7,ooo:!1},{id:"AP-4",name:"Approver Desk",role:"Approver",load:4,ooo:!1},{id:"AP-5",name:"Finance Desk",role:"Finance",load:6,ooo:!1},{id:"AP-6",name:"Accountant",role:"Accountant",load:3,ooo:!1},{id:"AP-7",name:"CFO",role:"CFO",load:1,ooo:!1},{id:"AP-8",name:"Org Admin",role:"Org Admin",load:2,ooo:!1}]),[je,_e]=d.useState({amountUGX:65e4,module:"Rides & Logistics",marketplace:"-",userAutoApprovalEligible:!0,attachmentsProvided:!0,commentProvided:!0,elapsedHours:0,oooRoles:[]}),[Ee,be]=d.useState(!1),[Fe,Pe]=d.useState(""),[pe,Q]=d.useState(!1),[Re,ce]=d.useState(!1),[xe,he]=d.useState(!1),[de,ye]=d.useState("Module"),[Ke,Le]=d.useState("New approval flow"),[Ne,ge]=d.useState("Rides & Logistics"),[$e,ie]=d.useState("MyLiveDealz"),[Oe,Se]=d.useState(!1),[Te,Ge]=d.useState("Corporate"),[We,ze]=d.useState("append"),[Ue,le]=d.useState(!1),[z,Ae]=d.useState(null),Ve=d.useMemo(()=>{const p=JSON.stringify(T),M=JSON.stringify(W);return p===M?0:1},[T,W]),Ye=d.useMemo(()=>{const p=R.trim().toLowerCase();return T.filter(M=>te==="All"?!0:M.scopeType===te).filter(M=>p?`${M.name} ${M.scopeType} ${M.module||""} ${M.marketplace||""} ${M.defaults.policyTemplate} ${M.defaults.approvalFlowKind}`.toLowerCase().includes(p):!0).sort((M,ee)=>M.name.localeCompare(ee.name))},[T,R,te]);d.useEffect(()=>{var p;G&&(T.some(M=>M.id===G)||H(((p=T[0])==null?void 0:p.id)||""))},[T,G]);const Be=d.useMemo(()=>{if(!Y)return null;const p={...je};return Y.scopeType==="Marketplace"&&(p.module="E-Commerce",p.marketplace=Y.marketplace||"MyLiveDealz"),Y.scopeType==="Module"&&Y.module&&(p.module=Y.module,p.marketplace=Y.module==="E-Commerce"?p.marketplace==="-"?"MyLiveDealz":p.marketplace:"-"),Y.scopeType==="RFQ"&&(p.module="Rides & Logistics",p.marketplace="-"),GV(Y,p,we)},[Y,je,we]),w=p=>{Ae(p),le(!0)},B=d.useMemo(()=>!Y||!z?null:Y.stages.find(p=>p.id===z)||null,[Y,z]),ue=p=>{Y&&C(M=>M.map(ee=>ee.id===Y.id?p(ee):ee))},ne=()=>{if(!Y)return;const p=zs({name:"New stage",minAmountUGX:Y.rule.requireApprovalOverUGX,role:"Manager",slaHours:8});ue(M=>({...M,stages:[...M.stages,p]})),g({title:"Stage added",message:`Added ${p.name}.`,kind:"success"})},Me=(p,M)=>{if(!Y)return;const ee=Y.stages.findIndex(b=>b.id===p);ee<0||ue(b=>{const ae=[...b.stages],[ve]=ae.splice(ee,1);return ae.splice(M,0,ve),{...b,stages:ae}})},De=p=>{Y&&(ue(M=>({...M,stages:M.stages.filter(ee=>ee.id!==p)})),g({title:"Stage removed",message:`Removed stage ${p}.`,kind:"info"}))},fe=()=>{if(!Y)return;const p=mm(Y);p.id=An("FLOW"),p.name=`${Y.name} (Copy)`,p.meta.notes=`${Y.meta.notes}
Cloned from ${Y.id}`,C(M=>[p,...M]),H(p.id),ce(!1),g({title:"Cloned",message:"Flow cloned.",kind:"success"})},me=()=>{Y&&(C(p=>p.filter(M=>M.id!==Y.id)),g({title:"Deleted",message:"Flow deleted.",kind:"info"}))},Xe=()=>{const p={id:An("FLOW"),name:Ke.trim()||"New approval flow",enabled:!0,scopeType:de,module:de==="Module"?Ne:de==="Marketplace"?"E-Commerce":void 0,marketplace:de==="Marketplace"?$e:void 0,rule:{autoApprove:{enabled:!0,thresholdUGX:2e5,eligibleOnly:!0},requireApprovalOverUGX:2e5,requireAttachmentsOverUGX:2e6,requireCommentOverUGX:8e5},stages:[zs({name:"Manager approval",minAmountUGX:2e5,role:"Manager",slaHours:8,assignment:"Least load"})],defaults:{policyTemplate:"Balanced",approvalFlowKind:"Manager approval"},sla:{breachAlertsEnabled:!0,breachNotifyChannels:["Email"],remindBeforeMinutes:30},loadBalancing:{enabled:!0,strategy:"Least load"},meta:{notes:"",industryTemplate:de==="RFQ"?"Corporate":void 0}};de==="RFQ"&&(p.rule.autoApprove.enabled=!1,p.rule.requireApprovalOverUGX=0,p.rule.requireAttachmentsOverUGX=0,p.rule.requireCommentOverUGX=0,p.stages=[zs({name:"Manager approval",minAmountUGX:0,role:"Manager",slaHours:6,assignment:"First available"}),zs({name:"Finance approval",minAmountUGX:0,role:"Finance",slaHours:8,assignment:"Least load"}),zs({name:"CFO approval",minAmountUGX:0,role:"CFO",slaHours:12,assignment:"Least load"})],p.defaults={policyTemplate:"Strict compliance",approvalFlowKind:"Multi-level escalation"}),C(M=>[p,...M]),H(p.id),he(!1),g({title:"Created",message:"New flow created.",kind:"success"})},V=()=>{Pe(""),Q(!1),be(!0)},E=()=>{if(!pe||Fe.trim().length<8){g({title:"Publish blocked",message:"Add a reason and confirm acknowledgement.",kind:"warn"});return}L(mm(T)),be(!1),g({title:"Published",message:"Approval workflows published.",kind:"success"})},u=()=>{g({title:"Saved",message:"Draft saved (demo).",kind:"success"})},P=()=>{C(mm(W)),g({title:"Reverted",message:"Reverted to last published.",kind:"info"})},se=()=>{var M,ee;const p=I4(Te);We==="replace"?(C(p),H(((M=p[0])==null?void 0:M.id)||"")):(C(b=>[...p,...b]),H(((ee=p[0])==null?void 0:ee.id)||G)),Se(!1),g({title:"Template applied",message:`${Te} template applied (${We}).`,kind:"success"})},D=d.useMemo(()=>{const p=T.flatMap(O=>O.stages.map(X=>{const N=(X.role==="CFO"?9:X.role==="Finance"?6:X.role==="Procurement"?5:3)+X.minAmountUGX/1e7*2,h=X.role==="Procurement"?.14:.08,K=Math.min(.4,Math.max(.02,(N-X.slaHours)/Math.max(1,X.slaHours)));return{flowId:O.id,flowName:O.name,stageId:X.id,stageName:X.name,role:X.role,avgHours:Number(N.toFixed(1)),slaHours:X.slaHours,breachRate:Number(R4(K,0,1).toFixed(2)),reworkRate:Number(h.toFixed(2))}})),M=p.reduce((O,X)=>O+X.avgHours,0)/Math.max(1,p.length),ee=p.reduce((O,X)=>O+X.breachRate,0)/Math.max(1,p.length),b=p.reduce((O,X)=>O+X.reworkRate,0)/Math.max(1,p.length),ae=[...p].sort((O,X)=>X.avgHours-O.avgHours)[0],ve=n.map(O=>{const X=p.filter(N=>N.role===O);if(!X.length)return null;const A=X.reduce((N,h)=>N+h.avgHours,0)/X.length;return{role:O,avgHours:Number(A.toFixed(1)),count:X.length}}).filter(Boolean);return ve.sort((O,X)=>X.avgHours-O.avgHours),{samples:p,overall:{avgHours:Number(M.toFixed(1)),breachRate:Number(ee.toFixed(2)),reworkRate:Number(b.toFixed(2))},bottleneck:ae,byRole:ve}},[T]),re=p=>p.scopeType==="RFQ"?"RFQ":p.scopeType==="Marketplace"?`E-Commerce  ${p.marketplace}`:p.module||"Module";return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(UV,{toasts:x,onDismiss:p=>j(M=>M.filter(ee=>ee.id!==p))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:mx.green},children:e.jsx(ct,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Approval Workflow Builder"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Rules, multi-level approvals, SLAs, delegation, load balancing, and templates."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(ns,{label:`Flows: ${T.length}`,tone:"neutral"}),e.jsx(ns,{label:`Draft: ${Ve?"Changed":"Clean"}`,tone:Ve?"warn":"good"}),e.jsx(ns,{label:`SLA alerts: ${T.filter(p=>p.sla.breachAlertsEnabled).length}`,tone:"info"}),e.jsx(ns,{label:"Premium",tone:"info"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ds,{variant:"outline",onClick:()=>Se(!0),children:[e.jsx(ht,{className:"h-4 w-4"})," Templates"]}),e.jsxs(Ds,{variant:"outline",onClick:()=>he(!0),children:[e.jsx(gt,{className:"h-4 w-4"})," New flow"]}),e.jsxs(Ds,{variant:"outline",onClick:P,disabled:!Ve,children:[e.jsx(Qe,{className:"h-4 w-4"})," Revert"]}),e.jsxs(Ds,{variant:"outline",onClick:u,children:[e.jsx(Da,{className:"h-4 w-4"})," Save"]}),e.jsxs(Ds,{variant:"primary",onClick:V,disabled:!Ve,children:[e.jsx(ct,{className:"h-4 w-4"})," Publish"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"builder",label:"Builder"},{id:"templates",label:"Templates"},{id:"analytics",label:"Analytics"}].map(p=>e.jsx("button",{className:ya("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",y===p.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:y===p.id?{background:mx.green}:void 0,onClick:()=>$(p.id),children:p.label},p.id))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[y==="builder"?e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Gl,{title:"Flows",subtitle:"Search and select a flow to edit.",right:e.jsx(ns,{label:`${Ye.length}`,tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3 lg:grid-cols-1",children:[e.jsx(xc,{label:"Search",value:R,onChange:F,placeholder:"MyLiveDealz, Finance, RFQ..."}),e.jsx(_a,{label:"Scope",value:te,onChange:p=>oe(p),options:["All","Module","Marketplace","RFQ"]}),e.jsxs(Ds,{variant:"outline",onClick:()=>{F(""),oe("All"),g({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(kl,{className:"h-4 w-4"})," Reset"]})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[Ye.map(p=>{const M=p.id===G;return e.jsx("button",{type:"button",onClick:()=>H(p.id),className:ya("w-full rounded-3xl border p-4 text-left transition",M?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:p.name}),e.jsx(ns,{label:p.enabled?"Enabled":"Off",tone:p.enabled?"good":"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[re(p),"  ",p.stages.length," stage(s)"]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(ns,{label:p.defaults.policyTemplate,tone:"neutral"}),e.jsx(ns,{label:p.defaults.approvalFlowKind,tone:"info"}),p.sla.breachAlertsEnabled?e.jsx(ns,{label:"SLA alerts",tone:"warn"}):e.jsx(ns,{label:"No SLA",tone:"neutral"})]})]}),e.jsx(et,{className:"mt-1 h-5 w-5 text-slate-400"})]})},p.id)}),Ye.length?null:e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(La,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No flows"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Create a new flow or change filters."})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:e.jsxs(Ds,{variant:"outline",className:"w-full",onClick:()=>he(!0),children:[e.jsx(gt,{className:"h-4 w-4"})," New flow"]})})]}),e.jsxs(Gl,{title:"Approver load",subtitle:"Premium: preview load balancing inputs.",children:[e.jsx("div",{className:"space-y-2",children:we.map(p=>e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:p.name}),e.jsxs("div",{className:"mt-0.5 text-xs text-slate-500",children:["Role: ",p.role]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ns,{label:`Load: ${p.load}`,tone:p.load>=6?"warn":"neutral"}),e.jsx("button",{type:"button",className:ya("relative h-7 w-12 rounded-full border transition",p.ooo?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>q(M=>M.map(ee=>ee.id===p.id?{...ee,ooo:!ee.ooo}:ee)),"aria-label":"Toggle out of office",children:e.jsx("span",{className:ya("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",p.ooo?"left-[22px]":"left-1")})})]})]},p.id))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Toggle OOO to test delegation handling in the simulator."})]})]}),e.jsx("div",{className:"space-y-4",children:Y?e.jsxs(e.Fragment,{children:[e.jsxs(Gl,{title:"Flow settings",subtitle:"Rule engine: if amount > X then approval required.",right:e.jsx(ns,{label:Y.scopeType,tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(xc,{label:"Flow name",value:Y.name,onChange:p=>ue(M=>({...M,name:p})),placeholder:"Approval flow name"}),e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Enabled"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Enable at checkout"})]}),e.jsx("button",{type:"button",className:ya("relative h-7 w-12 rounded-full border transition",Y.enabled?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>ue(p=>({...p,enabled:!p.enabled})),"aria-label":"Toggle enabled",children:e.jsx("span",{className:ya("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",Y.enabled?"left-[22px]":"left-1")})})]})}),e.jsx(_a,{label:"Policy template",value:Y.defaults.policyTemplate,onChange:p=>ue(M=>({...M,defaults:{...M.defaults,policyTemplate:p}})),options:a,hint:"Maps to Policy Builder"}),e.jsx(_a,{label:"Default approval flow kind",value:Y.defaults.approvalFlowKind,onChange:p=>ue(M=>({...M,defaults:{...M.defaults,approvalFlowKind:p}})),options:l,hint:"Classifies this flow"}),e.jsxs("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Scope"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Different flows per module and per marketplace, plus RFQ."})]}),e.jsx(ns,{label:re(Y),tone:"neutral"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(_a,{label:"Scope type",value:Y.scopeType,onChange:p=>{const M=p;ue(ee=>{const b=mm(ee);return b.scopeType=M,M==="Module"&&(b.module=b.module||"Rides & Logistics",b.marketplace=void 0),M==="Marketplace"&&(b.module="E-Commerce",b.marketplace=b.marketplace||"MyLiveDealz"),M==="RFQ"&&(b.module=void 0,b.marketplace=void 0,b.rule.autoApprove.enabled=!1,b.rule.requireApprovalOverUGX=0,b.rule.requireAttachmentsOverUGX=0,b.rule.requireCommentOverUGX=0),b})},options:["Module","Marketplace","RFQ"]}),e.jsx(_a,{label:"Module",value:Y.scopeType==="Marketplace"?"E-Commerce":Y.module||"Rides & Logistics",onChange:p=>ue(M=>({...M,module:p})),options:t,disabled:Y.scopeType==="RFQ"||Y.scopeType==="Marketplace",hint:Y.scopeType==="Marketplace"?"Fixed: E-Commerce":""}),e.jsx(_a,{label:"Marketplace",value:Y.marketplace||"MyLiveDealz",onChange:p=>ue(M=>({...M,marketplace:p})),options:s,disabled:Y.scopeType!=="Marketplace",hint:Y.scopeType==="Marketplace"?"E-Commerce only":""}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Industry tag"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(ns,{label:Y.meta.industryTemplate||"(none)",tone:"neutral"}),e.jsx(ns,{label:"Cloneable",tone:"info"})]})]})]})]})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:[e.jsxs(Ds,{variant:"outline",onClick:()=>ce(!0),children:[e.jsx(ss,{className:"h-4 w-4"})," Clone"]}),e.jsxs(Ds,{variant:"danger",onClick:me,children:[e.jsx(Qe,{className:"h-4 w-4"})," Delete"]})]})]}),e.jsxs(Gl,{title:"Rule engine",subtitle:"Auto-approve under threshold (if eligible). Above threshold routes to multi-level approvals.",right:e.jsx(ns,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Ji,{enabled:Y.rule.autoApprove.enabled,onChange:p=>ue(M=>({...M,rule:{...M.rule,autoApprove:{...M.rule.autoApprove,enabled:p}}})),label:"Enable auto-approve",description:"Uses eligibility flag and threshold."}),e.jsx(Ji,{enabled:Y.rule.autoApprove.eligibleOnly,onChange:p=>ue(M=>({...M,rule:{...M.rule,autoApprove:{...M.rule.autoApprove,eligibleOnly:p}}})),label:"Eligibility required",description:"Only auto-approve for eligible users."}),e.jsx($r,{label:"Auto-approve threshold (UGX)",value:Y.rule.autoApprove.thresholdUGX,onChange:p=>ue(M=>({...M,rule:{...M.rule,autoApprove:{...M.rule.autoApprove,thresholdUGX:p}}})),hint:`Preview: ${mc(Y.rule.autoApprove.thresholdUGX)}`,disabled:!Y.rule.autoApprove.enabled}),e.jsx($r,{label:"Approval required when amount is over (UGX)",value:Y.rule.requireApprovalOverUGX,onChange:p=>ue(M=>({...M,rule:{...M.rule,requireApprovalOverUGX:p}})),hint:`Rule: if amount > ${mc(Y.rule.requireApprovalOverUGX)} then approvals`}),e.jsx($r,{label:"Require comment above (UGX)",value:Y.rule.requireCommentOverUGX,onChange:p=>ue(M=>({...M,rule:{...M.rule,requireCommentOverUGX:p}})),hint:"Adds accountability"}),e.jsx($r,{label:"Require attachments above (UGX)",value:Y.rule.requireAttachmentsOverUGX,onChange:p=>ue(M=>({...M,rule:{...M.rule,requireAttachmentsOverUGX:p}})),hint:"Specs, invoices, PDFs"})]}),e.jsxs("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Effective rule:",e.jsxs("ul",{className:"mt-2 space-y-1 text-xs text-slate-600",children:[e.jsx("li",{children:"1) If amount  auto-approve threshold and eligible, approve automatically"}),e.jsx("li",{children:"2) If amount > approval trigger, route to approval stages"}),e.jsx("li",{children:"3) Above comment/attachment thresholds, enforce requirements"})]})]})]}),e.jsxs(Gl,{title:"Approval stages",subtitle:"Multi-level approvals with escalation paths and delegation handling.",right:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ns,{label:`${Y.stages.length} stages`,tone:"neutral"}),e.jsxs(Ds,{variant:"outline",onClick:ne,children:[e.jsx(gt,{className:"h-4 w-4"})," Add stage"]})]}),children:[e.jsxs("div",{className:"space-y-3",children:[Y.stages.map((p,M)=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:p.name}),e.jsx(ns,{label:`Min: ${mc(p.minAmountUGX)}`,tone:"neutral"}),e.jsx(ns,{label:p.role,tone:VV(p.role)}),e.jsx(ns,{label:`SLA: ${p.slaHours}h`,tone:p.slaHours<=4?"warn":"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Assignment: ",p.assignment,p.assignment==="Specific user"&&p.specificUser?` (${p.specificUser})`:""]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Escalation: ",p.escalation.enabled?`${p.escalation.target} after ${p.escalation.afterHours}h`:"Off"]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Delegation: ",p.delegation.enabled?`${p.delegation.mode}`:"Off"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ds,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>w(p.id),children:[e.jsx(kl,{className:"h-4 w-4"})," Edit"]}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:M,onChange:ee=>Me(p.id,Number(ee.target.value)),className:"appearance-none rounded-2xl border border-slate-200 bg-white py-2 pl-3 pr-8 text-xs font-semibold text-slate-700 outline-none hover:bg-slate-50 focus:ring-2 focus:ring-emerald-100",children:Y.stages.map((ee,b)=>e.jsxs("option",{value:b,children:["Step ",b+1]},b))}),e.jsx(ni,{className:"absolute right-2 top-1/2 h-3 w-3 -translate-y-1/2 text-slate-400 pointer-events-none"})]}),e.jsx(Ds,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>De(p.id),children:e.jsx(Qe,{className:"h-4 w-4"})})]})]})},p.id)),Y.stages.length?null:e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(La,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No stages"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Add a stage to enforce approvals."})]})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: load balancing strategies distribute approvals and reduce bottlenecks."})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"SLA & Breach Management"}),e.jsxs("div",{className:"mt-2 flex flex-col gap-4",children:[e.jsx(LV,{title:"SLA configuration",subtitle:"Breach thresholds and reminders",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ji,{label:"Breach alerts",description:"Notify when approval SLA is breached",enabled:Y.sla.breachAlertsEnabled,onChange:p=>ue(M=>({...M,sla:{...M.sla,breachAlertsEnabled:p}}))}),e.jsx($r,{label:"Remind before (minutes)",value:Y.sla.remindBeforeMinutes,onChange:p=>ue(M=>({...M,sla:{...M.sla,remindBeforeMinutes:p}})),hint:"Send early reminder to approver"})]})}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"Alert and breaching channels"}),e.jsx("div",{className:"mt-1 text-sm text-slate-500",children:"Configure how and where breach notifications are sent."})]}),e.jsx(ns,{label:`${Y.sla.breachNotifyChannels.length} active`,tone:"warn"})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-500",children:"Channels"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.map(p=>{const M=Y.sla.breachNotifyChannels.includes(p);return e.jsxs("button",{onClick:()=>{ue(ee=>{const b=M?ee.sla.breachNotifyChannels.filter(ae=>ae!==p):[...ee.sla.breachNotifyChannels,p];return{...ee,sla:{...ee.sla,breachNotifyChannels:b}}})},className:ya("flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-medium transition-all duration-200 border",M?"bg-emerald-50 border-emerald-200 text-emerald-700 shadow-sm":"bg-white border-slate-200 text-slate-600 hover:border-slate-300 hover:bg-slate-50"),children:[_V(p),p,M&&e.jsx(tt,{className:"h-3.5 w-3.5 ml-1"})]},p)})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-500",children:"Escalation Preview"}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-4 text-xs text-slate-600 leading-relaxed border border-slate-100",children:["When an approval breaches the SLA limit (current: ",e.jsxs("strong",{children:[((k=Y.stages[0])==null?void 0:k.slaHours)||8,"h"]}),"), a notification will be sent via ",e.jsx("strong",{children:Y.sla.breachNotifyChannels.join(", ")||"no channels"}),". Depending on stage settings, the request may auto-escalate to the next approver or Admin."]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Ds,{variant:"outline",className:"w-full text-xs h-9",children:[e.jsx(Fo,{className:"h-3.5 w-3.5 mr-2"})," Send test alert"]}),e.jsxs(Ds,{variant:"outline",className:"w-full text-xs h-9",children:[e.jsx(Ni,{className:"h-3.5 w-3.5 mr-2"})," Configure template"]})]})]})]})]})]})]})]}):e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-10 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(ct,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"Select a flow"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Choose a flow on the left to edit rules and stages."})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Gl,{title:"Simulator",subtitle:"Premium: test scenarios and preview decisions.",right:Be?e.jsx(ns,{label:Be.status,tone:Be.status==="Auto-approved"?"good":Be.status==="Blocked"?"bad":"warn"}):null,children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx($r,{label:"Amount (UGX)",value:je.amountUGX,onChange:p=>_e(M=>({...M,amountUGX:p})),hint:`Preview: ${mc(je.amountUGX)}`}),e.jsx(_a,{label:"Service Module",value:je.module,onChange:p=>_e(M=>({...M,module:p})),options:t,disabled:!!Y&&(Y.scopeType==="Marketplace"||Y.scopeType==="RFQ"),hint:(Y==null?void 0:Y.scopeType)==="Marketplace"?"Driven by flow":(Y==null?void 0:Y.scopeType)==="RFQ"?"Driven by RFQ":""}),e.jsx(_a,{label:"Marketplace",value:je.marketplace==="-"?"MyLiveDealz":je.marketplace,onChange:p=>_e(M=>({...M,marketplace:p})),options:s,disabled:je.module!=="E-Commerce"||(Y==null?void 0:Y.scopeType)==="RFQ",hint:je.module!=="E-Commerce"?"Applies to E-Commerce only":""}),e.jsx(Ji,{enabled:je.userAutoApprovalEligible,onChange:p=>_e(M=>({...M,userAutoApprovalEligible:p})),label:"User is auto-approval eligible",description:"Set by org admin when creating the user."}),e.jsx(Ji,{enabled:je.attachmentsProvided,onChange:p=>_e(M=>({...M,attachmentsProvided:p})),label:"Attachments provided",description:"Required above configured threshold."}),e.jsx(Ji,{enabled:je.commentProvided,onChange:p=>_e(M=>({...M,commentProvided:p})),label:"Comment provided",description:"Required above configured threshold."}),e.jsx($r,{label:"Elapsed time (hours)",value:je.elapsedHours,onChange:p=>_e(M=>({...M,elapsedHours:p})),hint:"Used to show SLA breach previews"}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Out-of-office simulation"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Delegation handling routes tasks if approver is OOO."}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2",children:["Manager","Procurement","Finance","CFO"].map(p=>{const M=je.oooRoles.includes(p);return e.jsxs("button",{type:"button",className:ya("flex items-center justify-between rounded-2xl border px-3 py-2 text-sm font-semibold",M?"border-amber-300 bg-amber-50":"border-slate-200 bg-white hover:bg-slate-50"),onClick:()=>{_e(ee=>{const b=new Set(ee.oooRoles);return b.has(p)?b.delete(p):b.add(p),{...ee,oooRoles:Array.from(b)}})},children:[e.jsx("span",{children:p}),e.jsx(ns,{label:M?"OOO":"OK",tone:M?"warn":"good"})]},p)})})]})]}),Be?e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Decision"}),e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:Be.status}),Be.reasons.length?e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsx("div",{className:"font-semibold",children:"Reasons"}),e.jsx("ul",{className:"mt-2 space-y-1 text-xs text-slate-600",children:Be.reasons.map((p,M)=>e.jsxs("li",{children:[" ",p]},M))})]}):null,Be.stages.length?e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Approval path"}),e.jsx("div",{className:"mt-2 space-y-2",children:Be.stages.map(p=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:p.stage.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Role: ",p.stage.role,"  Assigned: ",p.assignedTo]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["SLA: ",p.stage.slaHours,"h  Due in: ",Math.round(p.slaDueInHours*10)/10,"h"]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsx(ns,{label:p.breached?"Breached":"OK",tone:p.breached?"bad":"good"}),e.jsx(ns,{label:`Escalate: ${p.escalationTo}`,tone:"neutral"})]})]})},p.stage.id))}),Y!=null&&Y.sla.breachAlertsEnabled?e.jsxs("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:["SLA breach alerts enabled. Channels: ",Y.sla.breachNotifyChannels.join(", ")]}):null]}):null]}):null]}),e.jsx(Gl,{title:"Approval templates",subtitle:"Premium: industry templates and cloning.",children:e.jsx("div",{className:"grid grid-cols-1 gap-2",children:[{id:"Corporate",desc:"Balanced enterprise approvals."},{id:"Hospital",desc:"Strict compliance, faster SLAs."},{id:"Tour Company",desc:"Travel heavy defaults."}].map(p=>e.jsx("button",{type:"button",className:"rounded-3xl border border-slate-200 bg-white p-4 text-left hover:bg-slate-50",onClick:()=>{Ge(p.id),ze("append"),Se(!0)},children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:p.id}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:p.desc})]}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]})},p.id))})})]})]}):null,y==="templates"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsx(Gl,{title:"Template library",subtitle:"Premium: apply a template set and then customize.",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(_a,{label:"Industry",value:Te,onChange:p=>Ge(p),options:["Corporate","Hospital","Tour Company"]}),e.jsx(_a,{label:"Apply mode",value:We,onChange:p=>ze(p),options:["append","replace"],hint:"Append adds new flows; replace overwrites all."}),e.jsxs(Ds,{variant:"primary",className:"w-full",onClick:()=>Se(!0),children:[e.jsx(ht,{className:"h-4 w-4"})," Apply template"]}),e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Templates include per-module and per-marketplace flows, plus RFQ."})]})}),e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsx(Gl,{title:"Preview",subtitle:"What gets added by the selected template.",children:I4(Te).map(p=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:p.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Scope: ",re(p),"  Stages: ",p.stages.length]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(ns,{label:p.defaults.policyTemplate,tone:"neutral"}),e.jsx(ns,{label:p.defaults.approvalFlowKind,tone:"info"}),e.jsx(ns,{label:`SLA alerts: ${p.sla.breachAlertsEnabled?"On":"Off"}`,tone:p.sla.breachAlertsEnabled?"warn":"neutral"})]})]}),e.jsx(ns,{label:Te,tone:"info"})]})},p.id))}),e.jsxs(Gl,{title:"Cloning",subtitle:"Premium: clone a flow to create a variant for a different module or marketplace.",children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Recommended use:",e.jsxs("ul",{className:"mt-2 space-y-1 text-xs text-slate-600",children:[e.jsx("li",{children:"1) Clone E-Commerce default into EVmart override"}),e.jsx("li",{children:"2) Tighten thresholds and add extra stage (Finance or CFO)"}),e.jsx("li",{children:"3) Publish and preview impact"})]})]}),e.jsxs(Ds,{variant:"outline",className:"mt-3",onClick:()=>ce(!0),disabled:!Y,children:[e.jsx(ss,{className:"h-4 w-4"})," Clone selected flow"]})]})]})]}):null,y==="analytics"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs(Gl,{title:"Approval analytics",subtitle:"Premium: cycle time, bottlenecks, and rework rate.",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx(v,{title:"Average cycle time",value:`${D.overall.avgHours}h`,icon:e.jsx($E,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(v,{title:"SLA breach rate",value:`${Math.round(D.overall.breachRate*100)}%`,icon:e.jsx(sl,{className:"h-5 w-5"}),tone:D.overall.breachRate>.25?"warn":"good"}),e.jsx(v,{title:"Rework rate",value:`${Math.round(D.overall.reworkRate*100)}%`,icon:e.jsx(Et,{className:"h-5 w-5"}),tone:D.overall.reworkRate>.12?"warn":"neutral"})]}),e.jsxs("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Bottleneck stage:",e.jsx("div",{className:"mt-2 font-semibold text-slate-900",children:(m=D.bottleneck)==null?void 0:m.stageName}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Role: ",(S=D.bottleneck)==null?void 0:S.role,"  Avg: ",(f=D.bottleneck)==null?void 0:f.avgHours,"h  SLA: ",(U=D.bottleneck)==null?void 0:U.slaHours,"h"]})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: analytics should use real historical approvals. This demo uses synthetic data."})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsx(Gl,{title:"Bottlenecks by role",subtitle:"Average stage time by approver role.",children:e.jsx("div",{className:"space-y-2",children:D.byRole.slice(0,10).map(p=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:p.role}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Stages: ",p.count]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ns,{label:`Avg ${p.avgHours}h`,tone:p.avgHours>=8?"warn":"neutral"}),e.jsx("div",{className:"h-2 w-40 overflow-hidden rounded-full bg-slate-100",children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${R4(p.avgHours/12*100,0,100)}%`,background:mx.green}})})]})]})},p.role))})}),e.jsxs(Gl,{title:"Flow health",subtitle:"Identify risky flows and tighten defaults.",children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Flow"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Scope"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Stages"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Auto-approve"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"SLA alerts"})]})}),e.jsx("tbody",{children:T.map(p=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:p.name}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:re(p)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ns,{label:`${p.stages.length}`,tone:"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ns,{label:p.rule.autoApprove.enabled?"On":"Off",tone:p.rule.autoApprove.enabled?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ns,{label:p.sla.breachAlertsEnabled?"On":"Off",tone:p.sla.breachAlertsEnabled?"warn":"neutral"})})]},p.id))})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Use templates and cloning to improve bottlenecks and reduce rework."})]})]})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"J Approval Workflow Builder v2: rule engine, multi-level approvals, per-module and per-marketplace flows, auto-approve eligibility, attachments/comments thresholds, delegation, SLA alerts, load balancing, analytics, templates and cloning."})})]})}),e.jsx(FV,{open:Ue,title:B?`Edit stage: ${B.name}`:"Edit stage",subtitle:B?`${B.role}  Min ${mc(B.minAmountUGX)}  SLA ${B.slaHours}h`:"",onClose:()=>le(!1),actions:[{label:"Save changes",onClick:u,variant:"default"},{label:"Close",onClick:()=>le(!1)}],footer:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Changes are draft-only until published."}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ds,{variant:"outline",onClick:()=>le(!1),children:"Close"}),e.jsxs(Ds,{variant:"primary",onClick:u,children:[e.jsx(Da,{className:"h-4 w-4"})," Save"]})]})]}),children:Y&&B?e.jsxs("div",{className:"space-y-4",children:[e.jsx(xc,{label:"Stage name",value:B.name,onChange:p=>ue(M=>({...M,stages:M.stages.map(ee=>ee.id===B.id?{...ee,name:p}:ee)})),placeholder:"Manager approval"}),e.jsx($r,{label:"Minimum amount (UGX)",value:B.minAmountUGX,onChange:p=>ue(M=>({...M,stages:M.stages.map(ee=>ee.id===B.id?{...ee,minAmountUGX:p}:ee)})),hint:`Stage applies when amount  ${mc(B.minAmountUGX)}`}),e.jsx(_a,{label:"Approver role",value:B.role,onChange:p=>ue(M=>({...M,stages:M.stages.map(ee=>ee.id===B.id?{...ee,role:p}:ee)})),options:n,hint:"Role pool"}),e.jsx(_a,{label:"Assignment strategy",value:B.assignment,onChange:p=>ue(M=>({...M,stages:M.stages.map(ee=>ee.id===B.id?{...ee,assignment:p}:ee)})),options:r,hint:"Premium load balancing"}),e.jsx(xc,{label:"Specific user",value:B.specificUser||"",onChange:p=>ue(M=>({...M,stages:M.stages.map(ee=>ee.id===B.id?{...ee,specificUser:p}:ee)})),placeholder:"Name",disabled:B.assignment!=="Specific user",hint:"Used only when strategy is Specific user"}),e.jsx($r,{label:"SLA (hours)",value:B.slaHours,onChange:p=>ue(M=>({...M,stages:M.stages.map(ee=>ee.id===B.id?{...ee,slaHours:p}:ee)})),hint:"Premium: SLA timers and breach alerts"}),e.jsxs(Gl,{title:"Escalation",subtitle:"Escalate when SLA is breached.",children:[e.jsx(Ji,{enabled:B.escalation.enabled,onChange:p=>ue(M=>({...M,stages:M.stages.map(ee=>ee.id===B.id?{...ee,escalation:{...ee.escalation,enabled:p}}:ee)})),label:"Enable escalation",description:"Escalates after the configured time"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx($r,{label:"Escalate after (hours)",value:B.escalation.afterHours,onChange:p=>ue(M=>({...M,stages:M.stages.map(ee=>ee.id===B.id?{...ee,escalation:{...ee.escalation,afterHours:p}}:ee)})),disabled:!B.escalation.enabled}),e.jsx(_a,{label:"Escalation target",value:B.escalation.target,onChange:p=>ue(M=>({...M,stages:M.stages.map(ee=>ee.id===B.id?{...ee,escalation:{...ee.escalation,target:p}}:ee)})),options:i,disabled:!B.escalation.enabled})]})]}),e.jsxs(Gl,{title:"Delegation",subtitle:"Out-of-office routing.",children:[e.jsx(Ji,{enabled:B.delegation.enabled,onChange:p=>ue(M=>({...M,stages:M.stages.map(ee=>ee.id===B.id?{...ee,delegation:{...ee.delegation,enabled:p}}:ee)})),label:"Enable delegation",description:"Routes tasks when approver is OOO"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(_a,{label:"Delegation mode",value:B.delegation.mode,onChange:p=>ue(M=>({...M,stages:M.stages.map(ee=>ee.id===B.id?{...ee,delegation:{...ee.delegation,mode:p}}:ee)})),options:o,disabled:!B.delegation.enabled}),e.jsx(_a,{label:"Delegate role",value:B.delegation.delegateRole||B.role,onChange:p=>ue(M=>({...M,stages:M.stages.map(ee=>ee.id===B.id?{...ee,delegation:{...ee.delegation,delegateRole:p}}:ee)})),options:n,disabled:!B.delegation.enabled||B.delegation.mode!=="Role pool"}),e.jsx(xc,{label:"Delegate user",value:B.delegation.delegateUser||"",onChange:p=>ue(M=>({...M,stages:M.stages.map(ee=>ee.id===B.id?{...ee,delegation:{...ee.delegation,delegateUser:p}}:ee)})),placeholder:"Name",disabled:!B.delegation.enabled||B.delegation.mode!=="Delegate user"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Delegation behavior is previewed in the Simulator panel."})]})]}):null}),e.jsx(ph,{open:xe,title:"New approval flow",subtitle:"Create a per-module, per-marketplace, or RFQ flow.",onClose:()=>he(!1),actions:[{label:"Create",onClick:Xe,variant:"default"},{label:"Cancel",onClick:()=>he(!1)}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Ds,{variant:"outline",onClick:()=>he(!1),children:"Cancel"}),e.jsxs(Ds,{variant:"primary",onClick:Xe,children:[e.jsx(gt,{className:"h-4 w-4"})," Create"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(xc,{label:"Name",value:Ke,onChange:Le,placeholder:"New flow"}),e.jsx(_a,{label:"Scope type",value:de,onChange:p=>ye(p),options:["Module","Marketplace","RFQ"]}),e.jsx(_a,{label:"Module",value:Ne,onChange:p=>ge(p),options:t,disabled:de!=="Module"}),e.jsx(_a,{label:"Marketplace",value:$e,onChange:p=>ie(p),options:s,disabled:de!=="Marketplace"}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Marketplace flows are always under E-Commerce."})]})}),e.jsx(ph,{open:Re,title:"Clone flow",subtitle:"Premium: clone and then tweak thresholds, stages, or scope.",onClose:()=>ce(!1),actions:[{label:"Clone",onClick:fe,variant:"default"},{label:"Cancel",onClick:()=>ce(!1)}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Ds,{variant:"outline",onClick:()=>ce(!1),children:"Cancel"}),e.jsxs(Ds,{variant:"primary",onClick:fe,disabled:!Y,children:[e.jsx(ss,{className:"h-4 w-4"})," Clone"]})]}),children:Y?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Selected: ",e.jsx("span",{className:"font-semibold text-slate-900",children:Y.name}),e.jsxs("div",{className:"mt-1 text-slate-600",children:["Scope: ",re(Y),"  Stages: ",Y.stages.length]})]}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Cloning is best for marketplace overrides and custom high-value approval paths."})]}):null}),e.jsxs(ph,{open:Oe,title:"Apply template",subtitle:"Premium: industry templates with cloning support.",onClose:()=>Se(!1),actions:[{label:"Apply",onClick:se,variant:"default"},{label:"Cancel",onClick:()=>Se(!1)}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Ds,{variant:"outline",onClick:()=>Se(!1),children:"Cancel"}),e.jsxs(Ds,{variant:"primary",onClick:se,children:[e.jsx(ht,{className:"h-4 w-4"})," Apply"]})]}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(_a,{label:"Industry",value:Te,onChange:p=>Ge(p),options:["Corporate","Hospital","Tour Company"]}),e.jsx(_a,{label:"Apply mode",value:We,onChange:p=>ze(p),options:["append","replace"],hint:"Append adds; replace overwrites."})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Templates generate flows per service module, marketplaces under E-Commerce, and RFQ."})]}),e.jsxs(ph,{open:Ee,title:"Publish approval workflows",subtitle:"Provide a reason. This would be audit logged in production.",onClose:()=>be(!1),actions:[{label:"Publish",onClick:E,variant:"default"},{label:"Cancel",onClick:()=>be(!1)}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Ds,{variant:"outline",onClick:()=>be(!1),children:"Cancel"}),e.jsxs(Ds,{variant:"primary",onClick:E,disabled:!pe||Fe.trim().length<8,children:[e.jsx(ct,{className:"h-4 w-4"})," Publish"]})]}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Draft contains changes compared to published configuration."}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Reason"}),e.jsx("textarea",{value:Fe,onChange:p=>Pe(p.target.value),placeholder:"Example: enable stricter MyLiveDealz approvals; add CFO stage for high-value purchases; keep pilot rollout",rows:4,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"}),e.jsxs("label",{className:"mt-3 flex items-start gap-3 rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("input",{type:"checkbox",checked:pe,onChange:p=>Q(p.target.checked),className:"mt-1 h-4 w-4 rounded border-slate-300"}),e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"I confirm this change is authorized and should be logged."})]}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Minimum reason length: 8 characters."})]})]})]});function v({title:p,value:M,icon:ee,tone:b}){const ae=b==="bad"?"bg-rose-50 text-rose-700":b==="warn"?"bg-amber-50 text-amber-800":b==="good"?"bg-emerald-50 text-emerald-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:p}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:M})]}),e.jsx("div",{className:ya("grid h-10 w-10 place-items-center rounded-2xl",ae),children:ee})]})})}}const uy={green:"#03CD8C",orange:"#F77F00"};function zV({actions:t}){const[s,a]=d.useState(!1),l=qt.useRef(null);return d.useEffect(()=>{function n(r){l.current&&!l.current.contains(r.target)&&a(!1)}return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"flex h-8 w-8 items-center justify-center rounded-full text-slate-500 hover:bg-slate-100",children:e.jsx(xs,{className:"h-4 w-4"})}),s&&e.jsx("div",{className:"absolute right-0 top-full z-50 mt-1 w-48 origin-top-right overflow-hidden rounded-2xl border border-slate-100 bg-white p-1 shadow-lg ring-1 ring-slate-200",children:t.map((n,r)=>e.jsx("button",{onClick:()=>{n.onClick(),a(!1)},className:ii("flex w-full items-center px-3 py-2 text-sm font-medium transition-colors hover:bg-slate-50",n.variant==="danger"?"text-rose-600":"text-slate-700"),children:n.label},r))})]})}function ii(...t){return t.filter(Boolean).join(" ")}function hh(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function xx(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function v0(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function WV(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function my(t){const s=Math.round((t-Date.now())/6e4),a=Math.abs(s),l=Math.floor(a/60),n=a%60,r=l?`${l}h ${n}m`:`${n}m`;return s>=0?`Due in ${r}`:`Overdue by ${r}`}function px(t){return Date.now()>t}function zE(t,s=120){const a=t-Date.now();return a>0&&a<=s*60*1e3}function au(t){return t==="High"?"bad":t==="Medium"?"warn":"good"}function xy(t){return t==="Approved"?"good":t==="Rejected"||t==="Breached"||t==="Escalated"?"bad":"warn"}function Ls({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:ii("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function oa({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:uy.green}:t==="accent"?{background:uy.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:ii(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function ld({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100 disabled:bg-slate-50 disabled:text-slate-500",children:l.map(i=>e.jsx("option",{value:i,children:i},i))})]})}function gh({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:i=>a(i.target.value),placeholder:l,rows:r,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"})]})}function xm({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="920px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[8vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-1",children:[o?e.jsx(zV,{actions:o}):null,e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function HV({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:ii("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function $4(t,s){const a={};for(const l of t){const n=s(l);a[n]=a[n]||[],a[n].push(l)}return a}function XV(t){const s=[];return t.length?(t.filter(c=>c.status==="Pending"||c.status==="Breached"||c.status==="Escalated"||c.status==="Needs info").length!==t.length&&s.push("Only open items can be bulk approved"),Array.from(new Set(t.map(c=>c.vendor))).length!==1&&s.push("Bulk approve requires the same vendor"),t.every(c=>c.risk==="Low")||s.push("Bulk approve requires low risk items"),t.some(c=>c.requiresAttachment&&!c.hasAttachment)&&s.push("All items must have required attachments"),t.reduce((c,x)=>c+x.amountUGX,0)>3e6&&s.push("Bulk approve total is above safeguard cap (UGX 3,000,000)"),{ok:s.length===0,reasons:s}):{ok:!1,reasons:["Select at least one item"]}}function KV(){var ee;const t=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],s=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],a=["Operations","Sales","Finance","Admin","Procurement"],[l,n]=d.useState([]),r=b=>{const ae=hh("toast");n(ve=>[{id:ae,...b},...ve].slice(0,4)),window.setTimeout(()=>n(ve=>ve.filter(O=>O.id!==ae)),3200)},i=Date.now(),[o,c]=d.useState(()=>[{id:"AP-1821",tx:"Purchase",module:"E-Commerce",marketplace:"MyLiveDealz",group:"Operations",requester:"Mary N.",vendor:"Shenzhen Store",amountUGX:654e3,createdAt:i-2*60*60*1e3,slaDueAt:i+2*60*60*1e3,status:"Pending",risk:"High",assignedTo:"Procurement Desk",patternKey:"vendor_anomaly_shenzhen",requiresAttachment:!0,hasAttachment:!0,requiresComment:!0,hasComment:!0,history:[{at:i-2*60*60*1e3,by:"System",action:"Created"}]},{id:"RFQ-390",tx:"RFQ",module:"Rides & Logistics",marketplace:"-",group:"Admin",requester:"Ronald I.",vendor:"Vehicle Supplier",amountUGX:285e6,createdAt:i-26*60*60*1e3,slaDueAt:i-2*60*60*1e3,status:"Escalated",risk:"High",assignedTo:"CFO",patternKey:"rfq_high_value",requiresAttachment:!0,hasAttachment:!0,requiresComment:!0,hasComment:!0,history:[{at:i-26*60*60*1e3,by:"System",action:"Created"},{at:i-18*60*60*1e3,by:"Manager",action:"Approved",why:"Needed"},{at:i-9*60*60*1e3,by:"Finance Desk",action:"Approved",why:"Budget check"}]},{id:"RD-0442",tx:"Ride",module:"Rides & Logistics",marketplace:"-",group:"Sales",requester:"John S.",vendor:"EVzone Rides",amountUGX:41500,createdAt:i-35*60*1e3,slaDueAt:i+3*60*60*1e3,status:"Pending",risk:"Low",assignedTo:"Approver Desk",patternKey:"commute_repeat",requiresAttachment:!1,hasAttachment:!1,requiresComment:!1,hasComment:!1,history:[{at:i-35*60*1e3,by:"System",action:"Created"}]},{id:"SV-2201",tx:"Service",module:"EVs & Charging",marketplace:"-",group:"Finance",requester:"Finance Desk",vendor:"EVzone Charging",amountUGX:18e5,createdAt:i-4*60*60*1e3,slaDueAt:i+1*60*60*1e3,status:"Pending",risk:"Medium",assignedTo:"Finance Desk",patternKey:"charging_credits",requiresAttachment:!0,hasAttachment:!1,requiresComment:!0,hasComment:!0,history:[{at:i-4*60*60*1e3,by:"System",action:"Created"}]},{id:"PO-9002",tx:"Purchase",module:"E-Commerce",marketplace:"EVmart",group:"Operations",requester:"Irene K.",vendor:"Kampala Office Mart",amountUGX:12e4,createdAt:i-90*60*1e3,slaDueAt:i+4*60*60*1e3,status:"Pending",risk:"Low",assignedTo:"Procurement Desk",patternKey:"low_risk_vendor",requiresAttachment:!1,hasAttachment:!1,requiresComment:!1,hasComment:!1,history:[{at:i-90*60*1e3,by:"System",action:"Created"}]},{id:"PO-9003",tx:"Purchase",module:"E-Commerce",marketplace:"EVmart",group:"Operations",requester:"Irene K.",vendor:"Kampala Office Mart",amountUGX:98e3,createdAt:i-120*60*1e3,slaDueAt:i+4*60*60*1e3,status:"Pending",risk:"Low",assignedTo:"Procurement Desk",patternKey:"low_risk_vendor",requiresAttachment:!1,hasAttachment:!1,requiresComment:!1,hasComment:!1,history:[{at:i-120*60*1e3,by:"System",action:"Created"}]},{id:"EX-0011",tx:"Exception",module:"Finance & Payments",marketplace:"-",group:"Finance",requester:"Daisy O.",vendor:"CorporatePay",amountUGX:0,createdAt:i-7*60*60*1e3,slaDueAt:i-20*60*1e3,status:"Breached",risk:"High",assignedTo:"Org Admin",patternKey:"policy_exception",requiresAttachment:!0,hasAttachment:!0,requiresComment:!0,hasComment:!0,history:[{at:i-7*60*60*1e3,by:"System",action:"Created"}]}]),[x,j]=d.useState(()=>[{id:"AUD-001",at:i-9*60*60*1e3,by:"Finance Desk",action:"Approve",itemId:"RFQ-390",why:"Budget confirmed"}]),[g]=d.useState(()=>[{id:"APR-01",name:"Approver Desk",role:"Approver Desk",load:4,ooo:!1},{id:"APR-02",name:"Procurement Desk",role:"Procurement Desk",load:6,ooo:!1},{id:"APR-03",name:"Finance Desk",role:"Finance Desk",load:7,ooo:!1},{id:"APR-04",name:"CFO",role:"CFO",load:1,ooo:!1},{id:"APR-05",name:"Org Admin",role:"Org Admin",load:2,ooo:!1}]),[y,$]=d.useState(""),[T,C]=d.useState("All"),[W,L]=d.useState("All"),[R,F]=d.useState("All"),[te,oe]=d.useState("All"),[G,H]=d.useState("All"),[Y,we]=d.useState("None"),[q,je]=d.useState("sla"),[_e,Ee]=d.useState("asc"),[be,Fe]=d.useState(new Set),[Pe,pe]=d.useState(!1),[Q,Re]=d.useState(""),[ce,xe]=d.useState(!1),[he,de]=d.useState(!1),[ye,Ke]=d.useState("Approve"),[Le,Ne]=d.useState([]),[ge,$e]=d.useState(""),[ie,Oe]=d.useState(!1),[Se,Te]=d.useState(null),[Ge,We]=d.useState("Supporting document added"),[ze,Ue]=d.useState(!1),[le,z]=d.useState(null),[Ae,Ve]=d.useState(((ee=g[0])==null?void 0:ee.name)||"Approver Desk"),[Ye,Be]=d.useState("Reassign to avoid SLA breach"),[w,B]=d.useState(!1),[ue,ne]=d.useState(null),Me=d.useMemo(()=>te==="All"||te==="E-Commerce",[te]),De=d.useMemo(()=>{const b=y.trim().toLowerCase();return o.filter(ae=>{if(T!=="All"&&ae.status!==T||W!=="All"&&ae.risk!==W||R!=="All"&&ae.group!==R||te!=="All"&&ae.module!==te)return!1;if(G!=="All"){if(Me){if(String(ae.marketplace)!==String(G))return!1}else if(G!=="-")return!1}return!(b&&!`${ae.id} ${ae.tx} ${ae.module} ${ae.marketplace} ${ae.group} ${ae.requester} ${ae.vendor} ${ae.status} ${ae.risk}`.toLowerCase().includes(b))}).sort((ae,ve)=>{const O=_e==="asc"?1:-1;return q==="sla"?O*(ae.slaDueAt-ve.slaDueAt):q==="amount"?O*(ae.amountUGX-ve.amountUGX):q==="group"?O*ae.group.localeCompare(ve.group):q==="module"?O*ae.module.localeCompare(ve.module):q==="marketplace"?O*String(ae.marketplace).localeCompare(String(ve.marketplace)):0})},[o,y,T,W,R,te,G,q,_e,Me]),fe=d.useMemo(()=>{if(Y==="None")return null;const ae=$4(De,O=>Y==="Vendor"?O.vendor:Y==="Requester"?O.requester:O.patternKey),ve=Object.keys(ae);return ve.sort((O,X)=>ae[X].length-ae[O].length),ve.map(O=>({key:O,items:ae[O]}))},[De,Y]),me=d.useMemo(()=>De.filter(b=>["Pending","Escalated","Breached","Needs info"].includes(b.status)).length,[De]),Xe=d.useMemo(()=>De.filter(b=>b.status==="Escalated").length,[De]),V=d.useMemo(()=>De.filter(b=>b.status==="Breached"||px(b.slaDueAt)).length,[De]),E=d.useMemo(()=>De.filter(b=>zE(b.slaDueAt)&&!px(b.slaDueAt)).length,[De]),u=d.useMemo(()=>o.filter(b=>be.has(b.id)),[o,be]),P=d.useMemo(()=>XV(u),[u]),se=()=>Fe(new Set),D=b=>{Fe(ae=>{const ve=new Set(ae);return ve.has(b)?ve.delete(b):ve.add(b),ve})},re=()=>{Fe(b=>{const ae=new Set(b);return De.forEach(ve=>ae.add(ve.id)),ae})},v=()=>{Fe(b=>{const ae=new Set(b);return De.forEach(ve=>ae.delete(ve.id)),ae})},k=(b,ae)=>{Ke(b),Ne(ae),$e(""),de(!0)},m=()=>{const b=ge.trim();if(b.length<8){r({title:"Reason required",message:"Add a clear comment or reason (min 8 chars).",kind:"warn"});return}const ae=Le,ve=Date.now();c(X=>X.map(A=>{if(!ae.includes(A.id)||ye==="Approve"&&A.requiresAttachment&&!A.hasAttachment)return A;const N=ye==="Approve"?"Approved":ye==="Reject"?"Rejected":"Changes requested";return{...A,status:N,hasComment:A.hasComment||!!b,history:[...A.history,{at:ve,by:"You",action:N,why:b}]}})),j(X=>[...ae.map(A=>({id:hh("AUD"),at:ve,by:"You",action:ye,itemId:A,why:b})),...X]);const O=o.filter(X=>ae.includes(X.id)&&ye==="Approve"&&X.requiresAttachment&&!X.hasAttachment);O.length?r({title:"Some items blocked",message:`Attachment required for ${O.length} item(s). Add attachment and try again.`,kind:"warn"}):r({title:"Done",message:`${ye} completed for ${ae.length} item(s).`,kind:ye==="Approve"?"success":"info"}),de(!1),Ne([]),$e(""),se()},S=()=>{if(!Se)return;const b=Date.now();c(ae=>ae.map(ve=>ve.id===Se?{...ve,hasAttachment:!0,history:[...ve.history,{at:b,by:"You",action:"Attachment added",why:Ge}]}:ve)),j(ae=>[{id:hh("AUD"),at:b,by:"You",action:"Attachment added",itemId:Se,why:Ge},...ae]),r({title:"Attachment added",message:`${Se} updated.",`,kind:"success"}),Oe(!1),Te(null)},f=b=>{var ae;z(b),Ve(((ae=g[0])==null?void 0:ae.name)||"Approver Desk"),Be("Reassign to avoid SLA breach"),Ue(!0)},U=()=>{if(!le)return;const b=Ye.trim();if(b.length<8){r({title:"Reason required",message:"Add a clear reason (min 8 chars).",kind:"warn"});return}const ae=Date.now();c(ve=>ve.map(O=>O.id===le?{...O,assignedTo:Ae,status:O.status==="Breached"?"Escalated":O.status,history:[...O.history,{at:ae,by:"You",action:`Delegated to ${Ae}`,why:b}]}:O)),j(ve=>[{id:hh("AUD"),at:ae,by:"You",action:"Delegate",itemId:le,why:b},...ve]),r({title:"Delegated",message:`${le} delegated to ${Ae}.`,kind:"success"}),Ue(!1),z(null)},p=d.useMemo(()=>{const b=o.filter(O=>["Pending","Needs info"].includes(O.status)),ae=$4(b,O=>`${O.vendor}||${O.risk}`);return Object.keys(ae).map(O=>{const X=ae[O],[A,N]=O.split("||"),h=X.reduce((K,_)=>K+_.amountUGX,0);return{vendor:A,risk:N,count:X.length,total:h,ids:X.map(K=>K.id)}}).filter(O=>O.count>=2).sort((O,X)=>X.count-O.count).slice(0,3)},[o]),M=d.useMemo(()=>o.filter(ae=>ae.status==="Escalated"||ae.status==="Breached"||px(ae.slaDueAt)).sort((ae,ve)=>ae.slaDueAt-ve.slaDueAt).slice(0,6),[o]);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(HV,{toasts:l,onDismiss:b=>n(ae=>ae.filter(ve=>ve.id!==b))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:uy.green},children:e.jsx(ig,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Approvals Inbox"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Unified approvals for rides, services, purchases, RFQs, quotes and exceptions."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(Ls,{label:`Open: ${me}`,tone:me?"warn":"good"}),E?e.jsx(Ls,{label:`Due soon: ${E}`,tone:"warn"}):e.jsx(Ls,{label:"No due soon",tone:"good"}),Xe?e.jsx(Ls,{label:`Escalated: ${Xe}`,tone:"bad"}):e.jsx(Ls,{label:"No escalations",tone:"good"}),V?e.jsx(Ls,{label:`Breached: ${V}`,tone:"bad"}):e.jsx(Ls,{label:"No breaches",tone:"good"}),be.size?e.jsx(Ls,{label:`Selected: ${be.size}`,tone:"info"}):null]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(oa,{variant:"outline",onClick:()=>{r({title:"Audit",message:"Open an item audit from the table.",kind:"info"})},children:[e.jsx(kt,{className:"h-4 w-4"})," Audit"]}),e.jsxs(oa,{variant:"outline",onClick:()=>{r({title:"Refresh",message:"Inbox refreshed (demo).",kind:"success"})},children:[e.jsx(sl,{className:"h-4 w-4"})," Refresh"]}),e.jsxs(oa,{variant:"primary",disabled:!be.size,onClick:()=>{Re(""),xe(!1),pe(!0)},children:[e.jsx(ht,{className:"h-4 w-4"})," Bulk actions"]})]})]}),e.jsxs("div",{className:"mt-4 flex flex-col gap-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-4 lg:grid-cols-6",children:[e.jsxs("div",{className:"md:col-span-2 rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsxs("div",{className:"mt-1 flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-2 py-2",children:[e.jsx(pa,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:y,onChange:b=>$(b.target.value),placeholder:"ID, requester, vendor...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"})]})]}),e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2",children:e.jsx(ld,{label:"Status",value:T,onChange:b=>C(b),options:["All","Pending","Needs info","Escalated","Breached","Approved","Rejected","Changes requested"]})}),e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2",children:e.jsx(ld,{label:"Risk",value:W,onChange:b=>L(b),options:["All","Low","Medium","High"]})}),e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2",children:e.jsx(ld,{label:"Group",value:R,onChange:b=>F(b),options:["All",...a]})}),e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2",children:e.jsx(ld,{label:"Module",value:te,onChange:b=>{oe(b),b!=="All"&&b!=="E-Commerce"&&H("All")},options:["All",...t]})})]}),e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:ii("min-w-[140px] rounded-2xl border px-3 py-2",Me?"border-slate-200 bg-white":"border-slate-200 bg-slate-50 opacity-70"),children:e.jsx(ld,{label:"Marketplace",value:String(G),onChange:b=>H(b),options:["All","-",...s],disabled:!Me})}),e.jsx("div",{className:"min-w-[180px] rounded-2xl border border-slate-200 bg-white px-3 py-2",children:e.jsx(ld,{label:"Sort by",value:`${q}:${_e}`,onChange:b=>{const[ae,ve]=b.split(":");je(ae),Ee(ve)},options:["sla:asc","sla:desc","amount:asc","amount:desc","group:asc","group:desc","module:asc","module:desc","marketplace:asc","marketplace:desc"]})}),e.jsx("div",{className:"hidden h-8 w-px bg-slate-200 md:block"}),e.jsxs(oa,{variant:"outline",onClick:()=>{$(""),C("All"),L("All"),F("All"),oe("All"),H("All"),we("None"),je("sla"),Ee("asc"),r({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(vn,{className:"h-4 w-4"})," Reset"]}),e.jsxs(oa,{variant:"outline",onClick:be.size?v:re,children:[e.jsx(Os,{className:"h-4 w-4"})," ",be.size?"Deselect visible":"Select visible"]}),be.size?e.jsxs(oa,{variant:"outline",onClick:se,children:[e.jsx(Qe,{className:"h-4 w-4"})," Clear selection"]}):null]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-2 rounded-2xl border border-slate-200 bg-white p-1",children:[e.jsx("button",{onClick:()=>we("None"),className:ii("rounded-xl px-3 py-1.5 text-xs font-semibold transition-colors",Y==="None"?"bg-slate-100 text-slate-900":"text-slate-500 hover:bg-slate-50"),children:"List"}),e.jsx("button",{onClick:()=>we("Vendor"),className:ii("rounded-xl px-3 py-1.5 text-xs font-semibold transition-colors",Y!=="None"?"bg-emerald-50 text-emerald-700 ring-1 ring-emerald-200":"text-slate-500 hover:bg-slate-50"),children:"Smart Grouping"})]})})]}),e.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[e.jsxs("div",{className:"rounded-3xl border border-rose-100 bg-white p-5 shadow-sm ring-4 ring-rose-50/50",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Escalation Panel"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Items requiring immediate attention."})]}),e.jsx("div",{className:"grid h-8 w-8 place-items-center rounded-full bg-rose-50 text-rose-600",children:e.jsx(Et,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{className:"rounded-2xl border border-rose-100 bg-rose-50/50 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-semibold text-rose-700",children:"Breached SLA"}),e.jsx("span",{className:"text-xs font-bold text-rose-800",children:"3"})]}),e.jsx("div",{className:"mt-2 h-1.5 w-full rounded-full bg-rose-100",children:e.jsx("div",{className:"h-full w-3/4 rounded-full bg-rose-500"})})]}),e.jsxs("div",{className:"rounded-2xl border border-amber-100 bg-amber-50/50 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-semibold text-amber-700",children:"High Risk"}),e.jsx("span",{className:"text-xs font-bold text-amber-800",children:"5"})]}),e.jsx("div",{className:"mt-2 h-1.5 w-full rounded-full bg-amber-100",children:e.jsx("div",{className:"h-full w-1/2 rounded-full bg-amber-500"})})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(oa,{variant:"outline",className:"w-full text-xs",onClick:()=>{L("High"),C("Breached"),r({title:"Filtered",message:"Showing high priority items.",kind:"warn"})},children:"View critical items"})})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"My Performance"}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-emerald-600",children:"12m"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Avg. response"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-slate-900",children:"85%"}),e.jsx("div",{className:"text-xs text-slate-500",children:"SLA adherence"})]})]})]})]})]})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[e.jsxs("div",{className:"flex flex-col-reverse gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[p.length?e.jsxs("div",{className:"rounded-3xl border border-indigo-100 bg-white p-5 shadow-sm ring-4 ring-indigo-50/50",children:[e.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-indigo-50 text-indigo-600",children:e.jsx(ht,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Smart grouping suggestions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"We found repeated patterns for bulk approval."})]})]}),e.jsx(Ls,{label:`${p.length} suggestion(s)`,tone:"info"})]}),e.jsx("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-3",children:p.map(b=>e.jsxs("div",{className:"group relative rounded-2xl border border-slate-200 bg-slate-50/50 p-4 transition-all hover:bg-white hover:shadow-md hover:ring-1 hover:ring-indigo-200",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:b.vendor}),e.jsxs("div",{className:"mt-0.5 text-xs text-slate-500",children:[b.count," items  ",xx(b.total)]})]}),e.jsx(Ls,{label:b.risk,tone:au(b.risk)})]}),e.jsx("div",{className:"mt-4 flex gap-2 opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx(oa,{variant:"primary",className:"h-8 w-full text-xs",disabled:b.risk!=="Low",onClick:()=>{Fe(new Set(b.ids)),Re(""),xe(!1),pe(!0)},children:"Bulk Approve"})}),e.jsxs("div",{className:"absolute bottom-4 right-4 text-xs font-semibold text-slate-400 group-hover:opacity-0",children:["Review ",b.count]})]},`${b.vendor}-${b.risk}`))})]}):null,Y==="None"?e.jsx(WE,{items:De,selected:be,onToggle:D,onOpenAudit:b=>{ne(b),B(!0)},onAddAttachment:b=>{Te(b),We("Supporting document added"),Oe(!0)},onDelegate:f,onAction:(b,ae)=>k(b,[ae])}):e.jsx(JV,{groups:fe||[],selected:be,onToggle:D,onOpenAudit:b=>{ne(b),B(!0)},onAddAttachment:b=>{Te(b),We("Supporting document added"),Oe(!0)},onDelegate:f,onAction:(b,ae)=>k(b,[ae])})]}),e.jsx("div",{className:"",children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Escalation panel"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Breached or escalated items. Delegate now to avoid further breaches."})]}),e.jsx(Ls,{label:"Premium",tone:"info"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:M.length?M.map(b=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:b.id}),e.jsx(Ls,{label:b.status,tone:xy(b.status)}),e.jsx(Ls,{label:b.risk,tone:au(b.risk)})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[b.module,b.module==="E-Commerce"?`  ${b.marketplace}`:""]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[b.requester,"  ",b.vendor]}),e.jsx("div",{className:"mt-2 text-xs font-semibold text-slate-700",children:my(b.slaDueAt)})]}),e.jsx(Et,{className:"h-5 w-5 text-rose-700"})]}),e.jsxs("div",{className:"mt-3 flex flex-col gap-2",children:[e.jsxs(oa,{variant:"outline",onClick:()=>{ne(b.id),B(!0)},children:[e.jsx(kt,{className:"h-4 w-4"})," View audit"]}),e.jsxs(oa,{variant:"primary",onClick:()=>f(b.id),children:[e.jsx(Os,{className:"h-4 w-4"})," Delegate now"]})]})]},b.id)):e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(yt,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No escalations"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"You are on track."})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Tip: tighten SLAs and enable load balancing in Approval Workflow Builder (J)."})]})})]}),be.size?e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Selection actions"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["You selected ",be.size," item(s). Bulk approve is restricted by safeguards."]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(oa,{variant:"outline",onClick:()=>k("Request changes",u.map(b=>b.id)),children:[e.jsx(en,{className:"h-4 w-4"})," Request changes"]}),e.jsxs(oa,{variant:"outline",onClick:()=>k("Reject",u.map(b=>b.id)),children:[e.jsx(Qe,{className:"h-4 w-4"})," Reject"]}),e.jsxs(oa,{variant:"primary",disabled:!P.ok,onClick:()=>{Re(""),xe(!1),pe(!0)},children:[e.jsx(ht,{className:"h-4 w-4"})," Bulk approve"]})]})]}),P.ok?e.jsx("div",{className:"mt-3 rounded-2xl border border-emerald-200 bg-emerald-50 p-3 text-xs text-emerald-900",children:"Eligible for bulk approve: same vendor, low risk, required attachments present, and total under cap."}):e.jsxs("div",{className:"mt-3 rounded-2xl border border-amber-200 bg-amber-50 p-3 text-xs text-amber-900",children:[e.jsx("div",{className:"font-semibold",children:"Bulk approve safeguards"}),e.jsx("ul",{className:"mt-2 space-y-1",children:P.reasons.map(b=>e.jsxs("li",{children:[" ",b]},b))})]})]}):null,e.jsx("div",{className:"mt-4 text-xs text-slate-500",children:"K Approvals Inbox v2: unified queue, sorting, actions with comments, attachment enforcement, audit trail, premium bulk approve safeguards, smart grouping, and escalation delegation."})]})]})}),e.jsxs(xm,{open:he,title:`${ye}`,subtitle:`Applies to ${Le.length} item(s). Comment is required.`,onClose:()=>de(!1),actions:[{label:"Confirm",onClick:m,variant:ye==="Reject"?"danger":"default"},{label:"Cancel",onClick:()=>de(!1)}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(oa,{variant:"outline",onClick:()=>de(!1),children:"Cancel"}),e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:e.jsxs(oa,{variant:ye==="Approve"?"primary":ye==="Reject"?"danger":"outline",onClick:m,children:[e.jsx(tt,{className:"h-4 w-4"})," Confirm"]})})]}),children:[e.jsx(gh,{label:"Comment and reason",value:ge,onChange:$e,placeholder:"Example: approvals aligned with policy and budget. Proceed.",hint:"Minimum 8 characters",rows:4}),e.jsx("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Attachment enforcement: Approve is blocked if required attachment is missing."}),e.jsx("div",{className:"mt-3 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"ID"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Risk"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Attachment"})]})}),e.jsx("tbody",{children:o.filter(b=>Le.includes(b.id)).map(b=>e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:b.id}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:xx(b.amountUGX)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:b.vendor}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Ls,{label:b.risk,tone:au(b.risk)})}),e.jsx("td",{className:"px-4 py-3",children:b.requiresAttachment?e.jsx(Ls,{label:b.hasAttachment?"Present":"Missing",tone:b.hasAttachment?"good":"bad"}):e.jsx(Ls,{label:"Not required",tone:"neutral"})})]},b.id))})]})})]}),e.jsxs(xm,{open:Pe,title:"Bulk approve",subtitle:"Premium safeguards apply. Same vendor and low risk only.",onClose:()=>pe(!1),actions:[{label:"Confirm bulk approve",onClick:()=>{k("Approve",u.map(b=>b.id)),pe(!1),$e(Q)},variant:"default"},{label:"Cancel",onClick:()=>pe(!1)}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(oa,{variant:"outline",onClick:()=>pe(!1),children:"Cancel"}),e.jsxs(oa,{variant:"primary",disabled:!P.ok||!ce||Q.trim().length<8,onClick:()=>{k("Approve",u.map(b=>b.id)),pe(!1),$e(Q)},children:[e.jsx(ht,{className:"h-4 w-4"})," Confirm bulk approve"]})]}),children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-700",children:["Selected: ",u.length," item(s)  Total: ",xx(u.reduce((b,ae)=>b+ae.amountUGX,0))]}),P.ok?e.jsx("div",{className:"mt-3 rounded-2xl border border-emerald-200 bg-emerald-50 p-3 text-xs text-emerald-900",children:"Safeguards satisfied. Bulk approve is allowed."}):e.jsxs("div",{className:"mt-3 rounded-2xl border border-amber-200 bg-amber-50 p-3 text-xs text-amber-900",children:[e.jsx("div",{className:"font-semibold",children:"Safeguards not satisfied"}),e.jsx("ul",{className:"mt-2 space-y-1",children:P.reasons.map(b=>e.jsxs("li",{children:[" ",b]},b))})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(gh,{label:"Reason",value:Q,onChange:Re,placeholder:"Example: low-risk recurring purchases from same vendor.",hint:"Minimum 8 characters",rows:3}),e.jsxs("label",{className:"mt-3 flex items-start gap-3 rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("input",{type:"checkbox",checked:ce,onChange:b=>xe(b.target.checked),className:"mt-1 h-4 w-4 rounded border-slate-300"}),e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"I confirm these approvals are authorized and will be audit logged."})]})]})]}),e.jsxs(xm,{open:ie,title:"Add attachment",subtitle:"Required attachment enforcement blocks approval without this.",onClose:()=>Oe(!1),actions:[{label:"Mark attached",onClick:S,variant:"default"},{label:"Cancel",onClick:()=>Oe(!1)}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(oa,{variant:"outline",onClick:()=>Oe(!1),children:"Cancel"}),e.jsxs(oa,{variant:"primary",onClick:S,children:[e.jsx(Nw,{className:"h-4 w-4"})," Mark attached"]})]}),children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Item: ",e.jsx("span",{className:"font-semibold text-slate-900",children:Se})]}),e.jsx(gh,{label:"Attachment note",value:Ge,onChange:We,placeholder:"Example: invoice PDF uploaded",rows:3}),e.jsx("div",{className:"mt-3 rounded-2xl border border-slate-200 bg-white p-3 text-xs text-slate-600",children:"Demo: this marks the item as having required attachment. In production, files are uploaded and scanned."})]}),e.jsxs(xm,{open:ze,title:"Delegate now",subtitle:"Premium: reassign escalated items to prevent SLA breaches.",onClose:()=>Ue(!1),actions:[{label:"Delegate",onClick:U,variant:"default"},{label:"Cancel",onClick:()=>Ue(!1)}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(oa,{variant:"outline",onClick:()=>Ue(!1),children:"Cancel"}),e.jsxs(oa,{variant:"primary",onClick:U,children:[e.jsx(Os,{className:"h-4 w-4"})," Delegate"]})]}),children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Item: ",e.jsx("span",{className:"font-semibold text-slate-900",children:le})]}),e.jsx(ld,{label:"Delegate to",value:Ae,onChange:Ve,options:g.map(b=>`${b.name}`),hint:"Pick an approver desk"}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2",children:g.map(b=>e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:b.name}),e.jsxs("div",{className:"mt-0.5 text-xs text-slate-500",children:["Role: ",b.role,"  Load: ",b.load,b.ooo?"  OOO":""]})]}),e.jsx(Ls,{label:b.load>=6?"Busy":"OK",tone:b.load>=6?"warn":"good"})]},b.id))}),e.jsx("div",{className:"mt-3",children:e.jsx(gh,{label:"Reason",value:Ye,onChange:Be,placeholder:"Example: CFO out of office, delegate to Org Admin",hint:"Minimum 8 characters",rows:3})})]}),e.jsx(xm,{open:w,title:"Audit trail",subtitle:"Who, when, and why.",onClose:()=>B(!1),actions:[{label:"Close",onClick:()=>B(!1)}],footer:e.jsx("div",{className:"flex justify-end",children:e.jsx(oa,{variant:"outline",onClick:()=>B(!1),children:"Close"})}),children:(()=>{const b=ue,ae=o.find(O=>O.id===b);if(!b||!ae)return e.jsx("div",{className:"text-sm text-slate-600",children:"Select an item to view audit."});const ve=x.filter(O=>O.itemId===b);return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:ae.id}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[ae.tx,"  ",ae.module,ae.module==="E-Commerce"?`  ${ae.marketplace}`:""]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(Ls,{label:ae.status,tone:xy(ae.status)}),e.jsx(Ls,{label:`Risk: ${ae.risk}`,tone:au(ae.risk)}),e.jsx(Ls,{label:`Assigned: ${ae.assignedTo}`,tone:"info"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Created"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:v0(ae.createdAt)}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:my(ae.slaDueAt)})]})]})}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Item history"}),e.jsx("div",{className:"mt-3 space-y-2",children:ae.history.slice().sort((O,X)=>X.at-O.at).map((O,X)=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:O.action}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["By ",O.by,"  ",v0(O.at)," (",WV(O.at),")"]}),O.why?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Why: ",O.why]}):null]}),e.jsx(Ls,{label:"History",tone:"neutral"})]})},X))})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Audit entries"}),e.jsx("div",{className:"mt-3 space-y-2",children:ve.length?ve.slice().sort((O,X)=>X.at-O.at).map(O=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:O.action}),e.jsx(Ls,{label:O.by,tone:"info"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[v0(O.at),"  ",O.id]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Why: ",O.why]})]}),e.jsxs(oa,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>navigator.clipboard.writeText(O.id),children:[e.jsx(ss,{className:"h-4 w-4"})," Copy ID"]})]})},O.id)):e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(kt,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No audit entries"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Actions create audit entries."})]})})]})]})})()}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"K Approvals Inbox v2. Core: unified queue, sorting, actions with comments, attachment enforcement, and audit trail. Premium: bulk approve safeguards, smart grouping, and escalation delegation."})})]})}function WE({items:t,selected:s,onToggle:a,onOpenAudit:l,onAddAttachment:n,onDelegate:r,onAction:i}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white shadow-sm overflow-visible",children:[e.jsxs("div",{className:"border-b border-slate-200 px-4 py-3",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Queue"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Approve, reject, request changes, attach docs, and view audit."})]}),e.jsx("div",{className:"hidden overflow-visible md:block",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold w-10",children:e.jsx("span",{className:"sr-only",children:"Select"})}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Details"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Requester/Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"SLA"}),e.jsx("th",{className:"px-4 py-3 font-semibold text-right",children:"Actions"})]})}),e.jsx("tbody",{children:t.map(o=>{const c=px(o.slaDueAt),x=zE(o.slaDueAt),j=o.requiresAttachment&&!o.hasAttachment;return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60 group",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"checkbox",checked:s.has(o.id),onChange:()=>a(o.id),className:"h-4 w-4 rounded border-slate-300 accent-emerald-500"})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:o.tx}),e.jsxs("div",{className:"text-xs text-slate-500",children:[o.module,"  ",o.marketplace]}),e.jsx("div",{className:"text-xs text-slate-400",children:o.group})]}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"text-slate-900",children:o.requester}),e.jsx("div",{className:"text-xs text-slate-500",children:o.vendor})]}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:xx(o.amountUGX)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-col gap-1 items-start",children:[e.jsx(Ls,{label:o.status,tone:xy(o.status)}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:ii("h-1.5 w-1.5 rounded-full",au(o.risk)==="bad"?"bg-rose-500":au(o.risk)==="warn"?"bg-amber-500":"bg-emerald-500")}),e.jsxs("span",{className:"text-xs text-slate-500",children:[o.risk," Risk"]})]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-col gap-1 items-start",children:[e.jsx(Ls,{label:my(o.slaDueAt),tone:c?"bad":x?"warn":"info"}),e.jsx("div",{className:"text-xs text-slate-500",children:v0(o.slaDueAt)})]})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx(QV,{item:o,onOpenAudit:l,onAddAttachment:n,onDelegate:r,onAction:i,approveBlocked:j})})]},o.id)})})]})})]})}function QV({item:t,onOpenAudit:s,onAddAttachment:a,onDelegate:l,onAction:n,approveBlocked:r}){const[i,o]=qt.useState(!1),c=qt.useRef(null);return qt.useEffect(()=>{function x(j){c.current&&!c.current.contains(j.target)&&o(!1)}return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]),e.jsxs("div",{className:"relative inline-block text-left",ref:c,children:[e.jsx("button",{onClick:()=>o(!i),className:"flex h-8 w-8 items-center justify-center rounded-full text-slate-400 hover:bg-slate-100 hover:text-slate-600",children:e.jsx(xs,{className:"h-4 w-4"})}),i&&e.jsxs("div",{className:"absolute right-0 top-9 z-10 mt-1 w-48 origin-top-right rounded-xl border border-slate-100 bg-white p-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",children:[e.jsx("div",{className:"px-3 py-2 text-xs font-semibold text-slate-400 uppercase tracking-wider border-b border-slate-50 mb-1",children:"Actions"}),e.jsxs("button",{onClick:()=>{n("Approve",t.id),o(!1)},disabled:r,className:ii("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-xs font-medium transition-colors mb-1",r?"cursor-not-allowed opacity-50 text-slate-400":"text-emerald-700 hover:bg-emerald-50"),children:[e.jsx(XF,{className:"h-4 w-4"})," Approve"]}),e.jsxs("button",{onClick:()=>{n("Reject",t.id),o(!1)},className:"flex w-full items-center gap-2 rounded-lg px-3 py-2 text-xs font-medium text-rose-700 hover:bg-rose-50 transition-colors mb-1",children:[e.jsx(YV,{className:"h-4 w-4"})," Reject"]}),e.jsxs("button",{onClick:()=>{n("Request changes",t.id),o(!1)},className:"flex w-full items-center gap-2 rounded-lg px-3 py-2 text-xs font-medium text-amber-700 hover:bg-amber-50 transition-colors",children:[e.jsx(sU,{className:"h-4 w-4"})," Request Changes"]}),e.jsx("div",{className:"my-1 border-t border-slate-100"}),e.jsxs("button",{onClick:()=>{s(t.id),o(!1)},className:"flex w-full items-center gap-2 rounded-lg px-3 py-2 text-xs font-medium text-slate-600 hover:bg-slate-50 transition-colors",children:[e.jsx(kt,{className:"h-4 w-4"})," View Audit"]}),t.requiresAttachment&&e.jsxs("button",{onClick:()=>{a(t.id),o(!1)},className:"flex w-full items-center gap-2 rounded-lg px-3 py-2 text-xs font-medium text-slate-600 hover:bg-slate-50 transition-colors",children:[e.jsx(Nw,{className:"h-4 w-4"})," ",t.hasAttachment?"View Attachment":"Add Attachment"]}),(t.status==="Escalated"||t.status==="Breached"||px(t.slaDueAt))&&e.jsxs("button",{onClick:()=>{l(t.id),o(!1)},className:"flex w-full items-center gap-2 rounded-lg px-3 py-2 text-xs font-medium text-slate-600 hover:bg-slate-50 transition-colors",children:[e.jsx(Os,{className:"h-4 w-4"})," Delegate"]})]})]})}function YV(t){return e.jsx(Qe,{...t})}function JV({groups:t,selected:s,onToggle:a,onOpenAudit:l,onAddAttachment:n,onDelegate:r,onAction:i}){return e.jsxs("div",{className:"space-y-3",children:[t.map(o=>e.jsx(ZV,{title:o.key,count:o.items.length,total:o.items.reduce((c,x)=>c+x.amountUGX,0),children:e.jsx(WE,{items:o.items,selected:s,onToggle:a,onOpenAudit:l,onAddAttachment:n,onDelegate:r,onAction:i})},o.key)),t.length?null:e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(ZF,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No groups"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Nothing matches your filters."})]})]})}function ZV({title:t,count:s,total:a,children:l}){const[n,r]=d.useState(!0);return e.jsxs("div",{className:"overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-sm",children:[e.jsxs("button",{type:"button",className:"flex w-full items-start justify-between gap-3 px-4 py-4 text-left",onClick:()=>r(i=>!i),children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),e.jsx(Ls,{label:`${s} item(s)`,tone:"neutral"}),e.jsx(Ls,{label:`Total ${xx(a)}`,tone:"info"})]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Smart grouping stack"})]}),e.jsx(ni,{className:ii("h-5 w-5 text-slate-500 transition",n?"rotate-180":"rotate-0")})]}),e.jsx(lt,{initial:!1,children:n?e.jsx(qe.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.18},className:"border-t border-slate-200",children:e.jsx("div",{className:"p-4",children:l})}):null})]})}const Kx={green:"#03CD8C",orange:"#F77F00"};function al(...t){return t.filter(Boolean).join(" ")}function pc(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function e_(t,s,a){return Math.max(s,Math.min(a,t))}function us(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function Qv(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function fh(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function cr(t,s){return s<=0?0:Math.round(t/s*100)}function L4(t){return t==="Critical"?"bad":t==="Warning"?"warn":"info"}function F4(t){return t==="Hard"?"warn":"neutral"}function Is({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:al("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function rs({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:Kx.green}:t==="accent"?{background:Kx.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:al(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function t_({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:al("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:al("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function U4({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:al(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:al("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function vh({label:t,value:s,onChange:a,hint:l,disabled:n}){return e.jsxs("div",{className:al(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",value:s,onChange:r=>a(Number(r.target.value||0)),disabled:n,className:al("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function ql({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:al(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:al("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i,children:i},i))})]})}function Yv({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:i=>a(i.target.value),placeholder:l,rows:r,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"})]})}function s_({actions:t}){const[s,a]=d.useState(!1);return e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 focus:bg-slate-100 focus:outline-none",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>a(!1)}),e.jsx("div",{className:"absolute right-0 top-full z-40 mt-1 w-48 overflow-hidden rounded-xl border border-slate-200 bg-white shadow-xl ring-1 ring-slate-200",children:t.map((l,n)=>e.jsx("button",{onClick:()=>{l.onClick(),a(!1)},className:al("block w-full px-4 py-2.5 text-left text-sm font-medium transition hover:bg-slate-50",l.variant==="danger"?"text-rose-700 hover:bg-rose-50":"text-slate-700"),children:l.label},n))})]})]})}function bh({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="920px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[8vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-1",children:[o?e.jsx(s_,{actions:o}):null,e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function a_({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:al("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function hc({title:t,value:s,sub:a,icon:l,tone:n="neutral"}){const r=n==="good"?"bg-emerald-50 text-emerald-700":n==="warn"?"bg-amber-50 text-amber-800":n==="bad"?"bg-rose-50 text-rose-700":n==="info"?"bg-blue-50 text-blue-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:t}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:s}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a})]}),e.jsx("div",{className:al("grid h-10 w-10 place-items-center rounded-2xl",r),children:l})]})})}function pm({valuePct:t,labelLeft:s,labelRight:a}){const l=e_(t,0,140);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-600",children:[e.jsx("span",{className:"font-semibold",children:s}),e.jsx("span",{className:"font-semibold",children:a})]}),e.jsx("div",{className:"mt-2 h-2 w-full overflow-hidden rounded-full bg-slate-100",children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${Math.min(100,l)}%`,background:Kx.green}})}),l>100?e.jsxs("div",{className:"mt-2 text-xs font-semibold text-rose-700",children:["Over by ",Math.round((l-100)*10)/10,"%"]}):null]})}function V4(t,s){return s<=0?1/0:t/s}function l_(){const t=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],s=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],a=["Operations","Sales","Finance","Admin","Procurement"],l=[{id:"U-1001",name:"Mary N.",group:"Operations",role:"Manager",autoApprovalEligible:!0},{id:"U-1002",name:"John S.",group:"Sales",role:"Employee",autoApprovalEligible:!1},{id:"U-1003",name:"Irene K.",group:"Operations",role:"Travel Coordinator",autoApprovalEligible:!0},{id:"U-1004",name:"Daisy O.",group:"Finance",role:"Accountant",autoApprovalEligible:!0},{id:"U-1005",name:"Procurement Desk",group:"Procurement",role:"Approver",autoApprovalEligible:!0}],[n,r]=d.useState([]),i=v=>{const k=pc("toast");r(m=>[{id:k,...v},...m].slice(0,4)),window.setTimeout(()=>r(m=>m.filter(S=>S.id!==k)),3200)},o=8,c=30,[x,j]=d.useState(()=>{const v=Date.now();return[{id:"B-ORG",scope:"Org",period:"Monthly",capType:"Hard",amountUGX:4e7,usedUGX:325e5,updatedAt:v-2*24*60*60*1e3,updatedBy:"Org Admin",notes:"Primary monthly budget"},{id:"B-G-OPS",scope:"Group",period:"Monthly",capType:"Soft",amountUGX:15e6,usedUGX:12e6,group:"Operations",updatedAt:v-24*60*60*1e3,updatedBy:"Org Admin",notes:"Operations monthly allocation"},{id:"B-G-SALES",scope:"Group",period:"Monthly",capType:"Soft",amountUGX:12e6,usedUGX:98e5,group:"Sales",updatedAt:v-24*60*60*1e3,updatedBy:"Org Admin"},{id:"B-G-FIN",scope:"Group",period:"Monthly",capType:"Hard",amountUGX:6e6,usedUGX:52e5,group:"Finance",updatedAt:v-48*60*60*1e3,updatedBy:"Org Admin"},{id:"B-MOD-RIDES",scope:"Module",period:"Monthly",capType:"Soft",amountUGX:16e6,usedUGX:142e5,module:"Rides & Logistics",updatedAt:v-3*24*60*60*1e3,updatedBy:"Finance Desk",notes:"Soft cap, above routes to approvals"},{id:"B-MKT-MYLIVE",scope:"Marketplace",period:"Monthly",capType:"Hard",amountUGX:6e6,usedUGX:52e5,module:"E-Commerce",marketplace:"MyLiveDealz",updatedAt:v-3*24*60*60*1e3,updatedBy:"Procurement Desk",notes:"High risk marketplace hard cap"}]}),[g,y]=d.useState(()=>{const v=Date.now();return[{id:"UC-1001",userId:"U-1001",period:"Monthly",capType:"Soft",amountUGX:3e6,usedUGX:21e5,updatedAt:v-3*24*60*60*1e3,updatedBy:"Org Admin"},{id:"UC-1002",userId:"U-1002",period:"Monthly",capType:"Hard",amountUGX:12e5,usedUGX:9e5,updatedAt:v-3*24*60*60*1e3,updatedBy:"Org Admin"},{id:"UC-1003",userId:"U-1003",period:"Monthly",capType:"Soft",amountUGX:2e6,usedUGX:14e5,updatedAt:v-3*24*60*60*1e3,updatedBy:"Org Admin"}]}),[$,T]=d.useState(()=>{const v=Date.now();return[{id:"AL-01",ts:v-50*60*1e3,severity:"Warning",title:"Sales group at 82%",message:"Sales group is above 80% of monthly cap. Consider enforce or adjust.",relatedIds:["B-G-SALES"]},{id:"AL-02",ts:v-20*60*1e3,severity:"Critical",title:"Finance group nearing hard cap",message:"Finance group hard cap is close. Remaining is under UGX 1,000,000.",relatedIds:["B-G-FIN"]}]}),[C,W]=d.useState(()=>{const v=Date.now();return[{id:"H-01",ts:v-3*24*60*60*1e3,actor:"Org Admin",type:"Budget updated",details:"Updated org monthly budget to UGX 40,000,000"},{id:"H-02",ts:v-2*24*60*60*1e3,actor:"Org Admin",type:"Budget updated",details:"Updated Operations budget to UGX 15,000,000"},{id:"H-03",ts:v-9*60*60*1e3,actor:"System",type:"Spend applied",details:"Applied spend UGX 82,000 to Rides & Logistics for John S."}]}),[L,R]=d.useState(()=>[{id:"EXC-01",createdAt:Date.now()-18*60*60*1e3,createdBy:"Finance Desk",status:"Pending",targetType:"Group",targetId:"B-G-FIN",extraAmountUGX:15e5,reason:"Urgent month-end reconciliations and payouts",attachmentsProvided:!0,approver:"Org Admin"}]),[F,te]=d.useState("budgets"),[oe,G]=d.useState(!1),[H,Y]=d.useState(()=>({id:"",scope:"Group",period:"Monthly",capType:"Soft",amountUGX:1e6,usedUGX:0,group:"Operations",updatedAt:Date.now(),updatedBy:"You",notes:""})),[we,q]=d.useState(!1),[je,_e]=d.useState(()=>{const v=Date.now();return{id:"",userId:l[0].id,period:"Monthly",capType:"Soft",amountUGX:5e5,usedUGX:0,updatedAt:v,updatedBy:"You"}}),[Ee,be]=d.useState(!1),[Fe,Pe]=d.useState(()=>({userId:l[1].id,module:"Rides & Logistics",marketplace:"-",amountUGX:85e3,vendor:"EVzone Rides",risk:"Low",note:"Client meeting ride"})),[pe,Q]=d.useState(!1),[Re,ce]=d.useState(()=>({id:"",createdAt:Date.now(),createdBy:"You",status:"Pending",targetType:"Group",targetId:"B-G-FIN",extraAmountUGX:1e6,reason:"",attachmentsProvided:!0,approver:"Org Admin"})),[xe,he]=d.useState(""),[de,ye]=d.useState("All"),[Ke,Le]=d.useState("runrate"),Ne=d.useMemo(()=>x.find(v=>v.scope==="Org")||null,[x]),ge=(Ne==null?void 0:Ne.usedUGX)||x.filter(v=>v.scope==="Org").reduce((v,k)=>v+k.usedUGX,0),$e=(Ne==null?void 0:Ne.amountUGX)||x.filter(v=>v.scope==="Org").reduce((v,k)=>v+k.amountUGX,0),ie=Math.max(0,$e-ge),Oe=d.useMemo(()=>ge/o,[ge]),Se=d.useMemo(()=>V4(ie,Oe),[ie,Oe]),Te=d.useMemo(()=>Math.round(ge/o*c),[ge]),Ge=d.useMemo(()=>$.slice().sort((v,k)=>k.ts-v.ts),[$]),We=d.useMemo(()=>({Operations:[118e5,124e5,131e5],Sales:[82e5,91e5,99e5],Finance:[43e5,51e5,56e5],Admin:[31e5,37e5,39e5],Procurement:[24e5,29e5,32e5]}),[]),ze=d.useMemo(()=>a.map(k=>{const m=We[k],S=m.reduce((p,M)=>p+M,0)/m.length,f=Math.max(...m),U=Math.round(Math.max(S,f)*1.15);return{group:k,avg:Math.round(S),p90:f,suggested:U}}),[a,We]),Ue=d.useMemo(()=>x.filter(k=>k.scope==="Group"&&k.period==="Monthly").map(k=>{const m=k.usedUGX/o,S=Math.round(m*c),f=Math.max(0,k.amountUGX-k.usedUGX),U=V4(f,m);return{...k,forecast:S,burnPerDay:m,runway:U}}),[x]),le=d.useMemo(()=>{const v=xe.trim().toLowerCase();return Ue.filter(k=>{const m=de==="All"?!0:k.group===de,S=v?String(k.group||"").toLowerCase().includes(v):!0;return m&&S})},[Ue,de,xe]),z=d.useMemo(()=>x.filter(k=>k.scope==="Module"&&k.period==="Monthly").map(k=>{const m=k.usedUGX/o,S=Math.round(m*c);return{...k,forecast:S,burnPerDay:m}}),[x]),Ae=d.useMemo(()=>x.filter(k=>k.scope==="Marketplace"&&k.period==="Monthly").map(k=>{const m=k.usedUGX/o,S=Math.round(m*c);return{...k,forecast:S,burnPerDay:m}}),[x]),Ve=v=>{W(k=>[{id:pc("H"),...v},...k])},Ye=v=>{T(k=>[{id:pc("AL"),...v},...k].slice(0,40))},Be=()=>{const v={budgets:x,userCaps:g,alerts:$,history:C,exceptions:L,exportedAt:new Date().toISOString()},k=JSON.stringify(v,null,2),m=new Blob([k],{type:"application/json"}),S=URL.createObjectURL(m),f=document.createElement("a");f.href=S,f.download="corporatepay-budgets-controls.json",f.click(),URL.revokeObjectURL(S),i({title:"Exported",message:"Downloaded JSON config.",kind:"success"})},w=async()=>{const v={budgets:x,userCaps:g,alerts:$,history:C,exceptions:L};try{await navigator.clipboard.writeText(JSON.stringify(v,null,2)),i({title:"Copied",message:"Copied JSON to clipboard.",kind:"success"})}catch{i({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},B=()=>{const v=Date.now();Y({id:"",scope:"Group",period:"Monthly",capType:"Soft",amountUGX:1e6,usedUGX:0,group:"Operations",updatedAt:v,updatedBy:"You",notes:""}),G(!0)},ue=v=>{Y(JSON.parse(JSON.stringify(v))),G(!0)},ne=()=>{if(H.amountUGX<=0){i({title:"Invalid amount",message:"Budget amount must be greater than zero.",kind:"warn"});return}if(H.scope==="Marketplace"&&H.module!=="E-Commerce"){i({title:"Invalid scope",message:"Marketplace budgets must be under E-Commerce.",kind:"warn"});return}const v=Date.now(),k=!H.id,m=k?pc("B"):H.id;j(S=>{const f=S.slice(),U=f.findIndex(M=>M.id===m),p={...H,id:m,updatedAt:v,updatedBy:"You"};return U>=0?f[U]=p:f.unshift(p),f}),Ve({ts:v,actor:"You",type:k?"Budget created":"Budget updated",details:`${k?"Created":"Updated"} ${H.scope} budget (${m}) to ${us(H.amountUGX)} (${H.capType})`}),i({title:"Saved",message:"Budget saved.",kind:"success"}),G(!1)},Me=v=>{j(k=>k.filter(m=>m.id!==v)),Ve({ts:Date.now(),actor:"You",type:"Budget updated",details:`Deleted budget ${v}`}),i({title:"Deleted",message:`Budget ${v} removed.",`,kind:"info"})},De=()=>{const v=Date.now();_e({id:"",userId:l[0].id,period:"Monthly",capType:"Soft",amountUGX:5e5,usedUGX:0,updatedAt:v,updatedBy:"You"}),q(!0)},fe=v=>{_e(JSON.parse(JSON.stringify(v))),q(!0)},me=()=>{if(je.amountUGX<=0){i({title:"Invalid amount",message:"Cap amount must be greater than zero.",kind:"warn"});return}const v=Date.now(),k=!je.id,m=k?pc("UC"):je.id;y(S=>{const f=S.slice(),U=f.findIndex(M=>M.id===m),p={...je,id:m,updatedAt:v,updatedBy:"You"};return U>=0?f[U]=p:f.unshift(p),f}),Ve({ts:v,actor:"You",type:"User cap updated",details:`${k?"Created":"Updated"} user cap (${m}) to ${us(je.amountUGX)} (${je.capType})`}),i({title:"Saved",message:"User cap saved.",kind:"success"}),q(!1)},Xe=(v,k)=>{ce({id:"",createdAt:Date.now(),createdBy:"You",status:"Pending",targetType:v||"Group",targetId:k||"B-G-FIN",extraAmountUGX:1e6,reason:"",attachmentsProvided:!0,approver:"Org Admin"}),Q(!0)},V=()=>{if(Re.reason.trim().length<10){i({title:"Reason required",message:"Provide a clear reason (min 10 chars).",kind:"warn"});return}const v=Date.now(),k={...Re,id:pc("EXC"),createdAt:v,createdBy:"You",status:"Pending"};R(m=>[k,...m]),Ve({ts:v,actor:"You",type:"Exception requested",details:`Requested emergency exception ${k.id} (+${us(k.extraAmountUGX)}) for ${k.targetType} ${k.targetId}`}),Ye({ts:v,severity:"Warning",title:"Emergency exception requested",message:`${k.id} pending approval.`,relatedIds:[k.targetId]}),i({title:"Requested",message:"Emergency exception submitted.",kind:"success"}),Q(!1)},E=(v,k)=>{const m=Date.now();if(R(S=>S.map(f=>f.id===v?{...f,status:k,decisionNote:k==="Approved"?"Approved":"Rejected",approver:"Org Admin"}:f)),Ve({ts:m,actor:"Org Admin",type:k==="Approved"?"Exception approved":"Exception rejected",details:`${k} emergency exception ${v}`}),k==="Approved"){const S=L.find(f=>f.id===v);S&&(S.targetType==="User"?y(f=>f.map(U=>U.userId===S.targetId?{...U,amountUGX:U.amountUGX+S.extraAmountUGX,updatedAt:m,updatedBy:"Org Admin"}:U)):j(f=>f.map(U=>U.id===S.targetId?{...U,amountUGX:U.amountUGX+S.extraAmountUGX,updatedAt:m,updatedBy:"Org Admin",notes:`${U.notes||""} (Exception ${v})`}:U))),Ye({ts:m,severity:"Info",title:"Emergency exception approved",message:`${v} approved and applied to limits.",`,relatedIds:[v]}),i({title:"Approved",message:"Exception applied to limits.",kind:"success"})}else Ye({ts:m,severity:"Info",title:"Emergency exception rejected",message:`${v} rejected.",`,relatedIds:[v]}),i({title:"Rejected",message:"Exception rejected.",kind:"info"})},u=()=>{Pe({userId:l[1].id,module:"Rides & Logistics",marketplace:"-",amountUGX:85e3,vendor:"EVzone Rides",risk:"Low",note:"Client meeting ride"}),be(!0)},P=v=>l.find(k=>k.id===v)||l[0],se=()=>{const v=Date.now(),k=P(Fe.userId);Ve({ts:v,actor:"System",type:"Spend attempted",details:`Spend attempt ${us(Fe.amountUGX)} by ${k.name} in ${Fe.module}${Fe.module==="E-Commerce"?` (${Fe.marketplace})`:""}`});const m=[],S=x.find(b=>b.scope==="Org"&&b.period==="Monthly");S&&m.push(S);const f=x.find(b=>b.scope==="Group"&&b.group===k.group&&b.period==="Monthly");f&&m.push(f);const U=x.find(b=>b.scope==="Module"&&b.module===Fe.module&&b.period==="Monthly");if(U&&m.push(U),Fe.module==="E-Commerce"&&Fe.marketplace!=="-"){const b=x.find(ae=>ae.scope==="Marketplace"&&ae.marketplace===Fe.marketplace&&ae.period==="Monthly");b&&m.push(b)}const p=g.find(b=>b.userId===k.id&&b.period==="Monthly")||null,M=[];for(const b of m)b.capType==="Hard"&&b.usedUGX+Fe.amountUGX>b.amountUGX&&M.push({label:`${b.scope} budget ${b.id}`,id:b.id});if(p&&p.capType==="Hard"&&p.usedUGX+Fe.amountUGX>p.amountUGX&&M.push({label:`User cap ${p.id}`,id:p.id}),M.length){Ve({ts:v,actor:"System",type:"Hard cap blocked",details:`Blocked by: ${M.map(b=>b.label).join(", ")}`}),Ye({ts:v,severity:"Critical",title:"Hard cap blocked",message:'Spend blocked by hard cap. Consider emergency exception if urgent.",',relatedIds:M.map(b=>b.id)}),i({title:"Blocked",message:"Hard cap blocked this spend.",kind:"warn"}),be(!1);return}j(b=>b.map(ae=>{if(!m.find(X=>X.id===ae.id))return ae;const O=ae.usedUGX+Fe.amountUGX;return{...ae,usedUGX:O}})),p&&y(b=>b.map(ae=>ae.id===p.id?{...ae,usedUGX:ae.usedUGX+Fe.amountUGX}:ae));const ee=(b,ae,ve,O,X)=>{const A=cr(ve-Fe.amountUGX,O),N=cr(ve,O);N>=100&&A<100?Ye({ts:v,severity:X==="Hard"?"Critical":"Warning",title:`${b} reached 100%`,message:`${ae} reached its limit.",`,relatedIds:[ae]}):N>=80&&A<80&&Ye({ts:v,severity:"Warning",title:`${b} at 80%`,message:`${ae} is above 80% of its cap.",`,relatedIds:[ae]})};for(const b of m){const ae=x.find(O=>O.id===b.id),ve=((ae==null?void 0:ae.usedUGX)||b.usedUGX)+Fe.amountUGX;ee(`${b.scope}`,b.id,ve,b.amountUGX,b.capType),b.capType==="Soft"&&ve>b.amountUGX&&Ye({ts:v,severity:"Warning",title:"Soft cap exceeded",message:`${b.id} exceeded soft cap. Routed to approvals in production.",`,relatedIds:[b.id]})}if(p){const b=p.usedUGX+Fe.amountUGX;ee("User cap",p.id,b,p.amountUGX,p.capType),p.capType==="Soft"&&b>p.amountUGX&&Ye({ts:v,severity:"Warning",title:"User soft cap exceeded",message:`${k.name} exceeded their soft cap. Consider adjust or enforce.",`,relatedIds:[p.id]})}Ve({ts:v,actor:"System",type:"Spend applied",details:`Applied spend ${us(Fe.amountUGX)} by ${k.name}.`}),i({title:"Applied",message:"Spend applied and budgets updated.",kind:"success"}),be(!1)},D=$e>0?ge/$e*100:0;return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(a_,{toasts:n,onDismiss:v=>r(k=>k.filter(m=>m.id!==v))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:Kx.green},children:e.jsx(ox,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Budgets, Spend Limits and Controls"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Org budgets, group budgets, user caps, alerts, forecasting, and emergency exceptions."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(Is,{label:`Period: Monthly (Day ${o}/${c})`,tone:"neutral"}),e.jsx(Is,{label:`Org used: ${Math.round(D)}%`,tone:D>=90?"warn":"good"}),e.jsx(Is,{label:`Alerts: ${$.length}`,tone:$.some(v=>v.severity==="Critical")?"bad":"info"}),e.jsx(Is,{label:"Premium forecasting",tone:"info"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(rs,{variant:"outline",onClick:w,children:[e.jsx(ss,{className:"h-4 w-4"})," Copy JSON"]}),e.jsxs(rs,{variant:"outline",onClick:Be,children:[e.jsx(pt,{className:"h-4 w-4"})," Export"]}),e.jsxs(rs,{variant:"outline",onClick:u,children:[e.jsx(Ia,{className:"h-4 w-4"})," Simulate spend"]}),e.jsxs(rs,{variant:"primary",onClick:B,children:[e.jsx(gt,{className:"h-4 w-4"})," New budget"]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-6",children:[e.jsx(hc,{title:"Org budget",value:us($e),sub:"Monthly",icon:e.jsx(ox,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(hc,{title:"Spent",value:us(ge),sub:`MTD (Day ${o})`,icon:e.jsx(Er,{className:"h-5 w-5"}),tone:D>=90?"warn":"good"}),e.jsx(hc,{title:"Remaining",value:us(ie),sub:"Available this period",icon:e.jsx(Ia,{className:"h-5 w-5"}),tone:ie<=2e6?"warn":"neutral"}),e.jsx(hc,{title:"Runway",value:Se===1/0?"":`${Math.max(0,Math.round(Se))} days`,sub:"At current burn",icon:e.jsx(sl,{className:"h-5 w-5"}),tone:Se!==1/0&&Se<=5?"warn":"neutral"}),e.jsx(hc,{title:"Forecast",value:us(Te),sub:Te>$e?"Over budget risk":"Within budget",icon:e.jsx(zd,{className:"h-5 w-5"}),tone:Te>$e?"warn":"good"}),e.jsx(hc,{title:"Exceptions",value:`${L.filter(v=>v.status==="Pending").length} pending`,sub:"Emergency workflow",icon:e.jsx(yt,{className:"h-5 w-5"}),tone:L.some(v=>v.status==="Pending")?"info":"neutral"})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx(pm,{valuePct:D,labelLeft:"Org usage",labelRight:`${Math.round(D)}%`}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Hard cap blocks spend. Soft cap allows spend but triggers alerts and routes to approvals in production."})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"budgets",label:"Budgets"},{id:"caps",label:"User caps"},{id:"history",label:"Allocation history"},{id:"forecast",label:"Forecasting"},{id:"exceptions",label:"Emergency exceptions"}].map(v=>e.jsx("button",{className:al("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",F===v.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:F===v.id?{background:Kx.green}:void 0,onClick:()=>te(v.id),children:v.label},v.id))})]}),e.jsx("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Alerts"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Real-time cap breach alerts and policy reminders."})]}),e.jsx(Is,{label:"Live",tone:"info"})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[Ge.slice(0,6).map(v=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Is,{label:v.severity,tone:L4(v.severity)}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:v.title})]}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:v.message}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:[fh(v.ts),"  ",Qv(v.ts)]})]}),e.jsx(Et,{className:al("h-5 w-5",v.severity==="Critical"?"text-rose-700":v.severity==="Warning"?"text-amber-700":"text-blue-700")})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(rs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>i({title:"Rule",message:"Create rule from this alert (see J).",kind:"info"}),children:[e.jsx(ht,{className:"h-4 w-4"})," Create rule"]}),e.jsxs(rs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Xe("Org","B-ORG"),children:[e.jsx(yt,{className:"h-4 w-4"})," Exception"]})]})]},v.id)),Ge.length?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No alerts."})]})]}),e.jsxs("div",{className:"space-y-4",children:[F==="budgets"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Budgets"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Org, group, module, and marketplace budgets."})]}),e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:e.jsxs(rs,{variant:"outline",onClick:B,children:[e.jsx(gt,{className:"h-4 w-4"})," Add budget"]})})]}),e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Scope"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Target"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Period"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Cap type"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Used"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Limit"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Usage"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[x.slice().sort((v,k)=>v.scope==="Org"?-1:k.scope==="Org"?1:v.scope.localeCompare(k.scope)).map(v=>{const k=cr(v.usedUGX,v.amountUGX),m=v.usedUGX>v.amountUGX,S=k>=80,f=v.scope==="Org"?"Organization":v.scope==="Group"?v.group:v.scope==="Module"?v.module:`${v.marketplace}`;return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx(Is,{label:v.scope,tone:"neutral"})}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:f||"-"}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:v.period}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Is,{label:v.capType,tone:F4(v.capType)})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:us(v.usedUGX)}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:us(v.amountUGX)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(Is,{label:`${k}%`,tone:m?"bad":S?"warn":"good"}),e.jsxs("div",{className:"text-xs text-slate-500",children:["Updated ",fh(v.updatedAt)]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(rs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ue(v),children:"Edit"}),e.jsxs(rs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Xe(v.scope==="Org"?"Org":v.scope==="Group"?"Group":v.scope==="Module"?"Module":"Marketplace",v.id),children:[e.jsx(yt,{className:"h-4 w-4"})," Exception"]}),e.jsx(rs,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>Me(v.id),children:e.jsx(Qe,{className:"h-4 w-4"})})]})})]},v.id)}),x.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No budgets configured."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Core: hard cap vs soft cap, budget periods, allocation history, real-time alerts. Premium: forecasting and suggested caps."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Premium: suggested caps"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Based on historical spend. Apply to group budgets."})]}),e.jsx(Is,{label:"Premium",tone:"info"})]}),e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Avg"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Max"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Suggested"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Apply"})]})}),e.jsx("tbody",{children:ze.map(v=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:v.group}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:us(v.avg)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:us(v.p90)}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:us(v.suggested)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(rs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{const k=Date.now();j(m=>m.map(S=>S.scope==="Group"&&S.group===v.group?{...S,amountUGX:v.suggested,updatedAt:k,updatedBy:"You",notes:`${S.notes||""} (Suggested caps applied)`}:S)),Ve({ts:k,actor:"You",type:"Budget updated",details:`Applied suggested cap for ${v.group} to ${us(v.suggested)}`}),i({title:"Applied",message:`Updated ${v.group} budget.",`,kind:"success"})},children:"Apply"})})]},v.group))})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Suggested caps are guidance. Keep stricter controls for high-risk modules and marketplaces."})]})]}):null,F==="caps"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"User caps"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"User spend caps by period. Hard cap blocks, soft cap warns."})]}),e.jsxs(rs,{variant:"primary",onClick:De,children:[e.jsx(gt,{className:"h-4 w-4"})," Add cap"]})]}),e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"User"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Eligible"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Cap type"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Used"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Limit"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Usage"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[g.map(v=>{const k=l.find(U=>U.id===v.userId),m=cr(v.usedUGX,v.amountUGX),S=m>=80,f=v.usedUGX>v.amountUGX;return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:(k==null?void 0:k.name)||v.userId}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(k==null?void 0:k.group)||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Is,{label:k!=null&&k.autoApprovalEligible?"Yes":"No",tone:k!=null&&k.autoApprovalEligible?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Is,{label:v.capType,tone:F4(v.capType)})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:us(v.usedUGX)}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:us(v.amountUGX)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Is,{label:`${m}%`,tone:f?"bad":S?"warn":"good"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(rs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>fe(v),children:"Edit"}),e.jsxs(rs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Xe("User",v.userId),children:[e.jsx(yt,{className:"h-4 w-4"})," Exception"]})]})})]},v.id)}),g.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No user caps configured."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: suggested caps can be computed per user based on their historical spend."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Real-time alerts"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Alerts are generated when crossing 80% or 100% thresholds, and on hard cap blocks."})]}),e.jsxs(rs,{variant:"outline",onClick:u,children:[e.jsx(Ia,{className:"h-4 w-4"})," Simulate spend"]})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[Ge.slice(0,8).map(v=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Is,{label:v.severity,tone:L4(v.severity)}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:v.title})]}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:v.message}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:[Qv(v.ts)," (",fh(v.ts),")"]}),v.relatedIds.length?e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:v.relatedIds.slice(0,4).map(k=>e.jsx(Is,{label:k,tone:"neutral"},k))}):null]}),e.jsx(Et,{className:al("h-5 w-5",v.severity==="Critical"?"text-rose-700":v.severity==="Warning"?"text-amber-700":"text-blue-700")})]})},v.id)),Ge.length?null:e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(re,{})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No alerts"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Alerts will appear here."})]})]})]})]}):null,F==="history"?e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Budget allocation history"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Changes are logged with who, when, and what happened."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(rs,{variant:"outline",onClick:w,children:[e.jsx(ss,{className:"h-4 w-4"})," Copy JSON"]}),e.jsxs(rs,{variant:"outline",onClick:Be,children:[e.jsx(pt,{className:"h-4 w-4"})," Export"]})]})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[C.slice(0,30).map(v=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Is,{label:v.type,tone:v.type.includes("Hard cap")?"bad":v.type.includes("Exception")?"info":"neutral"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:v.actor})]}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:v.details}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:[Qv(v.ts)," (",fh(v.ts),")  ",v.id]})]}),e.jsx(kt,{className:"h-5 w-5 text-slate-600"})]})},v.id)),C.length?null:e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(kt,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No history"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Changes will be recorded here."})]})]})]}):null,F==="forecast"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Forecasting and runway"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: forecast to month-end by group, module, and marketplace."})]}),e.jsx(Is,{label:"Premium",tone:"info"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search groups"}),e.jsx(pa,{className:"h-4 w-4 text-slate-500"})]}),e.jsx("input",{value:xe,onChange:v=>he(v.target.value),placeholder:"Search groups",className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Department"}),e.jsxs("select",{value:de,onChange:v=>ye(v.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",children:[e.jsx("option",{value:"All",children:"All"}),e.jsx("option",{value:"Operations",children:"Ops"}),e.jsx("option",{value:"Sales",children:"Sales"}),e.jsx("option",{value:"Finance",children:"Finance"}),e.jsx("option",{value:"Admin",children:"Admin"}),e.jsx("option",{value:"Procurement",children:"Procurement"})]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Forecast method"}),e.jsx("span",{title:"Run rate uses month-to-date burn (used  day of period)  period days. Last 7 days and Seasonality are placeholders.",children:e.jsx(en,{className:"h-4 w-4 text-slate-500"})})]}),e.jsxs("select",{value:Ke,onChange:v=>{const k=v.target.value;Le(k),k!=="runrate"&&i({title:"Coming soon",message:"Only Run rate is implemented in this demo.",kind:"info"})},className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",children:[e.jsx("option",{value:"runrate",children:"Run rate (linear)"}),e.jsx("option",{value:"last7",children:"Last 7 days"}),e.jsx("option",{value:"seasonality",children:"Seasonality (placeholder)"})]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Org forecast"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:Ke==="runrate"?"Run rate projection.":"Projection method selected."}),e.jsx("div",{className:"mt-3",children:e.jsx(pm,{valuePct:cr(Te,$e),labelLeft:`Forecast ${us(Te)}`,labelRight:`Budget ${us($e)}`})}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:["Burn per day: ",us(Math.round(Oe))]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Runway by group"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"How long until budgets run out."}),e.jsx("div",{className:"mt-3 space-y-2",children:le.map(v=>{const k=Math.max(0,v.amountUGX-v.usedUGX),m=v.runway===1/0?1/0:Math.max(0,Math.round(v.runway)),S=Math.round(v.forecast-v.amountUGX),f=v.amountUGX>0?Math.round(S/v.amountUGX*100):0,U=v.forecast>v.amountUGX?"At risk":"OK";return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:v.group}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Remaining: ",us(k),"  Burn/day: ",us(Math.round(v.burnPerDay))]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Variance: ",e.jsx("span",{className:S>0?"font-semibold text-rose-700":"font-semibold text-emerald-700",children:us(S)}),e.jsxs("span",{className:"ml-2 block text-[11px] text-slate-500",children:["Variance %: ",f,"%"]})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsx(Is,{label:m===1/0?"":`${m}d`,tone:m!==1/0&&m<=5?"warn":"neutral"}),e.jsxs(rs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>i({title:"Drill-down",message:`Open ${v.group} forecast details (${U}).`,kind:"info"}),children:[U," ",e.jsx(et,{className:"h-4 w-4"})]})]})]}),e.jsx("div",{className:"mt-2",children:e.jsx(pm,{valuePct:cr(v.usedUGX,v.amountUGX),labelLeft:"Used",labelRight:`${cr(v.usedUGX,v.amountUGX)}%`})})]},v.id)})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Forecast by module"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Module budgets and projected spend."})]}),e.jsx(Is,{label:"Premium",tone:"info"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:z.length?z.map(v=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:v.module}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Forecast: ",us(v.forecast),"  Budget: ",us(v.amountUGX)]})]}),e.jsx(Is,{label:v.forecast>v.amountUGX?"Risk":"OK",tone:v.forecast>v.amountUGX?"warn":"good"})]}),e.jsx("div",{className:"mt-2",children:e.jsx(pm,{valuePct:cr(v.forecast,v.amountUGX),labelLeft:"Forecast",labelRight:`${cr(v.forecast,v.amountUGX)}%`})})]},v.id)):e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No module budgets configured."})})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Forecast by marketplace"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"E-Commerce marketplace budgets and projected spend."})]}),e.jsx(Is,{label:"Premium",tone:"info"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:Ae.length?Ae.map(v=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:v.marketplace}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Forecast: ",us(v.forecast),"  Budget: ",us(v.amountUGX)]})]}),e.jsx(Is,{label:v.forecast>v.amountUGX?"Risk":"OK",tone:v.forecast>v.amountUGX?"warn":"good"})]}),e.jsx("div",{className:"mt-2",children:e.jsx(pm,{valuePct:cr(v.forecast,v.amountUGX),labelLeft:"Forecast",labelRight:`${cr(v.forecast,v.amountUGX)}%`})})]},v.id)):e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No marketplace budgets configured."})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Tip: keep MyLiveDealz stricter due to high-value deals."})]})]})]}):null,F==="exceptions"?e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Emergency exception workflow"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: allow temporary limit increases with approvals."})]}),e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:e.jsxs(rs,{variant:"outline",onClick:()=>Xe(),children:[e.jsx(gt,{className:"h-4 w-4"})," New exception"]})})]}),e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"ID"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Target"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Extra"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Reason"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Attachments"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[L.map(v=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:v.id}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Is,{label:v.status,tone:v.status==="Approved"?"good":v.status==="Rejected"?"bad":"warn"})}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[v.targetType,"  ",v.targetId]}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:us(v.extraAmountUGX)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:v.reason}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Is,{label:v.attachmentsProvided?"Yes":"No",tone:v.attachmentsProvided?"good":"warn"})}),e.jsx("td",{className:"px-4 py-3",children:v.status==="Pending"?e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(rs,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>E(v.id,"Approved"),children:[e.jsx(tt,{className:"h-4 w-4"})," Approve"]}),e.jsxs(rs,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>E(v.id,"Rejected"),children:[e.jsx(Qe,{className:"h-4 w-4"})," Reject"]})]}):e.jsx(Is,{label:`By ${v.approver}`,tone:"neutral"})})]},v.id)),L.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No exceptions."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Emergency exceptions should be rare and always audit logged."})]}):null]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Quick actions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Budget and control tools."})]}),e.jsx(Is,{label:"Admin",tone:"neutral"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(rs,{variant:"outline",onClick:B,children:[e.jsx(gt,{className:"h-4 w-4"})," Create budget"]}),e.jsxs(rs,{variant:"outline",onClick:De,children:[e.jsx(dx,{className:"h-4 w-4"})," Set user cap"]}),e.jsxs(rs,{variant:"outline",onClick:u,children:[e.jsx(Ia,{className:"h-4 w-4"})," Simulate spend"]}),e.jsxs(rs,{variant:"outline",onClick:()=>Xe(),children:[e.jsx(yt,{className:"h-4 w-4"})," Emergency exception"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: emergency exceptions require approvals and are audit logged."})]})]})}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"L Budgets, Spend Limits and Controls v2. Core: org budget, group budgets, user caps, hard vs soft caps, budget periods, real-time alerts, and allocation history. Premium: forecasting and runway, suggested caps, and emergency exceptions with approvals."})})]})}),e.jsx(bh,{open:oe,title:H.id?"Edit budget":"New budget",subtitle:"Org, group, module, or marketplace budgets.",onClose:()=>G(!1),actions:[...H.id?[{label:"Delete",onClick:()=>{Me(H.id),G(!1)},variant:"danger"}]:[],{label:"Save",onClick:ne}],footer:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(rs,{variant:"ghost",onClick:()=>G(!1),children:"Cancel"}),e.jsx(rs,{variant:"primary",onClick:ne,children:H.id?"Save budget":"Add budget"})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(ql,{label:"Scope",value:H.scope,onChange:v=>{const k=v;Y(m=>{const S={...m,scope:k};return k==="Org"&&(delete S.group,delete S.module,delete S.marketplace),k==="Group"&&(S.group=S.group||"Operations",delete S.module,delete S.marketplace),k==="Module"&&(S.module=S.module||"Rides & Logistics",delete S.group,delete S.marketplace),k==="Marketplace"&&(S.module="E-Commerce",S.marketplace=S.marketplace||"MyLiveDealz",delete S.group),S})},options:["Org","Group","Module","Marketplace"]}),e.jsx(ql,{label:"Period",value:H.period,onChange:v=>Y(k=>({...k,period:v})),options:["Weekly","Monthly","Quarterly"]}),e.jsx(ql,{label:"Cap type",value:H.capType,onChange:v=>Y(k=>({...k,capType:v})),options:["Hard","Soft"],hint:"Hard blocks spend"}),e.jsx(vh,{label:"Amount (UGX)",value:H.amountUGX,onChange:v=>Y(k=>({...k,amountUGX:Math.max(0,v)})),hint:us(H.amountUGX)}),e.jsx("div",{className:al("",H.scope==="Group"?"":"opacity-70"),children:e.jsx(ql,{label:"Group",value:H.group||"Operations",onChange:v=>Y(k=>({...k,group:v})),options:["Operations","Sales","Finance","Admin","Procurement"],disabled:H.scope!=="Group"})}),e.jsx("div",{className:al("",H.scope==="Module"?"":"opacity-70"),children:e.jsx(ql,{label:"Module",value:H.module||"Rides & Logistics",onChange:v=>Y(k=>({...k,module:v})),options:t,disabled:H.scope!=="Module"&&H.scope!=="Marketplace",hint:H.scope==="Marketplace"?"Fixed to E-Commerce":void 0})}),e.jsx("div",{className:al("md:col-span-2",H.scope==="Marketplace"?"":"opacity-70"),children:e.jsx(ql,{label:"Marketplace",value:H.marketplace||"MyLiveDealz",onChange:v=>Y(k=>({...k,marketplace:v})),options:s,disabled:H.scope!=="Marketplace",hint:"E-Commerce only"})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Yv,{label:"Notes",value:H.notes||"",onChange:v=>Y(k=>({...k,notes:v})),placeholder:"Explain why this budget exists",rows:3})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Best practice: keep high-risk marketplaces on hard cap or require approvals above soft cap."})]})}),e.jsx(bh,{open:we,title:je.id?"Edit user cap":"New user cap",subtitle:"User caps are enforced alongside budgets.",onClose:()=>q(!1),actions:[{label:"Save",onClick:me}],footer:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(rs,{variant:"ghost",onClick:()=>q(!1),children:"Cancel"}),e.jsx(rs,{variant:"primary",onClick:me,children:"Save cap"})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(ql,{label:"User",value:je.userId,onChange:v=>_e(k=>({...k,userId:v})),options:l.map(v=>v.id),hint:"Select user ID"}),e.jsx(ql,{label:"Period",value:je.period,onChange:v=>_e(k=>({...k,period:v})),options:["Weekly","Monthly","Quarterly"]}),e.jsx(ql,{label:"Cap type",value:je.capType,onChange:v=>_e(k=>({...k,capType:v})),options:["Hard","Soft"],hint:"Hard blocks spend"}),e.jsx(vh,{label:"Cap amount (UGX)",value:je.amountUGX,onChange:v=>_e(k=>({...k,amountUGX:Math.max(0,v)})),hint:us(je.amountUGX)}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: use suggested caps from historical spend for consistent enforcement."})]})}),e.jsx(bh,{open:Ee,title:"Simulate spend",subtitle:"Creates alerts on breach and updates used amounts. Hard caps block.",onClose:()=>be(!1),actions:[{label:"Emergency exception",onClick:()=>Xe("Org","B-ORG")},{label:"Apply",onClick:se}],footer:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(rs,{variant:"ghost",onClick:()=>be(!1),children:"Cancel"}),e.jsx(rs,{variant:"primary",onClick:se,children:"Apply"})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(ql,{label:"User",value:Fe.userId,onChange:v=>{const k=l.find(m=>m.id===v)||l[0];Pe(m=>({...m,userId:v,module:m.module,marketplace:m.module==="E-Commerce"?m.marketplace==="-"?"MyLiveDealz":m.marketplace:"-"})),i({title:"User",message:`${k.name} selected.",`,kind:"info"})},options:l.map(v=>v.id),hint:"User ID"}),e.jsx(vh,{label:"Amount (UGX)",value:Fe.amountUGX,onChange:v=>Pe(k=>({...k,amountUGX:Math.max(0,v)})),hint:us(Fe.amountUGX)}),e.jsx(ql,{label:"Service Module",value:Fe.module,onChange:v=>{const k=v;Pe(m=>({...m,module:k,marketplace:k==="E-Commerce"?m.marketplace==="-"?"MyLiveDealz":m.marketplace:"-"}))},options:t}),e.jsx(ql,{label:"Marketplace",value:String(Fe.marketplace==="-"?"MyLiveDealz":Fe.marketplace),onChange:v=>Pe(k=>({...k,marketplace:v})),options:s,disabled:Fe.module!=="E-Commerce",hint:Fe.module!=="E-Commerce"?"E-Commerce only":void 0}),e.jsx(ql,{label:"Risk",value:Fe.risk,onChange:v=>Pe(k=>({...k,risk:v})),options:["Low","Medium","High"],hint:"Premium safeguards"}),e.jsx(U4,{label:"Vendor",value:Fe.vendor,onChange:v=>Pe(k=>({...k,vendor:v})),placeholder:"Vendor name"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Yv,{label:"Note",value:Fe.note,onChange:v=>Pe(k=>({...k,note:v})),placeholder:"Reason for spend",rows:3})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Spend hits org budget, group budget, optional module and marketplace budgets, plus the user cap."})]})}),e.jsx(bh,{open:pe,title:"Emergency exception request",subtitle:"Premium: temporary limit increase requires approval.",onClose:()=>Q(!1),actions:[{label:"Submit",onClick:V}],footer:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(rs,{variant:"ghost",onClick:()=>Q(!1),children:"Cancel"}),e.jsx(rs,{variant:"primary",onClick:V,children:"Submit"})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(ql,{label:"Target type",value:Re.targetType,onChange:v=>ce(k=>({...k,targetType:v})),options:["Org","Group","User","Module","Marketplace"]}),e.jsx(U4,{label:"Target ID",value:Re.targetId,onChange:v=>ce(k=>({...k,targetId:v})),placeholder:"Budget ID or User ID",hint:"Example: B-ORG or B-G-FIN or U-1002"}),e.jsx(vh,{label:"Extra amount (UGX)",value:Re.extraAmountUGX,onChange:v=>ce(k=>({...k,extraAmountUGX:Math.max(0,v)})),hint:us(Re.extraAmountUGX)}),e.jsx(ql,{label:"Approver",value:Re.approver,onChange:v=>ce(k=>({...k,approver:v})),options:["Org Admin","Finance Desk","CFO"]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Yv,{label:"Reason",value:Re.reason,onChange:v=>ce(k=>({...k,reason:v})),placeholder:"Example: urgent purchase required for operations, request approval to exceed cap",hint:"Minimum 10 characters",rows:4})}),e.jsx(t_,{enabled:Re.attachmentsProvided,onChange:v=>ce(k=>({...k,attachmentsProvided:v})),label:"Attachments provided",description:"Required for high value exceptions"}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"In production, this request routes to Approval Workflow Builder (J) and appears in Approvals Inbox (K)."})]})})]});function re(){return e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"text-slate-700",children:[e.jsx("path",{d:"M15 17H9",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),e.jsx("path",{d:"M18 8a6 6 0 10-12 0c0 7-3 7-3 7h18s-3 0-3-7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}}const Qx={green:"#03CD8C",orange:"#F77F00"};function Wa(...t){return t.filter(Boolean).join(" ")}function hm(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function py(t,s,a){return Math.max(s,Math.min(a,t))}function Lt(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function jh(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function _4(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function _t({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Wa("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Dt({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:Qx.green}:t==="accent"?{background:Qx.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Wa(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Zi({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:Wa("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:Wa("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function yh({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:Wa(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:Wa("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function Ya({label:t,value:s,onChange:a,hint:l,disabled:n}){return e.jsxs("div",{className:Wa(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",value:s,onChange:r=>a(Number(r.target.value||0)),disabled:n,className:Wa("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function gl({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:Wa(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:Wa("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i,children:i},i))})]})}function B4({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:i=>a(i.target.value),placeholder:l,rows:r,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"})]})}function n_({actions:t}){const[s,a]=d.useState(!1);return e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 focus:bg-slate-100 focus:outline-none",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>a(!1)}),e.jsx("div",{className:"absolute right-0 top-full z-40 mt-1 w-48 overflow-hidden rounded-xl border border-slate-200 bg-white shadow-xl ring-1 ring-slate-200",children:t.map((l,n)=>e.jsx("button",{onClick:()=>{l.onClick(),a(!1)},className:Wa("block w-full px-4 py-2.5 text-left text-sm font-medium transition hover:bg-slate-50",l.variant==="danger"?"text-rose-700 hover:bg-rose-50":"text-slate-700"),children:l.label},n))})]})]})}function Jv({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="920px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[8vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-1",children:[o?e.jsx(n_,{actions:o}):null,e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function r_({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Wa("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function Aa({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function G4({pct:t,labelLeft:s,labelRight:a}){const l=py(t,0,150);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-600",children:[e.jsx("span",{className:"font-semibold",children:s}),e.jsx("span",{className:"font-semibold",children:a})]}),e.jsx("div",{className:"mt-2 h-2 w-full overflow-hidden rounded-full bg-slate-100",children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${Math.min(100,l)}%`,background:Qx.green}})}),l>100?e.jsxs("div",{className:"mt-2 text-xs font-semibold text-rose-700",children:["Over by ",Math.round((l-100)*10)/10,"%"]}):null]})}function q4(t){return t==="High"?"bad":t==="Medium"?"warn":"good"}function Zv(t){return t==="Hard stop"?"bad":t==="Soft stop"?"warn":"good"}function i_(t){return t==="Approved"?"good":t==="Rejected"?"bad":"warn"}function eo(t){return Math.max(0,t.balanceUGX-t.heldUGX)}function o_(){const t=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],s=["Operations","Sales","Finance","Admin","Procurement"],a=["OPS-001","SALES-TRAVEL","FIN-OPS","ADMIN-CORE","PROC-001"],[l,n]=d.useState([]),r=O=>{const X=hm("toast");n(A=>[{id:X,...O},...A].slice(0,4)),window.setTimeout(()=>n(A=>A.filter(N=>N.id!==X)),3200)},[i,o]=d.useState("overview"),[c,x]=d.useState("Wallet"),[j,g]=d.useState({Wallet:!0,Credit:!0,Prepaid:!0}),[y,$]=d.useState(()=>{const O=Date.now();return[{id:"W-ORG",name:"Main Corporate Wallet",type:"Org",currency:"UGX",balanceUGX:92e5,heldUGX:7e5,status:"Active",updatedAt:O-2*60*60*1e3},{id:"W-OPS",name:"Operations Wallet",type:"Group",group:"Operations",currency:"UGX",balanceUGX:32e5,heldUGX:0,status:"Active",updatedAt:O-5*60*60*1e3},{id:"W-SALES",name:"Sales Wallet",type:"Group",group:"Sales",currency:"UGX",balanceUGX:18e5,heldUGX:12e4,status:"Active",updatedAt:O-8*60*60*1e3},{id:"W-CC-TRAVEL",name:"Sales Travel Cost Center",type:"Cost center",costCenter:"SALES-TRAVEL",currency:"UGX",balanceUGX:6e5,heldUGX:0,status:"Active",updatedAt:O-1*24*60*60*1e3}]}),[T,C]=d.useState("W-ORG"),[W,L]=d.useState(()=>({enabled:!0,limitUGX:15e6,usedUGX:42e5,repaymentTerms:{cycle:"Monthly",graceDays:7,metadata:"Interest: 0% promo, late fee: per agreement"},delinquent:!1})),[R,F]=d.useState(()=>({enabled:!0,balanceUGX:54e5,reservedUGX:35e4,stopWhenDepleted:!0})),[te,oe]=d.useState(5e6),[G,H]=d.useState(!1),[Y,we]=d.useState(()=>({enabled:!0,invoiceGraceDays:7,invoiceOverdueDays:0})),[q,je]=d.useState(()=>{const O=Date.now();return[{id:"FR-1001",createdAt:O-6*60*60*1e3,createdBy:"Finance Desk",kind:"Add funds",method:"Bank transfer",walletId:"W-ORG",amountUGX:85e5,risk:"Medium",reason:"Top up for month start operations",status:"Pending"},{id:"FR-1002",createdAt:O-30*60*60*1e3,createdBy:"Procurement Desk",kind:"Prepaid deposit",method:"Bank transfer",amountUGX:5e6,risk:"Low",reason:"Prepaid deposit for Q1",status:"Approved",approvedBy:"Org Admin",decisionNote:"Approved"}]}),[_e,Ee]=d.useState(()=>[{id:"ATU-01",enabled:!0,walletId:"W-ORG",thresholdUGX:15e5,topUpAmountUGX:2e6,maxPerDayUGX:4e6,requireApprovalOverUGX:5e6,method:"Bank transfer",notes:"Protect availability for core services."}]),[be,Fe]=d.useState(()=>{const O=Date.now();return[{id:"LG-001",at:O-2*60*60*1e3,type:"Hold placed",walletId:"W-ORG",amountUGX:7e5,note:"Hold for pending RFQ milestone"},{id:"LG-002",at:O-5*60*60*1e3,type:"Spend",walletId:"W-SALES",amountUGX:82e3,note:"Ride to client meeting"},{id:"LG-003",at:O-10*60*60*1e3,type:"Credit draw",amountUGX:12e5,note:"Marketplace purchase covered by credit"},{id:"LG-004",at:O-2*24*60*60*1e3,type:"Prepaid deposit",amountUGX:5e6,note:"Deposit funded"}]}),[Pe,pe]=d.useState(()=>{const O=Date.now();return[{id:"RE-01",createdAt:O-70*60*1e3,severity:"Warning",title:"Unusual funding frequency",details:"3 funding attempts within 30 minutes. Review source accounts.",walletId:"W-ORG",status:"Open"},{id:"RE-02",createdAt:O-14*60*60*1e3,severity:"Critical",title:"Potential fraud trigger",details:"Large funding request above threshold requires approval.",walletId:"W-ORG",status:"Open"}]}),[Q,Re]=d.useState(!1),[ce,xe]=d.useState(()=>({id:"",name:"",type:"Group",group:"Operations",costCenter:"OPS-001",currency:"UGX",balanceUGX:0,heldUGX:0,status:"Active",updatedAt:Date.now()})),[he,de]=d.useState(!1),[ye,Ke]=d.useState(()=>({kind:"Add funds",fromWalletId:"W-ORG",toWalletId:"W-ORG",amountUGX:5e5,method:"Bank transfer",reason:"",risk:"Low"})),[Le,Ne]=d.useState(!1),[ge,$e]=d.useState(()=>({id:"",enabled:!0,walletId:"W-ORG",thresholdUGX:15e5,topUpAmountUGX:2e6,maxPerDayUGX:4e6,requireApprovalOverUGX:5e6,method:"Bank transfer",notes:""})),[ie,Oe]=d.useState(""),[Se,Te]=d.useState("All"),[Ge,We]=d.useState("All"),[ze,Ue]=d.useState(""),[le,z]=d.useState("All"),Ae=d.useMemo(()=>y.find(O=>O.id===T)||y[0],[y,T]),Ve=d.useMemo(()=>y.reduce((O,X)=>O+X.balanceUGX,0),[y]),Ye=d.useMemo(()=>y.reduce((O,X)=>O+eo(X),0),[y]),Be=Math.max(0,W.limitUGX-W.usedUGX),w=Math.max(0,R.balanceUGX-R.reservedUGX),B=d.useMemo(()=>{const O=[];if(!Y.enabled)return{enabled:!1,invoiceOverdueDays:Y.invoiceOverdueDays,invoiceGraceDays:Y.invoiceGraceDays,agreementCompliant:!0,status:"Active",reasons:[]};G&&O.push("CorporatePay is frozen by admin risk control"),Y.invoiceOverdueDays>Y.invoiceGraceDays&&O.push(`Invoice overdue beyond grace (${Y.invoiceOverdueDays}d > ${Y.invoiceGraceDays}d)`);const X=j.Wallet&&Ae&&Ae.status==="Active"&&eo(Ae)>0,A=j.Credit&&W.enabled&&!W.delinquent&&Be>0,N=j.Prepaid&&R.enabled&&w>0;c==="Wallet"&&(!Ae||Ae.status!=="Active")&&O.push("Primary wallet is not active"),c==="Wallet"&&Ae&&eo(Ae)<=0&&O.push("Primary wallet is depleted"),c==="Credit"&&W.enabled&&(W.delinquent||Be<=0)&&O.push(W.delinquent?"Credit line is delinquent":"Credit limit reached"),c==="Prepaid"&&R.enabled&&w<=0&&R.stopWhenDepleted&&O.push("Prepaid deposit depleted");const h=O.length===0,K=G||Y.invoiceOverdueDays>Y.invoiceGraceDays||c==="Prepaid"&&R.stopWhenDepleted&&!N||c==="Wallet"&&!X||c==="Credit"&&!A,_=X||A||N,ke=c==="Wallet"?X:c==="Credit"?A:N;return K&&!_?{enabled:!0,invoiceOverdueDays:Y.invoiceOverdueDays,invoiceGraceDays:Y.invoiceGraceDays,agreementCompliant:!1,status:"Hard stop",reasons:O}:!ke&&_?(O.push("Default payment method unavailable, fallback available"),{enabled:!0,invoiceOverdueDays:Y.invoiceOverdueDays,invoiceGraceDays:Y.invoiceGraceDays,agreementCompliant:!1,status:"Soft stop",reasons:O}):K?{enabled:!0,invoiceOverdueDays:Y.invoiceOverdueDays,invoiceGraceDays:Y.invoiceGraceDays,agreementCompliant:!1,status:"Hard stop",reasons:O}:{enabled:!0,invoiceOverdueDays:Y.invoiceOverdueDays,invoiceGraceDays:Y.invoiceGraceDays,agreementCompliant:h,status:"Active",reasons:O}},[Y,G,j,c,Ae,W,Be,R,w]),ue=d.useMemo(()=>{const O=t.map(X=>({module:X,enabled:!0,reason:""}));return B.enabled?B.status==="Hard stop"?O.map(X=>({...X,enabled:!1,reason:B.reasons[0]||"Hard stop"})):B.status==="Soft stop"?O.map(X=>({...X,enabled:!0,reason:"Fallback payment may apply"})):O:O},[t,B]),ne=d.useMemo(()=>q.filter(O=>O.status==="Pending").length,[q]),Me=d.useMemo(()=>{const O=ze.trim().toLowerCase();return q.filter(X=>le==="All"?!0:X.status===le).filter(X=>O?`${X.id} ${X.kind} ${X.method} ${X.createdBy} ${X.reason} ${X.status} ${X.walletId||""}`.toLowerCase().includes(O):!0).sort((X,A)=>A.createdAt-X.createdAt)},[q,ze,le]),De=d.useMemo(()=>{const O=ie.trim().toLowerCase();return be.filter(X=>Se==="All"?!0:X.type===Se).filter(X=>Ge==="All"?!0:(X.walletId||"")===Ge).filter(X=>O?`${X.id} ${X.type} ${X.note} ${X.walletId||""}`.toLowerCase().includes(O):!0).sort((X,A)=>A.at-X.at)},[be,ie,Se,Ge]),fe=()=>{xe({id:"",name:"",type:"Group",group:"Operations",costCenter:"OPS-001",currency:"UGX",balanceUGX:0,heldUGX:0,status:"Active",updatedAt:Date.now()}),Re(!0)},me=()=>{if(!ce.name.trim()){r({title:"Missing name",message:"Wallet name is required.",kind:"warn"});return}const O=Date.now(),X=ce.id||hm("W"),A={...ce,id:X,updatedAt:O};$(N=>{const h=N.findIndex(K=>K.id===X);if(h>=0){const K=N.slice();return K[h]=A,K}return[A,...N]}),r({title:"Saved",message:"Wallet saved.",kind:"success"}),Re(!1),T||C(X)},Xe=O=>{if(O==="W-ORG"){r({title:"Blocked",message:"You cannot delete the main org wallet in this demo.",kind:"warn"});return}$(X=>X.filter(A=>A.id!==O)),T===O&&C("W-ORG"),r({title:"Deleted",message:"Wallet removed.",kind:"info"})},V=O=>{var A;const X=T||((A=y[0])==null?void 0:A.id)||"W-ORG";Ke(N=>({...N,kind:O,fromWalletId:X,toWalletId:X,amountUGX:O==="Repay credit"?5e5:O==="Prepaid deposit"?2e6:5e5,method:O==="Transfer"?"Internal transfer":"Bank transfer",reason:"",risk:"Low"})),de(!0)},E=O=>{const X={id:hm("FR"),createdAt:Date.now(),status:O.status||"Pending",...O};return je(A=>[X,...A]),X},u=O=>{Fe(X=>[{id:hm("LG"),at:Date.now(),...O},...X])},P=()=>{const O=ye.reason.trim();if(O.length<8){r({title:"Reason required",message:"Add a clear reason (min 8 chars).",kind:"warn"});return}if(ye.amountUGX<=0){r({title:"Invalid amount",message:"Amount must be greater than zero.",kind:"warn"});return}const X=ye.amountUGX,A=Date.now(),N=X>=te&&(ye.kind==="Add funds"||ye.kind==="Prepaid deposit");if(ye.kind==="Add funds"){const h=E({createdBy:"You",kind:"Add funds",method:ye.method,walletId:ye.toWalletId,amountUGX:X,risk:ye.risk,reason:O,status:N?"Pending":"Approved",approvedBy:N?void 0:"Auto",decisionNote:N?void 0:"Auto-approved under threshold"});N?(u({type:"Wallet funding",walletId:ye.toWalletId,amountUGX:0,note:`Funding request ${h.id} pending approval`}),r({title:"Request created",message:`${h.id} pending approval.",`,kind:"info"})):($(K=>K.map(_=>_.id===ye.toWalletId?{..._,balanceUGX:_.balanceUGX+X,updatedAt:A}:_)),u({type:"Wallet funding",walletId:ye.toWalletId,amountUGX:X,note:`Funding (${ye.method}): ${O}`}),r({title:"Funded",message:`Added ${Lt(X)} to wallet.",`,kind:"success"})),de(!1);return}if(ye.kind==="Transfer"){if(ye.fromWalletId===ye.toWalletId){r({title:"Invalid transfer",message:"Choose different wallets.",kind:"warn"});return}const h=y.find(_=>_.id===ye.fromWalletId),K=y.find(_=>_.id===ye.toWalletId);if(!h||!K){r({title:"Wallet not found",message:"Select valid wallets.",kind:"warn"});return}if(h.status!=="Active"){r({title:"Blocked",message:"Source wallet is frozen.",kind:"warn"});return}if(eo(h)<X){r({title:"Insufficient",message:"Not enough available balance in source wallet.",kind:"warn"});return}$(_=>_.map(ke=>ke.id===h.id?{...ke,balanceUGX:ke.balanceUGX-X,updatedAt:A}:ke.id===K.id?{...ke,balanceUGX:ke.balanceUGX+X,updatedAt:A}:ke)),u({type:"Wallet transfer",walletId:h.id,amountUGX:-X,note:`Transfer to ${K.name}: ${O}`}),u({type:"Wallet transfer",walletId:K.id,amountUGX:X,note:`Transfer from ${h.name}: ${O}`}),r({title:"Transferred",message:`Moved ${Lt(X)}.",`,kind:"success"}),de(!1);return}if(ye.kind==="Repay credit"){const h=E({createdBy:"You",kind:"Repay credit",method:ye.method,amountUGX:X,risk:ye.risk,reason:O,status:X>=te?"Pending":"Approved",approvedBy:X>=te?void 0:"Auto",decisionNote:X>=te?void 0:"Auto-approved under threshold"});h.status==="Approved"?(L(K=>({...K,usedUGX:Math.max(0,K.usedUGX-X),delinquent:!1})),u({type:"Credit repayment",amountUGX:X,note:`Credit repayment (${ye.method}): ${O}`}),r({title:"Repaid",message:`Repaid ${Lt(X)}.",`,kind:"success"})):r({title:"Request created",message:`${h.id} pending approval.",`,kind:"info"}),de(!1);return}if(ye.kind==="Prepaid deposit"){const h=E({createdBy:"You",kind:"Prepaid deposit",method:ye.method,amountUGX:X,risk:ye.risk,reason:O,status:N?"Pending":"Approved",approvedBy:N?void 0:"Auto",decisionNote:N?void 0:"Auto-approved under threshold"});N?r({title:"Request created",message:`${h.id} pending approval.",`,kind:"info"}):(F(K=>({...K,balanceUGX:K.balanceUGX+X})),u({type:"Prepaid deposit",amountUGX:X,note:`Prepaid deposit (${ye.method}): ${O}`}),r({title:"Deposited",message:`Added ${Lt(X)} to prepaid.",`,kind:"success"})),de(!1);return}},se=O=>{const X=Date.now(),A=q.find(N=>N.id===O);!A||A.status!=="Pending"||(je(N=>N.map(h=>h.id===O?{...h,status:"Approved",approvedBy:"You",decisionNote:"Approved"}:h)),A.kind==="Add funds"&&A.walletId&&($(N=>N.map(h=>h.id===A.walletId?{...h,balanceUGX:h.balanceUGX+A.amountUGX,updatedAt:X}:h)),u({type:"Wallet funding",walletId:A.walletId,amountUGX:A.amountUGX,note:`Approved funding ${O}`})),A.kind==="Prepaid deposit"&&(F(N=>({...N,balanceUGX:N.balanceUGX+A.amountUGX})),u({type:"Prepaid deposit",amountUGX:A.amountUGX,note:`Approved prepaid deposit ${O}`})),A.kind==="Repay credit"&&(L(N=>({...N,usedUGX:Math.max(0,N.usedUGX-A.amountUGX),delinquent:!1})),u({type:"Credit repayment",amountUGX:A.amountUGX,note:`Approved credit repayment ${O}`})),r({title:"Approved",message:`${O} approved.",`,kind:"success"}))},D=O=>{const X=q.find(A=>A.id===O);!X||X.status!=="Pending"||(je(A=>A.map(N=>N.id===O?{...N,status:"Rejected",approvedBy:"You",decisionNote:"Rejected"}:N)),r({title:"Rejected",message:`${O} rejected.",`,kind:"info"}))},re=O=>{const X=Date.now();$(A=>A.map(N=>{if(N.id!==O)return N;const h=N.status==="Active"?"Frozen":"Active";return u({type:h==="Frozen"?"Freeze":"Unfreeze",walletId:O,amountUGX:0,note:`${h} by admin`}),{...N,status:h,updatedAt:X}})),r({title:"Updated",message:"Wallet status updated.",kind:"info"})},v=()=>{const O=Date.now(),X=[];_e.forEach(A=>{if(!A.enabled)return;const N=y.find(ke=>ke.id===A.walletId);if(!N)return;const h=eo(N);if(h>=A.thresholdUGX)return;const K=A.topUpAmountUGX>=A.requireApprovalOverUGX,_=E({createdBy:"System",kind:"Add funds",method:A.method,walletId:A.walletId,amountUGX:A.topUpAmountUGX,risk:"Low",reason:`Auto top-up rule ${A.id} triggered (avail ${Lt(h)} < ${Lt(A.thresholdUGX)})`,status:K?"Pending":"Approved",approvedBy:K?void 0:"Auto",decisionNote:K?void 0:"Auto-approved by rule"});K?u({type:"Wallet funding",walletId:A.walletId,amountUGX:0,note:`Auto top-up request ${_.id} pending approval`}):($(ke=>ke.map(I=>I.id===A.walletId?{...I,balanceUGX:I.balanceUGX+A.topUpAmountUGX,updatedAt:O}:I)),u({type:"Wallet funding",walletId:A.walletId,amountUGX:A.topUpAmountUGX,note:`Auto top-up applied (${A.id})`})),X.push(A.id)}),X.length?r({title:"Auto top-up",message:`Triggered ${X.length} rule(s).\`,`,kind:"success"}):r({title:"No triggers",message:"No auto top-up rules triggered.",kind:"info"})},k=()=>{if(!ge.walletId){r({title:"Missing wallet",message:"Select a wallet.",kind:"warn"});return}if(ge.thresholdUGX<=0||ge.topUpAmountUGX<=0){r({title:"Invalid values",message:"Threshold and top-up amount must be greater than zero.",kind:"warn"});return}const O=ge.id||hm("ATU"),X={...ge,id:O};Ee(A=>{const N=A.findIndex(h=>h.id===O);if(N>=0){const h=A.slice();return h[N]=X,h}return[X,...A]}),r({title:"Saved",message:"Auto top-up rule saved.",kind:"success"}),Ne(!1)},m=O=>{pe(X=>X.map(A=>A.id===O?{...A,status:"Resolved"}:A)),r({title:"Resolved",message:"Risk event resolved.",kind:"success"})},S=()=>{const O={allowedPayments:j,defaultPayment:c,primaryWalletId:T,wallets:y,credit:W,prepaid:R,enforcementCfg:Y,riskFreezeCorporatePay:G,largeFundingThresholdUGX:te,requests:q,autoTopUps:_e,riskEvents:Pe,ledger:be,exportedAt:new Date().toISOString()},X=JSON.stringify(O,null,2),A=new Blob([X],{type:"application/json"}),N=URL.createObjectURL(A),h=document.createElement("a");h.href=N,h.download="corporatepay-wallet-credit-prepaid.json",h.click(),URL.revokeObjectURL(N),r({title:"Exported",message:"Downloaded JSON config.",kind:"success"})},f=async()=>{const O={wallets:y,credit:W,prepaid:R,requests:q,autoTopUps:_e,enforcementCfg:Y,riskEvents:Pe,ledger:be};try{await navigator.clipboard.writeText(JSON.stringify(O,null,2)),r({title:"Copied",message:"Copied JSON to clipboard.",kind:"success"})}catch{r({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},U=O=>{xe(JSON.parse(JSON.stringify(O))),Re(!0)},p=d.useMemo(()=>y.slice().sort((O,X)=>O.id===T?-1:X.id===T?1:O.name.localeCompare(X.name)),[y,T]),M=d.useMemo(()=>y.map(O=>O.id),[y]),ee=Zv(B.status);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(r_,{toasts:l,onDismiss:O=>n(X=>X.filter(A=>A.id!==O))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:Qx.green},children:e.jsx(Ia,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Corporate Wallet, Credit Line and Prepaid Funding"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Three payment models, multi-wallets, funding approvals, auto top-up rules, and enforcement."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(_t,{label:`Default: ${c}`,tone:"info"}),e.jsx(_t,{label:`Pending requests: ${ne}`,tone:ne?"warn":"good"}),e.jsx(_t,{label:`Enforcement: ${B.status}`,tone:ee}),G?e.jsx(_t,{label:"Frozen",tone:"bad"}):e.jsx(_t,{label:"Not frozen",tone:"good"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Dt,{variant:"outline",onClick:f,children:[e.jsx(ss,{className:"h-4 w-4"})," Copy JSON"]}),e.jsxs(Dt,{variant:"outline",onClick:S,children:[e.jsx(pt,{className:"h-4 w-4"})," Export"]}),e.jsxs(Dt,{variant:"outline",onClick:()=>V("Add funds"),children:[e.jsx(gt,{className:"h-4 w-4"})," Add funds"]}),e.jsxs(Dt,{variant:"primary",onClick:fe,children:[e.jsx(gt,{className:"h-4 w-4"})," New wallet"]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-5",children:[e.jsx(b,{title:"Wallet total",value:Lt(Ve),sub:`${Lt(Ye)} available`,icon:e.jsx(Ia,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(b,{title:"Credit utilization",value:`${Math.round(W.usedUGX/Math.max(1,W.limitUGX)*100)}%`,sub:`${Lt(Be)} available`,icon:e.jsx(Lc,{className:"h-5 w-5"}),tone:W.delinquent?"bad":"neutral"}),e.jsx(b,{title:"Prepaid",value:Lt(R.balanceUGX),sub:`${Lt(w)} available`,icon:e.jsx(Wm,{className:"h-5 w-5"}),tone:w<=0?"warn":"neutral"}),e.jsx(b,{title:"Large funding threshold",value:Lt(te),sub:"Requires approval",icon:e.jsx(yt,{className:"h-5 w-5"}),tone:"info"}),e.jsx(b,{title:"Open risk events",value:`${Pe.filter(O=>O.status==="Open").length}`,sub:"Fraud triggers and reviews",icon:e.jsx(Hm,{className:"h-5 w-5"}),tone:Pe.some(O=>O.status==="Open"&&O.severity==="Critical")?"bad":"warn"})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"overview",label:"Overview"},{id:"wallets",label:"Wallets"},{id:"credit",label:"Credit line"},{id:"prepaid",label:"Prepaid"},{id:"funding",label:"Funding and approvals"},{id:"autotopup",label:"Auto top-up"},{id:"risk",label:"Risk and enforcement"},{id:"ledger",label:"Ledger"}].map(O=>e.jsx("button",{className:Wa("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",i===O.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:i===O.id?{background:Qx.green}:void 0,onClick:()=>o(O.id),children:O.label},O.id))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[i==="overview"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-7 space-y-4",children:[e.jsxs(Aa,{title:"Payment models",subtitle:"Employees use normal EVzone apps. CorporatePay appears at checkout based on these settings.",right:e.jsx(_t,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(ae,{icon:e.jsx(Ia,{className:"h-5 w-5"}),title:"Pay as you go",subtitle:"Corporate Wallet",on:j.Wallet,onToggle:()=>g(O=>({...O,Wallet:!O.Wallet})),selected:c==="Wallet",onSelect:()=>x("Wallet"),bullets:["Uses wallet balance","Supports sub-wallets","Stops when depleted (if no fallback)"]}),e.jsx(ae,{icon:e.jsx(Lc,{className:"h-5 w-5"}),title:"Credit line",subtitle:"Limit-based spend",on:j.Credit,onToggle:()=>g(O=>({...O,Credit:!O.Credit})),selected:c==="Credit",onSelect:()=>x("Credit"),bullets:["Limit and utilization","Repayment terms metadata","Stops if delinquent or limit reached"]}),e.jsx(ae,{icon:e.jsx(Wm,{className:"h-5 w-5"}),title:"Prepaid deposit",subtitle:"Spend down",on:j.Prepaid,onToggle:()=>g(O=>({...O,Prepaid:!O.Prepaid})),selected:c==="Prepaid",onSelect:()=>x("Prepaid"),bullets:["Spend down balance","Stops when depleted","Good for strict cost control"]})]}),e.jsx("div",{className:"mt-4 rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-700",children:"Best practice: keep more than one model enabled so CorporatePay can fall back when a balance is low."})]}),e.jsxs(Aa,{title:"Account health",subtitle:"Balances, availability, and service stop enforcement.",right:e.jsx(_t,{label:B.status,tone:Zv(B.status)}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Primary wallet"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Used by default for pay-as-you-go."})]}),e.jsx(_t,{label:(Ae==null?void 0:Ae.status)||"-",tone:(Ae==null?void 0:Ae.status)==="Frozen"?"bad":"good"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2",children:[e.jsx(gl,{label:"Primary wallet",value:T,onChange:C,options:M,hint:"Org Admin"}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Balance: ",e.jsx("span",{className:"font-semibold text-slate-900",children:Lt((Ae==null?void 0:Ae.balanceUGX)||0)}),e.jsx("br",{}),"Held: ",e.jsx("span",{className:"font-semibold text-slate-900",children:Lt((Ae==null?void 0:Ae.heldUGX)||0)}),e.jsx("br",{}),"Available: ",e.jsx("span",{className:"font-semibold text-slate-900",children:Lt(Ae?eo(Ae):0)})]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Dt,{variant:"outline",onClick:()=>V("Transfer"),children:[e.jsx(_p,{className:"h-4 w-4"})," Transfer"]}),e.jsxs(Dt,{variant:"outline",onClick:()=>V("Add funds"),children:[e.jsx(gt,{className:"h-4 w-4"})," Add funds"]}),e.jsxs(Dt,{variant:"outline",onClick:()=>re(T),children:[(Ae==null?void 0:Ae.status)==="Frozen"?e.jsx(So,{className:"h-4 w-4"}):e.jsx(ia,{className:"h-4 w-4"})," ",(Ae==null?void 0:Ae.status)==="Frozen"?"Unfreeze":"Freeze"]})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Enforcement"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Policy-backed auto stop when agreements are not complied with."})]}),e.jsx(_t,{label:B.enabled?"Enabled":"Off",tone:B.enabled?"info":"neutral"})]}),e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsx(Zi,{enabled:Y.enabled,onChange:O=>we(X=>({...X,enabled:O})),label:"Enable enforcement",description:"When on, the system can stop services based on compliance."}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(Ya,{label:"Invoice overdue days",value:Y.invoiceOverdueDays,onChange:O=>we(X=>({...X,invoiceOverdueDays:Math.max(0,O)})),hint:"Simulated",disabled:!Y.enabled}),e.jsx(Ya,{label:"Grace days",value:Y.invoiceGraceDays,onChange:O=>we(X=>({...X,invoiceGraceDays:Math.max(0,O)})),hint:"Policy",disabled:!Y.enabled})]}),e.jsxs("div",{className:Wa("rounded-2xl p-3 text-xs ring-1",B.status==="Hard stop"?"bg-rose-50 text-rose-800 ring-rose-200":B.status==="Soft stop"?"bg-amber-50 text-amber-900 ring-amber-200":"bg-emerald-50 text-emerald-900 ring-emerald-200"),children:[e.jsxs("div",{className:"font-semibold",children:["Status: ",B.status]}),B.reasons.length?e.jsx("ul",{className:"mt-2 space-y-1",children:B.reasons.slice(0,5).map((O,X)=>e.jsxs("li",{children:[" ",O]},X))}):e.jsx("div",{className:"mt-2",children:"No issues detected."})]})]})]})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Service availability"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"When hard stopped, CorporatePay disappears at checkout and services stop."})]}),e.jsx(_t,{label:B.status,tone:Zv(B.status)})]}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2 md:grid-cols-2",children:ue.slice(0,8).map(O=>e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:O.module}),e.jsxs("div",{className:"mt-0.5 text-xs text-slate-500",children:[O.enabled?"Enabled":"Disabled",O.reason?`  ${O.reason}`:""]})]}),e.jsx(_t,{label:O.enabled?"On":"Off",tone:O.enabled?"good":"bad"})]},O.module))})]})]})]}),e.jsxs("div",{className:"lg:col-span-5 space-y-4",children:[e.jsxs(Aa,{title:"Funding actions",subtitle:"Add funds, deposit prepaid, repay credit, or transfer between sub-wallets.",right:e.jsx(_t,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(ve,{icon:e.jsx(gt,{className:"h-5 w-5"}),title:"Add funds",subtitle:"Top up wallet",onClick:()=>V("Add funds")}),e.jsx(ve,{icon:e.jsx(_p,{className:"h-5 w-5"}),title:"Transfer",subtitle:"Org to group or cost center",onClick:()=>V("Transfer")}),e.jsx(ve,{icon:e.jsx(Wm,{className:"h-5 w-5"}),title:"Prepaid deposit",subtitle:"Spend down account",onClick:()=>V("Prepaid deposit")}),e.jsx(ve,{icon:e.jsx(Lc,{className:"h-5 w-5"}),title:"Repay credit",subtitle:"Reduce utilization",onClick:()=>V("Repay credit")})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:["Premium: large funding events can require approvals. Threshold: ",Lt(te),"."]})]}),e.jsx(Aa,{title:"Pending approvals",subtitle:"Funding requests and limit changes that require review.",right:e.jsx(_t,{label:`${ne} pending`,tone:ne?"warn":"good"}),children:e.jsxs("div",{className:"space-y-2",children:[Me.filter(O=>O.status==="Pending").slice(0,6).map(O=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:O.id}),e.jsx(_t,{label:O.kind,tone:"neutral"}),e.jsx(_t,{label:O.risk,tone:q4(O.risk)})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[jh(O.createdAt),"  By ",O.createdBy]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:Lt(O.amountUGX)}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Method: ",O.method,O.walletId?`  Wallet: ${O.walletId}`:""]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Reason: ",O.reason]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(Dt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>se(O.id),children:[e.jsx(tt,{className:"h-4 w-4"})," Approve"]}),e.jsxs(Dt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>D(O.id),children:[e.jsx(Qe,{className:"h-4 w-4"})," Reject"]})]})]})},O.id)),ne?null:e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(ct,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No pending requests"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"All funding requests have been processed."})]})]})}),e.jsxs(Aa,{title:"Premium: auto top-up",subtitle:"Threshold-based funding rules to keep services available.",right:e.jsx(_t,{label:`${_e.filter(O=>O.enabled).length} enabled`,tone:"info"}),children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Dt,{variant:"outline",onClick:()=>{$e({id:"",enabled:!0,walletId:T,thresholdUGX:15e5,topUpAmountUGX:2e6,maxPerDayUGX:4e6,requireApprovalOverUGX:5e6,method:"Bank transfer",notes:""}),Ne(!0)},children:[e.jsx(gt,{className:"h-4 w-4"})," New rule"]}),e.jsxs(Dt,{variant:"primary",onClick:v,children:[e.jsx(Mr,{className:"h-4 w-4"})," Run simulation"]})]}),e.jsx("div",{className:"mt-3 space-y-2",children:_e.slice(0,3).map(O=>{const X=y.find(h=>h.id===O.walletId),N=(X?eo(X):0)<O.thresholdUGX;return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:O.id}),e.jsx(_t,{label:O.enabled?"On":"Off",tone:O.enabled?"good":"neutral"}),e.jsx(_t,{label:N?"Would trigger":"OK",tone:N?"warn":"good"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Wallet: ",(X==null?void 0:X.name)||O.walletId]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Threshold: ",Lt(O.thresholdUGX),"  Top-up: ",Lt(O.topUpAmountUGX),"  Max/day: ",Lt(O.maxPerDayUGX)]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Approval required over: ",Lt(O.requireApprovalOverUGX),"  Method: ",O.method]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(Dt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{$e(O),Ne(!0)},children:"Edit"}),e.jsxs(Dt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Ee(h=>h.map(K=>K.id===O.id?{...K,enabled:!K.enabled}:K)),children:[O.enabled?e.jsx(ia,{className:"h-4 w-4"}):e.jsx(So,{className:"h-4 w-4"})," ",O.enabled?"Disable":"Enable"]})]})]}),O.notes?e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:O.notes}):null]},O.id)})})]})]})]}):null,i==="wallets"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Aa,{title:"Wallet settings",subtitle:"Funding thresholds and risk controls.",right:e.jsx(_t,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Ya,{label:"Large funding threshold (UGX)",value:te,onChange:O=>oe(Math.max(0,O)),hint:"Above this requires approval"}),e.jsx(Zi,{enabled:G,onChange:H,label:"Freeze CorporatePay",description:"Risk control that blocks CorporatePay at checkout."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: fraud triggers can automatically freeze wallets and require step-up approval."})]}),e.jsxs(Aa,{title:"Multi-wallets",subtitle:"Premium: wallets per group and cost center. Allocate funds and enforce spend boundaries.",right:e.jsx(_t,{label:`${y.length} wallets`,tone:"info"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Primary"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Wallet"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Type"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Target"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Balance"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Held"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Available"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsx("tbody",{children:p.map(O=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"radio",name:"primaryWallet",checked:T===O.id,onChange:()=>C(O.id),className:"h-4 w-4"})}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:O.name}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:O.type}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:O.type==="Group"?O.group:O.type==="Cost center"?O.costCenter:"Organization"}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Lt(O.balanceUGX)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Lt(O.heldUGX)}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Lt(eo(O))}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(_t,{label:O.status,tone:O.status==="Frozen"?"bad":"good"})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Dt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>U(O),children:"Edit"}),e.jsxs(Dt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>re(O.id),children:[O.status==="Frozen"?e.jsx(So,{className:"h-4 w-4"}):e.jsx(ia,{className:"h-4 w-4"})," ",O.status==="Frozen"?"Unfreeze":"Freeze"]}),e.jsxs(Dt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Ke(X=>({...X,kind:"Transfer",fromWalletId:T,toWalletId:O.id})),de(!0)},children:[e.jsx(_p,{className:"h-4 w-4"})," Allocate"]}),e.jsx(Dt,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>Xe(O.id),children:e.jsx(Qe,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Updated ",_4(O.updatedAt)]})]})]},O.id))})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: cost center wallets help chargeback and improve reporting."})]})]}):null,i==="credit"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs(Aa,{title:"Credit line",subtitle:"Limit-based spend with repayment terms metadata.",right:e.jsx(_t,{label:W.enabled?"Enabled":"Off",tone:W.enabled?"good":"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Zi,{enabled:W.enabled,onChange:O=>L(X=>({...X,enabled:O})),label:"Enable credit",description:"When enabled, credit can be used when allowed by policy."}),e.jsx(Zi,{enabled:W.delinquent,onChange:O=>L(X=>({...X,delinquent:O})),label:"Delinquent",description:"Simulate repayment delinquency (stops credit)."}),e.jsx(Ya,{label:"Credit limit (UGX)",value:W.limitUGX,onChange:O=>L(X=>({...X,limitUGX:Math.max(0,O)})),hint:Lt(W.limitUGX)}),e.jsx(Ya,{label:"Used (UGX)",value:W.usedUGX,onChange:O=>L(X=>({...X,usedUGX:py(O,0,X.limitUGX)})),hint:Lt(W.usedUGX)})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx(G4,{pct:W.usedUGX/Math.max(1,W.limitUGX)*100,labelLeft:`Used ${Lt(W.usedUGX)}`,labelRight:`Limit ${Lt(W.limitUGX)}`}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Available: ",Lt(Be)]})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Repayment terms"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Metadata for enterprise agreements."})]}),e.jsx(_t,{label:W.repaymentTerms.cycle,tone:"neutral"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(gl,{label:"Cycle",value:W.repaymentTerms.cycle,onChange:O=>L(X=>({...X,repaymentTerms:{...X.repaymentTerms,cycle:O}})),options:["Weekly","Monthly"]}),e.jsx(Ya,{label:"Grace days",value:W.repaymentTerms.graceDays,onChange:O=>L(X=>({...X,repaymentTerms:{...X.repaymentTerms,graceDays:Math.max(0,O)}}))}),e.jsx(yh,{label:"Terms metadata",value:W.repaymentTerms.metadata,onChange:O=>L(X=>({...X,repaymentTerms:{...X.repaymentTerms,metadata:O}})),placeholder:"Interest, fees, notes"})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Dt,{variant:"outline",onClick:()=>V("Repay credit"),children:[e.jsx(e4,{className:"h-4 w-4"})," Repay"]}),e.jsxs(Dt,{variant:"outline",onClick:()=>{const O=E({createdBy:"You",kind:"Limit increase",method:"Bank transfer",amountUGX:0,risk:"Medium",reason:"Request limit increase review",status:"Pending"});r({title:"Requested",message:`${O.id} limit review pending.",`,kind:"info"})},children:[e.jsx(gt,{className:"h-4 w-4"})," Request limit review"]})]})]})]})}),e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(Aa,{title:"Credit controls",subtitle:"Premium: risk controls and approval for large draws.",right:e.jsx(_t,{label:"Premium",tone:"info"}),children:[e.jsx(Ya,{label:"Large funding threshold",value:te,onChange:O=>oe(Math.max(0,O)),hint:"Shared setting"}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Large repayment events can require approvals. Delinquency triggers auto stop."})]})})]}):null,i==="prepaid"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs(Aa,{title:"Prepaid deposit",subtitle:"Spend down account. When depleted, services can stop automatically.",right:e.jsx(_t,{label:R.enabled?"Enabled":"Off",tone:R.enabled?"good":"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Zi,{enabled:R.enabled,onChange:O=>F(X=>({...X,enabled:O})),label:"Enable prepaid",description:"Allow prepaid to be used as CorporatePay method."}),e.jsx(Zi,{enabled:R.stopWhenDepleted,onChange:O=>F(X=>({...X,stopWhenDepleted:O})),label:"Stop when depleted",description:"If on, prepaid depletion triggers a stop for prepaid payment model."}),e.jsx(Ya,{label:"Balance (UGX)",value:R.balanceUGX,onChange:O=>F(X=>({...X,balanceUGX:Math.max(0,O)})),hint:Lt(R.balanceUGX)}),e.jsx(Ya,{label:"Reserved (UGX)",value:R.reservedUGX,onChange:O=>F(X=>({...X,reservedUGX:py(O,0,X.balanceUGX)})),hint:"Pending commitments"})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx(G4,{pct:w/Math.max(1,R.balanceUGX)*100,labelLeft:`Available ${Lt(w)}`,labelRight:`Total ${Lt(R.balanceUGX)}`}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Reserved: ",Lt(R.reservedUGX)]})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:[e.jsxs(Dt,{variant:"primary",onClick:()=>V("Prepaid deposit"),children:[e.jsx(gt,{className:"h-4 w-4"})," Add deposit"]}),e.jsxs(Dt,{variant:"outline",onClick:()=>{const O=Math.min(w,15e4);F(X=>({...X,balanceUGX:Math.max(0,X.balanceUGX-O)})),u({type:"Prepaid spend",amountUGX:-O,note:"Prepaid spend simulation"}),r({title:"Spent",message:`Prepaid spend ${Lt(O)}.",`,kind:"success"})},children:[e.jsx(e4,{className:"h-4 w-4"})," Simulate spend"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"When prepaid is the default payment model, depletion can stop services immediately (if enabled)."})]})}),e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(Aa,{title:"Prepaid controls",subtitle:"Premium: approvals for large deposits and risk holds.",right:e.jsx(_t,{label:"Premium",tone:"info"}),children:[e.jsx(Ya,{label:"Large deposit threshold",value:te,onChange:O=>oe(Math.max(0,O)),hint:"Shared setting"}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Large deposits route to approvals. Risk holds can be placed at wallet level."})]})})]}):null,i==="funding"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs(Aa,{title:"Funding requests",subtitle:"Approvals for large events and sensitive operations.",right:e.jsx(_t,{label:`${ne} pending`,tone:ne?"warn":"good"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(yh,{label:"Search",value:ze,onChange:Ue,placeholder:"FR-1001, add funds..."}),e.jsx(gl,{label:"Status",value:le,onChange:O=>z(O),options:["All","Pending","Approved","Rejected"]})]}),e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"ID"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Kind"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Method"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Wallet"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Risk"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[Me.map(O=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:O.id}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:O.kind}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Lt(O.amountUGX)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:O.method}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:O.walletId||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(_t,{label:O.risk,tone:q4(O.risk)})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(_t,{label:O.status,tone:i_(O.status)})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[O.status==="Pending"?e.jsxs(e.Fragment,{children:[e.jsxs(Dt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>se(O.id),children:[e.jsx(tt,{className:"h-4 w-4"})," Approve"]}),e.jsxs(Dt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>D(O.id),children:[e.jsx(Qe,{className:"h-4 w-4"})," Reject"]})]}):e.jsx(_t,{label:O.approvedBy?`By ${O.approvedBy}`:"Done",tone:"neutral"}),e.jsxs(Dt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>r({title:"Details",message:`Reason: ${O.reason}`,kind:"info"}),children:[e.jsx(kt,{className:"h-4 w-4"})," Details"]})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:[jh(O.createdAt),"  ",O.createdBy]})]})]},O.id)),Me.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No requests found."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: large funding events require approvals and show in Approvals Inbox (K)."})]})}),e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(Aa,{title:"Funding actions",subtitle:"Create requests or apply immediately under threshold.",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs(Dt,{variant:"outline",onClick:()=>V("Add funds"),children:[e.jsx(gt,{className:"h-4 w-4"})," Add funds"]}),e.jsxs(Dt,{variant:"outline",onClick:()=>V("Prepaid deposit"),children:[e.jsx(Wm,{className:"h-4 w-4"})," Prepaid deposit"]}),e.jsxs(Dt,{variant:"outline",onClick:()=>V("Repay credit"),children:[e.jsx(Lc,{className:"h-4 w-4"})," Repay credit"]}),e.jsxs(Dt,{variant:"outline",onClick:()=>V("Transfer"),children:[e.jsx(_p,{className:"h-4 w-4"})," Transfer"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Funding rules: approvals are triggered by threshold and risk settings."})]})})]}):null,i==="autotopup"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs(Aa,{title:"Auto top-up rules",subtitle:"Premium: threshold-based top ups with max per day safeguards.",right:e.jsx(_t,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Dt,{variant:"primary",onClick:()=>{$e({id:"",enabled:!0,walletId:T,thresholdUGX:15e5,topUpAmountUGX:2e6,maxPerDayUGX:4e6,requireApprovalOverUGX:5e6,method:"Bank transfer",notes:""}),Ne(!0)},children:[e.jsx(gt,{className:"h-4 w-4"})," New rule"]}),e.jsxs(Dt,{variant:"outline",onClick:v,children:[e.jsx(Mr,{className:"h-4 w-4"})," Run simulation"]})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[_e.map(O=>{var X;return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:O.id}),e.jsx(_t,{label:O.enabled?"On":"Off",tone:O.enabled?"good":"neutral"}),e.jsx(_t,{label:O.method,tone:"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Wallet: ",((X=y.find(A=>A.id===O.walletId))==null?void 0:X.name)||O.walletId]}),e.jsxs("div",{className:"mt-2 grid grid-cols-1 gap-2 sm:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Trigger"}),e.jsxs("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:["Below ",Lt(O.thresholdUGX)]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Top-up"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:Lt(O.topUpAmountUGX)})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Max per day"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:Lt(O.maxPerDayUGX)})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Approval over"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:Lt(O.requireApprovalOverUGX)})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(Dt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{$e(O),Ne(!0)},children:"Edit"}),e.jsxs(Dt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Ee(A=>A.map(N=>N.id===O.id?{...N,enabled:!N.enabled}:N)),children:[O.enabled?e.jsx(ia,{className:"h-4 w-4"}):e.jsx(So,{className:"h-4 w-4"})," ",O.enabled?"Disable":"Enable"]})]})]}),O.notes?e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:O.notes}):null]},O.id)}),_e.length?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No rules configured."})]})]})}),e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsx(Aa,{title:"Notes",subtitle:"How auto top-up behaves.",children:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"1) If wallet available balance drops below threshold, a top-up is created"}),e.jsx("li",{children:"2) If top-up amount is above approval threshold, request goes to approvals"}),e.jsx("li",{children:"3) Max per day is a safeguard, enforced by policy in production"})]})})})})]}):null,i==="risk"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-7 space-y-4",children:[e.jsxs(Aa,{title:"Risk controls",subtitle:"Premium: freeze, holds, fraud triggers, and approvals for large events.",right:e.jsx(_t,{label:"Premium",tone:"info"}),children:[e.jsx(Zi,{enabled:G,onChange:H,label:"Freeze CorporatePay",description:"Stops CorporatePay at checkout. No silent actions and always audited."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Ya,{label:"Large funding approval threshold",value:te,onChange:O=>oe(Math.max(0,O)),hint:"Shared across funding"}),e.jsx(Ya,{label:"Invoice overdue days (simulate)",value:Y.invoiceOverdueDays,onChange:O=>we(X=>({...X,invoiceOverdueDays:Math.max(0,O)})),hint:"Impacts enforcement",disabled:!Y.enabled})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Fraud triggers examples: unusual funding frequency, repeated failed repayments, high value RFQ holds."})]}),e.jsx(Aa,{title:"Risk events",subtitle:"Investigate and resolve.",right:e.jsx(_t,{label:`${Pe.filter(O=>O.status==="Open").length} open`,tone:"warn"}),children:e.jsxs("div",{className:"space-y-2",children:[Pe.slice().sort((O,X)=>O.status===X.status?X.createdAt-O.createdAt:O.status==="Open"?-1:1).map(O=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(_t,{label:O.severity,tone:O.severity==="Critical"?"bad":O.severity==="Warning"?"warn":"info"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:O.title}),e.jsx(_t,{label:O.status,tone:O.status==="Open"?"warn":"good"})]}),e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:O.details}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:[jh(O.createdAt),"  ",_4(O.createdAt),O.walletId?`  Wallet ${O.walletId}`:""]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[O.status==="Open"?e.jsxs(Dt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>m(O.id),children:[e.jsx(tt,{className:"h-4 w-4"})," Resolve"]}):e.jsx(_t,{label:"Resolved",tone:"good"}),e.jsxs(Dt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>r({title:"Audit",message:"In production, this opens a full audit view.",kind:"info"}),children:[e.jsx(kt,{className:"h-4 w-4"})," Audit"]})]})]})},O.id)),Pe.length?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No risk events."})]})})]}),e.jsxs("div",{className:"lg:col-span-5 space-y-4",children:[e.jsxs(Aa,{title:"Enforcement summary",subtitle:"Auto stop when agreements are not complied with.",children:[e.jsxs("div",{className:Wa("rounded-3xl border p-4",B.status==="Hard stop"?"border-rose-200 bg-rose-50":B.status==="Soft stop"?"border-amber-200 bg-amber-50":"border-emerald-200 bg-emerald-50"),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:["Status: ",B.status]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-700",children:["Enforcement ",B.enabled?"enabled":"disabled","  Invoice grace ",Y.invoiceGraceDays," day(s)"]})]}),e.jsx(_t,{label:B.enabled?"On":"Off",tone:B.enabled?"info":"neutral"})]}),B.reasons.length?e.jsxs("div",{className:"mt-3 rounded-2xl bg-white/60 p-3 text-xs text-slate-700",children:[e.jsx("div",{className:"font-semibold",children:"Reasons"}),e.jsx("ul",{className:"mt-2 space-y-1",children:B.reasons.slice(0,8).map((O,X)=>e.jsxs("li",{children:[" ",O]},X))})]}):e.jsx("div",{className:"mt-3 text-xs text-slate-700",children:"No enforcement issues detected."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Policy-backed enforcement is recommended for corporate compliance and predictable spend."})]}),e.jsx(Aa,{title:"Quick tests",subtitle:"Simulate agreement issues and observe enforcement changes.",children:e.jsxs("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2",children:[e.jsxs(Dt,{variant:"outline",onClick:()=>{we(O=>({...O,invoiceOverdueDays:O.invoiceGraceDays+3})),r({title:"Simulated",message:"Invoice overdue beyond grace.",kind:"warn"})},children:[e.jsx(Dn,{className:"h-4 w-4"})," Simulate overdue"]}),e.jsxs(Dt,{variant:"outline",onClick:()=>{we(O=>({...O,invoiceOverdueDays:0})),r({title:"Reset",message:"Invoice overdue cleared.",kind:"info"})},children:[e.jsx(Mr,{className:"h-4 w-4"})," Clear overdue"]}),e.jsxs(Dt,{variant:"outline",onClick:()=>{$(O=>O.map(X=>X.id===T?{...X,balanceUGX:0,heldUGX:0}:X)),r({title:"Simulated",message:"Primary wallet depleted.",kind:"warn"})},children:[e.jsx(Ia,{className:"h-4 w-4"})," Deplete wallet"]}),e.jsxs(Dt,{variant:"outline",onClick:()=>{L(O=>({...O,delinquent:!0})),r({title:"Simulated",message:"Credit marked delinquent.",kind:"warn"})},children:[e.jsx(Lc,{className:"h-4 w-4"})," Delinquent credit"]})]})})]})]}):null,i==="ledger"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs(Aa,{title:"Ledger",subtitle:"All wallet, credit and prepaid movements.",right:e.jsx(_t,{label:`${be.length} entries`,tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx(yh,{label:"Search",value:ie,onChange:Oe,placeholder:"LG-001, hold, funding..."}),e.jsx(gl,{label:"Type",value:Se,onChange:O=>Te(O),options:["All",...Array.from(new Set(be.map(O=>O.type)))]}),e.jsx(gl,{label:"Wallet",value:Ge,onChange:We,options:["All",...M],hint:"Optional"})]}),e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"ID"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Type"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Wallet"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Note"})]})}),e.jsxs("tbody",{children:[De.map(O=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:O.id}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:jh(O.at)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(_t,{label:O.type,tone:"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:O.walletId||"-"}),e.jsx("td",{className:Wa("px-4 py-3 font-semibold",O.amountUGX<0?"text-rose-700":"text-slate-900"),children:O.amountUGX<0?`-${Lt(Math.abs(O.amountUGX))}`:Lt(O.amountUGX)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:O.note})]},O.id)),De.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No ledger entries."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: ledger exports can be pushed to ERP via secure API."})]})}),e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(Aa,{title:"Export",subtitle:"Export transactions for accounting.",right:e.jsx(_t,{label:"ERP-ready",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs(Dt,{variant:"outline",onClick:S,children:[e.jsx(pt,{className:"h-4 w-4"})," Export JSON"]}),e.jsxs(Dt,{variant:"outline",onClick:()=>{r({title:"Export",message:"CSV/PDF export would be generated in production.",kind:"info"})},children:[e.jsx(kt,{className:"h-4 w-4"})," Export CSV/PDF"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Best practice: use invoice group AP codes for ERP mapping."})]})})]}):null,null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"M Corporate Wallet, Credit Line and Prepaid Funding v2: three payment models, funding actions, credit metadata, prepaid stop, approvals, auto top-up, multi-wallets, risk controls, and enforcement."})})]})}),e.jsx(Jv,{open:Q,title:ce.id?"Edit wallet":"Create wallet",subtitle:"Premium: multi-wallets per group and cost center.",onClose:()=>Re(!1),actions:[...ce.id?[{label:"Delete",onClick:()=>{Xe(ce.id),Re(!1)},variant:"danger"}]:[],{label:"Save",onClick:me}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Dt,{variant:"outline",onClick:()=>Re(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[ce.id?e.jsxs(Dt,{variant:"danger",onClick:()=>{Xe(ce.id),Re(!1)},children:[e.jsx(Qe,{className:"h-4 w-4"})," Delete"]}):null,e.jsxs(Dt,{variant:"primary",onClick:me,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(yh,{label:"Name",value:ce.name,onChange:O=>xe(X=>({...X,name:O})),placeholder:"Wallet name"}),e.jsx(gl,{label:"Type",value:ce.type,onChange:O=>{const X=O;xe(A=>({...A,type:X,group:X==="Group"?A.group||"Operations":void 0,costCenter:X==="Cost center"?A.costCenter||"OPS-001":void 0}))},options:["Org","Group","Cost center"]}),e.jsx(gl,{label:"Group",value:ce.group||"Operations",onChange:O=>xe(X=>({...X,group:O})),options:s,disabled:ce.type!=="Group"}),e.jsx(gl,{label:"Cost center",value:ce.costCenter||"OPS-001",onChange:O=>xe(X=>({...X,costCenter:O})),options:a,disabled:ce.type!=="Cost center"}),e.jsx(Ya,{label:"Balance (UGX)",value:ce.balanceUGX,onChange:O=>xe(X=>({...X,balanceUGX:Math.max(0,O)})),hint:Lt(ce.balanceUGX)}),e.jsx(Ya,{label:"Held (UGX)",value:ce.heldUGX,onChange:O=>xe(X=>({...X,heldUGX:Math.max(0,O)})),hint:"Holds reserve funds"}),e.jsx(gl,{label:"Status",value:ce.status,onChange:O=>xe(X=>({...X,status:O})),options:["Active","Frozen"]}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"In production, cost center wallets map to chargeback and ERP exports."})]})}),e.jsx(Jv,{open:he,title:ye.kind,subtitle:"Funding actions with approvals for large events.",onClose:()=>de(!1),actions:[{label:"Submit",onClick:P}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Dt,{variant:"outline",onClick:()=>de(!1),children:"Cancel"}),e.jsxs(Dt,{variant:"primary",onClick:P,children:[e.jsx(tt,{className:"h-4 w-4"})," Submit"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(gl,{label:"Action",value:ye.kind,onChange:O=>Ke(X=>({...X,kind:O})),options:["Add funds","Transfer","Repay credit","Prepaid deposit"]}),e.jsx(gl,{label:"Method",value:ye.method,onChange:O=>Ke(X=>({...X,method:O})),options:["Bank transfer","Mobile money","Card","Internal transfer"],hint:ye.kind==="Transfer"?"Internal transfer":"Funding method",disabled:ye.kind==="Transfer"}),ye.kind==="Transfer"?e.jsxs(e.Fragment,{children:[e.jsx(gl,{label:"From wallet",value:ye.fromWalletId,onChange:O=>Ke(X=>({...X,fromWalletId:O})),options:M}),e.jsx(gl,{label:"To wallet",value:ye.toWalletId,onChange:O=>Ke(X=>({...X,toWalletId:O})),options:M})]}):ye.kind==="Add funds"?e.jsx(gl,{label:"Wallet",value:ye.toWalletId,onChange:O=>Ke(X=>({...X,toWalletId:O})),options:M}):null,e.jsx(Ya,{label:"Amount (UGX)",value:ye.amountUGX,onChange:O=>Ke(X=>({...X,amountUGX:Math.max(0,O)})),hint:Lt(ye.amountUGX)}),e.jsx(gl,{label:"Risk",value:ye.risk,onChange:O=>Ke(X=>({...X,risk:O})),options:["Low","Medium","High"],hint:"Premium safeguards"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(B4,{label:"Reason",value:ye.reason,onChange:O=>Ke(X=>({...X,reason:O})),placeholder:"Example: month-start top up for operations",hint:"Minimum 8 characters",rows:4})}),e.jsxs("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:["Approval required if amount is above ",Lt(te)," or if risk controls demand it."]})]})}),e.jsx(Jv,{open:Le,title:ge.id?"Edit auto top-up":"New auto top-up",subtitle:"Premium: threshold-based top up rule with max per day.",onClose:()=>Ne(!1),actions:[{label:"Save",onClick:k}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Dt,{variant:"outline",onClick:()=>Ne(!1),children:"Cancel"}),e.jsxs(Dt,{variant:"primary",onClick:k,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Zi,{enabled:ge.enabled,onChange:O=>$e(X=>({...X,enabled:O})),label:"Enabled",description:"If off, rule will not trigger."}),e.jsx(gl,{label:"Wallet",value:ge.walletId,onChange:O=>$e(X=>({...X,walletId:O})),options:M}),e.jsx(Ya,{label:"Trigger threshold (UGX)",value:ge.thresholdUGX,onChange:O=>$e(X=>({...X,thresholdUGX:Math.max(0,O)})),hint:Lt(ge.thresholdUGX)}),e.jsx(Ya,{label:"Top-up amount (UGX)",value:ge.topUpAmountUGX,onChange:O=>$e(X=>({...X,topUpAmountUGX:Math.max(0,O)})),hint:Lt(ge.topUpAmountUGX)}),e.jsx(Ya,{label:"Max per day (UGX)",value:ge.maxPerDayUGX,onChange:O=>$e(X=>({...X,maxPerDayUGX:Math.max(0,O)})),hint:Lt(ge.maxPerDayUGX)}),e.jsx(Ya,{label:"Approval required over (UGX)",value:ge.requireApprovalOverUGX,onChange:O=>$e(X=>({...X,requireApprovalOverUGX:Math.max(0,O)})),hint:"Creates funding request"}),e.jsx(gl,{label:"Method",value:ge.method,onChange:O=>$e(X=>({...X,method:O})),options:["Bank transfer","Mobile money","Card"]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(B4,{label:"Notes",value:ge.notes,onChange:O=>$e(X=>({...X,notes:O})),placeholder:"Explain rule intent",rows:3})})]})})]});function b({title:O,value:X,sub:A,icon:N,tone:h}){const K=h==="good"?"bg-emerald-50 text-emerald-700":h==="warn"?"bg-amber-50 text-amber-800":h==="bad"?"bg-rose-50 text-rose-700":h==="info"?"bg-blue-50 text-blue-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:O}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:X}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:A})]}),e.jsx("div",{className:Wa("grid h-10 w-10 place-items-center rounded-2xl",K),children:N})]})})}function ae({icon:O,title:X,subtitle:A,on:N,onToggle:h,selected:K,onSelect:_,bullets:ke}){return e.jsxs("div",{className:Wa("rounded-3xl border bg-white p-4",K?"border-emerald-300 ring-4 ring-emerald-100":"border-slate-200"),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-slate-50 text-slate-700 ring-1 ring-slate-200",children:O}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:X}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:A})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsx(_t,{label:N?"Enabled":"Off",tone:N?"good":"neutral"}),e.jsx("button",{type:"button",className:Wa("relative h-7 w-12 rounded-full border transition",N?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:h,"aria-label":"Toggle",children:e.jsx("span",{className:Wa("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",N?"left-[22px]":"left-1")})})]})]}),e.jsx("ul",{className:"mt-3 space-y-1 text-xs text-slate-600",children:ke.map(I=>e.jsxs("li",{children:[" ",I]},I))}),e.jsx("div",{className:"mt-4",children:e.jsxs(Dt,{variant:K?"primary":"outline",className:"w-full",onClick:_,disabled:!N,title:N?"":"Enable this model first",children:[e.jsx(ct,{className:"h-4 w-4"})," Set as default"]})})]})}function ve({icon:O,title:X,subtitle:A,onClick:N}){return e.jsx("button",{type:"button",onClick:N,className:"rounded-3xl border border-slate-200 bg-white p-4 text-left hover:bg-slate-50",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-emerald-50 text-emerald-700 ring-1 ring-emerald-200",children:O}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:X}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:A})]})]}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]})})}}const br={green:"#03CD8C",orange:"#F77F00"};function Sl(...t){return t.filter(Boolean).join(" ")}function nd(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function eb(t,s,a){return Math.max(s,Math.min(a,t))}function wi(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function Ed(t){return t.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"2-digit"})}function b0(t,s){const a=new Date(t);return a.setDate(a.getDate()+s),a}function HE(t){const[s,a]=t.split("-").map(l=>Number(l));return new Date(s,(a||1)-1,1,10,0,0,0)}function XE(t){const s=HE(t),a=new Date(s);return a.setMonth(a.getMonth()+1),a.setDate(0),a}function d_(t){return XE(t).getDate()}function c_(t,s){const a=d_(s);return t==="Daily"?a:t==="Weekly"?Math.max(1,Math.round(a/7)):t==="Monthly"?1:2}function z4(t,s){const a=HE(s);return t==="Monthly"?a:t==="Weekly"?b0(a,6):t==="Daily"?b0(a,0):b0(a,14)}function W4(t,s){return s.mode==="DueOnReceipt"?t:s.mode==="EOM"?XE(`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`):b0(t,Math.max(0,s.netDays))}function KE(t,s){if(!t.vatEnabled||t.vatRatePct<=0)return{vat:0,subtotal:s};const a=t.vatRatePct/100;if(t.vatInclusive){const r=s-s/(1+a),i=s-r;return{vat:r,subtotal:i}}return{vat:s*a,subtotal:s}}function ta({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Sl("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Cs({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:br.green}:t==="accent"?{background:br.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Sl(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function rd({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:Sl("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:Sl("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function Ja({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:Sl(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:Sl("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function to({label:t,value:s,onChange:a,hint:l,disabled:n}){return e.jsxs("div",{className:Sl(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",value:s,onChange:r=>a(Number(r.target.value||0)),disabled:n,className:Sl("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function Lr({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:Sl(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:Sl("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i,children:i},i))})]})}function gc({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4,disabled:i}){return e.jsxs("div",{className:Sl(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:o=>a(o.target.value),placeholder:l,rows:r,disabled:i,className:Sl("mt-2 w-full rounded-2xl border p-3 text-sm font-semibold shadow-sm outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function j0({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null),[n,r]=d.useState({top:0,left:0,up:!1});return d.useEffect(()=>{if(s&&l.current){const i=l.current.getBoundingClientRect(),o=t.length*40+20,x=window.innerHeight-i.bottom<o&&i.top>o;r({top:x?i.top-8:i.bottom+8,left:i.right,up:x});const j=()=>a(!1);return window.addEventListener("scroll",j,{capture:!0}),window.addEventListener("resize",j),()=>{window.removeEventListener("scroll",j,{capture:!0}),window.removeEventListener("resize",j)}}},[s,t.length]),e.jsxs(e.Fragment,{children:[e.jsx("button",{ref:l,onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 focus:bg-slate-100 focus:outline-none",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&Lg.createPortal(e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-[9998]",onClick:()=>a(!1)}),e.jsx("div",{className:"fixed z-[9999] w-48 overflow-hidden rounded-xl border border-slate-200 bg-white shadow-xl ring-1 ring-slate-200",style:{top:n.up?"auto":n.top,bottom:n.up?window.innerHeight-n.top:"auto",left:n.left-192},children:t.map((i,o)=>e.jsx("button",{onClick:()=>{i.onClick(),a(!1)},className:Sl("block w-full px-4 py-2.5 text-left text-sm font-medium transition hover:bg-slate-50",i.variant==="danger"?"text-rose-700 hover:bg-rose-50":"text-slate-700"),children:i.label},o))})]}),document.body)]})}function Nh({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="920px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[8vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-1",children:[o?e.jsx(j0,{actions:o}):null,e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function u_({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Sl("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(en,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function so({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function m_({entity:t,template:s,invoiceNo:a,issueDate:l,dueDate:n,terms:r,lines:i}){const o=d.useMemo(()=>{let x=0,j=0;for(const y of i){const $=KE(t,y.amountUGX);x+=$.subtotal,j+=$.vat}const g=(t.vatEnabled&&!t.vatInclusive,x+j);return{subtotal:x,vat:j,total:g}},[t,i]),c=d.useMemo(()=>r.mode==="DueOnReceipt"?"Due on receipt":r.mode==="EOM"?"Due end of month":`Net ${r.netDays}`,[r]);return e.jsxs("div",{className:"overflow-hidden rounded-[24px] border border-slate-200 bg-white",children:[e.jsxs("div",{className:"px-5 py-4",style:{background:"linear-gradient(135deg, rgba(3,205,140,0.12), rgba(255,255,255,0))"},children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Sl("grid h-11 w-11 place-items-center rounded-2xl text-white",s.showLogo?"":"opacity-70"),style:{background:s.accent||br.green},children:e.jsx(kt,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:s.brandName||"CorporatePay"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Invoice"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Invoice No"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:a})]})]}),s.headerNote?e.jsx("div",{className:"mt-3 rounded-2xl bg-white/70 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:s.headerNote}):null]}),e.jsxs("div",{className:"px-5 py-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"From"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:t.legalName}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:[t.address1,t.address2?`, ${t.address2}`:"",e.jsx("br",{}),t.city,", ",t.country,e.jsx("br",{}),"Tax ID: ",t.taxId||"-","  VAT: ",t.vatNo||"-"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Dates"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Issue: ",e.jsx("span",{className:"font-semibold text-slate-900",children:Ed(l)})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Due: ",e.jsx("span",{className:"font-semibold text-slate-900",children:Ed(n)})]}),e.jsx("div",{className:"mt-2",children:e.jsx(ta,{label:c,tone:"info"})})]})]}),e.jsx("div",{className:"mt-4 overflow-hidden rounded-2xl border border-slate-200",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Description"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Module"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"})]})}),e.jsxs("tbody",{children:[i.slice(0,6).map(x=>e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:x.description}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[x.module,x.marketplace?`  ${x.marketplace}`:""]}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:wi(x.amountUGX)})]},x.id)),i.length>6?e.jsx("tr",{className:"border-t border-slate-100",children:e.jsxs("td",{className:"px-4 py-3 text-xs text-slate-600",colSpan:3,children:["+ ",i.length-6," more line(s)"]})}):null]})]})}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Payment instructions"}),e.jsx("div",{className:"mt-1 text-slate-700",children:s.paymentInstructions||"-"})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-600",children:[e.jsx("span",{className:"font-semibold",children:"Subtotal"}),e.jsx("span",{className:"font-semibold text-slate-900",children:wi(o.subtotal)})]}),s.showVatLine?e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs text-slate-600",children:[e.jsx("span",{className:"font-semibold",children:"VAT"}),e.jsx("span",{className:"font-semibold text-slate-900",children:wi(o.vat)})]}):null,e.jsxs("div",{className:"mt-2 flex items-center justify-between text-sm text-slate-900",children:[e.jsx("span",{className:"font-semibold",children:"Total"}),e.jsx("span",{className:"font-semibold",children:wi(o.total)})]})]})]}),s.footerText?e.jsx("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:s.footerText}):null]})]})}function x_(){const[t,s]=d.useState([]),a=E=>{const u=nd("toast");s(P=>[{id:u,...E},...P].slice(0,4)),window.setTimeout(()=>s(P=>P.filter(se=>se.id!==u)),3200)},[l,n]=d.useState("invoiceGroups"),[r,i]=d.useState({mode:"Net",netDays:7,earlyDiscountPct:0,earlyDiscountDays:0,lateFeeText:"Late fees apply as per agreement."}),[o,c]=d.useState(()=>[{id:"ENT-UG",name:"Uganda HQ",legalName:"Acme Group Limited (Uganda)",country:"Uganda",city:"Kampala",address1:"Plot 12, Nkrumah Road",address2:"Suite 5",currency:"UGX",taxId:"TIN-123-456-789",vatNo:"VAT-UG-00991",vatEnabled:!0,vatRatePct:18,vatInclusive:!1,billingEmail:"ap-ug@acme.com",phone:"+256 700 000 000",isPrimary:!0},{id:"ENT-CN",name:"China Branch",legalName:"Acme Group Co., Ltd. (China)",country:"China",city:"Wuxi",address1:"Room 265, No. 3 Gaolang East Road",address2:"Xinwu District",currency:"CNY",taxId:"CN-TAX-0001",vatNo:"CN-VAT-0001",vatEnabled:!0,vatRatePct:13,vatInclusive:!1,billingEmail:"ap-cn@acme.com",phone:"+86 177 0000 0000",isPrimary:!1}]),[x,j]=d.useState(()=>[{id:"TPL-01",name:"Default modern",brandName:"EVzone CorporatePay",accent:br.green,showLogo:!0,headerNote:"Thank you for your business.",footerText:"This invoice is generated electronically and is valid without signature.",paymentInstructions:"Pay via bank transfer. Reference the invoice number.",showVatLine:!0,layout:"Modern"},{id:"TPL-02",name:"Finance classic",brandName:"EVzone CorporatePay",accent:br.orange,showLogo:!0,headerNote:"Accounts Payable: please include cost code on remittance advice.",footerText:"Payment terms apply as agreed.",paymentInstructions:"Bank transfer only. Contact finance for details.",showVatLine:!0,layout:"Classic"}]),[g,y]=d.useState(()=>{const E=Date.now();return[{id:"IG-MAIN-UG",name:"Main corporate",entityId:"ENT-UG",frequency:"Weekly",customRule:"",apTo:"ap@acme.com",apCc:"finance@acme.com",costCode:"ACME-MAIN",templateId:"TPL-01",prefix:"ACME",nextSequence:1042,paymentTermsOverrideEnabled:!1,status:"Active",lastInvoicedAt:E-7*24*60*60*1e3,nextInvoiceAt:E+2*24*60*60*1e3,notes:"Primary stream for Uganda HQ."},{id:"IG-SALES-TRAVEL",name:"Sales travel",entityId:"ENT-UG",frequency:"Monthly",customRule:"",apTo:"sales-ap@acme.com",apCc:"finance@acme.com",costCode:"ACME-SALES",templateId:"TPL-02",prefix:"ACME-SALES",nextSequence:88,paymentTermsOverrideEnabled:!0,paymentTermsOverride:{mode:"Net",netDays:14,earlyDiscountPct:0,earlyDiscountDays:0,lateFeeText:"Late fees apply."},status:"Active",lastInvoicedAt:E-28*24*60*60*1e3,nextInvoiceAt:E+3*24*60*60*1e3,notes:"Sales commutes and client rides."},{id:"IG-CN-PROC",name:"China procurement",entityId:"ENT-CN",frequency:"Weekly",customRule:"",apTo:"ap-cn@acme.com",apCc:"finance@acme.com",costCode:"CN-PROC",templateId:"TPL-01",prefix:"ACME-CN",nextSequence:221,paymentTermsOverrideEnabled:!1,status:"Active",lastInvoicedAt:E-8*24*60*60*1e3,nextInvoiceAt:E+1*24*60*60*1e3,notes:"Separate legal entity stream."}]}),$=d.useMemo(()=>{const E=(u,P,se,D,re)=>({id:u,description:P,module:se,marketplace:re,amountUGX:D});return{"IG-MAIN-UG":[E("L1","Corporate rides","Rides & Logistics",82e5),E("L2","EV charging credits","EVs & Charging",41e5),E("L3","EVmart purchases","E-Commerce",24e5,"EVmart"),E("L4","MyLiveDealz deals","E-Commerce",31e5,"MyLiveDealz")],"IG-SALES-TRAVEL":[E("L1","Sales travel rides","Rides & Logistics",52e5)],"IG-CN-PROC":[E("L1","GadgetMart procurement","E-Commerce",6e6,"GadgetMart"),E("L2","ExpressMart logistics","E-Commerce",11e5,"ExpressMart")]}},[]),[T,C]=d.useState(()=>{const E=new Date,u=new Date(E);return u.setMonth(u.getMonth()+1),`${u.getFullYear()}-${String(u.getMonth()+1).padStart(2,"0")}`}),[W,L]=d.useState(!0),[R,F]=d.useState(()=>JSON.parse(JSON.stringify($))),[te,oe]=d.useState(!1),[G,H]=d.useState(()=>({id:"",name:"",legalName:"",country:"",city:"",address1:"",address2:"",currency:"UGX",taxId:"",vatNo:"",vatEnabled:!0,vatRatePct:18,vatInclusive:!1,billingEmail:"",phone:"",isPrimary:!1})),[Y,we]=d.useState(!1),[q,je]=d.useState(()=>({id:"",name:"",brandName:"EVzone CorporatePay",accent:br.green,showLogo:!0,headerNote:"",footerText:"",paymentInstructions:"",showVatLine:!0,layout:"Modern"})),[_e,Ee]=d.useState(!1),[be,Fe]=d.useState(()=>({id:"",name:"",entityId:"ENT-UG",frequency:"Monthly",customRule:"",apTo:"",apCc:"",costCode:"",templateId:"TPL-01",prefix:"INV",nextSequence:1,paymentTermsOverrideEnabled:!1,paymentTermsOverride:void 0,status:"Active",notes:""})),[Pe,pe]=d.useState(()=>{var E;return((E=g[0])==null?void 0:E.id)||""}),[Q,Re]=d.useState(!1),[ce,xe]=d.useState({...r}),he=d.useMemo(()=>{const E={};return o.forEach(u=>E[u.id]=u),E},[o]),de=d.useMemo(()=>{const E={};return x.forEach(u=>E[u.id]=u),E},[x]),ye=d.useMemo(()=>{const E={};return g.forEach(u=>E[u.id]=u),E},[g]),Ke=d.useMemo(()=>{const E=g.filter(u=>u.status==="Active"&&u.nextInvoiceAt).map(u=>u.nextInvoiceAt).sort((u,P)=>u-P);return E.length?new Date(E[0]):null},[g]),Le=d.useMemo(()=>g.filter(E=>E.status==="Active").map(E=>{const u=he[E.entityId],P=R[E.id]||[],se=c_(E.frequency,T);let D=0,re=0;for(const ve of P){const O=KE(u,ve.amountUGX);D+=O.subtotal,re+=O.vat}const v=z4(E.frequency,T),k=E.paymentTermsOverrideEnabled&&E.paymentTermsOverride?E.paymentTermsOverride:r,m=W4(v,k),S=D,f=W?re:0,U=S+f,p=Math.round(S/Math.max(1,se)),M=Math.round(f/Math.max(1,se)),ee=p+M,b=E.nextSequence,ae=`${E.prefix}-${T.replace("-","")}-${String(b).padStart(4,"0")}`;return{invoiceGroupId:E.id,entityId:E.entityId,month:T,cyclesInMonth:se,monthSubtotal:S,monthVat:f,monthTotal:U,perCycleSubtotal:p,perCycleVat:M,perCycleTotal:ee,invoiceNoPreview:ae,issueDate:v,dueDate:m,lineItems:P}}).sort((E,u)=>E.entityId.localeCompare(u.entityId)||E.invoiceGroupId.localeCompare(u.invoiceGroupId)),[g,he,R,T,W,r]),Ne=d.useMemo(()=>Le.reduce((E,u)=>E+u.monthTotal,0),[Le]),ge=()=>{const E={entities:o,templates:x,invoiceGroups:g,paymentTerms:r,simulation:{month:T,includeVat:W,linesByGroup:R},exportedAt:new Date().toISOString()},u=JSON.stringify(E,null,2),P=new Blob([u],{type:"application/json"}),se=URL.createObjectURL(P),D=document.createElement("a");D.href=se,D.download="corporatepay-billing-setup.json",D.click(),URL.revokeObjectURL(se),a({title:"Exported",message:"Downloaded billing configuration.",kind:"success"})},$e=()=>a({title:"Saved",message:"Billing setup saved (demo).",kind:"success"}),ie=()=>{H({id:"",name:"",legalName:"",country:"",city:"",address1:"",address2:"",currency:"UGX",taxId:"",vatNo:"",vatEnabled:!0,vatRatePct:18,vatInclusive:!1,billingEmail:"",phone:"",isPrimary:!1}),oe(!0)},Oe=E=>{H(JSON.parse(JSON.stringify(E))),oe(!0)},Se=()=>{if(!G.name.trim()||!G.legalName.trim()||!G.country.trim()){a({title:"Missing fields",message:"Entity name, legal name, and country are required.",kind:"warn"});return}const E=G.id||nd("ENT");c(u=>{let P=u.slice();G.isPrimary&&(P=P.map(re=>({...re,isPrimary:!1})));const se=P.findIndex(re=>re.id===E),D={...G,id:E};return se>=0?P[se]=D:P.unshift(D),P}),a({title:"Saved",message:"Entity saved.",kind:"success"}),oe(!1)},Te=E=>{const u=o.find(se=>se.id===E);if(u!=null&&u.isPrimary){a({title:"Blocked",message:"You cannot delete the primary entity.",kind:"warn"});return}if(g.some(se=>se.entityId===E)){a({title:"Blocked",message:"Entity is used by an invoice group.",kind:"warn"});return}c(se=>se.filter(D=>D.id!==E)),a({title:"Deleted",message:"Entity deleted.",kind:"info"})},Ge=()=>{je({id:"",name:"",brandName:"EVzone CorporatePay",accent:br.green,showLogo:!0,headerNote:"",footerText:"",paymentInstructions:"Pay via bank transfer. Reference the invoice number.",showVatLine:!0,layout:"Modern"}),we(!0)},We=E=>{je(JSON.parse(JSON.stringify(E))),we(!0)},ze=()=>{if(!q.name.trim()){a({title:"Missing name",message:"Template name is required.",kind:"warn"});return}const E=q.id||nd("TPL"),u={...q,id:E};j(P=>{const se=P.slice(),D=se.findIndex(re=>re.id===E);return D>=0?se[D]=u:se.unshift(u),se}),a({title:"Saved",message:"Template saved.",kind:"success"}),we(!1)},Ue=E=>{if(g.some(P=>P.templateId===E)){a({title:"Blocked",message:"Template is used by an invoice group.",kind:"warn"});return}j(P=>P.filter(se=>se.id!==E)),a({title:"Deleted",message:"Template deleted.",kind:"info"})},le=E=>{const u=x.find(se=>se.id===E);if(!u)return;const P={...JSON.parse(JSON.stringify(u)),id:nd("TPL"),name:`${u.name} (Copy)`};j(se=>[P,...se]),a({title:"Duplicated",message:"Template duplicated.",kind:"success"})},z=()=>{var E,u,P;Fe({id:"",name:"",entityId:((E=o.find(se=>se.isPrimary))==null?void 0:E.id)||((u=o[0])==null?void 0:u.id)||"",frequency:"Monthly",customRule:"",apTo:"",apCc:"",costCode:"",templateId:((P=x[0])==null?void 0:P.id)||"",prefix:"INV",nextSequence:1,paymentTermsOverrideEnabled:!1,paymentTermsOverride:void 0,status:"Active",notes:""}),Ee(!0)},Ae=E=>{Fe(JSON.parse(JSON.stringify(E))),Ee(!0)},Ve=()=>{if(!be.name.trim()||!be.apTo.trim()||!be.costCode.trim()){a({title:"Missing fields",message:"Group name, AP recipient, and cost code are required.",kind:"warn"});return}const E=be.id||nd("IG"),u={...be,id:E};u.paymentTermsOverrideEnabled&&!u.paymentTermsOverride&&(u.paymentTermsOverride={...r}),y(P=>{const se=P.slice(),D=se.findIndex(re=>re.id===E);return D>=0?se[D]=u:se.unshift(u),se}),a({title:"Saved",message:"Invoice group saved.",kind:"success"}),Ee(!1)},Ye=E=>{y(u=>u.filter(P=>P.id!==E)),a({title:"Deleted",message:"Invoice group deleted.",kind:"info"})},Be=E=>{const u=g.find(se=>se.id===E);if(!u)return;const P={...JSON.parse(JSON.stringify(u)),id:nd("IG"),name:`${u.name} (Copy)`,nextSequence:1};y(se=>[P,...se]),a({title:"Cloned",message:"Invoice group cloned.",kind:"success"})},w=E=>{y(u=>u.map(P=>P.id===E?{...P,status:P.status==="Active"?"Paused":"Active"}:P)),a({title:"Updated",message:"Invoice group status updated.",kind:"info"})},B=()=>{const E=ye[be.id||""],u=be.paymentTermsOverride||((E==null?void 0:E.paymentTermsOverride)??r);xe({...u}),Re(!0)},ue=()=>{Fe(E=>({...E,paymentTermsOverride:{...ce},paymentTermsOverrideEnabled:!0})),Re(!1),a({title:"Applied",message:"Payment terms override applied to group draft.",kind:"success"})},ne=(E,u,P)=>{F(se=>{const D={...se},re=(D[E]||[]).map(v=>v.id===u?{...v,...P}:v);return D[E]=re,D})},Me=E=>{F(u=>{const P={...u},se=P[E]?P[E].slice():[];return se.push({id:nd("LI"),description:"New line",module:"Rides & Logistics",marketplace:"",amountUGX:0}),P[E]=se,P})},De=(E,u)=>{F(P=>{const se={...P};return se[E]=(se[E]||[]).filter(D=>D.id!==u),se})},fe=async()=>{try{await navigator.clipboard.writeText(JSON.stringify(Le,null,2)),a({title:"Copied",message:"Simulation JSON copied to clipboard.",kind:"success"})}catch{a({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},me=d.useMemo(()=>{const E=g.find(S=>S.id===Pe)||g[0];if(!E)return null;const u=he[E.entityId]||o[0],P=de[E.templateId]||x[0],se=Le.find(S=>S.invoiceGroupId===E.id),D=(se==null?void 0:se.invoiceNoPreview)||`${E.prefix}-${T.replace("-","")}-${String(E.nextSequence).padStart(4,"0")}`,re=(se==null?void 0:se.issueDate)||z4(E.frequency,T),v=(se==null?void 0:se.dueDate)||W4(re,E.paymentTermsOverrideEnabled&&E.paymentTermsOverride?E.paymentTermsOverride:r),k=(se==null?void 0:se.lineItems)||R[E.id]||[],m=E.paymentTermsOverrideEnabled&&E.paymentTermsOverride?E.paymentTermsOverride:r;return{entity:u,template:P,invoiceNo:D,issueDate:re,dueDate:v,terms:m,lines:k}},[Pe,g,he,de,o,x,Le,T,R,r]),Xe=d.useMemo(()=>r.mode==="DueOnReceipt"?"Due on receipt":r.mode==="EOM"?"Due end of month":`Net ${r.netDays}`,[r]),V=d.useMemo(()=>o.map(E=>E.id),[o]);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(u_,{toasts:t,onDismiss:E=>s(u=>u.filter(P=>P.id!==E))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:br.green},children:e.jsx(kt,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Billing Setup and Invoice Groups"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Invoice schedules, invoice groups, multi-entity tax settings, branded templates, and invoice simulations."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(ta,{label:`Entities: ${o.length}`,tone:"neutral"}),e.jsx(ta,{label:`Invoice groups: ${g.length}`,tone:"neutral"}),e.jsx(ta,{label:`Terms: ${Xe}`,tone:"info"}),Ke?e.jsx(ta,{label:`Next invoice: ${Ed(Ke)}`,tone:"neutral"}):e.jsx(ta,{label:"No upcoming invoices",tone:"warn"}),e.jsx(ta,{label:`Next month estimate: ${wi(Ne)}`,tone:Ne>0?"good":"neutral"}),e.jsx(ta,{label:"Premium simulations",tone:"info"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Cs,{variant:"outline",onClick:ge,children:[e.jsx(pt,{className:"h-4 w-4"})," Export JSON"]}),e.jsxs(Cs,{variant:"outline",onClick:$e,children:[e.jsx(Da,{className:"h-4 w-4"})," Save"]}),e.jsxs(Cs,{variant:"outline",onClick:fe,children:[e.jsx(ss,{className:"h-4 w-4"})," Copy simulation"]}),e.jsxs(Cs,{variant:"outline",onClick:Ge,children:[e.jsx(s4,{className:"h-4 w-4"})," New template"]}),e.jsxs(Cs,{variant:"primary",onClick:z,children:[e.jsx(gt,{className:"h-4 w-4"})," New invoice group"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"invoiceGroups",label:"Invoice groups"},{id:"entities",label:"Entities and tax"},{id:"templates",label:"Templates"},{id:"simulation",label:"Billing simulation"},{id:"terms",label:"Payment terms"}].map(E=>e.jsx("button",{className:Sl("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",l===E.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:l===E.id?{background:br.green}:void 0,onClick:()=>n(E.id),children:E.label},E.id))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"space-y-4",children:e.jsxs(lt,{mode:"wait",children:[l==="invoiceGroups"?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs(so,{title:"Invoice groups",subtitle:"Different AP recipients, cost codes, templates, and frequencies. Each group is tied to a legal entity stream.",right:e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:e.jsxs(Cs,{variant:"outline",onClick:z,children:[e.jsx(gt,{className:"h-4 w-4"})," Add"]})}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Entity"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Frequency"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"AP recipients"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Cost code"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Template"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Next invoice"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[g.map(E=>{const u=he[E.entityId],P=de[E.templateId];return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:E.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[E.prefix,"  Seq ",E.nextSequence]})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:u?u.name:E.entityId}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx(ta,{label:E.frequency,tone:"neutral"}),E.frequency==="Custom"&&E.customRule?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:E.customRule}):null]}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[e.jsxs("div",{className:"text-xs",children:["To: ",e.jsx("span",{className:"font-semibold",children:E.apTo})]}),E.apCc?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["CC: ",E.apCc]}):null]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:E.costCode}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:P?P.name:E.templateId}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ta,{label:E.status,tone:E.status==="Active"?"good":"warn"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:E.nextInvoiceAt?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:Ed(new Date(E.nextInvoiceAt))}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Last: ",E.lastInvoicedAt?Ed(new Date(E.lastInvoicedAt)):"-"]})]}):e.jsx("div",{className:"text-xs text-slate-500",children:"-"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(j0,{actions:[{label:"Preview",onClick:()=>{pe(E.id),a({title:"Preview",message:"Invoice preview updated.",kind:"info"})}},{label:"Edit",onClick:()=>Ae(E)},{label:"Clone",onClick:()=>Be(E.id)},{label:E.status==="Active"?"Pause":"Activate",onClick:()=>w(E.id)},{label:"Delete",onClick:()=>Ye(E.id),variant:"danger"}]})})]},E.id)}),g.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No invoice groups configured."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: each legal entity can have separate invoice streams. Use different invoice groups tied to each entity."})]})},"invoiceGroups"):null,l==="entities"?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs(so,{title:"Entities and tax, VAT",subtitle:"Tax and VAT settings are per entity or branch.",right:e.jsxs(Cs,{variant:"primary",onClick:ie,children:[e.jsx(gt,{className:"h-4 w-4"})," Add entity"]}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Entity"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Country"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Currency"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Tax ID"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"VAT"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Billing contact"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Primary"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsx("tbody",{children:o.map(E=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:E.name}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:E.legalName})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:E.country}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:E.currency}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:E.taxId||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ta,{label:E.vatEnabled?"VAT on":"VAT off",tone:E.vatEnabled?"good":"neutral"}),E.vatEnabled?e.jsx(ta,{label:`${E.vatRatePct}%`,tone:"info"}):null,E.vatEnabled?e.jsx(ta,{label:E.vatInclusive?"Inclusive":"Exclusive",tone:"neutral"}):null]})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:E.billingEmail||"-"}),e.jsx("td",{className:"px-4 py-3",children:E.isPrimary?e.jsx(ta,{label:"Primary",tone:"good"}):e.jsx(ta,{label:"No",tone:"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(j0,{actions:[{label:"Edit",onClick:()=>Oe(E)},{label:"Delete",onClick:()=>Te(E.id),variant:"danger"}]})})]},E.id))})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: VAT inclusive means VAT is included in item amounts. VAT exclusive adds VAT on top."})]})},"entities"):null,l==="templates"?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs(so,{title:"Invoice templates",subtitle:"Premium: branded templates per invoice group.",right:e.jsxs(Cs,{variant:"primary",onClick:Ge,children:[e.jsx(gt,{className:"h-4 w-4"})," New"]}),children:[e.jsx("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:x.map(E=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:E.name}),e.jsx(ta,{label:E.layout,tone:"neutral"}),e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-slate-50 px-3 py-2 text-xs font-semibold text-slate-700 ring-1 ring-slate-200",children:[e.jsx("span",{className:"h-2.5 w-2.5 rounded-full",style:{background:E.accent}}),"Accent"]})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Brand: ",E.brandName]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(ta,{label:E.showVatLine?"VAT line":"No VAT line",tone:E.showVatLine?"info":"neutral"}),e.jsx(ta,{label:E.showLogo?"Logo":"No logo",tone:E.showLogo?"good":"neutral"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(Cs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>We(E),children:[e.jsx(Uo,{className:"h-4 w-4"})," Edit"]}),e.jsxs(Cs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>le(E.id),children:[e.jsx(La,{className:"h-4 w-4"})," Duplicate"]}),e.jsx(Cs,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>Ue(E.id),children:e.jsx(as,{className:"h-4 w-4"})})]})]}),E.headerNote?e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:E.headerNote}):null]},E.id))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: assign templates per invoice group for separate branded streams."})]})},"templates"):null,l==="simulation"?e.jsx(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:e.jsxs(so,{title:"Billing simulation",subtitle:"Premium: what would next month invoice look like by invoice group and entity.",right:e.jsx(ta,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx(Ja,{label:"Simulation month",value:T,onChange:C,placeholder:"YYYY-MM",hint:"Example: 2026-02"}),e.jsx(rd,{enabled:W,onChange:L,label:"Include VAT",description:"Uses entity VAT settings"}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Estimate"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:wi(Ne)}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"All entities combined"})]})]}),e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Entity"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Invoice group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Frequency"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Cycles"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Month total"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Per-cycle estimate"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Invoice preview"})]})}),e.jsx("tbody",{children:Le.map(E=>{const u=ye[E.invoiceGroupId],P=he[E.entityId];return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(P==null?void 0:P.name)||E.entityId}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:(u==null?void 0:u.name)||E.invoiceGroupId}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Cost code: ",(u==null?void 0:u.costCode)||"-"]})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(u==null?void 0:u.frequency)||"-"}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:E.cyclesInMonth}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:wi(E.monthTotal)}),W?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["VAT: ",wi(E.monthVat)]}):e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"VAT not included"})]}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:wi(E.perCycleTotal)}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Issue: ",Ed(E.issueDate),"  Due: ",Ed(E.dueDate)]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(j0,{actions:[{label:"Preview",onClick:()=>pe(E.invoiceGroupId)},{label:"Add line item",onClick:()=>{Me(E.invoiceGroupId),a({title:"Added",message:"Line item added.",kind:"success"})}}]})})]},`${E.invoiceGroupId}-${E.entityId}`)})})]})}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Edit line items"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Adjust forecast inputs. Totals update automatically."})]}),e.jsx(ta,{label:Pe||"Select a group",tone:"info"})]}),Pe?e.jsx("div",{className:"mt-3 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Description"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Module"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Marketplace"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[(R[Pe]||[]).map(E=>e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{value:E.description,onChange:u=>ne(Pe,E.id,{description:u.target.value}),className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{value:E.module,onChange:u=>ne(Pe,E.id,{module:u.target.value}),className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{value:E.marketplace||"",onChange:u=>ne(Pe,E.id,{marketplace:u.target.value}),placeholder:"Optional",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"number",value:E.amountUGX,onChange:u=>ne(Pe,E.id,{amountUGX:Number(u.target.value||0)}),className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Cs,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>De(Pe,E.id),children:e.jsx(as,{className:"h-4 w-4"})})})]},E.id)),(R[Pe]||[]).length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No line items. Add one above."})})]})]})}):e.jsx("div",{className:"mt-3 rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"Select an invoice group to edit its simulation inputs."})]})]})},"simulation"):null,l==="terms"?e.jsxs(qe.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},className:"space-y-4",children:[e.jsxs(so,{title:"Payment terms",subtitle:"Global default terms. Invoice groups can override if needed.",right:e.jsx(ta,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Lr,{label:"Mode",value:r.mode,onChange:E=>i(u=>({...u,mode:E})),options:["Net","DueOnReceipt","EOM"],hint:"Due date rule"}),e.jsx(to,{label:"Net days",value:r.netDays,onChange:E=>i(u=>({...u,netDays:Math.max(0,E)})),disabled:r.mode!=="Net",hint:r.mode!=="Net"?"Not used":"Applies to all groups"}),e.jsx(to,{label:"Early discount percent",value:r.earlyDiscountPct,onChange:E=>i(u=>({...u,earlyDiscountPct:eb(E,0,100)})),hint:"Optional"}),e.jsx(to,{label:"Early discount days",value:r.earlyDiscountDays,onChange:E=>i(u=>({...u,earlyDiscountDays:Math.max(0,E)})),disabled:r.earlyDiscountPct<=0,hint:"Optional"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(gc,{label:"Late fee text",value:r.lateFeeText,onChange:E=>i(u=>({...u,lateFeeText:E})),placeholder:"Late fees apply...",rows:3})})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: invoice groups can have different terms if required by a specific AP desk."})]}),e.jsx(so,{title:"Group overrides",subtitle:"View and edit overrides by invoice group.",right:e.jsx(ta,{label:"Premium",tone:"info"}),children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Invoice group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Override"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Terms"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Action"})]})}),e.jsx("tbody",{children:g.map(E=>{const u=E.paymentTermsOverrideEnabled&&E.paymentTermsOverride?E.paymentTermsOverride:r,P=u.mode==="DueOnReceipt"?"Due on receipt":u.mode==="EOM"?"EOM":`Net ${u.netDays}`;return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:E.name}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ta,{label:E.paymentTermsOverrideEnabled?"Yes":"No",tone:E.paymentTermsOverrideEnabled?"info":"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:P}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(Cs,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Fe(JSON.parse(JSON.stringify(E))),xe({...E.paymentTermsOverride||r}),Re(!0),Ee(!0),a({title:"Edit",message:"Edit group and apply override.",kind:"info"})},children:[e.jsx(Uo,{className:"h-4 w-4"})," Edit"]})})]},E.id)})})]})})})]},"terms"):null]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(so,{title:"Invoice preview",subtitle:"Branded template preview for the selected invoice group.",right:e.jsx(ta,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx(Lr,{label:"Preview invoice group",value:Pe,onChange:pe,options:g.map(E=>E.id),hint:"Choose a group"}),me?e.jsx(m_,{entity:me.entity,template:me.template,invoiceNo:me.invoiceNo,issueDate:me.issueDate,dueDate:me.dueDate,terms:me.terms,lines:me.lines}):e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No preview available."})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Cs,{variant:"outline",onClick:()=>a({title:"PDF",message:"In production, this exports PDF.",kind:"info"}),children:[e.jsx(kt,{className:"h-4 w-4"})," Export PDF"]}),e.jsxs(Cs,{variant:"outline",onClick:()=>a({title:"Send",message:"In production, this sends to AP recipients.",kind:"info"}),children:[e.jsx(Xs,{className:"h-4 w-4"})," Send test"]}),e.jsxs(Cs,{variant:"outline",onClick:()=>a({title:"Numbering",message:"Invoice number preview is based on prefix and sequence.",kind:"info"}),children:[e.jsx(jw,{className:"h-4 w-4"})," Numbering"]})]})]}),e.jsxs(so,{title:"Premium billing simulation",subtitle:"How next month could look per entity and invoice group.",right:e.jsx(ht,{className:"h-5 w-5 text-emerald-700"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"1) Uses VAT settings per entity"}),e.jsx("li",{children:"2) Uses frequency to estimate cycles per month"}),e.jsx("li",{children:"3) Uses payment terms to compute due date"}),e.jsx("li",{children:"4) Uses template and invoice group prefix for number preview"})]})}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Cs,{variant:"primary",onClick:()=>n("simulation"),children:[e.jsx(Dn,{className:"h-4 w-4"})," Open simulation"]}),e.jsxs(Cs,{variant:"outline",onClick:()=>n("templates"),children:[e.jsx(s4,{className:"h-4 w-4"})," Edit templates"]})]})]})]})]}),e.jsx("div",{className:"mt-4 text-xs text-slate-500",children:"N Billing Setup and Invoice Groups v2: invoice frequency, invoice groups, entity tax and VAT, payment terms, branded templates, multi-entity invoice streams, and next month billing simulations."})]})]})}),e.jsx(Nh,{open:te,title:G.id?"Edit entity":"New entity",subtitle:"Tax and VAT settings are configured per entity or branch.",onClose:()=>oe(!1),actions:[{label:"Save",onClick:Se}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Cs,{variant:"outline",onClick:()=>oe(!1),children:"Cancel"}),e.jsxs(Cs,{variant:"primary",onClick:Se,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Ja,{label:"Entity name",value:G.name,onChange:E=>H(u=>({...u,name:E})),placeholder:"Uganda HQ"}),e.jsx(Ja,{label:"Legal name",value:G.legalName,onChange:E=>H(u=>({...u,legalName:E})),placeholder:"Legal registered name"}),e.jsx(Ja,{label:"Country",value:G.country,onChange:E=>H(u=>({...u,country:E})),placeholder:"Uganda"}),e.jsx(Ja,{label:"City",value:G.city,onChange:E=>H(u=>({...u,city:E})),placeholder:"Kampala"}),e.jsx(Ja,{label:"Address line 1",value:G.address1,onChange:E=>H(u=>({...u,address1:E})),placeholder:"Street, building"}),e.jsx(Ja,{label:"Address line 2",value:G.address2,onChange:E=>H(u=>({...u,address2:E})),placeholder:"Suite, floor"}),e.jsx(Lr,{label:"Currency",value:G.currency,onChange:E=>H(u=>({...u,currency:E})),options:["UGX","USD","EUR","CNY"]}),e.jsx(Ja,{label:"Billing email",value:G.billingEmail,onChange:E=>H(u=>({...u,billingEmail:E})),placeholder:"ap@company.com"}),e.jsx(Ja,{label:"Phone",value:G.phone,onChange:E=>H(u=>({...u,phone:E})),placeholder:"+256..."}),e.jsx(Ja,{label:"Tax ID",value:G.taxId,onChange:E=>H(u=>({...u,taxId:E})),placeholder:"TIN..."}),e.jsx(Ja,{label:"VAT number",value:G.vatNo,onChange:E=>H(u=>({...u,vatNo:E})),placeholder:"VAT..."}),e.jsx(rd,{enabled:G.vatEnabled,onChange:E=>H(u=>({...u,vatEnabled:E})),label:"VAT enabled",description:"If off, VAT line can be hidden"}),e.jsx(to,{label:"VAT rate percent",value:G.vatRatePct,onChange:E=>H(u=>({...u,vatRatePct:eb(E,0,100)})),disabled:!G.vatEnabled}),e.jsx(rd,{enabled:G.vatInclusive,onChange:E=>H(u=>({...u,vatInclusive:E})),label:"VAT inclusive",description:"If on, VAT is included in amounts"}),e.jsx(rd,{enabled:G.isPrimary,onChange:E=>H(u=>({...u,isPrimary:E})),label:"Primary entity",description:"Used for defaults"})]})}),e.jsx(Nh,{open:Y,title:q.id?"Edit template":"New template",subtitle:"Premium: branded invoice templates per invoice group.",onClose:()=>we(!1),actions:[{label:"Save",onClick:ze}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Cs,{variant:"outline",onClick:()=>we(!1),children:"Cancel"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(Cs,{variant:"primary",onClick:ze,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Ja,{label:"Template name",value:q.name,onChange:E=>je(u=>({...u,name:E})),placeholder:"Default modern"}),e.jsx(Ja,{label:"Brand name",value:q.brandName,onChange:E=>je(u=>({...u,brandName:E})),placeholder:"EVzone CorporatePay"}),e.jsx(Lr,{label:"Layout",value:q.layout,onChange:E=>je(u=>({...u,layout:E})),options:["Modern","Classic"]}),e.jsx(Lr,{label:"Accent color",value:q.accent,onChange:E=>je(u=>({...u,accent:E})),options:[br.green,br.orange,"#2563EB","#0F172A","#7C3AED"],hint:"Pick a preset"}),e.jsx(rd,{enabled:q.showLogo,onChange:E=>je(u=>({...u,showLogo:E})),label:"Show logo"}),e.jsx(rd,{enabled:q.showVatLine,onChange:E=>je(u=>({...u,showVatLine:E})),label:"Show VAT line"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(gc,{label:"Header note",value:q.headerNote,onChange:E=>je(u=>({...u,headerNote:E})),placeholder:"Optional note",rows:3})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(gc,{label:"Payment instructions",value:q.paymentInstructions,onChange:E=>je(u=>({...u,paymentInstructions:E})),placeholder:"How to pay",rows:3})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(gc,{label:"Footer text",value:q.footerText,onChange:E=>je(u=>({...u,footerText:E})),placeholder:"Footer",rows:3})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: set different templates for different AP recipients using invoice groups."})]})}),e.jsx(Nh,{open:_e,title:be.id?"Edit invoice group":"New invoice group",subtitle:"Frequency, AP recipients, cost codes, templates, and per-group terms.",onClose:()=>Ee(!1),actions:[...be.id?[{label:"Delete",onClick:()=>{Ye(be.id),Ee(!1)},variant:"danger"}]:[],{label:"Save",onClick:Ve}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Cs,{variant:"outline",onClick:()=>Ee(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[be.id?e.jsxs(Cs,{variant:"danger",onClick:()=>{Ye(be.id),Ee(!1)},children:[e.jsx(as,{className:"h-4 w-4"})," Delete"]}):null,e.jsxs(Cs,{variant:"primary",onClick:Ve,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Ja,{label:"Group name",value:be.name,onChange:E=>Fe(u=>({...u,name:E})),placeholder:"Main corporate"}),e.jsx(Lr,{label:"Entity stream",value:be.entityId,onChange:E=>Fe(u=>({...u,entityId:E})),options:V,hint:"Separate streams per entity"}),e.jsx(Lr,{label:"Frequency",value:be.frequency,onChange:E=>Fe(u=>({...u,frequency:E})),options:["Daily","Weekly","Monthly","Custom"]}),e.jsx(Ja,{label:"Custom rule",value:be.customRule,onChange:E=>Fe(u=>({...u,customRule:E})),placeholder:"Example: Every 15 days",disabled:be.frequency!=="Custom",hint:be.frequency!=="Custom"?"Not used":"Describe schedule"}),e.jsx(Ja,{label:"AP to",value:be.apTo,onChange:E=>Fe(u=>({...u,apTo:E})),placeholder:"ap@company.com"}),e.jsx(Ja,{label:"AP cc",value:be.apCc,onChange:E=>Fe(u=>({...u,apCc:E})),placeholder:"finance@company.com",hint:"Optional"}),e.jsx(Ja,{label:"Cost code",value:be.costCode,onChange:E=>Fe(u=>({...u,costCode:E})),placeholder:"ACME-MAIN"}),e.jsx(Lr,{label:"Template",value:be.templateId,onChange:E=>Fe(u=>({...u,templateId:E})),options:x.map(E=>E.id),hint:"Branded per group"}),e.jsx(Ja,{label:"Invoice prefix",value:be.prefix,onChange:E=>Fe(u=>({...u,prefix:E})),placeholder:"ACME"}),e.jsx(to,{label:"Next sequence",value:be.nextSequence,onChange:E=>Fe(u=>({...u,nextSequence:Math.max(1,E)})),hint:"Controls numbering"}),e.jsx(Lr,{label:"Status",value:be.status,onChange:E=>Fe(u=>({...u,status:E})),options:["Active","Paused"]}),e.jsx(rd,{enabled:be.paymentTermsOverrideEnabled,onChange:E=>Fe(u=>({...u,paymentTermsOverrideEnabled:E,paymentTermsOverride:E?u.paymentTermsOverride||{...r}:void 0})),label:"Override payment terms",description:"Different terms for this AP desk"}),e.jsx("div",{className:Sl("md:col-span-2",!be.paymentTermsOverrideEnabled&&"opacity-60"),children:e.jsxs(Cs,{variant:"outline",className:"w-full",disabled:!be.paymentTermsOverrideEnabled,onClick:B,children:[e.jsx(Dn,{className:"h-4 w-4"})," Edit override terms"]})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(gc,{label:"Notes",value:be.notes,onChange:E=>Fe(u=>({...u,notes:E})),placeholder:"Optional notes",rows:3})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: invoice groups allow different templates and AP recipients per entity, enabling separate invoice streams."})]})}),e.jsx(Nh,{open:Q,title:"Payment terms override",subtitle:"This override is applied to the invoice group draft.",onClose:()=>Re(!1),actions:[{label:"Apply",onClick:ue}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Cs,{variant:"outline",onClick:()=>Re(!1),children:"Cancel"}),e.jsxs(Cs,{variant:"primary",onClick:ue,children:[e.jsx(ct,{className:"h-4 w-4"})," Apply"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Lr,{label:"Mode",value:ce.mode,onChange:E=>xe(u=>({...u,mode:E})),options:["Net","DueOnReceipt","EOM"]}),e.jsx(to,{label:"Net days",value:ce.netDays,onChange:E=>xe(u=>({...u,netDays:Math.max(0,E)})),disabled:ce.mode!=="Net"}),e.jsx(to,{label:"Early discount percent",value:ce.earlyDiscountPct,onChange:E=>xe(u=>({...u,earlyDiscountPct:eb(E,0,100)}))}),e.jsx(to,{label:"Early discount days",value:ce.earlyDiscountDays,onChange:E=>xe(u=>({...u,earlyDiscountDays:Math.max(0,E)})),disabled:ce.earlyDiscountPct<=0}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(gc,{label:"Late fee text",value:ce.lateFeeText,onChange:E=>xe(u=>({...u,lateFeeText:E})),rows:3})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"This is a premium feature used when an invoice group requires special terms."})]})}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"N Billing Setup and Invoice Groups v2. Core: invoice frequency, invoice groups, tax and VAT per entity, and payment terms. Premium: multi-entity invoice streams, branded templates per group, and next month billing simulation."})})]})}const xg={green:"#03CD8C",orange:"#F77F00"};function oi(...t){return t.filter(Boolean).join(" ")}function id(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function p_(t){return Math.round(t).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function Bt(t,s){const a=Math.round(Number(t||0));try{return new Intl.NumberFormat(void 0,{style:"currency",currency:s,maximumFractionDigits:0}).format(a)}catch{return`${s} ${p_(a)}`}}function yn(t){return new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"2-digit"})}function od(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function ao(t){return t==="Paid"||t==="Approved"||t==="Resolved"?"good":t==="Overdue"||t==="Rejected"?"bad":t==="Draft"||t==="Pending"||t==="In review"?"warn":"neutral"}function H4(t,s){if(s==="Overdue")return"bad";if(s==="Sent"){const a=(t-Date.now())/6e4;return a<=0?"bad":a<=60*48?"warn":"info"}return"neutral"}function It({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:oi("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Qt({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:xg.green}:t==="accent"?{background:xg.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:oi(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function dd({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text"}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:i=>a(i.target.value),placeholder:l,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"})]})}function Fr({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:oi(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:oi("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function gm({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:i=>a(i.target.value),placeholder:l,rows:r,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"})]})}function Ba({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function Cw({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null),[n,r]=d.useState({top:0,left:0,up:!1});return d.useEffect(()=>{if(s&&l.current){const i=l.current.getBoundingClientRect(),o=t.length*40+20,x=window.innerHeight-i.bottom<o&&i.top>o;r({top:x?i.top-8:i.bottom+8,left:i.right,up:x});const j=()=>a(!1);return window.addEventListener("scroll",j,{capture:!0}),window.addEventListener("resize",j),()=>{window.removeEventListener("scroll",j,{capture:!0}),window.removeEventListener("resize",j)}}},[s,t.length]),t.length?e.jsxs(e.Fragment,{children:[e.jsx("button",{ref:l,onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&Lg.createPortal(e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-[9998]",onClick:()=>a(!1)}),e.jsx("div",{className:"fixed z-[9999] w-48 overflow-hidden rounded-xl border border-slate-200 bg-white shadow-xl ring-1 ring-slate-200",style:{top:n.up?"auto":n.top,bottom:n.up?window.innerHeight-n.top:"auto",left:n.left-192},children:t.map((i,o)=>e.jsxs("button",{onClick:()=>{i.onClick(),a(!1)},disabled:i.disabled,className:oi("flex w-full items-center gap-2 px-4 py-2.5 text-left text-sm font-medium transition hover:bg-slate-50 disabled:opacity-50",i.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700"),children:[i.icon&&e.jsx("span",{className:"mr-2 h-4 w-4",children:i.icon}),i.label]},o))})]}),document.body)]}):null}function fc({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="960px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:12,scale:.985},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:12,scale:.985},transition:{duration:.18},className:"fixed inset-x-0 top-[7vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(Cw,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[72vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function h_({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,actions:i}){return d.useEffect(()=>{const o=c=>c.key==="Escape"&&n();return t&&window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,x:18},animate:{opacity:1,x:0},exit:{opacity:0,x:18},transition:{duration:.18},className:oi("fixed z-50 overflow-hidden border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]","left-2 right-2 bottom-2 top-[10vh] rounded-[28px]","lg:left-auto lg:right-4 lg:top-4 lg:bottom-4 lg:w-[640px]"),role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-base font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i&&e.jsx(Cw,{actions:i}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"h-full min-h-0 overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function g_({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:oi("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function wh(t,s,a="text/plain"){const l=new Blob([s],{type:a}),n=URL.createObjectURL(l),r=document.createElement("a");r.href=n,r.download=t,r.click(),URL.revokeObjectURL(n)}function kh(t,s){const a=r=>{const i=String(r??"");return/[",\n]/.test(i)?`"${i.replace(/"/g,'""')}"`:i},l=s.map(r=>a(r.label)).join(","),n=t.map(r=>s.map(i=>a(r[i.key])).join(",")).join(`
`);return`${l}
${n}`}function fm(t,s,a){const l={};for(const r of t){const i=s(r);l[i]=(l[i]||0)+a(r)}return Object.keys(l).map(r=>({key:r,value:l[r]})).sort((r,i)=>i.value-r.value)}function f_(t,s,a,l){const n=(g,y)=>y==="Service module"?g.serviceModule||"-":y==="Marketplace"?g.marketplace||"-":y==="Vendor"?g.vendor||"-":y==="Group"?g.group||"-":y==="Cost center"?g.costCenter||"-":y==="Project tag"?g.projectTag||"-":y==="Invoice status"?g.invoiceStatus:y==="Invoice group"?g.invoiceGroupId:y==="Entity"?g.entityId:"-",r=Array.from(new Set(t.map(g=>n(g,s)))).sort(),i=a==="None"?["All"]:Array.from(new Set(t.map(g=>n(g,a)))).sort(),o={},c={},x={};let j=0;for(const g of t){const y=n(g,s),$=a==="None"?"All":n(g,a),T=l==="Count"?1:g.amount;o[y]=o[y]||{},o[y][$]=(o[y][$]||0)+T,c[y]=(c[y]||0)+T,x[$]=(x[$]||0)+T,j+=T}return{rowKeys:r,colKeys:i,matrix:o,rowTotals:c,colTotals:x,grand:j}}function v_(){var Sw,Aw,Ew;const[t]=d.useState(()=>[{id:"ENT-UG",name:"Uganda HQ",legalName:"Acme Group Limited (Uganda)",country:"Uganda",city:"Kampala",address:"Plot 12, Nkrumah Road, Suite 5",currency:"UGX",taxId:"TIN-123-456-789",vatNo:"VAT-UG-00991",vatEnabled:!0,vatRatePct:18,billingEmail:"ap-ug@acme.com"},{id:"ENT-CN",name:"China Branch",legalName:"Acme Group Co., Ltd. (China)",country:"China",city:"Wuxi",address:"Room 265, No. 3 Gaolang East Road, Xinwu District",currency:"CNY",taxId:"CN-TAX-0001",vatNo:"CN-VAT-0001",vatEnabled:!0,vatRatePct:13,billingEmail:"ap-cn@acme.com"}]),[s]=d.useState(()=>[{id:"IG-MAIN-UG",name:"Main corporate",entityId:"ENT-UG",apTo:"ap@acme.com",apCc:"finance@acme.com",costCode:"ACME-MAIN",templateName:"Default modern",prefix:"ACME"},{id:"IG-SALES-TRAVEL",name:"Sales travel",entityId:"ENT-UG",apTo:"sales-ap@acme.com",apCc:"finance@acme.com",costCode:"ACME-SALES",templateName:"Finance classic",prefix:"ACME-SALES"},{id:"IG-CN-PROC",name:"China procurement",entityId:"ENT-CN",apTo:"ap-cn@acme.com",apCc:"finance@acme.com",costCode:"CN-PROC",templateName:"Default modern",prefix:"ACME-CN"}]),a=d.useMemo(()=>Object.fromEntries(t.map(J=>[J.id,J])),[t]),l=d.useMemo(()=>Object.fromEntries(s.map(J=>[J.id,J])),[s]),[n,r]=d.useState([]),i=J=>{const Ie=id("toast");r(Je=>[{id:Ie,...J},...Je].slice(0,4)),window.setTimeout(()=>r(Je=>Je.filter(it=>it.id!==Ie)),3200)},o=Date.now(),c=24*60*60*1e3,[x,j]=d.useState(()=>[{id:"INV-0001",invoiceNo:"ACME-202601-1042",entityId:"ENT-UG",invoiceGroupId:"IG-MAIN-UG",issueDate:o-7*c,dueDate:o+1*c,status:"Sent",currency:"UGX",subtotal:14e6,vat:252e4,total:1652e4,paidAmount:0,balance:1652e4,createdAt:o-8*c,sentAt:o-7*c,notes:"Weekly corporate spend"},{id:"INV-0002",invoiceNo:"ACME-SALES-202512-0088",entityId:"ENT-UG",invoiceGroupId:"IG-SALES-TRAVEL",issueDate:o-38*c,dueDate:o-24*c,status:"Overdue",currency:"UGX",subtotal:52e5,vat:936e3,total:6136e3,paidAmount:0,balance:6136e3,createdAt:o-39*c,sentAt:o-38*c,notes:"Monthly travel rides"},{id:"INV-0003",invoiceNo:"ACME-202512-1038",entityId:"ENT-UG",invoiceGroupId:"IG-MAIN-UG",issueDate:o-22*c,dueDate:o-15*c,status:"Paid",currency:"UGX",subtotal:122e5,vat:2196e3,total:14396e3,paidAmount:14396e3,balance:0,createdAt:o-23*c,sentAt:o-22*c,paidAt:o-16*c,notes:"Weekly corporate spend"},{id:"INV-0004",invoiceNo:"ACME-CN-202512-0221",entityId:"ENT-CN",invoiceGroupId:"IG-CN-PROC",issueDate:o-14*c,dueDate:o-7*c,status:"Paid",currency:"CNY",subtotal:68e3,vat:8840,total:76840,paidAmount:76840,balance:0,createdAt:o-15*c,sentAt:o-14*c,paidAt:o-7*c,notes:"Procurement stream"},{id:"INV-0005",invoiceNo:"ACME-202601-1043",entityId:"ENT-UG",invoiceGroupId:"IG-MAIN-UG",issueDate:o-1*c,dueDate:o+6*c,status:"Draft",currency:"UGX",subtotal:91e5,vat:1638e3,total:10748e3,paidAmount:0,balance:10748e3,createdAt:o-1*c,notes:"Draft awaiting review"}]),[g,y]=d.useState(()=>[{id:"LI-1001",invoiceId:"INV-0001",description:"Corporate rides",serviceModule:"Rides & Logistics",marketplace:"",vendor:"EVzone Rides",group:"Operations",costCenter:"OPS-001",projectTag:"Office commute",amount:82e5},{id:"LI-1002",invoiceId:"INV-0001",description:"EV charging credits",serviceModule:"EVs & Charging",marketplace:"",vendor:"EVzone Charging",group:"Operations",costCenter:"OPS-001",projectTag:"Fleet charging",amount:41e5},{id:"LI-1003",invoiceId:"INV-0001",description:"EVmart purchases",serviceModule:"E-Commerce",marketplace:"EVmart",vendor:"Kampala Office Mart",group:"Procurement",costCenter:"PROC-001",projectTag:"Office supplies",amount:24e5},{id:"LI-1004",invoiceId:"INV-0001",description:"MyLiveDealz deals",serviceModule:"E-Commerce",marketplace:"MyLiveDealz",vendor:"Shenzhen Store",group:"Procurement",costCenter:"PROC-001",projectTag:"High value",amount:31e5},{id:"LI-2001",invoiceId:"INV-0002",description:"Sales travel rides",serviceModule:"Rides & Logistics",marketplace:"",vendor:"EVzone Rides",group:"Sales",costCenter:"SALES-TRAVEL",projectTag:"Client meetings",amount:52e5},{id:"LI-3001",invoiceId:"INV-0003",description:"Corporate rides",serviceModule:"Rides & Logistics",marketplace:"",vendor:"EVzone Rides",group:"Operations",costCenter:"OPS-001",projectTag:"Office commute",amount:71e5},{id:"LI-3002",invoiceId:"INV-0003",description:"ServiceMart services",serviceModule:"E-Commerce",marketplace:"ServiceMart",vendor:"ServicePro",group:"Admin",costCenter:"ADMIN-CORE",projectTag:"Facilities",amount:23e5},{id:"LI-3003",invoiceId:"INV-0003",description:"Charging credits",serviceModule:"EVs & Charging",marketplace:"",vendor:"EVzone Charging",group:"Operations",costCenter:"OPS-001",projectTag:"Fleet charging",amount:28e5},{id:"LI-4001",invoiceId:"INV-0004",description:"GadgetMart procurement",serviceModule:"E-Commerce",marketplace:"GadgetMart",vendor:"Shenzhen Tech",group:"Procurement",costCenter:"PROC-001",projectTag:"Devices",amount:6e4},{id:"LI-4002",invoiceId:"INV-0004",description:"ExpressMart logistics",serviceModule:"E-Commerce",marketplace:"ExpressMart",vendor:"Express CN",group:"Procurement",costCenter:"PROC-001",projectTag:"Shipping",amount:8e3},{id:"LI-5001",invoiceId:"INV-0005",description:"Corporate rides",serviceModule:"Rides & Logistics",marketplace:"",vendor:"EVzone Rides",group:"Operations",costCenter:"OPS-001",projectTag:"Office commute",amount:48e5},{id:"LI-5002",invoiceId:"INV-0005",description:"MyLiveDealz deals",serviceModule:"E-Commerce",marketplace:"MyLiveDealz",vendor:"Shenzhen Store",group:"Procurement",costCenter:"PROC-001",projectTag:"High value",amount:23e5},{id:"LI-5003",invoiceId:"INV-0005",description:"Facilities services",serviceModule:"E-Commerce",marketplace:"ServiceMart",vendor:"ServicePro",group:"Admin",costCenter:"ADMIN-CORE",projectTag:"Facilities",amount:2e6}]),[$,T]=d.useState(()=>{const J=(Je,it,Ct,ls,bs,St)=>({id:id("EVT"),lineItemId:Je,ts:o-Math.round(Math.random()*10)*c,kind:it,reference:Ct,serviceModule:(St==null?void 0:St.serviceModule)||"Rides & Logistics",marketplace:St==null?void 0:St.marketplace,vendor:(St==null?void 0:St.vendor)||"EVzone",group:(St==null?void 0:St.group)||"Operations",costCenter:(St==null?void 0:St.costCenter)||"OPS-001",projectTag:(St==null?void 0:St.projectTag)||"General",amount:ls,details:bs,...St}),Ie=[];return Ie.push(J("LI-1001","Trip","TRP-84001",165e3,"Airport pickup",{vendor:"EVzone Rides",group:"Operations",costCenter:"OPS-001",projectTag:"Office commute"})),Ie.push(J("LI-1001","Trip","TRP-84002",98e3,"City commute",{vendor:"EVzone Rides",group:"Operations",costCenter:"OPS-001",projectTag:"Office commute"})),Ie.push(J("LI-1001","Trip","TRP-84003",12e4,"Client meeting",{vendor:"EVzone Rides",group:"Operations",costCenter:"OPS-001",projectTag:"Office commute"})),Ie.push(J("LI-1004","Order","ORD-MLD-4401",9e5,"Deal order",{serviceModule:"E-Commerce",marketplace:"MyLiveDealz",vendor:"Shenzhen Store",group:"Procurement",costCenter:"PROC-001",projectTag:"High value"})),Ie.push(J("LI-1004","Order","ORD-MLD-4402",11e5,"Deal order",{serviceModule:"E-Commerce",marketplace:"MyLiveDealz",vendor:"Shenzhen Store",group:"Procurement",costCenter:"PROC-001",projectTag:"High value"})),Ie.push(J("LI-2001","Trip","TRP-99001",85e3,"Client site",{vendor:"EVzone Rides",group:"Sales",costCenter:"SALES-TRAVEL",projectTag:"Client meetings"})),Ie.push(J("LI-2001","Trip","TRP-99002",132e3,"Airport drop",{vendor:"EVzone Rides",group:"Sales",costCenter:"SALES-TRAVEL",projectTag:"Client meetings"})),Ie.push(J("LI-4001","Order","ORD-GAD-1001",24e3,"Device purchase",{serviceModule:"E-Commerce",marketplace:"GadgetMart",vendor:"Shenzhen Tech",group:"Procurement",costCenter:"PROC-001",projectTag:"Devices"})),Ie.push(J("LI-4001","Order","ORD-GAD-1002",36e3,"Device purchase",{serviceModule:"E-Commerce",marketplace:"GadgetMart",vendor:"Shenzhen Tech",group:"Procurement",costCenter:"PROC-001",projectTag:"Devices"})),Ie}),[C,W]=d.useState(()=>[{id:"CN-001",invoiceId:"INV-0001",createdAt:o-2*c,createdBy:"Finance Desk",amount:2e5,reason:"Service cancellation credit",status:"Pending"},{id:"CN-002",invoiceId:"INV-0002",createdAt:o-12*c,createdBy:"Finance Desk",amount:15e4,reason:"Duplicate trip adjustment",status:"Approved",approvalReason:"Approved for accuracy",decidedBy:"Org Admin",decidedAt:o-11*c}]),[L,R]=d.useState(()=>[{id:"DSP-010",invoiceId:"INV-0001",createdAt:o-18*60*60*1e3,createdBy:"Procurement Desk",status:"In review",category:"Wrong amount",description:"MyLiveDealz line seems higher than expected. Please reconcile raw events.",messages:[{at:o-18*60*60*1e3,by:"Procurement Desk",message:"Please verify ORD-MLD counts."},{at:o-16*60*60*1e3,by:"Finance Desk",message:"Reviewing events and vendor confirmations."}],evidence:[{id:"EV-01",name:"Vendor quote.pdf",note:"Initial quote",uploadedBy:"Procurement Desk",uploadedAt:o-18*60*60*1e3}]}]),[F,te]=d.useState("invoices"),[oe,G]=d.useState(""),[H,Y]=d.useState("All"),[we,q]=d.useState("All"),[je,_e]=d.useState("All"),[Ee,be]=d.useState(!1),[Fe,Pe]=d.useState(null),[pe,Q]=d.useState(!1),[Re,ce]=d.useState(null),[xe,he]=d.useState(!1),[de,ye]=d.useState({invoiceId:"INV-0001",amount:1e5,reason:"",attachmentNote:""}),[Ke,Le]=d.useState(!1),[Ne,ge]=d.useState(null),[$e,ie]=d.useState(""),[Oe,Se]=d.useState(!1),[Te,Ge]=d.useState(!1),[We,ze]=d.useState({invoiceId:"INV-0001",category:"Wrong amount",description:"",evidenceName:"",evidenceNote:""}),[Ue,le]=d.useState(!1),[z,Ae]=d.useState(null),[Ve,Ye]=d.useState(""),[Be,w]=d.useState(""),[B,ue]=d.useState(""),[ne,Me]=d.useState("Service module"),[De,fe]=d.useState("Invoice status"),[me,Xe]=d.useState("Amount"),[V,E]=d.useState(!1),[u,P]=d.useState(null),se=J=>x.find(Ie=>Ie.id===J)||null,D=d.useMemo(()=>x.map(J=>J.balance>0&&J.status!=="Draft"&&Date.now()>J.dueDate&&J.status!=="Overdue"?{...J,status:"Overdue"}:J),[x]),re=d.useMemo(()=>{const J=oe.trim().toLowerCase();return D.filter(Ie=>H==="All"?!0:Ie.status===H).filter(Ie=>we==="All"?!0:Ie.entityId===we).filter(Ie=>je==="All"?!0:Ie.invoiceGroupId===je).filter(Ie=>{if(!J)return!0;const Je=a[Ie.entityId],it=l[Ie.invoiceGroupId];return`${Ie.invoiceNo} ${Ie.id} ${Ie.status} ${(Je==null?void 0:Je.name)||""} ${(it==null?void 0:it.name)||""} ${(it==null?void 0:it.costCode)||""}`.toLowerCase().includes(J)}).sort((Ie,Je)=>Je.issueDate-Ie.issueDate)},[D,oe,H,we,je,a,l]),v=d.useMemo(()=>{const J={};for(const Ie of L)Ie.status==="Resolved"||Ie.status==="Rejected"||(J[Ie.invoiceId]=(J[Ie.invoiceId]||0)+1);return J},[L]),k=d.useMemo(()=>{const J=re.reduce((bs,St)=>bs+St.total,0),Ie=re.reduce((bs,St)=>bs+St.balance,0),Je=re.filter(bs=>bs.status==="Overdue").length,it=re.filter(bs=>bs.status==="Paid").length,Ct=re.filter(bs=>bs.status==="Sent").length,ls=re.filter(bs=>bs.status==="Draft").length;return{total:J,balance:Ie,overdue:Je,paid:it,sent:Ct,draft:ls}},[re]),m=d.useMemo(()=>Fe?se(Fe):null,[Fe,D]),S=d.useMemo(()=>m?g.filter(J=>J.invoiceId===m.id).slice().sort((J,Ie)=>Ie.amount-J.amount):[],[m,g]),f=d.useMemo(()=>m?C.filter(J=>J.invoiceId===m.id).slice().sort((J,Ie)=>Ie.createdAt-J.createdAt):[],[m,C]),U=d.useMemo(()=>m?L.filter(J=>J.invoiceId===m.id).slice().sort((J,Ie)=>Ie.createdAt-J.createdAt):[],[m,L]),p=[{value:"serviceModule",label:"Service module"},{value:"marketplace",label:"Marketplace"},{value:"vendor",label:"Vendor"},{value:"group",label:"Group"},{value:"costCenter",label:"Cost center"},{value:"projectTag",label:"Project tag"}],[M,ee]=d.useState("serviceModule"),b=d.useMemo(()=>fm(S,Ie=>{const Je=Ie[M];return Je&&String(Je).trim()||"-"},Ie=>Ie.amount),[S,M]),ae=d.useMemo(()=>Re&&g.find(J=>J.id===Re)||null,[Re,g]),ve=d.useMemo(()=>Re?$.filter(J=>J.lineItemId===Re).slice().sort((J,Ie)=>Ie.ts-J.ts):[],[$,Re]),O=d.useMemo(()=>{if(!ae||!ve.length)return null;const J=ve.reduce((it,Ct)=>it+Ct.amount,0),Ie=fm(ve,it=>it.kind,it=>it.amount),Je=fm(ve,it=>it.vendor,it=>it.amount);return{total:J,byKind:Ie,byVendor:Je}},[ae,ve]),X=d.useMemo(()=>{const J=Object.fromEntries(D.map(Ie=>[Ie.id,Ie]));return g.map(Ie=>{const Je=J[Ie.invoiceId];return Je?{...Ie,marketplace:Ie.marketplace||"-",invoiceNo:Je.invoiceNo,invoiceStatus:Je.status,entityId:Je.entityId,invoiceGroupId:Je.invoiceGroupId,issueDate:Je.issueDate,dueDate:Je.dueDate,currency:Je.currency}:null}).filter(Boolean)},[g,D]),A=d.useMemo(()=>{const J=new Set(re.map(Ie=>Ie.id));return X.filter(Ie=>J.has(Ie.invoiceId))},[X,re]),N=d.useMemo(()=>f_(A,ne,De,me),[A,ne,De,me]),h=[{value:"Service module",label:"Service module"},{value:"Marketplace",label:"Marketplace"},{value:"Vendor",label:"Vendor"},{value:"Group",label:"Group"},{value:"Cost center",label:"Cost center"},{value:"Project tag",label:"Project tag"},{value:"Invoice status",label:"Invoice status"},{value:"Invoice group",label:"Invoice group"},{value:"Entity",label:"Entity"}],[K,_]=d.useState(()=>{const J=new Date;return`${J.getFullYear()}-${String(J.getMonth()+1).padStart(2,"0")}`}),ke=d.useMemo(()=>{const[J,Ie]=K.split("-").map(St=>Number(St)),Je=new Date(J,(Ie||1)-1,1).getTime(),it=new Date(J,Ie||1,0,23,59,59,999).getTime(),Ct=D.filter(St=>St.issueDate>=Je&&St.issueDate<=it),ls=Object.fromEntries(t.map(St=>[St.id,{entity:St,invoices:[]}]));Ct.forEach(St=>{var Gi;return(Gi=ls[St.entityId])==null?void 0:Gi.invoices.push(St)});const bs=[];return Object.keys(ls).forEach(St=>{const Gi=ls[St].entity,Vu=ls[St].invoices,aM=Vu.reduce((_u,Bu)=>_u+Bu.total,0),lM=Vu.reduce((_u,Bu)=>_u+Bu.paidAmount,0),nM=Vu.reduce((_u,Bu)=>_u+Bu.balance,0);Vu.length&&bs.push({entityId:St,entityName:Gi.name,invoiceCount:Vu.length,issued:aM,paid:lM,balance:nM})}),bs.sort((St,Gi)=>Gi.issued-St.issued),bs},[K,D,t]),I=d.useMemo(()=>C.slice().sort((J,Ie)=>Ie.createdAt-J.createdAt),[C]),Z=d.useMemo(()=>L.slice().sort((J,Ie)=>J.status!==Ie.status?J.status==="Open"||J.status==="In review"?-1:1:Ie.createdAt-J.createdAt),[L]),Ce=J=>{Pe(J),be(!0)},He=()=>{const J=re.map(Je=>{var it,Ct;return{invoiceNo:Je.invoiceNo,entity:((it=a[Je.entityId])==null?void 0:it.name)||Je.entityId,invoiceGroup:((Ct=l[Je.invoiceGroupId])==null?void 0:Ct.name)||Je.invoiceGroupId,issueDate:yn(Je.issueDate),dueDate:yn(Je.dueDate),status:Je.status,total:Bt(Je.total,Je.currency),paid:Bt(Je.paidAmount,Je.currency),balance:Bt(Je.balance,Je.currency)}}),Ie=kh(J,[{key:"invoiceNo",label:"Invoice No"},{key:"entity",label:"Entity"},{key:"invoiceGroup",label:"Invoice Group"},{key:"issueDate",label:"Issue Date"},{key:"dueDate",label:"Due Date"},{key:"status",label:"Status"},{key:"total",label:"Total"},{key:"paid",label:"Paid"},{key:"balance",label:"Balance"}]);wh("invoices.csv",Ie,"text/csv"),i({title:"Exported",message:"Invoice list CSV downloaded.",kind:"success"})},mt=J=>{const Ie=se(J);if(!Ie)return;const it=g.filter(ls=>ls.invoiceId===J).map(ls=>({invoiceNo:Ie.invoiceNo,description:ls.description,serviceModule:ls.serviceModule,marketplace:ls.marketplace||"-",vendor:ls.vendor,group:ls.group,costCenter:ls.costCenter,projectTag:ls.projectTag,amount:Bt(ls.amount,Ie.currency)})),Ct=kh(it,[{key:"invoiceNo",label:"Invoice No"},{key:"description",label:"Description"},{key:"serviceModule",label:"Service Module"},{key:"marketplace",label:"Marketplace"},{key:"vendor",label:"Vendor"},{key:"group",label:"Group"},{key:"costCenter",label:"Cost Center"},{key:"projectTag",label:"Project Tag"},{key:"amount",label:"Amount"}]);wh(`invoice-${Ie.invoiceNo}-lines.csv`,Ct,"text/csv"),i({title:"Exported",message:"Invoice line items CSV downloaded.",kind:"success"})},ot=J=>{const Ie=se(J);if(!Ie)return;const Je=a[Ie.entityId],it=l[Ie.invoiceGroupId],Ct=g.filter(St=>St.invoiceId===J),ls=`
      <html>
        <head>
          <title>${Ie.invoiceNo}</title>
          <style>
            body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial; padding: 24px; }
            .row { display:flex; justify-content:space-between; gap:12px; }
            .muted { color:#64748b; font-size:12px; }
            .title { font-size:18px; font-weight:700; }
            table { width:100%; border-collapse:collapse; margin-top:16px; }
            th, td { border: 1px solid #e2e8f0; padding: 10px; font-size:12px; }
            th { background:#f8fafc; text-align:left; }
            .totals { margin-top: 16px; width: 320px; margin-left:auto; }
            .totals .row { padding: 6px 0; }
          </style>
        </head>
        <body>
          <div class="row">
            <div>
              <div class="title">Invoice</div>
              <div class="muted">${Ie.invoiceNo}</div>
              <div class="muted">Entity: ${(Je==null?void 0:Je.legalName)||(Je==null?void 0:Je.name)||Ie.entityId}</div>
              <div class="muted">Invoice group: ${(it==null?void 0:it.name)||Ie.invoiceGroupId}  Cost code: ${(it==null?void 0:it.costCode)||"-"}</div>
            </div>
            <div style="text-align:right">
              <div class="muted">Issue: ${yn(Ie.issueDate)}</div>
              <div class="muted">Due: ${yn(Ie.dueDate)}</div>
              <div class="muted">Status: ${Ie.status}</div>
            </div>
          </div>

          <table>
            <thead>
              <tr>
                <th>Description</th>
                <th>Module</th>
                <th>Marketplace</th>
                <th>Vendor</th>
                <th>Group</th>
                <th>Cost center</th>
                <th>Project tag</th>
                <th>Amount</th>
              </tr>
            </thead>
            <tbody>
              ${Ct.map(St=>`
                <tr>
                  <td>${St.description}</td>
                  <td>${St.serviceModule}</td>
                  <td>${St.marketplace||"-"}</td>
                  <td>${St.vendor}</td>
                  <td>${St.group}</td>
                  <td>${St.costCenter}</td>
                  <td>${St.projectTag}</td>
                  <td style="text-align:right">${Bt(St.amount,Ie.currency)}</td>
                </tr>`).join("")}
            </tbody>
          </table>

          <div class="totals">
            <div class="row"><div>Subtotal</div><div><b>${Bt(Ie.subtotal,Ie.currency)}</b></div></div>
            <div class="row"><div>VAT</div><div><b>${Bt(Ie.vat,Ie.currency)}</b></div></div>
            <div class="row"><div>Total</div><div><b>${Bt(Ie.total,Ie.currency)}</b></div></div>
            <div class="row"><div>Paid</div><div><b>${Bt(Ie.paidAmount,Ie.currency)}</b></div></div>
            <div class="row"><div>Balance</div><div><b>${Bt(Ie.balance,Ie.currency)}</b></div></div>
          </div>

          <div class="muted" style="margin-top:20px">Generated by EVzone CorporatePay</div>
        </body>
      </html>
    `,bs=window.open("","_blank");if(!bs){i({title:"Popup blocked",message:"Allow popups to print/export PDF.",kind:"warn"});return}bs.document.open(),bs.document.write(ls),bs.document.close(),bs.focus(),bs.print(),i({title:"Print ready",message:"Use Print to PDF to save.",kind:"info"})},Nt=J=>{ye({invoiceId:J,amount:1e5,reason:"",attachmentNote:""}),he(!0)},nt=()=>{if(!de.invoiceId)return;if(de.amount<=0){i({title:"Invalid",message:"Credit amount must be greater than zero.",kind:"warn"});return}if(de.reason.trim().length<8){i({title:"Reason required",message:"Provide a clear reason (min 8 chars).",kind:"warn"});return}const J=se(de.invoiceId);if(!J)return;const Ie={id:id("CN"),invoiceId:de.invoiceId,createdAt:Date.now(),createdBy:"You",amount:de.amount,reason:de.reason.trim(),status:"Pending"};W(Je=>[Ie,...Je]),he(!1),i({title:"Submitted",message:"Credit note submitted for approval.",kind:"success"}),de.attachmentNote.trim()&&T(Je=>{var it,Ct;return[{id:id("EVT"),lineItemId:((it=g.find(ls=>ls.invoiceId===J.id))==null?void 0:it.id)||"",ts:Date.now(),kind:"Service",reference:`CN-EVID-${Ie.id}`,serviceModule:"Finance & Payments",marketplace:"-",vendor:"CorporatePay",group:"Finance",costCenter:((Ct=l[J.invoiceGroupId])==null?void 0:Ct.costCode)||"-",projectTag:"Credit note",amount:0,details:`Evidence note: ${de.attachmentNote.trim()}`},...Je]})},Vs=J=>{ge(J),ie(""),Se(!1),Le(!0)},Es=J=>{if(!Ne)return;if($e.trim().length<8||!Oe){i({title:"Blocked",message:"Add a reason and confirm acknowledgement.",kind:"warn"});return}const Ie=Ne,Je=Date.now();if(W(it=>it.map(Ct=>Ct.id===Ie?{...Ct,status:J,approvalReason:$e.trim(),decidedBy:"You",decidedAt:Je}:Ct)),J==="Approved"){const it=C.find(Ct=>Ct.id===Ie);it&&j(Ct=>Ct.map(ls=>{if(ls.id!==it.invoiceId)return ls;const bs=Math.max(0,ls.total-it.amount),St=Math.max(0,ls.balance-it.amount),Gi=St<=0?"Paid":ls.status;return{...ls,total:bs,balance:St,status:Gi}})),i({title:"Approved",message:"Credit note approved and applied to invoice.",kind:"success"})}else i({title:"Rejected",message:"Credit note rejected.",kind:"info"});Le(!1),ge(null)},ka=J=>{ze({invoiceId:J,category:"Wrong amount",description:"",evidenceName:"",evidenceNote:""}),Ge(!0)},Ot=()=>{if(We.description.trim().length<12){i({title:"More details needed",message:"Describe the issue (min 12 chars).",kind:"warn"});return}const J=id("DSP"),Ie=Date.now(),Je=We.evidenceName.trim()?[{id:id("EV"),name:We.evidenceName.trim(),note:We.evidenceNote.trim()||"Evidence attached",uploadedBy:"You",uploadedAt:Ie}]:[],it={id:J,invoiceId:We.invoiceId,createdAt:Ie,createdBy:"You",status:"Open",category:We.category,description:We.description.trim(),messages:[{at:Ie,by:"You",message:We.description.trim()}],evidence:Je};R(Ct=>[it,...Ct]),Ge(!1),i({title:"Created",message:"Dispute ticket created.",kind:"success"})},Ca=J=>{Ae(J),le(!0),Ye(""),w(""),ue("")},Ft=d.useMemo(()=>z&&L.find(J=>J.id===z)||null,[z,L]),Uu=()=>{if(!z||!Ve.trim())return;const J=Date.now();R(Ie=>Ie.map(Je=>Je.id===z?{...Je,status:Je.status==="Open"?"In review":Je.status,messages:[...Je.messages,{at:J,by:"You",message:Ve.trim()}]}:Je)),Ye(""),i({title:"Sent",message:"Message added.",kind:"success"})},Yo=()=>{if(!z||!Be.trim()){i({title:"Missing",message:"Evidence name is required.",kind:"warn"});return}const J=Date.now();R(Ie=>Ie.map(Je=>Je.id===z?{...Je,status:Je.status==="Open"?"In review":Je.status,evidence:[...Je.evidence,{id:id("EV"),name:Be.trim(),note:B.trim()||"Evidence attached",uploadedBy:"You",uploadedAt:J}]}:Je)),w(""),ue(""),i({title:"Uploaded",message:"Evidence added.",kind:"success"})},Al=J=>{z&&(R(Ie=>Ie.map(Je=>Je.id===z?{...Je,status:J}:Je)),i({title:"Updated",message:`Ticket set to ${J}.",`,kind:"info"}))},Yd=J=>{ce(J),Q(!0)},Jo=()=>{const J=[];N.rowKeys.forEach(it=>{const Ct={row:it};N.colKeys.forEach(ls=>{var bs;Ct[ls]=((bs=N.matrix[it])==null?void 0:bs[ls])||0}),Ct.Total=N.rowTotals[it]||0,J.push(Ct)});const Ie=[{key:"row",label:ne},...N.colKeys.map(it=>({key:it,label:it})),{key:"Total",label:"Total"}],Je=kh(J,Ie);wh("invoice-explorer-pivot.csv",Je,"text/csv"),i({title:"Exported",message:"Pivot CSV downloaded.",kind:"success"})},Af=d.useMemo(()=>{if(!u)return[];const{rowKey:J,colKey:Ie}=u,Je=(it,Ct)=>Ct==="Service module"?it.serviceModule||"-":Ct==="Marketplace"?it.marketplace||"-":Ct==="Vendor"?it.vendor||"-":Ct==="Group"?it.group||"-":Ct==="Cost center"?it.costCenter||"-":Ct==="Project tag"?it.projectTag||"-":Ct==="Invoice status"?it.invoiceStatus:Ct==="Invoice group"?it.invoiceGroupId:Ct==="Entity"?it.entityId:"-";return A.filter(it=>Je(it,ne)===J).filter(it=>De==="None"?!0:Je(it,De)===Ie)},[u,A,ne,De]);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(g_,{toasts:n,onDismiss:J=>r(Ie=>Ie.filter(Je=>Je.id!==J))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:xg.green},children:e.jsx(kt,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Invoices and Statements"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Invoices, line items, exports, credit notes and disputes. Premium explorer and charge drilldowns."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(It,{label:`Total: ${Bt(k.total,"UGX")}`,tone:"neutral"}),e.jsx(It,{label:`Balance: ${Bt(k.balance,"UGX")}`,tone:k.balance>0?"warn":"good"}),e.jsx(It,{label:`Overdue: ${k.overdue}`,tone:k.overdue?"bad":"good"}),e.jsx(It,{label:`Paid: ${k.paid}`,tone:"good"}),e.jsx(It,{label:`Sent: ${k.sent}`,tone:"info"}),e.jsx(It,{label:`Draft: ${k.draft}`,tone:"neutral"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[F==="invoices"?e.jsxs(e.Fragment,{children:[e.jsxs(Qt,{variant:"outline",onClick:He,children:[e.jsx(pt,{className:"h-4 w-4"})," Export CSV"]}),e.jsxs(Qt,{variant:"outline",onClick:()=>{if(!re.length){i({title:"Nothing to export",message:"No invoices in current filter.",kind:"info"});return}ot(re[0].id)},title:"Print first invoice in list (demo)",children:[e.jsx(kt,{className:"h-4 w-4"})," Export PDF"]})]}):null,F==="explorer"?e.jsxs(Qt,{variant:"outline",onClick:Jo,children:[e.jsx(pt,{className:"h-4 w-4"})," Export pivot CSV"]}):null,e.jsxs(Qt,{variant:"primary",onClick:()=>{te("invoices"),i({title:"Tip",message:"Open an invoice to export PDF or raise a dispute.",kind:"info"})},children:[e.jsx(ht,{className:"h-4 w-4"})," Quick actions"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"invoices",label:"Invoices"},{id:"explorer",label:"Invoice explorer"},{id:"statements",label:"Statements"},{id:"creditNotes",label:"Credit notes"},{id:"disputes",label:"Disputes"}].map(J=>e.jsx("button",{className:oi("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",F===J.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:F===J.id?{background:xg.green}:void 0,onClick:()=>te(J.id),children:J.label},J.id))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[F==="invoices"?e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Ba,{title:"Filters",subtitle:"Search and narrow invoice list.",right:e.jsx(It,{label:"Core",tone:"neutral"}),children:[e.jsx(dd,{label:"Search",value:oe,onChange:G,placeholder:"Invoice no, entity, cost code..."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(Fr,{label:"Status",value:H,onChange:J=>Y(J),options:[{value:"All",label:"All"},{value:"Draft",label:"Draft"},{value:"Sent",label:"Sent"},{value:"Paid",label:"Paid"},{value:"Overdue",label:"Overdue"}]}),e.jsx(Fr,{label:"Entity",value:we,onChange:J=>q(J),options:[{value:"All",label:"All"},...t.map(J=>({value:J.id,label:J.name}))]}),e.jsx("div",{className:"sm:col-span-2",children:e.jsx(Fr,{label:"Invoice group",value:je,onChange:J=>_e(J),options:[{value:"All",label:"All"},...s.map(J=>({value:J.id,label:J.name}))]})})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:[e.jsxs(Qt,{variant:"outline",onClick:()=>{G(""),Y("All"),q("All"),_e("All"),i({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(vn,{className:"h-4 w-4"})," Reset"]}),e.jsxs(Qt,{variant:"outline",onClick:()=>te("explorer"),children:[e.jsx(La,{className:"h-4 w-4"})," Explorer"]})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: invoice explorer supports pivot-like analysis and drilldown to line items."})]}),e.jsx(Ba,{title:"Quick insights",subtitle:"Top contributors in current filter.",right:e.jsx(It,{label:"Premium",tone:"info"}),children:(()=>{const J=new Set(re.map(Ct=>Ct.id)),Ie=g.filter(Ct=>J.has(Ct.invoiceId)),Je=fm(Ie,Ct=>Ct.vendor,Ct=>Ct.amount)[0],it=fm(Ie,Ct=>Ct.serviceModule,Ct=>Ct.amount)[0];return e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Top vendor"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:(Je==null?void 0:Je.key)||"-"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:Je?Bt(Je.value,"UGX"):"-"})]}),e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-emerald-50 text-emerald-700 ring-1 ring-emerald-200",children:e.jsx(Er,{className:"h-5 w-5"})})]})}),e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Top module"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:(it==null?void 0:it.key)||"-"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:it?Bt(it.value,"UGX"):"-"})]}),e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-slate-50 text-slate-700 ring-1 ring-slate-200",children:e.jsx(La,{className:"h-5 w-5"})})]})}),e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: open an invoice to see vendor and project tag breakdown."})]})})()})]}),e.jsx("div",{className:"lg:col-span-8",children:e.jsxs(Ba,{title:"Invoice list",subtitle:"Statuses: draft, sent, paid, overdue. Click an invoice to open details.",right:e.jsx(It,{label:`${re.length} invoice(s)`,tone:"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Invoice"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Entity"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Issue"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Due"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Total"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Balance"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[re.map(J=>{const Ie=a[J.entityId],Je=l[J.invoiceGroupId],it=!!v[J.id],Ct=H4(J.dueDate,J.status);return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:J.invoiceNo}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[J.id,"  ",(Je==null?void 0:Je.costCode)||"-"]}),it?e.jsx("div",{className:"mt-2",children:e.jsx(It,{label:`${v[J.id]} dispute`,tone:"warn"})}):null]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(Ie==null?void 0:Ie.name)||J.entityId}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(Je==null?void 0:Je.name)||J.invoiceGroupId}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:yn(J.issueDate)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(It,{label:yn(J.dueDate),tone:Ct}),e.jsx("div",{className:"text-xs text-slate-500",children:od(J.dueDate)})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(It,{label:J.status,tone:ao(J.status)})}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Bt(J.total,J.currency)}),e.jsx("td",{className:oi("px-4 py-3 font-semibold",J.balance>0?"text-slate-900":"text-emerald-700"),children:Bt(J.balance,J.currency)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"flex justify-end",children:e.jsx(Cw,{actions:[{label:"Open details",icon:e.jsx(et,{className:"h-4 w-4"}),onClick:()=>Ce(J.id)},{label:"Download PDF",icon:e.jsx(kt,{className:"h-4 w-4"}),onClick:()=>ot(J.id)},{label:"Create credit note",icon:e.jsx(yt,{className:"h-4 w-4"}),onClick:()=>Nt(J.id)},{label:"Raise dispute",icon:e.jsx(yi,{className:"h-4 w-4"}),onClick:()=>ka(J.id)}]})})})]},J.id)}),re.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-4 py-12 text-center text-sm text-slate-600",children:"No invoices match your filters."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Core exports: CSV is available. PDF export uses print to PDF."})]})})]}):null,F==="explorer"?e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs(Ba,{title:"Pivot table",subtitle:"Totals are computed in real time.",right:e.jsx(It,{label:me==="Amount"?Bt(N.grand,"UGX"):`${N.grand} events`,tone:"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:ne}),N.colKeys.map(J=>e.jsx("th",{className:"px-4 py-3 font-semibold",children:J},J)),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Total"})]})}),e.jsxs("tbody",{children:[N.rowKeys.map(J=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:J}),N.colKeys.map(Ie=>{var it;const Je=((it=N.matrix[J])==null?void 0:it[Ie])||0;return e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{type:"button",className:"rounded-xl px-3 py-2 text-sm font-semibold text-slate-900 hover:bg-slate-100",onClick:()=>{P({rowKey:J,colKey:Ie}),E(!0)},children:me==="Amount"?Bt(Je,"UGX"):Je})},Ie)}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:me==="Amount"?Bt(N.rowTotals[J]||0,"UGX"):N.rowTotals[J]||0})]},J)),N.rowKeys.length?e.jsxs("tr",{className:"border-t border-slate-200 bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:"Total"}),N.colKeys.map(J=>e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:me==="Amount"?Bt(N.colTotals[J]||0,"UGX"):N.colTotals[J]||0},J)),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:me==="Amount"?Bt(N.grand,"UGX"):N.grand})]}):e.jsx("tr",{children:e.jsx("td",{colSpan:N.colKeys.length+2,className:"px-4 py-12 text-center text-sm text-slate-600",children:"No data in current scope."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: drilldown supports explain charge linking to raw events."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Ba,{title:"Interactive invoice explorer",subtitle:"Premium: pivot-like analysis across line items.",right:e.jsx(It,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx(Fr,{label:"Row dimension",value:ne,onChange:J=>Me(J),options:h.map(J=>({value:J.value,label:J.label}))}),e.jsx(Fr,{label:"Column dimension",value:De,onChange:J=>fe(J),options:[{value:"None",label:"None"},...h.map(J=>({value:J.value,label:J.label}))]}),e.jsx(Fr,{label:"Metric",value:me,onChange:J=>Xe(J),options:[{value:"Amount",label:"Amount"},{value:"Count",label:"Count"}],hint:"Amount sums line items"})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Click a cell to drill down and view the underlying line items."}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:[e.jsxs(Qt,{variant:"outline",onClick:()=>te("invoices"),children:[e.jsx(et,{className:"h-4 w-4"})," Back to invoices"]}),e.jsxs(Qt,{variant:"outline",onClick:Jo,children:[e.jsx(pt,{className:"h-4 w-4"})," CSV"]})]})]}),e.jsx(Ba,{title:"Scope",subtitle:"Explorer uses invoice filters from Invoices tab.",right:e.jsx(It,{label:`${A.length} line(s)`,tone:"neutral"}),children:e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"To change scope, go to Invoices tab and adjust entity, status, or invoice group."})})]})]}):null,F==="statements"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(Ba,{title:"Statement period",subtitle:"Monthly statement summary.",right:e.jsx(It,{label:"Core",tone:"neutral"}),children:[e.jsx(dd,{label:"Month",value:K,onChange:_,placeholder:"YYYY-MM",hint:"Example: 2026-01"}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Qt,{variant:"outline",onClick:()=>{const J=kh(ke.map(Ie=>({entity:Ie.entityName,invoices:Ie.invoiceCount,issued:Bt(Ie.issued,a[Ie.entityId].currency),paid:Bt(Ie.paid,a[Ie.entityId].currency),balance:Bt(Ie.balance,a[Ie.entityId].currency)})),[{key:"entity",label:"Entity"},{key:"invoices",label:"Invoice Count"},{key:"issued",label:"Issued"},{key:"paid",label:"Paid"},{key:"balance",label:"Balance"}]);wh(`statement-${K}.csv`,J,"text/csv"),i({title:"Exported",message:"Statement CSV downloaded.",kind:"success"})},children:[e.jsx(pt,{className:"h-4 w-4"})," Export CSV"]}),e.jsxs(Qt,{variant:"outline",onClick:()=>{const J=`
                            <html><head><title>Statement ${K}</title>
                            <style>body{font-family: ui-sans-serif, system-ui; padding:24px;} table{width:100%; border-collapse:collapse; margin-top:16px;} th,td{border:1px solid #e2e8f0; padding:10px; font-size:12px;} th{background:#f8fafc; text-align:left;}</style>
                            </head><body>
                            <h2>Statement ${K}</h2>
                            <table><thead><tr><th>Entity</th><th>Invoice count</th><th>Issued</th><th>Paid</th><th>Balance</th></tr></thead><tbody>
                            ${ke.map(Je=>{const it=a[Je.entityId].currency;return`<tr><td>${Je.entityName}</td><td>${Je.invoiceCount}</td><td>${Bt(Je.issued,it)}</td><td>${Bt(Je.paid,it)}</td><td>${Bt(Je.balance,it)}</td></tr>`}).join("")}
                            </tbody></table>
                            <div style="margin-top:16px; color:#64748b; font-size:12px">Generated by EVzone CorporatePay</div>
                            </body></html>
                          `,Ie=window.open("","_blank");if(!Ie){i({title:"Popup blocked",message:"Allow popups to print/export PDF.",kind:"warn"});return}Ie.document.open(),Ie.document.write(J),Ie.document.close(),Ie.focus(),Ie.print(),i({title:"Print ready",message:"Use Print to PDF to save.",kind:"info"})},children:[e.jsx(kt,{className:"h-4 w-4"})," Export PDF"]})]})]}),e.jsx(Ba,{title:"What is included",subtitle:"Statements are based on invoice issue date.",right:e.jsx(It,{label:"Info",tone:"info"}),children:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"1) Issued totals are the sum of invoice totals"}),e.jsx("li",{children:"2) Paid totals are the sum of paid amounts"}),e.jsx("li",{children:"3) Balance totals are remaining amounts"})]})})})]}),e.jsx("div",{className:"lg:col-span-8",children:e.jsxs(Ba,{title:"Statement summary",subtitle:"Per entity totals for the selected month.",right:e.jsx(It,{label:`${ke.length} entity`,tone:"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Entity"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Invoices"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Issued"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Paid"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Balance"})]})}),e.jsxs("tbody",{children:[ke.map(J=>{const Ie=a[J.entityId].currency;return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:J.entityName}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:J.invoiceCount}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Bt(J.issued,Ie)}),e.jsx("td",{className:"px-4 py-3 font-semibold text-emerald-700",children:Bt(J.paid,Ie)}),e.jsx("td",{className:oi("px-4 py-3 font-semibold",J.balance>0?"text-slate-900":"text-emerald-700"),children:Bt(J.balance,Ie)})]},J.entityId)}),ke.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-12 text-center text-sm text-slate-600",children:"No invoices issued in this month."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Statements support multi-entity organizations and separate invoice streams."})]})})]}):null,F==="creditNotes"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(Ba,{title:"Create adjustment",subtitle:"Credit notes are approval-gated.",right:e.jsx(It,{label:"Core",tone:"neutral"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Credit notes reduce invoice balance and total once approved."}),e.jsxs(Qt,{variant:"primary",onClick:()=>{var J,Ie;return Nt(((J=re[0])==null?void 0:J.id)||((Ie=x[0])==null?void 0:Ie.id)||"INV-0001")},children:[e.jsx(gt,{className:"h-4 w-4"})," New credit note"]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: approvals are tracked in audit logs and can be routed by rules."})]}),e.jsx(Ba,{title:"Pending approvals",subtitle:"Approve or reject.",right:e.jsx(It,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"space-y-2",children:[I.filter(J=>J.status==="Pending").map(J=>{const Ie=se(J.invoiceId);return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:J.id}),e.jsx(It,{label:J.status,tone:ao(J.status)})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Invoice: ",(Ie==null?void 0:Ie.invoiceNo)||J.invoiceId]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:Bt(J.amount,(Ie==null?void 0:Ie.currency)||"UGX")}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Reason: ",J.reason]})]}),e.jsxs(Qt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>Vs(J.id),children:[e.jsx(yt,{className:"h-4 w-4"})," Review"]})]})},J.id)}),I.some(J=>J.status==="Pending")?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No pending credit notes."})]})})]}),e.jsx("div",{className:"lg:col-span-8",children:e.jsx(Ba,{title:"All credit notes",subtitle:"Adjustments and approvals history.",right:e.jsx(It,{label:`${I.length}`,tone:"neutral"}),children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"ID"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Invoice"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Reason"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Created"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Decision"})]})}),e.jsxs("tbody",{children:[I.map(J=>{const Ie=se(J.invoiceId);return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:J.id}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(Ie==null?void 0:Ie.invoiceNo)||J.invoiceId}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Bt(J.amount,(Ie==null?void 0:Ie.currency)||"UGX")}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(It,{label:J.status,tone:ao(J.status)})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:J.reason}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:yn(J.createdAt)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:J.status!=="Pending"?e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs text-slate-500",children:["By ",J.decidedBy||"-","  ",J.decidedAt?yn(J.decidedAt):"-"]}),J.approvalReason?e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Why: ",J.approvalReason]}):null]}):e.jsx(It,{label:"Pending",tone:"warn"})})]},J.id)}),I.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-12 text-center text-sm text-slate-600",children:"No credit notes."})})]})]})})})})]}):null,F==="disputes"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(Ba,{title:"Create dispute",subtitle:"Ticketing with evidence attachments.",right:e.jsx(It,{label:"Premium",tone:"info"}),children:[e.jsxs(Qt,{variant:"primary",onClick:()=>{var J,Ie;return ka(((J=re[0])==null?void 0:J.id)||((Ie=x[0])==null?void 0:Ie.id)||"INV-0001")},children:[e.jsx(gt,{className:"h-4 w-4"})," New ticket"]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Disputes are linked to invoices and track messages, evidence, and resolution."})]}),e.jsx(Ba,{title:"Statuses",subtitle:"Resolve or reject after review.",right:e.jsx(It,{label:"Core",tone:"neutral"}),children:e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: disputes can pause payment enforcement until resolved."})})]}),e.jsx("div",{className:"lg:col-span-8",children:e.jsxs(Ba,{title:"Tickets",subtitle:"Open, in review, resolved.",right:e.jsx(It,{label:`${Z.length}`,tone:"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Ticket"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Invoice"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Category"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Evidence"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Updated"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[Z.map(J=>{const Ie=se(J.invoiceId),Je=J.messages[J.messages.length-1];return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:J.id}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["By ",J.createdBy]})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(Ie==null?void 0:Ie.invoiceNo)||J.invoiceId}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(It,{label:J.status,tone:ao(J.status)})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:J.category}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(It,{label:`${J.evidence.length}`,tone:J.evidence.length?"info":"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:od(Je?Je.at:J.createdAt)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Qt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Ca(J.id),children:[e.jsx(yi,{className:"h-4 w-4"})," Open"]}),J.status!=="Resolved"?e.jsxs(Qt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Ae(J.id),le(!0),Al("Resolved")},children:[e.jsx(tt,{className:"h-4 w-4"})," Resolve"]}):null]})})]},J.id)}),Z.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-12 text-center text-sm text-slate-600",children:"No dispute tickets."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Ticket detail includes evidence attachments and message thread."})]})})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"O Invoices and Statements v2. Core: invoice list, statuses, line item breakdown, export CSV/PDF, credit notes with approvals. Premium: pivot explorer, explain charge drilldown, dispute workflow."})})]})}),e.jsx(h_,{open:Ee,title:m?m.invoiceNo:"Invoice",subtitle:m?`${((Sw=a[m.entityId])==null?void 0:Sw.name)||m.entityId}  ${((Aw=l[m.invoiceGroupId])==null?void 0:Aw.name)||m.invoiceGroupId}`:"",onClose:()=>be(!1),actions:[{label:"Lines CSV",onClick:()=>m&&mt(m.id)},{label:"PDF",onClick:()=>m&&ot(m.id)},{label:"Credit",onClick:()=>m&&Nt(m.id)},{label:"Dispute",onClick:()=>m&&ka(m.id)}],footer:m?e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Exports and disputes are audit logged in production."}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Qt,{variant:"outline",onClick:()=>mt(m.id),children:[e.jsx(pt,{className:"h-4 w-4"})," Lines CSV"]}),e.jsxs(Qt,{variant:"outline",onClick:()=>ot(m.id),children:[e.jsx(kt,{className:"h-4 w-4"})," PDF"]}),e.jsxs(Qt,{variant:"outline",onClick:()=>Nt(m.id),children:[e.jsx(yt,{className:"h-4 w-4"})," Credit"]}),e.jsxs(Qt,{variant:"primary",onClick:()=>ka(m.id),children:[e.jsx(yi,{className:"h-4 w-4"})," Dispute"]})]})]}):null,children:m?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(It,{label:m.status,tone:ao(m.status)}),e.jsx(It,{label:`Issue ${yn(m.issueDate)}`,tone:"neutral"}),e.jsx(It,{label:`Due ${yn(m.dueDate)}`,tone:H4(m.dueDate,m.status)}),v[m.id]?e.jsx(It,{label:`${v[m.id]} dispute`,tone:"warn"}):null]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Notes: ",m.notes||"-"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Total"}),e.jsx("div",{className:"mt-1 text-lg font-semibold text-slate-900",children:Bt(m.total,m.currency)}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Balance: ",Bt(m.balance,m.currency)]})]})]})}),e.jsx(Ba,{title:"Line items",subtitle:"Breakdown by module, marketplace, vendor, group, cost center, and project tag.",right:e.jsx(Fr,{label:"Group by",value:M,onChange:ee,options:p,hint:"Breakdown"}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Key"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"})]})}),e.jsxs("tbody",{children:[b.slice(0,10).map(J=>e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:J.key}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Bt(J.value,m.currency)})]},J.key)),b.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:2,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No line items."})})]})]})}),e.jsx("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Description"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Explain"})]})}),e.jsxs("tbody",{children:[S.slice(0,10).map(J=>e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:J.description}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[J.serviceModule,J.marketplace?`  ${J.marketplace}`:"","  ",J.vendor]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[J.group,"  ",J.costCenter,"  ",J.projectTag]})]}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Bt(J.amount,m.currency)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(Qt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Yd(J.id),children:[e.jsx(ht,{className:"h-4 w-4"})," Explain"]})})]},J.id)),S.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No line items."})})]})]})})]})}),e.jsx(Ba,{title:"Adjustments",subtitle:"Credit notes are approval-gated.",right:e.jsx(It,{label:`${f.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[f.map(J=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:J.id}),e.jsx(It,{label:J.status,tone:ao(J.status)})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[yn(J.createdAt),"  ",J.createdBy]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:Bt(J.amount,m.currency)}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Reason: ",J.reason]}),J.status!=="Pending"&&J.approvalReason?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Decision: ",J.approvalReason]}):null]}),J.status==="Pending"?e.jsxs(Qt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>Vs(J.id),children:[e.jsx(yt,{className:"h-4 w-4"})," Review"]}):e.jsx(It,{label:"Final",tone:"neutral"})]})},J.id)),f.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No adjustments."})]})}),e.jsx(Ba,{title:"Disputes",subtitle:"Ticketing and evidence attachments.",right:e.jsx(It,{label:`${U.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[U.map(J=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:J.id}),e.jsx(It,{label:J.status,tone:ao(J.status)}),e.jsx(It,{label:J.category,tone:"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",od(J.createdAt),"  By ",J.createdBy]}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:J.description}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Evidence: ",J.evidence.length,"  Messages: ",J.messages.length]})]}),e.jsxs(Qt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Ca(J.id),children:[e.jsx(yi,{className:"h-4 w-4"})," Open"]})]})},J.id)),U.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No disputes for this invoice."})]})})]}):e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"Select an invoice."})}),e.jsx(fc,{open:pe,title:"Explain charge",subtitle:"Premium: drill down from line item to raw events.",onClose:()=>Q(!1),actions:[{label:"Export raw",onClick:()=>i({title:"Export",message:"In production, raw events export to CSV.",kind:"info"})}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Qt,{variant:"outline",onClick:()=>Q(!1),children:"Close"}),e.jsxs(Qt,{variant:"outline",onClick:()=>i({title:"Export",message:"In production, raw events export to CSV.",kind:"info"}),children:[e.jsx(pt,{className:"h-4 w-4"})," Export raw"]})]}),children:ae?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:ae.description}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[ae.serviceModule,ae.marketplace?`  ${ae.marketplace}`:"","  ",ae.vendor]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[ae.group,"  ",ae.costCenter,"  ",ae.projectTag]})]}),e.jsx(It,{label:ae.id,tone:"neutral"})]})}),O?e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Summary"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Based on ",ve.length," raw event(s)."]})]}),e.jsx(It,{label:Bt(O.total,"UGX"),tone:"info"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"By type"}),e.jsx("div",{className:"mt-2 space-y-1",children:O.byKind.map(J=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"font-semibold text-slate-700",children:J.key}),e.jsx("span",{className:"font-semibold text-slate-900",children:Bt(J.value,"UGX")})]},J.key))})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"By vendor"}),e.jsx("div",{className:"mt-2 space-y-1",children:O.byVendor.map(J=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"font-semibold text-slate-700",children:J.key}),e.jsx("span",{className:"font-semibold text-slate-900",children:Bt(J.value,"UGX")})]},J.key))})]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Explain charge: each raw event is linked to a trip, order, charging session, or service record."})]}):e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No raw events available for this line in demo."}),e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Type"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Reference"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Module"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Details"})]})}),e.jsxs("tbody",{children:[ve.map(J=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:yn(J.ts)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(It,{label:J.kind,tone:"neutral"})}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:J.reference}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[J.serviceModule,J.marketplace?`  ${J.marketplace}`:""]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:J.vendor}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Bt(J.amount,"UGX")}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:J.details})]},J.id)),ve.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No raw events."})})]})]})})]}):null}),e.jsx(fc,{open:xe,title:"Create credit note",subtitle:"Core: adjustments are approval-gated.",onClose:()=>he(!1),actions:[{label:"Submit",onClick:nt}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Qt,{variant:"outline",onClick:()=>he(!1),children:"Cancel"}),e.jsxs(Qt,{variant:"primary",onClick:nt,children:[e.jsx(ct,{className:"h-4 w-4"})," Submit"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Fr,{label:"Invoice",value:de.invoiceId,onChange:J=>ye(Ie=>({...Ie,invoiceId:J})),options:D.map(J=>({value:J.id,label:J.invoiceNo})),hint:"Select invoice"}),e.jsx(dd,{label:"Amount",value:String(de.amount),onChange:J=>ye(Ie=>({...Ie,amount:Math.max(0,Number(J||0))})),type:"number",hint:"UGX"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(gm,{label:"Reason",value:de.reason,onChange:J=>ye(Ie=>({...Ie,reason:J})),placeholder:"Example: duplicate line, service cancellation, pricing correction",hint:"Minimum 8 characters",rows:4})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(gm,{label:"Evidence note",value:de.attachmentNote,onChange:J=>ye(Ie=>({...Ie,attachmentNote:J})),placeholder:"Optional: reference document or evidence",hint:"Optional",rows:3})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"This credit note will appear in the approval queue. Approving applies it to the invoice totals."})]})}),e.jsx(fc,{open:Ke,title:"Credit note approval",subtitle:"Approval-gated adjustments require a reason.",onClose:()=>Le(!1),actions:[{label:"Reject",onClick:()=>Es("Rejected"),variant:"danger"},{label:"Approve",onClick:()=>Es("Approved")}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Qt,{variant:"outline",onClick:()=>Le(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Qt,{variant:"outline",onClick:()=>Es("Rejected"),children:[e.jsx(Qe,{className:"h-4 w-4"})," Reject"]}),e.jsxs(Qt,{variant:"primary",onClick:()=>Es("Approved"),children:[e.jsx(tt,{className:"h-4 w-4"})," Approve"]})]})]}),children:(()=>{const J=C.find(Je=>Je.id===Ne);if(!J)return e.jsx("div",{className:"text-sm text-slate-600",children:"Select a credit note."});const Ie=se(J.invoiceId);return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Credit:"})," ",J.id]}),e.jsxs("div",{className:"mt-1",children:[e.jsx("span",{className:"font-semibold",children:"Invoice:"})," ",(Ie==null?void 0:Ie.invoiceNo)||J.invoiceId]}),e.jsxs("div",{className:"mt-1",children:[e.jsx("span",{className:"font-semibold",children:"Amount:"})," ",Bt(J.amount,(Ie==null?void 0:Ie.currency)||"UGX")]}),e.jsxs("div",{className:"mt-1",children:[e.jsx("span",{className:"font-semibold",children:"Reason:"})," ",J.reason]})]}),e.jsx(gm,{label:"Decision reason",value:$e,onChange:ie,placeholder:"Example: verified raw events and vendor confirmation",hint:"Minimum 8 characters",rows:3}),e.jsxs("label",{className:"flex items-start gap-3 rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("input",{type:"checkbox",checked:Oe,onChange:Je=>Se(Je.target.checked),className:"mt-1 h-4 w-4 rounded border-slate-300"}),e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"I confirm this decision is authorized and will be audit logged."})]})]})})()}),e.jsx(fc,{open:Te,title:"Create dispute ticket",subtitle:"Premium: ticketing with evidence attachments.",onClose:()=>Ge(!1),actions:[{label:"Create",onClick:Ot}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Qt,{variant:"outline",onClick:()=>Ge(!1),children:"Cancel"}),e.jsxs(Qt,{variant:"primary",onClick:Ot,children:[e.jsx(ct,{className:"h-4 w-4"})," Create"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Fr,{label:"Invoice",value:We.invoiceId,onChange:J=>ze(Ie=>({...Ie,invoiceId:J})),options:D.map(J=>({value:J.id,label:J.invoiceNo}))}),e.jsx(Fr,{label:"Category",value:We.category,onChange:J=>ze(Ie=>({...Ie,category:J})),options:[{value:"Wrong amount",label:"Wrong amount"},{value:"Duplicate",label:"Duplicate"},{value:"Missing service",label:"Missing service"},{value:"VAT/tax",label:"VAT/tax"},{value:"Other",label:"Other"}]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(gm,{label:"Description",value:We.description,onChange:J=>ze(Ie=>({...Ie,description:J})),placeholder:"Describe the dispute and what you expect to change.",hint:"Minimum 12 characters",rows:4})}),e.jsx(dd,{label:"Evidence name",value:We.evidenceName,onChange:J=>ze(Ie=>({...Ie,evidenceName:J})),placeholder:"Example: screenshot.png",hint:"Optional"}),e.jsx(dd,{label:"Evidence note",value:We.evidenceNote,onChange:J=>ze(Ie=>({...Ie,evidenceNote:J})),placeholder:"What this evidence shows",hint:"Optional"}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Evidence is stored securely in production. This demo stores metadata only."})]})}),e.jsx(fc,{open:Ue,title:Ft?`Ticket ${Ft.id}`:"Ticket",subtitle:Ft?`${Ft.status}  Invoice ${((Ew=se(Ft.invoiceId))==null?void 0:Ew.invoiceNo)||Ft.invoiceId}`:"",onClose:()=>le(!1),actions:[{label:"In review",onClick:()=>Al("In review")},{label:"Reject",onClick:()=>Al("Rejected"),variant:"danger"},{label:"Resolve",onClick:()=>Al("Resolved")}],footer:Ft?e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Qt,{variant:"outline",onClick:()=>le(!1),children:"Close"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Qt,{variant:"outline",onClick:()=>Al("In review"),children:[e.jsx(en,{className:"h-4 w-4"})," In review"]}),e.jsxs(Qt,{variant:"outline",onClick:()=>Al("Rejected"),children:[e.jsx(Qe,{className:"h-4 w-4"})," Reject"]}),e.jsxs(Qt,{variant:"primary",onClick:()=>Al("Resolved"),children:[e.jsx(tt,{className:"h-4 w-4"})," Resolve"]})]})]}):null,children:Ft?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsx("div",{className:"flex items-start justify-between gap-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(It,{label:Ft.status,tone:ao(Ft.status)}),e.jsx(It,{label:Ft.category,tone:"neutral"}),e.jsx(It,{label:`Evidence ${Ft.evidence.length}`,tone:Ft.evidence.length?"info":"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:Ft.description}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Created ",od(Ft.createdAt),"  By ",Ft.createdBy]})]})})}),e.jsxs(Ba,{title:"Messages",subtitle:"Conversation thread",right:e.jsx(It,{label:`${Ft.messages.length}`,tone:"neutral"}),children:[e.jsx("div",{className:"space-y-2",children:Ft.messages.slice().sort((J,Ie)=>J.at-Ie.at).map((J,Ie)=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:J.by}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:J.message}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[yn(J.at),"  ",od(J.at)]})]}),e.jsx(yi,{className:"h-5 w-5 text-slate-400"})]})},Ie))}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3",children:[e.jsx(gm,{label:"Add message",value:Ve,onChange:Ye,placeholder:"Write a message",rows:3}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(Qt,{variant:"primary",onClick:Uu,disabled:!Ve.trim(),children:[e.jsx(tt,{className:"h-4 w-4"})," Send"]})})]})]}),e.jsxs(Ba,{title:"Evidence",subtitle:"Attachments metadata",right:e.jsx(It,{label:`${Ft.evidence.length}`,tone:"neutral"}),children:[e.jsxs("div",{className:"space-y-2",children:[Ft.evidence.map(J=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:J.name}),e.jsx(It,{label:J.id,tone:"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Uploaded ",od(J.uploadedAt),"  ",J.uploadedBy]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Note: ",J.note]})]}),e.jsx(Nw,{className:"h-5 w-5 text-slate-400"})]})},J.id)),Ft.evidence.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No evidence attached."})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(dd,{label:"Evidence name",value:Be,onChange:w,placeholder:"file.png"}),e.jsx(dd,{label:"Evidence note",value:B,onChange:ue,placeholder:"What it shows"}),e.jsx("div",{className:"md:col-span-2 flex justify-end",children:e.jsxs(Qt,{variant:"primary",onClick:Yo,children:[e.jsx(gt,{className:"h-4 w-4"})," Add evidence"]})})]})]})]}):e.jsx("div",{className:"text-sm text-slate-600",children:"Select a ticket."})}),e.jsx(fc,{open:V,title:"Explorer drilldown",subtitle:"Premium: items behind the pivot cell.",onClose:()=>E(!1),actions:[{label:"Close",onClick:()=>E(!1)}],footer:e.jsx("div",{className:"flex justify-end",children:e.jsx(Qt,{variant:"outline",onClick:()=>E(!1),children:"Close"})}),children:u?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Row: ",e.jsx("span",{className:"font-semibold",children:u.rowKey}),De!=="None"?e.jsxs(e.Fragment,{children:[e.jsx("br",{}),"Column: ",e.jsx("span",{className:"font-semibold",children:u.colKey})]}):null,e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Items: ",Af.length]})]}),e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Invoice"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Line"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Explain"})]})}),e.jsxs("tbody",{children:[Af.slice(0,50).map(J=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("button",{className:"text-left",onClick:()=>{Ce(J.invoiceId),E(!1)},children:[e.jsx("div",{className:"font-semibold text-slate-900",children:J.invoiceNo}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:J.invoiceStatus})]})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:J.description}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:J.vendor}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Bt(J.amount,"UGX")}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(Qt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Yd(J.id),E(!1)},children:[e.jsx(ht,{className:"h-4 w-4"})," Explain"]})})]},`${J.invoiceId}-${J.id}`)),Af.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No rows."})})]})]})}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: drilldown can link to the full raw events for each line item."})]}):null})]})}const pg={green:"#03CD8C",orange:"#F77F00"};function Fs(...t){return t.filter(Boolean).join(" ")}function Ch(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function vc(t,s,a){return Math.max(s,Math.min(a,t))}function bc(t){return new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"2-digit"})}function tb(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function X4(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function vm(t,s){const a=Math.round(Number(t||0));try{return new Intl.NumberFormat(void 0,{style:"currency",currency:s,maximumFractionDigits:0}).format(a)}catch{return`${s} ${a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}}function b_(t){let s=2166136261;for(let a=0;a<t.length;a++)s^=t.charCodeAt(a),s=Math.imul(s,16777619);return(s>>>0)%1e3/1e3}function xt({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Fs("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Gt({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:pg.green}:t==="accent"?{background:pg.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Fs(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function bm({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:Fs("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:Fs("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function sb({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:Fs(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:Fs("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function jc({label:t,value:s,onChange:a,hint:l,disabled:n}){return e.jsxs("div",{className:Fs(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",value:s,onChange:r=>a(Number(r.target.value||0)),disabled:n,className:Fs("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function ur({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:Fs(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:Fs("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function ab({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4,disabled:i}){return e.jsxs("div",{className:Fs(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:o=>a(o.target.value),placeholder:l,rows:r,disabled:i,className:Fs("mt-2 w-full rounded-2xl border p-3 text-sm font-semibold shadow-sm outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function QE({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null),[n,r]=d.useState({top:0,left:0,up:!1});return d.useEffect(()=>{if(s&&l.current){const i=l.current.getBoundingClientRect(),o=t.length*40+20,x=window.innerHeight-i.bottom<o&&i.top>o;r({top:x?i.top-8:i.bottom+8,left:i.right,up:x});const j=()=>a(!1);return window.addEventListener("scroll",j,{capture:!0}),window.addEventListener("resize",j),()=>{window.removeEventListener("scroll",j,{capture:!0}),window.removeEventListener("resize",j)}}},[s,t.length]),t.length?e.jsxs(e.Fragment,{children:[e.jsx("button",{ref:l,onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&Lg.createPortal(e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-[9998]",onClick:()=>a(!1)}),e.jsx("div",{className:"fixed z-[9999] w-48 overflow-hidden rounded-xl border border-slate-200 bg-white shadow-xl ring-1 ring-slate-200",style:{top:n.up?"auto":n.top,bottom:n.up?window.innerHeight-n.top:"auto",left:n.left-192},children:t.map((i,o)=>e.jsxs("button",{onClick:()=>{i.onClick(),a(!1)},disabled:i.disabled,className:Fs("flex w-full items-center gap-2 px-4 py-2.5 text-left text-sm font-medium transition hover:bg-slate-50 disabled:opacity-50",i.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700"),children:[i.icon&&e.jsx("span",{className:"mr-2 h-4 w-4",children:i.icon}),i.label]},o))})]}),document.body)]}):null}function Sh({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="920px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[8vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-1",children:[o?e.jsx(QE,{actions:o}):null,e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function j_({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r}){return d.useEffect(()=>{const i=o=>o.key==="Escape"&&n();return t&&window.addEventListener("keydown",i),()=>window.removeEventListener("keydown",i)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,x:16},animate:{opacity:1,x:0},exit:{opacity:0,x:16},transition:{duration:.18},className:Fs("fixed z-50 overflow-hidden border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]","left-2 right-2 bottom-2 top-[12vh] rounded-[28px]","lg:left-auto lg:right-4 lg:top-4 lg:bottom-4 lg:w-[680px]"),role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-base font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"h-full min-h-0 overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function y_({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Fs("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function yc(t){return t==="Email"?e.jsx(Xs,{className:"h-4 w-4"}):t==="WhatsApp"?e.jsx(DE,{className:"h-4 w-4"}):t==="WeChat"?e.jsx($i,{className:"h-4 w-4"}):e.jsx(ww,{className:"h-4 w-4"})}function Ms({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function Nc({title:t,value:s,sub:a,icon:l,tone:n}){const r=n==="good"?"bg-emerald-50 text-emerald-700":n==="warn"?"bg-amber-50 text-amber-800":n==="bad"?"bg-rose-50 text-rose-700":n==="info"?"bg-blue-50 text-blue-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-500",children:t}),e.jsx("div",{className:"mt-2 text-3xl font-semibold tracking-tight text-slate-900",children:s}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a})]}),e.jsx("div",{className:Fs("grid h-12 w-12 place-items-center rounded-2xl",r),children:l})]})})}function lb(t){return t==="Paid"||t==="Resolved"?"good":t==="Overdue"||t==="Rejected"?"bad":t==="Draft"||t==="Open"||t==="In review"||t==="Pending"?"warn":t==="Sent"?"info":"neutral"}function wc(t){return t==="Full stopped"?"bad":t==="Soft paused"?"warn":"good"}function N_(t){return t==="High"?"bad":t==="Medium"?"warn":"good"}function w_(t){return t<45?"High":t<75?"Medium":"Low"}function k_(t){const{maxOverdueDays:s,overdueBalanceBase:a,openDisputes:l,failedDeliveries:n,pendingFinalNotices:r}=t;let i=100;return i-=vc(s*3.2,0,55),i-=vc(Math.log10(1+a)*9.5,0,22),i-=vc(l*6,0,20),i-=vc(n*2,0,10),i-=vc(r*8,0,16),Math.round(vc(i,0,100))}function K4(t,s,a){const r=t.filter(c=>c.balance>0&&c.status!=="Draft").map(c=>({inv:c,days:Math.max(0,Math.floor((a-c.dueDate)/864e5))})).filter(c=>c.days>0),i=r.length?Math.max(...r.map(c=>c.days)):0,o=r.length;return s.enabled?s.freezeAllServices?{mode:"Full stopped",reason:"Risk freeze enabled",maxOverdueDays:i,overdueCount:o}:i>=s.fullStopAfterOverdueDays&&o>0?{mode:"Full stopped",reason:`Overdue exceeded full stop threshold (${s.fullStopAfterOverdueDays} days)`,maxOverdueDays:i,overdueCount:o}:i>=s.softPauseAfterOverdueDays&&o>0?{mode:"Soft paused",reason:`Overdue exceeded soft pause threshold (${s.softPauseAfterOverdueDays} days)`,maxOverdueDays:i,overdueCount:o}:{mode:"Active",reason:"No enforcement triggers",maxOverdueDays:i,overdueCount:o}:{mode:"Active",reason:"Enforcement disabled",maxOverdueDays:i,overdueCount:o}}function jm(t,s){return t==="Finance"?s.filter(a=>a.role==="Finance"||a.role==="AP"):t==="CFO"?s.filter(a=>a.role==="CFO"):s.filter(a=>a.role==="EVzone Support")}function C_(){var ae,ve,O,X;const t=["Email","WhatsApp","WeChat","SMS"],[s,a]=d.useState(()=>Date.now()),[l,n]=d.useState([]),r=A=>{const N=Ch("toast");n(h=>[{id:N,...A},...h].slice(0,4)),window.setTimeout(()=>n(h=>h.filter(K=>K.id!==N)),3200)},[i,o]=d.useState("overview"),[c]=d.useState(()=>[{id:"ENT-UG",name:"Uganda HQ",currency:"UGX",vatEnabled:!0,vatRatePct:18},{id:"ENT-CN",name:"China Branch",currency:"CNY",vatEnabled:!0,vatRatePct:13}]),[x]=d.useState(()=>[{id:"IG-MAIN-UG",name:"Main corporate",entityId:"ENT-UG",apCode:"ACME-MAIN"},{id:"IG-SALES-TRAVEL",name:"Sales travel",entityId:"ENT-UG",apCode:"ACME-SALES"},{id:"IG-CN-PROC",name:"China procurement",entityId:"ENT-CN",apCode:"CN-PROC"}]),j=d.useMemo(()=>Object.fromEntries(c.map(A=>[A.id,A])),[c]),g=d.useMemo(()=>Object.fromEntries(x.map(A=>[A.id,A])),[x]),[y,$]=d.useState(()=>[{id:"C-AP",name:"Accounts Payable",role:"AP",email:"ap@acme.com",phone:"+256 701 000 000",channels:{Email:!0,WhatsApp:!1,WeChat:!1,SMS:!0}},{id:"C-FIN",name:"Finance Desk",role:"Finance",email:"finance@acme.com",phone:"+256 700 000 000",channels:{Email:!0,WhatsApp:!0,WeChat:!0,SMS:!0}},{id:"C-CFO",name:"CFO",role:"CFO",email:"cfo@acme.com",phone:"+256 702 000 000",channels:{Email:!0,WhatsApp:!0,WeChat:!1,SMS:!0}},{id:"C-EVZ",name:"EVzone Support",role:"EVzone Support",email:"support@evzone.com",phone:"+256 703 000 000",channels:{Email:!0,WhatsApp:!0,WeChat:!1,SMS:!0}}]),T=24*60*60*1e3,[C,W]=d.useState(()=>[{id:"INV-0001",invoiceNo:"ACME-202601-1042",entityId:"ENT-UG",invoiceGroupId:"IG-MAIN-UG",issueDate:s-9*T,dueDate:s+1*T,status:"Sent",total:1652e4,paidAmount:0,balance:1652e4,openDisputes:1,lastReminderAt:s-16*60*60*1e3},{id:"INV-0002",invoiceNo:"ACME-SALES-202512-0088",entityId:"ENT-UG",invoiceGroupId:"IG-SALES-TRAVEL",issueDate:s-42*T,dueDate:s-24*T,status:"Overdue",total:6136e3,paidAmount:0,balance:6136e3,openDisputes:0,lastReminderAt:s-2*T},{id:"INV-0003",invoiceNo:"ACME-202512-1038",entityId:"ENT-UG",invoiceGroupId:"IG-MAIN-UG",issueDate:s-23*T,dueDate:s-16*T,status:"Paid",total:14396e3,paidAmount:14396e3,balance:0,openDisputes:0,lastReminderAt:void 0},{id:"INV-0004",invoiceNo:"ACME-CN-202512-0221",entityId:"ENT-CN",invoiceGroupId:"IG-CN-PROC",issueDate:s-15*T,dueDate:s-7*T,status:"Paid",total:76840,paidAmount:76840,balance:0,openDisputes:0},{id:"INV-0005",invoiceNo:"ACME-202601-1043",entityId:"ENT-UG",invoiceGroupId:"IG-MAIN-UG",issueDate:s-2*T,dueDate:s+6*T,status:"Draft",total:10748e3,paidAmount:0,balance:10748e3,openDisputes:0}]),[L,R]=d.useState(()=>[{id:"TPL-UPCOMING",name:"Upcoming due reminder",subject:"Upcoming invoice due: {invoiceNo}",body:"Hello {contactName}. Your invoice {invoiceNo} is due on {dueDate}. Amount due: {balance}. Please arrange payment to avoid service interruption.",enabledChannels:{Email:!0,WhatsApp:!0,WeChat:!0,SMS:!0}},{id:"TPL-OVERDUE",name:"Overdue notice",subject:"Overdue invoice: {invoiceNo}",body:"Hello {contactName}. Invoice {invoiceNo} is overdue. Balance: {balance}. Please pay immediately. Continued delinquency may pause services.",enabledChannels:{Email:!0,WhatsApp:!0,WeChat:!0,SMS:!0}},{id:"TPL-FINAL",name:"Final notice",subject:"Final notice: {invoiceNo}",body:"Hello {contactName}. Final notice for invoice {invoiceNo}. Balance: {balance}. Services may stop if payment is not received.",enabledChannels:{Email:!0,WhatsApp:!0,WeChat:!0,SMS:!0}}]),[F,te]=d.useState(()=>[{id:"STG-1",name:"Upcoming due",trigger:"Upcoming due",offsetDaysFromDue:-2,templateId:"TPL-UPCOMING",channels:{Email:!0,WhatsApp:!0,WeChat:!1,SMS:!1},escalation:"Finance",action:"None",enabled:!0},{id:"STG-2",name:"Overdue reminder",trigger:"Overdue",offsetDaysFromDue:1,templateId:"TPL-OVERDUE",channels:{Email:!0,WhatsApp:!0,WeChat:!1,SMS:!0},escalation:"Finance",action:"Soft pause",enabled:!0},{id:"STG-3",name:"Final notice",trigger:"Final notice",offsetDaysFromDue:7,templateId:"TPL-FINAL",channels:{Email:!0,WhatsApp:!0,WeChat:!0,SMS:!0},escalation:"CFO",action:"Full stop",enabled:!0},{id:"STG-4",name:"Escalate to EVzone support",trigger:"Final notice",offsetDaysFromDue:14,templateId:"TPL-FINAL",channels:{Email:!0,WhatsApp:!0,WeChat:!1,SMS:!0},escalation:"EVzone Support",action:"Full stop",enabled:!0}]),[oe,G]=d.useState(()=>[]),[H,Y]=d.useState(()=>({enabled:!0,softPauseAfterOverdueDays:3,fullStopAfterOverdueDays:10,finalNoticeAfterOverdueDays:7,autoReactivateAfterPayment:!0,freezeAllServices:!1,scope:"CorporatePay only"})),[we,q]=d.useState(()=>({firstResponseHours:4,resolutionHours:72})),[je,_e]=d.useState(()=>[{id:"DSP-010",invoiceId:"INV-0001",status:"In review",createdAt:s-20*60*60*1e3,lastUpdatedAt:s-2*60*60*1e3,firstResponseAt:s-18*60*60*1e3},{id:"DSP-011",invoiceId:"INV-0002",status:"Open",createdAt:s-9*60*60*1e3,lastUpdatedAt:s-9*60*60*1e3}]),[Ee,be]=d.useState(!1),[Fe,Pe]=d.useState(()=>({id:"",name:"",trigger:"Overdue",offsetDaysFromDue:1,templateId:"TPL-OVERDUE",channels:{Email:!0,WhatsApp:!0,WeChat:!1,SMS:!0},escalation:"Finance",action:"Soft pause",enabled:!0})),[pe,Q]=d.useState(!1),[Re,ce]=d.useState(()=>({id:"",name:"",subject:"",body:"",enabledChannels:{Email:!0,WhatsApp:!0,WeChat:!0,SMS:!0}})),[xe,he]=d.useState(!1),[de,ye]=d.useState(null),[Ke,Le]=d.useState(!1),[Ne,ge]=d.useState({invoiceId:"INV-0001",stageId:"STG-2",note:"Manual reminder"}),[$e,ie]=d.useState(!1),[Oe,Se]=d.useState(""),[Te,Ge]=d.useState("All"),[We,ze]=d.useState("All"),[Ue,le]=d.useState(()=>[{level:"Finance",notify:["Email","WhatsApp","SMS"]},{level:"CFO",notify:["Email","WhatsApp","SMS"]},{level:"EVzone Support",notify:["Email","WhatsApp"]}]),z=d.useMemo(()=>de&&C.find(A=>A.id===de)||null,[de,C]),Ae=d.useMemo(()=>C.filter(A=>A.balance>0&&A.status!=="Draft"),[C]),Ve=d.useMemo(()=>C.filter(A=>A.balance>0&&A.status!=="Draft").map(A=>({inv:A,overdueDays:Math.max(0,Math.floor((s-A.dueDate)/T))})).filter(A=>A.overdueDays>0).sort((A,N)=>N.overdueDays-A.overdueDays),[C,s]),Ye=d.useMemo(()=>C.filter(N=>N.balance>0&&N.status!=="Draft").map(N=>({inv:N,daysToDue:Math.ceil((N.dueDate-s)/T)})).filter(N=>N.daysToDue>=0&&N.daysToDue<=3).sort((N,h)=>N.daysToDue-h.daysToDue),[C,s]),Be=d.useMemo(()=>{var N;const A={};for(const h of C){const K=((N=j[h.entityId])==null?void 0:N.currency)||"UGX";A[K]=A[K]||{currency:K,total:0,balance:0,overdueBalance:0},A[K].total+=h.total,A[K].balance+=h.balance;const _=Math.max(0,Math.floor((s-h.dueDate)/T));h.balance>0&&h.status!=="Draft"&&_>0&&(A[K].overdueBalance+=h.balance)}return Object.values(A).sort((h,K)=>K.balance-h.balance)},[C,j,s]),w=d.useMemo(()=>K4(C,H,s),[C,H,s]),B=d.useMemo(()=>Ve.filter(A=>A.overdueDays>=H.finalNoticeAfterOverdueDays).map(A=>A.inv.id),[Ve,H.finalNoticeAfterOverdueDays]),ue=d.useMemo(()=>{const A={Email:{delivered:0,failed:0,queued:0},WhatsApp:{delivered:0,failed:0,queued:0},WeChat:{delivered:0,failed:0,queued:0},SMS:{delivered:0,failed:0,queued:0}};for(const N of oe)N.status==="Delivered"&&(A[N.channel].delivered+=1),N.status==="Failed"&&(A[N.channel].failed+=1),N.status==="Queued"&&(A[N.channel].queued+=1);return A},[oe]),ne=d.useMemo(()=>{const A=je.filter(I=>I.status==="Open"||I.status==="In review"),N=je.filter(I=>I.status==="Resolved"||I.status==="Rejected"),h=A.filter(I=>{const Z=(s-I.createdAt)/36e5;return I.firstResponseAt?!1:Z>we.firstResponseHours}),K=A.filter(I=>(s-I.createdAt)/36e5>we.resolutionHours),_=A.length?Math.round((A.length-h.length)/A.length*100):100,ke=A.length?Math.round((A.length-K.length)/A.length*100):100;return{openCount:A.length,resolvedCount:N.length,firstRespBreaches:h,resolutionBreaches:K,complianceFirst:_,complianceResolution:ke}},[je,we,s]),Me=d.useMemo(()=>oe.filter(A=>A.status==="Failed").length,[oe]),De=d.useMemo(()=>{const A=Be.find(N=>N.currency==="UGX");return(A==null?void 0:A.overdueBalance)||0},[Be]),fe=d.useMemo(()=>{const A=w.maxOverdueDays,N=je.filter(K=>K.status==="Open"||K.status==="In review").length,h=B.length;return k_({maxOverdueDays:A,overdueBalanceBase:De,openDisputes:N,failedDeliveries:Me,pendingFinalNotices:h})},[w.maxOverdueDays,je,B.length,De,Me]),me=d.useMemo(()=>w_(fe),[fe]),Xe=d.useMemo(()=>{const A=Oe.trim().toLowerCase();return oe.filter(N=>Te==="All"?!0:N.channel===Te).filter(N=>We==="All"?!0:N.status===We).filter(N=>{if(!A)return!0;const h=C.find(ke=>ke.id===N.invoiceId),K=F.find(ke=>ke.id===N.stageId);return`${N.id} ${N.status} ${N.channel} ${N.to} ${(h==null?void 0:h.invoiceNo)||N.invoiceId} ${(K==null?void 0:K.name)||N.stageId}`.toLowerCase().includes(A)}).slice().sort((N,h)=>h.createdAt-N.createdAt)},[oe,Oe,Te,We,C,F]),V=A=>{ye(A),he(!0)},E=A=>{W(N=>N.map(h=>h.id!==A?h:{...h,status:"Paid",paidAmount:h.total,balance:0})),r({title:"Payment recorded",message:"Invoice marked paid. Reactivation rules will apply.",kind:"success"}),H.autoReactivateAfterPayment&&H.freezeAllServices&&r({title:"Still frozen",message:"Risk freeze is enabled. Turn it off to reactivate services.",kind:"warn"})},u=A=>oe.some(h=>h.invoiceId===A.invoiceId&&h.stageId===A.stageId&&h.channel===A.channel)?!1:(G(h=>[{id:Ch("DLV"),...A},...h]),!0),P=(A,N,h)=>{const K=C.find(He=>He.id===A),_=F.find(He=>He.id===N);if(!K||!_)return;if(!_.enabled){r({title:"Stage disabled",message:"Enable the stage to send.",kind:"warn"});return}const ke=L.find(He=>He.id===_.templateId);if(!ke){r({title:"Template missing",message:"Select a template for this stage.",kind:"warn"});return}const I=jm(_.escalation,y);if(!I.length){r({title:"No recipients",message:"No contact found for the escalation level.",kind:"warn"});return}const Z=Date.now();let Ce=0;for(const He of t){if(!_.channels[He]||!ke.enabledChannels[He])continue;const mt=I.find(Ot=>Ot.channels[He])||I[0],ot=He==="Email"?mt.email:mt.phone,Nt=`${A}-${N}-${He}-${Z}`,Vs=b_(Nt)<.86?"Delivered":"Failed";u({createdAt:Z,invoiceId:A,stageId:N,channel:He,to:ot,status:Vs,error:Vs==="Failed"?"Temporary delivery failure. Will retry.":void 0})&&(Ce+=1)}W(He=>He.map(mt=>mt.id===A?{...mt,lastReminderAt:Z}:mt)),r({title:"Reminder sent",message:`${Ce} delivery record(s) created${h?` (${h})`:""}.`,kind:Ce?"success":"info"})},se=()=>{const A=s,N=C.filter(_=>_.balance>0&&_.status!=="Draft"),h=F.filter(_=>_.enabled).slice().sort((_,ke)=>_.offsetDaysFromDue-ke.offsetDaysFromDue);let K=0;for(const _ of N)for(const ke of h){const I=_.dueDate+ke.offsetDaysFromDue*T;A<I||ke.trigger==="Upcoming due"&&Math.max(0,Math.floor((A-_.dueDate)/T))>0||(P(_.id,ke.id),K+=1)}r({title:"Dunning run completed",message:`Evaluated ${N.length} invoice(s). Stages checked: ${h.length}.`,kind:K?"success":"info"})},D=()=>{var A;Pe({id:"",name:"New stage",trigger:"Overdue",offsetDaysFromDue:1,templateId:((A=L[0])==null?void 0:A.id)||"TPL-OVERDUE",channels:{Email:!0,WhatsApp:!0,WeChat:!1,SMS:!0},escalation:"Finance",action:"Soft pause",enabled:!0}),be(!0)},re=A=>{Pe(JSON.parse(JSON.stringify(A))),be(!0)},v=()=>{if(!Fe.name.trim()){r({title:"Missing name",message:"Stage name is required.",kind:"warn"});return}const A=Fe.id||Ch("STG"),N={...Fe,id:A};te(h=>{const K=h.findIndex(_=>_.id===A);if(K>=0){const _=h.slice();return _[K]=N,_}return[N,...h]}),be(!1),r({title:"Saved",message:"Dunning stage saved.",kind:"success"})},k=A=>{te(N=>N.filter(h=>h.id!==A)),r({title:"Deleted",message:"Stage removed.",kind:"info"})},m=()=>{ce({id:"",name:"New template",subject:"Reminder: {invoiceNo}",body:"Hello {contactName}. Invoice {invoiceNo} is due on {dueDate}. Balance: {balance}.",enabledChannels:{Email:!0,WhatsApp:!0,WeChat:!0,SMS:!0}}),Q(!0)},S=A=>{ce(JSON.parse(JSON.stringify(A))),Q(!0)},f=()=>{if(!Re.name.trim()){r({title:"Missing name",message:"Template name is required.",kind:"warn"});return}const A=Re.id||Ch("TPL"),N={...Re,id:A};R(h=>{const K=h.findIndex(_=>_.id===A);if(K>=0){const _=h.slice();return _[K]=N,_}return[N,...h]}),Q(!1),r({title:"Saved",message:"Template saved.",kind:"success"})},U=A=>{if(F.some(h=>h.templateId===A)){r({title:"Blocked",message:"Template is used by a stage.",kind:"warn"});return}R(h=>h.filter(K=>K.id!==A)),r({title:"Deleted",message:"Template removed.",kind:"info"})},p=()=>{const A=Xe.map(Ce=>{const He=C.find(ot=>ot.id===Ce.invoiceId),mt=F.find(ot=>ot.id===Ce.stageId);return{id:Ce.id,createdAt:tb(Ce.createdAt),invoiceNo:(He==null?void 0:He.invoiceNo)||Ce.invoiceId,stage:(mt==null?void 0:mt.name)||Ce.stageId,channel:Ce.channel,to:Ce.to,status:Ce.status,error:Ce.error||""}}),N=["id","createdAt","invoiceNo","stage","channel","to","status","error"].join(","),h=Ce=>{const He=String(Ce??"");return/[",\n]/.test(He)?`"${He.replace(/"/g,'""')}"`:He},K=A.map(Ce=>[Ce.id,Ce.createdAt,Ce.invoiceNo,Ce.stage,Ce.channel,Ce.to,Ce.status,Ce.error].map(h).join(",")).join(`
`),_=`${N}
${K}`,ke=new Blob([_],{type:"text/csv"}),I=URL.createObjectURL(ke),Z=document.createElement("a");Z.href=I,Z.download="collections-delivery-logs.csv",Z.click(),URL.revokeObjectURL(I),r({title:"Exported",message:"Delivery logs CSV downloaded.",kind:"success"})},M=async()=>{const A={enforcementCfg:H,disputeSlaCfg:we,escalationLadder:Ue,stages:F,templates:L,exportedAt:new Date().toISOString()},N=new Blob([JSON.stringify(A,null,2)],{type:"application/json"}),h=URL.createObjectURL(N),K=document.createElement("a");K.href=h,K.download="corporatepay-collections-config.json",K.click(),URL.revokeObjectURL(h),r({title:"Exported",message:"Collections config JSON downloaded.",kind:"success"})};return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(y_,{toasts:l,onDismiss:A=>n(N=>N.filter(h=>h.id!==A))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:pg.green},children:e.jsx(Fo,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Collections, Reminders and Enforcement"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Automated dunning, multi-channel reminders, service suspension, reactivation, escalation routing, and billing dispute SLAs."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(xt,{label:`Enforcement: ${w.mode}`,tone:wc(w.mode)}),e.jsx(xt,{label:`Predicted risk: ${me}`,tone:N_(me)}),e.jsx(xt,{label:`Health: ${fe}/100`,tone:fe>=75?"good":fe>=45?"warn":"bad"}),e.jsx(xt,{label:`Disputes SLA: ${ne.complianceFirst}% first response`,tone:ne.complianceFirst>=90?"good":"warn"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Gt,{variant:"outline",onClick:()=>a(Date.now()),children:[e.jsx(Mr,{className:"h-4 w-4"})," Refresh time"]}),e.jsxs(Gt,{variant:"outline",onClick:se,children:[e.jsx(sl,{className:"h-4 w-4"})," Run scheduler"]}),e.jsxs(Gt,{variant:H.freezeAllServices?"danger":"outline",onClick:()=>{Y(A=>({...A,freezeAllServices:!A.freezeAllServices})),r({title:H.freezeAllServices?"Freeze disabled":"Freeze enabled",message:H.freezeAllServices?"Services can resume if no overdue triggers.":"CorporatePay is frozen until disabled.",kind:H.freezeAllServices?"info":"warn"})},children:[H.freezeAllServices?e.jsx(So,{className:"h-4 w-4"}):e.jsx(ia,{className:"h-4 w-4"})," Freeze"]}),e.jsxs(Gt,{variant:"outline",onClick:()=>Le(!0),children:[e.jsx(ht,{className:"h-4 w-4"})," Send now"]}),e.jsxs(Gt,{variant:"outline",onClick:M,children:[e.jsx(pt,{className:"h-4 w-4"})," Export config"]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.jsx(Nc,{title:"Outstanding",value:Be.map(A=>vm(A.balance,A.currency)).join("  "),sub:"All invoices",icon:e.jsx(Er,{className:"h-5 w-5"}),tone:Be.some(A=>A.balance>0)?"neutral":"good"}),e.jsx(Nc,{title:"Overdue invoices",value:`${Ve.length}`,sub:Ve.length?`Max ${w.maxOverdueDays} day(s)`:"No overdue",icon:e.jsx(Et,{className:"h-5 w-5"}),tone:Ve.length?"bad":"good"}),e.jsx(Nc,{title:"Due soon",value:`${Ye.length}`,sub:"Within 3 days",icon:e.jsx(Dn,{className:"h-5 w-5"}),tone:Ye.length?"warn":"good"}),e.jsx(Nc,{title:"Pending final notices",value:`${B.length}`,sub:`Threshold ${H.finalNoticeAfterOverdueDays} day(s)`,icon:e.jsx(yt,{className:"h-5 w-5"}),tone:B.length?"warn":"good"}),e.jsx(Nc,{title:"Delivery failures",value:`${Me}`,sub:"Across channels",icon:e.jsx(yi,{className:"h-5 w-5"}),tone:Me?"warn":"good"}),e.jsx(Nc,{title:"Disputes",value:`${ne.openCount} open`,sub:`${ne.complianceResolution}% resolution SLA`,icon:e.jsx(ny,{className:"h-5 w-5"}),tone:ne.openCount?"warn":"good"})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"overview",label:"Overview"},{id:"dunning",label:"Dunning schedules"},{id:"reminders",label:"Reminders and logs"},{id:"enforcement",label:"Enforcement"},{id:"escalation",label:"Escalation routing"},{id:"health",label:"Health and SLA"}].map(A=>e.jsx("button",{className:Fs("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",i===A.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:i===A.id?{background:pg.green}:void 0,onClick:()=>o(A.id),children:A.label},A.id))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[i==="overview"?e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs(Ms,{title:"Collections queue",subtitle:"Prioritize overdue items and upcoming due reminders.",right:e.jsx(xt,{label:`${Ae.length} unpaid`,tone:Ae.length?"warn":"good"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Invoice"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Entity"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Due"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Balance"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Reminders"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[C.filter(A=>A.balance>0&&A.status!=="Draft").slice().sort((A,N)=>{const h=Math.max(0,Math.floor((s-A.dueDate)/T));return Math.max(0,Math.floor((s-N.dueDate)/T))-h}).map(A=>{const N=j[A.entityId],h=g[A.invoiceGroupId],K=Math.max(0,Math.floor((s-A.dueDate)/T)),_=K>=H.fullStopAfterOverdueDays?"bad":K>=H.softPauseAfterOverdueDays?"warn":"neutral",ke=(N==null?void 0:N.currency)||"UGX";return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:A.invoiceNo}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:A.id}),A.openDisputes?e.jsx("div",{className:"mt-2",children:e.jsx(xt,{label:`${A.openDisputes} dispute`,tone:"warn"})}):null]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(N==null?void 0:N.name)||A.entityId}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(h==null?void 0:h.name)||A.invoiceGroupId}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(xt,{label:bc(A.dueDate),tone:_}),e.jsx("div",{className:"text-xs text-slate-500",children:K>0?`${K} day(s) overdue`:`${Math.max(0,Math.ceil((A.dueDate-s)/T))} day(s) to due`})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(xt,{label:A.status,tone:lb(A.status)})}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:vm(A.balance,ke)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:A.lastReminderAt?e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Last"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:X4(A.lastReminderAt)})]}):e.jsx(xt,{label:"None",tone:"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"flex justify-end",children:e.jsx(QE,{actions:[{label:"Open invoice",icon:e.jsx(et,{className:"h-4 w-4"}),onClick:()=>V(A.id)},{label:"Send reminder",icon:e.jsx(ht,{className:"h-4 w-4"}),onClick:()=>{var I;ge({invoiceId:A.id,stageId:((I=F[0])==null?void 0:I.id)||"STG-1",note:"Manual"}),Le(!0)}},{label:"Mark as paid",icon:e.jsx(tt,{className:"h-4 w-4"}),onClick:()=>E(A.id)}]})})})]},A.id)}),Ae.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-12 text-center text-sm text-slate-600",children:"No unpaid invoices."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Core: upcoming due, overdue, and final notice reminders. Premium: escalation routing and health score."})]}),e.jsxs(Ms,{title:"Enforcement summary",subtitle:"Service suspension rules and reactivation after payment.",right:e.jsx(xt,{label:w.mode,tone:wc(w.mode)}),children:[e.jsxs("div",{className:Fs("rounded-3xl border p-4",w.mode==="Full stopped"?"border-rose-200 bg-rose-50":w.mode==="Soft paused"?"border-amber-200 bg-amber-50":"border-emerald-200 bg-emerald-50"),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:w.mode}),e.jsx("div",{className:"mt-1 text-xs text-slate-700",children:w.reason}),e.jsxs("div",{className:"mt-2 text-xs text-slate-700",children:["Scope:"," ",e.jsx("span",{className:"font-semibold",children:H.scope})]})]}),e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-white/60 text-slate-700 ring-1 ring-slate-200",children:e.jsx(yt,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"mt-3 text-xs text-slate-700",children:["Soft pause: CorporatePay is paused and users may be prompted to pay first.",e.jsx("br",{}),"Full stop: corporate-funded services are stopped until compliant."]})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2",children:[e.jsx(bm,{enabled:H.enabled,onChange:A=>Y(N=>({...N,enabled:A})),label:"Enable enforcement",description:"Applies suspension rules based on overdue and risk controls."}),e.jsx(bm,{enabled:H.autoReactivateAfterPayment,onChange:A=>Y(N=>({...N,autoReactivateAfterPayment:A})),label:"Auto-reactivate after payment",description:"When balances are cleared, services can resume automatically."})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Gt,{variant:"outline",onClick:()=>o("enforcement"),children:[e.jsx(et,{className:"h-4 w-4"})," Configure"]}),e.jsxs(Gt,{variant:"outline",onClick:()=>{H.freezeAllServices?(Y(A=>({...A,freezeAllServices:!1})),r({title:"Freeze disabled",message:"Enforcement can now resume normal evaluation.",kind:"info"})):r({title:"Not frozen",message:"Risk freeze is not enabled.",kind:"info"})},children:[e.jsx(So,{className:"h-4 w-4"})," Unfreeze"]})]})]}),e.jsx(Ms,{title:"Channel delivery health",subtitle:"Delivery status per channel with logs.",right:e.jsxs(Gt,{variant:"outline",onClick:()=>o("reminders"),children:[e.jsx(et,{className:"h-4 w-4"})," Open logs"]}),children:e.jsx("div",{className:"grid grid-cols-1 gap-4",children:t.map(A=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-slate-900",children:[e.jsx("span",{className:"text-slate-600",children:yc(A)})," ",A]}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Delivered"}),e.jsx("div",{className:"mt-1 text-lg font-semibold text-slate-900",children:ue[A].delivered})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsx(xt,{label:`Failed ${ue[A].failed}`,tone:ue[A].failed?"warn":"good"}),e.jsx(xt,{label:`Queued ${ue[A].queued}`,tone:"neutral"})]})]})},A))})}),e.jsxs(Ms,{title:"Escalation ladder",subtitle:"Premium: finance to CFO to EVzone support.",right:e.jsx(xt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"space-y-4",children:Ue.map((A,N)=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:["Step ",N+1,": ",A.level]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Notify: ",A.notify.join(", ")]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[jm(A.level,y).slice(0,3).map(h=>e.jsx(xt,{label:h.name,tone:"neutral"},h.id)),jm(A.level,y).length?null:e.jsx(xt,{label:"No contacts",tone:"warn"})]})]}),e.jsx(ht,{className:"h-5 w-5 text-emerald-700"})]})},A.level))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Escalation routing can be customized per stage in the Escalation tab."})]})]}):null,i==="dunning"?e.jsxs("div",{className:"flex flex-col-reverse gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Ms,{title:"Dunning schedules",subtitle:"Upcoming due, overdue, and final notice. Configure channels and actions per stage.",right:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Gt,{variant:"outline",onClick:m,children:[e.jsx(gt,{className:"h-4 w-4"})," Template"]}),e.jsxs(Gt,{variant:"primary",onClick:D,children:[e.jsx(gt,{className:"h-4 w-4"})," Stage"]})]}),children:[e.jsxs("div",{className:"space-y-2",children:[F.slice().sort((A,N)=>A.offsetDaysFromDue-N.offsetDaysFromDue).map(A=>{const N=L.find(h=>h.id===A.templateId);return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:A.name}),e.jsx(xt,{label:A.trigger,tone:"neutral"}),e.jsx(xt,{label:`Offset ${A.offsetDaysFromDue}d`,tone:"info"}),e.jsx(xt,{label:A.escalation,tone:A.escalation==="EVzone Support"?"warn":"neutral"}),e.jsx(xt,{label:A.action,tone:A.action==="Full stop"?"bad":A.action==="Soft pause"?"warn":"neutral"}),e.jsx(xt,{label:A.enabled?"Enabled":"Off",tone:A.enabled?"good":"neutral"})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Template: ",e.jsx("span",{className:"font-semibold",children:(N==null?void 0:N.name)||A.templateId})]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:t.map(h=>e.jsx(xt,{label:h,tone:A.channels[h]?"good":"neutral"},h))})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Gt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>re(A),children:[e.jsx(Uo,{className:"h-4 w-4"})," Edit"]}),e.jsxs(Gt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>te(h=>h.map(K=>K.id===A.id?{...K,enabled:!K.enabled}:K)),children:[A.enabled?e.jsx(ia,{className:"h-4 w-4"}):e.jsx(So,{className:"h-4 w-4"})," ",A.enabled?"Disable":"Enable"]}),e.jsx(Gt,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>k(A.id),children:e.jsx(as,{className:"h-4 w-4"})})]})]})},A.id)}),F.length?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No stages configured."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Best practice: ensure final notice includes all channels and escalates to CFO. EVzone support escalation is optional."})]}),e.jsx(Ms,{title:"Templates",subtitle:"Premium: templates can be branded and channel-aware.",right:e.jsx(xt,{label:`${L.length}`,tone:"neutral"}),children:e.jsx("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:L.map(A=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:A.name}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:A.id}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:t.map(N=>e.jsx(xt,{label:N,tone:A.enabledChannels[N]?"good":"neutral"},N))})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(Gt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>S(A),children:[e.jsx(Uo,{className:"h-4 w-4"})," Edit"]}),e.jsx(Gt,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>U(A.id),children:e.jsx(as,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[e.jsx("div",{className:"font-semibold",children:"Subject"}),e.jsx("div",{className:"mt-1 text-slate-700",children:A.subject}),e.jsx("div",{className:"mt-3 font-semibold",children:"Body"}),e.jsx("div",{className:"mt-1 text-slate-700",children:A.body})]})]},A.id))})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Ms,{title:"Runbook",subtitle:"How dunning is executed.",right:e.jsx(xt,{label:"Core",tone:"neutral"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"1) Scheduler checks invoices and stage trigger times"}),e.jsx("li",{children:"2) Stage channels send to escalation recipients"}),e.jsx("li",{children:"3) Delivery logs are recorded per channel"}),e.jsx("li",{children:"4) Enforcement evaluates overdue thresholds and risk freeze"}),e.jsx("li",{children:"5) Payment triggers reactivation when configured"})]})}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Gt,{variant:"primary",onClick:se,children:[e.jsx(sl,{className:"h-4 w-4"})," Run scheduler"]}),e.jsxs(Gt,{variant:"outline",onClick:()=>Le(!0),children:[e.jsx(ht,{className:"h-4 w-4"})," Send now"]})]})]}),e.jsxs(Ms,{title:"Enforcement mapping",subtitle:"Soft pause vs full stop per stage.",right:e.jsx(xt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"space-y-2",children:F.slice().sort((A,N)=>A.offsetDaysFromDue-N.offsetDaysFromDue).map(A=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:A.name}),e.jsxs("div",{className:"mt-0.5 text-xs text-slate-500",children:["Action: ",A.action]})]}),e.jsx(xt,{label:A.action,tone:A.action==="Full stop"?"bad":A.action==="Soft pause"?"warn":"neutral"})]})},A.id))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: enforcement is also driven by global thresholds in the Enforcement tab."})]})]})]}):null,i==="reminders"?e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Ms,{title:"Filters",subtitle:"Search delivery logs.",right:e.jsx(xt,{label:"Core",tone:"neutral"}),children:[e.jsx(sb,{label:"Search",value:Oe,onChange:Se,placeholder:"invoice, stage, to..."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(ur,{label:"Channel",value:Te,onChange:A=>Ge(A),options:[{value:"All",label:"All"},...t.map(A=>({value:A,label:A}))]}),e.jsx(ur,{label:"Status",value:We,onChange:A=>ze(A),options:[{value:"All",label:"All"},{value:"Delivered",label:"Delivered"},{value:"Failed",label:"Failed"},{value:"Queued",label:"Queued"}]})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:[e.jsxs(Gt,{variant:"outline",onClick:p,children:[e.jsx(pt,{className:"h-4 w-4"})," Export CSV"]}),e.jsxs(Gt,{variant:"outline",onClick:()=>{Se(""),Ge("All"),ze("All"),r({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(vn,{className:"h-4 w-4"})," Reset"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Delivery logs show per-channel status for Email, WhatsApp, WeChat, and SMS."})]}),e.jsx(Ms,{title:"Channel health",subtitle:"Delivery status summary.",right:e.jsx(xt,{label:"Premium",tone:"info"}),children:e.jsx("div",{className:"space-y-2",children:t.map(A=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-slate-900",children:[e.jsx("span",{className:"text-slate-600",children:yc(A)})," ",A]}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Delivered"}),e.jsx("div",{className:"mt-1 text-lg font-semibold text-slate-900",children:ue[A].delivered})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsx(xt,{label:`Failed ${ue[A].failed}`,tone:ue[A].failed?"warn":"good"}),e.jsx(xt,{label:`Queued ${ue[A].queued}`,tone:"neutral"})]})]})},A))})})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs(Ms,{title:"Delivery logs",subtitle:"Audit-ready logs per channel.",right:e.jsx(xt,{label:`${Xe.length}`,tone:"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Invoice"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Stage"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Channel"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"To"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Details"})]})}),e.jsxs("tbody",{children:[Xe.map(A=>{const N=C.find(K=>K.id===A.invoiceId),h=F.find(K=>K.id===A.stageId);return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:tb(A.createdAt)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("button",{className:"text-left",onClick:()=>N&&V(N.id),children:[e.jsx("div",{className:"font-semibold text-slate-900",children:(N==null?void 0:N.invoiceNo)||A.invoiceId}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:(N==null?void 0:N.status)||"-"})]})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(h==null?void 0:h.name)||A.stageId}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:"inline-flex items-center gap-2 text-slate-700",children:[e.jsx("span",{className:"text-slate-600",children:yc(A.channel)}),A.channel]})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:A.to}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(xt,{label:A.status,tone:A.status==="Delivered"?"good":A.status==="Failed"?"warn":"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:A.error||"-"})]},A.id)}),Xe.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-12 text-center text-sm text-slate-600",children:"No delivery logs."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: failed deliveries can trigger escalation routing and alternate channels."})]})})]}):null,i==="enforcement"?e.jsxs("div",{className:"flex flex-col-reverse gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ms,{title:"Simulation",subtitle:"Preview enforcement actions.",right:e.jsxs(Gt,{variant:"outline",onClick:()=>r({title:"Simulation",message:"Preview updated.",kind:"info"}),children:[e.jsx(Mr,{className:"h-4 w-4"})," Run"]}),children:e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-4",children:(()=>{const A=K4(C,H,s);return e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:Fs("grid h-10 w-10 place-items-center rounded-2xl bg-slate-50",wc(A.mode)==="bad"?"bg-rose-100 text-rose-700":wc(A.mode)==="warn"?"bg-amber-100 text-amber-800":"bg-emerald-100 text-emerald-700"),children:A.mode==="Active"?e.jsx(tt,{className:"h-5 w-5"}):A.mode==="Soft paused"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(ia,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:A.mode}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:A.reason})]})]})})()})}),e.jsx(Ms,{title:"Enforcement audit log",subtitle:"Recent automated actions.",right:e.jsx(xt,{label:"5 events",tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 text-xs text-slate-600",children:[e.jsx("span",{className:"font-semibold text-slate-900",children:bc(s-2*24*3600*1e3)}),": System changed status from Active to Soft paused (Risk alert)."]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 text-xs text-slate-600",children:[e.jsx("span",{className:"font-semibold text-slate-900",children:bc(s-5*24*3600*1e3)}),": Payment received (INV-001). Enforcement restored to Active."]})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Ms,{title:"Service suspension rules",subtitle:"Soft pause vs full stop. Reactivation after payment.",right:e.jsx(xt,{label:w.mode,tone:wc(w.mode)}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(bm,{enabled:H.enabled,onChange:A=>Y(N=>({...N,enabled:A})),label:"Enable enforcement",description:"Evaluates overdue and risk freeze rules."}),e.jsx(bm,{enabled:H.autoReactivateAfterPayment,onChange:A=>Y(N=>({...N,autoReactivateAfterPayment:A})),label:"Auto-reactivate after payment",description:"When balances clear, services can resume."}),e.jsx(jc,{label:"Soft pause after overdue days",value:H.softPauseAfterOverdueDays,onChange:A=>Y(N=>({...N,softPauseAfterOverdueDays:Math.max(0,A)})),hint:"Example: 3",disabled:!H.enabled}),e.jsx(jc,{label:"Full stop after overdue days",value:H.fullStopAfterOverdueDays,onChange:A=>Y(N=>({...N,fullStopAfterOverdueDays:Math.max(0,A)})),hint:"Example: 10",disabled:!H.enabled}),e.jsx(jc,{label:"Final notice after overdue days",value:H.finalNoticeAfterOverdueDays,onChange:A=>Y(N=>({...N,finalNoticeAfterOverdueDays:Math.max(0,A)})),hint:"Triggers stage and escalation",disabled:!H.enabled}),e.jsx(ur,{label:"Enforcement scope",value:H.scope,onChange:A=>Y(N=>({...N,scope:A})),options:[{value:"CorporatePay only",label:"CorporatePay only"},{value:"All services",label:"All services"}],hint:"Soft pause affects checkout",disabled:!H.enabled})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Current evaluation"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Computed from invoices and rules."})]}),e.jsx(xt,{label:w.mode,tone:wc(w.mode)})]}),e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:w.reason}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Max overdue: ",w.maxOverdueDays," day(s)  Overdue invoices: ",w.overdueCount]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Gt,{variant:H.freezeAllServices?"danger":"outline",onClick:()=>Y(A=>({...A,freezeAllServices:!A.freezeAllServices})),children:[H.freezeAllServices?e.jsx(So,{className:"h-4 w-4"}):e.jsx(ia,{className:"h-4 w-4"})," Risk freeze"]}),e.jsxs(Gt,{variant:"outline",onClick:()=>{W(A=>A.map(N=>N.balance>0&&N.status!=="Draft"?{...N,status:"Sent"}:N)),r({title:"Simulated",message:"Simulated compliance for unpaid invoices (demo).",kind:"info"})},children:[e.jsx(ht,{className:"h-4 w-4"})," Simulate compliance"]})]})]}),e.jsx("div",{className:"mt-4 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Reactivation occurs after payment when auto-reactivate is enabled and risk freeze is off."})]}),e.jsx(Ms,{title:"Reactivation after payment",subtitle:"Mark overdue invoices paid and observe the enforcement state.",right:e.jsx(xt,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[Ve.slice(0,5).map(A=>{const N=A.inv,h=j[N.entityId],K=(h==null?void 0:h.currency)||"UGX";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:N.invoiceNo}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[A.overdueDays," day(s) overdue  Balance ",vm(N.balance,K)]})]}),e.jsxs(Gt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>E(N.id),children:[e.jsx(tt,{className:"h-4 w-4"})," Mark paid"]})]})},N.id)}),Ve.length?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No overdue invoices."})]})})]}),e.jsxs("div",{className:"lg:col-span-5 space-y-4",children:[e.jsx(Ms,{title:"Soft pause vs full stop",subtitle:"What each mode does.",right:e.jsx(xt,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Soft pause"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"CorporatePay is paused. Reminders continue. Users are prompted to resolve payment."})]}),e.jsx(xt,{label:"Soft paused",tone:"warn"})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Typical triggers: overdue beyond ",H.softPauseAfterOverdueDays," day(s), dispute in review, repeated reminder failures."]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Full stop"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Corporate-funded services are stopped until compliant. Escalations fire."})]}),e.jsx(xt,{label:"Full stopped",tone:"bad"})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Typical triggers: overdue beyond ",H.fullStopAfterOverdueDays," day(s), risk freeze, repeated failed collections."]})]})]})}),e.jsxs(Ms,{title:"Escalation integration",subtitle:"When enforcement changes, routing escalates.",right:e.jsx(xt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"1) Upcoming due reminders go to Finance"}),e.jsx("li",{children:"2) Overdue reminders escalate to Finance and optionally CFO"}),e.jsx("li",{children:"3) Final notice escalates to CFO"}),e.jsx("li",{children:"4) Extended delinquency can involve EVzone support"})]})}),e.jsx("div",{className:"mt-3",children:e.jsxs(Gt,{variant:"outline",onClick:()=>o("escalation"),children:[e.jsx(et,{className:"h-4 w-4"})," Open routing"]})})]})]})]}):null,i==="escalation"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-7 space-y-4",children:[e.jsxs(Ms,{title:"Escalation routing",subtitle:"Premium: finance to CFO to EVzone support.",right:e.jsx(xt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"space-y-2",children:F.slice().sort((A,N)=>A.offsetDaysFromDue-N.offsetDaysFromDue).map(A=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:A.name}),e.jsx(xt,{label:A.trigger,tone:"neutral"}),e.jsx(xt,{label:`Offset ${A.offsetDaysFromDue}d`,tone:"info"}),e.jsx(xt,{label:`Escalation ${A.escalation}`,tone:A.escalation==="EVzone Support"?"warn":"neutral"})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Recipients: ",jm(A.escalation,y).map(N=>N.name).join(", ")||"None"]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:t.map(N=>e.jsx(xt,{label:N,tone:A.channels[N]?"good":"neutral"},N))})]}),e.jsxs(Gt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>re(A),children:[e.jsx(Uo,{className:"h-4 w-4"})," Edit stage"]})]})},A.id))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Escalation routing can include EVzone support as a role-gated support desk."})]}),e.jsxs(Ms,{title:"Contacts",subtitle:"Configure who receives reminders and escalations.",right:e.jsx(xt,{label:`${y.length}`,tone:"neutral"}),children:[e.jsx("div",{className:"space-y-2",children:y.map(A=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:A.name}),e.jsx(xt,{label:A.role,tone:A.role==="EVzone Support"?"warn":"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[A.email,"  ",A.phone]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:t.map(N=>e.jsx(xt,{label:N,tone:A.channels[N]?"good":"neutral"},N))})]}),e.jsxs(Gt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{$(N=>N.map(h=>h.id===A.id?{...h,channels:{...h.channels,WhatsApp:!h.channels.WhatsApp}}:h)),r({title:"Updated",message:"Updated contact channels (demo).",kind:"info"})},children:[e.jsx(Os,{className:"h-4 w-4"})," Toggle WhatsApp"]})]})},A.id))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"In production, contacts come from Billing Contacts (D) and Invoice Groups (N)."})]})]}),e.jsxs("div",{className:"lg:col-span-5 space-y-4",children:[e.jsxs(Ms,{title:"Routing ladder",subtitle:"Premium: who gets notified by escalation level.",right:e.jsx(xt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"space-y-2",children:Ue.map((A,N)=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:["Step ",N+1,": ",A.level]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Notify channels: ",A.notify.join(", ")]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:jm(A.level,y).map(h=>e.jsx(xt,{label:h.name,tone:"neutral"},h.id))})]}),e.jsx(ht,{className:"h-5 w-5 text-emerald-700"})]}),e.jsx("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:t.map(h=>{const K=A.notify.includes(h);return e.jsxs("button",{type:"button",className:Fs("inline-flex items-center gap-2 rounded-2xl border px-3 py-2 text-xs font-semibold",K?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),onClick:()=>{le(_=>_.map(ke=>{if(ke.level!==A.level)return ke;const I=new Set(ke.notify);return I.has(h)?I.delete(h):I.add(h),{...ke,notify:Array.from(I)}}))},children:[e.jsx("span",{className:"text-slate-600",children:yc(h)}),h]},h)})})]},A.level))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: routing can escalate based on repeated failures and dispute SLA breaches."})]}),e.jsx(Ms,{title:"Test routing",subtitle:"Pick an invoice and stage to simulate send.",right:e.jsx(xt,{label:"Demo",tone:"neutral"}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx(ur,{label:"Invoice",value:Ne.invoiceId,onChange:A=>ge(N=>({...N,invoiceId:A})),options:C.map(A=>({value:A.id,label:A.invoiceNo}))}),e.jsx(ur,{label:"Stage",value:Ne.stageId,onChange:A=>ge(N=>({...N,stageId:A})),options:F.map(A=>({value:A.id,label:`${A.name} (${A.offsetDaysFromDue}d)`}))}),e.jsxs(Gt,{variant:"primary",onClick:()=>{P(Ne.invoiceId,Ne.stageId,"Routing test"),o("reminders")},children:[e.jsx(ht,{className:"h-4 w-4"})," Send test"]})]})})]})]}):null,i==="health"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-5 space-y-4",children:[e.jsxs(Ms,{title:"Customer health score",subtitle:"Premium: risk score and predicted delinquency.",right:e.jsx(xt,{label:`${fe}/100`,tone:fe>=75?"good":fe>=45?"warn":"bad"}),children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Predicted risk"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:me}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Based on overdue, disputes, and delivery failures"})]}),e.jsx("div",{className:Fs("grid h-12 w-12 place-items-center rounded-2xl ring-1",me==="High"?"bg-rose-50 text-rose-700 ring-rose-200":me==="Medium"?"bg-amber-50 text-amber-800 ring-amber-200":"bg-emerald-50 text-emerald-700 ring-emerald-200"),children:e.jsx(ht,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3",children:[e.jsx(ee,{label:"Max overdue days",value:`${w.maxOverdueDays}`,tone:w.maxOverdueDays>=H.fullStopAfterOverdueDays?"bad":w.maxOverdueDays>=H.softPauseAfterOverdueDays?"warn":"good"}),e.jsx(ee,{label:"Overdue invoices",value:`${Ve.length}`,tone:Ve.length?"warn":"good"}),e.jsx(ee,{label:"Open disputes",value:`${je.filter(A=>A.status==="Open"||A.status==="In review").length}`,tone:ne.openCount?"warn":"good"}),e.jsx(ee,{label:"Delivery failures",value:`${Me}`,tone:Me?"warn":"good"}),e.jsx(ee,{label:"Final notice candidates",value:`${B.length}`,tone:B.length?"warn":"good"})]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: predicted delinquency can be improved with real historical payment patterns and external signals."})]}),e.jsxs(Ms,{title:"Dispute SLA controls",subtitle:"Premium: SLA compliance tracking for billing disputes.",right:e.jsx(xt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(jc,{label:"First response SLA (hours)",value:we.firstResponseHours,onChange:A=>q(N=>({...N,firstResponseHours:Math.max(1,A)}))}),e.jsx(jc,{label:"Resolution SLA (hours)",value:we.resolutionHours,onChange:A=>q(N=>({...N,resolutionHours:Math.max(1,A)}))})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"First response compliance"}),e.jsxs("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:[ne.complianceFirst,"%"]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Breaches: ",ne.firstRespBreaches.length]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Resolution compliance"}),e.jsxs("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:[ne.complianceResolution,"%"]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Breaches: ",ne.resolutionBreaches.length]})]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Gt,{variant:"primary",onClick:()=>ie(!0),children:[e.jsx(ny,{className:"h-4 w-4"})," View disputes"]}),e.jsxs(Gt,{variant:"outline",onClick:()=>{const A="DSP-011";_e(N=>N.map(h=>h.id===A?{...h,firstResponseAt:Date.now(),lastUpdatedAt:Date.now(),status:"In review"}:h)),r({title:"Updated",message:"Simulated first response on a dispute.",kind:"success"})},children:[e.jsx(ht,{className:"h-4 w-4"})," Simulate response"]})]})]})]}),e.jsxs("div",{className:"lg:col-span-7 space-y-4",children:[e.jsx(Ms,{title:"Recommendations",subtitle:"Premium next-best actions.",right:e.jsx(xt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{title:"Run scheduler",detail:"Send upcoming and overdue reminders across channels.",cta:"Run now",onClick:se}),e.jsx(b,{title:"Escalate final notices",detail:`There are ${B.length} invoice(s) past the final notice threshold.`,cta:"Open dunning",onClick:()=>o("dunning")}),e.jsx(b,{title:"Fix delivery failures",detail:`There are ${Me} failed delivery attempts. Enable alternate channels or correct contact info.`,cta:"Open logs",onClick:()=>o("reminders")}),e.jsx(b,{title:"Dispute SLA",detail:`Open disputes: ${ne.openCount}. First response compliance: ${ne.complianceFirst}%.`,cta:"Open SLA",onClick:()=>ie(!0)}),e.jsx(b,{title:"Enforcement rules",detail:`Current mode: ${w.mode}. Review thresholds and scope.`,cta:"Configure",onClick:()=>o("enforcement")})]})}),e.jsxs(Ms,{title:"Multi-channel coverage",subtitle:"Automated reminders via Email, WhatsApp, WeChat, and SMS.",right:e.jsx(xt,{label:"Core",tone:"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Stage"}),t.map(A=>e.jsx("th",{className:"px-4 py-3 font-semibold",children:A},A)),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Escalation"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Action"})]})}),e.jsx("tbody",{children:F.slice().sort((A,N)=>A.offsetDaysFromDue-N.offsetDaysFromDue).map(A=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:A.name}),t.map(N=>e.jsx("td",{className:"px-4 py-3",children:e.jsx(xt,{label:A.channels[N]?"On":"Off",tone:A.channels[N]?"good":"neutral"})},N)),e.jsx("td",{className:"px-4 py-3",children:e.jsx(xt,{label:A.escalation,tone:A.escalation==="EVzone Support"?"warn":"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(xt,{label:A.action,tone:A.action==="Full stop"?"bad":A.action==="Soft pause"?"warn":"neutral"})})]},A.id))})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"For best results, enable at least two channels per stage and validate contact preferences."})]})]})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"P Collections, Reminders and Enforcement v2. Core: automated reminders on Email, WhatsApp, WeChat, SMS; dunning schedules; service suspension; reactivation after payment. Premium: escalation routing; customer health and predicted risk; dispute SLA compliance."})})]})}),e.jsx(Sh,{open:Ee,title:Fe.id?"Edit dunning stage":"New dunning stage",subtitle:"Configure trigger timing, channels, escalation routing, and enforcement action.",onClose:()=>be(!1),actions:[{label:"Save",onClick:v}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Gt,{variant:"outline",onClick:()=>be(!1),children:"Cancel"}),e.jsxs(Gt,{variant:"primary",onClick:v,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(sb,{label:"Name",value:Fe.name,onChange:A=>Pe(N=>({...N,name:A})),placeholder:"Overdue reminder"}),e.jsx(bm,{enabled:Fe.enabled,onChange:A=>Pe(N=>({...N,enabled:A})),label:"Enabled",description:"If off, scheduler will skip it."}),e.jsx(ur,{label:"Trigger",value:Fe.trigger,onChange:A=>Pe(N=>({...N,trigger:A})),options:[{value:"Upcoming due",label:"Upcoming due"},{value:"Overdue",label:"Overdue"},{value:"Final notice",label:"Final notice"}]}),e.jsx(jc,{label:"Offset days from due",value:Fe.offsetDaysFromDue,onChange:A=>Pe(N=>({...N,offsetDaysFromDue:A})),hint:"Negative means before due"}),e.jsx(ur,{label:"Template",value:Fe.templateId,onChange:A=>Pe(N=>({...N,templateId:A})),options:L.map(A=>({value:A.id,label:A.name}))}),e.jsx(ur,{label:"Escalation",value:Fe.escalation,onChange:A=>Pe(N=>({...N,escalation:A})),options:[{value:"Finance",label:"Finance"},{value:"CFO",label:"CFO"},{value:"EVzone Support",label:"EVzone Support"}]}),e.jsx(ur,{label:"Enforcement action",value:Fe.action,onChange:A=>Pe(N=>({...N,action:A})),options:[{value:"None",label:"None"},{value:"Soft pause",label:"Soft pause"},{value:"Full stop",label:"Full stop"}]}),e.jsxs("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Channels"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Select the channels to send this stage."}),e.jsx("div",{className:"mt-3 grid grid-cols-2 gap-2 sm:grid-cols-4",children:t.map(A=>{const N=Fe.channels[A];return e.jsxs("button",{type:"button",className:Fs("flex items-center justify-between gap-2 rounded-2xl border px-3 py-2 text-sm font-semibold",N?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),onClick:()=>Pe(h=>({...h,channels:{...h.channels,[A]:!h.channels[A]}})),children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:Fs("text-slate-600",N&&"text-emerald-700"),children:yc(A)}),A]}),e.jsx(xt,{label:N?"On":"Off",tone:N?"good":"neutral"})]},A)})})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs(Gt,{variant:"outline",className:"w-full",onClick:()=>{be(!1),r({title:"Tip",message:"Use Send now to test a stage.",kind:"info"})},children:[e.jsx(ht,{className:"h-4 w-4"})," Save and test later"]})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Note: stage actions are guidance. Global enforcement rules still apply."})]})}),e.jsx(Sh,{open:pe,title:Re.id?"Edit template":"New template",subtitle:"Templates support placeholders: {invoiceNo}, {dueDate}, {balance}, {contactName}",onClose:()=>Q(!1),actions:[{label:"Save",onClick:f}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Gt,{variant:"outline",onClick:()=>Q(!1),children:"Cancel"}),e.jsxs(Gt,{variant:"primary",onClick:f,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(sb,{label:"Name",value:Re.name,onChange:A=>ce(N=>({...N,name:A})),placeholder:"Upcoming due reminder"}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Enabled channels"}),e.jsx("div",{className:"mt-3 grid grid-cols-2 gap-2 sm:grid-cols-4",children:t.map(A=>e.jsxs("button",{type:"button",className:Fs("flex items-center justify-between gap-2 rounded-2xl border px-3 py-2 text-sm font-semibold",Re.enabledChannels[A]?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),onClick:()=>ce(N=>({...N,enabledChannels:{...N.enabledChannels,[A]:!N.enabledChannels[A]}})),children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:Fs("text-slate-600",Re.enabledChannels[A]&&"text-emerald-700"),children:yc(A)}),A]}),e.jsx(xt,{label:Re.enabledChannels[A]?"On":"Off",tone:Re.enabledChannels[A]?"good":"neutral"})]},A))})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(ab,{label:"Subject",value:Re.subject,onChange:A=>ce(N=>({...N,subject:A})),placeholder:"Upcoming invoice due: {invoiceNo}",hint:"Used for Email",rows:2})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(ab,{label:"Body",value:Re.body,onChange:A=>ce(N=>({...N,body:A})),placeholder:"Hello {contactName}...",rows:6})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: keep SMS short and actionable. Use WhatsApp for richer content."})]})}),e.jsx(Sh,{open:Ke,title:"Send reminder now",subtitle:"Manual send for a specific invoice and stage.",onClose:()=>Le(!1),actions:[{label:"Send",onClick:()=>{P(Ne.invoiceId,Ne.stageId,Ne.note||"Manual"),Le(!1)}}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Gt,{variant:"outline",onClick:()=>Le(!1),children:"Cancel"}),e.jsxs(Gt,{variant:"primary",onClick:()=>{P(Ne.invoiceId,Ne.stageId,Ne.note||"Manual"),Le(!1)},children:[e.jsx(ht,{className:"h-4 w-4"})," Send"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(ur,{label:"Invoice",value:Ne.invoiceId,onChange:A=>ge(N=>({...N,invoiceId:A})),options:C.map(A=>({value:A.id,label:A.invoiceNo}))}),e.jsx(ur,{label:"Stage",value:Ne.stageId,onChange:A=>ge(N=>({...N,stageId:A})),options:F.map(A=>({value:A.id,label:`${A.name} (${A.offsetDaysFromDue}d)`}))}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(ab,{label:"Note",value:Ne.note,onChange:A=>ge(N=>({...N,note:A})),placeholder:"Why are you sending this now",rows:3})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Manual sends are logged per channel. Duplicate sends for the same stage and channel are prevented."})]})}),e.jsx(j_,{open:xe,title:z?z.invoiceNo:"Invoice",subtitle:z?`${((ae=j[z.entityId])==null?void 0:ae.name)||z.entityId}  ${((ve=g[z.invoiceGroupId])==null?void 0:ve.name)||z.invoiceGroupId}`:"",onClose:()=>he(!1),footer:z?e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Collections actions are audit logged in production."}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Gt,{variant:"outline",onClick:()=>{var A;ge({invoiceId:z.id,stageId:((A=F[0])==null?void 0:A.id)||"STG-1",note:"Manual"}),Le(!0)},children:[e.jsx(ht,{className:"h-4 w-4"})," Remind"]}),e.jsxs(Gt,{variant:"primary",onClick:()=>E(z.id),children:[e.jsx(tt,{className:"h-4 w-4"})," Mark paid"]})]})]}):null,children:z?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(xt,{label:z.status,tone:lb(z.status)}),e.jsx(xt,{label:`Issue ${bc(z.issueDate)}`,tone:"neutral"}),e.jsx(xt,{label:`Due ${bc(z.dueDate)}`,tone:z.status==="Overdue"?"bad":"neutral"}),z.openDisputes?e.jsx(xt,{label:`${z.openDisputes} dispute`,tone:"warn"}):null]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Last reminder: ",z.lastReminderAt?X4(z.lastReminderAt):"None"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Balance"}),e.jsx("div",{className:"mt-1 text-lg font-semibold text-slate-900",children:vm(z.balance,((O=j[z.entityId])==null?void 0:O.currency)||"UGX")}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Total: ",vm(z.total,((X=j[z.entityId])==null?void 0:X.currency)||"UGX")]})]})]})}),e.jsx(Ms,{title:"Dunning timeline",subtitle:"Stages evaluated based on due date and offsets.",right:e.jsx(xt,{label:"Core",tone:"neutral"}),children:e.jsx("div",{className:"space-y-2",children:F.slice().sort((A,N)=>A.offsetDaysFromDue-N.offsetDaysFromDue).map(A=>{const N=z.dueDate+A.offsetDaysFromDue*T,h=oe.some(_=>_.invoiceId===z.id&&_.stageId===A.id),K=s>=N;return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:A.name}),e.jsx(xt,{label:`Offset ${A.offsetDaysFromDue}d`,tone:"info"}),e.jsx(xt,{label:K?"Eligible":"Not yet",tone:K?"warn":"neutral"}),e.jsx(xt,{label:h?"Sent":"Not sent",tone:h?"good":"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Trigger time: ",bc(N)]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:t.map(_=>e.jsx(xt,{label:_,tone:A.channels[_]?"good":"neutral"},_))})]}),e.jsxs(Gt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>P(z.id,A.id,"From invoice"),disabled:!A.enabled,children:[e.jsx(ht,{className:"h-4 w-4"})," Send"]})]})},A.id)})})}),e.jsx(Ms,{title:"Delivery records",subtitle:"Logs for this invoice.",right:e.jsx(xt,{label:"Core",tone:"neutral"}),children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Stage"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Channel"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"To"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Error"})]})}),e.jsxs("tbody",{children:[oe.filter(A=>A.invoiceId===z.id).slice().sort((A,N)=>N.createdAt-A.createdAt).map(A=>{var N;return e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:tb(A.createdAt)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:((N=F.find(h=>h.id===A.stageId))==null?void 0:N.name)||A.stageId}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:A.channel}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:A.to}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(xt,{label:A.status,tone:A.status==="Delivered"?"good":A.status==="Failed"?"warn":"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:A.error||"-"})]},A.id)}),oe.some(A=>A.invoiceId===z.id)?null:e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No delivery logs for this invoice."})})]})]})})})]}):null}),e.jsx(Sh,{open:$e,title:"Billing disputes SLA",subtitle:"Premium: SLA compliance tracking for billing disputes.",onClose:()=>ie(!1),footer:e.jsx("div",{className:"flex justify-end",children:e.jsx(Gt,{variant:"outline",onClick:()=>ie(!1),children:"Close"})}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Open disputes"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:ne.openCount}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Including In review"})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"First response breaches"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:ne.firstRespBreaches.length}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["SLA ",we.firstResponseHours,"h"]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Resolution breaches"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:ne.resolutionBreaches.length}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["SLA ",we.resolutionHours,"h"]})]})]}),e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Dispute"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Invoice"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Age"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"First response"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Resolution SLA"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[je.slice().sort((A,N)=>{const h=A.status==="Open"||A.status==="In review",K=N.status==="Open"||N.status==="In review";return h!==K?h?-1:1:N.createdAt-A.createdAt}).map(A=>{const N=C.find(ke=>ke.id===A.invoiceId),h=Math.round((s-A.createdAt)/(60*60*1e3)*10)/10,K=!A.firstResponseAt&&h>we.firstResponseHours&&(A.status==="Open"||A.status==="In review"),_=h>we.resolutionHours&&(A.status==="Open"||A.status==="In review");return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:A.id}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(N==null?void 0:N.invoiceNo)||A.invoiceId}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(xt,{label:A.status,tone:lb(A.status)})}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[h,"h"]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(xt,{label:A.firstResponseAt?"Done":K?"Breached":"Pending",tone:A.firstResponseAt?"good":K?"bad":"warn"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(xt,{label:_?"Breached":"OK",tone:_?"bad":"good"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Gt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{_e(ke=>ke.map(I=>I.id===A.id?{...I,firstResponseAt:I.firstResponseAt||Date.now(),lastUpdatedAt:Date.now(),status:"In review"}:I)),r({title:"Updated",message:"First response recorded.",kind:"success"})},disabled:!!A.firstResponseAt,children:[e.jsx(ht,{className:"h-4 w-4"})," First response"]}),e.jsxs(Gt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>{_e(ke=>ke.map(I=>I.id===A.id?{...I,status:"Resolved",lastUpdatedAt:Date.now()}:I)),r({title:"Resolved",message:"Dispute resolved.",kind:"success"})},disabled:A.status==="Resolved",children:[e.jsx(tt,{className:"h-4 w-4"})," Resolve"]})]})})]},A.id)}),je.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-12 text-center text-sm text-slate-600",children:"No disputes."})})]})]})}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: SLA breaches can trigger escalation routing and pause enforcement until reviewed."})]})})]});function ee({label:A,value:N,tone:h}){const K=h==="good"?"bg-emerald-50 text-emerald-900 ring-emerald-200":h==="warn"?"bg-amber-50 text-amber-900 ring-amber-200":"bg-rose-50 text-rose-900 ring-rose-200";return e.jsxs("div",{className:Fs("flex items-center justify-between gap-3 rounded-2xl p-3 text-xs ring-1",K),children:[e.jsx("div",{className:"font-semibold",children:A}),e.jsx("div",{className:"font-semibold",children:N})]})}function b({title:A,detail:N,cta:h,onClick:K}){return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:A}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:N})]}),e.jsxs(Gt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:K,children:[e.jsx(et,{className:"h-4 w-4"})," ",h]})]})})}}const hg={green:"#03CD8C",orange:"#F77F00"};function na(...t){return t.filter(Boolean).join(" ")}function lo(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function hy(t,s,a){return Math.max(s,Math.min(a,t))}function Ea(t,s){const a=Math.round(Number(t||0));try{return new Intl.NumberFormat(void 0,{style:"currency",currency:s,maximumFractionDigits:0}).format(a)}catch{return`${s} ${a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}}function S_(t){return new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"2-digit"})}function cd(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function Q4(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function gy(t,s){return Math.floor(Math.abs(t-s)/864e5)}function wt({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:na("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function $t({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:hg.green}:t==="accent"?{background:hg.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:na(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function xi({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:na(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:na("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function Ah({label:t,value:s,onChange:a,hint:l,disabled:n}){return e.jsxs("div",{className:na(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",min:0,onKeyDown:r=>(r.key==="-"||r.key==="e")&&r.preventDefault(),value:s,onChange:r=>{const i=Number(r.target.value||0);i>=0&&a(i)},disabled:n,className:na("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function ud({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:na(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:na("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function A_({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4,disabled:i}){return e.jsxs("div",{className:na(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:o=>a(o.target.value),placeholder:l,rows:r,disabled:i,className:na("mt-2 w-full rounded-2xl border p-3 text-sm font-semibold shadow-sm outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function fy({actions:t}){const[s,a]=qt.useState(!1),[l,n]=qt.useState("down"),r=qt.useRef(null);return qt.useEffect(()=>{const i=o=>{r.current&&!r.current.contains(o.target)&&a(!1)};return document.addEventListener("mousedown",i),()=>document.removeEventListener("mousedown",i)},[]),qt.useEffect(()=>{if(!s)return;const i=r.current;if(!i)return;const o=i.getBoundingClientRect(),c=o.top,x=window.innerHeight-o.bottom,j=Math.min(t.length,10)*40+16,g=x<j&&c>x;n(g?"up":"down")},[s,t.length]),t.length?e.jsxs("div",{className:"relative",ref:r,children:[e.jsx("button",{onClick:()=>a(i=>!i),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:na("absolute right-0 z-[9999] w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",l==="up"?"bottom-full mb-1":"top-full mt-1"),style:{maxHeight:"70vh",overflowY:"auto"},children:t.map((i,o)=>e.jsxs("button",{onClick:()=>{i.onClick(),a(!1)},disabled:i.disabled,className:na("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",i.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[i.icon,i.label]},o))})]}):null}function Eh({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="980px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:12,scale:.985},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:12,scale:.985},transition:{duration:.18},className:"fixed inset-x-0 bottom-4 top-4 z-50 mx-auto flex w-[min(1020px,calc(100vw-2rem))] flex-col overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i,maxHeight:"92vh"},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex shrink-0 items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(fy,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"shrink-0 border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function E_({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(480px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:na("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function fl({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function nb(t,s){const a=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),l=URL.createObjectURL(a),n=document.createElement("a");n.href=l,n.download=t,n.click(),URL.revokeObjectURL(l)}function M_(t,s){const a=r=>{const i=String(r??"");return/[",\n]/.test(i)?`"${i.replace(/"/g,'""')}"`:i},l=s.map(r=>a(r.label)).join(","),n=t.map(r=>s.map(i=>a(r[i.key])).join(",")).join(`
`);return`${l}
${n}`}function P_(t,s,a="text/plain"){const l=new Blob([s],{type:a}),n=URL.createObjectURL(l),r=document.createElement("a");r.href=n,r.download=t,r.click(),URL.revokeObjectURL(n)}function O_(t,s){return t==="Vendor"?s.vendor||"-":t==="Service module"?s.serviceModule||"-":t==="Marketplace"?s.marketplace||"-":t==="Group"?s.group||"-":t==="Cost center"?s.costCenter||"-":t==="Tax code"?s.taxCode||"-":t==="Transaction type"?s.type||"-":t==="Transaction status"&&s.status||"-"}function Y4(t,s,a,l){const n={};for(const r of t){const i=O_(s,r),o=a==="Count"?1:Number(r[l]||0);n[i]=n[i]||{key:i,value:0},n[i].value+=o}return Object.values(n).sort((r,i)=>i.value-r.value)}function J4(t,s,a){let l=1;if(a.requireSameVendor&&t.vendor!==s.vendor)return 0;if(a.requireSameModule&&t.serviceModule!==s.serviceModule&&(l*=.65),a.requireSameMarketplace){const x=(t.marketplace||"-").trim(),j=(s.marketplace||"-").trim();x!==j&&(l*=.55)}const n=gy(t.serviceDate,s.occurredAt),r=n<=Math.max(0,a.dateWindowDays);l*=r?1:Math.max(0,1-(n-a.dateWindowDays)*.12);const i=Math.max(.001,a.amountTolerancePct/100),o=Math.abs(t.amount-s.amount)/Math.max(1,t.amount),c=o<=i;return l*=c?1:Math.max(0,1-(o-i)*2.2),l*=s.status==="Posted"?1:s.status==="Pending"?.7:0,t.currency!==s.currency?0:hy(l,0,1)}function T_(){const s=Date.now(),[a,l]=d.useState([]),n=I=>{const Z=lo("toast");l(Ce=>[{id:Z,...I},...Ce].slice(0,4)),window.setTimeout(()=>l(Ce=>Ce.filter(He=>He.id!==Z)),3200)},[r,i]=d.useState("recon"),[o,c]=d.useState(()=>[{id:"TX-9001",type:"Wallet debit",status:"Posted",currency:"UGX",amount:165e3,vendor:"EVzone Rides",serviceModule:"Rides & Logistics",marketplace:"-",group:"Operations",costCenter:"OPS-001",taxCode:"VAT18",occurredAt:s-4*864e5,reference:"TRP-84001",note:"Airport pickup"},{id:"TX-9002",type:"Wallet debit",status:"Posted",currency:"UGX",amount:98e3,vendor:"EVzone Rides",serviceModule:"Rides & Logistics",marketplace:"-",group:"Operations",costCenter:"OPS-001",taxCode:"VAT18",occurredAt:s-4*864e5,reference:"TRP-84002",note:"City commute"},{id:"TX-9010",type:"Wallet debit",status:"Failed",currency:"UGX",amount:12e4,vendor:"EVzone Rides",serviceModule:"Rides & Logistics",marketplace:"-",group:"Sales",costCenter:"SALES-TRAVEL",taxCode:"VAT18",occurredAt:s-2*864e5,reference:"TRP-99001",note:"Client site"},{id:"TX-9020",type:"Credit draw",status:"Posted",currency:"UGX",amount:9e5,vendor:"Shenzhen Store",serviceModule:"E-Commerce",marketplace:"MyLiveDealz",group:"Procurement",costCenter:"PROC-001",taxCode:"VAT0",occurredAt:s-8*864e5,reference:"ORD-MLD-4401",note:"Deal order"},{id:"TX-9021",type:"Credit draw",status:"Posted",currency:"UGX",amount:11e5,vendor:"Shenzhen Store",serviceModule:"E-Commerce",marketplace:"MyLiveDealz",group:"Procurement",costCenter:"PROC-001",taxCode:"VAT0",occurredAt:s-8*864e5,reference:"ORD-MLD-4402",note:"Deal order"},{id:"TX-9030",type:"Prepaid spend",status:"Posted",currency:"UGX",amount:24e5,vendor:"Kampala Office Mart",serviceModule:"E-Commerce",marketplace:"EVmart",group:"Procurement",costCenter:"PROC-001",taxCode:"VAT18",occurredAt:s-9*864e5,reference:"ORD-EVM-2001",note:"Office supplies"},{id:"TX-9040",type:"Refund",status:"Pending",currency:"UGX",amount:2e5,vendor:"EVzone Rides",serviceModule:"Rides & Logistics",marketplace:"-",group:"Finance",costCenter:"FIN-OPS",taxCode:"VAT18",occurredAt:s-1*864e5,reference:"RFND-1001",note:"Refund pending"},{id:"TX-9050",type:"Reversal",status:"Posted",currency:"UGX",amount:15e4,vendor:"EVzone Rides",serviceModule:"Rides & Logistics",marketplace:"-",group:"Finance",costCenter:"FIN-OPS",taxCode:"VAT18",occurredAt:s-12*864e5,reference:"REV-2001",note:"Duplicate correction"}]),[x,j]=d.useState(()=>[{id:"IL-1001",invoiceNo:"ACME-202601-1042",invoiceId:"INV-0001",entityId:"ENT-UG",currency:"UGX",serviceDate:s-4*864e5,description:"Airport pickup TRP-84001",vendor:"EVzone Rides",serviceModule:"Rides & Logistics",marketplace:"-",group:"Operations",costCenter:"OPS-001",projectTag:"Office commute",taxCode:"VAT18",amount:165e3},{id:"IL-1002",invoiceNo:"ACME-202601-1042",invoiceId:"INV-0001",entityId:"ENT-UG",currency:"UGX",serviceDate:s-4*864e5,description:"City commute TRP-84002",vendor:"EVzone Rides",serviceModule:"Rides & Logistics",marketplace:"-",group:"Operations",costCenter:"OPS-001",projectTag:"Office commute",taxCode:"VAT18",amount:98e3},{id:"IL-1101",invoiceNo:"ACME-202601-1042",invoiceId:"INV-0001",entityId:"ENT-UG",currency:"UGX",serviceDate:s-8*864e5,description:"MyLiveDealz orders",vendor:"Shenzhen Store",serviceModule:"E-Commerce",marketplace:"MyLiveDealz",group:"Procurement",costCenter:"PROC-001",projectTag:"High value",taxCode:"VAT0",amount:2e6},{id:"IL-1201",invoiceNo:"ACME-202601-1042",invoiceId:"INV-0001",entityId:"ENT-UG",currency:"UGX",serviceDate:s-9*864e5,description:"EVmart supplies",vendor:"Kampala Office Mart",serviceModule:"E-Commerce",marketplace:"EVmart",group:"Procurement",costCenter:"PROC-001",projectTag:"Office supplies",taxCode:"VAT18",amount:24e5},{id:"IL-2001",invoiceNo:"ACME-SALES-202512-0088",invoiceId:"INV-0002",entityId:"ENT-UG",currency:"UGX",serviceDate:s-2*864e5,description:"Sales travel ride TRP-99001",vendor:"EVzone Rides",serviceModule:"Rides & Logistics",marketplace:"-",group:"Sales",costCenter:"SALES-TRAVEL",projectTag:"Client meetings",taxCode:"VAT18",amount:12e4}]),[g,y]=d.useState(()=>[{id:"R-01",name:"Strict: same vendor, amount, and date",enabled:!0,requireSameVendor:!0,requireSameModule:!1,requireSameMarketplace:!1,dateWindowDays:1,amountTolerancePct:0,minConfidence:.92,allowPartialMatch:!1},{id:"R-02",name:"Standard: vendor + amount tolerance",enabled:!0,requireSameVendor:!0,requireSameModule:!0,requireSameMarketplace:!1,dateWindowDays:7,amountTolerancePct:5,minConfidence:.85,allowPartialMatch:!0},{id:"R-03",name:"Marketplace: vendor + marketplace",enabled:!0,requireSameVendor:!0,requireSameModule:!0,requireSameMarketplace:!0,dateWindowDays:14,amountTolerancePct:10,minConfidence:.8,allowPartialMatch:!0}]),[$,T]=d.useState(()=>[{id:"MAP-DEF",scope:"Default",key:"*",glCode:"4000",costCenter:"ORG",taxCode:"VAT18",memo:"Default mapping",enabled:!0},{id:"MAP-MOD-RIDES",scope:"Module",key:"Rides & Logistics",glCode:"4100",costCenter:"OPS-001",taxCode:"VAT18",memo:"Ride revenue",enabled:!0},{id:"MAP-MOD-CHG",scope:"Module",key:"EVs & Charging",glCode:"4200",costCenter:"OPS-001",taxCode:"VAT18",memo:"Charging",enabled:!0},{id:"MAP-MKT-MYLIVE",scope:"Marketplace",key:"MyLiveDealz",glCode:"4305",costCenter:"PROC-001",taxCode:"VAT0",memo:"Deals marketplace",enabled:!0},{id:"MAP-VND-SHEN",scope:"Vendor",key:"Shenzhen Store",glCode:"5001",costCenter:"PROC-001",taxCode:"VAT0",memo:"Imports vendor",enabled:!0}]),[C,W]=d.useState(()=>[{id:"MT-01",lineId:"IL-1001",txId:"TX-9001",amount:165e3,method:"Auto",confidence:.98,ruleId:"R-01",createdAt:s-2*60*60*1e3,createdBy:"System",note:"Auto-match"},{id:"MT-02",lineId:"IL-1002",txId:"TX-9002",amount:98e3,method:"Auto",confidence:.98,ruleId:"R-01",createdAt:s-2*60*60*1e3,createdBy:"System",note:"Auto-match"}]),[L,R]=d.useState(()=>[{id:"EX-100",kind:"Failed charge",severity:"Critical",status:"Open",createdAt:s-2*864e5,txId:"TX-9010",invoiceNo:"ACME-SALES-202512-0088",message:"Transaction failed for Sales travel ride. No posted payment exists.",suggestedNext:"Retry charge or route to exceptions approval"},{id:"EX-101",kind:"Refund pending",severity:"Warning",status:"Investigating",createdAt:s-1*864e5,txId:"TX-9040",invoiceNo:"ACME-202601-1042",message:"Refund is pending and may need approval to post.",suggestedNext:"Approve refund or schedule follow-up"}]),[F,te]=d.useState(()=>[{id:"AU-001",at:s-2*60*60*1e3,actor:"System",action:"AUTO_MATCH_RUN",entityRef:"Batch",details:"Auto-matched 2 lines"}]),[oe,G]=d.useState(""),[H,Y]=d.useState("All"),[we,q]=d.useState("All"),[je,_e]=d.useState(""),[Ee,be]=d.useState("Unmatched"),[Fe,Pe]=d.useState(""),[pe,Q]=d.useState("All"),[Re,ce]=d.useState(null),[xe,he]=d.useState(null),[de,ye]=d.useState(!1),[Ke,Le]=d.useState({amount:0,note:""}),[Ne,ge]=d.useState(!1),[$e,ie]=d.useState(null),[Oe,Se]=d.useState(!1),[Te,Ge]=d.useState(null),[We,ze]=d.useState(!1),Ue=d.useMemo(()=>{const I={};for(const Z of C)I[Z.txId]=(I[Z.txId]||0)+Z.amount;return I},[C]),le=d.useMemo(()=>{const I={};for(const Z of C)I[Z.lineId]=(I[Z.lineId]||0)+Z.amount;return I},[C]),z=I=>{const Z=o.find(He=>He.id===I);if(!Z)return 0;const Ce=Ue[I]||0;return Math.max(0,Z.amount-Ce)},Ae=I=>{const Z=x.find(He=>He.id===I);if(!Z)return 0;const Ce=le[I]||0;return Math.max(0,Z.amount-Ce)},Ve=I=>Ae(I)<=1e-4,Ye=I=>(le[I]||0)>0&&Ae(I)>1e-4,Be=d.useMemo(()=>Re&&x.find(I=>I.id===Re)||null,[Re,x]),w=d.useMemo(()=>xe&&o.find(I=>I.id===xe)||null,[xe,o]),B=d.useMemo(()=>Be?C.filter(I=>I.lineId===Be.id):[],[Be,C]),ue=d.useMemo(()=>w?C.filter(I=>I.txId===w.id):[],[w,C]),ne=d.useMemo(()=>{const I=oe.trim().toLowerCase();return o.filter(Z=>H==="All"?!0:Z.type===H).filter(Z=>we==="All"?!0:Z.status===we).filter(Z=>I?`${Z.id} ${Z.reference} ${Z.vendor} ${Z.serviceModule} ${Z.marketplace} ${Z.group} ${Z.costCenter} ${Z.note}`.toLowerCase().includes(I):!0).slice().sort((Z,Ce)=>Ce.occurredAt-Z.occurredAt)},[o,oe,H,we]),Me=d.useMemo(()=>{const I=je.trim().toLowerCase();return x.filter(Z=>Ee==="Unmatched"?!Ve(Z.id):Ee==="Partially matched"?Ye(Z.id):!0).filter(Z=>I?`${Z.invoiceNo} ${Z.description} ${Z.vendor} ${Z.serviceModule} ${Z.marketplace} ${Z.group} ${Z.costCenter} ${Z.projectTag} ${Z.taxCode}`.toLowerCase().includes(I):!0).slice().sort((Z,Ce)=>Ce.serviceDate-Z.serviceDate)},[x,je,Ee,le,C]),De=d.useMemo(()=>{const I=Fe.trim().toLowerCase();return L.filter(Z=>pe==="All"?!0:Z.status===pe).filter(Z=>I?`${Z.id} ${Z.kind} ${Z.severity} ${Z.status} ${Z.message} ${Z.suggestedNext} ${Z.invoiceNo||""} ${Z.txId||""}`.toLowerCase().includes(I):!0).slice().sort((Z,Ce)=>Ce.createdAt-Z.createdAt)},[L,Fe,pe]),fe=d.useMemo(()=>{if(!Be)return[];const I=o.filter(He=>He.currency===Be.currency).filter(He=>He.status!=="Failed").filter(He=>z(He.id)>0).filter(He=>gy(He.occurredAt,Be.serviceDate)<=30),Z=g.filter(He=>He.enabled);return I.map(He=>{let mt=0,ot;for(const Nt of Z){const nt=J4(Be,He,Nt);nt>mt&&(mt=nt,ot=Nt)}return{tx:He,score:mt,bestRule:ot}}).filter(He=>He.score>0).sort((He,mt)=>mt.score-He.score)},[Be,o,Ue,g]),me=d.useMemo(()=>{const I=x.filter(nt=>!Ve(nt.id)).length,Z=x.filter(nt=>Ye(nt.id)).length,Ce=L.filter(nt=>nt.status!=="Resolved").length,He=o.filter(nt=>nt.status==="Failed").length,mt=o.filter(nt=>nt.status==="Pending").length,ot=o.filter(nt=>nt.status==="Posted").length,Nt=o.filter(nt=>z(nt.id)>0&&nt.status==="Posted").length;return{unmatched:I,partial:Z,openExc:Ce,failedTx:He,pendingTx:mt,postedTx:ot,unmatchedTx:Nt}},[x,C,L,o,Ue]),Xe=I=>te(Z=>[{id:lo("AU"),...I},...Z]),V=I=>{const Z={id:lo("EX"),createdAt:Date.now(),status:I.status||"Open",...I};R(Ce=>[Z,...Ce]),Xe({at:Z.createdAt,actor:"System",action:"EXCEPTION_CREATED",entityRef:Z.id,details:`${Z.kind} (${Z.severity})`})},E=I=>{if(!Be){n({title:"Select a line",message:"Choose an invoice line to reconcile.",kind:"warn"});return}I&&he(I);const Z=I?o.find(He=>He.id===I):w,Ce=Z?Math.min(Ae(Be.id),z(Z.id)):Ae(Be.id);Le({amount:Ce>0?Ce:0,note:""}),ye(!0)},u=(I,Z,Ce)=>{if(!Be||!w)return;const He=Math.max(0,Math.round(Ke.amount));if(He<=0){n({title:"Invalid amount",message:"Match amount must be greater than zero.",kind:"warn"});return}const mt=Ae(Be.id),ot=z(w.id);if(He>mt){n({title:"Too much",message:"Amount exceeds remaining line balance.",kind:"warn"});return}if(He>ot){n({title:"Too much",message:"Amount exceeds remaining transaction balance.",kind:"warn"});return}const Nt={id:lo("MT"),lineId:Be.id,txId:w.id,amount:He,method:I,confidence:Z,ruleId:Ce,createdAt:Date.now(),createdBy:"You",note:Ke.note.trim()||"Manual match"};W(Vs=>[Nt,...Vs]),Xe({at:Nt.createdAt,actor:Nt.createdBy,action:"MATCH_CREATED",entityRef:Nt.id,details:`${Nt.lineId} <- ${Nt.txId} (${Nt.amount})`}),n({title:"Matched",message:`${Be.invoiceNo} line matched to ${w.id}.`,kind:"success"});const nt=mt-He;nt>0&&nt>Math.max(1e3,Be.amount*.02)&&V({kind:"Partial payment",severity:"Warning",invoiceNo:Be.invoiceNo,lineId:Be.id,txId:w.id,message:"Line partially matched. Remaining amount still due.",suggestedNext:"Find another transaction or raise an adjustment",status:"Open"}),ye(!1)},P=I=>{const Z=C.find(Ce=>Ce.id===I);Z&&(W(Ce=>Ce.filter(He=>He.id!==I)),Xe({at:Date.now(),actor:"You",action:"MATCH_REMOVED",entityRef:I,details:`${Z.lineId} x ${Z.txId} (${Z.amount})`}),n({title:"Unmatched",message:"Match removed.",kind:"info"}))},se=()=>{const I=g.filter(Ot=>Ot.enabled);if(!I.length){n({title:"No rules",message:"Enable at least one auto-match rule.",kind:"warn"});return}let Z=0,Ce=0;const He=Object.fromEntries(o.map(Ot=>[Ot.id,Ot])),mt=[...C],ot={},Nt={};for(const Ot of mt)ot[Ot.txId]=(ot[Ot.txId]||0)+Ot.amount,Nt[Ot.lineId]=(Nt[Ot.lineId]||0)+Ot.amount;const nt=Ot=>{const Ca=He[Ot];return Ca?Math.max(0,Ca.amount-(ot[Ot]||0)):0},Vs=Ot=>{const Ca=x.find(Ft=>Ft.id===Ot);return Ca?Math.max(0,Ca.amount-(Nt[Ot]||0)):0},Es=[],ka=o.filter(Ot=>Ot.status!=="Failed");for(const Ot of x){if(Vs(Ot.id)<=1e-4)continue;const Ca=ka.filter(Al=>Al.currency===Ot.currency).filter(Al=>nt(Al.id)>0).filter(Al=>gy(Al.occurredAt,Ot.serviceDate)<=30);let Ft=null;for(const Al of Ca)for(const Yd of I){const Jo=J4(Ot,Al,Yd);Jo<=0||Jo<Yd.minConfidence||(!Ft||Jo>Ft.score)&&(Ft={tx:Al,score:Jo,rule:Yd})}if(!Ft){Ce+=1;continue}const Uu=Ft.rule,Yo=Math.min(Vs(Ot.id),nt(Ft.tx.id));if(!Uu.allowPartialMatch&&Yo!==Vs(Ot.id)){Ce+=1;continue}if(Yo<=0){Ce+=1;continue}ot[Ft.tx.id]=(ot[Ft.tx.id]||0)+Yo,Nt[Ot.id]=(Nt[Ot.id]||0)+Yo,Es.push({id:lo("MT"),lineId:Ot.id,txId:Ft.tx.id,amount:Math.round(Yo),method:"Auto",confidence:Ft.score,ruleId:Uu.id,createdAt:Date.now(),createdBy:"System",note:`Auto-match by ${Uu.name}`}),Z+=1}if(Es.length){W(Ft=>[...Es,...Ft]),Xe({at:Date.now(),actor:"System",action:"AUTO_MATCH_RUN",entityRef:"Batch",details:`Auto-matched ${Z} line(s), skipped ${Ce}.`}),n({title:"Auto-match complete",message:`Matched ${Z} line(s).`,kind:"success"});const Ot={};for(const Ft of[...C,...Es])Ot[Ft.lineId]=(Ot[Ft.lineId]||0)+Ft.amount;const Ca=x.filter(Ft=>Math.max(0,Ft.amount-(Ot[Ft.id]||0))>1e-4);Ca.length&&V({kind:"Unmatched",severity:"Warning",message:`${Ca.length} invoice line(s) remain unmatched after auto-match.",`,suggestedNext:"Review candidate transactions or create adjustments",status:"Open"})}else n({title:"No matches",message:"No auto-matches met the confidence thresholds.",kind:"info"})},D=I=>{R(Z=>Z.map(Ce=>Ce.id===I?{...Ce,status:"Resolved"}:Ce)),Xe({at:Date.now(),actor:"You",action:"EXCEPTION_UPDATED",entityRef:I,details:"Marked resolved"}),n({title:"Resolved",message:"Exception resolved.",kind:"success"})},re=(I,Z)=>{R(Ce=>Ce.map(He=>He.id===I?{...He,status:Z}:He)),Xe({at:Date.now(),actor:"You",action:"EXCEPTION_UPDATED",entityRef:I,details:`Status -> ${Z}`}),n({title:"Updated",message:"Exception updated.",kind:"info"})},v=I=>{c(Z=>Z.map(Ce=>Ce.id===I?{...Ce,status:"Pending",note:`${Ce.note} (retry queued)`}:Ce)),Xe({at:Date.now(),actor:"You",action:"TX_STATUS_UPDATED",entityRef:I,details:"Retry queued"}),n({title:"Retry queued",message:"Transaction moved to Pending.",kind:"success"})},k=I=>{c(Z=>Z.map(Ce=>Ce.id===I?{...Ce,status:"Posted"}:Ce)),Xe({at:Date.now(),actor:"You",action:"TX_STATUS_UPDATED",entityRef:I,details:"Marked Posted"}),n({title:"Updated",message:"Transaction marked Posted.",kind:"success"})},m=I=>{ie(I?JSON.parse(JSON.stringify(I)):{id:"",name:"New rule",enabled:!0,requireSameVendor:!0,requireSameModule:!0,requireSameMarketplace:!1,dateWindowDays:7,amountTolerancePct:5,minConfidence:.85,allowPartialMatch:!0}),ge(!0)},S=()=>{if(!$e)return;if(!$e.name.trim()){n({title:"Missing name",message:"Rule name is required.",kind:"warn"});return}const I=!$e.id,Z=$e.id||lo("R"),Ce={...$e,id:Z};y(He=>{const mt=He.findIndex(ot=>ot.id===Z);if(mt>=0){const ot=He.slice();return ot[mt]=Ce,ot}return[Ce,...He]}),Xe({at:Date.now(),actor:"You",action:"RULE_UPDATED",entityRef:Z,details:`${I?"Created":"Updated"} rule`}),n({title:"Saved",message:"Rule saved.",kind:"success"}),ge(!1)},f=I=>{y(Z=>Z.filter(Ce=>Ce.id!==I)),Xe({at:Date.now(),actor:"You",action:"RULE_UPDATED",entityRef:I,details:"Deleted rule"}),n({title:"Deleted",message:"Rule deleted.",kind:"info"})},U=I=>{Ge(I?JSON.parse(JSON.stringify(I)):{id:"",scope:"Module",key:"Rides & Logistics",glCode:"4000",costCenter:"ORG",taxCode:"VAT18",memo:"",enabled:!0}),Se(!0)},p=()=>{if(!Te)return;if(!Te.key.trim()){n({title:"Missing key",message:"Key is required.",kind:"warn"});return}const I=!Te.id,Z=Te.id||lo("MAP"),Ce={...Te,id:Z};T(He=>{const mt=He.findIndex(ot=>ot.id===Z);if(mt>=0){const ot=He.slice();return ot[mt]=Ce,ot}return[Ce,...He]}),Xe({at:Date.now(),actor:"You",action:"ERP_MAPPING_UPDATED",entityRef:Z,details:`${I?"Created":"Updated"} mapping`}),n({title:"Saved",message:"ERP mapping saved.",kind:"success"}),Se(!1)},M=I=>{T(Z=>Z.filter(Ce=>Ce.id!==I)),Xe({at:Date.now(),actor:"You",action:"ERP_MAPPING_UPDATED",entityRef:I,details:"Deleted mapping"}),n({title:"Deleted",message:"Mapping removed.",kind:"info"})},ee=()=>{const I=ae();nb("reconciliation-report.json",I),Xe({at:Date.now(),actor:"You",action:"EXPORT",entityRef:"recon-report.json",details:"Exported reconciliation report JSON"}),n({title:"Exported",message:"Reconciliation report JSON downloaded.",kind:"success"})},b=()=>{const I=ne.map(Ce=>({id:Ce.id,occurredAt:cd(Ce.occurredAt),type:Ce.type,status:Ce.status,currency:Ce.currency,amount:Ea(Ce.amount,Ce.currency),matched:Ea(Ue[Ce.id]||0,Ce.currency),remaining:Ea(z(Ce.id),Ce.currency),vendor:Ce.vendor,module:Ce.serviceModule,marketplace:Ce.marketplace,group:Ce.group,costCenter:Ce.costCenter,taxCode:Ce.taxCode,reference:Ce.reference,note:Ce.note})),Z=M_(I,[{key:"id",label:"ID"},{key:"occurredAt",label:"Time"},{key:"type",label:"Type"},{key:"status",label:"Status"},{key:"currency",label:"Currency"},{key:"amount",label:"Amount"},{key:"matched",label:"Matched"},{key:"remaining",label:"Remaining"},{key:"vendor",label:"Vendor"},{key:"module",label:"Module"},{key:"marketplace",label:"Marketplace"},{key:"group",label:"Group"},{key:"costCenter",label:"Cost center"},{key:"taxCode",label:"Tax code"},{key:"reference",label:"Reference"},{key:"note",label:"Note"}]);P_("transaction-ledger.csv",Z,"text/csv"),Xe({at:Date.now(),actor:"You",action:"EXPORT",entityRef:"transaction-ledger.csv",details:"Exported ledger CSV"}),n({title:"Exported",message:"Ledger CSV downloaded.",kind:"success"})},ae=()=>{const I=x.filter(Ce=>Ae(Ce.id)>1e-4),Z=o.filter(Ce=>Ce.status==="Posted"&&z(Ce.id)>1e-4);return{generatedAt:new Date().toISOString(),summary:{invoiceLines:x.length,transactions:o.length,matches:C.length,unmatchedLines:I.length,unmatchedPostedTransactions:Z.length,openExceptions:L.filter(Ce=>Ce.status!=="Resolved").length},matches:C,unmatchedLines:I.map(Ce=>({lineId:Ce.id,invoiceNo:Ce.invoiceNo,vendor:Ce.vendor,module:Ce.serviceModule,marketplace:Ce.marketplace,amount:Ce.amount,matched:le[Ce.id]||0,remaining:Ae(Ce.id)})),unmatchedTransactions:Z.map(Ce=>({txId:Ce.id,type:Ce.type,vendor:Ce.vendor,module:Ce.serviceModule,marketplace:Ce.marketplace,amount:Ce.amount,matched:Ue[Ce.id]||0,remaining:z(Ce.id)})),exceptions:L,erpMappings:$,rules:g,audit:F}},ve=d.useMemo(()=>ae().summary,[x,o,C,L,$,g,F,Ue,le]);return d.useEffect(()=>{const I=L.some(Ce=>Ce.kind==="Unmatched"),Z=x.filter(Ce=>Ae(Ce.id)>1e-4);!I&&Z.length>=2&&R(Ce=>[{id:lo("EX"),kind:"Unmatched",severity:"Warning",status:"Investigating",createdAt:Date.now(),message:"Some invoice lines are unmatched. Review reconciliation.",suggestedNext:"Run auto-match or match manually"},...Ce])},[]),e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(E_,{toasts:a,onDismiss:I=>l(Z=>Z.filter(Ce=>Ce.id!==I))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:hg.green},children:e.jsx(t4,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Transactions and Reconciliation"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Ledger, matching tools, exceptions queue, ERP mappings, auto-match rules, and audit-ready reports."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(wt,{label:`Unmatched lines: ${me.unmatched}`,tone:me.unmatched?"warn":"good"}),e.jsx(wt,{label:`Partial: ${me.partial}`,tone:me.partial?"info":"neutral"}),e.jsx(wt,{label:`Open exceptions: ${me.openExc}`,tone:me.openExc?"bad":"good"}),e.jsx(wt,{label:`Posted tx: ${me.postedTx}`,tone:"neutral"}),e.jsx(wt,{label:`Unmatched tx: ${me.unmatchedTx}`,tone:me.unmatchedTx?"warn":"good"}),e.jsx(wt,{label:"Premium: auto-match + ERP",tone:"info"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs($t,{variant:"outline",onClick:()=>i("recon"),children:[e.jsx(Ud,{className:"h-4 w-4"})," Reconcile"]}),e.jsxs($t,{variant:"outline",onClick:se,children:[e.jsx(ht,{className:"h-4 w-4"})," Auto-match"]}),e.jsxs($t,{variant:"outline",onClick:b,children:[e.jsx(pt,{className:"h-4 w-4"})," Ledger CSV"]}),e.jsxs($t,{variant:"primary",onClick:ee,children:[e.jsx(kt,{className:"h-4 w-4"})," Export report"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"recon",label:"Reconciliation"},{id:"ledger",label:"Transaction ledger"},{id:"exceptions",label:"Exceptions queue"},{id:"erp",label:"ERP mappings"},{id:"rules",label:"Auto-match rules"},{id:"reports",label:"Reports"}].map(I=>e.jsx("button",{className:na("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",r===I.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:r===I.id?{background:hg.green}:void 0,onClick:()=>i(I.id),children:I.label},I.id))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[r==="ledger"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs(fl,{title:"Transaction ledger",subtitle:"Click a transaction to reconcile against the selected invoice line.",right:e.jsx(wt,{label:`${ne.length} tx`,tone:"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Tx"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Type"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Module"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Remaining"}),e.jsx("th",{className:"px-4 py-3 font-semibold text-right",children:" "})]})}),e.jsxs("tbody",{children:[ne.map(I=>{const Z=Ue[I.id]||0,Ce=z(I.id),He=xe===I.id;return e.jsxs("tr",{className:na("border-t border-slate-100 hover:bg-slate-50/60",He&&"bg-emerald-50/40"),children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:I.id}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Ref: ",I.reference]})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:cd(I.occurredAt)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:I.type}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(wt,{label:I.status,tone:I.status==="Posted"?"good":I.status==="Pending"?"warn":"bad"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:I.vendor}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[I.serviceModule,I.marketplace!=="-"?`  ${I.marketplace}`:""]}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Ea(I.amount,I.currency)}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:Ea(Ce,I.currency)}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Matched: ",Ea(Z,I.currency)]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"flex justify-end",children:e.jsx(fy,{actions:[{label:"Select",icon:e.jsx(Ud,{className:"h-4 w-4"}),onClick:()=>{he(I.id),n({title:"Selected",message:"Transaction selected.",kind:"info"})}},{label:"Match",icon:e.jsx(tt,{className:"h-4 w-4"}),onClick:()=>{he(I.id),E(I.id)},disabled:!Re||Ce<=0||I.status==="Failed"},...I.status==="Failed"?[{label:"Retry",icon:e.jsx(Mr,{className:"h-4 w-4"}),onClick:()=>v(I.id)}]:I.status==="Pending"?[{label:"Mark posted",icon:e.jsx(ct,{className:"h-4 w-4"}),onClick:()=>k(I.id)}]:[],{label:"Copy ID",icon:e.jsx(ss,{className:"h-4 w-4"}),onClick:async()=>{try{await navigator.clipboard.writeText(I.id),n({title:"Copied",message:"Transaction ID copied.",kind:"success"})}catch{n({title:"Copy failed",message:"Copy manually.",kind:"warn"})}}}]})})})]},I.id)}),ne.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-4 py-12 text-center text-sm text-slate-600",children:"No transactions match filters."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: ERP export mappings (GL codes, cost centers, tax codes) are configured in the ERP tab."})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-2",children:[e.jsxs(fl,{title:"Ledger filters",subtitle:"Search by vendor, ref, module, cost center.",right:e.jsx(wt,{label:"Core",tone:"neutral"}),children:[e.jsx(xi,{label:"Search",value:oe,onChange:G,placeholder:"TX-9001, vendor, ORD..."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(ud,{label:"Type",value:H,onChange:I=>Y(I),options:[{value:"All",label:"All"},...Array.from(new Set(o.map(I=>I.type))).map(I=>({value:I,label:I}))]}),e.jsx(ud,{label:"Status",value:we,onChange:I=>q(I),options:[{value:"All",label:"All"},{value:"Posted",label:"Posted"},{value:"Pending",label:"Pending"},{value:"Failed",label:"Failed"}]})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:[e.jsxs($t,{variant:"outline",onClick:()=>{G(""),Y("All"),q("All"),n({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(vn,{className:"h-4 w-4"})," Reset"]}),e.jsxs($t,{variant:"outline",onClick:b,children:[e.jsx(pt,{className:"h-4 w-4"})," CSV"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Core: ledger shows wallet, credit, prepaid, refunds, and reversals."})]}),e.jsx(fl,{title:"Ledger insights",subtitle:"Premium pivot summary.",right:e.jsx(wt,{label:"Premium",tone:"info"}),children:e.jsx(A,{rows:ne,currency:"UGX"})})]})]}):null,r==="recon"?e.jsx("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:e.jsxs("div",{className:"lg:col-span-12 space-y-4",children:[e.jsx(fl,{title:"Reconciliation workspace",subtitle:"Match invoice lines to wallet, credit, prepaid, refunds, and reversals.",right:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs($t,{variant:"outline",onClick:()=>i("ledger"),children:[e.jsx(et,{className:"h-4 w-4"})," Open ledger"]}),e.jsxs($t,{variant:"outline",onClick:()=>i("exceptions"),children:[e.jsx(Et,{className:"h-4 w-4"})," Exceptions"]})]}),children:Be?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:Be.invoiceNo}),e.jsx(wt,{label:Be.taxCode,tone:"neutral"}),e.jsx(wt,{label:Be.marketplace!=="-"?Be.marketplace:Be.serviceModule,tone:"info"})]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:Be.description}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[Be.vendor,"  ",S_(Be.serviceDate)]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[Be.group,"  ",Be.costCenter,"  ",Be.projectTag]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Amount"}),e.jsx("div",{className:"mt-1 text-lg font-semibold text-slate-900",children:Ea(Be.amount,Be.currency)}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Remaining"}),e.jsx("div",{className:na("mt-1 text-sm font-semibold",Ae(Be.id)>0?"text-slate-900":"text-emerald-700"),children:Ea(Ae(Be.id),Be.currency)})]})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:[e.jsxs($t,{variant:"primary",onClick:()=>{var I,Z,Ce,He;!xe&&((Z=(I=fe[0])==null?void 0:I.tx)!=null&&Z.id)&&he(fe[0].tx.id),E(xe||((He=(Ce=fe[0])==null?void 0:Ce.tx)==null?void 0:He.id))},disabled:Ae(Be.id)<=1e-4,children:[e.jsx(tt,{className:"h-4 w-4"})," Match"]}),e.jsxs($t,{variant:"outline",onClick:()=>{he(null),n({title:"Cleared",message:"Transaction selection cleared.",kind:"info"})},children:[e.jsx(Qe,{className:"h-4 w-4"})," Clear tx"]}),e.jsxs($t,{variant:"outline",onClick:se,children:[e.jsx(ht,{className:"h-4 w-4"})," Auto-match all"]}),e.jsxs($t,{variant:"outline",onClick:()=>ze(!0),children:[e.jsx(kt,{className:"h-4 w-4"})," Report"]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Existing matches"}),e.jsx("div",{className:"mt-2 space-y-2",children:B.length?B.map(I=>{const Z=o.find(Ce=>Ce.id===I.txId);return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:I.txId}),e.jsx(wt,{label:I.method,tone:I.method==="Auto"?"info":"neutral"}),e.jsx(wt,{label:`${Math.round(I.confidence*100)}%`,tone:I.confidence>=.9?"good":I.confidence>=.8?"warn":"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[(Z==null?void 0:Z.vendor)||"-","  ",(Z==null?void 0:Z.type)||"-","  ",Z?cd(Z.occurredAt):"-"]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Note: ",I.note]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Amount"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:Ea(I.amount,Be.currency)}),e.jsx("div",{className:"mt-2 flex justify-end",children:e.jsxs($t,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>P(I.id),children:[e.jsx(Qe,{className:"h-4 w-4"})," Remove"]})})]})]})},I.id)}):e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No matches yet for this line."})})]})]})}),e.jsxs("div",{className:"lg:col-span-5 space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Candidate transactions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Suggested by rules and scoring."})]}),e.jsx(wt,{label:`Top ${Math.min(8,fe.length)}`,tone:"info"})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[fe.slice(0,8).map(I=>{var Nt;const Z=I.tx,Ce=z(Z.id),He=xe===Z.id,mt=Math.round(I.score*100),ot=((Nt=I.bestRule)==null?void 0:Nt.name)||"-";return e.jsx("button",{type:"button",className:na("w-full rounded-3xl border bg-white p-4 text-left hover:bg-slate-50",He?"border-emerald-300 ring-4 ring-emerald-100":"border-slate-200"),onClick:()=>he(Z.id),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:Z.id}),e.jsx(wt,{label:Z.status,tone:Z.status==="Posted"?"good":"warn"}),e.jsx(wt,{label:`${mt}%`,tone:mt>=90?"good":mt>=80?"warn":"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[Z.vendor,"  ",Z.type]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[Z.serviceModule,Z.marketplace!=="-"?`  ${Z.marketplace}`:""]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Rule: ",ot]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Available"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:Ea(Ce,Z.currency)}),e.jsx("div",{className:"mt-2",children:e.jsxs($t,{variant:"primary",className:"px-3 py-2 text-xs",onClick:nt=>{nt.preventDefault(),nt.stopPropagation(),he(Z.id),E(Z.id)},disabled:Ae(Be.id)<=1e-4||Ce<=1e-4,children:[e.jsx(tt,{className:"h-4 w-4"})," Match"]})})]})]})},Z.id)}),fe.length?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No candidates found. Try opening the ledger and selecting a transaction."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium assistant: auto-match rules can be tuned in the Rules tab."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Selected transaction"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"For manual reconciliation."})]}),e.jsx(wt,{label:w?w.status:"None",tone:w?w.status==="Posted"?"good":w.status==="Pending"?"warn":"bad":"neutral"})]}),w?e.jsxs("div",{className:"mt-3 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:w.id}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[w.vendor,"  ",w.type]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[cd(w.occurredAt),"  Ref ",w.reference]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Note: ",w.note]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Remaining"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:Ea(z(w.id),w.currency)})]})]}),ue.length?e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Matches"}),e.jsx("ul",{className:"mt-2 space-y-1",children:ue.slice(0,6).map(I=>e.jsxs("li",{children:[" ",I.lineId," (",Ea(I.amount,w.currency),")"]},I.id))})]}):e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No matches for this transaction."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[w.status==="Failed"?e.jsxs($t,{variant:"outline",onClick:()=>v(w.id),children:[e.jsx(Mr,{className:"h-4 w-4"})," Retry"]}):w.status==="Pending"?e.jsxs($t,{variant:"outline",onClick:()=>k(w.id),children:[e.jsx(ct,{className:"h-4 w-4"})," Mark Posted"]}):null,e.jsxs($t,{variant:"outline",onClick:async()=>{try{await navigator.clipboard.writeText(w.id),n({title:"Copied",message:"Transaction ID copied.",kind:"success"})}catch{n({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},children:[e.jsx(ss,{className:"h-4 w-4"})," Copy ID"]})]})]}):e.jsx("div",{className:"mt-3 rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"Select a candidate or choose a transaction from the Ledger."})]})]})]}):e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(Ud,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"Select an invoice line"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Choose a line below to see candidate transactions."})]})}),e.jsxs(fl,{title:"Invoice lines",subtitle:"Select a line and match to transactions.",right:e.jsx(wt,{label:Ee,tone:"neutral"}),children:[e.jsx(xi,{label:"Search lines",value:je,onChange:_e,placeholder:"Invoice, vendor, project tag..."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(ud,{label:"Scope",value:Ee,onChange:I=>be(I),options:[{value:"Unmatched",label:"Unmatched"},{value:"Partially matched",label:"Partially matched"},{value:"All",label:"All"}],hint:"Worklist"}),e.jsxs($t,{variant:"outline",className:"mt-[22px] w-full sm:mt-0",onClick:se,children:[e.jsx(ht,{className:"h-4 w-4"})," Auto-match"]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-2 md:grid-cols-2",children:[Me.slice(0,30).map(I=>{const Z=Ae(I.id),Ce=le[I.id]||0,He=Re===I.id;return e.jsx("button",{type:"button",className:na("w-full rounded-3xl border bg-white p-4 text-left hover:bg-slate-50",He?"border-emerald-300 ring-4 ring-emerald-100":"border-slate-200"),onClick:()=>{ce(I.id)},children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:I.invoiceNo}),Z<=1e-4?e.jsx(wt,{label:"Matched",tone:"good"}):Ce>0?e.jsx(wt,{label:"Partial",tone:"info"}):e.jsx(wt,{label:"Unmatched",tone:"warn"})]}),e.jsx("div",{className:"mt-1 truncate text-xs text-slate-500",children:I.description}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[I.vendor,"  ",I.serviceModule,I.marketplace!=="-"?`  ${I.marketplace}`:""]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[I.group,"  ",I.costCenter,"  ",I.projectTag]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Amount"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:Ea(I.amount,I.currency)}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Remaining"}),e.jsx("div",{className:na("mt-1 text-sm font-semibold",Z>0?"text-slate-900":"text-emerald-700"),children:Ea(Z,I.currency)})]})]})},I.id)}),Me.length?null:e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center md:col-span-2",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(t4,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"No lines"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Your current scope and filters show no lines."})]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium assistant: auto-match uses enabled rules and confidence thresholds."})]})]})}):null,r==="exceptions"?e.jsxs("div",{className:"space-y-4",children:[e.jsx(fl,{title:"Exceptions queue",subtitle:"Failed charges, partial payments, and reconciliation gaps.",right:e.jsx(wt,{label:`${De.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[De.map(I=>{const Z=I.severity==="Critical"?"bad":I.severity==="Warning"?"warn":"info";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:I.id}),e.jsx(wt,{label:I.kind,tone:"neutral"}),e.jsx(wt,{label:I.severity,tone:Z}),e.jsx(wt,{label:I.status,tone:I.status==="Resolved"?"good":I.status==="Investigating"?"info":"warn"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",Q4(I.createdAt),"  ",cd(I.createdAt)]}),I.invoiceNo?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Invoice: ",I.invoiceNo]}):null,I.txId?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Transaction: ",I.txId]}):null,e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:I.message}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Next: ",I.suggestedNext]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[I.txId?e.jsxs($t,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{he(I.txId||null),i("ledger"),n({title:"Opened",message:"Transaction selected in ledger.",kind:"info"})},children:[e.jsx(et,{className:"h-4 w-4"})," Open tx"]}):null,I.status!=="Resolved"?e.jsxs(e.Fragment,{children:[e.jsxs($t,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>re(I.id,"Investigating"),children:[e.jsx(kl,{className:"h-4 w-4"})," Investigate"]}),e.jsxs($t,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>D(I.id),children:[e.jsx(tt,{className:"h-4 w-4"})," Resolve"]})]}):e.jsx(wt,{label:"Done",tone:"good"}),I.kind==="Failed charge"&&I.txId?e.jsxs($t,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>v(I.txId),children:[e.jsx(Mr,{className:"h-4 w-4"})," Retry"]}):null]})]})},I.id)}),De.length?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No exceptions."})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-2",children:[e.jsxs(fl,{title:"Exceptions filters",subtitle:"Search and manage exceptions.",right:e.jsx(wt,{label:"Core",tone:"neutral"}),children:[e.jsx(xi,{label:"Search",value:Fe,onChange:Pe,placeholder:"TX, invoice, message..."}),e.jsx(ud,{label:"Status",value:pe,onChange:I=>Q(I),options:[{value:"All",label:"All"},{value:"Open",label:"Open"},{value:"Investigating",label:"Investigating"},{value:"Resolved",label:"Resolved"}]}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:[e.jsxs($t,{variant:"outline",onClick:()=>{Pe(""),Q("All"),n({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(vn,{className:"h-4 w-4"})," Reset"]}),e.jsxs($t,{variant:"outline",onClick:()=>{V({kind:"Unmatched",severity:"Warning",message:"Manual exception created.",suggestedNext:"Review reconciliation"}),n({title:"Created",message:"Exception created.",kind:"success"})},children:[e.jsx(gt,{className:"h-4 w-4"})," New exception"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Core: exceptions queue covers failed charges and partial payments."})]}),e.jsxs(fl,{title:"Premium",subtitle:"Audit-ready reconciliation reports.",right:e.jsx(wt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"1) Exceptions are linked to transactions and invoices"}),e.jsx("li",{children:"2) Actions are audit logged"}),e.jsx("li",{children:"3) Reports export to JSON for ERP ingestion"})]})}),e.jsx("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:e.jsxs($t,{variant:"outline",onClick:()=>i("reports"),children:[e.jsx(et,{className:"h-4 w-4"})," Open reports"]})})]})]})]}):null,r==="erp"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs(fl,{title:"Mappings",subtitle:"Define GL, cost center, and tax codes for exports.",right:e.jsx(wt,{label:`${$.length}`,tone:"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Scope"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Key"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"GL"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Cost center"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Tax"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Enabled"}),e.jsx("th",{className:"px-4 py-3 font-semibold text-right",children:" "})]})}),e.jsxs("tbody",{children:[$.map(I=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx(wt,{label:I.scope,tone:I.scope==="Default"?"neutral":"info"})}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:I.key}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:I.glCode}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:I.costCenter}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:I.taxCode}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(wt,{label:I.enabled?"On":"Off",tone:I.enabled?"good":"neutral"})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(fy,{actions:[{label:"Edit",icon:e.jsx(kl,{className:"h-4 w-4"}),onClick:()=>U(I)},{label:I.enabled?"Disable":"Enable",onClick:()=>T(Z=>Z.map(Ce=>Ce.id===I.id?{...Ce,enabled:!Ce.enabled}:Ce))},{label:"Delete",icon:e.jsx(Qe,{className:"h-4 w-4"}),variant:"danger",onClick:()=>M(I.id)}]})}),I.memo?e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:I.memo}):null]})]},I.id)),$.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-12 text-center text-sm text-slate-600",children:"No mappings."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: exports can map invoice lines to GL codes, cost centers, and tax codes."})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-2",children:[e.jsxs(fl,{title:"ERP export mappings",subtitle:"GL codes, cost centers, tax codes.",right:e.jsx(wt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"1) Mapping resolution: Vendor, then Marketplace, then Module, then Default"}),e.jsx("li",{children:"2) Used by reconciliation exports and ERP posts"}),e.jsx("li",{children:"3) Keep tax codes consistent with entity VAT settings"})]})}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs($t,{variant:"primary",onClick:()=>U(),children:[e.jsx(gt,{className:"h-4 w-4"})," New mapping"]}),e.jsxs($t,{variant:"outline",onClick:()=>{nb("erp-mappings.json",$),Xe({at:Date.now(),actor:"You",action:"EXPORT",entityRef:"erp-mappings.json",details:"Exported ERP mappings"}),n({title:"Exported",message:"ERP mappings JSON downloaded.",kind:"success"})},children:[e.jsx(pt,{className:"h-4 w-4"})," Export"]})]})]}),e.jsx(fl,{title:"ERP mapping preview",subtitle:"Check how a transaction maps.",right:e.jsx(wt,{label:"Premium",tone:"info"}),children:e.jsx(K,{tx:w,mappings:$,onPickTx:()=>{i("ledger"),n({title:"Pick tx",message:"Select a transaction in the ledger.",kind:"info"})}})})]})]}):null,r==="rules"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(fl,{title:"Auto-match rules",subtitle:"Premium: reconciliation assistant rules.",right:e.jsx(wt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"1) Same vendor and currency is recommended"}),e.jsx("li",{children:"2) Date window controls how far back to match"}),e.jsx("li",{children:"3) Amount tolerance handles small differences"}),e.jsx("li",{children:"4) Confidence threshold prevents risky matches"})]})}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs($t,{variant:"primary",onClick:()=>m(),children:[e.jsx(gt,{className:"h-4 w-4"})," New rule"]}),e.jsxs($t,{variant:"outline",onClick:se,children:[e.jsx(ht,{className:"h-4 w-4"})," Run auto-match"]}),e.jsxs($t,{variant:"outline",onClick:()=>{nb("auto-match-rules.json",g),Xe({at:Date.now(),actor:"You",action:"EXPORT",entityRef:"auto-match-rules.json",details:"Exported rules"}),n({title:"Exported",message:"Rules JSON downloaded.",kind:"success"})},children:[e.jsx(pt,{className:"h-4 w-4"})," Export"]})]})]}),e.jsx(fl,{title:"Rule test",subtitle:"Select a line and see top candidates.",right:e.jsx(wt,{label:"Premium",tone:"info"}),children:Be?e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:Be.invoiceNo}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:Be.description}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Top candidates:"}),e.jsxs("div",{className:"mt-2 space-y-2",children:[fe.slice(0,3).map(I=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:I.tx.id}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[I.tx.vendor,"  ",I.tx.type]})]}),e.jsx(wt,{label:`${Math.round(I.score*100)}%`,tone:I.score>=.9?"good":I.score>=.8?"warn":"neutral"})]})},I.tx.id)),fe.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No candidates found."})]})]}):e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"Select an invoice line in Reconciliation."})})]}),e.jsx("div",{className:"lg:col-span-8",children:e.jsxs(fl,{title:"Rules",subtitle:"Tune behavior and thresholds.",right:e.jsx(wt,{label:`${g.filter(I=>I.enabled).length} enabled`,tone:"neutral"}),children:[e.jsxs("div",{className:"space-y-2",children:[g.map(I=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:I.name}),e.jsx(wt,{label:I.enabled?"On":"Off",tone:I.enabled?"good":"neutral"}),e.jsx(wt,{label:`Min ${Math.round(I.minConfidence*100)}%`,tone:"info"}),e.jsx(wt,{label:`Window ${I.dateWindowDays}d`,tone:"neutral"}),e.jsx(wt,{label:`Tol ${I.amountTolerancePct}%`,tone:"neutral"}),e.jsx(wt,{label:I.allowPartialMatch?"Partial OK":"Full only",tone:I.allowPartialMatch?"info":"neutral"})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(wt,{label:I.requireSameVendor?"Same vendor":"Vendor optional",tone:I.requireSameVendor?"good":"neutral"}),e.jsx(wt,{label:I.requireSameModule?"Same module":"Module optional",tone:I.requireSameModule?"good":"neutral"}),e.jsx(wt,{label:I.requireSameMarketplace?"Same marketplace":"Marketplace optional",tone:I.requireSameMarketplace?"good":"neutral"})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs($t,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>m(I),children:[e.jsx(kl,{className:"h-4 w-4"})," Edit"]}),e.jsx($t,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>y(Z=>Z.map(Ce=>Ce.id===I.id?{...Ce,enabled:!Ce.enabled}:Ce)),children:I.enabled?"Disable":"Enable"}),e.jsx($t,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>f(I.id),children:e.jsx(Qe,{className:"h-4 w-4"})})]})]})},I.id)),g.length?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No rules."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: you can create strict rules for sensitive vendors and looser rules for low risk recurring vendors."})]})})]}):null,r==="reports"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(fl,{title:"Audit-ready reports",subtitle:"Premium reconciliation reports.",right:e.jsx(wt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Matches"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:ve.matches}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Total match records"})]}),e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-emerald-50 text-emerald-700 ring-1 ring-emerald-200",children:e.jsx(ct,{className:"h-5 w-5"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx(O,{label:"Unmatched lines",value:`${ve.unmatchedLines}`,tone:ve.unmatchedLines?"warn":"good",icon:e.jsx(Et,{className:"h-4 w-4"})}),e.jsx(O,{label:"Unmatched posted tx",value:`${ve.unmatchedPostedTransactions}`,tone:ve.unmatchedPostedTransactions?"warn":"good",icon:e.jsx(Wm,{className:"h-4 w-4"})}),e.jsx(O,{label:"Open exceptions",value:`${ve.openExceptions}`,tone:ve.openExceptions?"bad":"good",icon:e.jsx(yt,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs($t,{variant:"primary",onClick:ee,children:[e.jsx(pt,{className:"h-4 w-4"})," Export JSON"]}),e.jsxs($t,{variant:"outline",onClick:()=>ze(!0),children:[e.jsx(kt,{className:"h-4 w-4"})," Preview"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Reports include: matches, unmatched items, exceptions, rules, ERP mappings, and audit log."})]}),e.jsx(fl,{title:"Audit log",subtitle:"Who changed what and when.",right:e.jsx(wt,{label:`${F.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[F.slice(0,10).map(I=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(wt,{label:I.action,tone:"neutral"}),e.jsx(wt,{label:I.actor,tone:"info"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[cd(I.at),"  ",Q4(I.at),"  ",I.entityRef]}),e.jsx("div",{className:"mt-2 text-xs text-slate-700",children:I.details})]}),e.jsx($t,{variant:"outline",className:"px-3 py-2 text-xs",onClick:async()=>{try{await navigator.clipboard.writeText(I.id),n({title:"Copied",message:"Audit ID copied.",kind:"success"})}catch{n({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},children:e.jsx(ss,{className:"h-4 w-4"})})]})},I.id)),F.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No audit events."})]})})]}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs(fl,{title:"Reconciliation overview",subtitle:"Pivot summary over transactions.",right:e.jsx(wt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(N,{rows:o,title:"By vendor",dim:"Vendor"}),e.jsx(N,{rows:o,title:"By module",dim:"Service module"}),e.jsx(N,{rows:o,title:"By transaction type",dim:"Transaction type"}),e.jsx(N,{rows:o,title:"By status",dim:"Transaction status"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: pivot summaries support quicker reconciliation reviews and ERP mapping validation."})]})})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"Q Transactions and Reconciliation v2. Core: ledger, manual matching, reconciliation to invoice lines, exceptions queue. Premium: ERP mappings, auto-match rules, and audit-ready exports."})})]})}),e.jsx(Eh,{open:de,title:"Create match",subtitle:"Match selected invoice line to selected transaction.",onClose:()=>ye(!1),actions:[{label:"Match",onClick:()=>u("Manual",.88)}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx($t,{variant:"outline",onClick:()=>ye(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs($t,{variant:"outline",onClick:()=>{if(!Be||!w)return;const I=Math.min(Ae(Be.id),z(w.id));Le(Z=>({...Z,amount:Math.max(0,Math.round(I))})),n({title:"Suggested",message:"Suggested a safe match amount.",kind:"info"})},children:[e.jsx(lU,{className:"h-4 w-4"})," Suggest"]}),e.jsxs($t,{variant:"primary",onClick:()=>u("Manual",.88),disabled:!Be||!w,children:[e.jsx(tt,{className:"h-4 w-4"})," Match"]})]})]}),children:!Be||!w?e.jsx("div",{className:"text-sm text-slate-600",children:"Select a line and transaction first."}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Line"}),": ",Be.invoiceNo,"  ",Be.id]}),e.jsxs("div",{className:"mt-1",children:[e.jsx("span",{className:"font-semibold",children:"Tx"}),": ",w.id,"  ",w.type,"  ",w.status]}),e.jsxs("div",{className:"mt-1",children:[e.jsx("span",{className:"font-semibold",children:"Line remaining"}),": ",Ea(Ae(Be.id),Be.currency)]}),e.jsxs("div",{className:"mt-1",children:[e.jsx("span",{className:"font-semibold",children:"Tx remaining"}),": ",Ea(z(w.id),w.currency)]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Ah,{label:"Match amount",value:Ke.amount,onChange:I=>Le(Z=>({...Z,amount:Math.max(0,I)})),hint:`Currency ${Be.currency}`}),e.jsx(xi,{label:"Note",value:Ke.note,onChange:I=>Le(Z=>({...Z,note:I})),placeholder:"Optional",hint:"Saved in audit"})]}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: auto-match creates matches with rule ID and confidence score. Manual matches are also audit logged."})]})}),e.jsx(Eh,{open:Ne,title:$e!=null&&$e.id?"Edit rule":"New rule",subtitle:"Reconciliation assistant rule settings.",onClose:()=>ge(!1),actions:[{label:"Save",onClick:S},...$e!=null&&$e.id?[{label:"Delete",onClick:()=>$e&&f($e.id),variant:"danger"}]:[]],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx($t,{variant:"outline",onClick:()=>ge(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[$e!=null&&$e.id?e.jsxs($t,{variant:"danger",onClick:()=>$e&&f($e.id),children:[e.jsx(Qe,{className:"h-4 w-4"})," Delete"]}):null,e.jsxs($t,{variant:"primary",onClick:S,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]})]}),children:$e?e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(xi,{label:"Name",value:$e.name,onChange:I=>ie(Z=>Z&&{...Z,name:I})}),e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Enabled"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"If off, auto-match skips this rule."})]}),e.jsx("button",{type:"button",className:na("relative h-7 w-12 rounded-full border transition",$e.enabled?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>ie(I=>I&&{...I,enabled:!I.enabled}),"aria-label":"Toggle enabled",children:e.jsx("span",{className:na("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",$e.enabled?"left-[22px]":"left-1")})})]})}),e.jsx(Ah,{label:"Date window (days)",value:$e.dateWindowDays,onChange:I=>ie(Z=>Z&&{...Z,dateWindowDays:Math.max(0,I)}),hint:"Max days difference"}),e.jsx(Ah,{label:"Amount tolerance (%)",value:$e.amountTolerancePct,onChange:I=>ie(Z=>Z&&{...Z,amountTolerancePct:hy(I,0,100)}),hint:"Percent diff"}),e.jsx(Ah,{label:"Min confidence (0-100)",value:Math.round($e.minConfidence*100),onChange:I=>ie(Z=>Z&&{...Z,minConfidence:hy(I,0,100)/100}),hint:"Auto-match threshold"}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Constraints"}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx(X,{label:"Require same vendor",enabled:$e.requireSameVendor,onChange:I=>ie(Z=>Z&&{...Z,requireSameVendor:I})}),e.jsx(X,{label:"Require same module",enabled:$e.requireSameModule,onChange:I=>ie(Z=>Z&&{...Z,requireSameModule:I})}),e.jsx(X,{label:"Require same marketplace",enabled:$e.requireSameMarketplace,onChange:I=>ie(Z=>Z&&{...Z,requireSameMarketplace:I})}),e.jsx(X,{label:"Allow partial match",enabled:$e.allowPartialMatch,onChange:I=>ie(Z=>Z&&{...Z,allowPartialMatch:I})})]})]}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Tip: strict rules should be placed above looser ones. This demo picks the best scoring rule."})]}):null}),e.jsx(Eh,{open:Oe,title:Te!=null&&Te.id?"Edit ERP mapping":"New ERP mapping",subtitle:"Map to GL codes, cost centers, and tax codes for exports.",onClose:()=>Se(!1),actions:[{label:"Save",onClick:p},...Te!=null&&Te.id?[{label:"Delete",onClick:()=>Te&&M(Te.id),variant:"danger"}]:[]],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx($t,{variant:"outline",onClick:()=>Se(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[Te!=null&&Te.id?e.jsxs($t,{variant:"danger",onClick:()=>Te&&M(Te.id),children:[e.jsx(Qe,{className:"h-4 w-4"})," Delete"]}):null,e.jsxs($t,{variant:"primary",onClick:p,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]})]}),children:Te?e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(ud,{label:"Scope",value:Te.scope,onChange:I=>Ge(Z=>Z&&{...Z,scope:I}),options:[{value:"Default",label:"Default"},{value:"Module",label:"Module"},{value:"Marketplace",label:"Marketplace"},{value:"Vendor",label:"Vendor"}]}),e.jsx(xi,{label:"Key",value:Te.key,onChange:I=>Ge(Z=>Z&&{...Z,key:I}),placeholder:Te.scope==="Default"?"*":"Rides & Logistics",hint:Te.scope==="Default"?"Use *":"Module, marketplace, or vendor"}),e.jsx(xi,{label:"GL code",value:Te.glCode,onChange:I=>Ge(Z=>Z&&{...Z,glCode:I}),placeholder:"4000"}),e.jsx(xi,{label:"Cost center",value:Te.costCenter,onChange:I=>Ge(Z=>Z&&{...Z,costCenter:I}),placeholder:"OPS-001"}),e.jsx(xi,{label:"Tax code",value:Te.taxCode,onChange:I=>Ge(Z=>Z&&{...Z,taxCode:I}),placeholder:"VAT18"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(A_,{label:"Memo",value:Te.memo,onChange:I=>Ge(Z=>Z&&{...Z,memo:I}),placeholder:"Optional memo",rows:3})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(X,{label:"Enabled",enabled:Te.enabled,onChange:I=>Ge(Z=>Z&&{...Z,enabled:I})})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Resolution order: Vendor, Marketplace, Module, Default."})]}):null}),e.jsx(Eh,{open:We,title:"Reconciliation report preview",subtitle:"Audit-ready summary of matching and exceptions.",onClose:()=>ze(!1),actions:[{label:"Export JSON",onClick:ee}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx($t,{variant:"outline",onClick:()=>ze(!1),children:"Close"}),e.jsxs($t,{variant:"primary",onClick:ee,children:[e.jsx(pt,{className:"h-4 w-4"})," Export JSON"]})]}),children:e.jsx(_,{payload:ae()})})]});function O({label:I,value:Z,tone:Ce,icon:He}){const mt=Ce==="good"?"bg-emerald-50 text-emerald-700":Ce==="warn"?"bg-amber-50 text-amber-800":Ce==="bad"?"bg-rose-50 text-rose-700":Ce==="info"?"bg-blue-50 text-blue-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:I}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:Z})]}),e.jsx("div",{className:na("grid h-10 w-10 place-items-center rounded-2xl",mt),children:He})]})})}function X({label:I,enabled:Z,onChange:Ce}){return e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:I}),e.jsx("button",{type:"button",className:na("relative h-7 w-12 rounded-full border transition",Z?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>Ce(!Z),"aria-label":I,children:e.jsx("span",{className:na("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",Z?"left-[22px]":"left-1")})})]})}function A({rows:I,currency:Z}){const[Ce,He]=d.useState("Vendor"),[mt,ot]=d.useState("Amount"),Nt=d.useMemo(()=>Y4(I,Ce,mt,"amount"),[I,Ce,mt]);return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(ud,{label:"Dimension",value:Ce,onChange:nt=>He(nt),options:["Vendor","Service module","Marketplace","Group","Cost center","Tax code","Transaction type","Transaction status"].map(nt=>({value:nt,label:nt}))}),e.jsx(ud,{label:"Metric",value:mt,onChange:nt=>ot(nt),options:[{value:"Amount",label:"Amount"},{value:"Count",label:"Count"}]})]}),e.jsx("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:Ce}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:mt})]})}),e.jsxs("tbody",{children:[Nt.slice(0,10).map(nt=>e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:nt.key}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:mt==="Amount"?Ea(nt.value,Z):nt.value})]},nt.key)),Nt.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:2,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No rows."})})]})]})})]})}function N({rows:I,title:Z,dim:Ce}){const He=d.useMemo(()=>Y4(I,Ce,"Amount","amount"),[I,Ce]);return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:Z}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Top 6"})]}),e.jsx(wt,{label:"Premium",tone:"info"})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[He.slice(0,6).map(mt=>e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-800",children:mt.key}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:Ea(mt.value,"UGX")})]},mt.key)),He.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No data."})]})]})}function h(I,Z){if(!I)return null;const Ce=Z.filter(nt=>nt.enabled),He=Ce.find(nt=>nt.scope==="Vendor"&&nt.key===I.vendor);if(He)return He;const mt=Ce.find(nt=>nt.scope==="Marketplace"&&nt.key===I.marketplace);if(mt)return mt;const ot=Ce.find(nt=>nt.scope==="Module"&&nt.key===I.serviceModule);return ot||Ce.find(nt=>nt.scope==="Default"&&nt.key==="*")||null}function K({tx:I,mappings:Z,onPickTx:Ce}){if(!I)return e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:["Select a transaction to preview ERP mapping.",e.jsx("div",{className:"mt-3",children:e.jsxs($t,{variant:"outline",onClick:Ce,children:[e.jsx(et,{className:"h-4 w-4"})," Open ledger"]})})]});const He=h(I,Z);return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:I.id}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[I.vendor,"  ",I.serviceModule,I.marketplace!=="-"?`  ${I.marketplace}`:""]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Amount: ",Ea(I.amount,I.currency),"  Status ",I.status]})]}),e.jsx(wt,{label:"Preview",tone:"info"})]}),e.jsxs("div",{className:"mt-3 rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Resolved mapping"}),He?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-2",children:["Scope: ",e.jsx("span",{className:"font-semibold",children:He.scope}),"  Key: ",e.jsx("span",{className:"font-semibold",children:He.key})]}),e.jsxs("div",{className:"mt-1",children:["GL: ",e.jsx("span",{className:"font-semibold",children:He.glCode}),"  Cost center: ",e.jsx("span",{className:"font-semibold",children:He.costCenter}),"  Tax: ",e.jsx("span",{className:"font-semibold",children:He.taxCode})]}),He.memo?e.jsxs("div",{className:"mt-2",children:["Memo: ",He.memo]}):null]}):e.jsx("div",{className:"mt-2",children:"No enabled mapping. Create a default mapping."})]})]})}function _({payload:I}){var Z,Ce;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Summary"}),e.jsxs("div",{className:"mt-2 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx(ke,{label:"Invoice lines",value:String(I.summary.invoiceLines)}),e.jsx(ke,{label:"Transactions",value:String(I.summary.transactions)}),e.jsx(ke,{label:"Matches",value:String(I.summary.matches)}),e.jsx(ke,{label:"Unmatched lines",value:String(I.summary.unmatchedLines)}),e.jsx(ke,{label:"Unmatched posted tx",value:String(I.summary.unmatchedPostedTransactions)}),e.jsx(ke,{label:"Open exceptions",value:String(I.summary.openExceptions)})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Unmatched lines"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Top 8"})]}),e.jsx(wt,{label:"Audit",tone:"info"})]}),e.jsx("div",{className:"mt-3 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Line"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Invoice"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Remaining"})]})}),e.jsxs("tbody",{children:[(I.unmatchedLines||[]).slice(0,8).map(He=>e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:He.lineId}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:He.invoiceNo}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:He.vendor}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Ea(He.amount,"UGX")}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Ea(He.remaining,"UGX")})]},He.lineId)),(Z=I.unmatchedLines)!=null&&Z.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-10 text-center text-sm text-slate-600",children:"None"})})]})]})})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Audit log"}),e.jsxs("div",{className:"mt-3 space-y-2",children:[(I.audit||[]).slice(0,8).map(He=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(wt,{label:He.action,tone:"neutral"}),e.jsx(wt,{label:He.actor,tone:"info"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[cd(new Date(He.at).getTime()),"  ",He.entityRef]}),e.jsx("div",{className:"mt-2 text-xs text-slate-700",children:He.details})]}),e.jsx(wt,{label:"Audit",tone:"info"})]})},He.id)),(Ce=I.audit)!=null&&Ce.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No audit entries."})]})]}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"This preview is a subset. Export JSON to get the full report."})]})}function ke({label:I,value:Z}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:I}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:Z})]})}}const gg={green:"#03CD8C",orange:"#F77F00"};function Nl(...t){return t.filter(Boolean).join(" ")}function kc(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function Jr(t,s,a){return Math.max(s,Math.min(a,t))}function Cc(t){return new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"2-digit"})}function Z4(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function At({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Nl("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Ut({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:gg.green}:t==="accent"?{background:gg.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Nl(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function R_({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:Nl("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:Nl("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function Nn({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:Nl(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:Nl("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function ym({label:t,value:s,onChange:a,hint:l,disabled:n}){return e.jsxs("div",{className:Nl(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",value:s,onChange:r=>a(Number(r.target.value||0)),disabled:n,className:Nl("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function md({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:Nl(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:Nl("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function Mh({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:i=>a(i.target.value),placeholder:l,rows:r,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"})]})}function YE({actions:t}){const[s,a]=qt.useState(!1),l=qt.useRef(null);return qt.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:Nl("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function rb({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="980px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:12,scale:.985},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:12,scale:.985},transition:{duration:.18},className:"fixed inset-x-0 top-[7vh] z-50 mx-auto w-[min(1040px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(YE,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[72vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function D_({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,actions:i}){return d.useEffect(()=>{const o=c=>c.key==="Escape"&&n();return t&&window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,x:18},animate:{opacity:1,x:0},exit:{opacity:0,x:18},transition:{duration:.18},className:Nl("fixed z-50 overflow-hidden border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]","left-2 right-2 bottom-2 top-[10vh] rounded-[28px]","lg:left-auto lg:right-4 lg:top-4 lg:bottom-4 lg:w-[720px]"),role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-base font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i&&e.jsx(YE,{actions:i}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"h-full min-h-0 overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function I_({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(480px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Nl("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function qn({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function ib(t){return t==="Approved"?"good":t==="Blocked"?"bad":"warn"}function Nm(t){return t==="High"?"bad":t==="Medium"?"warn":"good"}function $_(t){return t==="Verified"?"good":t==="Expired"?"bad":"warn"}function pi(t){return t<55?"High":t<80?"Medium":"Low"}function hi(t){const a=Jr(t.rating*10,0,50),l=Jr((t.slaOnTimePct-70)*.6,-20,18),n=Jr(t.negotiatedTerms.discountPct*.8,0,12),r=t.complianceDocs.reduce((x,j)=>j.status==="Expired"?x+18:j.status==="Pending"?x+8:x,0),i=t.status==="Blocked"?40:0,o=t.status==="Pending"?10:0,c=50+a+l+n-r-i-o;return Math.round(Jr(c,0,100))}function L_(t,s){const a=t.riskScore,l=t.preferred?6:0,n=t.negotiatedTerms.discountPct,r=t.slaOnTimePct,i=t.rating,o=y=>t.modules.includes(y),c=y=>t.marketplaces.includes(y);let x=0;s==="Corporate Rides"&&(x=o("Rides & Logistics")?100:0),s==="EV Charging"&&(x=o("EVs & Charging")?100:0),s==="Deals Procurement"&&(x=c("MyLiveDealz")?100:0),s==="Office Supplies"&&(x=c("EVmart")||c("LivingMart")||c("GeneratMart")?100:0),s==="IT Devices"&&(x=c("GadgetMart")?100:0),s==="Facilities Services"&&(x=c("ServiceMart")?100:0),s==="Travel Procurement"&&(x=o("Travel & Tourism")||c("ExpressMart")?100:0);const j=Jr(i*12+r*.25+n*1.2,0,100),g=t.status!=="Approved"?45:0;return Math.round(Jr(.45*x+.35*j+.2*a+l-g,0,100))}function F_(){const t=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],s=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],a=["Corporate Rides","EV Charging","Office Supplies","IT Devices","Facilities Services","Travel Procurement","Deals Procurement"],[l,n]=d.useState([]),r=w=>{const B=kc("toast");n(ue=>[{id:B,...w},...ue].slice(0,4)),window.setTimeout(()=>n(ue=>ue.filter(ne=>ne.id!==B)),3200)},[i,o]=d.useState(()=>{const w=Date.now(),B=(Me,De,fe,me,Xe="")=>({id:kc("DOC"),type:Me,name:me,status:De,issuedAt:w-120*24*60*60*1e3,expiresAt:w+fe*24*60*60*1e3,notes:Xe}),ue=(Me,De,fe,me,Xe)=>({id:kc("CTR"),title:Me,startAt:w-fe*24*60*60*1e3,endAt:w+me*24*60*60*1e3,paymentTerms:"Net 14",discountPct:De,slaText:"On-time delivery 92%+, response < 2h",rateCardName:Xe,notes:"Negotiated for corporate volumes."});return[{id:"V-001",name:"EVzone Rides",country:"Uganda",city:"Kampala",status:"Approved",preferred:!0,categories:["Mobility","Corporate transport"],modules:["Rides & Logistics"],marketplaces:[],rating:4.6,slaOnTimePct:93,negotiatedTerms:{discountPct:7,paymentTerms:"Net 14",warrantyDays:0},riskScore:88,riskLevel:"Low",complianceDocs:[B("License","Verified",200,"Operations license"),B("Insurance","Verified",80,"Liability insurance")],contracts:[ue("Ride services master agreement",7,120,240,"Ride rate card v3.pdf")],lastActiveAt:w-2*60*60*1e3,notes:"Preferred vendor for corporate rides."},{id:"V-002",name:"EVzone Charging",country:"Uganda",city:"Kampala",status:"Approved",preferred:!0,categories:["Energy","EV infrastructure"],modules:["EVs & Charging"],marketplaces:[],rating:4.3,slaOnTimePct:90,negotiatedTerms:{discountPct:5,paymentTerms:"Net 7",warrantyDays:0},riskScore:83,riskLevel:"Low",complianceDocs:[B("License","Verified",180,"Energy operations license"),B("Insurance","Verified",40,"Equipment insurance")],contracts:[ue("Charging credits agreement",5,60,300,"Charging rate card.pdf")],lastActiveAt:w-7*60*60*1e3,notes:"Charging credits supplier."},{id:"V-003",name:"Kampala Office Mart",country:"Uganda",city:"Kampala",status:"Approved",preferred:!1,categories:["Office supplies","Consumables"],modules:["E-Commerce"],marketplaces:["EVmart","GeneratMart"],rating:4.1,slaOnTimePct:86,negotiatedTerms:{discountPct:3,paymentTerms:"Net 14",warrantyDays:14},riskScore:74,riskLevel:"Medium",complianceDocs:[B("Tax/VAT","Verified",140,"VAT certificate"),B("Business registration","Verified",320,"Registration")],contracts:[ue("Office supplies agreement",3,30,200,"Office supplies rate card.xlsx")],lastActiveAt:w-2*24*60*60*1e3,notes:"Local supplier for office and general supplies."},{id:"V-004",name:"Shenzhen Store",country:"China",city:"Shenzhen",status:"Approved",preferred:!1,categories:["Imports","Electronics"],modules:["E-Commerce"],marketplaces:["MyLiveDealz","GadgetMart"],rating:4,slaOnTimePct:82,negotiatedTerms:{discountPct:8,paymentTerms:"Net 30",warrantyDays:90},riskScore:68,riskLevel:"Medium",complianceDocs:[B("Business registration","Verified",300,"Business license"),B("Insurance","Pending",120,"Cargo insurance","Pending verification")],contracts:[ue("Cross-border procurement",8,10,180,"Imports rate card.pdf")],lastActiveAt:w-9*60*60*1e3,notes:"Used for deals procurement. Monitor compliance."},{id:"V-005",name:"ServicePro",country:"Uganda",city:"Kampala",status:"Pending",preferred:!1,categories:["Facilities","Maintenance"],modules:["E-Commerce"],marketplaces:["ServiceMart"],rating:3.8,slaOnTimePct:76,negotiatedTerms:{discountPct:0,paymentTerms:"Due on receipt",warrantyDays:30},riskScore:60,riskLevel:"Medium",complianceDocs:[B("Insurance","Pending",60,"Liability insurance","Awaiting certificate"),B("License","Pending",60,"Trade license")],contracts:[],lastActiveAt:w-14*24*60*60*1e3,notes:"Awaiting onboarding checks."},{id:"V-006",name:"Express CN",country:"China",city:"Wuxi",status:"Blocked",preferred:!1,categories:["Logistics"],modules:["E-Commerce"],marketplaces:["ExpressMart"],rating:2.9,slaOnTimePct:62,negotiatedTerms:{discountPct:0,paymentTerms:"Net 7",warrantyDays:0},riskScore:34,riskLevel:"High",complianceDocs:[B("Insurance","Expired",-10,"Cargo insurance","Expired"),B("Tax/VAT","Pending",90,"Tax certificate")],contracts:[],lastActiveAt:w-40*24*60*60*1e3,notes:"Blocked due to expired insurance and SLA breaches."}].map(Me=>{const De=hi(Me);return{...Me,riskScore:De,riskLevel:pi(De)}}).sort((Me,De)=>Me.status!==De.status?Me.status==="Pending"?-1:1:De.riskScore-Me.riskScore)}),[c,x]=d.useState("directory"),[j,g]=d.useState(""),[y,$]=d.useState("All"),[T,C]=d.useState("All"),[W,L]=d.useState("All"),[R,F]=d.useState("All"),[te,oe]=d.useState(!1),[G,H]=d.useState(!1),[Y,we]=d.useState(null),q=d.useMemo(()=>Y&&i.find(w=>w.id===Y)||null,[Y,i]),[je,_e]=d.useState(!1),[Ee,be]=d.useState(()=>({id:"",name:"",country:"Uganda",city:"Kampala",status:"Pending",preferred:!1,categories:[""],modules:["E-Commerce"],marketplaces:["Other Marketplace"],rating:4,slaOnTimePct:85,negotiatedTerms:{discountPct:0,paymentTerms:"Net 14",warrantyDays:30},riskScore:70,riskLevel:"Medium",complianceDocs:[],contracts:[],lastActiveAt:Date.now(),notes:""})),[Fe,Pe]=d.useState(!1),[pe,Q]=d.useState(()=>({id:"",type:"License",name:"",status:"Pending",issuedAt:Date.now(),expiresAt:Date.now()+180*24*60*60*1e3,notes:""})),[Re,ce]=d.useState(!1),[xe,he]=d.useState(()=>({id:"",title:"",startAt:Date.now()-7*24*60*60*1e3,endAt:Date.now()+180*24*60*60*1e3,paymentTerms:"Net 14",discountPct:0,slaText:"",rateCardName:"",notes:""})),de=d.useMemo(()=>{const w=i.length,B=i.filter(me=>me.status==="Approved").length,ue=i.filter(me=>me.status==="Pending").length,ne=i.filter(me=>me.status==="Blocked").length,Me=i.filter(me=>me.preferred&&me.status==="Approved").length,De=i.filter(me=>me.riskLevel==="High").length,fe=i.reduce((me,Xe)=>{const V=Xe.complianceDocs.some(E=>E.expiresAt&&E.expiresAt<Date.now()+2592e6&&E.status==="Verified");return me+(V?1:0)},0);return{total:w,approved:B,pending:ue,blocked:ne,preferred:Me,highRisk:De,expiringDocs:fe}},[i]),ye=d.useMemo(()=>{const w=j.trim().toLowerCase();return i.filter(B=>y==="All"?!0:B.status===y).filter(B=>T==="All"?!0:B.riskLevel===T).filter(B=>te?B.preferred:!0).filter(B=>W==="All"?!0:B.modules.includes(W)).filter(B=>R==="All"?!0:B.marketplaces.includes(R)).filter(B=>w?`${B.id} ${B.name} ${B.country} ${B.city} ${B.status} ${B.categories.join(" ")} ${B.modules.join(" ")} ${B.marketplaces.join(" ")}`.toLowerCase().includes(w):!0).slice().sort((B,ue)=>B.status!==ue.status?B.status==="Pending"?-1:1:B.preferred!==ue.preferred?B.preferred?-1:1:ue.riskScore-B.riskScore)},[i,j,y,T,te,W,R]),Ke=d.useMemo(()=>i.filter(w=>w.status==="Pending"),[i]),Le=d.useMemo(()=>i.map(B=>{const ue=B.complianceDocs.filter(V=>V.status==="Expired").length,ne=B.complianceDocs.filter(V=>V.status==="Pending").length,Me=B.complianceDocs.filter(V=>V.status==="Verified").length,De=B.complianceDocs.some(V=>V.type==="Insurance"&&V.status==="Verified"),fe=B.complianceDocs.some(V=>V.type==="License"&&V.status==="Verified"),me=B.riskScore,Xe=(ue>0?2:0)+(ne>1?1:0)+(De?0:1)+(fe?0:1)+(B.status==="Blocked"?2:0);return{vendor:B,expired:ue,pending:ne,verified:Me,hasInsurance:De,hasLicense:fe,score:me,redFlags:Xe}}).sort((B,ue)=>ue.redFlags-B.redFlags||B.score-ue.score),[i]),Ne=d.useMemo(()=>{const w=i.filter(B=>B.status==="Approved");return a.map(B=>{const ue=w.map(ne=>({vendor:ne,score:L_(ne,B)})).filter(ne=>ne.score>0).sort((ne,Me)=>Me.score-ne.score);return{category:B,top:ue.slice(0,3)}})},[i]),ge=()=>{const w={vendors:i,exportedAt:new Date().toISOString()},B=new Blob([JSON.stringify(w,null,2)],{type:"application/json"}),ue=URL.createObjectURL(B),ne=document.createElement("a");ne.href=ue,ne.download="corporatepay-vendors.json",ne.click(),URL.revokeObjectURL(ue),r({title:"Exported",message:"Vendors JSON downloaded.",kind:"success"})},$e=async()=>{try{await navigator.clipboard.writeText(JSON.stringify(i,null,2)),r({title:"Copied",message:"Copied vendors JSON to clipboard.",kind:"success"})}catch{r({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},ie=w=>{we(w),H(!0)},Oe=w=>{o(B=>B.map(ue=>{if(ue.id!==w)return ue;const ne=hi(ue);return{...ue,riskScore:ne,riskLevel:pi(ne)}})),r({title:"Risk updated",message:"Vendor risk score recalculated.",kind:"success"})},Se=(w,B)=>{o(ue=>ue.map(ne=>{if(ne.id!==w)return ne;const Me={...ne,status:B},De=hi(Me);return{...Me,riskScore:De,riskLevel:pi(De)}})),r({title:"Updated",message:`Vendor status set to ${B}.`,kind:"success"})},Te=w=>{o(B=>B.map(ue=>ue.id!==w?ue:{...ue,preferred:!ue.preferred})),r({title:"Updated",message:"Preferred vendor updated.",kind:"info"})},Ge=()=>{be({id:"",name:"",country:"Uganda",city:"Kampala",status:"Pending",preferred:!1,categories:[""],modules:["E-Commerce"],marketplaces:["Other Marketplace"],rating:4,slaOnTimePct:85,negotiatedTerms:{discountPct:0,paymentTerms:"Net 14",warrantyDays:30},riskScore:70,riskLevel:"Medium",complianceDocs:[],contracts:[],lastActiveAt:Date.now(),notes:""}),_e(!0)},We=w=>{be(JSON.parse(JSON.stringify(w))),_e(!0)},ze=()=>{if(!Ee.name.trim()){r({title:"Missing name",message:"Vendor name is required.",kind:"warn"});return}const w=Date.now(),B=!Ee.id,ue=Ee.id||kc("V"),ne=Ee.categories.map(fe=>fe.trim()).filter(Boolean),Me={...Ee,id:ue,categories:ne.length?ne:["Other"],lastActiveAt:B?w:Ee.lastActiveAt},De=hi(Me);Me.riskScore=De,Me.riskLevel=pi(De),o(fe=>{const me=fe.findIndex(V=>V.id===ue),Xe=fe.slice();return me>=0?Xe[me]=Me:Xe.unshift(Me),Xe}),r({title:"Saved",message:"Vendor saved.",kind:"success"}),_e(!1),we(ue)},Ue=w=>{o(B=>B.filter(ue=>ue.id!==w)),Y===w&&(we(null),H(!1)),r({title:"Deleted",message:"Vendor deleted.",kind:"info"})},le=()=>{if(!q){r({title:"Select vendor",message:"Open a vendor first.",kind:"warn"});return}Q({id:"",type:"License",name:"",status:"Pending",issuedAt:Date.now()-30*24*60*60*1e3,expiresAt:Date.now()+180*24*60*60*1e3,notes:""}),Pe(!0)},z=()=>{if(!q)return;if(!pe.name.trim()){r({title:"Missing",message:"Document name is required.",kind:"warn"});return}const w={...pe,id:pe.id||kc("DOC")};o(B=>B.map(ue=>{if(ue.id!==q.id)return ue;const ne=ue.complianceDocs.slice(),Me=ne.findIndex(me=>me.id===w.id);Me>=0?ne[Me]=w:ne.unshift(w);const De={...ue,complianceDocs:ne},fe=hi(De);return{...De,riskScore:fe,riskLevel:pi(fe)}})),r({title:"Saved",message:"Compliance document saved.",kind:"success"}),Pe(!1)},Ae=w=>{q&&(o(B=>B.map(ue=>{if(ue.id!==q.id)return ue;const ne={...ue,complianceDocs:ue.complianceDocs.filter(De=>De.id!==w)},Me=hi(ne);return{...ne,riskScore:Me,riskLevel:pi(Me)}})),r({title:"Deleted",message:"Document removed.",kind:"info"}))},Ve=()=>{if(!q){r({title:"Select vendor",message:"Open a vendor first.",kind:"warn"});return}he({id:"",title:"",startAt:Date.now()-7*24*60*60*1e3,endAt:Date.now()+180*24*60*60*1e3,paymentTerms:"Net 14",discountPct:0,slaText:"On-time delivery 90%+, response < 4h",rateCardName:"",notes:""}),ce(!0)},Ye=()=>{if(!q)return;if(!xe.title.trim()){r({title:"Missing",message:"Contract title is required.",kind:"warn"});return}const w={...xe,id:xe.id||kc("CTR")};o(B=>B.map(ue=>{if(ue.id!==q.id)return ue;const ne=ue.contracts.slice(),Me=ne.findIndex(me=>me.id===w.id);Me>=0?ne[Me]=w:ne.unshift(w);const De={...ue,contracts:ne,negotiatedTerms:{...ue.negotiatedTerms,discountPct:Math.max(ue.negotiatedTerms.discountPct,w.discountPct),paymentTerms:w.paymentTerms||ue.negotiatedTerms.paymentTerms}},fe=hi(De);return{...De,riskScore:fe,riskLevel:pi(fe)}})),r({title:"Saved",message:"Contract saved.",kind:"success"}),ce(!1)},Be=w=>{q&&(o(B=>B.map(ue=>{if(ue.id!==q.id)return ue;const ne={...ue,contracts:ue.contracts.filter(De=>De.id!==w)},Me=hi(ne);return{...ne,riskScore:Me,riskLevel:pi(Me)}})),r({title:"Deleted",message:"Contract removed.",kind:"info"}))};return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(I_,{toasts:l,onDismiss:w=>n(B=>B.filter(ue=>ue.id!==w))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:gg.green},children:e.jsx(Xl,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Vendor and Catalog Management"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Vendor directory across modules and marketplaces, allowlist and denylist, compliance docs, contracts, and preferred vendor recommendations."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(At,{label:`Total: ${de.total}`,tone:"neutral"}),e.jsx(At,{label:`Approved: ${de.approved}`,tone:"good"}),e.jsx(At,{label:`Pending: ${de.pending}`,tone:de.pending?"warn":"good"}),e.jsx(At,{label:`Blocked: ${de.blocked}`,tone:de.blocked?"bad":"good"}),e.jsx(At,{label:`Preferred: ${de.preferred}`,tone:"info"}),e.jsx(At,{label:`High risk: ${de.highRisk}`,tone:de.highRisk?"bad":"good"}),e.jsx(At,{label:`Docs expiring: ${de.expiringDocs}`,tone:de.expiringDocs?"warn":"good"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ut,{variant:"outline",onClick:$e,children:[e.jsx(ss,{className:"h-4 w-4"})," Copy JSON"]}),e.jsxs(Ut,{variant:"outline",onClick:ge,children:[e.jsx(pt,{className:"h-4 w-4"})," Export"]}),e.jsxs(Ut,{variant:"outline",onClick:()=>x("requests"),children:[e.jsx(h0,{className:"h-4 w-4"})," Requests (",Ke.length,")"]}),e.jsxs(Ut,{variant:"primary",onClick:Ge,children:[e.jsx(gt,{className:"h-4 w-4"})," New vendor"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"directory",label:"Directory"},{id:"requests",label:"Vendor requests"},{id:"risk",label:"Risk and compliance"},{id:"contracts",label:"Contracts and rate cards"},{id:"recommendations",label:"Preferred recommendations"}].map(w=>e.jsx("button",{className:Nl("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",c===w.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:c===w.id?{background:gg.green}:void 0,onClick:()=>x(w.id),children:w.label},w.id))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[c==="directory"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(qn,{title:"Filters",subtitle:"Search and slice vendor directory.",right:e.jsx(At,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-2 py-2",children:[e.jsx(pa,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:j,onChange:w=>g(w.target.value),placeholder:"Vendor name, module, marketplace...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(md,{label:"Status",value:y,onChange:w=>$(w),options:[{value:"All",label:"All"},{value:"Approved",label:"Approved"},{value:"Pending",label:"Pending"},{value:"Blocked",label:"Blocked"}]}),e.jsx(md,{label:"Risk",value:T,onChange:w=>C(w),options:[{value:"All",label:"All"},{value:"Low",label:"Low"},{value:"Medium",label:"Medium"},{value:"High",label:"High"}]}),e.jsx(md,{label:"Module",value:W,onChange:w=>L(w),options:[{value:"All",label:"All"},...t.map(w=>({value:w,label:w}))]}),e.jsx(md,{label:"Marketplace",value:R,onChange:w=>F(w),options:[{value:"All",label:"All"},...s.map(w=>({value:w,label:w}))],hint:"E-Commerce"})]}),e.jsx("div",{className:"mt-3",children:e.jsx(R_,{enabled:te,onChange:oe,label:"Preferred only",description:"Show preferred vendors first"})}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Ut,{variant:"outline",onClick:()=>{g(""),$("All"),C("All"),L("All"),F("All"),oe(!1),r({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(vn,{className:"h-4 w-4"})," Reset"]}),e.jsxs(Ut,{variant:"outline",onClick:()=>x("risk"),children:[e.jsx(Hm,{className:"h-4 w-4"})," Risk"]}),e.jsxs(Ut,{variant:"outline",onClick:()=>x("recommendations"),children:[e.jsx(Il,{className:"h-4 w-4"})," Recommendations"]})]})]}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: Vendor risk scoring is logic-based initially. Later, you can enrich it with compliance signals and dispute history."})]})}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs(qn,{title:"Vendor directory",subtitle:"Approve vendors (allowlist) or block (denylist). Open a vendor to view compliance and contracts.",right:e.jsx(At,{label:`${ye.length} vendor(s)`,tone:"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Risk"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Rating"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"SLA"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Terms"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Modules"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Marketplaces"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[ye.map(w=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"flex items-start justify-between gap-3",children:e.jsxs("button",{className:"text-left",onClick:()=>ie(w.id),children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:w.name}),w.preferred?e.jsx(At,{label:"Preferred",tone:"info"}):null,e.jsx(At,{label:w.id,tone:"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[w.city,", ",w.country,"  Active ",Z4(w.lastActiveAt)]})]})})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(At,{label:w.status,tone:ib(w.status)})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(At,{label:`${w.riskLevel} (${w.riskScore})`,tone:Nm(w.riskLevel)}),w.complianceDocs.some(B=>B.status==="Expired")?e.jsx(At,{label:"Expired doc",tone:"bad"}):null]})}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[e.jsx("span",{className:"font-semibold text-slate-900",children:w.rating.toFixed(1)})," / 5"]}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[e.jsxs("span",{className:"font-semibold text-slate-900",children:[w.slaOnTimePct,"%"]})," on-time"]}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Discount ",e.jsxs("span",{className:"font-semibold text-slate-900",children:[w.negotiatedTerms.discountPct,"%"]})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Terms ",e.jsx("span",{className:"font-semibold text-slate-900",children:w.negotiatedTerms.paymentTerms})]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[w.modules.slice(0,2).map(B=>e.jsx(At,{label:B,tone:"neutral"},B)),w.modules.length>2?e.jsx(At,{label:`+${w.modules.length-2}`,tone:"neutral"}):null]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[w.marketplaces.slice(0,2).map(B=>e.jsx(At,{label:B,tone:"neutral"},B)),w.marketplaces.length>2?e.jsx(At,{label:`+${w.marketplaces.length-2}`,tone:"neutral"}):null,w.marketplaces.length?null:e.jsx(At,{label:"-",tone:"neutral"})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Ut,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Te(w.id),disabled:w.status!=="Approved",title:w.status!=="Approved"?"Approve first":"",children:e.jsx(Il,{className:"h-4 w-4"})}),e.jsxs(Ut,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>We(w),children:[e.jsx(kl,{className:"h-4 w-4"})," Edit"]}),w.status!=="Approved"?e.jsxs(Ut,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>Se(w.id,"Approved"),children:[e.jsx(Ao,{className:"h-4 w-4"})," Approve"]}):e.jsxs(Ut,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Se(w.id,"Blocked"),children:[e.jsx(Hm,{className:"h-4 w-4"})," Block"]}),e.jsxs(Ut,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ie(w.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]})]})})]},w.id)),ye.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-4 py-12 text-center text-sm text-slate-600",children:"No vendors match your filters."})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Core: allowlist and denylist. Premium: risk scoring, compliance docs, contracts, and preferred recommendations."})]})})]}):null,c==="requests"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(qn,{title:"Requests",subtitle:"Pending vendors awaiting approval.",right:e.jsx(At,{label:`${Ke.length}`,tone:Ke.length?"warn":"good"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Approve vendors to add them to the allowlist. Block vendors to deny access."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Ut,{variant:"primary",onClick:Ge,children:[e.jsx(gt,{className:"h-4 w-4"})," New vendor"]}),e.jsxs(Ut,{variant:"outline",onClick:()=>x("directory"),children:[e.jsx(et,{className:"h-4 w-4"})," Directory"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: onboarding can require compliance documents before approval."})]})}),e.jsx("div",{className:"lg:col-span-8",children:e.jsx(qn,{title:"Pending approvals",subtitle:"Approve or block.",right:e.jsx(At,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[Ke.map(w=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:w.name}),e.jsx(At,{label:w.id,tone:"neutral"}),e.jsx(At,{label:`${w.riskLevel} (${w.riskScore})`,tone:Nm(w.riskLevel)})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[w.city,", ",w.country,"  Rating ",w.rating.toFixed(1),"  SLA ",w.slaOnTimePct,"%"]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[w.modules.map(B=>e.jsx(At,{label:B,tone:"neutral"},B)),w.marketplaces.map(B=>e.jsx(At,{label:B,tone:"neutral"},B))]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Docs: ",w.complianceDocs.length,"  Contracts: ",w.contracts.length]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ut,{variant:"outline",onClick:()=>ie(w.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]}),e.jsxs(Ut,{variant:"primary",onClick:()=>Se(w.id,"Approved"),children:[e.jsx(Ao,{className:"h-4 w-4"})," Approve"]}),e.jsxs(Ut,{variant:"outline",onClick:()=>Se(w.id,"Blocked"),children:[e.jsx(Hm,{className:"h-4 w-4"})," Block"]})]})]})},w.id)),Ke.length?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No pending vendors."})]})})})]}):null,c==="risk"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsxs(qn,{title:"Risk hotspots",subtitle:"High risk or missing compliance.",right:e.jsx(At,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"space-y-2",children:Le.slice(0,8).map(w=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("button",{className:"text-left",onClick:()=>ie(w.vendor.id),children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:w.vendor.name}),e.jsx(At,{label:w.vendor.status,tone:ib(w.vendor.status)}),e.jsx(At,{label:`${w.vendor.riskLevel} (${w.vendor.riskScore})`,tone:Nm(w.vendor.riskLevel)})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Expired: ",w.expired,"  Pending: ",w.pending,"  Verified: ",w.verified]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Insurance: ",w.hasInsurance?"Yes":"No","  License: ",w.hasLicense?"Yes":"No"]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(Ut,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Oe(w.vendor.id),children:[e.jsx(wv,{className:"h-4 w-4"})," Recalc"]}),e.jsxs(Ut,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ie(w.vendor.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]})]})]})},w.vendor.id))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: Attach compliance documents and mark them verified to improve risk score."})]})}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs(qn,{title:"Compliance overview",subtitle:"Doc status across all vendors.",right:e.jsx(At,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Docs"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Verified"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Pending"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Expired"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsx("tbody",{children:i.slice().sort((w,B)=>{const ue=w.complianceDocs.filter(Me=>Me.status==="Expired").length;return B.complianceDocs.filter(Me=>Me.status==="Expired").length-ue||w.riskScore-B.riskScore}).slice(0,10).map(w=>{const B=w.complianceDocs.filter(Me=>Me.status==="Verified").length,ue=w.complianceDocs.filter(Me=>Me.status==="Pending").length,ne=w.complianceDocs.filter(Me=>Me.status==="Expired").length;return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:w.name}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:w.complianceDocs.length}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(At,{label:`${B}`,tone:B?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(At,{label:`${ue}`,tone:ue?"warn":"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(At,{label:`${ne}`,tone:ne?"bad":"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ut,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ie(w.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]}),e.jsxs(Ut,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Oe(w.id),children:[e.jsx(wv,{className:"h-4 w-4"})," Recalc"]})]})})]},w.id)})})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: For enterprise safety, require Insurance + License verified before approval for sensitive categories."})]})})]}):null,c==="contracts"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(qn,{title:"Contracts and rate cards",subtitle:"Premium: contract + rate-card storage.",right:e.jsx(At,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Open a vendor to add contract documents and rate cards. Use negotiated terms for approvals and savings insights."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Ut,{variant:"outline",onClick:()=>x("directory"),children:[e.jsx(et,{className:"h-4 w-4"})," Open directory"]}),e.jsxs(Ut,{variant:"primary",onClick:()=>{!Y&&i[0]&&we(i[0].id),H(!0)},children:[e.jsx(et,{className:"h-4 w-4"})," Open vendor"]})]})]})}),e.jsx("div",{className:"lg:col-span-8",children:e.jsx(qn,{title:"Active contracts",subtitle:"Across all vendors.",right:e.jsx(At,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"space-y-2",children:[i.flatMap(w=>w.contracts.map(B=>({vendor:w,contract:B}))).sort((w,B)=>B.contract.startAt-w.contract.startAt).slice(0,12).map(({vendor:w,contract:B})=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:B.title}),e.jsx(At,{label:w.name,tone:"neutral"}),e.jsx(At,{label:`${B.discountPct}% discount`,tone:B.discountPct?"info":"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[Cc(B.startAt),"  ",Cc(B.endAt),"  ",B.paymentTerms]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Rate card: ",B.rateCardName||"-"]}),B.slaText?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["SLA: ",B.slaText]}):null]}),e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:e.jsxs(Ut,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ie(w.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open vendor"]})})]})},B.id)),i.some(w=>w.contracts.length)?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No contracts yet."})]})})})]}):null,c==="recommendations"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(qn,{title:"How recommendations work",subtitle:"Premium: preferred vendor recommendations by spend category.",right:e.jsx(At,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Recommendations are based on:",e.jsxs("ul",{className:"mt-2 space-y-1",children:[e.jsx("li",{children:"1) Vendor fit (module/marketplace coverage)"}),e.jsx("li",{children:"2) Quality (rating + SLA)"}),e.jsx("li",{children:"3) Savings (negotiated discount)"}),e.jsx("li",{children:"4) Risk score (compliance and history)"}),e.jsx("li",{children:"5) Preferred flag (admin curated)"})]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Tip: Approvals can auto-route to preferred vendors, and non-preferred purchases can require additional approvals."})]})}),e.jsx("div",{className:"lg:col-span-8",children:e.jsx(qn,{title:"Recommended vendors",subtitle:"Top 3 per spend category.",right:e.jsx(At,{label:"Premium",tone:"info"}),children:e.jsx("div",{className:"space-y-3",children:Ne.map(w=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(iy,{className:"h-4 w-4 text-slate-500"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:w.category})]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Top vendors based on fit, savings, and risk."})]}),e.jsx(At,{label:w.top.length?"Available":"No vendors",tone:w.top.length?"good":"warn"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-3",children:[w.top.map(B=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:B.vendor.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Score ",B.score,"/100"]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(At,{label:B.vendor.riskLevel,tone:Nm(B.vendor.riskLevel)}),e.jsx(At,{label:`${B.vendor.rating.toFixed(1)}`,tone:"neutral"}),e.jsx(At,{label:`${B.vendor.slaOnTimePct}% SLA`,tone:"neutral"}),e.jsx(At,{label:`${B.vendor.negotiatedTerms.discountPct}% off`,tone:B.vendor.negotiatedTerms.discountPct?"info":"neutral"})]})]}),B.vendor.preferred?e.jsx(Il,{className:"h-5 w-5 text-amber-500"}):e.jsx(Il,{className:"h-5 w-5 text-slate-300"})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Ut,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ie(B.vendor.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]}),e.jsxs(Ut,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Te(B.vendor.id),disabled:B.vendor.status!=="Approved",children:[e.jsx(Il,{className:"h-4 w-4"})," Preferred"]})]})]},B.vendor.id)),w.top.length?null:e.jsx("div",{className:"md:col-span-3 rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No approved vendors match this category yet."})]})]},w.category))})})})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"R Vendor and Catalog Management v2. Core: vendor directory, allowlist and denylist, metadata. Premium: risk scoring and compliance docs, contracts and rate cards, and preferred vendor recommendations."})})]})}),e.jsx(D_,{open:G,title:q?q.name:"Vendor",subtitle:q?`${q.city}, ${q.country}  ${q.status}  Risk ${q.riskScore}/100`:"",onClose:()=>H(!1),footer:q?e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsxs(Ut,{variant:"outline",onClick:()=>We(q),children:[e.jsx(kl,{className:"h-4 w-4"})," Edit vendor"]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ut,{variant:"outline",onClick:()=>Oe(q.id),children:[e.jsx(wv,{className:"h-4 w-4"})," Recalc risk"]}),e.jsxs(Ut,{variant:"outline",onClick:le,children:[e.jsx(dg,{className:"h-4 w-4"})," Add doc"]}),e.jsxs(Ut,{variant:"outline",onClick:Ve,children:[e.jsx(gt,{className:"h-4 w-4"})," Add contract"]})]})]}):null,children:q?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(At,{label:q.status,tone:ib(q.status)}),e.jsx(At,{label:q.preferred?"Preferred":"Standard",tone:q.preferred?"info":"neutral"}),e.jsx(At,{label:`${q.riskLevel} (${q.riskScore})`,tone:Nm(q.riskLevel)}),e.jsx(At,{label:`${q.rating.toFixed(1)}`,tone:"neutral"}),e.jsx(At,{label:`${q.slaOnTimePct}% SLA`,tone:"neutral"})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Categories: ",q.categories.join(", ")]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Last active: ",Z4(q.lastActiveAt)]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsxs(Ut,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Te(q.id),disabled:q.status!=="Approved",children:[e.jsx(Il,{className:"h-4 w-4"})," ",q.preferred?"Unprefer":"Prefer"]}),q.status!=="Approved"?e.jsxs(Ut,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>Se(q.id,"Approved"),children:[e.jsx(Ao,{className:"h-4 w-4"})," Approve"]}):e.jsxs(Ut,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Se(q.id,"Blocked"),children:[e.jsx(Hm,{className:"h-4 w-4"})," Block"]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Negotiated terms"}),e.jsxs("div",{className:"mt-2",children:["Discount: ",e.jsxs("span",{className:"font-semibold",children:[q.negotiatedTerms.discountPct,"%"]})]}),e.jsxs("div",{className:"mt-1",children:["Payment terms: ",e.jsx("span",{className:"font-semibold",children:q.negotiatedTerms.paymentTerms})]}),e.jsxs("div",{className:"mt-1",children:["Warranty: ",e.jsxs("span",{className:"font-semibold",children:[q.negotiatedTerms.warrantyDays," day(s)"]})]})]}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Coverage"}),e.jsxs("div",{className:"mt-2",children:["Modules: ",q.modules.join(", ")||"-"]}),e.jsxs("div",{className:"mt-1",children:["Marketplaces: ",q.marketplaces.join(", ")||"-"]})]})]}),q.notes?e.jsx("div",{className:"mt-3 rounded-2xl bg-white p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:q.notes}):null]}),e.jsx(qn,{title:"Compliance documents",subtitle:"Premium: licenses, insurance, and verification.",right:e.jsx(At,{label:`${q.complianceDocs.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[q.complianceDocs.map(w=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(At,{label:w.type,tone:"neutral"}),e.jsx(At,{label:w.status,tone:$_(w.status)}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:w.name})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Issued ",w.issuedAt?Cc(w.issuedAt):"-","  Expires ",w.expiresAt?Cc(w.expiresAt):"-"]}),w.notes?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Notes: ",w.notes]}):null]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ut,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{const B=w.status==="Pending"?"Verified":w.status==="Verified"?"Expired":"Pending";o(ue=>ue.map(ne=>{if(ne.id!==q.id)return ne;const Me=ne.complianceDocs.map(me=>me.id===w.id?{...me,status:B}:me),De={...ne,complianceDocs:Me},fe=hi(De);return{...De,riskScore:fe,riskLevel:pi(fe)}})),r({title:"Updated",message:"Document status updated.",kind:"success"})},children:[e.jsx(YF,{className:"h-4 w-4"})," Toggle status"]}),e.jsx(Ut,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>Ae(w.id),children:e.jsx(as,{className:"h-4 w-4"})})]})]})},w.id)),q.complianceDocs.length?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No compliance docs yet. Add License and Insurance for enterprise safety."})]})}),e.jsx(qn,{title:"Contracts and rate cards",subtitle:"Premium: store agreements and rate cards.",right:e.jsx(At,{label:`${q.contracts.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[q.contracts.map(w=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:w.title}),e.jsx(At,{label:`${w.discountPct}% off`,tone:w.discountPct?"info":"neutral"}),e.jsx(At,{label:w.paymentTerms,tone:"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[Cc(w.startAt),"  ",Cc(w.endAt)]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Rate card: ",w.rateCardName||"-"]}),w.slaText?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["SLA: ",w.slaText]}):null,w.notes?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Notes: ",w.notes]}):null]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(Ut,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{he(JSON.parse(JSON.stringify(w))),ce(!0)},children:[e.jsx(kl,{className:"h-4 w-4"})," Edit"]}),e.jsx(Ut,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>Be(w.id),children:e.jsx(as,{className:"h-4 w-4"})})]})]})},w.id)),q.contracts.length?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No contracts. Add a contract and rate card for negotiated pricing."})]})})]}):e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"Select a vendor."})}),e.jsx(rb,{open:je,title:Ee.id?"Edit vendor":"New vendor",subtitle:"Core: vendor directory and allowlist/denylist. Premium: compliance and contracts are added per vendor.",onClose:()=>_e(!1),actions:[{label:"Save",onClick:ze},...Ee.id?[{label:"Delete",onClick:()=>{Ue(Ee.id),_e(!1)},variant:"danger"}]:[]],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Ut,{variant:"outline",onClick:()=>_e(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[Ee.id?e.jsxs(Ut,{variant:"danger",onClick:()=>{Ue(Ee.id),_e(!1)},children:[e.jsx(as,{className:"h-4 w-4"})," Delete"]}):null,e.jsxs(Ut,{variant:"primary",onClick:ze,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Nn,{label:"Vendor name",value:Ee.name,onChange:w=>be(B=>({...B,name:w})),placeholder:"Vendor name"}),e.jsx(md,{label:"Status",value:Ee.status,onChange:w=>be(B=>({...B,status:w})),options:[{value:"Pending",label:"Pending"},{value:"Approved",label:"Approved"},{value:"Blocked",label:"Blocked"}]}),e.jsx(Nn,{label:"Country",value:Ee.country,onChange:w=>be(B=>({...B,country:w})),placeholder:"Country"}),e.jsx(Nn,{label:"City",value:Ee.city,onChange:w=>be(B=>({...B,city:w})),placeholder:"City"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Nn,{label:"Categories (comma separated)",value:Ee.categories.join(", "),onChange:w=>be(B=>({...B,categories:w.split(",").map(ue=>ue.trim())})),placeholder:"Office supplies, Consumables",hint:"Metadata"})}),e.jsx(ym,{label:"Rating (0-5)",value:Ee.rating,onChange:w=>be(B=>({...B,rating:Jr(w,0,5)})),hint:"Internal"}),e.jsx(ym,{label:"SLA on-time percent",value:Ee.slaOnTimePct,onChange:w=>be(B=>({...B,slaOnTimePct:Jr(w,0,100)})),hint:"Internal"}),e.jsx(ym,{label:"Discount percent",value:Ee.negotiatedTerms.discountPct,onChange:w=>be(B=>({...B,negotiatedTerms:{...B.negotiatedTerms,discountPct:Jr(w,0,100)}}))}),e.jsx(ym,{label:"Warranty days",value:Ee.negotiatedTerms.warrantyDays,onChange:w=>be(B=>({...B,negotiatedTerms:{...B.negotiatedTerms,warrantyDays:Math.max(0,w)}}))}),e.jsx(Nn,{label:"Payment terms",value:Ee.negotiatedTerms.paymentTerms,onChange:w=>be(B=>({...B,negotiatedTerms:{...B.negotiatedTerms,paymentTerms:w}})),placeholder:"Net 14"}),e.jsxs("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Modules"}),e.jsx("div",{className:"mt-2 grid grid-cols-1 gap-2 sm:grid-cols-2",children:t.map(w=>{const B=Ee.modules.includes(w);return e.jsxs("button",{type:"button",className:Nl("rounded-2xl border px-3 py-3 text-left",B?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),onClick:()=>be(ue=>({...ue,modules:B?ue.modules.filter(ne=>ne!==w):[...ue.modules,w]})),children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:w}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:B?"Enabled":"Disabled"})]},w)})})]}),e.jsxs("div",{className:Nl("md:col-span-2 rounded-3xl border border-slate-200 bg-white p-4",Ee.modules.includes("E-Commerce")?"":"opacity-60"),children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Marketplaces"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Only relevant when E-Commerce is enabled."}),e.jsx("div",{className:"mt-2 grid grid-cols-1 gap-2 sm:grid-cols-2",children:s.map(w=>{const B=Ee.marketplaces.includes(w),ue=!Ee.modules.includes("E-Commerce");return e.jsxs("button",{type:"button",disabled:ue,className:Nl("rounded-2xl border px-3 py-3 text-left",B?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50",ue&&"cursor-not-allowed"),onClick:()=>{ue||be(ne=>({...ne,marketplaces:B?ne.marketplaces.filter(Me=>Me!==w):[...ne.marketplaces,w]}))},children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:w}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:B?"Enabled":"Disabled"})]},w)})})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Mh,{label:"Notes",value:Ee.notes,onChange:w=>be(B=>({...B,notes:w})),placeholder:"Vendor notes",rows:3})})]})}),e.jsx(rb,{open:Fe,title:pe.id?"Edit compliance doc":"Add compliance doc",subtitle:"Premium: store and verify licenses, insurance, and other compliance documents.",onClose:()=>Pe(!1),actions:[{label:"Save",onClick:z}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Ut,{variant:"outline",onClick:()=>Pe(!1),children:"Cancel"}),e.jsxs(Ut,{variant:"primary",onClick:z,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(md,{label:"Type",value:pe.type,onChange:w=>Q(B=>({...B,type:w})),options:["Business registration","Tax/VAT","License","Insurance","KYC","Other"].map(w=>({value:w,label:w}))}),e.jsx(md,{label:"Status",value:pe.status,onChange:w=>Q(B=>({...B,status:w})),options:["Pending","Verified","Expired"].map(w=>({value:w,label:w}))}),e.jsx(Nn,{label:"Document name",value:pe.name,onChange:w=>Q(B=>({...B,name:w})),placeholder:"Insurance certificate"}),e.jsx(Nn,{label:"Issued date",value:pe.issuedAt?new Date(pe.issuedAt).toISOString().slice(0,10):"",onChange:w=>Q(B=>({...B,issuedAt:new Date(w).getTime()})),type:"date"}),e.jsx(Nn,{label:"Expiry date",value:pe.expiresAt?new Date(pe.expiresAt).toISOString().slice(0,10):"",onChange:w=>Q(B=>({...B,expiresAt:new Date(w).getTime()})),type:"date"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Mh,{label:"Notes",value:pe.notes,onChange:w=>Q(B=>({...B,notes:w})),placeholder:"Verification notes",rows:3})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Upload is simulated here. In production this stores file metadata and secure URLs."})]})}),e.jsx(rb,{open:Re,title:xe.id?"Edit contract":"Add contract",subtitle:"Premium: contract + rate card storage and negotiated pricing.",onClose:()=>ce(!1),actions:[{label:"Save",onClick:Ye}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Ut,{variant:"outline",onClick:()=>ce(!1),children:"Cancel"}),e.jsxs(Ut,{variant:"primary",onClick:Ye,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Nn,{label:"Title",value:xe.title,onChange:w=>he(B=>({...B,title:w})),placeholder:"Master services agreement"}),e.jsx(Nn,{label:"Rate card name",value:xe.rateCardName,onChange:w=>he(B=>({...B,rateCardName:w})),placeholder:"Rate card.pdf"}),e.jsx(Nn,{label:"Start date",type:"date",value:new Date(xe.startAt).toISOString().slice(0,10),onChange:w=>he(B=>({...B,startAt:new Date(w).getTime()}))}),e.jsx(Nn,{label:"End date",type:"date",value:new Date(xe.endAt).toISOString().slice(0,10),onChange:w=>he(B=>({...B,endAt:new Date(w).getTime()}))}),e.jsx(Nn,{label:"Payment terms",value:xe.paymentTerms,onChange:w=>he(B=>({...B,paymentTerms:w})),placeholder:"Net 14"}),e.jsx(ym,{label:"Discount percent",value:xe.discountPct,onChange:w=>he(B=>({...B,discountPct:Jr(w,0,100)}))}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Mh,{label:"SLA text",value:xe.slaText,onChange:w=>he(B=>({...B,slaText:w})),placeholder:"On-time 92%+, response < 2h",rows:3})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Mh,{label:"Notes",value:xe.notes,onChange:w=>he(B=>({...B,notes:w})),placeholder:"Optional",rows:3})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Rate card upload is simulated. In production you store files with access control."})]})})]})}const hx={green:"#03CD8C",orange:"#F77F00"};function Oa(...t){return t.filter(Boolean).join(" ")}function Ma(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function U_(t){return new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"2-digit"})}function xd(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function eC(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function nn(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function Sc(t,s){const a=Math.round(Number(t||0));try{return new Intl.NumberFormat(void 0,{style:"currency",currency:s,maximumFractionDigits:0}).format(a)}catch{return`${s} ${a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}}function Tt({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Oa("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Vt({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:hx.green}:t==="accent"?{background:hx.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Oa(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function zn({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:Oa(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:Oa("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function wm({label:t,value:s,onChange:a,hint:l,disabled:n}){return e.jsxs("div",{className:Oa(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",value:s,onChange:r=>a(Number(r.target.value||0)),disabled:n,className:Oa("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function pd({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:Oa(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:Oa("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function km({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4,disabled:i}){return e.jsxs("div",{className:Oa(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:o=>a(o.target.value),placeholder:l,rows:r,disabled:i,className:Oa("mt-2 w-full rounded-2xl border p-3 text-sm font-semibold shadow-sm outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function il({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function Ac({title:t,subtitle:s}){return e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(kt,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:s})]})}function V_({actions:t}){const[s,a]=qt.useState(!1),l=qt.useRef(null);return qt.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:Oa("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function Ph({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="980px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:12,scale:.985},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:12,scale:.985},transition:{duration:.18},className:"fixed inset-x-0 top-[7vh] z-50 mx-auto w-[min(1020px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(V_,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[72vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function __({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(480px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Oa("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function B_(){return["Delivery inspection completed","Warranty documents received","Commissioning completed","Training provided","Acceptance signed"].map(s=>({id:Ma("CHK"),label:s,done:!1}))}function G_(){return`ASSET-${Math.floor(1e3+Math.random()*9e3)}`}function ob(t,s,a,l){const n={Manager:"Manager",Finance:"Finance Desk",CFO:"CFO",CEO:"CEO","EVzone Support":"EVzone Support"};let r=t.steps.slice();if(t.appliesTo==="Any"&&l>=15e6&&!r.some(i=>i.role==="CFO")&&(r=[...r,{role:"CFO",slaHours:24}]),a==="CapEx"){const i=r.some(c=>c.role==="CFO"),o=r.some(c=>c.role==="CEO");i||(r=[...r,{role:"CFO",slaHours:24}]),o||(r=[...r,{role:"CEO",slaHours:24}])}return r.map(i=>({id:Ma("APR"),role:i.role,assignee:n[i.role]||i.role,status:"Pending",slaHours:i.slaHours,requestedAt:s}))}function q_(){var S,f,U;const t=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],s=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],[a,l]=d.useState([]),n=p=>{const M=Ma("toast");l(ee=>[{id:M,...p},...ee].slice(0,4)),window.setTimeout(()=>l(ee=>ee.filter(b=>b.id!==M)),3200)},[r,i]=d.useState(()=>[{id:"TPL-OPEX",name:"Standard OpEx",appliesTo:"OpEx",minAmountUGX:0,description:"Manager then Finance approval. Suitable for routine procurement.",steps:[{role:"Manager",slaHours:8},{role:"Finance",slaHours:12}]},{id:"TPL-CAPEX",name:"Executive CapEx",appliesTo:"CapEx",minAmountUGX:0,description:"Manager then CFO then CEO. For high value assets and CapEx.",steps:[{role:"Manager",slaHours:8},{role:"CFO",slaHours:24},{role:"CEO",slaHours:24}]},{id:"TPL-HIGH",name:"High Value OpEx",appliesTo:"Any",minAmountUGX:1e7,description:"Manager and Finance. CFO added automatically when estimate is high.",steps:[{role:"Manager",slaHours:8},{role:"Finance",slaHours:12}]}]),[o]=d.useState(()=>[{id:"V-001",name:"EVzone Rides",country:"Uganda",rating:4.6,status:"Approved",riskLevel:"Low",riskScore:88,categories:["Mobility","Corporate transport"],modules:["Rides & Logistics"],marketplaces:[],negotiatedDiscountPct:7,slaOnTimePct:93},{id:"V-002",name:"EVzone Charging",country:"Uganda",rating:4.3,status:"Approved",riskLevel:"Low",riskScore:83,categories:["Energy","EV infrastructure"],modules:["EVs & Charging"],marketplaces:[],negotiatedDiscountPct:5,slaOnTimePct:90},{id:"V-010",name:"Shenzhen EV Motors",country:"China",rating:4.2,status:"Approved",riskLevel:"Medium",riskScore:74,categories:["Vehicles","Fleet"],modules:["E-Commerce"],marketplaces:["MyLiveDealz","EVmart"],negotiatedDiscountPct:10,slaOnTimePct:84},{id:"V-011",name:"Kampala Auto Supplier",country:"Uganda",rating:4,status:"Approved",riskLevel:"Medium",riskScore:70,categories:["Vehicles","Service"],modules:["E-Commerce"],marketplaces:["EVmart","ServiceMart"],negotiatedDiscountPct:4,slaOnTimePct:86},{id:"V-020",name:"Express CN",country:"China",rating:2.9,status:"Blocked",riskLevel:"High",riskScore:34,categories:["Logistics"],modules:["E-Commerce"],marketplaces:["ExpressMart"],negotiatedDiscountPct:0,slaOnTimePct:62}]),[c]=d.useState(()=>({opExMonthlyLimitUGX:12e6,opExMonthlyUsedUGX:98e5,capExAnnualLimitUGX:15e7,capExAnnualUsedUGX:42e6})),x=Math.max(0,c.opExMonthlyLimitUGX-c.opExMonthlyUsedUGX),j=Math.max(0,c.capExAnnualLimitUGX-c.capExAnnualUsedUGX),[g,y]=d.useState(()=>{const p=Date.now(),M={id:"RFQ-001",title:"Company vehicle procurement",createdAt:p-6*24*60*60*1e3,createdBy:"Procurement Desk",status:"Sent",fundingType:"CapEx",serviceModule:"E-Commerce",marketplace:"EVmart",category:"Vehicle",specs:"Electric SUV. Minimum 400km range. Right-hand drive. Warranty 5 years.",quantity:1,unit:"Unit",deliveryLocation:"Millennium House, Nsambya Road 472, Kampala",warrantyNeeds:"5 years vehicle, 8 years battery",attachments:[{id:Ma("AT"),name:"Vehicle specs.pdf",note:"Initial specs",uploadedAt:p-6*24*60*60*1e3,uploadedBy:"Procurement Desk"}],estimatedBudgetUGX:9e7,capexJustification:"High value asset cannot fit monthly OpEx. Requires CapEx approval.",approvalTemplateId:"TPL-CAPEX",approvals:ob({appliesTo:"CapEx",steps:[{role:"Manager",slaHours:8},{role:"CFO",slaHours:24},{role:"CEO",slaHours:24}]},p-6*24*60*60*1e3,"CapEx",9e7).map((b,ae)=>({...b,status:ae<3?"Approved":"Pending",decidedAt:p-5*24*60*60*1e3,decisionNote:"Approved"})),invited:[{vendorId:"V-010",status:"Invited",invitedAt:p-5*24*60*60*1e3,lastSeenAt:p-4*24*60*60*1e3},{vendorId:"V-011",status:"Quoted",invitedAt:p-5*24*60*60*1e3,lastSeenAt:p-2*24*60*60*1e3}],qna:[{id:Ma("QNA"),at:p-4*24*60*60*1e3,by:"Buyer",message:"Confirm charging standard and warranty terms.",attachments:[]},{id:Ma("QNA"),at:p-4*24*60*60*1e3+3*60*60*1e3,by:"Vendor",vendorId:"V-011",message:"Supports CCS2. Warranty 5y vehicle and 8y battery.",attachments:[]}],quotes:[{id:"QT-001",rfqId:"RFQ-001",vendorId:"V-011",createdAt:p-2*24*60*60*1e3,status:"Submitted",currency:"UGX",total:88e6,leadTimeDays:30,warrantyMonths:60,paymentTerms:"30% deposit, 60% on delivery, 10% commissioning",notes:"Includes delivery and registration assistance.",attachments:[{id:Ma("AT"),name:"Quote.pdf",note:"Quotation",uploadedAt:p-2*24*60*60*1e3,uploadedBy:"Kampala Auto Supplier"}],lineItems:[{description:"Electric SUV",qty:1,unitPrice:88e6}]}],selectedQuoteId:"QT-001",po:{id:"PO-001",rfqId:"RFQ-001",vendorId:"V-011",createdAt:p-1*24*60*60*1e3,status:"Issued",total:88e6,currency:"UGX",deliverTo:"Millennium House, Nsambya Road 472, Kampala",deliverByDays:30,shippingTerms:"DAP Kampala",milestones:[{id:Ma("MS"),name:"Deposit",pct:30,dueInDays:2,status:"Invoiced"},{id:Ma("MS"),name:"Delivery",pct:60,dueInDays:30,status:"Planned"},{id:Ma("MS"),name:"Commissioning",pct:10,dueInDays:40,status:"Planned"}],notes:"Milestone payments required."},assets:[]},ee={id:"RFQ-002",title:"Office generator replacement",createdAt:p-3*24*60*60*1e3,createdBy:"Admin",status:"Approval pending",fundingType:"OpEx",serviceModule:"E-Commerce",marketplace:"ServiceMart",category:"Equipment",specs:"Backup generator 50kVA, installation required.",quantity:1,unit:"Unit",deliveryLocation:"Kampala HQ",warrantyNeeds:"Minimum 1 year",attachments:[],estimatedBudgetUGX:18e6,capexJustification:"",approvalTemplateId:"TPL-HIGH",approvals:ob({appliesTo:"Any",steps:[{role:"Manager",slaHours:8},{role:"Finance",slaHours:12}]},p-3*24*60*60*1e3,"OpEx",18e6),invited:[],qna:[],quotes:[],assets:[]};return[M,ee]}),[$,T]=d.useState(()=>"RFQ-001"),C=d.useMemo(()=>g.find(p=>p.id===$)||null,[g,$]),[W,L]=d.useState("rfqs"),[R,F]=d.useState("Overview"),[te,oe]=d.useState(0),[G,H]=d.useState(()=>({title:"",fundingType:"OpEx",serviceModule:"E-Commerce",marketplace:"EVmart",category:"Vehicle",specs:"",quantity:1,unit:"Unit",deliveryLocation:"",warrantyNeeds:"",estimatedBudgetUGX:0,capexJustification:"",approvalTemplateId:"TPL-OPEX",vendorIds:[],attachments:[]})),[Y,we]=d.useState(!1),[q,je]=d.useState({name:"",note:""}),[_e,Ee]=d.useState(!1),[be,Fe]=d.useState("Please submit your quotation with lead time and warranty."),[Pe,pe]=d.useState(!1),[Q,Re]=d.useState({vendorId:"",total:0,leadTimeDays:30,warrantyMonths:12,paymentTerms:"Net 14",notes:""}),[ce,xe]=d.useState(!1),[he,de]=d.useState({type:"Vehicle",description:"",serialNo:"",location:"Kampala HQ",assignedTo:""}),[ye,Ke]=d.useState(""),[Le,Ne]=d.useState(""),ge=d.useMemo(()=>{const p=g.filter(ae=>ae.status!=="Closed").length,M=g.filter(ae=>ae.status==="Approval pending").length,ee=g.reduce((ae,ve)=>ae+ve.quotes.length,0),b=g.filter(ae=>ae.fundingType==="CapEx").length;return{active:p,pendingApprovals:M,quotes:ee,capex:b}},[g]),$e=d.useMemo(()=>(G.estimatedBudgetUGX||0)<=x,[G.estimatedBudgetUGX,x]),ie=d.useMemo(()=>{const p=G.estimatedBudgetUGX||0;return p<=0?G.fundingType:p>x?"CapEx":"OpEx"},[G.fundingType,G.estimatedBudgetUGX,x]),Oe=(p,M)=>{y(ee=>ee.map(b=>b.id===p?{...b,...M}:b))},Se=(p,M)=>{y(ee=>ee.map(b=>b.id===p?{...b,attachments:[M,...b.attachments]}:b))},Te=p=>n({title:p,message:"Downloaded file.",kind:"success"}),Ge=()=>{if(!C)return;const p={rfq:C,exportedAt:new Date().toISOString()},M=new Blob([JSON.stringify(p,null,2)],{type:"application/json"}),ee=URL.createObjectURL(M),b=document.createElement("a");b.href=ee,b.download=`rfq-${C.id}.json`,b.click(),URL.revokeObjectURL(ee),Te("Exported")},We=()=>{if(!C)return;const p=C.quotes.map(A=>{const N=o.find(h=>h.id===A.vendorId);return{rfqId:C.id,vendor:(N==null?void 0:N.name)||A.vendorId,currency:A.currency,total:A.total,leadTimeDays:A.leadTimeDays,warrantyMonths:A.warrantyMonths,paymentTerms:A.paymentTerms,notes:A.notes}}),M=A=>{const N=String(A??"");return/[",\n]/.test(N)?`"${N.replace(/"/g,'""')}"`:N},ee=["rfqId","vendor","currency","total","leadTimeDays","warrantyMonths","paymentTerms","notes"].join(","),b=p.map(A=>[A.rfqId,A.vendor,A.currency,A.total,A.leadTimeDays,A.warrantyMonths,A.paymentTerms,A.notes].map(M).join(",")).join(`
`),ae=`${ee}
${b}`,ve=new Blob([ae],{type:"text/csv"}),O=URL.createObjectURL(ve),X=document.createElement("a");X.href=O,X.download=`rfq-${C.id}-quotes.csv`,X.click(),URL.revokeObjectURL(O),Te("Exported")},ze=()=>{if(!C)return;const p=`
      <html>
        <head>
          <title>RFQ ${C.id}</title>
          <style>
            body{font-family: ui-sans-serif, system-ui; padding:24px;}
            .muted{color:#64748b;font-size:12px}
            h2{margin:0}
            table{width:100%; border-collapse:collapse; margin-top:16px}
            th,td{border:1px solid #e2e8f0; padding:10px; font-size:12px}
            th{background:#f8fafc; text-align:left}
          </style>
        </head>
        <body>
          <h2>RFQ ${C.id} - ${C.title}</h2>
          <div class="muted">Status: ${C.status}  Funding: ${C.fundingType}  Created: ${U_(C.createdAt)}</div>
          <div class="muted">Module: ${C.serviceModule}${C.marketplace?`  Marketplace: ${C.marketplace}`:""}</div>
          <div class="muted">Delivery: ${C.deliveryLocation}</div>
          <h3 style="margin-top:16px">Specs</h3>
          <div>${C.specs}</div>
          <h3 style="margin-top:16px">Quotes</h3>
          <table>
            <thead>
              <tr><th>Vendor</th><th>Total</th><th>Lead time</th><th>Warranty</th><th>Terms</th></tr>
            </thead>
            <tbody>
              ${C.quotes.map(ee=>{const b=o.find(ae=>ae.id===ee.vendorId);return`<tr><td>${(b==null?void 0:b.name)||ee.vendorId}</td><td>${ee.currency} ${ee.total}</td><td>${ee.leadTimeDays} days</td><td>${ee.warrantyMonths} months</td><td>${ee.paymentTerms}</td></tr>`}).join("")}
            </tbody>
          </table>
          <div class="muted" style="margin-top:16px">Generated by EVzone CorporatePay</div>
        </body>
      </html>
    `,M=window.open("","_blank");if(!M){n({title:"Popup blocked",message:"Allow popups to print/export PDF.",kind:"warn"});return}M.document.open(),M.document.write(p),M.document.close(),M.focus(),M.print(),n({title:"Print ready",message:"Use Print to PDF to save.",kind:"info"})},Ue=()=>{if(!G.title.trim()){n({title:"Missing",message:"Add an RFQ title.",kind:"warn"});return}if(!G.deliveryLocation.trim()){n({title:"Missing",message:"Add a delivery location.",kind:"warn"});return}if(!G.specs.trim()){n({title:"Missing",message:"Add specifications.",kind:"warn"});return}if(G.estimatedBudgetUGX<=0){n({title:"Missing",message:"Add an estimated budget.",kind:"warn"});return}const p=Date.now(),M=`RFQ-${String(100+Math.floor(Math.random()*900))}`,ee=r.find(X=>X.id===G.approvalTemplateId)||r[0],b=G.fundingType,ae=ob(ee,p,b,G.estimatedBudgetUGX),ve=(G.vendorIds.length?G.vendorIds:o.filter(X=>X.status==="Approved").slice(0,2).map(X=>X.id)).map(X=>({vendorId:X,status:"Not invited"})),O={id:M,title:G.title.trim(),createdAt:p,createdBy:"You",status:"Approval pending",fundingType:b,serviceModule:G.serviceModule,marketplace:G.serviceModule==="E-Commerce"?G.marketplace:void 0,category:G.category.trim()||"High value asset",specs:G.specs.trim(),quantity:Math.max(1,G.quantity),unit:G.unit.trim()||"Unit",deliveryLocation:G.deliveryLocation.trim(),warrantyNeeds:G.warrantyNeeds.trim(),attachments:G.attachments,estimatedBudgetUGX:G.estimatedBudgetUGX,capexJustification:b==="CapEx"?G.capexJustification.trim():"",approvalTemplateId:ee.id,approvals:ae,invited:ve,qna:[],quotes:[],assets:[]};y(X=>[O,...X]),T(M),L("rfqs"),F("Approvals"),n({title:"Submitted",message:"RFQ created and sent for approval.",kind:"success"})},le=p=>{const M=Date.now();y(ee=>ee.map(b=>{if(b.id!==p)return b;const ae=b.approvals.findIndex(X=>X.status==="Pending");if(ae<0)return b;const ve=b.approvals.slice();ve[ae]={...ve[ae],status:"Approved",decidedAt:M,decisionNote:"Approved"};const O=ve.every(X=>X.status==="Approved");return{...b,approvals:ve,status:O?"Approved":b.status}})),n({title:"Approved",message:"Approval step approved.",kind:"success"})},z=p=>{const M=Date.now();y(ee=>ee.map(b=>{if(b.id!==p)return b;const ae=b.approvals.findIndex(O=>O.status==="Pending");if(ae<0)return b;const ve=b.approvals.slice();return ve[ae]={...ve[ae],status:"Rejected",decidedAt:M,decisionNote:"Rejected"},{...b,approvals:ve,status:"Draft"}})),n({title:"Rejected",message:"Approval rejected. RFQ moved back to Draft.",kind:"warn"})},Ae=p=>{const M=Date.now();y(ee=>ee.map(b=>{if(b.id!==p||b.status!=="Approved"&&b.status!=="Sent")return b;const ae=b.invited.map(ve=>ve.status==="Not invited"?{...ve,status:"Invited",invitedAt:M,lastSeenAt:M}:ve);return{...b,invited:ae,status:"Sent"}})),n({title:"Sent",message:"RFQ sent to invited vendors.",kind:"success"})},Ve=(p,M)=>{const ee=Date.now();y(b=>b.map(ae=>{if(ae.id!==p)return ae;const ve=ae.invited.map(O=>O.vendorId===M?{...O,status:O.status==="Invited"?"Viewed":O.status,lastSeenAt:ee}:O);return{...ae,invited:ve}})),n({title:"Updated",message:"Vendor marked as viewed.",kind:"info"})},Ye=p=>{C&&(Re({vendorId:p,total:C.estimatedBudgetUGX||0,leadTimeDays:30,warrantyMonths:24,paymentTerms:"30/60/10",notes:""}),pe(!0))},Be=()=>{if(!C)return;if(!Q.vendorId){n({title:"Missing",message:"Select a vendor.",kind:"warn"});return}if(Q.total<=0){n({title:"Missing",message:"Add a quote total.",kind:"warn"});return}const p=Date.now(),M={id:Ma("QT"),rfqId:C.id,vendorId:Q.vendorId,createdAt:p,status:"Submitted",currency:"UGX",total:Q.total,leadTimeDays:Math.max(1,Q.leadTimeDays),warrantyMonths:Math.max(0,Q.warrantyMonths),paymentTerms:Q.paymentTerms.trim()||"Net 14",notes:Q.notes.trim(),attachments:[{id:Ma("AT"),name:"Quote.pdf",note:"Uploaded",uploadedAt:p,uploadedBy:"Vendor"}],lineItems:[{description:C.category||"Item",qty:C.quantity,unitPrice:Q.total/Math.max(1,C.quantity)}]};y(ee=>ee.map(b=>{if(b.id!==C.id)return b;const ae=[M,...b.quotes],ve=b.invited.map(O=>O.vendorId===M.vendorId?{...O,status:"Quoted",lastSeenAt:p}:O);return{...b,quotes:ae,invited:ve}})),n({title:"Submitted",message:"Quote added.",kind:"success"}),pe(!1),F("Quotes")},w=p=>{C&&(Oe(C.id,{selectedQuoteId:p}),n({title:"Selected",message:"Winning quote selected.",kind:"success"}))},B=()=>{if(!C)return;const p=C.quotes.find(b=>b.id===C.selectedQuoteId);if(!p){n({title:"Select quote",message:"Select a winning quote first.",kind:"warn"});return}const M=Date.now(),ee={id:Ma("PO"),rfqId:C.id,vendorId:p.vendorId,createdAt:M,status:"Draft",total:p.total,currency:p.currency,deliverTo:C.deliveryLocation,deliverByDays:p.leadTimeDays,shippingTerms:"DAP",milestones:[{id:Ma("MS"),name:"Deposit",pct:30,dueInDays:2,status:"Planned"},{id:Ma("MS"),name:"Delivery",pct:60,dueInDays:p.leadTimeDays,status:"Planned"},{id:Ma("MS"),name:"Commissioning",pct:10,dueInDays:p.leadTimeDays+10,status:"Planned"}],notes:"Milestone payments required."};y(b=>b.map(ae=>ae.id===C.id?{...ae,po:ee,status:"Awarded"}:ae)),n({title:"Created",message:"Purchase order created.",kind:"success"}),F("PO")},ue=p=>{C!=null&&C.po&&(y(M=>M.map(ee=>ee.id===C.id?{...ee,po:{...ee.po,status:p}}:ee)),n({title:"Updated",message:`PO status set to ${p}.`,kind:"info"}))},ne=p=>{C!=null&&C.po&&(y(M=>M.map(ee=>{if(ee.id!==C.id||!ee.po)return ee;const b=ee.po.milestones.map(ae=>ae.id===p?{...ae,status:ae.status==="Paid"?"Planned":"Paid"}:ae);return{...ee,po:{...ee.po,milestones:b}}})),n({title:"Updated",message:"Milestone updated.",kind:"success"}))},Me=()=>{if(!(C!=null&&C.po)){n({title:"PO required",message:"Create a PO before adding assets.",kind:"warn"});return}de({type:C.category.toLowerCase().includes("vehicle")?"Vehicle":"Equipment",description:C.title,serialNo:"",location:C.deliveryLocation,assignedTo:""}),xe(!0)},De=()=>{if(!C)return;if(!he.description.trim()){n({title:"Missing",message:"Asset description is required.",kind:"warn"});return}const p=Date.now(),M={id:Ma("AS"),tag:G_(),type:he.type,description:he.description.trim(),serialNo:he.serialNo.trim(),location:he.location.trim()||C.deliveryLocation,assignedTo:he.assignedTo.trim(),createdAt:p,checklist:B_(),attachments:[]};y(ee=>ee.map(b=>b.id===C.id?{...b,assets:[M,...b.assets]}:b)),n({title:"Created",message:"Asset record created.",kind:"success"}),xe(!1),F("Assets")},fe=(p,M)=>{C&&y(ee=>ee.map(b=>{if(b.id!==C.id)return b;const ae=b.assets.map(ve=>{if(ve.id!==p)return ve;const O=ve.checklist.map(X=>X.id===M?{...X,done:!X.done}:X);return{...ve,checklist:O}});return{...b,assets:ae}}))},me=()=>{if(!C)return;if(!ye.trim()){n({title:"Empty",message:"Write a message.",kind:"warn"});return}const p=Date.now(),M={id:Ma("QNA"),at:p,by:Le?"Vendor":"Buyer",vendorId:Le||void 0,message:ye.trim(),attachments:[]};y(ee=>ee.map(b=>b.id===C.id?{...b,qna:[...b.qna,M]}:b)),Ke(""),n({title:"Sent",message:"Message added.",kind:"success"})},Xe=()=>{if(!q.name.trim()){n({title:"Missing",message:"Attachment name required.",kind:"warn"});return}const p=Date.now(),M={id:Ma("AT"),name:q.name.trim(),note:q.note.trim(),uploadedAt:p,uploadedBy:"You"};H(ee=>({...ee,attachments:[M,...ee.attachments]})),je({name:"",note:""}),we(!1),n({title:"Added",message:"Attachment added to draft.",kind:"success"})},V=()=>{if(!C)return;if(!q.name.trim()){n({title:"Missing",message:"Attachment name required.",kind:"warn"});return}const p=Date.now(),M={id:Ma("AT"),name:q.name.trim(),note:q.note.trim(),uploadedAt:p,uploadedBy:"You"};Se(C.id,M),je({name:"",note:""}),we(!1),n({title:"Added",message:"Attachment added.",kind:"success"})},E=()=>{G.estimatedBudgetUGX>0&&G.estimatedBudgetUGX>x&&(H(p=>({...p,fundingType:"CapEx"})),n({title:"Suggested",message:"Estimate exceeds monthly OpEx. Switched to CapEx.",kind:"info"}))},u=p=>p==="Approved"||p==="Awarded"?"good":p==="Approval pending"?"warn":p==="Sent"?"info":"neutral",P=p=>p==="Quoted"?"good":p==="Invited"||p==="Viewed"?"info":p==="Declined"?"bad":"neutral",se=p=>p==="Approved"?"good":p==="Rejected"?"bad":"warn",D=d.useMemo(()=>C!=null&&C.quotes.length?C.quotes.slice().sort((p,M)=>p.total-M.total)[0]:null,[C]),re=d.useMemo(()=>C!=null&&C.selectedQuoteId&&C.quotes.find(p=>p.id===C.selectedQuoteId)||null,[C]),v=d.useMemo(()=>{if(!C||!re)return null;const p=D;if(!p)return null;const M=re.total-p.total;return{best:p.total,selected:re.total,diff:M}},[C,re,D]);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(__,{toasts:a,onDismiss:p=>l(M=>M.filter(ee=>ee.id!==p))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:hx.green},children:e.jsx(kt,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"RFQ and Quote Requests (High Value Assets)"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"RFQ creation, approvals, vendor Q and A, quote comparison, PO conversion, milestone payments, and asset handover."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(Tt,{label:`Active RFQs: ${ge.active}`,tone:"neutral"}),e.jsx(Tt,{label:`Approvals pending: ${ge.pendingApprovals}`,tone:ge.pendingApprovals?"warn":"good"}),e.jsx(Tt,{label:`Quotes received: ${ge.quotes}`,tone:ge.quotes?"info":"neutral"}),e.jsx(Tt,{label:`CapEx: ${ge.capex}`,tone:"info"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Vt,{variant:"outline",onClick:()=>L("rfqs"),children:[e.jsx(et,{className:"h-4 w-4"})," RFQs"]}),e.jsxs(Vt,{variant:"primary",onClick:()=>{L("create"),oe(0),n({title:"Create",message:"Start RFQ creation.",kind:"info"})},children:[e.jsx(gt,{className:"h-4 w-4"})," New RFQ"]}),e.jsxs(Vt,{variant:"outline",onClick:()=>L("templates"),children:[e.jsx(yt,{className:"h-4 w-4"})," Approval templates"]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-4",children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"OpEx remaining"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:nn(x)}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Monthly budget"})]}),e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-slate-50 text-slate-700 ring-1 ring-slate-200",children:e.jsx(Ia,{className:"h-5 w-5"})})]})}),e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"CapEx remaining"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:nn(j)}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Annual allocation"})]}),e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-blue-50 text-blue-700 ring-1 ring-blue-200",children:e.jsx(Er,{className:"h-5 w-5"})})]})}),e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Preferred vendors"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:o.filter(p=>p.status==="Approved"&&p.riskLevel!=="High").length}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Allowlisted vendors"})]}),e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-amber-50 text-amber-800 ring-1 ring-amber-200",children:e.jsx(Il,{className:"h-5 w-5"})})]})}),e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"High value workflow"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold text-slate-900",children:"CapEx and milestones"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Executive approvals"})]}),e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl bg-emerald-50 text-emerald-700 ring-1 ring-emerald-200",children:e.jsx(ct,{className:"h-5 w-5"})})]})})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"rfqs",label:"RFQs"},{id:"create",label:"Create RFQ"},{id:"templates",label:"Approval templates"}].map(p=>e.jsx("button",{className:Oa("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",W===p.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:W===p.id?{background:hx.green}:void 0,onClick:()=>L(p.id),children:p.label},p.id))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[W==="rfqs"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsx(il,{title:"RFQ list",subtitle:"Select an RFQ to manage approvals, vendors, quotes, and conversion.",right:e.jsx(Tt,{label:`${g.length} total`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[g.map(p=>{const M=p.id===$;return e.jsx("button",{type:"button",onClick:()=>{T(p.id),F("Overview")},className:Oa("w-full rounded-3xl border bg-white p-4 text-left hover:bg-slate-50",M?"border-emerald-300 ring-4 ring-emerald-100":"border-slate-200"),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:p.title}),e.jsx(Tt,{label:p.status,tone:u(p.status)}),e.jsx(Tt,{label:p.fundingType,tone:p.fundingType==="CapEx"?"info":"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[p.id,"  Created ",eC(p.createdAt),"  By ",p.createdBy]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[p.serviceModule,p.marketplace?`  ${p.marketplace}`:""]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Estimate"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:nn(p.estimatedBudgetUGX)}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Quotes ",p.quotes.length]})]})]})},p.id)}),g.length?null:e.jsx(Ac,{title:"No RFQs",subtitle:"Create an RFQ to start procurement."})]})}),e.jsx(il,{title:"Quick actions",subtitle:"Common flows.",right:e.jsx(Tt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs(Vt,{variant:"primary",onClick:()=>{L("create"),oe(0)},children:[e.jsx(gt,{className:"h-4 w-4"})," New RFQ"]}),e.jsxs(Vt,{variant:"outline",onClick:()=>{C&&(F("Approvals"),n({title:"Approvals",message:"Open approvals tab.",kind:"info"}))},disabled:!C,children:[e.jsx(yt,{className:"h-4 w-4"})," Approvals"]}),e.jsxs(Vt,{variant:"outline",onClick:()=>F("Quotes"),disabled:!C,children:[e.jsx(Er,{className:"h-4 w-4"})," Quote comparison"]}),e.jsxs(Vt,{variant:"outline",onClick:()=>F("PO"),disabled:!C,children:[e.jsx(kt,{className:"h-4 w-4"})," PO and invoices"]})]})})]}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsx(il,{title:"RFQ details",subtitle:"Manage the selected RFQ.",right:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Vt,{variant:"outline",onClick:Ge,disabled:!C,children:[e.jsx(pt,{className:"h-4 w-4"})," Export JSON"]}),e.jsxs(Vt,{variant:"outline",onClick:ze,disabled:!C,children:[e.jsx(kt,{className:"h-4 w-4"})," Export PDF"]})]}),children:C?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:["Overview","Approvals","Vendors","Quotes","PO","Assets"].map(p=>e.jsx("button",{className:Oa("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",R===p?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:R===p?{background:hx.green}:void 0,onClick:()=>F(p),children:p},p))}),R==="Overview"?e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:C.title}),e.jsx(Tt,{label:C.status,tone:u(C.status)}),e.jsx(Tt,{label:C.fundingType,tone:C.fundingType==="CapEx"?"info":"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[C.id,"  Created ",xd(C.createdAt),"  By ",C.createdBy]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(Tt,{label:C.serviceModule,tone:"neutral"}),C.marketplace?e.jsx(Tt,{label:C.marketplace,tone:"neutral"}):null,e.jsx(Tt,{label:`Qty ${C.quantity} ${C.unit}`,tone:"neutral"}),e.jsx(Tt,{label:`Estimate ${nn(C.estimatedBudgetUGX)}`,tone:"info"})]}),e.jsxs("div",{className:"mt-3 text-sm text-slate-700",children:["Delivery: ",e.jsx("span",{className:"font-semibold",children:C.deliveryLocation})]}),C.warrantyNeeds?e.jsxs("div",{className:"mt-1 text-sm text-slate-700",children:["Warranty: ",e.jsx("span",{className:"font-semibold",children:C.warrantyNeeds})]}):null]}),e.jsxs("div",{className:"flex flex-col items-start gap-2 md:items-end",children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Budget check"}),e.jsxs("div",{className:"mt-1",children:["OpEx remaining: ",e.jsx("span",{className:"font-semibold",children:nn(x)})]}),e.jsxs("div",{className:"mt-1",children:["CapEx remaining: ",e.jsx("span",{className:"font-semibold",children:nn(j)})]}),C.fundingType==="OpEx"&&C.estimatedBudgetUGX>x?e.jsx("div",{className:"mt-2 text-rose-700 font-semibold",children:"Does not fit OpEx. Consider CapEx."}):null]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Vt,{variant:"primary",onClick:()=>le(C.id),disabled:C.status!=="Approval pending"||!C.approvals.some(p=>p.status==="Pending"),children:[e.jsx(tt,{className:"h-4 w-4"})," Approve next"]}),e.jsxs(Vt,{variant:"outline",onClick:()=>Ae(C.id),disabled:!(C.status==="Approved"||C.status==="Sent"),children:[e.jsx(Xs,{className:"h-4 w-4"})," Send RFQ"]})]})]})]})}),e.jsx(il,{title:"Specifications",subtitle:"What vendors will quote against.",right:e.jsx(Tt,{label:"Core",tone:"neutral"}),children:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-sm text-slate-700 ring-1 ring-slate-200 whitespace-pre-wrap",children:C.specs})}),e.jsx(il,{title:"Attachments",subtitle:"Specs, drawings, or requirements.",right:e.jsxs(Vt,{variant:"outline",onClick:()=>{je({name:"",note:""}),we(!0)},children:[e.jsx(dg,{className:"h-4 w-4"})," Add"]}),children:e.jsxs("div",{className:"space-y-2",children:[C.attachments.map(p=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:p.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[xd(p.uploadedAt),"  ",p.uploadedBy]}),p.note?e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Note: ",p.note]}):null]}),e.jsx(Vt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:async()=>{try{await navigator.clipboard.writeText(p.name),n({title:"Copied",message:"Attachment name copied.",kind:"success"})}catch{n({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},children:e.jsx(ss,{className:"h-4 w-4"})})]})},p.id)),C.attachments.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No attachments."})]})})]}):null,R==="Approvals"?e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs(il,{title:"Approval chain",subtitle:"Required approvals before sending RFQ.",right:e.jsx(Tt,{label:((S=r.find(p=>p.id===C.approvalTemplateId))==null?void 0:S.name)||C.approvalTemplateId,tone:"info"}),children:[e.jsxs("div",{className:"space-y-2",children:[C.approvals.map((p,M)=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Tt,{label:`Step ${M+1}`,tone:"neutral"}),e.jsx(Tt,{label:p.role,tone:"neutral"}),e.jsx(Tt,{label:p.status,tone:se(p.status)}),e.jsx(Tt,{label:`SLA ${p.slaHours}h`,tone:"info"})]}),e.jsxs("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:["Assignee: ",p.assignee]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Requested ",xd(p.requestedAt)]}),p.decidedAt?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Decided ",xd(p.decidedAt),"  ",p.decisionNote||""]}):null]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Vt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>le(C.id),disabled:p.status!=="Pending"||C.status!=="Approval pending",children:[e.jsx(tt,{className:"h-4 w-4"})," Approve"]}),e.jsxs(Vt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>z(C.id),disabled:p.status!=="Pending"||C.status!=="Approval pending",children:[e.jsx(Qe,{className:"h-4 w-4"})," Reject"]})]})]})},p.id)),C.approvals.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No approvals configured."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: Executive approval chain templates are used for CapEx and very high value purchases."})]}),e.jsx(il,{title:"Send readiness",subtitle:"RFQ can only be sent after approval.",right:e.jsx(Tt,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Checklist"}),e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsx(k,{ok:!!C.specs.trim(),label:"Specs provided"}),e.jsx(k,{ok:!!C.deliveryLocation.trim(),label:"Delivery location"}),e.jsx(k,{ok:C.invited.length>0,label:"Vendors selected"}),e.jsx(k,{ok:C.approvals.every(p=>p.status==="Approved"),label:"Approvals completed"})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Actions"}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Only available once approved."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Vt,{variant:"primary",onClick:()=>Ae(C.id),disabled:!C.approvals.every(p=>p.status==="Approved"),children:[e.jsx(Xs,{className:"h-4 w-4"})," Send RFQ"]}),e.jsxs(Vt,{variant:"outline",onClick:()=>F("Vendors"),children:[e.jsx(Os,{className:"h-4 w-4"})," Vendors"]})]}),C.fundingType==="CapEx"?e.jsx("div",{className:"mt-3 rounded-2xl bg-blue-50 p-3 text-xs text-blue-700 ring-1 ring-blue-200",children:"CapEx: milestone payments and asset handover will be enabled after quote award."}):null]})]})})]}):null,R==="Vendors"?e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsx(il,{title:"Vendor invitations",subtitle:"Invite vendors to quote and track status.",right:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Vt,{variant:"outline",onClick:()=>Ee(!0),children:[e.jsx(Xs,{className:"h-4 w-4"})," Invite"]}),e.jsxs(Vt,{variant:"outline",onClick:()=>n({title:"Tip",message:"Use vendor allowlist from Vendor Management (R).",kind:"info"}),children:[e.jsx(en,{className:"h-4 w-4"})," Tip"]})]}),children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Rating"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Risk"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Last seen"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[C.invited.map(p=>{const M=o.find(b=>b.id===p.vendorId),ee=(M==null?void 0:M.riskLevel)==="High"?"bad":(M==null?void 0:M.riskLevel)==="Medium"?"warn":"good";return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:(M==null?void 0:M.name)||p.vendorId}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:(M==null?void 0:M.country)||"-"})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Tt,{label:p.status,tone:P(p.status)})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:M?`${M.rating.toFixed(1)} / 5`:"-"}),e.jsx("td",{className:"px-4 py-3",children:M?e.jsx(Tt,{label:`${M.riskLevel} (${M.riskScore})`,tone:ee}):e.jsx(Tt,{label:"-",tone:"neutral"})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:p.lastSeenAt?eC(p.lastSeenAt):"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Vt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Ve(C.id,p.vendorId),disabled:p.status!=="Invited",children:[e.jsx(et,{className:"h-4 w-4"})," Mark viewed"]}),e.jsxs(Vt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>Ye(p.vendorId),disabled:p.status==="Declined",children:[e.jsx(gt,{className:"h-4 w-4"})," Add quote"]})]})})]},p.vendorId)}),C.invited.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-10",children:e.jsx(Ac,{title:"No vendors",subtitle:"Invite vendors to start receiving quotes."})})})]})]})})}),e.jsxs(il,{title:"Q and A thread",subtitle:"Clarify requirements with vendors.",right:e.jsx(Tt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"space-y-2",children:[C.qna.map(p=>{const M=p.vendorId?o.find(b=>b.id===p.vendorId):null,ee=p.by==="Buyer"?"bg-emerald-50 border-emerald-200":"bg-white border-slate-200";return e.jsx("div",{className:Oa("rounded-3xl border p-4",ee),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Tt,{label:p.by,tone:p.by==="Buyer"?"good":"neutral"}),M?e.jsx(Tt,{label:M.name,tone:"info"}):null]}),e.jsx("div",{className:"mt-2 text-sm text-slate-800 whitespace-pre-wrap",children:p.message}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:xd(p.at)})]}),e.jsx(yi,{className:"h-5 w-5 text-slate-400"})]})},p.id)}),C.qna.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No messages yet."})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx(pd,{label:"Post as",value:Le,onChange:Ne,options:[{value:"",label:"Buyer"},...C.invited.map(p=>{var M;return{value:p.vendorId,label:((M=o.find(ee=>ee.id===p.vendorId))==null?void 0:M.name)||p.vendorId}})],hint:"Simulate vendor reply"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(km,{label:"Message",value:ye,onChange:Ke,placeholder:"Ask a question or reply",rows:3})}),e.jsx("div",{className:"md:col-span-3 flex justify-end",children:e.jsxs(Vt,{variant:"primary",onClick:me,children:[e.jsx(tt,{className:"h-4 w-4"})," Send"]})})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: Q and A can require attachments and can be audit logged."})]})]}):null,R==="Quotes"?e.jsx("div",{className:"mt-4 space-y-4",children:e.jsxs(il,{title:"Quote comparison",subtitle:"Compare vendor quotes and select a winner.",right:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Vt,{variant:"outline",onClick:We,children:[e.jsx(pt,{className:"h-4 w-4"})," Export CSV"]}),e.jsxs(Vt,{variant:"primary",onClick:B,children:[e.jsx(kt,{className:"h-4 w-4"})," Convert to PO"]})]}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Total"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Lead time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Warranty"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Terms"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Select"})]})}),e.jsxs("tbody",{children:[C.quotes.slice().sort((p,M)=>p.total-M.total).map(p=>{const M=o.find(ae=>ae.id===p.vendorId),ee=C.selectedQuoteId===p.id,b=(D==null?void 0:D.id)===p.id;return e.jsxs("tr",{className:Oa("border-t border-slate-100 hover:bg-slate-50/60",ee&&"bg-emerald-50/40"),children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:(M==null?void 0:M.name)||p.vendorId}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[p.id,b?"  Best":""]})]}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Sc(p.total,p.currency)}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[p.leadTimeDays," days"]}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[p.warrantyMonths," months"]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:p.paymentTerms}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Tt,{label:p.status,tone:"neutral"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(Vt,{variant:ee?"primary":"outline",className:"px-3 py-2 text-xs",onClick:()=>w(p.id),children:[e.jsx(tt,{className:"h-4 w-4"})," ",ee?"Selected":"Select"]})})]},p.id)}),C.quotes.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10",children:e.jsx(Ac,{title:"No quotes",subtitle:"Invite vendors and add quotes."})})})]})]})}),v?e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Savings analysis"}),e.jsxs("div",{className:"mt-1",children:["Best quote: ",e.jsx("span",{className:"font-semibold",children:Sc(v.best,"UGX")})]}),e.jsxs("div",{className:"mt-1",children:["Selected: ",e.jsx("span",{className:"font-semibold",children:Sc(v.selected,"UGX")})]}),e.jsxs("div",{className:"mt-1",children:["Difference: ",e.jsx("span",{className:Oa("font-semibold",v.diff<=0?"text-emerald-700":"text-rose-700"),children:Sc(v.diff,"UGX")})]})]}):null,e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: quote comparison can include compliance and contract checks and can recommend preferred vendors."})]})}):null,R==="PO"?e.jsx("div",{className:"mt-4 space-y-4",children:e.jsx(il,{title:"Purchase order",subtitle:"Convert quote to PO then track milestone payments and invoices.",right:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Vt,{variant:"outline",onClick:B,children:[e.jsx(gt,{className:"h-4 w-4"})," Create PO"]}),e.jsxs(Vt,{variant:"outline",onClick:()=>n({title:"Invoices",message:"In production, each milestone generates an invoice.",kind:"info"}),children:[e.jsx(kt,{className:"h-4 w-4"})," Invoice schedule"]})]}),children:C.po?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:C.po.id}),e.jsx(Tt,{label:C.po.status,tone:C.po.status==="Accepted"?"good":C.po.status==="Issued"?"info":"neutral"}),re?e.jsx(Tt,{label:((f=o.find(p=>p.id===re.vendorId))==null?void 0:f.name)||re.vendorId,tone:"neutral"}):null]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",xd(C.po.createdAt),"  Deliver by ",C.po.deliverByDays," day(s)"]}),e.jsxs("div",{className:"mt-2 text-sm text-slate-700",children:["Deliver to: ",e.jsx("span",{className:"font-semibold",children:C.po.deliverTo})]}),e.jsxs("div",{className:"mt-1 text-sm text-slate-700",children:["Shipping: ",e.jsx("span",{className:"font-semibold",children:C.po.shippingTerms})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Total"}),e.jsx("div",{className:"mt-1 text-lg font-semibold text-slate-900",children:Sc(C.po.total,C.po.currency)}),e.jsxs("div",{className:"mt-2 flex flex-wrap justify-end gap-2",children:[e.jsxs(Vt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ue("Issued"),children:[e.jsx(Xs,{className:"h-4 w-4"})," Issue"]}),e.jsxs(Vt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ue("Accepted"),children:[e.jsx(ct,{className:"h-4 w-4"})," Accept"]}),e.jsxs(Vt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ue("Closed"),children:[e.jsx(tt,{className:"h-4 w-4"})," Close"]})]})]})]})}),e.jsxs(il,{title:"Milestone payments",subtitle:"Premium: deposit, delivery, commissioning.",right:e.jsx(Tt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Milestone"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Percent"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Due in"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Action"})]})}),e.jsx("tbody",{children:C.po.milestones.map(p=>{const M=Math.round(C.po.total*p.pct/100),ee=p.status==="Paid"?"good":p.status==="Invoiced"?"info":"neutral";return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:p.name}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[p.pct,"%"]}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[p.dueInDays," day(s)"]}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:Sc(M,C.po.currency)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Tt,{label:p.status,tone:ee})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(Vt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ne(p.id),children:[e.jsx(sl,{className:"h-4 w-4"})," Toggle paid"]})})]},p.id)})})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"In production, each milestone produces an invoice and reconciles in Transactions."})]})]}):e.jsx(Ac,{title:"No PO",subtitle:"Select a winning quote and convert to a purchase order."})})}):null,R==="Assets"?e.jsx("div",{className:"mt-4 space-y-4",children:e.jsx(il,{title:"Assets and handover",subtitle:"Premium: asset tagging and handover checklist for vehicles and equipment.",right:e.jsxs(Vt,{variant:"primary",onClick:Me,children:[e.jsx(iy,{className:"h-4 w-4"})," New asset"]}),children:e.jsxs("div",{className:"space-y-3",children:[C.assets.map(p=>{const M=p.checklist.filter(b=>b.done).length,ee=p.checklist.length;return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Tt,{label:p.type,tone:"neutral"}),e.jsx(Tt,{label:p.tag,tone:"info"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:p.description})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",xd(p.createdAt)]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Serial: ",p.serialNo||"-","  Location: ",p.location]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Assigned to: ",p.assignedTo||"-"]})]}),e.jsx("div",{className:"text-right",children:e.jsx(Tt,{label:`${M}/${ee} complete`,tone:M===ee?"good":M>0?"warn":"neutral"})})]}),e.jsx("div",{className:"mt-4 grid grid-cols-1 gap-2",children:p.checklist.map(b=>e.jsxs("label",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("span",{className:Oa("text-sm font-semibold",b.done?"text-emerald-700":"text-slate-800"),children:b.label}),e.jsx("input",{type:"checkbox",checked:b.done,onChange:()=>fe(p.id,b.id),className:"h-4 w-4 rounded border-slate-300"})]},b.id))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: handover checklist can require uploads, signatures, and audit trails."})]},p.id)}),C.assets.length?null:e.jsx(Ac,{title:"No assets",subtitle:"Create an asset record after PO award to track tagging and handover."})]})})}):null]}):e.jsx(Ac,{title:"Select an RFQ",subtitle:"Choose an RFQ from the list to view details."})})})]}):null,W==="create"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(il,{title:"Create RFQ",subtitle:"Wizard for high value procurement.",right:e.jsx(Tt,{label:`Step ${te+1}/5`,tone:"info"}),children:[e.jsx("div",{className:"space-y-2",children:[{i:0,label:"Basics"},{i:1,label:"Specs"},{i:2,label:"Vendors"},{i:3,label:"Budget and approvals"},{i:4,label:"Review"}].map(p=>e.jsx("button",{type:"button",className:Oa("w-full rounded-3xl border bg-white p-4 text-left hover:bg-slate-50",te===p.i?"border-emerald-300 ring-4 ring-emerald-100":"border-slate-200"),onClick:()=>oe(p.i),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:p.label}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Configure ",p.label.toLowerCase()]})]}),te===p.i?e.jsx(et,{className:"h-5 w-5 text-emerald-700"}):null]})},p.i))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: if estimate exceeds OpEx remaining, CapEx is recommended with executive approvals and milestones."})]}),e.jsx(il,{title:"Budget snapshot",subtitle:"Helps decide OpEx vs CapEx.",right:e.jsx(Tt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"OpEx remaining"}),e.jsx("div",{className:"mt-1 text-lg font-semibold text-slate-900",children:nn(x)}),e.jsx("div",{className:"mt-3 text-xs text-slate-500",children:"CapEx remaining"}),e.jsx("div",{className:"mt-1 text-lg font-semibold text-slate-900",children:nn(j)}),G.estimatedBudgetUGX>0?e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Estimate: ",e.jsx("span",{className:"font-semibold",children:nn(G.estimatedBudgetUGX)}),e.jsxs("div",{className:"mt-1",children:["Suggested: ",e.jsx("span",{className:"font-semibold",children:ie})]}),ie==="CapEx"?e.jsx("div",{className:"mt-1 text-rose-700 font-semibold",children:"Does not fit monthly OpEx."}):e.jsx("div",{className:"mt-1 text-emerald-700 font-semibold",children:"Fits monthly OpEx."})]}):null]})})]}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs(il,{title:"RFQ draft",subtitle:"Complete all steps then request approvals.",right:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Vt,{variant:"outline",onClick:()=>{je({name:"",note:""}),we(!0)},children:[e.jsx(dg,{className:"h-4 w-4"})," Attachment"]}),e.jsxs(Vt,{variant:"primary",onClick:Ue,title:"Creates RFQ and sends for approvals",children:[e.jsx(yt,{className:"h-4 w-4"})," Request approvals"]})]}),children:[te===0?e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(zn,{label:"Title",value:G.title,onChange:p=>H(M=>({...M,title:p})),placeholder:"Example: Company vehicle procurement"}),e.jsx(pd,{label:"Funding type",value:G.fundingType,onChange:p=>H(M=>({...M,fundingType:p})),options:[{value:"OpEx",label:"OpEx"},{value:"CapEx",label:"CapEx"}],hint:G.estimatedBudgetUGX>0?`Suggested: ${ie}`:""}),e.jsx(pd,{label:"Service module",value:G.serviceModule,onChange:p=>H(M=>({...M,serviceModule:p})),options:t.map(p=>({value:p,label:p}))}),e.jsx(pd,{label:"Marketplace",value:G.marketplace,onChange:p=>H(M=>({...M,marketplace:p})),options:s.map(p=>({value:p,label:p})),disabled:G.serviceModule!=="E-Commerce",hint:G.serviceModule!=="E-Commerce"?"Only for E-Commerce":""}),e.jsx(zn,{label:"Category",value:G.category,onChange:p=>H(M=>({...M,category:p})),placeholder:"Vehicle, equipment, service"}),e.jsx(wm,{label:"Quantity",value:G.quantity,onChange:p=>H(M=>({...M,quantity:Math.max(1,p)}))}),e.jsx(zn,{label:"Unit",value:G.unit,onChange:p=>H(M=>({...M,unit:p})),placeholder:"Unit"}),e.jsx(wm,{label:"Estimated budget (UGX)",value:G.estimatedBudgetUGX,onChange:p=>H(M=>({...M,estimatedBudgetUGX:Math.max(0,p)})),hint:"Used for approvals"}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs(Vt,{variant:"outline",onClick:E,children:[e.jsx(en,{className:"h-4 w-4"})," Apply suggested funding"]})})]}):null,te===1?e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx(km,{label:"Specifications",value:G.specs,onChange:p=>H(M=>({...M,specs:p})),placeholder:"Detailed requirements",rows:8}),e.jsx(zn,{label:"Delivery location",value:G.deliveryLocation,onChange:p=>H(M=>({...M,deliveryLocation:p})),placeholder:"Address"}),e.jsx(zn,{label:"Warranty needs",value:G.warrantyNeeds,onChange:p=>H(M=>({...M,warrantyNeeds:p})),placeholder:"Warranty requirements"})]}):null,te===2?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Select vendors"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Only approved vendors are recommended."}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2 md:grid-cols-2",children:o.filter(p=>p.status!=="Blocked").map(p=>{const M=G.vendorIds.includes(p.id);return e.jsx("button",{type:"button",className:Oa("rounded-3xl border p-4 text-left",M?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),onClick:()=>H(ee=>({...ee,vendorIds:M?ee.vendorIds.filter(b=>b!==p.id):[...ee.vendorIds,p.id]})),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:p.name}),e.jsx(Tt,{label:p.riskLevel,tone:p.riskLevel==="High"?"bad":p.riskLevel==="Medium"?"warn":"good"}),e.jsx(Tt,{label:`${p.rating.toFixed(1)}`,tone:"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[p.country,"  SLA ",p.slaOnTimePct,"%  Discount ",p.negotiatedDiscountPct,"%"]})]}),e.jsx(Tt,{label:M?"Selected":"Select",tone:M?"good":"neutral"})]})},p.id)})})]}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:["Selected vendors: ",G.vendorIds.length?G.vendorIds.map(p=>{var M;return((M=o.find(ee=>ee.id===p))==null?void 0:M.name)||p}).join(", "):"None"]})]}):null,te===3?e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(pd,{label:"Approval template",value:G.approvalTemplateId,onChange:p=>H(M=>({...M,approvalTemplateId:p})),options:r.filter(p=>p.appliesTo==="Any"||p.appliesTo===G.fundingType).map(p=>({value:p.id,label:`${p.name} (min ${nn(p.minAmountUGX)})`})),hint:"Executive chain for CapEx"}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Budget mode"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"OpEx uses monthly cap. CapEx uses annual allocation."}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[e.jsx(Tt,{label:`OpEx remaining ${nn(x)}`,tone:x?"neutral":"warn"}),e.jsx(Tt,{label:`CapEx remaining ${nn(j)}`,tone:j?"neutral":"warn"})]}),G.estimatedBudgetUGX>0&&!$e?e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"This estimate does not fit monthly OpEx. Use CapEx with executive approvals."}):null]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(km,{label:"CapEx justification",value:G.capexJustification,onChange:p=>H(M=>({...M,capexJustification:p})),placeholder:"Required for CapEx",rows:4,disabled:G.fundingType!=="CapEx",hint:G.fundingType==="CapEx"?"Explain why monthly budget cannot cover":"Not required"})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: CapEx vs OpEx budgeting supports assets that cannot fit monthly budgets."})]}):null,te===4?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Review"}),e.jsxs("div",{className:"mt-2 grid grid-cols-1 gap-2 md:grid-cols-2",children:[e.jsx(m,{label:"Title",value:G.title||"-"}),e.jsx(m,{label:"Funding",value:G.fundingType}),e.jsx(m,{label:"Service module",value:G.serviceModule}),e.jsx(m,{label:"Marketplace",value:G.serviceModule==="E-Commerce"?G.marketplace:"-"}),e.jsx(m,{label:"Estimate",value:G.estimatedBudgetUGX?nn(G.estimatedBudgetUGX):"-"}),e.jsx(m,{label:"Delivery",value:G.deliveryLocation||"-"}),e.jsx(m,{label:"Quantity",value:`${G.quantity} ${G.unit}`}),e.jsx(m,{label:"Vendors",value:G.vendorIds.length?G.vendorIds.map(p=>{var M;return((M=o.find(ee=>ee.id===p))==null?void 0:M.name)||p}).join(", "):"Auto pick"}),e.jsx(m,{label:"Template",value:((U=r.find(p=>p.id===G.approvalTemplateId))==null?void 0:U.name)||G.approvalTemplateId}),e.jsx(m,{label:"Attachments",value:`${G.attachments.length}`})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200 whitespace-pre-wrap",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Specs"}),e.jsx("div",{className:"mt-2",children:G.specs||"-"})]})]}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Clicking Request approvals will create the RFQ and start the approval workflow."})]}):null]})})]}):null,W==="templates"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsxs(il,{title:"Templates",subtitle:"Executive approval chain templates.",right:e.jsx(Tt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"space-y-2",children:r.slice().sort((p,M)=>p.minAmountUGX-M.minAmountUGX).map(p=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:p.name}),e.jsx(Tt,{label:p.appliesTo,tone:p.appliesTo==="CapEx"?"info":"neutral"}),e.jsx(Tt,{label:`Min ${nn(p.minAmountUGX)}`,tone:"neutral"})]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:p.id}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:p.description}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:p.steps.map((M,ee)=>e.jsx(Tt,{label:`${ee+1}. ${M.role} (${M.slaHours}h)`,tone:"neutral"},`${p.id}-${ee}`))})]}),e.jsxs(Vt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{const M={...p,id:Ma("TPL"),name:`${p.name} Copy`};i(ee=>[M,...ee]),n({title:"Duplicated",message:"Template duplicated.",kind:"success"})},children:[e.jsx(ss,{className:"h-4 w-4"})," Duplicate"]})]})},p.id))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: chain templates can vary by module, marketplace, vendor risk, and funding type."})]})}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs(il,{title:"Template guidance",subtitle:"How to choose templates.",right:e.jsx(Tt,{label:"Info",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"1) OpEx uses Manager then Finance for routine purchases."}),e.jsx("li",{children:"2) CapEx uses Manager then CFO then CEO for high value assets."}),e.jsx("li",{children:"3) High value OpEx can add CFO automatically when estimate is above threshold."}),e.jsx("li",{children:"4) Vendor risk score can require extra approvals."})]})}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Next suggested additions"}),e.jsxs("ul",{className:"mt-2 space-y-1",children:[e.jsx("li",{children:" Template per Service Module (Travel, Medical) with stricter SLA"}),e.jsx("li",{children:" Template that includes EVzone Support for regulated categories"}),e.jsx("li",{children:" Escalation if SLA breached"})]})]})]})})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"S RFQ and Quote Requests v2. Core: RFQ flow, vendor invitations and Q and A, quote comparison, convert quote to PO and invoice. Premium: CapEx vs OpEx budgeting, milestone payments, asset tagging and handover checklist, executive approval templates."})})]})}),e.jsx(Ph,{open:Y,title:"Add attachment",subtitle:W==="create"?"Adds attachment to draft.":"Adds attachment to RFQ.",onClose:()=>we(!1),actions:[{label:"Add",onClick:()=>{W==="create"?Xe():V()}}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Vt,{variant:"outline",onClick:()=>we(!1),children:"Cancel"}),e.jsxs(Vt,{variant:"primary",onClick:()=>{W==="create"?Xe():V()},children:[e.jsx(ct,{className:"h-4 w-4"})," Add"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(zn,{label:"File name",value:q.name,onChange:p=>je(M=>({...M,name:p})),placeholder:"Specs.pdf"}),e.jsx(zn,{label:"Note",value:q.note,onChange:p=>je(M=>({...M,note:p})),placeholder:"Optional"}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Upload is simulated. In production, files are stored securely with access control."})]})}),e.jsxs(Ph,{open:_e,title:"Invite vendors",subtitle:"Send RFQ invite with message.",onClose:()=>Ee(!1),actions:[{label:"Send",onClick:()=>{C&&(Ae(C.id),Ee(!1))}}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Vt,{variant:"outline",onClick:()=>Ee(!1),children:"Cancel"}),e.jsxs(Vt,{variant:"primary",onClick:()=>{C&&(Ae(C.id),Ee(!1))},children:[e.jsx(Xs,{className:"h-4 w-4"})," Send"]})]}),children:[e.jsx(km,{label:"Invite message",value:be,onChange:Fe,rows:4}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"In production, invites are delivered via Email, WhatsApp, WeChat, and SMS, with delivery logs."})]}),e.jsx(Ph,{open:Pe,title:"Add quote",subtitle:"Enter quote details for comparison and award.",onClose:()=>pe(!1),actions:[{label:"Save",onClick:Be}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Vt,{variant:"outline",onClick:()=>pe(!1),children:"Cancel"}),e.jsxs(Vt,{variant:"primary",onClick:Be,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(pd,{label:"Vendor",value:Q.vendorId,onChange:p=>Re(M=>({...M,vendorId:p})),options:((C==null?void 0:C.invited)||[]).map(p=>{var M;return{value:p.vendorId,label:((M=o.find(ee=>ee.id===p.vendorId))==null?void 0:M.name)||p.vendorId}})}),e.jsx(wm,{label:"Total (UGX)",value:Q.total,onChange:p=>Re(M=>({...M,total:Math.max(0,p)}))}),e.jsx(wm,{label:"Lead time (days)",value:Q.leadTimeDays,onChange:p=>Re(M=>({...M,leadTimeDays:Math.max(1,p)}))}),e.jsx(wm,{label:"Warranty (months)",value:Q.warrantyMonths,onChange:p=>Re(M=>({...M,warrantyMonths:Math.max(0,p)}))}),e.jsx(zn,{label:"Payment terms",value:Q.paymentTerms,onChange:p=>Re(M=>({...M,paymentTerms:p})),placeholder:"30/60/10 or Net 14"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(km,{label:"Notes",value:Q.notes,onChange:p=>Re(M=>({...M,notes:p})),rows:4})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: quotes can include compliance checks and rate card links."})]})}),e.jsx(Ph,{open:ce,title:"Create asset record",subtitle:"Asset tagging and handover checklist.",onClose:()=>xe(!1),actions:[{label:"Create",onClick:De}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Vt,{variant:"outline",onClick:()=>xe(!1),children:"Cancel"}),e.jsxs(Vt,{variant:"primary",onClick:De,children:[e.jsx(iy,{className:"h-4 w-4"})," Create"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(pd,{label:"Asset type",value:he.type,onChange:p=>de(M=>({...M,type:p})),options:[{value:"Vehicle",label:"Vehicle"},{value:"Equipment",label:"Equipment"},{value:"Other",label:"Other"}]}),e.jsx(zn,{label:"Serial number",value:he.serialNo,onChange:p=>de(M=>({...M,serialNo:p})),placeholder:"Optional"}),e.jsx(zn,{label:"Description",value:he.description,onChange:p=>de(M=>({...M,description:p})),placeholder:"Vehicle or equipment description"}),e.jsx(zn,{label:"Location",value:he.location,onChange:p=>de(M=>({...M,location:p})),placeholder:"Site"}),e.jsx(zn,{label:"Assigned to",value:he.assignedTo,onChange:p=>de(M=>({...M,assignedTo:p})),placeholder:"Department or person"}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"After creation, complete the handover checklist and attach warranty documents."})]})})]});function k({ok:p,label:M}){return e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:M}),p?e.jsx(Tt,{label:"Done",tone:"good"}):e.jsx(Tt,{label:"Pending",tone:"warn"})]})}function m({label:p,value:M}){return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:p}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:M})]})}}const fg={green:"#03CD8C",orange:"#F77F00"};function Ra(...t){return t.filter(Boolean).join(" ")}function wn(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function db(t,s,a){return Math.max(s,Math.min(a,t))}function tC(t){return new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"2-digit"})}function mr(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function z_(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function sC(t,s){const a=Math.round(Number(t||0));try{return new Intl.NumberFormat(void 0,{style:"currency",currency:s,maximumFractionDigits:0}).format(a)}catch{return`${s} ${a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}}function aC(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function Mt({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Ra("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function zt({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:fg.green}:t==="accent"?{background:fg.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Ra(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Ec({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:Ra("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:Ra("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function lC({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:Ra(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:Ra("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function cb({label:t,value:s,onChange:a,hint:l,disabled:n}){return e.jsxs("div",{className:Ra(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",value:s,onChange:r=>a(Number(r.target.value||0)),disabled:n,className:Ra("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function Ur({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:Ra(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:Ra("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function ub({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4,disabled:i}){return e.jsxs("div",{className:Ra(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:o=>a(o.target.value),placeholder:l,rows:r,disabled:i,className:Ra("mt-2 w-full rounded-2xl border p-3 text-sm font-semibold shadow-sm outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function JE({actions:t}){const[s,a]=qt.useState(!1),l=qt.useRef(null);return qt.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:Ra("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function mb({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="980px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:12,scale:.985},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:12,scale:.985},transition:{duration:.18},className:"fixed inset-x-0 top-[7vh] z-50 mx-auto w-[min(1020px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(JE,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[72vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function W_({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,actions:i}){return d.useEffect(()=>{const o=c=>c.key==="Escape"&&n();return t&&window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,x:18},animate:{opacity:1,x:0},exit:{opacity:0,x:18},transition:{duration:.18},className:Ra("fixed z-50 overflow-hidden border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]","left-2 right-2 bottom-2 top-[10vh] rounded-[28px]","lg:left-auto lg:right-4 lg:top-4 lg:bottom-4 lg:w-[760px]"),role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-base font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i&&e.jsx(JE,{actions:i}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"h-full min-h-0 overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function H_({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(480px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Ra("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function Pl({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function Mc({title:t,subtitle:s}){return e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(kt,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:s})]})}function xb(t){return t==="Completed"?"good":t==="In progress"||t==="Confirmed"?"info":t==="Cancelled"||t==="Refunded"?"bad":t==="Rebooked"?"warn":"neutral"}function nC(t){return t==="Critical"?"bad":t==="Warning"?"warn":"info"}function X_(t){return t==="Resolved"?"good":t==="In review"?"info":"warn"}function no(t,s){if(t.status==="Cancelled"||t.status==="Refunded")return{breached:!1,overdueDays:0,lateDays:0};if(t.completedAt){const l=Math.max(0,Math.ceil((t.completedAt-t.dueAt)/864e5));return{breached:l>0,overdueDays:0,lateDays:l}}const a=Math.max(0,Math.ceil((s-t.dueAt)/(24*60*60*1e3)));return{breached:a>0,overdueDays:a,lateDays:0}}function pb(t,s){if(!s||t.currency!=="UGX")return 0;const a=Math.round(t.total*s.penaltyPct/100);return Math.min(a,Math.max(0,s.penaltyCapUGX))}function K_(){var Xe;const t=Date.now(),s=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],a=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],[l,n]=d.useState([]),r=V=>{const E=wn("toast");n(u=>[{id:E,...V},...u].slice(0,4)),window.setTimeout(()=>n(u=>u.filter(P=>P.id!==E)),3200)},[i,o]=d.useState(()=>({autoDisputeOnSlaBreach:!0,autoPenaltyCalc:!0,penaltyApprovalThresholdUGX:5e5,requireApprovalForPenalty:!0})),[c,x]=d.useState(()=>[{id:"V-011",name:"Kampala Auto Supplier",country:"Uganda",status:"Approved",ratingAvg:4.1,ratingCount:28,slaOnTimeTargetPct:90,penaltyPct:2,penaltyCapUGX:25e5,categories:["Vehicles","Fleet"],modules:["E-Commerce"],marketplaces:["EVmart","ServiceMart"]},{id:"V-010",name:"Shenzhen EV Motors",country:"China",status:"Approved",ratingAvg:4.2,ratingCount:41,slaOnTimeTargetPct:85,penaltyPct:1,penaltyCapUGX:3e6,categories:["Vehicles","Imports"],modules:["E-Commerce"],marketplaces:["MyLiveDealz","EVmart"]},{id:"V-001",name:"EVzone Rides",country:"Uganda",status:"Approved",ratingAvg:4.6,ratingCount:290,slaOnTimeTargetPct:95,penaltyPct:1,penaltyCapUGX:8e5,categories:["Mobility"],modules:["Rides & Logistics"],marketplaces:[]},{id:"V-002",name:"EVzone Charging",country:"Uganda",status:"Approved",ratingAvg:4.3,ratingCount:120,slaOnTimeTargetPct:92,penaltyPct:1,penaltyCapUGX:6e5,categories:["Energy"],modules:["EVs & Charging"],marketplaces:[]},{id:"V-020",name:"Express CN",country:"China",status:"Blocked",ratingAvg:2.9,ratingCount:15,slaOnTimeTargetPct:80,penaltyPct:2,penaltyCapUGX:15e5,categories:["Logistics"],modules:["E-Commerce"],marketplaces:["ExpressMart"]}]),j=d.useMemo(()=>Object.fromEntries(c.map(V=>[V.id,V])),[c]),g=(V,E)=>{const u=V.map(P=>({id:wn("TL"),label:P}));return u[0]={...u[0],at:E,note:"Created"},u},[y,$]=d.useState(()=>{const E=Date.now(),u=E-8*864e5,P=E+24*864e5,se=E-2*864e5,D=E-1*864e5+2*60*60*1e3,re=E-12*864e5,v=E-2*864e5,k=E-5*864e5,m=E-2*864e5;return[{id:"FUL-PO-001",ref:"PO-001",type:"Purchase Order",status:"In progress",createdAt:u,dueAt:P,module:"E-Commerce",marketplace:"EVmart",vendorId:"V-011",currency:"UGX",total:88e6,description:"Electric SUV procurement (high value asset)",location:"Millennium House, Nsambya Road 472, Kampala",timeline:g(["PO created","PO issued","Vendor accepted","Deposit paid","In transit","Delivered","Commissioned","Closed"],u),currentStep:4,proofs:[{id:wn("PR"),name:"PO.pdf",type:"Other",note:"Purchase order document",addedAt:u+2*60*60*1e3,addedBy:"Procurement"},{id:wn("PR"),name:"Deposit receipt.jpg",type:"Photo",note:"Deposit paid proof",addedAt:u+4*864e5,addedBy:"Finance"}]},{id:"FUL-RIDE-101",ref:"SCH-RIDE-101",type:"Ride Schedule",status:"Completed",createdAt:se,scheduledAt:se+2*60*60*1e3,dueAt:D,completedAt:D-12*60*1e3,module:"Rides & Logistics",vendorId:"V-001",currency:"UGX",total:165e3,description:"Airport pickup schedule for visiting client",location:"Entebbe Airport  Kampala HQ",timeline:g(["Scheduled","Driver assigned","Picked up","Dropped off"],se),currentStep:3,proofs:[{id:wn("PR"),name:"Trip receipt.pdf",type:"Trip receipt",note:"Receipt and route",addedAt:D,addedBy:"System"}],rating:{stars:5,comment:"On time and professional.",at:D+10*60*1e3}},{id:"FUL-DEL-009",ref:"DEL-009",type:"Delivery",status:"Cancelled",createdAt:re,dueAt:v,module:"E-Commerce",marketplace:"ExpressMart",vendorId:"V-020",currency:"UGX",total:34e4,description:"Document courier to branch",location:"Kampala HQ  Jinja",timeline:g(["Created","Pickup","In transit","Delivered"],re),currentStep:1,proofs:[]},{id:"FUL-SVC-044",ref:"SVC-044",type:"Service Booking",status:"Completed",createdAt:k,dueAt:m,completedAt:m-3*60*60*1e3,module:"E-Commerce",marketplace:"ServiceMart",vendorId:"V-011",currency:"UGX",total:54e4,description:"Office maintenance service booking",location:"Kampala HQ",timeline:g(["Booked","Confirmed","In service","Completed"],k),currentStep:3,proofs:[{id:wn("PR"),name:"Completion log.txt",type:"Completion log",note:"Work completed and signed",addedAt:m-2*60*60*1e3,addedBy:"Vendor"},{id:wn("PR"),name:"Signature.png",type:"Signature",note:"Site sign-off",addedAt:m-2*60*60*1e3,addedBy:"Admin"}],rating:{stars:4,comment:"Good work. Arrived slightly earlier.",at:m-30*60*1e3}}]}),[T,C]=d.useState(()=>[{id:"EX-001",createdAt:Date.now()-2*24*60*60*1e3,kind:"Cancellation",status:"Open",severity:"Warning",fulfillmentId:"FUL-DEL-009",title:"Delivery cancelled",detail:"Delivery request was cancelled after pickup delay.",recommendedAction:"Refund or rebook with an approved vendor."}]),[W,L]=d.useState(()=>[]),[R,F]=d.useState("overview"),[te,oe]=d.useState(""),[G,H]=d.useState("All"),[Y,we]=d.useState("All"),[q,je]=d.useState("All"),[_e,Ee]=d.useState("All"),[be,Fe]=d.useState(!1),[Pe,pe]=d.useState(!1),[Q,Re]=d.useState(null),ce=d.useMemo(()=>Q&&y.find(V=>V.id===Q)||null,[Q,y]),xe=d.useMemo(()=>ce?j[ce.vendorId]:null,[ce,j]),[he,de]=d.useState(!1),[ye,Ke]=d.useState(()=>({type:"Purchase Order",module:"E-Commerce",marketplace:"EVmart",vendorId:"V-011",currency:"UGX",total:0,description:"",location:"",dueInDays:7})),[Le,Ne]=d.useState(!1),[ge,$e]=d.useState({type:"Photo",name:"",note:""}),[ie,Oe]=d.useState(!1),[Se,Te]=d.useState({stars:5,comment:"",acknowledge:!1}),Ge=d.useMemo(()=>{const V=y.filter(D=>!["Completed","Cancelled","Refunded"].includes(D.status)).length,E=y.filter(D=>D.completedAt&&Date.now()-D.completedAt<7*24*60*60*1e3).length,u=y.filter(D=>no(D,t).breached).length,P=T.filter(D=>D.status==="Open").length,se=W.filter(D=>D.status!=="Resolved").length;return{open:V,completed7d:E,breached:u,openExceptions:P,openDisputes:se}},[y,T,W,t]),We=d.useMemo(()=>{const V=te.trim().toLowerCase();return y.filter(E=>G==="All"?!0:E.type===G).filter(E=>Y==="All"?!0:E.status===Y).filter(E=>q==="All"?!0:E.module===q).filter(E=>_e==="All"?!0:E.vendorId===_e).filter(E=>be?no(E,t).breached:!0).filter(E=>{if(!V)return!0;const u=j[E.vendorId];return`${E.id} ${E.ref} ${E.type} ${E.status} ${E.module} ${E.marketplace||""} ${(u==null?void 0:u.name)||""} ${E.description} ${E.location}`.toLowerCase().includes(V)}).slice().sort((E,u)=>u.createdAt-E.createdAt)},[y,te,G,Y,q,_e,be,j,t]),ze=d.useMemo(()=>{const V={};for(const E of y){const u=j[E.vendorId];V[E.vendorId]=V[E.vendorId]||{totalCompleted:0,onTime:0,breached:0,penaltiesUGX:0},no(E,t).breached&&(V[E.vendorId].breached+=1,i.autoPenaltyCalc&&(V[E.vendorId].penaltiesUGX+=pb(E,u))),E.status==="Completed"&&(V[E.vendorId].totalCompleted+=1,(!E.completedAt||E.completedAt<=E.dueAt)&&(V[E.vendorId].onTime+=1))}return c.map(E=>{const u=V[E.id]||{totalCompleted:0,onTime:0,breached:0,penaltiesUGX:0},P=u.totalCompleted?Math.round(u.onTime/u.totalCompleted*100):100;return{vendor:E,...u,onTimePct:P}}).sort((E,u)=>u.penaltiesUGX-E.penaltiesUGX||u.breached-E.breached||E.vendor.name.localeCompare(u.vendor.name))},[y,c,j,i.autoPenaltyCalc,t]),Ue=V=>{Re(V),pe(!0)},le=V=>{const E={id:wn("EX"),createdAt:V.createdAt??Date.now(),status:V.status??"Open",...V};return C(u=>[E,...u]),E},z=()=>{let V=0,E=0;for(const u of y){const P=no(u,t);if(!P.breached)continue;if(!T.some(D=>D.kind==="SLA breach"&&D.fulfillmentId===u.id)){const D=u.completedAt?`Completed ${P.lateDays} day(s) late.`:`Overdue by ${P.overdueDays} day(s).`;le({kind:"SLA breach",severity:"Critical",fulfillmentId:u.id,title:"SLA breach detected",detail:D,recommendedAction:"Review penalty and open a dispute if needed."}),E+=1}i.autoDisputeOnSlaBreach&&(W.some(re=>re.fulfillmentId===u.id&&re.reason.toLowerCase().includes("sla breach"))||(L(re=>[{id:wn("DSP"),createdAt:Date.now(),fulfillmentId:u.id,status:"Open",reason:"SLA breach auto-trigger",autoTriggered:!0,evidence:[]},...re]),V+=1))}r({title:"SLA scan completed",message:`Exceptions created: ${E}. Disputes created: ${V}.`,kind:E||V?"success":"info"})},Ae=()=>{const V=We.map(m=>{const S=j[m.vendorId],f=no(m,t),U=i.autoPenaltyCalc?pb(m,S):0;return{id:m.id,ref:m.ref,type:m.type,status:m.status,module:m.module,marketplace:m.marketplace||"-",vendor:(S==null?void 0:S.name)||m.vendorId,dueAt:mr(m.dueAt),completedAt:m.completedAt?mr(m.completedAt):"-",currency:m.currency,total:m.total,slaBreach:f.breached?"Yes":"No",penaltyUGX:U,location:m.location}}),E=["id","ref","type","status","module","marketplace","vendor","dueAt","completedAt","currency","total","slaBreach","penaltyUGX","location"],u=m=>{const S=String(m??"");return/[",\n]/.test(S)?`"${S.replace(/"/g,'""')}"`:S},P=E.join(","),se=V.map(m=>E.map(S=>u(m[S])).join(",")).join(`
`),D=`${P}
${se}`,re=new Blob([D],{type:"text/csv"}),v=URL.createObjectURL(re),k=document.createElement("a");k.href=v,k.download="corporatepay-fulfillment.csv",k.click(),URL.revokeObjectURL(v),r({title:"Exported",message:"Fulfillment CSV downloaded.",kind:"success"})},Ve=()=>{const V={items:y,exceptions:T,disputes:W,vendors:c,settings:i,exportedAt:new Date().toISOString()},E=new Blob([JSON.stringify(V,null,2)],{type:"application/json"}),u=URL.createObjectURL(E),P=document.createElement("a");P.href=u,P.download="corporatepay-fulfillment.json",P.click(),URL.revokeObjectURL(u),r({title:"Exported",message:"Fulfillment JSON downloaded.",kind:"success"})},Ye=()=>{if(!ye.description.trim()){r({title:"Missing",message:"Add a description.",kind:"warn"});return}if(!ye.location.trim()){r({title:"Missing",message:"Add a location.",kind:"warn"});return}if(!ye.total||ye.total<=0){r({title:"Missing",message:"Add a total amount showing expected cost.",kind:"warn"});return}const V=24*60*60*1e3,E=Date.now(),u=E+db(ye.dueInDays,0,365)*V,P=ye.type,D=(P==="Purchase Order"?["Created","Confirmed","In progress","Delivered","Completed"]:P==="Service Booking"?["Booked","Confirmed","In service","Completed"]:P==="Delivery"?["Created","Picked up","In transit","Delivered"]:["Scheduled","Driver assigned","Picked up","Dropped off"]).map(v=>({id:wn("TL"),label:v}));D[0]={...D[0],at:E,note:"Created"};const re={id:wn("FUL"),ref:`${P==="Purchase Order"?"PO":P==="Service Booking"?"SVC":P==="Delivery"?"DEL":"SCH"}-${Math.floor(100+Math.random()*900)}`,type:P,status:"Pending",createdAt:E,dueAt:u,module:ye.module,marketplace:ye.module==="E-Commerce"?ye.marketplace:void 0,vendorId:ye.vendorId,currency:ye.currency,total:Math.round(ye.total),description:ye.description.trim(),location:ye.location.trim(),timeline:D,currentStep:0,proofs:[]};$(v=>[re,...v]),de(!1),F("items"),r({title:"Created",message:"New request created.",kind:"success"})},Be=V=>{$(E=>E.map(u=>{if(u.id!==V||u.status==="Cancelled"||u.status==="Refunded")return u;const P=Math.min(u.timeline.length-1,u.currentStep+1),se=u.timeline.slice();se[P].at||(se[P]={...se[P],at:Date.now()});let D=u.status;P===0?D="Pending":P===u.timeline.length-1?D="Completed":P>=1&&P<=2?D="Confirmed":D="In progress";const re=D==="Completed"?Date.now():u.completedAt;return{...u,timeline:se,currentStep:P,status:D,completedAt:re}})),r({title:"Updated",message:"Status advanced.",kind:"success"})},w=V=>{$(E=>E.map(u=>u.id===V?{...u,status:"Cancelled"}:u)),le({kind:"Cancellation",severity:"Warning",fulfillmentId:V,title:"Cancelled",detail:"Request was cancelled by admin.",recommendedAction:"Rebook if needed."}),r({title:"Cancelled",message:"Item cancelled.",kind:"warn"})},B=V=>{$(E=>E.map(u=>u.id===V?{...u,status:"Refunded"}:u)),le({kind:"Refund",severity:"Warning",fulfillmentId:V,title:"Refund initiated",detail:"Refund recorded (demo).",recommendedAction:"Verify refund settlement in Transactions."}),r({title:"Refunded",message:"Refund recorded.",kind:"info"})},ue=V=>{$(E=>E.map(u=>u.id===V?{...u,status:"Rebooked"}:u)),le({kind:"Rebooking",severity:"Info",fulfillmentId:V,title:"Rebook requested",detail:"Item rebook requested. Create a new request to replace it.",recommendedAction:"Create a new booking and link reference."}),r({title:"Rebooked",message:"Rebooking logged.",kind:"info"})},ne=()=>{if(!ce)return;if(!ge.name.trim()){r({title:"Missing",message:"Add a proof name.",kind:"warn"});return}const V={id:wn("PR"),name:ge.name.trim(),type:ge.type,note:ge.note.trim(),addedAt:Date.now(),addedBy:"You"};$(E=>E.map(u=>u.id===ce.id?{...u,proofs:[V,...u.proofs]}:u)),Ne(!1),r({title:"Added",message:"Proof attached.",kind:"success"})},Me=(V,E=!1)=>{if(!ce)return;if(!V.trim()){r({title:"Missing",message:"Add a dispute reason.",kind:"warn"});return}const u={id:wn("DSP"),createdAt:Date.now(),fulfillmentId:ce.id,status:"Open",reason:V.trim(),autoTriggered:E,evidence:[]};L(P=>[u,...P]),r({title:"Dispute opened",message:"Dispute created.",kind:"success"})},De=()=>{ce&&(Te({stars:5,comment:"",acknowledge:!1}),Oe(!0))},fe=()=>{if(!ce)return;if(!Se.acknowledge){r({title:"Required",message:"Acknowledge that rating is recorded.",kind:"warn"});return}const V=db(Math.round(Se.stars),1,5),E=Se.comment.trim(),u=Date.now();$(P=>P.map(se=>se.id===ce.id?{...se,rating:{stars:V,comment:E,at:u}}:se)),x(P=>P.map(se=>{if(se.id!==ce.vendorId)return se;const D=se.ratingCount+1,re=(se.ratingAvg*se.ratingCount+V)/D;return{...se,ratingAvg:Math.round(re*10)/10,ratingCount:D}})),Oe(!1),r({title:"Thanks",message:"Vendor feedback recorded.",kind:"success"})};return d.useEffect(()=>{Oe(!1)},[Q]),e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(H_,{toasts:l,onDismiss:V=>n(E=>E.filter(u=>u.id!==V))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:fg.green},children:e.jsx(kt,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Orders, Service Requests and Fulfillment"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Track POs, bookings, deliveries, and ride schedules with timelines, proofs, exceptions, SLAs, and dispute triggers."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(Mt,{label:`Open: ${Ge.open}`,tone:Ge.open?"warn":"good"}),e.jsx(Mt,{label:`Completed 7d: ${Ge.completed7d}`,tone:"good"}),e.jsx(Mt,{label:`SLA breaches: ${Ge.breached}`,tone:Ge.breached?"bad":"good"}),e.jsx(Mt,{label:`Exceptions: ${Ge.openExceptions}`,tone:Ge.openExceptions?"warn":"good"}),e.jsx(Mt,{label:`Disputes: ${Ge.openDisputes}`,tone:Ge.openDisputes?"warn":"good"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(zt,{variant:"outline",onClick:z,children:[e.jsx(sl,{className:"h-4 w-4"})," SLA scan"]}),e.jsxs(zt,{variant:"outline",onClick:Ae,children:[e.jsx(pt,{className:"h-4 w-4"})," Export CSV"]}),e.jsxs(zt,{variant:"outline",onClick:Ve,children:[e.jsx(pt,{className:"h-4 w-4"})," Export JSON"]}),e.jsxs(zt,{variant:"primary",onClick:()=>de(!0),children:[e.jsx(gt,{className:"h-4 w-4"})," New"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"overview",label:"Overview"},{id:"items",label:"All fulfillment"},{id:"exceptions",label:"Exceptions"},{id:"sla",label:"SLA and penalties"},{id:"disputes",label:"Disputes"}].map(V=>e.jsx("button",{className:Ra("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",R===V.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:R===V.id?{background:fg.green}:void 0,onClick:()=>F(V.id),children:V.label},V.id))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[R==="overview"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsxs(Pl,{title:"Fulfillment health",subtitle:"Status timelines and proofs for end-to-end operational visibility.",right:e.jsx(Mt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-4",children:[e.jsx(me,{title:"Open items",value:`${Ge.open}`,sub:"Pending, confirmed, in progress",icon:e.jsx(Dn,{className:"h-5 w-5"}),tone:Ge.open?"warn":"good"}),e.jsx(me,{title:"Completed",value:`${Ge.completed7d}`,sub:"Last 7 days",icon:e.jsx(tt,{className:"h-5 w-5"}),tone:"good"}),e.jsx(me,{title:"SLA breaches",value:`${Ge.breached}`,sub:"Overdue or late",icon:e.jsx(Et,{className:"h-5 w-5"}),tone:Ge.breached?"bad":"good"}),e.jsx(me,{title:"Disputes",value:`${Ge.openDisputes}`,sub:"Open or in review",icon:e.jsx(yt,{className:"h-5 w-5"}),tone:Ge.openDisputes?"warn":"good"})]}),e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Item"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Type"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Due"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"SLA"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Proofs"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Action"})]})}),e.jsxs("tbody",{children:[We.slice(0,6).map(V=>{const E=j[V.vendorId],u=no(V,t);return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:V.ref}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[V.module,V.marketplace?`  ${V.marketplace}`:""]})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:V.type}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(E==null?void 0:E.name)||V.vendorId}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Mt,{label:V.status,tone:xb(V.status)})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:tC(V.dueAt)}),e.jsxs("td",{className:"px-4 py-3",children:[u.breached?e.jsx(Mt,{label:"Breached",tone:"bad"}):e.jsx(Mt,{label:"OK",tone:"good"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:u.overdueDays?`${u.overdueDays} day(s) overdue`:u.lateDays?`${u.lateDays} day(s) late`:"On track"})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:V.proofs.length}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(zt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>Ue(V.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]})})]},V.id)}),y.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-10",children:e.jsx(Mc,{title:"No fulfillment",subtitle:"Create your first order or booking."})})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: SLA breaches can auto-create disputes and calculate penalties."})]}),e.jsxs(Pl,{title:"Automation settings",subtitle:"Premium controls for dispute triggers and penalty calculations.",right:e.jsx(Mt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(Ec,{enabled:i.autoDisputeOnSlaBreach,onChange:V=>o(E=>({...E,autoDisputeOnSlaBreach:V})),label:"Auto dispute on SLA breach",description:"Creates a dispute record when overdue or late."}),e.jsx(Ec,{enabled:i.autoPenaltyCalc,onChange:V=>o(E=>({...E,autoPenaltyCalc:V})),label:"Auto penalty calculation",description:"Estimates penalty amounts per vendor terms."}),e.jsx(Ec,{enabled:i.requireApprovalForPenalty,onChange:V=>o(E=>({...E,requireApprovalForPenalty:V})),label:"Require approval for penalties",description:"If penalty exceeds threshold, route to approval chain."}),e.jsx("div",{className:Ra(!i.requireApprovalForPenalty&&"opacity-60"),children:e.jsx(cb,{label:"Penalty approval threshold",value:i.penaltyApprovalThresholdUGX,onChange:V=>o(E=>({...E,penaltyApprovalThresholdUGX:Math.max(0,V)})),hint:"UGX",disabled:!i.requireApprovalForPenalty})})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(zt,{variant:"primary",onClick:z,children:[e.jsx(sl,{className:"h-4 w-4"})," Run SLA scan"]}),e.jsxs(zt,{variant:"outline",onClick:()=>F("sla"),children:[e.jsx(et,{className:"h-4 w-4"})," View SLA"]}),e.jsxs(zt,{variant:"outline",onClick:()=>F("disputes"),children:[e.jsx(et,{className:"h-4 w-4"})," View disputes"]})]})]})]}),e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(Pl,{title:"Exceptions snapshot",subtitle:"Open issues needing attention.",right:e.jsx(Mt,{label:`${T.filter(V=>V.status==="Open").length}`,tone:T.filter(V=>V.status==="Open").length?"warn":"good"}),children:[e.jsxs("div",{className:"space-y-2",children:[T.filter(V=>V.status==="Open").slice(0,5).map(V=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Mt,{label:V.kind,tone:"neutral"}),e.jsx(Mt,{label:V.severity,tone:nC(V.severity)})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:V.title}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[z_(V.createdAt),"  ",V.fulfillmentId]}),e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:V.detail})]}),e.jsxs(zt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Ue(V.fulfillmentId),F("items")},children:[e.jsx(et,{className:"h-4 w-4"})," Open"]})]})},V.id)),T.filter(V=>V.status==="Open").length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No open exceptions."})]}),e.jsx("div",{className:"mt-3",children:e.jsxs(zt,{variant:"outline",className:"w-full",onClick:()=>F("exceptions"),children:[e.jsx(et,{className:"h-4 w-4"})," Open exceptions"]})})]}),e.jsxs(Pl,{title:"Quality feedback",subtitle:"Premium: vendor rating loop after fulfillment.",right:e.jsx(Mt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"space-y-2",children:c.filter(V=>V.status==="Approved").slice(0,5).map(V=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:V.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Rating ",V.ratingAvg.toFixed(1),"  ",V.ratingCount," reviews"]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(Mt,{label:`SLA target ${V.slaOnTimeTargetPct}%`,tone:"neutral"}),e.jsx(Mt,{label:`Penalty ${V.penaltyPct}%`,tone:"neutral"})]})]}),e.jsx(Il,{className:"h-5 w-5 text-amber-500"})]})},V.id))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Ratings can be required after completion for specific categories."})]})]})]}):null,R==="items"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(Pl,{title:"Filters",subtitle:"Search and filter all fulfillment.",right:e.jsx(Mt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-2 py-2",children:[e.jsx(pa,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:te,onChange:V=>oe(V.target.value),placeholder:"ref, vendor, location...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(Ur,{label:"Type",value:G,onChange:V=>H(V),options:[{value:"All",label:"All"},...["Purchase Order","Service Booking","Delivery","Ride Schedule"].map(V=>({value:V,label:V}))]}),e.jsx(Ur,{label:"Status",value:Y,onChange:V=>we(V),options:[{value:"All",label:"All"},...["Pending","Confirmed","In progress","Completed","Cancelled","Refunded","Rebooked"].map(V=>({value:V,label:V}))]}),e.jsx(Ur,{label:"Module",value:q,onChange:V=>je(V),options:[{value:"All",label:"All"},...s.map(V=>({value:V,label:V}))]}),e.jsx(Ur,{label:"Vendor",value:_e,onChange:Ee,options:[{value:"All",label:"All"},...c.map(V=>({value:V.id,label:V.name}))]})]}),e.jsx("div",{className:"mt-3",children:e.jsx(Ec,{enabled:be,onChange:Fe,label:"SLA breach only",description:"Overdue or completed late"})}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(zt,{variant:"outline",onClick:()=>{oe(""),H("All"),we("All"),je("All"),Ee("All"),Fe(!1),r({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(vn,{className:"h-4 w-4"})," Reset"]}),e.jsxs(zt,{variant:"outline",onClick:Ae,children:[e.jsx(pt,{className:"h-4 w-4"})," CSV"]})]})]}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Proofs are required for delivery and completion confirmation in regulated programs."})]})}),e.jsx("div",{className:"lg:col-span-8",children:e.jsx(Pl,{title:"All fulfillment",subtitle:"Track orders, bookings, deliveries, and ride schedules with proofs and exceptions.",right:e.jsx(Mt,{label:`${We.length}`,tone:"neutral"}),children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Ref"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Type"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Due"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"SLA"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Proofs"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[We.map(V=>{const E=j[V.vendorId],u=no(V,t);return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:V.ref}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[V.module,V.marketplace?`  ${V.marketplace}`:""]})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:V.type}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(E==null?void 0:E.name)||V.vendorId}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Mt,{label:V.status,tone:xb(V.status)})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:tC(V.dueAt)}),e.jsxs("td",{className:"px-4 py-3",children:[u.breached?e.jsx(Mt,{label:"Breached",tone:"bad"}):e.jsx(Mt,{label:"OK",tone:"good"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:u.overdueDays?`${u.overdueDays} overdue`:u.lateDays?`${u.lateDays} late`:""})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:V.proofs.length}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(zt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>Ue(V.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]}),e.jsxs(zt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Be(V.id),disabled:V.status==="Completed"||V.status==="Cancelled"||V.status==="Refunded",title:V.status==="Completed"?"Already completed":"Advance timeline",children:[e.jsx(tt,{className:"h-4 w-4"})," Advance"]})]})})]},V.id)}),We.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-10",children:e.jsx(Mc,{title:"No results",subtitle:"Try changing your filters."})})})]})]})})})})]}):null,R==="exceptions"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(Pl,{title:"Exceptions",subtitle:"Cancellations, refunds, rebooking, SLA breaches.",right:e.jsx(Mt,{label:"Core",tone:"neutral"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Use this queue to resolve exceptions and keep the audit trail clean."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(zt,{variant:"outline",onClick:z,children:[e.jsx(sl,{className:"h-4 w-4"})," Scan SLA"]}),e.jsxs(zt,{variant:"outline",onClick:()=>F("items"),children:[e.jsx(et,{className:"h-4 w-4"})," Open fulfillment"]})]})]})}),e.jsx("div",{className:"lg:col-span-8",children:e.jsx(Pl,{title:"Exceptions queue",subtitle:"Resolve, refund, rebook, or dispute.",right:e.jsx(Mt,{label:`${T.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[T.map(V=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Mt,{label:V.kind,tone:"neutral"}),e.jsx(Mt,{label:V.severity,tone:nC(V.severity)}),e.jsx(Mt,{label:V.status,tone:V.status==="Resolved"?"good":"warn"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:V.title}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[mr(V.createdAt),"  ",V.fulfillmentId]}),e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:V.detail}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Recommended: ",V.recommendedAction]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(zt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Ue(V.fulfillmentId),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]}),V.status==="Open"?e.jsxs(zt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>{C(E=>E.map(u=>u.id===V.id?{...u,status:"Resolved"}:u)),r({title:"Resolved",message:"Exception resolved.",kind:"success"})},children:[e.jsx(tt,{className:"h-4 w-4"})," Resolve"]}):null]})]})},V.id)),T.length?null:e.jsx(Mc,{title:"No exceptions",subtitle:"Everything is running smoothly."})]})})})]}):null,R==="sla"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(Pl,{title:"SLA and penalties",subtitle:"Premium: vendor SLA tracking and penalties.",right:e.jsx(Mt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Penalty calculations are estimates. In production, you can require approvals and generate credit notes."}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx(Ec,{enabled:i.autoPenaltyCalc,onChange:V=>o(E=>({...E,autoPenaltyCalc:V})),label:"Auto calculate penalties",description:"Uses vendor penalty terms"}),e.jsx(Ec,{enabled:i.autoDisputeOnSlaBreach,onChange:V=>o(E=>({...E,autoDisputeOnSlaBreach:V})),label:"Auto dispute on breach",description:"Creates disputes when breach detected"})]}),e.jsx("div",{className:"mt-3",children:e.jsxs(zt,{variant:"primary",className:"w-full",onClick:z,children:[e.jsx(sl,{className:"h-4 w-4"})," Run SLA scan"]})})]})}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs(Pl,{title:"Vendor SLA tracking",subtitle:"On-time rate, breaches, penalties, and ratings.",right:e.jsx(Mt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Target"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"On-time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Breaches"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Penalty estimate"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Rating"})]})}),e.jsxs("tbody",{children:[ze.map(V=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:V.vendor.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[V.vendor.country,"  ",V.vendor.status]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Mt,{label:`${V.vendor.slaOnTimeTargetPct}%`,tone:"neutral"})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx(Mt,{label:`${V.onTimePct}%`,tone:V.onTimePct>=V.vendor.slaOnTimeTargetPct?"good":V.onTimePct>=V.vendor.slaOnTimeTargetPct-5?"warn":"bad"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[V.totalCompleted," completed"]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Mt,{label:`${V.breached}`,tone:V.breached?"warn":"good"})}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:aC(V.penaltiesUGX)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Il,{className:"h-4 w-4 text-amber-500"}),e.jsx("span",{className:"font-semibold text-slate-900",children:V.vendor.ratingAvg.toFixed(1)}),e.jsxs("span",{className:"text-xs text-slate-500",children:["(",V.vendor.ratingCount,")"]})]})})]},V.vendor.id)),ze.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-10",children:e.jsx(Mc,{title:"No vendors",subtitle:"No vendor stats available."})})})]})]})}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: penalties can create credit notes or adjustments in Invoices and Statements."})]})})]}):null,R==="disputes"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(Pl,{title:"Disputes",subtitle:"Auto triggers on SLA breach and manual disputes.",right:e.jsx(Mt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Disputes can be triggered automatically on SLA breach or opened manually with evidence."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(zt,{variant:"outline",onClick:z,children:[e.jsx(sl,{className:"h-4 w-4"})," Scan SLA"]}),e.jsxs(zt,{variant:"outline",onClick:()=>F("items"),children:[e.jsx(et,{className:"h-4 w-4"})," Open fulfillment"]})]})]})}),e.jsx("div",{className:"lg:col-span-8",children:e.jsx(Pl,{title:"Dispute list",subtitle:"Open, review, resolve.",right:e.jsx(Mt,{label:`${W.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[W.map(V=>{const E=y.find(P=>P.id===V.fulfillmentId),u=E?j[E.vendorId]:null;return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Mt,{label:V.status,tone:X_(V.status)}),e.jsx(Mt,{label:V.autoTriggered?"Auto":"Manual",tone:V.autoTriggered?"info":"neutral"}),E?e.jsx(Mt,{label:E.ref,tone:"neutral"}):null]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:V.reason}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",mr(V.createdAt)]}),E?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Vendor: ",(u==null?void 0:u.name)||E.vendorId,"  Type: ",E.type,"  Total: ",sC(E.total,E.currency)]}):null]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[E?e.jsxs(zt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Ue(E.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open item"]}):null,V.status!=="Resolved"?e.jsxs(zt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>{L(P=>P.map(se=>se.id===V.id?{...se,status:"Resolved"}:se)),r({title:"Resolved",message:"Dispute resolved.",kind:"success"})},children:[e.jsx(tt,{className:"h-4 w-4"})," Resolve"]}):null]})]})},V.id)}),W.length?null:e.jsx(Mc,{title:"No disputes",subtitle:"Run SLA scan or create a dispute from an item."})]})})})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"T Orders, Service Requests and Fulfillment v2. Core: track POs, bookings, deliveries, and ride schedules with timelines and proofs plus exception handling. Premium: vendor SLA tracking and penalties, quality feedback loop, and automated dispute triggers."})})]})}),e.jsx(mb,{open:he,title:"Create request",subtitle:"Create a PO, service booking, delivery, or ride schedule for tracking.",onClose:()=>de(!1),actions:[{label:"Create",onClick:Ye}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(zt,{variant:"outline",onClick:()=>de(!1),children:"Cancel"}),e.jsxs(zt,{variant:"primary",onClick:Ye,children:[e.jsx(ct,{className:"h-4 w-4"})," Create"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Ur,{label:"Type",value:ye.type,onChange:V=>Ke(E=>({...E,type:V})),options:["Purchase Order","Service Booking","Delivery","Ride Schedule"].map(V=>({value:V,label:V}))}),e.jsx(Ur,{label:"Module",value:ye.module,onChange:V=>Ke(E=>({...E,module:V})),options:s.map(V=>({value:V,label:V}))}),e.jsx(Ur,{label:"Marketplace",value:ye.marketplace,onChange:V=>Ke(E=>({...E,marketplace:V})),options:a.map(V=>({value:V,label:V})),disabled:ye.module!=="E-Commerce",hint:ye.module!=="E-Commerce"?"Only for E-Commerce":""}),e.jsx(Ur,{label:"Vendor",value:ye.vendorId,onChange:V=>Ke(E=>({...E,vendorId:V})),options:c.map(V=>({value:V.id,label:`${V.name} (${V.status})`}))}),e.jsx(Ur,{label:"Currency",value:ye.currency,onChange:V=>Ke(E=>({...E,currency:V})),options:["UGX","USD","EUR","CNY"].map(V=>({value:V,label:V}))}),e.jsx(cb,{label:"Total",value:ye.total,onChange:V=>Ke(E=>({...E,total:Math.max(0,V)})),hint:"Expected cost"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(lC,{label:"Location",value:ye.location,onChange:V=>Ke(E=>({...E,location:V})),placeholder:"Delivery or service location"})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(ub,{label:"Description",value:ye.description,onChange:V=>Ke(E=>({...E,description:V})),placeholder:"What needs to be delivered or done",rows:4})}),e.jsx(cb,{label:"Due in (days)",value:ye.dueInDays,onChange:V=>Ke(E=>({...E,dueInDays:db(V,0,365)})),hint:"SLA baseline"}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"For high value items, create RFQ first, then convert to PO. This page focuses on tracking and fulfillment."})]})}),e.jsx(mb,{open:Le,title:"Add proof",subtitle:"Upload delivery confirmations or completion logs (simulated).",onClose:()=>Ne(!1),actions:[{label:"Add",onClick:ne}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(zt,{variant:"outline",onClick:()=>Ne(!1),children:"Cancel"}),e.jsxs(zt,{variant:"primary",onClick:ne,children:[e.jsx(ct,{className:"h-4 w-4"})," Add"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Ur,{label:"Proof type",value:ge.type,onChange:V=>$e(E=>({...E,type:V})),options:["Delivery confirmation","Completion log","Trip receipt","Signature","Photo","Other"].map(V=>({value:V,label:V}))}),e.jsx(lC,{label:"File name",value:ge.name,onChange:V=>$e(E=>({...E,name:V})),placeholder:"photo.jpg"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(ub,{label:"Note",value:ge.note,onChange:V=>$e(E=>({...E,note:V})),rows:3,placeholder:"Optional"})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"In production, files are stored securely and referenced by signed URLs."})]})}),e.jsx(mb,{open:ie,title:"Rate vendor",subtitle:"Premium: quality feedback loop after fulfillment.",onClose:()=>Oe(!1),actions:[{label:"Submit",onClick:fe}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(zt,{variant:"outline",onClick:()=>Oe(!1),children:"Cancel"}),e.jsxs(zt,{variant:"primary",onClick:fe,children:[e.jsx(Il,{className:"h-4 w-4"})," Submit"]})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Stars"}),e.jsx("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[1,2,3,4,5].map(V=>e.jsxs("button",{type:"button",className:Ra("inline-flex items-center gap-2 rounded-2xl border px-4 py-2 text-sm font-semibold",Se.stars>=V?"border-amber-200 bg-amber-50":"border-slate-200 bg-white hover:bg-slate-50"),onClick:()=>Te(E=>({...E,stars:V})),children:[e.jsx(Il,{className:Ra("h-4 w-4",Se.stars>=V?"text-amber-500":"text-slate-300")}),V]},V))})]}),e.jsx(ub,{label:"Comment",value:Se.comment,onChange:V=>Te(E=>({...E,comment:V})),placeholder:"Optional feedback",rows:4}),e.jsxs("label",{className:"flex items-start gap-3 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("input",{type:"checkbox",className:"mt-1 h-4 w-4 rounded border-slate-300",checked:Se.acknowledge,onChange:V=>Te(E=>({...E,acknowledge:V.target.checked}))}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Acknowledge"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"This feedback is stored and can be used to improve vendor performance."})]})]})]})}),e.jsx(W_,{open:Pe,title:ce?`${ce.ref}  ${ce.type}`:"Fulfillment",subtitle:ce?`${ce.module}${ce.marketplace?`  ${ce.marketplace}`:""}  ${((Xe=j[ce.vendorId])==null?void 0:Xe.name)||ce.vendorId}`:"",onClose:()=>pe(!1),footer:ce?e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Actions are audit logged in production."}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(zt,{variant:"outline",onClick:()=>{$e({type:"Photo",name:"",note:""}),Ne(!0)},children:[e.jsx(gt,{className:"h-4 w-4"})," Add proof"]}),e.jsxs(zt,{variant:"outline",onClick:()=>{ce&&(Me("Manual dispute",!1),F("disputes"))},children:[e.jsx(yt,{className:"h-4 w-4"})," Dispute"]}),e.jsxs(zt,{variant:"primary",onClick:()=>Be(ce.id),disabled:ce.status==="Completed"||ce.status==="Cancelled"||ce.status==="Refunded",children:[e.jsx(tt,{className:"h-4 w-4"})," Advance"]})]})]}):null,children:ce?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Mt,{label:ce.status,tone:xb(ce.status)}),e.jsx(Mt,{label:ce.currency,tone:"neutral"}),xe?e.jsx(Mt,{label:`Vendor SLA ${xe.slaOnTimeTargetPct}%`,tone:"neutral"}):null]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:ce.description}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",mr(ce.createdAt),"  Due ",mr(ce.dueAt)]}),e.jsxs("div",{className:"mt-2 text-sm text-slate-700",children:["Location: ",e.jsx("span",{className:"font-semibold",children:ce.location})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Total"}),e.jsx("div",{className:"mt-1 text-lg font-semibold text-slate-900",children:sC(ce.total,ce.currency)}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Proofs ",ce.proofs.length]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsxs(zt,{variant:"outline",onClick:()=>w(ce.id),disabled:ce.status==="Completed"||ce.status==="Cancelled"||ce.status==="Refunded",children:[e.jsx(Qe,{className:"h-4 w-4"})," Cancel"]}),e.jsxs(zt,{variant:"outline",onClick:()=>B(ce.id),disabled:ce.status==="Refunded",children:[e.jsx(Ia,{className:"h-4 w-4"})," Refund"]}),e.jsxs(zt,{variant:"outline",onClick:()=>ue(ce.id),disabled:ce.status==="Rebooked",children:[e.jsx(Dn,{className:"h-4 w-4"})," Rebook"]})]})]}),e.jsx(Pl,{title:"SLA status",subtitle:"Overdue checks and penalty estimate.",right:e.jsx(Mt,{label:"Premium",tone:"info"}),children:(()=>{const V=no(ce,t),E=i.autoPenaltyCalc?pb(ce,xe||void 0):0,u=i.requireApprovalForPenalty&&E>=i.penaltyApprovalThresholdUGX;return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[V.breached?e.jsx(Mt,{label:"Breached",tone:"bad"}):e.jsx(Mt,{label:"OK",tone:"good"}),V.overdueDays?e.jsx(Mt,{label:`${V.overdueDays} day(s) overdue`,tone:"warn"}):null,V.lateDays?e.jsx(Mt,{label:`${V.lateDays} day(s) late`,tone:"warn"}):null]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Due: ",mr(ce.dueAt),ce.completedAt?`  Completed: ${mr(ce.completedAt)}`:""]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Penalty estimate"}),e.jsx("div",{className:"mt-1 text-lg font-semibold text-slate-900",children:aC(E)}),u?e.jsx("div",{className:"mt-1 text-xs font-semibold text-amber-700",children:"Approval required"}):e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"No approval needed"})]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(zt,{variant:"outline",onClick:()=>Me("SLA breach dispute",!0),disabled:!V.breached,children:[e.jsx(yt,{className:"h-4 w-4"})," Open dispute"]}),e.jsxs(zt,{variant:"outline",onClick:()=>{r({title:"Penalty",message:"In production, penalties can create credit notes or adjustments.",kind:"info"})},disabled:!V.breached||!i.autoPenaltyCalc,children:[e.jsx(kt,{className:"h-4 w-4"})," Create credit note"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Automated dispute triggers run via SLA scan. You can run the scan from the page header."})]})})()}),e.jsx(Pl,{title:"Status timeline",subtitle:"Timeline plus completion logs.",right:e.jsx(Mt,{label:"Core",tone:"neutral"}),children:e.jsx("div",{className:"space-y-2",children:ce.timeline.map((V,E)=>{const u=E<ce.currentStep,P=E===ce.currentStep;return e.jsx("div",{className:Ra("rounded-3xl border p-4",P?"border-emerald-200 bg-emerald-50":"border-slate-200 bg-white"),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Mt,{label:`Step ${E+1}`,tone:"neutral"}),u?e.jsx(Mt,{label:"Done",tone:"good"}):P?e.jsx(Mt,{label:"Current",tone:"info"}):e.jsx(Mt,{label:"Next",tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:V.label}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[V.at?mr(V.at):"Not reached",V.note?`  ${V.note}`:""]})]}),P&&ce.status!=="Completed"&&ce.status!=="Cancelled"&&ce.status!=="Refunded"?e.jsxs(zt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>Be(ce.id),children:[e.jsx(tt,{className:"h-4 w-4"})," Advance"]}):null]})},V.id)})})}),e.jsx(Pl,{title:"Proofs",subtitle:"Delivery confirmations, completion logs, receipts.",right:e.jsxs(zt,{variant:"outline",onClick:()=>{$e({type:"Photo",name:"",note:""}),Ne(!0)},children:[e.jsx(gt,{className:"h-4 w-4"})," Add"]}),children:e.jsxs("div",{className:"space-y-2",children:[ce.proofs.map(V=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Mt,{label:V.type,tone:"neutral"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:V.name})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Added ",mr(V.addedAt),"  ",V.addedBy]}),V.note?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Note: ",V.note]}):null]}),e.jsx(zt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:async()=>{try{await navigator.clipboard.writeText(V.name),r({title:"Copied",message:"Proof filename copied.",kind:"success"})}catch{r({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},children:e.jsx(ss,{className:"h-4 w-4"})})]})},V.id)),ce.proofs.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No proofs attached."})]})}),e.jsx(Pl,{title:"Vendor feedback",subtitle:"Rate vendor after completion.",right:e.jsx(Mt,{label:"Premium",tone:"info"}),children:ce.status==="Completed"?e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:ce.rating?e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Il,{className:"h-5 w-5 text-amber-500"}),e.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:[ce.rating.stars," star(s)"]}),e.jsx(Mt,{label:mr(ce.rating.at),tone:"neutral"})]}),ce.rating.comment?e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:ce.rating.comment}):e.jsx("div",{className:"mt-2 text-sm text-slate-600",children:"No comment."})]}),e.jsxs(zt,{variant:"outline",onClick:De,children:[e.jsx(Il,{className:"h-4 w-4"})," Update"]})]}):e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"No rating yet"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium: ratings can be required for some modules."})]}),e.jsxs(zt,{variant:"primary",onClick:De,children:[e.jsx(Il,{className:"h-4 w-4"})," Rate now"]})]})}):e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Rating is available once the item is completed."})})]}):e.jsx(Mc,{title:"No item selected",subtitle:"Select a fulfillment item to view details."})})]});function me({title:V,value:E,sub:u,icon:P,tone:se}){const D=se==="good"?"bg-emerald-50 text-emerald-700":se==="warn"?"bg-amber-50 text-amber-800":se==="bad"?"bg-rose-50 text-rose-700":se==="info"?"bg-blue-50 text-blue-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:V}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:E}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:u})]}),e.jsx("div",{className:Ra("grid h-10 w-10 place-items-center rounded-2xl",D),children:P})]})})}}const gx={green:"#03CD8C",orange:"#F77F00"};function ca(...t){return t.filter(Boolean).join(" ")}function Vr(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function Oh(t,s,a){return Math.max(s,Math.min(a,t))}function Pc(t){return new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"2-digit"})}function xr(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function hb(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function Q_(t){const s=new Date(t),a=c=>String(c).padStart(2,"0"),l=s.getFullYear(),n=a(s.getMonth()+1),r=a(s.getDate()),i=a(s.getHours()),o=a(s.getMinutes());return`${l}-${n}-${r}T${i}:${o}`}function Y_(t){const s=new Date(t).getTime();return Number.isFinite(s)?s:Date.now()}function dt({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:ca("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Jt({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:gx.green}:t==="accent"?{background:gx.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:ca(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Cm({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:ca("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:ca("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function rn({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:ca(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:ca("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function gb({label:t,value:s,onChange:a,hint:l,disabled:n}){return e.jsxs("div",{className:ca(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",value:s,onChange:r=>a(Number(r.target.value||0)),disabled:n,className:ca("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function Wn({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:ca(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:ca("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function rC({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4,disabled:i}){return e.jsxs("div",{className:ca(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:o=>a(o.target.value),placeholder:l,rows:r,disabled:i,className:ca("mt-2 w-full rounded-2xl border p-3 text-sm font-semibold shadow-sm outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function ZE({actions:t}){const[s,a]=d.useState(!1),l=qt.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:ca("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function fb({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="980px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:12,scale:.985},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:12,scale:.985},transition:{duration:.18},className:"fixed inset-x-0 top-[7vh] z-50 mx-auto w-[min(1040px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(ZE,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[72vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function J_({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,actions:i}){return d.useEffect(()=>{const o=c=>c.key==="Escape"&&n();return t&&window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,x:18},animate:{opacity:1,x:0},exit:{opacity:0,x:18},transition:{duration:.18},className:ca("fixed z-50 overflow-hidden border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]","left-2 right-2 bottom-2 top-[10vh] rounded-[28px]","lg:left-auto lg:right-4 lg:top-4 lg:bottom-4 lg:w-[760px]"),role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-base font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i&&e.jsx(ZE,{actions:i}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"h-full min-h-0 overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function Z_({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(480px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:ca("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function Ga({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function ro({title:t,subtitle:s}){return e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(qF,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:s})]})}function vb(t){return t==="Completed"?"good":t==="Confirmed"?"info":t==="Pending approval"?"warn":t==="Cancelled"?"bad":"neutral"}function Sm(t){return t==="Approved"?"good":t==="Rejected"?"bad":"warn"}function Am(t,s="06:00",a="22:00"){const l=new Date(t),n=l.getHours(),r=l.getMinutes(),i=n*60+r,o=j=>{const[g,y]=j.split(":").map($=>Number($));return(g||0)*60+(y||0)},c=o(s),x=o(a);return i<c||i>x}function eB(t){return new Date(t).getHours()}function hd(t){return`${t}-${Math.floor(100+Math.random()*900)}`}function iC(t){const s=t.some(n=>n.includes("VIP")||n.includes("Premium")||n.includes("CapEx")||n.includes("Executive")),a=t.some(n=>n.includes("CEO")),l=[{role:"Manager",slaHours:8},{role:"Finance",slaHours:12}];return s&&!l.some(n=>n.role==="CFO")&&l.push({role:"CFO",slaHours:24}),a&&l.push({role:"CEO",slaHours:24}),l}function tB(){const t=Date.now(),s=["Client meeting","Airport","Office commute","Event","Visitor","Other"],[a,l]=d.useState([]),n=u=>{const P=Vr("toast");l(se=>[{id:P,...u},...se].slice(0,4)),window.setTimeout(()=>l(se=>se.filter(D=>D.id!==P)),3200)},[r,i]=d.useState(()=>({workStart:"06:00",workEnd:"22:00",requirePurpose:!0,requireProjectTag:!0,requireCostCenter:!0,premiumRequiresApproval:!0,vipPremiumAllowedWithApproval:!0,enforceVisitorHost:!0,peakHourThreshold:6})),[o]=d.useState(()=>[{id:"E-001",name:"Mary N.",group:"Operations",costCenter:"OPS-001",vip:!1,email:"mary@acme.com"},{id:"E-002",name:"John S.",group:"Sales",costCenter:"SALES-TRAVEL",vip:!1,email:"john@acme.com"},{id:"E-003",name:"Irene K.",group:"Operations",costCenter:"OPS-001",vip:!0,email:"irene@acme.com"},{id:"E-004",name:"Daisy O.",group:"Finance",costCenter:"FIN-OPS",vip:!1,email:"daisy@acme.com"},{id:"E-005",name:"Procurement Desk",group:"Procurement",costCenter:"PROC-001",vip:!1}]),[c,x]=d.useState(()=>[{id:"VST-01",name:"Alex Chen",company:"Shenzhen Motors",hostEmployeeId:"E-003",vip:!0,phone:"+86 177 0000 0000"},{id:"VST-02",name:"Sarah Kato",company:"Partner Co",hostEmployeeId:"E-001",vip:!1,phone:"+256 701 222 222"}]),j=d.useMemo(()=>Object.fromEntries(o.map(u=>[u.id,u])),[o]),g=d.useMemo(()=>Object.fromEntries(c.map(u=>[u.id,u])),[c]),[y,$]=d.useState(()=>{const P=t+1728e5+36e6;return[{id:"EVT-001",name:"Investor Roadshow",location:"Kampala Serena",startAt:P,endAt:P+3*60*60*1e3,organizer:"Travel Coordinator",attendees:[{type:"Employee",id:"E-001"},{type:"Employee",id:"E-002"},{type:"Employee",id:"E-003"},{type:"Visitor",id:"VST-01"}],notes:"Bulk bookings required. VIP guest attending."}]}),[T,C]=d.useState(()=>[{id:"RC-001",name:"Office commute - Operations",days:["Mon","Tue","Wed","Thu","Fri"],timeLocal:"07:30",pickup:"Home",dropoff:"Kampala HQ",category:"Standard",purpose:"Office commute",tags:["Commute"],employees:["E-001","E-003"],enabled:!0},{id:"RC-002",name:"Airport run - Sales",days:["Mon","Wed","Fri"],timeLocal:"05:30",pickup:"Kampala HQ",dropoff:"Entebbe Airport",category:"Premium",purpose:"Airport",tags:["Airport"],employees:["E-002"],enabled:!1}]),[W,L]=d.useState(()=>{const se=t+864e5+324e5,D=t+2*864e5+8*36e5,re=t+2*864e5+18*36e5;return[{id:"BK-001",ref:hd("TRV"),travelerType:"Visitor",travelerId:"VST-01",bookedBy:"Travel Coordinator",createdAt:t-5*36e5,scheduledAt:se,pickup:"Entebbe Airport",dropoff:"Kampala HQ",category:"Premium",purpose:"Visitor",tags:["VIP","Airport"],costCenter:"SALES-TRAVEL",projectTag:"Roadshow",module:"Rides & Logistics",status:"Pending approval",vipRequested:!0,policyNotes:["Premium requested","VIP traveler"],proofs:[]},{id:"BK-002",ref:hd("TRV"),travelerType:"Employee",travelerId:"E-001",bookedBy:"Travel Coordinator",createdAt:t-2*36e5,scheduledAt:D,pickup:"Kampala HQ",dropoff:"Kampala Serena",category:"Standard",purpose:"Event",tags:["Event"],costCenter:"OPS-001",projectTag:"Investor Roadshow",module:"Rides & Logistics",status:"Confirmed",eventId:"EVT-001",vipRequested:!1,policyNotes:[],proofs:[]},{id:"BK-003",ref:hd("TRV"),travelerType:"Employee",travelerId:"E-002",bookedBy:"Travel Coordinator",createdAt:t-90*60*1e3,scheduledAt:re,pickup:"Kampala Serena",dropoff:"Kampala HQ",category:"Standard",purpose:"Event",tags:["Event","Return"],costCenter:"SALES-TRAVEL",projectTag:"Investor Roadshow",module:"Rides & Logistics",status:"Confirmed",eventId:"EVT-001",vipRequested:!1,policyNotes:[],proofs:[]}]}),[R,F]=d.useState(()=>[{id:"VX-001",travelerType:"Employee",travelerId:"E-003",exceptionType:"Premium rides",validFrom:t-3*864e5,validTo:t+30*864e5,status:"Approved",requestedBy:"Org Admin",reason:"Executive travel allowance",approvalId:"APR-EX-001"}]),[te,oe]=d.useState(()=>{const P=(D,re)=>{const v=iC(D),k={Manager:"Manager",Finance:"Finance Desk",CFO:"CFO",CEO:"CEO"};return v.map(m=>({id:Vr("AS"),role:m.role,assignee:k[m.role],status:"Pending",requestedAt:re,slaHours:m.slaHours}))},se=t-18e6;return[{id:"APR-001",createdAt:se,createdBy:"Travel Coordinator",status:"Pending",scope:"Booking",scopeId:"BK-001",reason:"VIP airport pickup requires premium category",policyFlags:["VIP traveler","Premium requested"],steps:P(["VIP","Premium"],se)}]}),[G,H]=d.useState("overview"),[Y,we]=d.useState(""),[q,je]=d.useState("All"),[_e,Ee]=d.useState("All"),[be,Fe]=d.useState(!1),[Pe,pe]=d.useState(null),Q=d.useMemo(()=>Pe&&W.find(u=>u.id===Pe)||null,[Pe,W]),[Re,ce]=d.useState(!1),[xe,he]=d.useState(0),[de,ye]=d.useState(()=>({travelerType:"Employee",travelerId:"E-001",bookedBy:"Travel Coordinator",scheduledAt:Q_(t+24*60*60*1e3),pickup:"Kampala HQ",dropoff:"Entebbe Airport",category:"Standard",purpose:"Airport",purposeOther:"",tags:"Airport,Client",costCenter:"OPS-001",projectTag:"Business travel",module:"Rides & Logistics",vipRequested:!1})),[Ke,Le]=d.useState(!1),[Ne,ge]=d.useState(()=>({eventId:"EVT-001",pickup:"Kampala HQ",dropoff:"Kampala Serena",category:"Standard",createReturn:!0,returnPickup:"Kampala Serena",returnDropoff:"Kampala HQ",offsetMinsBeforeStart:30,returnMinsAfterEnd:15,purpose:"Event",tags:"Event",costCenter:"OPS-001",projectTag:"Investor Roadshow"})),[$e,ie]=d.useState(!1),[Oe,Se]=d.useState(()=>({travelerType:"Employee",travelerId:"E-003",exceptionType:"Premium rides",validDays:30,reason:""})),Te=(u,P)=>{var se,D;return u==="Employee"?((se=j[P])==null?void 0:se.name)||P:((D=g[P])==null?void 0:D.name)||P},Ge=(u,P)=>{var se,D;return u==="Employee"?!!((se=j[P])!=null&&se.vip):!!((D=g[P])!=null&&D.vip)},We=u=>{var se;const P=g[u];return P?((se=j[P.hostEmployeeId])==null?void 0:se.name)||P.hostEmployeeId:"-"},ze=d.useMemo(()=>W.filter(u=>u.scheduledAt>t&&u.status!=="Cancelled"),[W,t]),Ue=d.useMemo(()=>te.filter(u=>u.status==="Pending").length,[te]),le=d.useMemo(()=>y.filter(u=>u.startAt>t).sort((u,P)=>u.startAt-P.startAt),[y,t]),z=d.useMemo(()=>{const u=Y.trim().toLowerCase();return W.filter(P=>q==="All"?!0:P.status===q).filter(P=>_e==="All"?!0:P.travelerType===_e).filter(P=>u?`${P.ref} ${P.id} ${Te(P.travelerType,P.travelerId)} ${P.pickup} ${P.dropoff} ${P.purpose} ${P.tags.join(" ")} ${P.costCenter} ${P.projectTag}`.toLowerCase().includes(u):!0).slice().sort((P,se)=>P.scheduledAt-se.scheduledAt)},[W,Y,q,_e,j,g]),Ae=d.useMemo(()=>{const u=Array.from({length:24},()=>0);for(const P of ze)u[eB(P.scheduledAt)]+=1;return u},[ze]),Ve=d.useMemo(()=>{let u=0,P=-1;return Ae.forEach((se,D)=>{se>P&&(P=se,u=D)}),{hour:u,count:P}},[Ae]),Ye=Ve.count>=r.peakHourThreshold,Be=d.useMemo(()=>{const u=W.filter(D=>["Draft","Pending approval","Confirmed"].includes(D.status)).length,P=W.filter(D=>{const re=new Date(D.scheduledAt),v=new Date(t);return re.getFullYear()===v.getFullYear()&&re.getMonth()===v.getMonth()&&re.getDate()===v.getDate()}).length,se=te.filter(D=>D.status==="Pending"&&D.policyFlags.some(re=>re.toLowerCase().includes("vip"))).length;return{open:u,dueToday:P,vipPending:se}},[W,te,t]),w=d.useMemo(()=>{const u=Y_(de.scheduledAt),P=[],se=Ge(de.travelerType,de.travelerId),D=Am(u,r.workStart,r.workEnd);if(r.requirePurpose&&(!de.purpose||de.purpose==="Other"&&!de.purposeOther.trim())&&P.push("Purpose required"),r.requireProjectTag&&!de.projectTag.trim()&&P.push("Project tag required"),r.requireCostCenter&&!de.costCenter.trim()&&P.push("Cost center required"),de.travelerType==="Visitor"&&r.enforceVisitorHost){const f=g[de.travelerId];f!=null&&f.hostEmployeeId||P.push("Visitor host required")}D&&P.push("After-hours");const re=R.some(f=>{if(f.status!=="Approved"||f.travelerType!==de.travelerType||f.travelerId!==de.travelerId||f.exceptionType!=="After-hours"&&f.exceptionType!=="Premium rides")return!1;const U=u;return U>=f.validFrom&&U<=f.validTo}),v=de.category==="Premium";v&&r.premiumRequiresApproval&&P.push("Premium requested"),(de.vipRequested||se)&&P.push("VIP traveler");const k=P.some(f=>["After-hours","Premium requested","VIP traveler"].includes(f))&&!re,m=P.filter(f=>f.endsWith("required"));return{scheduledAt:u,flags:P,errors:m,needsApproval:k,hasActiveVipException:re,afterHours:D,premium:v,tVip:se}},[de,r,R,g,Ge]),B=u=>{pe(u),Fe(!0)},ue=u=>{const P=Date.now(),se=iC(u.flags),D={Manager:"Manager",Finance:"Finance Desk",CFO:"CFO",CEO:"CEO"},re=se.map(k=>({id:Vr("AS"),role:k.role,assignee:D[k.role],status:"Pending",requestedAt:P,slaHours:k.slaHours})),v={id:Vr("APR"),createdAt:P,createdBy:u.createdBy,status:"Pending",scope:u.scope,scopeId:u.scopeId,reason:u.reason,policyFlags:u.flags,steps:re};return oe(k=>[v,...k]),v},ne=()=>{const u=w;if(u.errors.length){n({title:"Fix required fields",message:u.errors.join("  "),kind:"warn"});return}const P=Date.now(),se=Vr("BK"),D=de.tags.split(",").map(k=>k.trim()).filter(Boolean).slice(0,10),re=de.purpose==="Other"?de.purposeOther.trim():void 0,v={id:se,ref:hd("TRV"),travelerType:de.travelerType,travelerId:de.travelerId,bookedBy:de.bookedBy,createdAt:P,scheduledAt:u.scheduledAt,pickup:de.pickup.trim(),dropoff:de.dropoff.trim(),category:de.category,purpose:de.purpose,purposeOther:re,tags:D,costCenter:de.costCenter.trim(),projectTag:de.projectTag.trim(),module:de.module,status:u.needsApproval?"Pending approval":"Confirmed",vipRequested:de.vipRequested||u.tVip,policyNotes:u.flags.filter(k=>!k.endsWith("required")),proofs:[]};L(k=>[v,...k]),u.needsApproval&&ue({scope:"Booking",scopeId:v.id,createdBy:de.bookedBy,reason:"Policy exception required for this booking",flags:u.flags.filter(k=>!k.endsWith("required"))}),n({title:"Created",message:u.needsApproval?"Booking created and sent for approval.":"Booking confirmed.",kind:"success"}),ce(!1),he(0),H("bookings")},Me=()=>{const u=y.find(S=>S.id===Ne.eventId);if(!u){n({title:"Missing",message:"Select an event.",kind:"warn"});return}const P=u.startAt,se=u.endAt,D=[],re=P-Ne.offsetMinsBeforeStart*60*1e3,v=se+Ne.returnMinsAfterEnd*60*1e3,k=Date.now();for(const S of u.attendees){Te(S.type,S.id);const f=Ge(S.type,S.id),U=[];Ne.category==="Premium"&&r.premiumRequiresApproval&&U.push("Premium requested"),f&&U.push("VIP traveler"),Am(re,r.workStart,r.workEnd)&&U.push("After-hours");const p=U.length>0;if(D.push({id:Vr("BK"),ref:hd("EVT"),travelerType:S.type,travelerId:S.id,bookedBy:"Travel Coordinator",createdAt:k,scheduledAt:re,pickup:Ne.pickup,dropoff:Ne.dropoff,category:Ne.category,purpose:Ne.purpose,tags:Ne.tags.split(",").map(M=>M.trim()).filter(Boolean),costCenter:Ne.costCenter,projectTag:Ne.projectTag,module:"Rides & Logistics",status:p?"Pending approval":"Confirmed",eventId:u.id,vipRequested:f,policyNotes:U,proofs:[]}),Ne.createReturn){const M=[];Ne.category==="Premium"&&r.premiumRequiresApproval&&M.push("Premium requested"),f&&M.push("VIP traveler"),Am(v,r.workStart,r.workEnd)&&M.push("After-hours");const ee=M.length>0;D.push({id:Vr("BK"),ref:hd("EVT"),travelerType:S.type,travelerId:S.id,bookedBy:"Travel Coordinator",createdAt:k,scheduledAt:v,pickup:Ne.returnPickup,dropoff:Ne.returnDropoff,category:Ne.category,purpose:Ne.purpose,tags:[...Ne.tags.split(",").map(b=>b.trim()).filter(Boolean),"Return"],costCenter:Ne.costCenter,projectTag:Ne.projectTag,module:"Rides & Logistics",status:ee?"Pending approval":"Confirmed",eventId:u.id,vipRequested:f,policyNotes:M,proofs:[]})}}if(L(S=>[...D,...S]),D.some(S=>S.status==="Pending approval")){const S=Array.from(new Set(D.flatMap(f=>f.policyNotes))).filter(Boolean);ue({scope:"Event",scopeId:u.id,createdBy:"Travel Coordinator",reason:`Bulk event booking requires policy approval (${D.filter(f=>f.status==="Pending approval").length} pending).`,flags:S.length?S:["Bulk booking"]})}n({title:"Bulk created",message:`Created ${D.length} booking(s).`,kind:"success"}),Le(!1),H("bookings")},De=u=>{const P=Date.now();oe(se=>se.map(D=>{if(D.id!==u)return D;const re=D.steps.findIndex(S=>S.status==="Pending");if(re<0)return D;const v=D.steps.slice();v[re]={...v[re],status:"Approved",decidedAt:P,note:"Approved"};const m=v.every(S=>S.status==="Approved")?"Approved":"Pending";return{...D,steps:v,status:m}})),te.find(se=>se.id===u),te.map(se=>(se.id===u,se)),setTimeout(()=>{oe(se=>{const D=se.find(re=>re.id===u);return!D||D.status!=="Approved"||(D.scope==="Booking"&&L(re=>re.map(v=>v.id===D.scopeId?{...v,status:"Confirmed"}:v)),D.scope==="Event"&&L(re=>re.map(v=>v.eventId===D.scopeId&&v.status==="Pending approval"?{...v,status:"Confirmed"}:v)),D.scope==="VIP Exception"&&F(re=>re.map(v=>v.approvalId===D.id?{...v,status:"Approved"}:v)),n({title:"Approved",message:"Approval progressed.",kind:"success"})),se})},0)},fe=u=>{const P=Date.now();oe(D=>D.map(re=>{if(re.id!==u)return re;const v=re.steps.findIndex(m=>m.status==="Pending"),k=re.steps.slice();return v>=0&&(k[v]={...k[v],status:"Rejected",decidedAt:P,note:"Rejected"}),{...re,steps:k,status:"Rejected"}}));const se=te.find(D=>D.id===u);(se==null?void 0:se.scope)==="Booking"&&L(D=>D.map(re=>re.id===se.scopeId?{...re,status:"Cancelled",policyNotes:[...re.policyNotes,"Rejected"]}:re)),n({title:"Rejected",message:"Approval rejected.",kind:"warn"})},me=()=>{if(!Oe.reason.trim()){n({title:"Missing",message:"Add a reason.",kind:"warn"});return}const P=Date.now(),se={id:Vr("VX"),travelerType:Oe.travelerType,travelerId:Oe.travelerId,exceptionType:Oe.exceptionType,validFrom:P,validTo:P+Oh(Oe.validDays,1,365)*864e5,status:"Pending",requestedBy:"Org Admin",reason:Oe.reason.trim()},D=["VIP",Oe.exceptionType==="Premium rides"?"Premium":"After-hours"],re=ue({scope:"VIP Exception",scopeId:se.id,createdBy:"Org Admin",reason:se.reason,flags:D});se.approvalId=re.id,F(v=>[se,...v]),n({title:"Requested",message:"VIP exception requested and sent for approval.",kind:"success"}),ie(!1),H("approvals")},Xe=()=>{const u=z.map(f=>{const U=Te(f.travelerType,f.travelerId),p=f.travelerType==="Visitor"?We(f.travelerId):"-";return{ref:f.ref,status:f.status,traveler:U,travelerType:f.travelerType,host:p,when:xr(f.scheduledAt),pickup:f.pickup,dropoff:f.dropoff,category:f.category,purpose:f.purpose==="Other"?f.purposeOther||"Other":f.purpose,tags:f.tags.join(";"),costCenter:f.costCenter,projectTag:f.projectTag,policyNotes:f.policyNotes.join(";")}}),P=Object.keys(u[0]||{ref:""}),se=f=>{const U=String(f??"");return/[",\n]/.test(U)?`"${U.replace(/"/g,'""')}"`:U},D=P.join(","),re=u.map(f=>P.map(U=>se(f[U])).join(",")).join(`
`),v=`${D}
${re}`,k=new Blob([v],{type:"text/csv"}),m=URL.createObjectURL(k),S=document.createElement("a");S.href=m,S.download="corporate-travel-bookings.csv",S.click(),URL.revokeObjectURL(m),n({title:"Exported",message:"Bookings CSV downloaded.",kind:"success"})};return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(Z_,{toasts:a,onDismiss:u=>l(P=>P.filter(se=>se.id!==u))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:gx.green},children:e.jsx(Dn,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Corporate Travel and Scheduling"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Pre-book rides for visitors, events, and recurring commutes. Book on behalf, enforce purpose tags, and handle VIP exceptions with approvals."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(dt,{label:`Open: ${Be.open}`,tone:Be.open?"warn":"good"}),e.jsx(dt,{label:`Today: ${Be.dueToday}`,tone:Be.dueToday?"info":"neutral"}),e.jsx(dt,{label:`Approvals: ${Ue}`,tone:Ue?"warn":"good"}),e.jsx(dt,{label:`VIP pending: ${Be.vipPending}`,tone:Be.vipPending?"warn":"good"}),e.jsx(dt,{label:Ye?`Peak hour: ${Ve.hour}:00 (${Ve.count})`:`Peak hour: ${Ve.hour}:00`,tone:Ye?"warn":"neutral"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Jt,{variant:"outline",onClick:Xe,children:[e.jsx(pt,{className:"h-4 w-4"})," Export CSV"]}),e.jsxs(Jt,{variant:"outline",onClick:()=>Le(!0),children:[e.jsx(Os,{className:"h-4 w-4"})," Bulk event booking"]}),e.jsxs(Jt,{variant:"primary",onClick:()=>{ce(!0),he(0)},children:[e.jsx(gt,{className:"h-4 w-4"})," New booking"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"overview",label:"Overview"},{id:"bookings",label:"Bookings"},{id:"events",label:"Events"},{id:"recurring",label:"Recurring commutes"},{id:"vip",label:"Visitors and VIP"},{id:"insights",label:"Scheduling insights"},{id:"approvals",label:"Approvals"}].map(u=>e.jsx("button",{className:ca("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",G===u.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:G===u.id?{background:gx.green}:void 0,onClick:()=>H(u.id),children:u.label},u.id))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[G==="overview"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsxs(Ga,{title:"Upcoming bookings",subtitle:"Pre-booked rides, event transfers, and visitor trips.",right:e.jsx(dt,{label:`${ze.length} upcoming`,tone:ze.length?"info":"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"When"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Traveler"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Route"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Purpose"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[ze.slice().sort((u,P)=>u.scheduledAt-P.scheduledAt).slice(0,6).map(u=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:xr(u.scheduledAt)}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:Te(u.travelerType,u.travelerId)}),Ge(u.travelerType,u.travelerId)?e.jsx(dt,{label:"VIP",tone:"info"}):null,e.jsx(dt,{label:u.travelerType,tone:"neutral"})]}),u.travelerType==="Visitor"?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Host: ",We(u.travelerId)]}):null]}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[u.pickup,"  ",u.dropoff]}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx(dt,{label:u.purpose==="Other"?u.purposeOther||"Other":u.purpose,tone:"neutral"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[u.tags.slice(0,3).join(", "),u.tags.length>3?"":""]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(dt,{label:u.status,tone:vb(u.status)})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(Jt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>B(u.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]})})]},u.id)),ze.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-10",children:e.jsx(ro,{title:"No upcoming bookings",subtitle:"Create a booking or bulk book for an event."})})})]})]})}),Ye?e.jsxs("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:["Smart scheduling: peak time detected around ",Ve.hour,":00. Consider preplanning 15-30 minutes earlier or switching to bulk event booking."]}):e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Smart scheduling: no peak congestion detected in upcoming bookings."})]}),e.jsxs(Ga,{title:"Policy guardrails",subtitle:"Trip purpose enforcement and tagging.",right:e.jsx(dt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(Cm,{enabled:r.requirePurpose,onChange:u=>i(P=>({...P,requirePurpose:u})),label:"Require trip purpose",description:"Purpose must be selected and stored."}),e.jsx(Cm,{enabled:r.requireProjectTag,onChange:u=>i(P=>({...P,requireProjectTag:u})),label:"Require project tag",description:"Used for reporting and chargeback."}),e.jsx(Cm,{enabled:r.requireCostCenter,onChange:u=>i(P=>({...P,requireCostCenter:u})),label:"Require cost center",description:"Enforced on booking creation."}),e.jsx(Cm,{enabled:r.premiumRequiresApproval,onChange:u=>i(P=>({...P,premiumRequiresApproval:u})),label:"Premium requires approval",description:"Policy exceptions are approval-gated."})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:["Default working hours: ",r.workStart," to ",r.workEnd,". After-hours bookings require approval unless a VIP exception is active."]})]})]}),e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsx(Ga,{title:"Events",subtitle:"Upcoming corporate events with manifests.",right:e.jsx(dt,{label:`${le.length}`,tone:le.length?"info":"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[le.slice(0,4).map(u=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:u.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[xr(u.startAt),"  ",u.location]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(dt,{label:`${u.attendees.length} attendees`,tone:"neutral"}),u.attendees.some(P=>Ge(P.type,P.id))?e.jsx(dt,{label:"VIP present",tone:"info"}):null]})]}),e.jsxs(Jt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{ge(P=>({...P,eventId:u.id,projectTag:u.name})),Le(!0)},children:[e.jsx(Os,{className:"h-4 w-4"})," Bulk"]})]})},u.id)),le.length?null:e.jsx(ro,{title:"No upcoming events",subtitle:"Create an event manifest first (future)."})]})}),e.jsxs(Ga,{title:"Approvals queue",subtitle:"Policy exceptions and VIP handling.",right:e.jsx(dt,{label:`${Ue}`,tone:Ue?"warn":"good"}),children:[e.jsxs("div",{className:"space-y-2",children:[te.filter(u=>u.status==="Pending").slice(0,4).map(u=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(dt,{label:u.scope,tone:"neutral"}),e.jsx(dt,{label:u.status,tone:Sm(u.status)}),e.jsx(dt,{label:`${u.steps.filter(P=>P.status==="Pending").length} step(s)`,tone:"info"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:u.reason}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[hb(u.createdAt),"  ",u.createdBy]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[u.policyFlags.slice(0,3).map((P,se)=>e.jsx(dt,{label:P,tone:"neutral"},`${u.id}-f-${se}`)),u.policyFlags.length>3?e.jsx(dt,{label:"+more",tone:"neutral"}):null]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(Jt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>De(u.id),children:[e.jsx(tt,{className:"h-4 w-4"})," Approve"]}),e.jsxs(Jt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>fe(u.id),children:[e.jsx(Qe,{className:"h-4 w-4"})," Reject"]})]})]})},u.id)),te.filter(u=>u.status==="Pending").length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No pending approvals."})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Jt,{variant:"outline",onClick:()=>H("approvals"),children:[e.jsx(et,{className:"h-4 w-4"})," Open approvals"]}),e.jsxs(Jt,{variant:"outline",onClick:()=>ie(!0),children:[e.jsx(Qr,{className:"h-4 w-4"})," VIP exception"]})]})]})]})]}):null,G==="bookings"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(Ga,{title:"Search and filters",subtitle:"Coordinator view.",right:e.jsx(dt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-2 py-2",children:[e.jsx(pa,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:Y,onChange:u=>we(u.target.value),placeholder:"ref, traveler, route, tag...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(Wn,{label:"Status",value:q,onChange:u=>je(u),options:[{value:"All",label:"All"},...["Draft","Pending approval","Confirmed","Completed","Cancelled"].map(u=>({value:u,label:u}))]}),e.jsx(Wn,{label:"Traveler type",value:_e,onChange:u=>Ee(u),options:[{value:"All",label:"All"},{value:"Employee",label:"Employee"},{value:"Visitor",label:"Visitor"}]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Jt,{variant:"outline",onClick:()=>{we(""),je("All"),Ee("All"),n({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(vn,{className:"h-4 w-4"})," Reset"]}),e.jsxs(Jt,{variant:"outline",onClick:Xe,children:[e.jsx(pt,{className:"h-4 w-4"})," CSV"]}),e.jsxs(Jt,{variant:"primary",onClick:()=>ce(!0),children:[e.jsx(gt,{className:"h-4 w-4"})," New"]})]})]}),e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Book on behalf: choose employee or visitor, then apply purpose tags, cost center, and project tag."})]})}),e.jsx("div",{className:"lg:col-span-8",children:e.jsx(Ga,{title:"Bookings",subtitle:"Pre-booked rides and scheduled transfers.",right:e.jsx(dt,{label:`${z.length}`,tone:"neutral"}),children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Ref"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"When"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Traveler"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Route"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Category"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Purpose"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[z.map(u=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:u.ref}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:u.id})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:xr(u.scheduledAt)}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:Te(u.travelerType,u.travelerId)}),Ge(u.travelerType,u.travelerId)?e.jsx(dt,{label:"VIP",tone:"info"}):null,e.jsx(dt,{label:u.travelerType,tone:"neutral"})]}),u.travelerType==="Visitor"?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Host: ",We(u.travelerId)]}):null]}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[u.pickup,"  ",u.dropoff]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(dt,{label:u.category,tone:u.category==="Premium"?"info":"neutral"})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx(dt,{label:u.purpose==="Other"?u.purposeOther||"Other":u.purpose,tone:"neutral"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[u.costCenter,"  ",u.projectTag]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(dt,{label:u.status,tone:vb(u.status)})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(Jt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>B(u.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]})})]},u.id)),z.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-10",children:e.jsx(ro,{title:"No bookings",subtitle:"Create a booking or adjust filters."})})})]})]})})})})]}):null,G==="events"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsx(Ga,{title:"Event manifests",subtitle:"Premium: many riders and bulk booking.",right:e.jsx(dt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"space-y-2",children:[y.slice().sort((u,P)=>u.startAt-P.startAt).map(u=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:u.name}),e.jsx(dt,{label:Pc(u.startAt),tone:"neutral"}),e.jsx(dt,{label:`${u.attendees.length} attendees`,tone:"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[xr(u.startAt)," to ",xr(u.endAt)]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Location: ",u.location]}),u.notes?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Notes: ",u.notes]}):null]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(Jt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{ge(P=>({...P,eventId:u.id,projectTag:u.name})),Le(!0)},children:[e.jsx(Os,{className:"h-4 w-4"})," Bulk"]}),e.jsxs(Jt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{H("bookings"),we(u.name),n({title:"Filtered",message:"Showing related bookings.",kind:"info"})},children:[e.jsx(et,{className:"h-4 w-4"})," Bookings"]})]})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Manifest"}),e.jsxs("div",{className:"mt-2 grid grid-cols-1 gap-2 sm:grid-cols-2",children:[u.attendees.slice(0,6).map((P,se)=>e.jsxs("div",{className:"flex items-center justify-between gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-800",children:Te(P.type,P.id)}),e.jsxs("div",{className:"flex items-center gap-2",children:[Ge(P.type,P.id)?e.jsx(dt,{label:"VIP",tone:"info"}):null,e.jsx(dt,{label:P.type,tone:"neutral"})]})]},`${u.id}-a-${se}`)),u.attendees.length>6?e.jsxs("div",{className:"text-xs text-slate-500",children:["+",u.attendees.length-6," more"]}):null]})]})]},u.id)),y.length?null:e.jsx(ro,{title:"No events",subtitle:"Add an event manifest first."})]})})}),e.jsxs("div",{className:"lg:col-span-7 space-y-4",children:[e.jsx(Ga,{title:"Peak-time preplanning",subtitle:"Premium: detect peak times and suggest buffers.",right:e.jsx(dt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Peak hour"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Computed from upcoming bookings by hour."})]}),e.jsx(dt,{label:`${Ve.hour}:00  ${Ve.count} booking(s)`,tone:Ye?"warn":"neutral"})]}),e.jsx("div",{className:"mt-4 grid grid-cols-6 gap-2 sm:grid-cols-8 md:grid-cols-12",children:Ae.map((u,P)=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-2 text-center",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-700",children:P}),e.jsx("div",{className:ca("mt-2 h-2 rounded-full",u?"bg-emerald-200":"bg-slate-100"),style:{width:"100%"}}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:u})]},P))}),e.jsxs("div",{className:"mt-4 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:["Smart suggestion: if booking at ",Ve.hour,":00, consider scheduling 15-30 minutes earlier and pre-assigning vehicles for event manifests."]})]})}),e.jsx(Ga,{title:"VIP handling",subtitle:"Policy exceptions with approvals.",right:e.jsx(dt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"VIP exceptions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Allow premium rides or after-hours for specific travelers."})]}),e.jsxs(Jt,{variant:"primary",onClick:()=>ie(!0),children:[e.jsx(Qr,{className:"h-4 w-4"})," Request"]})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[R.slice(0,5).map(u=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(dt,{label:u.exceptionType,tone:"neutral"}),e.jsx(dt,{label:u.status,tone:Sm(u.status)}),e.jsx(dt,{label:`${Pc(u.validFrom)}  ${Pc(u.validTo)}`,tone:"info"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:Te(u.travelerType,u.travelerId)}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Requested by ",u.requestedBy,"  ",u.reason]})]}),u.approvalId?e.jsx(dt,{label:u.approvalId,tone:"neutral"}):null]})},u.id)),R.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No VIP exceptions."})]})]})})]})]}):null,G==="recurring"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsxs(Ga,{title:"Recurring commutes",subtitle:"Core: recurring schedules for office commute.",right:e.jsx(dt,{label:`${T.length}`,tone:"neutral"}),children:[e.jsxs("div",{className:"space-y-2",children:[T.map(u=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:u.name}),e.jsx(dt,{label:u.enabled?"Enabled":"Disabled",tone:u.enabled?"good":"neutral"}),e.jsx(dt,{label:`${u.timeLocal}`,tone:"neutral"}),e.jsx(dt,{label:u.category,tone:u.category==="Premium"?"info":"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Days: ",u.days.join(", ")]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Route: ",u.pickup,"  ",u.dropoff]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Employees: ",u.employees.map(P=>{var se;return((se=j[P])==null?void 0:se.name)||P}).join(", ")]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(Jt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{C(P=>P.map(se=>se.id===u.id?{...se,enabled:!se.enabled}:se)),n({title:"Updated",message:"Recurring schedule updated.",kind:"success"})},children:[e.jsx(IE,{className:"h-4 w-4"})," Toggle"]}),e.jsxs(Jt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{const P=Date.now()+1728e5,[se,D]=u.timeLocal.split(":").map(S=>Number(S)),re=new Date(P);re.setHours(se||0,D||0,0,0);const v=re.getTime(),k=u.employees.map(S=>{const f=j[S],U=[];u.category==="Premium"&&r.premiumRequiresApproval&&U.push("Premium requested"),Am(v,r.workStart,r.workEnd)&&U.push("After-hours"),f!=null&&f.vip&&U.push("VIP traveler");const p=U.length>0;return{id:Vr("BK"),ref:hd("RC"),travelerType:"Employee",travelerId:S,bookedBy:"Travel Coordinator",createdAt:Date.now(),scheduledAt:v,pickup:u.pickup,dropoff:u.dropoff,category:u.category,purpose:u.purpose,tags:u.tags,costCenter:(f==null?void 0:f.costCenter)||"OPS-001",projectTag:u.name,module:"Rides & Logistics",status:p?"Pending approval":"Confirmed",recurringId:u.id,vipRequested:!!(f!=null&&f.vip),policyNotes:U,proofs:[]}});L(S=>[...k,...S]),k.some(S=>S.status==="Pending approval")&&ue({scope:"Event",scopeId:u.id,createdBy:"Travel Coordinator",reason:"Recurring booking instance requires policy approval",flags:Array.from(new Set(k.flatMap(S=>S.policyNotes)))}),n({title:"Generated",message:`Created ${k.length} booking(s) from recurring schedule.`,kind:"success"}),H("bookings")},children:[e.jsx(ht,{className:"h-4 w-4"})," Generate"]})]})]})},u.id)),T.length?null:e.jsx(ro,{title:"No recurring schedules",subtitle:"Create a recurring commute plan."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: smart scheduling can preplan around peak time and suggest alternate pickup windows."})]})}),e.jsxs("div",{className:"lg:col-span-7 space-y-4",children:[e.jsxs(Ga,{title:"Policy enforcement preview",subtitle:"What would require approval.",right:e.jsx(dt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"After-hours"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Outside ",r.workStart," to ",r.workEnd]})]}),e.jsx(dt,{label:"Approval",tone:"warn"})]}),e.jsx("div",{className:"mt-3 text-xs text-slate-600",children:"Best practice: require Manager and Finance approval; add CFO for VIP."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Premium"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Premium category request"})]}),e.jsx(dt,{label:"Approval",tone:"warn"})]}),e.jsx("div",{className:"mt-3 text-xs text-slate-600",children:"Best practice: allow premium for VIP only through approvals or VIP exception."})]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Tip: Link enforcement to Approval Workflow Builder (J) for organization-wide consistency."})]}),e.jsx(Ga,{title:"Recurring best practices",subtitle:"Operational tips for commuting programs.",right:e.jsx(dt,{label:"Premium",tone:"info"}),children:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"1) Start with a pilot group for commutes, then expand"}),e.jsx("li",{children:"2) Enforce purpose tagging and cost center"}),e.jsx("li",{children:"3) Prebook 15-30 minutes earlier during peak traffic"}),e.jsx("li",{children:"4) Maintain VIP exceptions for executives with audit trails"})]})})})]})]}):null,G==="vip"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-6 space-y-4",children:e.jsxs(Ga,{title:"Visitors",subtitle:"Core: visitor prebooking and host enforcement.",right:e.jsx(dt,{label:`${c.length}`,tone:"neutral"}),children:[e.jsxs("div",{className:"space-y-2",children:[c.map(u=>{var P;return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:u.name}),e.jsx(dt,{label:u.company,tone:"neutral"}),u.vip?e.jsx(dt,{label:"VIP",tone:"info"}):null]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Host: ",((P=j[u.hostEmployeeId])==null?void 0:P.name)||u.hostEmployeeId]}),u.phone?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Phone: ",u.phone]}):null]}),e.jsxs(Jt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>{ye(se=>({...se,travelerType:"Visitor",travelerId:u.id,pickup:"Entebbe Airport",dropoff:"Kampala HQ",category:u.vip?"Premium":"Standard",vipRequested:u.vip,purpose:"Visitor",projectTag:"Visitor transport",tags:u.vip?"VIP,Airport":"Visitor,Airport"})),he(1),ce(!0)},children:[e.jsx(WF,{className:"h-4 w-4"})," Book"]})]})},u.id)}),c.length?null:e.jsx(ro,{title:"No visitors",subtitle:"Add visitors to enable pre-booking."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: visitor bookings should always store host employee and trip purpose."})]})}),e.jsx("div",{className:"lg:col-span-6 space-y-4",children:e.jsxs(Ga,{title:"VIP exceptions",subtitle:"Premium: policy exceptions with approvals.",right:e.jsx(dt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Jt,{variant:"primary",onClick:()=>ie(!0),children:[e.jsx(Qr,{className:"h-4 w-4"})," Request exception"]}),e.jsxs(Jt,{variant:"outline",onClick:()=>H("approvals"),children:[e.jsx(et,{className:"h-4 w-4"})," View approvals"]})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[R.map(u=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(dt,{label:u.exceptionType,tone:"neutral"}),e.jsx(dt,{label:u.status,tone:Sm(u.status)}),e.jsx(dt,{label:`${Pc(u.validFrom)}  ${Pc(u.validTo)}`,tone:"info"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:Te(u.travelerType,u.travelerId)}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Requested by ",u.requestedBy,"  ",u.reason]}),u.approvalId?e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Approval: ",u.approvalId]}):null]}),e.jsx(Qr,{className:ca("h-5 w-5",u.status==="Approved"?"text-amber-500":"text-slate-300")})]})},u.id)),R.length?null:e.jsx(ro,{title:"No VIP exceptions",subtitle:"Request an exception to allow premium or after-hours travel."})]})]})})]}):null,G==="insights"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-5 space-y-4",children:[e.jsx(Ga,{title:"Peak time detection",subtitle:"Premium: smart scheduling suggestions.",right:e.jsx(dt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Peak hour"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Upcoming bookings by hour (0-23)"})]}),e.jsx(dt,{label:`${Ve.hour}:00  ${Ve.count}`,tone:Ye?"warn":"neutral"})]}),e.jsx("div",{className:"mt-4 grid grid-cols-6 gap-2 sm:grid-cols-8 md:grid-cols-12",children:Ae.map((u,P)=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-2 text-center",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-700",children:P}),e.jsx("div",{className:ca("mt-2 h-2 rounded-full",u?"bg-emerald-200":"bg-slate-100")}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:u})]},P))}),e.jsx("div",{className:"mt-4 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Suggestion: schedule event transfers 30 minutes earlier during peak hours and use bulk booking to reduce coordination load."})]})}),e.jsx(Ga,{title:"Recommendations",subtitle:"Next best coordinator actions.",right:e.jsx(dt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{title:"Bulk book your next event",detail:le.length?`Upcoming event: ${le[0].name} has ${le[0].attendees.length} attendee(s).`:"Create an event manifest to bulk book rides.",cta:"Bulk book",onClick:()=>Le(!0)}),e.jsx(E,{title:"Resolve pending approvals",detail:`There are ${Ue} approval request(s) pending.`,cta:"Open approvals",onClick:()=>H("approvals")}),e.jsx(E,{title:"Create a VIP exception",detail:"For recurring executive travel, create an approved VIP exception with audit trail.",cta:"Request",onClick:()=>ie(!0)})]})})]}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs(Ga,{title:"Program insights",subtitle:"Policy compliance and quality indicators.",right:e.jsx(dt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(V,{title:"After-hours",value:`${W.filter(u=>Am(u.scheduledAt,r.workStart,r.workEnd)).length}`,sub:"Bookings outside window",icon:e.jsx(sl,{className:"h-5 w-5"}),tone:"warn"}),e.jsx(V,{title:"Premium",value:`${W.filter(u=>u.category==="Premium").length}`,sub:"Premium category",icon:e.jsx(Qr,{className:"h-5 w-5"}),tone:"info"}),e.jsx(V,{title:"Purpose missing",value:`${W.filter(u=>u.purpose==="Other"&&!u.purposeOther).length}`,sub:"Should be 0",icon:e.jsx(Et,{className:"h-5 w-5"}),tone:"bad"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: peak time detection can be expanded with traffic data and city events calendars."})]})})]}):null,G==="approvals"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(Ga,{title:"Approvals",subtitle:"VIP, premium, and after-hours exceptions.",right:e.jsx(dt,{label:"Core",tone:"neutral"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Approvals are required before sending some bookings to dispatch."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Jt,{variant:"primary",onClick:()=>ie(!0),children:[e.jsx(Qr,{className:"h-4 w-4"})," VIP exception"]}),e.jsxs(Jt,{variant:"outline",onClick:()=>n({title:"Tip",message:"Map these approvals to your global Approval Workflow Builder (J).",kind:"info"}),children:[e.jsx(en,{className:"h-4 w-4"})," Tip"]})]})]})}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsx(Ga,{title:"Approval requests",subtitle:"Approve or reject with audit trail.",right:e.jsx(dt,{label:`${te.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[te.slice().sort((u,P)=>P.createdAt-u.createdAt).map(u=>{const P=u.steps.findIndex(D=>D.status==="Pending"),se=P>=0?u.steps[P]:null;return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(dt,{label:u.scope,tone:"neutral"}),e.jsx(dt,{label:u.status,tone:Sm(u.status)}),e.jsx(dt,{label:u.id,tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:u.reason}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",hb(u.createdAt),"  ",u.createdBy]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:u.policyFlags.map((D,re)=>e.jsx(dt,{label:D,tone:"neutral"},`${u.id}-pf-${re}`))}),se?e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Next: ",e.jsx("span",{className:"font-semibold",children:se.role})," (",se.assignee,")  SLA ",se.slaHours,"h"]}):null]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Jt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>De(u.id),disabled:u.status!=="Pending",children:[e.jsx(tt,{className:"h-4 w-4"})," Approve"]}),e.jsxs(Jt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>fe(u.id),disabled:u.status!=="Pending",children:[e.jsx(Qe,{className:"h-4 w-4"})," Reject"]}),u.scope==="Booking"?e.jsxs(Jt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{B(u.scopeId)},children:[e.jsx(et,{className:"h-4 w-4"})," Open booking"]}):null]})]}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2 md:grid-cols-2",children:u.steps.map(D=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:D.role}),e.jsx(dt,{label:D.status,tone:Sm(D.status)})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Assignee: ",D.assignee,"  SLA ",D.slaHours,"h"]}),D.decidedAt?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Decided ",xr(D.decidedAt),"  ",D.note||""]}):null]},D.id))})]},u.id)}),te.length?null:e.jsx(ro,{title:"No approvals",subtitle:"Policy exceptions will appear here."})]})})})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"U Corporate Travel and Scheduling v2. Core: pre-book rides for visitors, events, recurring commutes; coordinator book-on-behalf tools; purpose tagging. Premium: event manifests and bulk booking, VIP exception approvals, and peak-time scheduling insights."})})]})}),e.jsx(J_,{open:be,title:Q?`${Q.ref}  ${Q.category}`:"Booking",subtitle:Q?`${Te(Q.travelerType,Q.travelerId)}  ${xr(Q.scheduledAt)}`:"",onClose:()=>Fe(!1),footer:Q?e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"In production, this links to dispatch and driver assignment."}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Jt,{variant:"outline",onClick:()=>{L(u=>u.map(P=>P.id===Q.id?{...P,status:"Cancelled"}:P)),n({title:"Cancelled",message:"Booking cancelled.",kind:"warn"}),Fe(!1)},disabled:Q.status==="Cancelled"||Q.status==="Completed",children:[e.jsx(Qe,{className:"h-4 w-4"})," Cancel"]}),e.jsxs(Jt,{variant:"primary",onClick:()=>{L(u=>u.map(P=>P.id===Q.id?{...P,status:"Completed",proofs:[{id:Vr("AT"),name:"Trip receipt.pdf",note:"Receipt",addedAt:Date.now(),addedBy:"System"},...P.proofs]}:P)),n({title:"Completed",message:"Booking marked completed.",kind:"success"})},disabled:Q.status!=="Confirmed",title:Q.status!=="Confirmed"?"Only confirmed bookings can complete":"",children:[e.jsx(tt,{className:"h-4 w-4"})," Complete"]})]})]}):null,children:Q?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(dt,{label:Q.status,tone:vb(Q.status)}),e.jsx(dt,{label:Q.purpose==="Other"?Q.purposeOther||"Other":Q.purpose,tone:"neutral"}),Ge(Q.travelerType,Q.travelerId)?e.jsx(dt,{label:"VIP",tone:"info"}):null,Q.category==="Premium"?e.jsx(dt,{label:"Premium",tone:"info"}):e.jsx(dt,{label:"Standard",tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:Te(Q.travelerType,Q.travelerId)}),Q.travelerType==="Visitor"?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Host: ",We(Q.travelerId)]}):null,e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Booked by ",Q.bookedBy,"  Created ",hb(Q.createdAt)]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Scheduled"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:xr(Q.scheduledAt)}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Cost center"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:Q.costCenter})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Pickup"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:Q.pickup})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Drop-off"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:Q.dropoff})]})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Tags"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:Q.tags.length?Q.tags.map((u,P)=>e.jsx(dt,{label:u,tone:"neutral"},`${Q.id}-t-${P}`)):e.jsx(dt,{label:"None",tone:"neutral"})}),e.jsxs("div",{className:"mt-3 text-xs text-slate-600",children:["Project: ",Q.projectTag]})]}),Q.policyNotes.length?e.jsxs("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:[e.jsx("div",{className:"font-semibold",children:"Policy notes"}),e.jsx("ul",{className:"mt-2 space-y-1",children:Q.policyNotes.map((u,P)=>e.jsxs("li",{children:[" ",u]},`${Q.id}-pn-${P}`))})]}):null]}),e.jsx(Ga,{title:"Proofs",subtitle:"Receipts and completion logs.",right:e.jsx(dt,{label:`${Q.proofs.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[Q.proofs.map(u=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:u.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[xr(u.addedAt),"  ",u.addedBy]}),u.note?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Note: ",u.note]}):null]}),e.jsx(Jt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:async()=>{try{await navigator.clipboard.writeText(u.name),n({title:"Copied",message:"Proof name copied.",kind:"success"})}catch{n({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},children:e.jsx(ss,{className:"h-4 w-4"})})]})},u.id)),Q.proofs.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No proofs yet."})]})})]}):null}),e.jsx(fb,{open:Re,title:"New booking",subtitle:"Coordinator booking on behalf. Purpose, tags, and policy enforcement are required.",onClose:()=>ce(!1),actions:[{label:"Create",onClick:ne}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Jt,{variant:"outline",onClick:()=>ce(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Jt,{variant:"outline",onClick:()=>he(u=>u>0?u-1:u),disabled:xe===0,children:"Back"}),xe<2?e.jsxs(Jt,{variant:"primary",onClick:()=>he(u=>u+1),children:["Next",e.jsx(et,{className:"h-4 w-4"})]}):e.jsxs(Jt,{variant:"primary",onClick:ne,children:[e.jsx(ct,{className:"h-4 w-4"})," Create"]})]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:[0,1,2].map(u=>e.jsx("button",{type:"button",className:ca("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",xe===u?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:xe===u?{background:gx.green}:void 0,onClick:()=>he(u),children:u===0?"Traveler":u===1?"Trip details":"Policy check"},u))}),xe===0?e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Wn,{label:"Traveler type",value:de.travelerType,onChange:u=>ye(P=>{var se,D;return{...P,travelerType:u,travelerId:u==="Employee"?((se=o[0])==null?void 0:se.id)||"":((D=c[0])==null?void 0:D.id)||""}}),options:[{value:"Employee",label:"Employee"},{value:"Visitor",label:"Visitor"}]}),e.jsx(Wn,{label:"Traveler",value:de.travelerId,onChange:u=>ye(P=>({...P,travelerId:u})),options:(de.travelerType==="Employee"?o:c).map(u=>({value:u.id,label:u.name}))}),e.jsx(rn,{label:"Booked by",value:de.bookedBy,onChange:u=>ye(P=>({...P,bookedBy:u})),placeholder:"Travel Coordinator"}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"VIP"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Flag the booking as VIP handling."})]}),e.jsx("button",{type:"button",className:ca("relative h-7 w-12 rounded-full border transition",de.vipRequested?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>ye(u=>({...u,vipRequested:!u.vipRequested})),"aria-label":"Toggle VIP",children:e.jsx("span",{className:ca("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",de.vipRequested?"left-[22px]":"left-1")})})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[Ge(de.travelerType,de.travelerId)?e.jsx(dt,{label:"Traveler is VIP",tone:"info"}):e.jsx(dt,{label:"Standard traveler",tone:"neutral"}),de.travelerType==="Visitor"?e.jsx(dt,{label:`Host: ${We(de.travelerId)}`,tone:"neutral"}):null]})]})]}):null,xe===1?e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(rn,{label:"Pickup",value:de.pickup,onChange:u=>ye(P=>({...P,pickup:u})),placeholder:"Kampala HQ"}),e.jsx(rn,{label:"Drop-off",value:de.dropoff,onChange:u=>ye(P=>({...P,dropoff:u})),placeholder:"Entebbe Airport"}),e.jsx(rn,{label:"Scheduled time",type:"datetime-local",value:de.scheduledAt,onChange:u=>ye(P=>({...P,scheduledAt:u})),hint:"Local time"}),e.jsx(Wn,{label:"Ride category",value:de.category,onChange:u=>ye(P=>({...P,category:u})),options:[{value:"Standard",label:"Standard"},{value:"Premium",label:"Premium"}]}),e.jsx(Wn,{label:"Purpose",value:de.purpose,onChange:u=>ye(P=>({...P,purpose:u})),options:s.map(u=>({value:u,label:u}))}),e.jsx(rn,{label:"Tags",value:de.tags,onChange:u=>ye(P=>({...P,tags:u})),placeholder:"Comma separated",hint:"Example: Airport,VIP,Event"}),e.jsx(rn,{label:"Cost center",value:de.costCenter,onChange:u=>ye(P=>({...P,costCenter:u})),placeholder:"OPS-001"}),e.jsx(rn,{label:"Project tag",value:de.projectTag,onChange:u=>ye(P=>({...P,projectTag:u})),placeholder:"Roadshow"}),e.jsx(Wn,{label:"Module",value:de.module,onChange:u=>ye(P=>({...P,module:u})),options:[{value:"Rides & Logistics",label:"Rides & Logistics"},{value:"Travel & Tourism",label:"Travel & Tourism"},{value:"Other Service Module",label:"Other Service Module"}],hint:"Typically Rides & Logistics"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(rC,{label:"If purpose is Other",value:de.purposeOther,onChange:u=>ye(P=>({...P,purposeOther:u})),placeholder:"Explain the purpose",rows:3,disabled:de.purpose!=="Other",hint:de.purpose!=="Other"?"Disabled":"Required when Other"})})]}):null,xe===2?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Policy check"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"This preview shows why approval may be required."})]}),w.needsApproval?e.jsx(dt,{label:"Approval required",tone:"warn"}):e.jsx(dt,{label:"No approval",tone:"good"})]}),w.errors.length?e.jsxs("div",{className:"mt-3 rounded-2xl bg-rose-50 p-3 text-xs text-rose-800 ring-1 ring-rose-200",children:[e.jsx("div",{className:"font-semibold",children:"Missing"}),e.jsx("ul",{className:"mt-2 space-y-1",children:w.errors.map((u,P)=>e.jsxs("li",{children:[" ",u]},`err-${P}`))})]}):null,e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Scheduled"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:xr(w.scheduledAt)}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["After-hours: ",w.afterHours?"Yes":"No"]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Category"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:de.category}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["VIP: ",w.tVip||de.vipRequested?"Yes":"No"]})]})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Flags"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[w.flags.length?w.flags.map((u,P)=>e.jsx(dt,{label:u,tone:u.endsWith("required")?"bad":"neutral"},`flag-${P}`)):e.jsx(dt,{label:"None",tone:"neutral"}),w.hasActiveVipException?e.jsx(dt,{label:"VIP exception active",tone:"info"}):null]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"If approval is required, the booking will be created in Pending approval and routed to Manager then Finance, and optionally CFO for VIP or Premium."})]})}):null]})}),e.jsx(fb,{open:Ke,title:"Bulk travel plan",subtitle:"Premium: schedule many rides on behalf of employees.",onClose:()=>Le(!1),actions:[{label:"Create",onClick:Me}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Jt,{variant:"outline",onClick:()=>Le(!1),children:"Cancel"}),e.jsxs(Jt,{variant:"primary",onClick:Me,children:[e.jsx(ct,{className:"h-4 w-4"})," Create"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Wn,{label:"Event",value:Ne.eventId,onChange:u=>ge(P=>({...P,eventId:u})),options:y.map(u=>({value:u.id,label:`${u.name} (${Pc(u.startAt)})`}))}),e.jsx(Wn,{label:"Category",value:Ne.category,onChange:u=>ge(P=>({...P,category:u})),options:[{value:"Standard",label:"Standard"},{value:"Premium",label:"Premium"}]}),e.jsx(rn,{label:"Pickup",value:Ne.pickup,onChange:u=>ge(P=>({...P,pickup:u}))}),e.jsx(rn,{label:"Drop-off",value:Ne.dropoff,onChange:u=>ge(P=>({...P,dropoff:u}))}),e.jsx(gb,{label:"Minutes before event",value:Ne.offsetMinsBeforeStart,onChange:u=>ge(P=>({...P,offsetMinsBeforeStart:Oh(u,0,240)})),hint:"Departure buffer"}),e.jsx(rn,{label:"Tags",value:Ne.tags,onChange:u=>ge(P=>({...P,tags:u})),hint:"Comma separated"}),e.jsx(rn,{label:"Cost center",value:Ne.costCenter,onChange:u=>ge(P=>({...P,costCenter:u}))}),e.jsx(rn,{label:"Project tag",value:Ne.projectTag,onChange:u=>ge(P=>({...P,projectTag:u}))}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Cm,{enabled:Ne.createReturn,onChange:u=>ge(P=>({...P,createReturn:u})),label:"Create return trips",description:"Generate return rides after the event ends."})}),e.jsx(rn,{label:"Return pickup",value:Ne.returnPickup,onChange:u=>ge(P=>({...P,returnPickup:u})),disabled:!Ne.createReturn}),e.jsx(rn,{label:"Return drop-off",value:Ne.returnDropoff,onChange:u=>ge(P=>({...P,returnDropoff:u})),disabled:!Ne.createReturn}),e.jsx(gb,{label:"Minutes after event",value:Ne.returnMinsAfterEnd,onChange:u=>ge(P=>({...P,returnMinsAfterEnd:Oh(u,0,240)})),disabled:!Ne.createReturn}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Bulk booking uses the event manifest. If any generated booking violates policy (VIP, Premium, after-hours), an event-level approval request is created."})]})}),e.jsx(fb,{open:$e,title:"Request VIP exception",subtitle:"Premium: allow luxury rides or after-hours travel through approvals.",onClose:()=>ie(!1),actions:[{label:"Submit",onClick:me}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Jt,{variant:"outline",onClick:()=>ie(!1),children:"Cancel"}),e.jsxs(Jt,{variant:"primary",onClick:me,children:[e.jsx(yt,{className:"h-4 w-4"})," Submit"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Wn,{label:"Traveler type",value:Oe.travelerType,onChange:u=>Se(P=>{var se,D;return{...P,travelerType:u,travelerId:u==="Employee"?((se=o[0])==null?void 0:se.id)||"":((D=c[0])==null?void 0:D.id)||""}}),options:[{value:"Employee",label:"Employee"},{value:"Visitor",label:"Visitor"}]}),e.jsx(Wn,{label:"Traveler",value:Oe.travelerId,onChange:u=>Se(P=>({...P,travelerId:u})),options:(Oe.travelerType==="Employee"?o:c).map(u=>({value:u.id,label:u.name}))}),e.jsx(Wn,{label:"Exception type",value:Oe.exceptionType,onChange:u=>Se(P=>({...P,exceptionType:u})),options:[{value:"Premium rides",label:"Premium rides"},{value:"After-hours",label:"After-hours"}]}),e.jsx(gb,{label:"Valid days",value:Oe.validDays,onChange:u=>Se(P=>({...P,validDays:Oh(u,1,365)})),hint:"1 to 365"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(rC,{label:"Reason",value:Oe.reason,onChange:u=>Se(P=>({...P,reason:u})),placeholder:"Explain the business justification",rows:4})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Executive approval chain templates (CFO/CEO) can be applied for VIP exceptions in your workflow builder."})]})})]});function V({title:u,value:P,sub:se,icon:D,tone:re}){const v=re==="good"?"bg-emerald-50 text-emerald-700":re==="warn"?"bg-amber-50 text-amber-800":re==="bad"?"bg-rose-50 text-rose-700":re==="info"?"bg-blue-50 text-blue-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:u}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:P}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:se})]}),e.jsx("div",{className:ca("grid h-10 w-10 place-items-center rounded-2xl",v),children:D})]})})}function E({title:u,detail:P,cta:se,onClick:D}){return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:u}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:P})]}),e.jsxs(Jt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:D,children:[e.jsx(et,{className:"h-4 w-4"})," ",se]})]})})}}const Yx={green:"#03CD8C",orange:"#F77F00"};function un(...t){return t.filter(Boolean).join(" ")}function gd(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function oC(t,s,a){return Math.max(s,Math.min(a,t))}function Em(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function qs(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function dC(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function cC(t,s){const a=r=>{const i=String(r??"");return/[",\n]/.test(i)?`"${i.replace(/"/g,'""')}"`:i},l=s.map(r=>a(r.label)).join(","),n=t.map(r=>s.map(i=>a(r[i.key])).join(",")).join(`
`);return`${l}
${n}`}function Th(t,s,a="text/plain"){const l=new Blob([s],{type:a}),n=URL.createObjectURL(l),r=document.createElement("a");r.href=n,r.download=t,r.click(),URL.revokeObjectURL(n)}function sB(t){let s=t>>>0;return()=>(s=s*1664525+1013904223>>>0,s/4294967296)}function vt({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:un("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function ms({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:Yx.green}:t==="accent"?{background:Yx.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:un(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Zs({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:un(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:un("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function Oc({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:un(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:un("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function aB({actions:t}){const[s,a]=d.useState(!1),l=qt.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:un("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function uC({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="980px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:12,scale:.985},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:12,scale:.985},transition:{duration:.18},className:"fixed inset-x-0 top-[7vh] z-50 mx-auto w-[min(1040px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(aB,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[72vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function lB({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(480px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:un("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function $s({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function qa({title:t,value:s,sub:a,icon:l,tone:n="neutral"}){const r=n==="good"?"bg-emerald-50 text-emerald-700":n==="warn"?"bg-amber-50 text-amber-800":n==="bad"?"bg-rose-50 text-rose-700":n==="info"?"bg-blue-50 text-blue-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:t}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:s}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a})]}),e.jsx("div",{className:un("grid h-10 w-10 place-items-center rounded-2xl",r),children:l})]})})}function bb({label:t,value:s,total:a,right:l}){const n=a>0?Math.round(s/a*100):0;return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:t}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[n,"% share"]})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:l??qs(s)})})]}),e.jsx("div",{className:"mt-3 h-2 w-full overflow-hidden rounded-full bg-slate-100",children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${Math.min(100,n)}%`,background:Yx.green}})})]})}function nB(t){if(!t.length)return 0;const s=t.slice().sort((l,n)=>l-n),a=Math.floor(s.length/2);return s.length%2?s[a]:(s[a-1]+s[a])/2}function mC(t,s,a){const l=new Date,n=l.getTime(),r=new Date(l.getFullYear(),0,1).getTime(),i=24*60*60*1e3;if(t==="7d")return{start:n-7*i,end:n};if(t==="30d")return{start:n-30*i,end:n};if(t==="90d")return{start:n-90*i,end:n};if(t==="YTD")return{start:r,end:n};const o=s?new Date(s).getTime():n-30*i,c=a?new Date(a).getTime()+(24*60*60*1e3-1):n;return{start:Number.isFinite(o)?o:n-30*i,end:Number.isFinite(c)?c:n}}function io(t,s){switch(s){case"Group":return t.group;case"Cost center":return t.costCenter;case"Module":return t.module;case"Marketplace":return t.marketplace||"-";case"Vendor":return t.vendor;case"Requester":return t.requesterName;case"Risk":return t.risk;default:return"-"}}function Rh(t){return t>=7&&t<=9||t>=17&&t<=20}function rB(){const t=d.useMemo(()=>[{id:"U-1001",name:"Mary N.",group:"Operations",costCenter:"OPS-001"},{id:"U-1002",name:"John S.",group:"Sales",costCenter:"SALES-TRAVEL"},{id:"U-1003",name:"Irene K.",group:"Operations",costCenter:"OPS-001"},{id:"U-1004",name:"Daisy O.",group:"Finance",costCenter:"FIN-OPS"},{id:"U-1005",name:"Procurement Desk",group:"Procurement",costCenter:"PROC-001"}],[]);d.useMemo(()=>["EVzone Rides","EVzone Charging","Kampala Office Mart","Shenzhen Store","Shenzhen Tech","ServicePro","Express CN","Hotel Partner","Airline Partner"],[]);const s=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],a=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],[l,n]=d.useState([]),r=m=>{const S=gd("toast");n(f=>[{id:S,...m},...f].slice(0,4)),window.setTimeout(()=>n(f=>f.filter(U=>U.id!==S)),3200)},i=d.useMemo(()=>{const m=sB(1337),S=Date.now(),f=24*60*60*1e3,U=[],p=[],M=h=>{const K=h.reduce((ke,I)=>ke+I.w,0);let _=m()*K;for(const ke of h)if(_-=ke.w,_<=0)return ke.item;return h[h.length-1].item},ee=h=>h==="Ride"?"Rides & Logistics":h==="Charging"?"EVs & Charging":"E-Commerce",b=()=>M([{item:"EVmart",w:1.1},{item:"GadgetMart",w:.9},{item:"LivingMart",w:.6},{item:"ServiceMart",w:.8},{item:"MyLiveDealz",w:.9},{item:"ExpressMart",w:.5}]),ae=(h,K)=>h==="Ride"?"EVzone Rides":h==="Charging"?"EVzone Charging":K==="MyLiveDealz"?"Shenzhen Store":K==="GadgetMart"?"Shenzhen Tech":K==="ExpressMart"?"Express CN":K==="ServiceMart"?"ServicePro":"Kampala Office Mart",ve=(h,K,_=0)=>K==="MyLiveDealz"?"High":K==="ExpressMart"||h==="Charging"&&_>18e4?"Medium":"Low",O=(h,K)=>h==="Ride"?M([{item:["Client"],w:1},{item:["Airport"],w:.6},{item:["Commute"],w:.8}]):h==="Charging"?M([{item:["Depot"],w:1},{item:["Commute"],w:.7},{item:["Emergency"],w:.2}]):K==="MyLiveDealz"?["Deal","Promo"]:K==="ServiceMart"?["Service","Booking"]:["Procurement"],X=h=>{const K=h.ts-Math.floor((m()*90+10)*6e4),_=Math.floor(m()*240+10),ke=K+_*6e4,I=h.amountUGX<=2e5?"Auto-approved":m()<.88?"Approved":"Rejected",Z=h.amountUGX>1e6?24:12,Ce=h.amountUGX>1e6?"CFO":h.risk==="High"?"Finance Desk":"Manager";return{id:gd("APR"),requestedAt:K,decidedAt:ke,module:h.module,marketplace:h.marketplace,requesterId:h.requesterId,requesterName:h.requesterName,approver:Ce,outcome:I,amountUGX:h.amountUGX,reason:h.risk==="High"?"High risk marketplace":"Above threshold",slaHours:Z}};for(let h=0;h<90;h++){const K=S-h*f,ke=1+Math.floor(m()*3)+Math.floor(m()*3);for(let Ce=0;Ce<ke;Ce++){const He=M([{item:t[0],w:1},{item:t[1],w:1},{item:t[2],w:.8},{item:t[4],w:.4}]),mt=Math.floor(m()*24),ot=K-Math.floor(m()*4*60*60*1e3)+mt*60*60*1e3,Nt=Math.round(45e3+m()*18e4),nt={id:gd("TX"),ts:ot,type:"Ride",module:ee("Ride"),vendor:ae("Ride"),requesterId:He.id,requesterName:He.name,group:He.group,costCenter:He.costCenter,amountUGX:Nt,currency:"UGX",risk:ve("Ride",void 0,Nt),approved:!0,tags:O("Ride")};if(Nt>2e5||m()<.08){const Es=X(nt);p.push(Es),nt.approvalId=Es.id,nt.approved=Es.outcome!=="Rejected"}U.push(nt)}const I=Math.floor(m()*2);for(let Ce=0;Ce<I;Ce++){const He=M([{item:t[0],w:.8},{item:t[2],w:1},{item:t[1],w:.6}]),mt=M([{item:8,w:1.1},{item:18,w:1},{item:Math.floor(m()*24),w:.7}]),ot=K+mt*60*60*1e3+Math.floor(m()*40)*6e4,Nt=12+m()*55,nt=Rh(mt)?1350:1050,Vs=Math.round(Nt*nt),Es={id:gd("TX"),ts:ot,type:"Charging",module:ee("Charging"),vendor:ae("Charging"),requesterId:He.id,requesterName:He.name,group:He.group,costCenter:He.costCenter,amountUGX:Vs,currency:"UGX",risk:ve("Charging",void 0,Vs),approved:!0,tags:O("Charging")};if(Vs>2e5||Rh(mt)||m()<.05){const Ot=X(Es);p.push(Ot),Es.approvalId=Ot.id,Es.approved=Ot.outcome!=="Rejected"}U.push(Es)}const Z=Math.floor(m()*3);for(let Ce=0;Ce<Z;Ce++){const He=M([{item:t[4],w:1.2},{item:t[0],w:.7},{item:t[1],w:.7}]),mt=b(),ot=Math.floor(m()*24),Nt=K+ot*60*60*1e3+Math.floor(m()*50)*6e4,nt=mt==="MyLiveDealz"?18e4+m()*32e5:7e4+m()*12e5,Vs=Math.round(nt),Es=mt==="ServiceMart"?"Service":"Purchase",ka={id:gd("TX"),ts:Nt,type:Es,module:"E-Commerce",marketplace:mt,vendor:ae(Es,mt),requesterId:He.id,requesterName:He.name,group:He.group,costCenter:He.costCenter,amountUGX:Vs,currency:"UGX",risk:ve(Es,mt,Vs),approved:!0,tags:O(Es,mt)};if(Vs>25e4||ka.risk==="High"||m()<.08){const Ca=X(ka);p.push(Ca),ka.approvalId=Ca.id,ka.approved=Ca.outcome!=="Rejected"}U.push(ka)}}const A=U.slice().sort((h,K)=>K.ts-h.ts).slice(0,900),N=p.slice().sort((h,K)=>K.requestedAt-h.requestedAt).slice(0,500);return{txs:A,approvals:N}},[t]),[o,c]=d.useState("overview"),[x,j]=d.useState("30d"),[g,y]=d.useState(new Date(Date.now()-30*24*60*60*1e3).toISOString().slice(0,10)),[$,T]=d.useState(new Date().toISOString().slice(0,10)),[C,W]=d.useState("All"),[L,R]=d.useState("All"),[F,te]=d.useState("All"),[oe,G]=d.useState("All"),[H,Y]=d.useState("All"),[we,q]=d.useState("All"),[je,_e]=d.useState("All"),[Ee,be]=d.useState(""),Fe=["Group","Cost center","Module","Marketplace","Vendor","Requester","Risk"],[Pe,pe]=d.useState("Module"),[Q,Re]=d.useState("None"),[ce,xe]=d.useState("Spend"),[he,de]=d.useState(()=>[{id:"RPT-001",name:"Spend by module (30d)",timeRange:"30d",dimensionA:"Module",metric:"Spend",filters:{module:"All",marketplace:"All",group:"All",costCenter:"All",vendor:"All",requester:"All",risk:"All"},createdAt:Date.now()-2*24*60*60*1e3},{id:"RPT-002",name:"Spend by vendor (90d)",timeRange:"90d",dimensionA:"Vendor",metric:"Spend",filters:{module:"All",marketplace:"All",group:"All",costCenter:"All",vendor:"All",requester:"All",risk:"All"},createdAt:Date.now()-5*24*60*60*1e3}]),[ye,Ke]=d.useState(()=>[{id:"SCH-001",reportId:"RPT-001",enabled:!0,frequency:"Weekly",hourLocal:9,dayOfWeek:"Mon",recipients:"finance@acme.com, ap@acme.com",channels:{email:!0,whatsapp:!1,wechat:!1,sms:!1},formats:{csv:!0,pdf:!0,json:!1},lastRunAt:Date.now()-2*24*60*60*1e3,lastStatus:"Success"}]),[Le,Ne]=d.useState(!1),[ge,$e]=d.useState(()=>({id:"",name:"",timeRange:"30d",customFrom:new Date(Date.now()-30*24*60*60*1e3).toISOString().slice(0,10),customTo:new Date().toISOString().slice(0,10),dimensionA:"Module",dimensionB:void 0,metric:"Spend",filters:{module:"All",marketplace:"All",group:"All",costCenter:"All",vendor:"All",requester:"All",risk:"All"},createdAt:Date.now()})),[ie,Oe]=d.useState(!1),[Se,Te]=d.useState(()=>({id:"",reportId:"RPT-001",enabled:!0,frequency:"Weekly",hourLocal:9,dayOfWeek:"Mon",dayOfMonth:1,recipients:"finance@acme.com",channels:{email:!0,whatsapp:!0,wechat:!1,sms:!1},formats:{csv:!0,pdf:!0,json:!1}})),Ge=d.useMemo(()=>mC(x,g,$),[x,g,$]),We=i.txs,ze=i.approvals,Ue=d.useMemo(()=>{const m=Ee.trim().toLowerCase();return We.filter(S=>S.ts>=Ge.start&&S.ts<=Ge.end).filter(S=>C==="All"?!0:S.module===C).filter(S=>L==="All"?!0:(S.marketplace||"-")===L).filter(S=>F==="All"?!0:S.group===F).filter(S=>oe==="All"?!0:S.costCenter===oe).filter(S=>H==="All"?!0:S.vendor===H).filter(S=>we==="All"?!0:S.requesterName===we).filter(S=>je==="All"?!0:S.risk===je).filter(S=>m?`${S.id} ${S.type} ${S.module} ${S.marketplace||""} ${S.vendor} ${S.requesterName} ${S.group} ${S.costCenter} ${S.risk} ${S.tags.join(" ")}`.toLowerCase().includes(m):!0).slice().sort((S,f)=>f.ts-S.ts)},[We,Ge.start,Ge.end,C,L,F,oe,H,we,je,Ee]),le=d.useMemo(()=>ze.filter(m=>m.requestedAt>=Ge.start&&m.requestedAt<=Ge.end).filter(m=>C==="All"?!0:m.module===C).filter(m=>L==="All"?!0:(m.marketplace||"-")===L).filter(m=>we==="All"?!0:m.requesterName===we).slice().sort((m,S)=>S.requestedAt-m.requestedAt),[ze,Ge.start,Ge.end,C,L,we]);d.useMemo(()=>Ue.reduce((m,S)=>m+(S.approved?S.amountUGX:0),0),[Ue]);const z=Ue.length,Ae=d.useMemo(()=>Ue.filter(m=>m.approved).reduce((m,S)=>m+S.amountUGX,0),[Ue]),Ve=d.useMemo(()=>Ue.filter(m=>!m.approved).reduce((m,S)=>m+S.amountUGX,0),[Ue]);d.useMemo(()=>le.filter(m=>m.outcome!=="Auto-approved"&&m.outcome!=="Approved"&&m.outcome!=="Rejected").length,[le]);const Ye=d.useMemo(()=>{const m=new Map;return Ue.forEach(S=>{const f=S.module,U=m.get(f)||{spend:0,count:0};m.set(f,{spend:U.spend+(S.approved?S.amountUGX:0),count:U.count+1})}),Array.from(m.entries()).map(([S,f])=>({key:S,...f})).sort((S,f)=>f.spend-S.spend)},[Ue]),Be=d.useMemo(()=>{const m=new Map;return Ue.forEach(S=>{S.approved&&m.set(S.vendor,(m.get(S.vendor)||0)+S.amountUGX)}),Array.from(m.entries()).map(([S,f])=>({vendor:S,spend:f})).sort((S,f)=>f.spend-S.spend).slice(0,6)},[Ue]),w=d.useMemo(()=>{const m=le.map(b=>Math.max(1,Math.round((b.decidedAt-b.requestedAt)/6e4))),S=m.length?Math.round(m.reduce((b,ae)=>b+ae,0)/m.length):0,f=Math.round(nB(m)),U=le.filter(b=>(b.decidedAt-b.requestedAt)/36e5>b.slaHours).length,p=le.filter(b=>b.outcome==="Auto-approved").length,M=le.filter(b=>b.outcome==="Approved").length,ee=le.filter(b=>b.outcome==="Rejected").length;return{avgMins:S,medMins:f,breaches:U,auto:p,approved:M,rejected:ee,total:le.length}},[le]),B=d.useMemo(()=>{const m=new Map;return le.forEach(S=>{const f=S.module,U=m.get(f)||{total:0,avgMins:0,ok:0,rejected:0,breach:0},p=Math.max(1,Math.round((S.decidedAt-S.requestedAt)/6e4)),M=U.total+1,ee=Math.round((U.avgMins*U.total+p)/M),b=(S.decidedAt-S.requestedAt)/36e5>S.slaHours?1:0;m.set(f,{total:M,avgMins:ee,ok:U.ok+(S.outcome==="Approved"||S.outcome==="Auto-approved"?1:0),rejected:U.rejected+(S.outcome==="Rejected"?1:0),breach:U.breach+b})}),Array.from(m.entries()).map(([S,f])=>({module:S,...f,approvalRate:f.total?Math.round(f.ok/f.total*100):100})).sort((S,f)=>f.total-S.total)},[le]),ue=d.useMemo(()=>{const m=Pe,S=Q==="None"?null:Q,f=new Map;Ue.forEach(M=>{const ee=io(M,m),b=f.get(ee)||{spend:0,count:0};f.set(ee,{spend:b.spend+(M.approved?M.amountUGX:0),count:b.count+1})});const U=Array.from(f.entries()).map(([M,ee])=>({key:M,...ee,avg:ee.count?Math.round(ee.spend/ee.count):0})).sort((M,ee)=>ce==="Transactions"?ee.count-M.count:ce==="Avg transaction"?ee.avg-M.avg:ee.spend-M.spend);let p=null;if(S){const M=new Map;Ue.forEach(X=>{if(!X.approved)return;const A=io(X,S);M.set(A,(M.get(A)||0)+X.amountUGX)});const ee=Array.from(M.entries()).sort((X,A)=>A[1]-X[1]).slice(0,6).map(([X])=>X),b=new Map,ae=new Map;Ue.forEach(X=>{if(!X.approved)return;const A=io(X,m),N=io(X,S),h=ee.includes(N)?N:"Other",K=b.get(A)||{};K[h]=(K[h]||0)+X.amountUGX,b.set(A,K),ae.set(A,(ae.get(A)||0)+X.amountUGX)});const ve=[...ee,"Other"].filter((X,A,N)=>X!=="Other"?!0:Array.from(b.values()).some(K=>(K.Other||0)>0)),O=Array.from(b.entries()).map(([X,A])=>({rowKey:X,cells:A,total:ae.get(X)||0})).sort((X,A)=>A.total-X.total).slice(0,12);p={columns:ve,rows:O}}return{rowsA:U,pivot:p}},[Ue,Pe,Q,ce]),ne=d.useMemo(()=>{const S=Ge.end,f={start:S-7*864e5,end:S},U={start:S-14*864e5,end:S-7*864e5},p=(N,h)=>N.ts>=h.start&&N.ts<h.end&&N.approved,M=N=>{const h=new Map;return We.forEach(K=>{p(K,N)&&h.set(K.vendor,(h.get(K.vendor)||0)+K.amountUGX)}),h},ee=M(f),b=M(U),ae=Array.from(ee.entries()).map(([N,h])=>({kind:"Unusual vendor spend",vendor:N,last7:h,prev7:b.get(N)||0})).filter(N=>N.last7>=7e5&&N.prev7>0&&N.last7>N.prev7*2).sort((N,h)=>h.last7-N.last7).slice(0,6),ve=We.filter(N=>N.approved).filter(N=>{const h=new Date(N.ts).getHours();return h<6||h>22}).filter(N=>N.ts>=Ge.start&&N.ts<=Ge.end).slice(0,10),O=(()=>{const N=Ue.filter(_=>_.approved).reduce((_,ke)=>_+ke.amountUGX,0),h=Ue.filter(_=>_.approved&&_.risk==="High").reduce((_,ke)=>_+ke.amountUGX,0),K=N?Math.round(h/N*100):0;return{spend:N,high:h,pct:K}})(),X=(()=>{const N=Ue.filter(K=>K.approved&&K.type==="Charging"),h=N.filter(K=>{const _=new Date(K.ts).getHours();return Rh(_)});return{total:N.length,peak:h.length,pct:N.length?Math.round(h.length/N.length*100):0}})(),A=le.filter(N=>N.amountUGX<=2e5&&N.outcome==="Approved").length;return{vendorSpikes:ae,afterHours:ve,highRiskShare:O,chargingPeak:X,lowAmountApprovals:A}},[We,Ue,le,Ge.start,Ge.end]),Me=d.useMemo(()=>{const m=new Map;Ue.filter(ae=>ae.approved).forEach(ae=>{const ve=ae.module,O=m.get(ve)||{spend:0,vendors:new Map};O.spend+=ae.amountUGX,O.vendors.set(ae.vendor,(O.vendors.get(ae.vendor)||0)+ae.amountUGX),m.set(ve,O)});const S=Array.from(m.entries()).map(([ae,ve])=>{var N,h;const O=Array.from(ve.vendors.entries()).sort((K,_)=>_[1]-K[1]),X=((N=O[0])==null?void 0:N[1])||0,A=ve.spend?Math.round(X/ve.spend*100):0;return{module:ae,totalSpend:ve.spend,vendorCount:O.length,topVendor:((h=O[0])==null?void 0:h[0])||"-",topShare:A}}).filter(ae=>ae.totalSpend>=15e5&&ae.vendorCount>=3&&ae.topShare<=70).sort((ae,ve)=>ve.totalSpend-ae.totalSpend).slice(0,6),f=le.filter(ae=>ae.outcome==="Approved"&&ae.amountUGX<=2e5).length,U=le.length,p=U?Math.round(f/U*100):0,M=Ue.filter(ae=>ae.approved&&ae.type==="Charging"),ee=M.filter(ae=>Rh(new Date(ae.ts).getHours())),b=M.length?Math.round(ee.length/M.length*100):0;return{vendorConsolidation:S,policy:{smallApprovals:f,totalApprovals:U,smallPct:p},charging:{total:M.length,peak:ee.length,peakPct:b}}},[Ue,le]),De=d.useMemo(()=>Array.from(new Set(We.map(m=>m.costCenter))).sort(),[We]),fe=d.useMemo(()=>Array.from(new Set(We.map(m=>m.vendor))).sort(),[We]),me=d.useMemo(()=>Array.from(new Set(We.map(m=>m.requesterName))).sort(),[We]),Xe=()=>{const m=Ue.map(f=>({ts:Em(f.ts),id:f.id,type:f.type,module:f.module,marketplace:f.marketplace||"-",vendor:f.vendor,requester:f.requesterName,group:f.group,costCenter:f.costCenter,amountUGX:f.amountUGX,risk:f.risk,approved:f.approved?"Yes":"No",approvalId:f.approvalId||"-",tags:f.tags.join(";")})),S=cC(m,[{key:"ts",label:"Time"},{key:"id",label:"Transaction ID"},{key:"type",label:"Type"},{key:"module",label:"Module"},{key:"marketplace",label:"Marketplace"},{key:"vendor",label:"Vendor"},{key:"requester",label:"Requester"},{key:"group",label:"Group"},{key:"costCenter",label:"Cost center"},{key:"amountUGX",label:"Amount (UGX)"},{key:"risk",label:"Risk"},{key:"approved",label:"Approved"},{key:"approvalId",label:"Approval ID"},{key:"tags",label:"Tags"}]);Th("transactions.csv",S,"text/csv"),r({title:"Exported",message:"Transactions CSV downloaded.",kind:"success"})},V=()=>{const m=ue.rowsA.map(f=>({dimension:f.key,spendUGX:f.spend,transactions:f.count,avgUGX:f.avg})),S=cC(m,[{key:"dimension",label:Pe},{key:"spendUGX",label:"Spend (UGX)"},{key:"transactions",label:"Transactions"},{key:"avgUGX",label:"Avg (UGX)"}]);Th("report-aggregate.csv",S,"text/csv"),r({title:"Exported",message:"Aggregate CSV downloaded.",kind:"success"})},E=()=>{const m={filters:{timeRange:x,customFrom:g,customTo:$,moduleFilter:C,marketplaceFilter:L,groupFilter:F,costCenterFilter:oe,vendorFilter:H,requesterFilter:we,riskFilter:je,q:Ee},totals:{approvedSpend:Ae,rejectedSpend:Ve,txCount:z,approvalCount:le.length},transactions:Ue,approvals:le,generatedAt:new Date().toISOString()};Th("report.json",JSON.stringify(m,null,2),"application/json"),r({title:"Exported",message:"JSON downloaded.",kind:"success"})},u=()=>{const m=`
      <html>
        <head>
          <title>CorporatePay Report</title>
          <style>
            body{font-family: ui-sans-serif, system-ui; padding:24px;}
            .muted{color:#64748b;font-size:12px}
            h2{margin:0}
            .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:16px}
            .card{border:1px solid #e2e8f0;border-radius:16px;padding:12px}
            table{width:100%; border-collapse:collapse; margin-top:16px}
            th,td{border:1px solid #e2e8f0; padding:10px; font-size:12px}
            th{background:#f8fafc; text-align:left}
          </style>
        </head>
        <body>
          <h2>CorporatePay Reporting & Analytics</h2>
          <div class="muted">Time range: ${x}${x==="Custom"?` (${g} to ${$})`:""}  Generated: ${new Date().toLocaleString()}</div>
          <div class="grid">
            <div class="card"><div class="muted">Approved spend</div><div style="font-size:20px;font-weight:700">${qs(Ae)}</div></div>
            <div class="card"><div class="muted">Transactions</div><div style="font-size:20px;font-weight:700">${z}</div></div>
            <div class="card"><div class="muted">Approvals</div><div style="font-size:20px;font-weight:700">${le.length}</div></div>
          </div>

          <h3 style="margin-top:18px">Top vendors</h3>
          <table>
            <thead><tr><th>Vendor</th><th>Spend</th></tr></thead>
            <tbody>
              ${Be.map(f=>`<tr><td>${f.vendor}</td><td>${qs(f.spend)}</td></tr>`).join("")}
            </tbody>
          </table>

          <div class="muted" style="margin-top:18px">Tip: Use browser Print  Save as PDF.</div>
        </body>
      </html>
    `,S=window.open("","_blank");if(!S){r({title:"Popup blocked",message:"Allow popups to export PDF via Print.",kind:"warn"});return}S.document.open(),S.document.write(m),S.document.close(),S.focus(),S.print(),r({title:"Print ready",message:"Use Print to PDF to save.",kind:"info"})},P=d.useMemo(()=>{const m=mC(ge.timeRange,ge.customFrom,ge.customTo),S=ge.filters,f=We.filter(ve=>ve.ts>=m.start&&ve.ts<=m.end).filter(ve=>S.module&&S.module!=="All"?ve.module===S.module:!0).filter(ve=>S.marketplace&&S.marketplace!=="All"?(ve.marketplace||"-")===S.marketplace:!0).filter(ve=>S.group&&S.group!=="All"?ve.group===S.group:!0).filter(ve=>S.costCenter&&S.costCenter!=="All"?ve.costCenter===S.costCenter:!0).filter(ve=>S.vendor&&S.vendor!=="All"?ve.vendor===S.vendor:!0).filter(ve=>S.requester&&S.requester!=="All"?ve.requesterName===S.requester:!0).filter(ve=>S.risk&&S.risk!=="All"?ve.risk===S.risk:!0).filter(ve=>ve.approved),U=ge.dimensionA,p=ge.dimensionB,M=new Map;f.forEach(ve=>{const O=io(ve,U),X=M.get(O)||{spend:0,count:0};M.set(O,{spend:X.spend+ve.amountUGX,count:X.count+1})});const ee=Array.from(M.entries()).map(([ve,O])=>({key:ve,spend:O.spend,count:O.count,avg:O.count?Math.round(O.spend/O.count):0})).sort((ve,O)=>O.spend-ve.spend).slice(0,12);let b=null;if(p){const ve=new Map;f.forEach(K=>{const _=io(K,p);ve.set(_,(ve.get(_)||0)+K.amountUGX)});const O=Array.from(ve.entries()).sort((K,_)=>_[1]-K[1]).slice(0,5).map(([K])=>K),X=new Map,A=new Map;f.forEach(K=>{const _=io(K,U),ke=io(K,p),I=O.includes(ke)?ke:"Other",Z=X.get(_)||{};Z[I]=(Z[I]||0)+K.amountUGX,X.set(_,Z),A.set(_,(A.get(_)||0)+K.amountUGX)});const N=[...O,"Other"].filter(K=>K!=="Other"?!0:Array.from(X.values()).some(_=>(_.Other||0)>0)),h=Array.from(X.entries()).map(([K,_])=>({rowKey:K,cells:_,total:A.get(K)||0})).sort((K,_)=>_.total-K.total).slice(0,10);b={columns:N,rows:h}}const ae={spend:f.reduce((ve,O)=>ve+O.amountUGX,0),count:f.length};return{rows:ee,pivot:b,totalsAll:ae}},[ge,We]),se=()=>{if(ge.name.trim().length<3){r({title:"Name required",message:"Enter a report name.",kind:"warn"});return}const m=!ge.id,S=ge.id||gd("RPT"),f={...ge,id:S,createdAt:m?Date.now():ge.createdAt};de(U=>{const p=U.findIndex(ee=>ee.id===S),M=U.slice();return p>=0?M[p]=f:M.unshift(f),M}),r({title:"Saved",message:"Report saved.",kind:"success"}),Ne(!1),c("schedules")},D=()=>{if(!he.find(U=>U.id===Se.reportId)){r({title:"Select report",message:"Choose a report to schedule.",kind:"warn"});return}if(Se.recipients.trim().length<3){r({title:"Recipients required",message:"Enter recipients emails or numbers.",kind:"warn"});return}const S=Se.id||gd("SCH"),f={...Se,id:S,enabled:!0};Ke(U=>{const p=U.findIndex(ee=>ee.id===S),M=U.slice();return p>=0?M[p]=f:M.unshift(f),M}),r({title:"Scheduled",message:"Report schedule saved.",kind:"success"}),Oe(!1)},re=m=>{Ke(S=>S.map(f=>f.id===m?{...f,lastRunAt:Date.now(),lastStatus:Math.random()<.92?"Success":"Failed"}:f)),r({title:"Triggered",message:"Schedule run triggered (demo).",kind:"info"})},v="PDF export uses Print to PDF.";return e.jsxs("div",{className:"min-h-screen bg-slate-50 transition-colors dark:bg-slate-950",children:[e.jsx(lB,{toasts:l,onDismiss:m=>n(S=>S.filter(f=>f.id!==m))}),e.jsx("div",{className:"px-4 py-6 md:px-6 lg:px-8",children:e.jsxs("div",{className:"bg-white transition-colors dark:bg-slate-900",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 transition-colors md:px-6 dark:border-slate-800 dark:bg-slate-900",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:Yx.green},children:e.jsx(Er,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"Reporting & Analytics"}),e.jsx("div",{className:"mt-1 text-sm text-slate-500 dark:text-slate-400",children:"Spend breakdowns, approvals, anomalies, and scheduled reports"}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(vt,{label:`Approved spend: ${qs(Ae)}`,tone:"good"}),e.jsx(vt,{label:`Rejected: ${qs(Ve)}`,tone:Ve?"warn":"good"}),e.jsx(vt,{label:`Tx: ${z}`,tone:"neutral"}),e.jsx(vt,{label:`Approvals: ${le.length}`,tone:le.length?"info":"neutral"}),e.jsx(vt,{label:v,tone:"neutral"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ms,{variant:"outline",onClick:Xe,children:[e.jsx(pt,{className:"h-4 w-4"})," Export CSV"]}),e.jsxs(ms,{variant:"outline",onClick:E,children:[e.jsx(pt,{className:"h-4 w-4"})," Export JSON"]}),e.jsxs(ms,{variant:"outline",onClick:u,title:v,children:[e.jsx(kt,{className:"h-4 w-4"})," Export PDF"]}),e.jsxs(ms,{variant:"accent",onClick:()=>{$e({id:"",name:"",timeRange:x,customFrom:g,customTo:$,dimensionA:"Module",dimensionB:void 0,metric:"Spend",filters:{module:"All",marketplace:"All",group:"All",costCenter:"All",vendor:"All",requester:"All",risk:"All"},createdAt:Date.now()}),Ne(!0)},children:[e.jsx(l4,{className:"h-4 w-4"})," Build report"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"overview",label:"Overview"},{id:"spend",label:"Spend explorer"},{id:"approvals",label:"Approvals"},{id:"anomalies",label:"Anomalies"},{id:"savings",label:"Savings"},{id:"builder",label:"Custom builder"},{id:"schedules",label:"Schedules"}].map(m=>e.jsx("button",{className:un("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",o===m.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:o===m.id?{background:Yx.green}:void 0,onClick:()=>c(m.id),children:m.label},m.id))}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 rounded-2xl border border-slate-200 bg-slate-50 p-4 transition-colors md:grid-cols-12 dark:border-slate-700 dark:bg-slate-800",children:[e.jsx("div",{className:"md:col-span-3",children:e.jsx(Zs,{label:"Time range",value:x,onChange:m=>j(m),options:[{value:"7d",label:"Last 7 days"},{value:"30d",label:"Last 30 days"},{value:"90d",label:"Last 90 days"},{value:"YTD",label:"Year to date"},{value:"Custom",label:"Custom"}]})}),e.jsx("div",{className:un("md:col-span-2",x!=="Custom"&&"opacity-60"),children:e.jsx(Oc,{label:"From",type:"date",value:g,onChange:y,disabled:x!=="Custom"})}),e.jsx("div",{className:un("md:col-span-2",x!=="Custom"&&"opacity-60"),children:e.jsx(Oc,{label:"To",type:"date",value:$,onChange:T,disabled:x!=="Custom"})}),e.jsx("div",{className:"md:col-span-3",children:e.jsx(Zs,{label:"Module",value:C,onChange:m=>W(m),options:[{value:"All",label:"All"},...s.map(m=>({value:m,label:m}))]})}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400",children:"Search"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2.5 dark:border-slate-700 dark:bg-slate-800",children:[e.jsx(pa,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:Ee,onChange:m=>be(m.target.value),placeholder:"vendor, tag...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400 dark:text-white"}),Ee?e.jsx("button",{className:"rounded-xl p-1 text-slate-500 hover:bg-slate-100 dark:hover:bg-slate-700",onClick:()=>be(""),"aria-label":"Clear",children:e.jsx(Qe,{className:"h-4 w-4"})}):null]})]}),e.jsxs("div",{className:"md:col-span-12 grid grid-cols-1 gap-3 md:grid-cols-6",children:[e.jsx(Zs,{label:"Marketplace",value:L,onChange:m=>R(m),options:[{value:"All",label:"All"},...a.map(m=>({value:m,label:m}))],hint:"E-Commerce",disabled:C!=="All"&&C!=="E-Commerce"}),e.jsx(Zs,{label:"Group",value:F,onChange:m=>te(m),options:[{value:"All",label:"All"},...["Operations","Sales","Finance","Admin","Procurement"].map(m=>({value:m,label:m}))]}),e.jsx(Zs,{label:"Cost center",value:oe,onChange:G,options:[{value:"All",label:"All"},...De.map(m=>({value:m,label:m}))]}),e.jsx(Zs,{label:"Vendor",value:H,onChange:Y,options:[{value:"All",label:"All"},...fe.map(m=>({value:m,label:m}))]}),e.jsx(Zs,{label:"Requester",value:we,onChange:q,options:[{value:"All",label:"All"},...me.map(m=>({value:m,label:m}))]}),e.jsx(Zs,{label:"Risk",value:je,onChange:m=>_e(m),options:[{value:"All",label:"All"},{value:"Low",label:"Low"},{value:"Medium",label:"Medium"},{value:"High",label:"High"}]})]}),e.jsxs("div",{className:"md:col-span-12 flex flex-wrap items-center justify-between gap-2",children:[e.jsxs("div",{className:"text-xs text-slate-500",children:["Showing ",e.jsx("span",{className:"font-semibold text-slate-900",children:Ue.length})," transactions and ",e.jsx("span",{className:"font-semibold text-slate-900",children:le.length})," approvals in this time range."]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ms,{variant:"outline",onClick:()=>{R("All"),te("All"),G("All"),Y("All"),q("All"),_e("All"),be(""),r({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(vn,{className:"h-4 w-4"})," Reset"]}),e.jsxs(ms,{variant:"outline",onClick:V,children:[e.jsx(pt,{className:"h-4 w-4"})," Export aggregate"]})]})]})]})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[o==="overview"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsxs($s,{title:"KPIs",subtitle:"High-level performance and spend signals.",right:e.jsx(vt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-4",children:[e.jsx(qa,{title:"Approved spend",value:qs(Ae),sub:"Within selected range",icon:e.jsx(Er,{className:"h-5 w-5"}),tone:"good"}),e.jsx(qa,{title:"Transactions",value:`${z}`,sub:"All events",icon:e.jsx(zd,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(qa,{title:"Approvals",value:`${w.total}`,sub:`Avg ${w.avgMins}m  Median ${w.medMins}m`,icon:e.jsx(sl,{className:"h-5 w-5"}),tone:w.breaches?"warn":"good"}),e.jsx(qa,{title:"SLA breaches",value:`${w.breaches}`,sub:"Approval SLA",icon:e.jsx(Et,{className:"h-5 w-5"}),tone:w.breaches?"bad":"good"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx($s,{title:"Spend by module",subtitle:"Top modules by approved spend.",right:e.jsx(vt,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[Ye.slice(0,8).map(m=>e.jsx(bb,{label:m.key,value:m.spend,total:Ae,right:qs(m.spend)},m.key)),Ye.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-sm text-slate-600",children:"No data."})]})}),e.jsxs($s,{title:"Top vendors",subtitle:"Where most money goes.",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"space-y-2",children:[Be.map(m=>e.jsx(bb,{label:m.vendor,value:m.spend,total:Ae,right:qs(m.spend)},m.vendor)),Be.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-sm text-slate-600",children:"No vendor spend."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: vendor consolidation suggestions appear in Savings."})]})]})]}),e.jsx($s,{title:"Recent activity",subtitle:"Sample of the most recent transactions.",right:e.jsx(vt,{label:"Core",tone:"neutral"}),children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Module"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Requester"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Risk"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Approved"})]})}),e.jsxs("tbody",{children:[Ue.slice(0,10).map(m=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Em(m.ts)}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:m.module}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:m.marketplace?m.marketplace:m.type})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:m.vendor}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:m.requesterName}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:qs(m.amountUGX)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(vt,{label:m.risk,tone:m.risk==="High"?"bad":m.risk==="Medium"?"warn":"good"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(vt,{label:m.approved?"Yes":"No",tone:m.approved?"good":"warn"})})]},m.id)),Ue.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No transactions match the filters."})})]})]})})})]}),e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs($s,{title:"Quick exports",subtitle:"CSV, JSON, and Print to PDF.",right:e.jsx(vt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs(ms,{variant:"outline",onClick:Xe,children:[e.jsx(pt,{className:"h-4 w-4"})," Export transactions CSV"]}),e.jsxs(ms,{variant:"outline",onClick:V,children:[e.jsx(pt,{className:"h-4 w-4"})," Export aggregate CSV"]}),e.jsxs(ms,{variant:"outline",onClick:E,children:[e.jsx(pt,{className:"h-4 w-4"})," Export JSON"]}),e.jsxs(ms,{variant:"outline",onClick:u,title:v,children:[e.jsx(kt,{className:"h-4 w-4"})," Export PDF"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Core exports: CSV/PDF/JSON. Premium: scheduled reports in Schedules."})]}),e.jsx($s,{title:"Premium signals",subtitle:"Anomaly and savings snapshots.",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"High-risk spend"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Share of spend marked High risk."})]}),e.jsx(vt,{label:`${ne.highRiskShare.pct}%`,tone:ne.highRiskShare.pct>=20?"warn":"good"})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:[qs(ne.highRiskShare.high)," / ",qs(ne.highRiskShare.spend)]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Charging peak usage"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Peak hour charging share."})]}),e.jsx(vt,{label:`${ne.chargingPeak.pct}%`,tone:ne.chargingPeak.pct>=40?"warn":"good"})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Peak ",ne.chargingPeak.peak," / Total ",ne.chargingPeak.total]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Vendor consolidation"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Modules with fragmented vendors."})]}),e.jsx(vt,{label:`${Me.vendorConsolidation.length}`,tone:Me.vendorConsolidation.length?"info":"good"})]}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Open Savings tab for recommendations."})]})]})})]})]}):null,o==="spend"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs($s,{title:"Explorer settings",subtitle:"Choose dimensions and metric.",right:e.jsx(vt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx(Zs,{label:"Primary dimension",value:Pe,onChange:m=>pe(m),options:Fe.map(m=>({value:m,label:m}))}),e.jsx(Zs,{label:"Secondary dimension",value:Q,onChange:m=>Re(m),options:[{value:"None",label:"None"},...Fe.filter(m=>m!==Pe).map(m=>({value:m,label:m}))],hint:"Premium pivot"}),e.jsx(Zs,{label:"Metric",value:ce,onChange:m=>xe(m),options:[{value:"Spend",label:"Spend"},{value:"Transactions",label:"Transactions"},{value:"Avg transaction",label:"Avg transaction"}]}),e.jsxs(ms,{variant:"outline",onClick:V,children:[e.jsx(pt,{className:"h-4 w-4"})," Export aggregate"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: add a secondary dimension to create a pivot-style table."})]}),e.jsx($s,{title:"Top results",subtitle:"Sorted by selected metric.",right:e.jsx(vt,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[ue.rowsA.slice(0,10).map(m=>{const S=ce==="Transactions"?m.count:ce==="Avg transaction"?m.avg:m.spend,f=ce==="Transactions"?ue.rowsA.reduce((U,p)=>U+p.count,0):ce==="Avg transaction"?Math.max(...ue.rowsA.map(U=>U.avg),1):Ae;return e.jsx(bb,{label:m.key,value:S,total:f,right:ce==="Transactions"?`${S}`:qs(S)},m.key)}),ue.rowsA.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-sm text-slate-600",children:"No data."})]})})]}),e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsx($s,{title:"Pivot table",subtitle:ue.pivot?`${Pe} by ${Q}`:"Enable a secondary dimension to show pivot.",right:e.jsx(vt,{label:ue.pivot?"Premium":"Off",tone:ue.pivot?"info":"neutral"}),children:ue.pivot?e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:Pe}),ue.pivot.columns.map(m=>e.jsx("th",{className:"px-4 py-3 font-semibold",children:m},m)),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Total"})]})}),e.jsx("tbody",{children:ue.pivot.rows.map(m=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:m.rowKey}),ue.pivot.columns.map(S=>e.jsx("td",{className:"px-4 py-3 text-slate-700",children:qs(m.cells[S]||0)},`${m.rowKey}-${S}`)),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:qs(m.total)})]},m.rowKey))})]})}):e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"Select a secondary dimension to build a pivot. Example: Module by Vendor."})}),e.jsx($s,{title:"Raw transactions",subtitle:"Drilldown view.",right:e.jsx(vt,{label:"Core",tone:"neutral"}),children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Type"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Module"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Requester"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Approved"})]})}),e.jsxs("tbody",{children:[Ue.slice(0,16).map(m=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Em(m.ts)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:m.type}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[m.module,m.marketplace?`  ${m.marketplace}`:""]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:m.vendor}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:m.requesterName}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:qs(m.amountUGX)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(vt,{label:m.approved?"Yes":"No",tone:m.approved?"good":"warn"})})]},m.id)),Ue.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No transactions."})})]})]})})})]})]}):null,o==="approvals"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs($s,{title:"Approval KPIs",subtitle:"Performance reports.",right:e.jsx(vt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx(qa,{title:"Avg cycle time",value:`${w.avgMins}m`,sub:"Mean",icon:e.jsx(sl,{className:"h-5 w-5"}),tone:w.avgMins>180?"warn":"good"}),e.jsx(qa,{title:"Median",value:`${w.medMins}m`,sub:"Median",icon:e.jsx(sl,{className:"h-5 w-5"}),tone:w.medMins>180?"warn":"good"}),e.jsx(qa,{title:"SLA breaches",value:`${w.breaches}`,sub:"Over SLA",icon:e.jsx(Et,{className:"h-5 w-5"}),tone:w.breaches?"bad":"good"}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Outcomes"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(vt,{label:`Auto: ${w.auto}`,tone:"info"}),e.jsx(vt,{label:`Approved: ${w.approved}`,tone:"good"}),e.jsx(vt,{label:`Rejected: ${w.rejected}`,tone:w.rejected?"warn":"good"})]})]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Core: approval performance reports. Premium: scheduled approvals performance reports via Schedules."})]})}),e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsx($s,{title:"Approvals by module",subtitle:"Cycle time, approval rate, SLA breaches.",right:e.jsx(vt,{label:"Core",tone:"neutral"}),children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Module"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Total"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Approval rate"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Avg mins"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Rejected"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Breaches"})]})}),e.jsxs("tbody",{children:[B.map(m=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:m.module}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:m.total}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(vt,{label:`${m.approvalRate}%`,tone:m.approvalRate>=90?"good":m.approvalRate>=75?"warn":"bad"})}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[m.avgMins,"m"]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:m.rejected}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(vt,{label:`${m.breach}`,tone:m.breach?"warn":"good"})})]},m.module)),B.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No approvals."})})]})]})})}),e.jsx($s,{title:"Recent approvals",subtitle:"Audit-friendly list.",right:e.jsx(vt,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[le.slice(0,10).map(m=>{const S=Math.max(1,Math.round((m.decidedAt-m.requestedAt)/6e4)),f=(m.decidedAt-m.requestedAt)/36e5>m.slaHours;return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(vt,{label:m.outcome,tone:m.outcome==="Rejected"?"bad":m.outcome==="Auto-approved"?"info":"good"}),e.jsx(vt,{label:m.module,tone:"neutral"}),m.marketplace?e.jsx(vt,{label:m.marketplace,tone:"neutral"}):null,e.jsx(vt,{label:m.id,tone:"neutral"}),f?e.jsx(vt,{label:"SLA breach",tone:"warn"}):e.jsx(vt,{label:"SLA ok",tone:"good"})]}),e.jsxs("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:[qs(m.amountUGX),"  ",m.requesterName]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Approver: ",m.approver,"  Cycle: ",S,"m  SLA: ",m.slaHours,"h"]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Reason: ",m.reason]})]}),e.jsxs("div",{className:"text-right text-xs text-slate-500",children:["Requested ",dC(m.requestedAt)]})]})},m.id)}),le.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-sm text-slate-600",children:"No approvals in this range."})]})})]})]}):null,o==="anomalies"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs($s,{title:"Anomaly dashboards",subtitle:"Logic-based detection (initial).",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:["Anomalies are detected using safe, explainable rules. Later you can add ML/AI.",e.jsxs("ul",{className:"mt-2 space-y-1",children:[e.jsx("li",{children:"1) Vendor spike: last 7 days > 2x previous 7 days"}),e.jsx("li",{children:"2) After-hours usage outside policy window"}),e.jsx("li",{children:"3) High-risk share trends"}),e.jsx("li",{children:"4) Charging peak-hour usage"})]})]}),e.jsxs(ms,{variant:"outline",onClick:()=>r({title:"Tip",message:"Use Notifications Center for real-time alert routing.",kind:"info"}),children:[e.jsx(en,{className:"h-4 w-4"})," Alert routing tip"]})]}),e.jsx($s,{title:"Quick counters",subtitle:"What needs attention.",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx(qa,{title:"Vendor spikes",value:`${ne.vendorSpikes.length}`,sub:"Last 7d vs previous 7d",icon:e.jsx(ht,{className:"h-5 w-5"}),tone:ne.vendorSpikes.length?"warn":"good"}),e.jsx(qa,{title:"After-hours tx",value:`${ne.afterHours.length}`,sub:"In selected range",icon:e.jsx(Dn,{className:"h-5 w-5"}),tone:ne.afterHours.length?"warn":"good"}),e.jsx(qa,{title:"High-risk share",value:`${ne.highRiskShare.pct}%`,sub:"Of approved spend",icon:e.jsx(Et,{className:"h-5 w-5"}),tone:ne.highRiskShare.pct>=20?"warn":"good"}),e.jsx(qa,{title:"Charging peak",value:`${ne.chargingPeak.pct}%`,sub:"Peak-hour sessions",icon:e.jsx(sl,{className:"h-5 w-5"}),tone:ne.chargingPeak.pct>=40?"warn":"good"})]})})]}),e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsx($s,{title:"Unusual vendor spend",subtitle:"Spike detection.",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"space-y-2",children:[ne.vendorSpikes.map(m=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(vt,{label:"Vendor spike",tone:"warn"}),e.jsx(vt,{label:m.vendor,tone:"neutral"})]}),e.jsxs("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:["Last 7d: ",qs(m.last7)]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Previous 7d: ",qs(m.prev7)]}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Why: spend more than 2x week-over-week"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ms,{variant:"outline",onClick:()=>{Y(m.vendor),c("spend"),r({title:"Filtered",message:`Showing spend for ${m.vendor}.`,kind:"info"})},children:[e.jsx(et,{className:"h-4 w-4"})," Drill down"]}),e.jsxs(ms,{variant:"outline",onClick:()=>r({title:"Rule",message:"Create rule from this event (demo).",kind:"info"}),children:[e.jsx(kl,{className:"h-4 w-4"})," Create rule"]})]})]})},m.vendor)),ne.vendorSpikes.length?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No vendor spikes detected."})]})}),e.jsx($s,{title:"After-hours transactions",subtitle:"Outside policy window (6-22).",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Module"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Requester"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Action"})]})}),e.jsxs("tbody",{children:[ne.afterHours.map(m=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Em(m.ts)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:m.module}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:m.vendor}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:m.requesterName}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:qs(m.amountUGX)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(ms,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{q(m.requesterName),c("spend"),r({title:"Filtered",message:`Showing spend for ${m.requesterName}.`,kind:"info"})},children:[e.jsx(et,{className:"h-4 w-4"})," Drill down"]})})]},m.id)),ne.afterHours.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No after-hours activity detected."})})]})]})})})]})]}):null,o==="savings"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs($s,{title:"Savings dashboard",subtitle:"Premium recommendations.",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Savings opportunities are generated from transaction and approvals patterns."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3",children:[e.jsx(qa,{title:"Consolidation opportunities",value:`${Me.vendorConsolidation.length}`,sub:"Modules with fragmented vendors",icon:e.jsx(ht,{className:"h-5 w-5"}),tone:Me.vendorConsolidation.length?"info":"good"}),e.jsx(qa,{title:"Low-value approvals",value:`${Me.policy.smallApprovals}`,sub:`${Me.policy.smallPct}% of approvals`,icon:e.jsx(sl,{className:"h-5 w-5"}),tone:Me.policy.smallPct>=30?"warn":"good"}),e.jsx(qa,{title:"Charging peak share",value:`${Me.charging.peakPct}%`,sub:`${Me.charging.peak}/${Me.charging.total} charging tx`,icon:e.jsx(Dn,{className:"h-5 w-5"}),tone:Me.charging.peakPct>=40?"warn":"good"})]})]}),e.jsx($s,{title:"Suggested actions",subtitle:"Do the next best thing.",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{title:"Consolidate vendors",detail:"Reduce vendor fragmentation to improve pricing and SLA.",cta:"Open",onClick:()=>r({title:"Next",message:"Start a vendor consolidation project (demo).",kind:"info"})}),e.jsx(k,{title:"Improve policies",detail:"Reduce approvals for low amounts by updating thresholds.",cta:"Open",onClick:()=>r({title:"Next",message:"Open policy simulator (demo).",kind:"info"})}),e.jsx(k,{title:"Shift charging off-peak",detail:"Move charging sessions away from peak tariffs to reduce cost.",cta:"Open",onClick:()=>{W("EVs & Charging"),c("spend"),r({title:"Filtered",message:"Showing EV charging spend.",kind:"info"})}})]})})]}),e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsx($s,{title:"Vendor consolidation",subtitle:"Vendor consolidation, policy improvements.",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"space-y-2",children:[Me.vendorConsolidation.map(m=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(vt,{label:"Consolidation",tone:"info"}),e.jsx(vt,{label:m.module,tone:"neutral"}),e.jsx(vt,{label:`${m.vendorCount} vendors`,tone:"neutral"})]}),e.jsxs("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:["Total spend: ",qs(m.totalSpend)]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Top vendor: ",m.topVendor," (",m.topShare,"% share)"]}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Suggestion: negotiate a preferred vendor set for this module and route non-preferred purchases for approval."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ms,{variant:"outline",onClick:()=>{pe("Vendor"),W(m.module),c("spend"),r({title:"Explorer",message:"Exploring vendor mix.",kind:"info"})},children:[e.jsx(et,{className:"h-4 w-4"})," Explore"]}),e.jsxs(ms,{variant:"outline",onClick:()=>r({title:"Created",message:"Vendor consolidation task created (demo).",kind:"success"}),children:[e.jsx(ht,{className:"h-4 w-4"})," Create plan"]})]})]})},m.module)),Me.vendorConsolidation.length?null:e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"No consolidation opportunities found."})]})}),e.jsx($s,{title:"Policy improvements",subtitle:"Reduce approval friction.",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Low-value approvals"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Approvals under UGX 200,000."})]}),e.jsx(vt,{label:`${Me.policy.smallPct}%`,tone:Me.policy.smallPct>=30?"warn":"good"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx(qa,{title:"Small approvals",value:`${Me.policy.smallApprovals}`,sub:"Approved",icon:e.jsx(tt,{className:"h-5 w-5"}),tone:"info"}),e.jsx(qa,{title:"Total approvals",value:`${Me.policy.totalApprovals}`,sub:"All",icon:e.jsx(sl,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(qa,{title:"Suggestion",value:Me.policy.smallPct>=30?"Raise threshold":"OK",sub:"Policy",icon:e.jsx(ht,{className:"h-5 w-5"}),tone:Me.policy.smallPct>=30?"warn":"good"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Recommendation: If this is consistently high, raise auto-approval threshold and add guardrails (risk, vendor allowlist) to keep safety."})]})}),e.jsx($s,{title:"Charging cost optimization",subtitle:"Off-peak scheduling.",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Peak-hour charging"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Share of charging transactions during peak tariff hours."})]}),e.jsx(vt,{label:`${Me.charging.peakPct}%`,tone:Me.charging.peakPct>=40?"warn":"good"})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Peak ",Me.charging.peak," / Total ",Me.charging.total]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:"Suggestion: Move non-urgent charging to off-peak windows and batch depot top-ups."})]})})]})]}):null,o==="builder"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsxs($s,{title:"Custom report builder",subtitle:"Premium: build and save report configurations.",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs(ms,{variant:"primary",onClick:()=>{$e({id:"",name:"",timeRange:x,customFrom:g,customTo:$,dimensionA:Pe,dimensionB:Q==="None"?void 0:Q,metric:ce,filters:{module:C,marketplace:L,group:F,costCenter:oe,vendor:H,requester:we,risk:je},createdAt:Date.now()}),Ne(!0)},children:[e.jsx(l4,{className:"h-4 w-4"})," New report"]}),e.jsxs(ms,{variant:"outline",onClick:()=>{r({title:"Tip",message:"Saved reports can be scheduled for email delivery in Schedules.",kind:"info"})},children:[e.jsx(en,{className:"h-4 w-4"})," Tip"]})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[he.map(m=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:m.name}),e.jsx(vt,{label:m.timeRange,tone:"neutral"}),e.jsx(vt,{label:m.metric,tone:"info"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[m.id,"  Created ",dC(m.createdAt)]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Dim: ",m.dimensionA,m.dimensionB?` by ${m.dimensionB}`:""]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(ms,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{$e(JSON.parse(JSON.stringify(m))),Ne(!0)},children:[e.jsx(kl,{className:"h-4 w-4"})," Edit"]}),e.jsxs(ms,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Te(S=>({...S,reportId:m.id})),Oe(!0)},children:[e.jsx(Xs,{className:"h-4 w-4"})," Schedule"]})]})]})},m.id)),he.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-sm text-slate-600",children:"No saved reports."})]})]})}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs($s,{title:"Preview",subtitle:"Preview uses the draft report configuration.",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(qa,{title:"Spend",value:qs(P.totalsAll.spend),sub:"Approved",icon:e.jsx(Er,{className:"h-5 w-5"}),tone:"good"}),e.jsx(qa,{title:"Transactions",value:`${P.totalsAll.count}`,sub:"Approved",icon:e.jsx(zd,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(qa,{title:"Preview rows",value:`${P.rows.length}`,sub:"Top rows",icon:e.jsx(kt,{className:"h-5 w-5"}),tone:"info"})]}),e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:ge.dimensionA}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Spend"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Tx"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Avg"})]})}),e.jsxs("tbody",{children:[P.rows.map(m=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:m.key}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:qs(m.spend)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:m.count}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:qs(m.avg)})]},m.key)),P.rows.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No data."})})]})]})}),P.pivot?e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Pivot preview"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[ge.dimensionA," by ",ge.dimensionB]})]}),e.jsx(vt,{label:"Premium",tone:"info"})]}),e.jsx("div",{className:"mt-3 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:ge.dimensionA}),P.pivot.columns.map(m=>e.jsx("th",{className:"px-4 py-3 font-semibold",children:m},m)),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Total"})]})}),e.jsx("tbody",{children:P.pivot.rows.map(m=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:m.rowKey}),P.pivot.columns.map(S=>e.jsx("td",{className:"px-4 py-3 text-slate-700",children:qs(m.cells[S]||0)},`${m.rowKey}-${S}`)),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:qs(m.total)})]},m.rowKey))})]})})]}):null]})})]}):null,o==="schedules"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsx($s,{title:"Saved reports",subtitle:"Pick a report and schedule it.",right:e.jsxs(ms,{variant:"primary",onClick:()=>{var m;Te({id:"",reportId:((m=he[0])==null?void 0:m.id)||"RPT-001",enabled:!0,frequency:"Weekly",hourLocal:9,dayOfWeek:"Mon",dayOfMonth:1,recipients:"finance@acme.com",channels:{email:!0,whatsapp:!0,wechat:!1,sms:!1},formats:{csv:!0,pdf:!0,json:!1}}),Oe(!0)},disabled:!he.length,children:[e.jsx(Xs,{className:"h-4 w-4"})," New schedule"]}),children:e.jsxs("div",{className:"space-y-2",children:[he.map(m=>{const S=ye.filter(f=>f.reportId===m.id).length;return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:m.name}),e.jsx(vt,{label:m.metric,tone:"info"}),e.jsx(vt,{label:m.timeRange,tone:"neutral"}),e.jsx(vt,{label:`Schedules: ${S}`,tone:S?"info":"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[m.id,"  ",m.dimensionA,m.dimensionB?` by ${m.dimensionB}`:""]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(ms,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Te(f=>({...f,reportId:m.id,recipients:"finance@acme.com"})),Oe(!0)},children:[e.jsx(Xs,{className:"h-4 w-4"})," Schedule"]}),e.jsxs(ms,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{const f={report:m,exportedAt:new Date().toISOString()};Th(`report-${m.id}.json`,JSON.stringify(f,null,2),"application/json"),r({title:"Exported",message:"Report definition JSON downloaded.",kind:"success"})},children:[e.jsx(pt,{className:"h-4 w-4"})," Definition"]})]})]})},m.id)}),he.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-sm text-slate-600",children:"No saved reports."})]})})}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs($s,{title:"Scheduled reports",subtitle:"Email delivery and scheduling.",right:e.jsx(vt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"space-y-2",children:[ye.slice().sort((m,S)=>(S.lastRunAt||0)-(m.lastRunAt||0)).map(m=>{const S=he.find(p=>p.id===m.reportId),f=Object.entries(m.formats).filter(([,p])=>p).map(([p])=>p.toUpperCase()).join(", "),U=Object.entries(m.channels).filter(([,p])=>p).map(([p])=>p).join(", ");return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(vt,{label:m.enabled?"Enabled":"Disabled",tone:m.enabled?"good":"neutral"}),e.jsx(vt,{label:m.frequency,tone:"neutral"}),e.jsx(vt,{label:`${String(m.hourLocal).padStart(2,"0")}:00`,tone:"neutral"}),m.frequency==="Weekly"?e.jsx(vt,{label:m.dayOfWeek||"Mon",tone:"neutral"}):null,m.frequency==="Monthly"?e.jsx(vt,{label:`Day ${m.dayOfMonth||1}`,tone:"neutral"}):null,e.jsx(vt,{label:m.id,tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:(S==null?void 0:S.name)||m.reportId}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Recipients: ",m.recipients]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Channels: ",U||"-","  Formats: ",f||"-"]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Last run: ",m.lastRunAt?`${Em(m.lastRunAt)} (${m.lastStatus})`:"Never"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ms,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Ke(p=>p.map(M=>M.id===m.id?{...M,enabled:!M.enabled}:M)),r({title:"Updated",message:"Schedule updated.",kind:"success"})},children:[e.jsx(kl,{className:"h-4 w-4"})," Toggle"]}),e.jsxs(ms,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>re(m.id),children:[e.jsx(ht,{className:"h-4 w-4"})," Run now"]}),e.jsxs(ms,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Te(JSON.parse(JSON.stringify(m))),Oe(!0)},children:[e.jsx(et,{className:"h-4 w-4"})," Edit"]})]})]})},m.id)}),ye.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-sm text-slate-600",children:"No schedules yet."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: scheduled report emails. In production, delivery logs appear in Notifications & Activity Center."})]})})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"V Reporting & Analytics v2. Core: spend breakdowns + approvals performance + CSV/PDF/JSON export. Premium: anomalies, savings dashboard, custom report builder, scheduled report emails."})})]})}),e.jsx(uC,{open:Le,title:ge.id?"Edit report":"New report",subtitle:"Choose dimensions, metric, time range, and filters.",onClose:()=>Ne(!1),actions:[{label:"Save",onClick:se}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(ms,{variant:"outline",onClick:()=>Ne(!1),children:"Cancel"}),e.jsxs(ms,{variant:"primary",onClick:se,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Oc,{label:"Report name",value:ge.name,onChange:m=>$e(S=>({...S,name:m})),placeholder:"Example: Spend by vendor"}),e.jsx(Zs,{label:"Metric",value:ge.metric,onChange:m=>$e(S=>({...S,metric:m})),options:[{value:"Spend",label:"Spend"},{value:"Transactions",label:"Transactions"},{value:"Avg transaction",label:"Avg transaction"}]}),e.jsx(Zs,{label:"Time range",value:ge.timeRange,onChange:m=>$e(S=>({...S,timeRange:m})),options:[{value:"7d",label:"Last 7 days"},{value:"30d",label:"Last 30 days"},{value:"90d",label:"Last 90 days"},{value:"YTD",label:"Year to date"},{value:"Custom",label:"Custom"}]}),e.jsx("div",{className:un(ge.timeRange!=="Custom"&&"opacity-60"),children:e.jsx(Oc,{label:"From",type:"date",value:ge.customFrom||"",onChange:m=>$e(S=>({...S,customFrom:m})),disabled:ge.timeRange!=="Custom"})}),e.jsx("div",{className:un(ge.timeRange!=="Custom"&&"opacity-60"),children:e.jsx(Oc,{label:"To",type:"date",value:ge.customTo||"",onChange:m=>$e(S=>({...S,customTo:m})),disabled:ge.timeRange!=="Custom"})}),e.jsx(Zs,{label:"Primary dimension",value:ge.dimensionA,onChange:m=>$e(S=>({...S,dimensionA:m})),options:Fe.map(m=>({value:m,label:m}))}),e.jsx(Zs,{label:"Secondary dimension",value:ge.dimensionB||"None",onChange:m=>$e(S=>({...S,dimensionB:m==="None"?void 0:m})),options:[{value:"None",label:"None"},...Fe.filter(m=>m!==ge.dimensionA).map(m=>({value:m,label:m}))],hint:"Premium pivot"}),e.jsxs("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Filters"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(Zs,{label:"Module",value:ge.filters.module||"All",onChange:m=>$e(S=>({...S,filters:{...S.filters,module:m}})),options:[{value:"All",label:"All"},...s.map(m=>({value:m,label:m}))]}),e.jsx(Zs,{label:"Marketplace",value:ge.filters.marketplace||"All",onChange:m=>$e(S=>({...S,filters:{...S.filters,marketplace:m}})),options:[{value:"All",label:"All"},...a.map(m=>({value:m,label:m}))],disabled:ge.filters.module!=="All"&&ge.filters.module!=="E-Commerce"}),e.jsx(Zs,{label:"Group",value:ge.filters.group||"All",onChange:m=>$e(S=>({...S,filters:{...S.filters,group:m}})),options:[{value:"All",label:"All"},...["Operations","Sales","Finance","Admin","Procurement"].map(m=>({value:m,label:m}))]}),e.jsx(Zs,{label:"Risk",value:ge.filters.risk||"All",onChange:m=>$e(S=>({...S,filters:{...S.filters,risk:m}})),options:[{value:"All",label:"All"},{value:"Low",label:"Low"},{value:"Medium",label:"Medium"},{value:"High",label:"High"}]})]}),e.jsx("div",{className:"mt-3 text-xs text-slate-600",children:"More filters (vendor, requester, cost center) can be added as needed."})]})]})}),e.jsx(uC,{open:ie,title:Se.id?"Edit schedule":"New schedule",subtitle:"Send scheduled report emails (and other channels) with attachments.",onClose:()=>Oe(!1),actions:[{label:"Save schedule",onClick:D}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(ms,{variant:"outline",onClick:()=>Oe(!1),children:"Cancel"}),e.jsxs(ms,{variant:"primary",onClick:D,children:[e.jsx(Xs,{className:"h-4 w-4"})," Save schedule"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Zs,{label:"Report",value:Se.reportId,onChange:m=>Te(S=>({...S,reportId:m})),options:he.map(m=>({value:m.id,label:m.name}))}),e.jsx(Zs,{label:"Frequency",value:Se.frequency,onChange:m=>Te(S=>({...S,frequency:m})),options:[{value:"Daily",label:"Daily"},{value:"Weekly",label:"Weekly"},{value:"Monthly",label:"Monthly"}]}),e.jsx(Zs,{label:"Hour",value:`${Se.hourLocal}`,onChange:m=>Te(S=>({...S,hourLocal:oC(Number(m),0,23)})),options:Array.from({length:24},(m,S)=>({value:`${S}`,label:`${String(S).padStart(2,"0")}:00`}))}),e.jsx(Zs,{label:"Day of week",value:Se.dayOfWeek||"Mon",onChange:m=>Te(S=>({...S,dayOfWeek:m})),options:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map(m=>({value:m,label:m})),disabled:Se.frequency!=="Weekly"}),e.jsx(Zs,{label:"Day of month",value:`${Se.dayOfMonth||1}`,onChange:m=>Te(S=>({...S,dayOfMonth:oC(Number(m),1,28)})),options:Array.from({length:28},(m,S)=>({value:`${S+1}`,label:`${S+1}`})),disabled:Se.frequency!=="Monthly"}),e.jsx(Oc,{label:"Recipients",value:Se.recipients,onChange:m=>Te(S=>({...S,recipients:m})),placeholder:"emails and/or phone numbers",hint:"Comma separated"}),e.jsxs("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Channels"}),e.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2 sm:grid-cols-4",children:[{k:"email",label:"Email"},{k:"whatsapp",label:"WhatsApp"},{k:"wechat",label:"WeChat"},{k:"sms",label:"SMS"}].map(m=>e.jsxs("label",{className:"flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-700",children:[e.jsx("input",{type:"checkbox",checked:Se.channels[m.k],onChange:S=>Te(f=>({...f,channels:{...f.channels,[m.k]:S.target.checked}})),className:"h-4 w-4 rounded border-slate-300"}),m.label]},m.k))}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"Attachments"}),e.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2 sm:grid-cols-3",children:[{k:"csv",label:"CSV"},{k:"pdf",label:"PDF"},{k:"json",label:"JSON"}].map(m=>e.jsxs("label",{className:"flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-700",children:[e.jsx("input",{type:"checkbox",checked:Se.formats[m.k],onChange:S=>Te(f=>({...f,formats:{...f.formats,[m.k]:S.target.checked}})),className:"h-4 w-4 rounded border-slate-300"}),m.label]},m.k))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: scheduled report emails. Delivery logs show per channel (Email/WhatsApp/WeChat/SMS)."})]})]})})]});function k({title:m,detail:S,cta:f,onClick:U}){return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:m}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:S})]}),e.jsxs(ms,{variant:"outline",className:"px-3 py-2 text-xs",onClick:U,children:[e.jsx(et,{className:"h-4 w-4"})," ",f]})]})})}}const Eo={green:"#03CD8C",orange:"#F77F00"};function Kl(...t){return t.filter(Boolean).join(" ")}function Dh(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function fr(t,s,a){return Math.max(s,Math.min(a,t))}function xC(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function oo(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function ys(t,s=0){return Number(t||0).toLocaleString(void 0,{maximumFractionDigits:s,minimumFractionDigits:s})}function kn(t){const s=Number(t||0);return s>=1e3?`${ys(s/1e3,2)} tCO2e`:`${ys(s,0)} kgCO2e`}function iB(t){let s=t>>>0;return()=>(s=s*1664525+1013904223>>>0,s/4294967296)}function jb(t,s){const a=r=>{const i=String(r??"");return/[",\n]/.test(i)?`"${i.replace(/"/g,'""')}"`:i},l=s.map(r=>a(r.label)).join(","),n=t.map(r=>s.map(i=>a(r[i.key])).join(",")).join(`
`);return`${l}
${n}`}function Ih(t,s,a="text/plain"){const l=new Blob([s],{type:a}),n=URL.createObjectURL(l),r=document.createElement("a");r.href=n,r.download=t,r.click(),URL.revokeObjectURL(n)}function oB(t,s,a){const l=new Date,n=l.getTime(),r=new Date(l.getFullYear(),0,1).getTime(),i=24*60*60*1e3;if(t==="7d")return{start:n-7*i,end:n};if(t==="30d")return{start:n-30*i,end:n};if(t==="90d")return{start:n-90*i,end:n};if(t==="YTD")return{start:r,end:n};const o=s?new Date(s).getTime():n-30*i,c=a?new Date(a).getTime()+(24*60*60*1e3-1):n;return{start:Number.isFinite(o)?o:n-30*i,end:Number.isFinite(c)?c:n}}function Ss({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Kl("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Za({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:Eo.green}:t==="accent"?{background:Eo.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Kl(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Mm({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:Kl(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:Kl("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function yb({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:Kl(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:Kl("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function Nb({label:t,value:s,onChange:a,hint:l,disabled:n,min:r=0,max:i=999999,step:o=.01}){return e.jsxs("div",{className:Kl(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",min:r,max:i,step:o,value:Number.isFinite(s)?s:0,onChange:c=>a(Number(c.target.value||0)),disabled:n,className:Kl("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function dB({actions:t}){const[s,a]=d.useState(!1),l=qt.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:Kl("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function pC({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="980px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:12,scale:.985},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:12,scale:.985},transition:{duration:.18},className:"fixed inset-x-0 top-[7vh] z-50 mx-auto w-[min(1020px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(dB,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[72vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function cB({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(480px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Kl("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function ol({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function hC({title:t,subtitle:s}){return e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(Fd,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:s})]})}function Hn({title:t,value:s,sub:a,icon:l,tone:n="neutral"}){const r=n==="good"?"bg-emerald-50 text-emerald-700":n==="warn"?"bg-amber-50 text-amber-800":n==="bad"?"bg-rose-50 text-rose-700":n==="info"?"bg-blue-50 text-blue-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:t}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:s}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a})]}),e.jsx("div",{className:Kl("grid h-10 w-10 place-items-center rounded-2xl",r),children:l})]})})}function gi({value:t,label:s}){const a=fr(t,0,100),l=82,n=10,r=(l-n)/2,i=2*Math.PI*r,o=a/100*i;return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:s}),e.jsxs("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:[Math.round(a),"%"]})]}),e.jsxs("div",{className:"relative grid place-items-center",children:[e.jsxs("svg",{width:l,height:l,className:"-rotate-90",children:[e.jsx("circle",{cx:l/2,cy:l/2,r,stroke:"#E2E8F0",strokeWidth:n,fill:"none"}),e.jsx("circle",{cx:l/2,cy:l/2,r,stroke:Eo.green,strokeWidth:n,fill:"none",strokeDasharray:`${o} ${i}`,strokeLinecap:"round"})]}),e.jsxs("div",{className:"absolute text-sm font-semibold text-slate-900",children:[Math.round(a),"%"]})]})]})})}function uB({label:t,value:s,total:a,right:l}){const n=a>0?Math.round(s/a*100):0;return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:t}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[n,"% share"]})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:l??ys(s,0)})})]}),e.jsx("div",{className:"mt-3 h-2 w-full overflow-hidden rounded-full bg-slate-100",children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${Math.min(100,n)}%`,background:Eo.green}})})]})}function gC(t){const s=fr(t,0,100);return s>=85?{label:"A",tone:"good"}:s>=70?{label:"B",tone:"info"}:s>=55?{label:"C",tone:"warn"}:{label:"D",tone:"bad"}}function mB(){const t=["Operations","Sales","Finance","Admin","Procurement"],s=["OPS-001","SALES-TRAVEL","FIN-OPS","ADMIN-001","PROC-001"],[a,l]=d.useState([]),n=ie=>{const Oe=Dh("toast");l(Se=>[{id:Oe,...ie},...Se].slice(0,4)),window.setTimeout(()=>l(Se=>Se.filter(Te=>Te.id!==Oe)),3200)},[r,i]=d.useState(!0),[o,c]=d.useState("overview"),[x,j]=d.useState("30d"),[g,y]=d.useState(new Date(Date.now()-30*24*60*60*1e3).toISOString().slice(0,10)),[$,T]=d.useState(new Date().toISOString().slice(0,10)),[C,W]=d.useState("All"),[L,R]=d.useState("All"),[F,te]=d.useState(""),[oe,G]=d.useState({gridKgCO2ePerKWh:.45,iceKgCO2ePerKm:.2,renewableSharePct:0}),[H,Y]=d.useState(!1),we=["Internal ESG Template v1","Scorecard Template v1","Mobility Emissions Template v1","Other"],[q,je]=d.useState(!1),[_e,Ee]=d.useState("Internal ESG Template v1"),[be,Fe]=d.useState("CSV"),[Pe,pe]=d.useState("ESG Report"),Q=d.useMemo(()=>oB(x,g,$),[x,g,$]),Re=d.useMemo(()=>{const ie=iB(2026),Oe=Date.now(),Se=24*60*60*1e3,Te=["Mary N.","John S.","Irene K.","Daisy O.","Procurement Desk","Admin Desk"],Ge=[],We=[],ze=Ve=>Ve[Math.floor(ie()*Ve.length)],Ue=Ve=>{const Ye=Ve.reduce((w,B)=>w+B.w,0);let Be=ie()*Ye;for(const w of Ve)if(Be-=w.w,Be<=0)return w.item;return Ve[Ve.length-1].item},le={Operations:["OPS-001"],Sales:["SALES-TRAVEL"],Finance:["FIN-OPS"],Admin:["ADMIN-001"],Procurement:["PROC-001"]},z={Operations:.62,Sales:.44,Finance:.35,Admin:.25,Procurement:.28},Ae=["Kampala HQ","Entebbe Fast Hub","Jinja Road Hub","Other"];for(let Ve=0;Ve<90;Ve++){const Ye=Oe-Ve*Se;for(const Be of t){const w=ze(le[Be]),B=1+Math.floor(ie()*4);for(let ue=0;ue<B;ue++){const ne=Math.floor(ie()*24),Me=Ye+ne*60*60*1e3+Math.floor(ie()*50)*6e4,De=Ue([{item:"Ride",w:1},{item:"Delivery",w:.35},{item:"Commute",w:.55}]),fe=ie()<z[Be],me=Math.round((4+ie()*26)*10)/10,Xe=fe?ie()<.07?"Medium":"Low":ie()<.08?"Medium":"Low",V=De==="Ride"?Ue([{item:["Client"],w:1},{item:["Airport"],w:.4},{item:["Commute"],w:.6}]):De==="Delivery"?["Delivery"]:["Commute"];if(Ge.push({id:Dh("MOB"),ts:Me,group:Be,costCenter:w,requester:ze(Te),mobilityType:De,vehicleType:fe?"EV":"ICE",km:me,module:"Rides & Logistics",tags:V,risk:Xe}),fe&&ie()<.26){const E=Ue([{item:"Kampala HQ",w:1.2},{item:"Jinja Road Hub",w:.6},{item:"Entebbe Fast Hub",w:.45},{item:"Other",w:.2}]),u=Ue([{item:8,w:.9},{item:18,w:1},{item:Math.floor(ie()*24),w:.8}]),P=Ye+u*60*60*1e3+Math.floor(ie()*45)*6e4,se=!(u>=7&&u<=9)&&!(u>=17&&u<=20),D=Math.round((8+ie()*42)*10)/10,v=Math.round(D*(se?1050:1350)),k=ie()<.9;We.push({id:Dh("CHG"),ts:P,group:Be,costCenter:w,vehicleType:"EV",site:E,kWh:D,costUGX:v,offPeak:se,hasReceipt:k,module:"EVs & Charging",tags:["Charging",se?"Off-peak":"Peak"]})}}if(ie()<.14){const ue=ze(Ae),ne=Ue([{item:19,w:1},{item:13,w:.6},{item:Math.floor(ie()*24),w:.6}]),Me=Ye+ne*60*60*1e3+Math.floor(ie()*45)*6e4,De=!(ne>=7&&ne<=9)&&!(ne>=17&&ne<=20),fe=Math.round((10+ie()*50)*10)/10,Xe=Math.round(fe*(De?1050:1350)),V=ie()<.88;We.push({id:Dh("CHG"),ts:Me,group:Be,costCenter:w,vehicleType:"EV",site:ue,kWh:fe,costUGX:Xe,offPeak:De,hasReceipt:V,module:"EVs & Charging",tags:["Charging",De?"Off-peak":"Peak"]})}}}return{mobility:Ge,charging:We}},[]),ce=d.useMemo(()=>{if(!r)return[];const ie=F.trim().toLowerCase();return Re.mobility.filter(Oe=>Oe.ts>=Q.start&&Oe.ts<=Q.end).filter(Oe=>C==="All"?!0:Oe.group===C).filter(Oe=>L==="All"?!0:Oe.costCenter===L).filter(Oe=>ie?`${Oe.requester} ${Oe.group} ${Oe.costCenter} ${Oe.mobilityType} ${Oe.vehicleType} ${Oe.tags.join(" ")}`.toLowerCase().includes(ie):!0).slice().sort((Oe,Se)=>Se.ts-Oe.ts)},[Re.mobility,Q.start,Q.end,C,L,F,r]),xe=d.useMemo(()=>{if(!r)return[];const ie=F.trim().toLowerCase();return Re.charging.filter(Oe=>Oe.ts>=Q.start&&Oe.ts<=Q.end).filter(Oe=>C==="All"?!0:Oe.group===C).filter(Oe=>L==="All"?!0:Oe.costCenter===L).filter(Oe=>ie?`${Oe.site} ${Oe.group} ${Oe.costCenter} ${Oe.tags.join(" ")}`.toLowerCase().includes(ie):!0).slice().sort((Oe,Se)=>Se.ts-Oe.ts)},[Re.charging,Q.start,Q.end,C,L,F,r]),he=d.useMemo(()=>{const ie=ce.filter(z=>z.vehicleType==="EV").reduce((z,Ae)=>z+Ae.km,0),Oe=ce.filter(z=>z.vehicleType==="ICE").reduce((z,Ae)=>z+Ae.km,0),Se=ie+Oe,Te=xe.reduce((z,Ae)=>z+Ae.kWh,0),Ge=xe.reduce((z,Ae)=>z+Ae.costUGX,0),We=xe.length,ze=We?Math.round(xe.filter(z=>z.offPeak).length/We*100):0,Ue=We?Math.round(xe.filter(z=>z.hasReceipt).length/We*100):0,le=Se?Math.round(ie/Se*100):0;return{kmEV:ie,kmICE:Oe,kmAll:Se,evSharePct:le,kWh:Te,chargingSpend:Ge,sessions:We,offPeakPct:ze,receiptPct:Ue}},[ce,xe]),de=d.useMemo(()=>{const ie=fr(oe.renewableSharePct,0,100)/100,Oe=Math.max(0,oe.gridKgCO2ePerKWh)*(1-ie),Se=he.kWh*Oe,Te=he.kmICE*Math.max(0,oe.iceKgCO2ePerKm),Ge=he.kmEV*Math.max(0,oe.iceKgCO2ePerKm),We=Math.max(0,Ge-Se),ze=he.kmAll>0?(Te+Se)/he.kmAll:0,Ue=he.kmEV>0?Se/he.kmEV:0;return{effectiveGridFactor:Oe,evScope2Kg:Se,iceKg:Te,avoidedKg:We,intensityKgPerKm:ze,evIntensityKgPerKm:Ue,baselineIceForEVkm:Ge}},[he,oe]),ye=d.useMemo(()=>{const ie=he.evSharePct,Oe=he.offPeakPct,Se=he.receiptPct,Te=fr(oe.renewableSharePct,0,100),Ge=de.intensityKgPerKm,We=fr(100-Ge*300,0,100),ze=Math.round(ie*.28+Oe*.18+Te*.18+Se*.18+We*.18);return{adoptionScore:ie,offPeakScore:Oe,renewableScore:Te,dataQualityScore:Se,intensityScore:We,overall:ze}},[he.evSharePct,he.offPeakPct,he.receiptPct,oe.renewableSharePct,de.intensityKgPerKm]),Ke=d.useMemo(()=>{const ie=new Map;for(const Se of t)ie.set(Se,{kmEV:0,kmICE:0,kWh:0,spend:0});ce.forEach(Se=>{const Te=ie.get(Se.group)||{kmEV:0,kmICE:0,kWh:0,spend:0};Se.vehicleType==="EV"?Te.kmEV+=Se.km:Te.kmICE+=Se.km,ie.set(Se.group,Te)}),xe.forEach(Se=>{const Te=ie.get(Se.group)||{kmEV:0,kmICE:0,kWh:0,spend:0};Te.kWh+=Se.kWh,Te.spend+=Se.costUGX,ie.set(Se.group,Te)});const Oe=Array.from(ie.entries()).map(([Se,Te])=>({group:Se,...Te,kmAll:Te.kmEV+Te.kmICE}));return Oe.sort((Se,Te)=>Te.kmAll-Se.kmAll),Oe},[ce,xe]),Le=d.useMemo(()=>{const ie=new Map;return["Kampala HQ","Entebbe Fast Hub","Jinja Road Hub","Other"].forEach(Se=>ie.set(Se,{sessions:0,kWh:0,spend:0,offPeak:0})),xe.forEach(Se=>{const Te=ie.get(Se.site)||{sessions:0,kWh:0,spend:0,offPeak:0};Te.sessions+=1,Te.kWh+=Se.kWh,Te.spend+=Se.costUGX,Te.offPeak+=Se.offPeak?1:0,ie.set(Se.site,Te)}),Array.from(ie.entries()).map(([Se,Te])=>({site:Se,...Te,offPeakPct:Te.sessions?Math.round(Te.offPeak/Te.sessions*100):0})).sort((Se,Te)=>Te.kWh-Se.kWh)},[xe]),Ne=()=>{const ie={name:Pe.trim()||"ESG Report",generatedAt:new Date().toISOString(),timeRange:x,customFrom:x==="Custom"?g:void 0,customTo:x==="Custom"?$:void 0,filters:{group:C,costCenter:L,query:F||void 0},factors:oe},Oe={meta:ie,core:{evKm:he.kmEV,iceKm:he.kmICE,totalKm:he.kmAll,evSharePct:he.evSharePct,chargingKWh:he.kWh,chargingSpendUGX:he.chargingSpend,chargingSessions:he.sessions,chargingOffPeakPct:he.offPeakPct,receiptCoveragePct:he.receiptPct},emissions:{effectiveGridKgCO2ePerKWh:de.effectiveGridFactor,evScope2KgCO2e:de.evScope2Kg,iceKgCO2e:de.iceKg,avoidedKgCO2e:de.avoidedKg,intensityKgCO2ePerKm:de.intensityKgPerKm},scorecards:{overall:ye.overall,adoption:ye.adoptionScore,offPeak:ye.offPeakScore,renewable:ye.renewableScore,dataQuality:ye.dataQualityScore,intensity:ye.intensityScore}};if(be==="JSON"){const Ge={templateId:_e,...Oe,breakdowns:{byGroup:Ke,chargingBySite:Le}};Ih(`${Pe||"esg"}.json`,JSON.stringify(Ge,null,2),"application/json"),n({title:"Exported",message:"JSON downloaded.",kind:"success"}),je(!1);return}if(be==="CSV"){if(_e==="Scorecard Template v1"){const ze=[{reportName:ie.name,generatedAt:ie.generatedAt,timeRange:ie.timeRange,group:ie.filters.group,costCenter:ie.filters.costCenter,overallScore:ye.overall,adoptionScore:ye.adoptionScore,offPeakScore:ye.offPeakScore,renewableScore:ye.renewableScore,dataQualityScore:ye.dataQualityScore,intensityScore:ye.intensityScore}],Ue=jb(ze,[{key:"reportName",label:"report_name"},{key:"generatedAt",label:"generated_at"},{key:"timeRange",label:"time_range"},{key:"group",label:"group"},{key:"costCenter",label:"cost_center"},{key:"overallScore",label:"overall_score"},{key:"adoptionScore",label:"adoption_score"},{key:"offPeakScore",label:"offpeak_score"},{key:"renewableScore",label:"renewable_score"},{key:"dataQualityScore",label:"data_quality_score"},{key:"intensityScore",label:"intensity_score"}]);Ih(`${Pe||"esg"}-scorecard.csv`,Ue,"text/csv"),n({title:"Exported",message:"CSV downloaded.",kind:"success"}),je(!1);return}if(_e==="Mobility Emissions Template v1"){const ze=Ke.map(le=>{const z=le.kmAll,Ae=z?Math.round(le.kmEV/z*100):0;return{reportName:ie.name,group:le.group,evKm:Math.round(le.kmEV*10)/10,iceKm:Math.round(le.kmICE*10)/10,totalKm:Math.round(z*10)/10,evSharePct:Ae,chargingKWh:Math.round(le.kWh*10)/10,chargingSpendUGX:Math.round(le.spend),gridKgCO2ePerKWh:de.effectiveGridFactor,iceKgCO2ePerKm:oe.iceKgCO2ePerKm}}),Ue=jb(ze,[{key:"reportName",label:"report_name"},{key:"group",label:"group"},{key:"evKm",label:"ev_km"},{key:"iceKm",label:"ice_km"},{key:"totalKm",label:"total_km"},{key:"evSharePct",label:"ev_share_pct"},{key:"chargingKWh",label:"charging_kwh"},{key:"chargingSpendUGX",label:"charging_spend_ugx"},{key:"gridKgCO2ePerKWh",label:"grid_kgco2e_per_kwh"},{key:"iceKgCO2ePerKm",label:"ice_kgco2e_per_km"}]);Ih(`${Pe||"esg"}-mobility.csv`,Ue,"text/csv"),n({title:"Exported",message:"CSV downloaded.",kind:"success"}),je(!1);return}const Ge=[{reportName:ie.name,generatedAt:ie.generatedAt,timeRange:ie.timeRange,group:ie.filters.group,costCenter:ie.filters.costCenter,evKm:Math.round(he.kmEV*10)/10,iceKm:Math.round(he.kmICE*10)/10,totalKm:Math.round(he.kmAll*10)/10,evSharePct:he.evSharePct,chargingKWh:Math.round(he.kWh*10)/10,chargingSpendUGX:Math.round(he.chargingSpend),chargingSessions:he.sessions,offPeakPct:he.offPeakPct,receiptCoveragePct:he.receiptPct,evScope2KgCO2e:Math.round(de.evScope2Kg),iceKgCO2e:Math.round(de.iceKg),avoidedKgCO2e:Math.round(de.avoidedKg),overallScore:ye.overall}],We=jb(Ge,[{key:"reportName",label:"report_name"},{key:"generatedAt",label:"generated_at"},{key:"timeRange",label:"time_range"},{key:"group",label:"group"},{key:"costCenter",label:"cost_center"},{key:"evKm",label:"ev_km"},{key:"iceKm",label:"ice_km"},{key:"totalKm",label:"total_km"},{key:"evSharePct",label:"ev_share_pct"},{key:"chargingKWh",label:"charging_kwh"},{key:"chargingSpendUGX",label:"charging_spend_ugx"},{key:"chargingSessions",label:"charging_sessions"},{key:"offPeakPct",label:"charging_offpeak_pct"},{key:"receiptCoveragePct",label:"receipt_coverage_pct"},{key:"evScope2KgCO2e",label:"ev_scope2_kgco2e"},{key:"iceKgCO2e",label:"ice_kgco2e"},{key:"avoidedKgCO2e",label:"avoided_kgco2e"},{key:"overallScore",label:"sustainability_score"}]);Ih(`${Pe||"esg"}-internal.csv`,We,"text/csv"),n({title:"Exported",message:"CSV downloaded.",kind:"success"}),je(!1);return}const Se=`
      <html>
        <head>
          <title>${ie.name}</title>
          <style>
            body{font-family: ui-sans-serif, system-ui; padding:24px;}
            .muted{color:#64748b;font-size:12px}
            h2{margin:0}
            .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:16px}
            .card{border:1px solid #e2e8f0;border-radius:16px;padding:12px}
            table{width:100%; border-collapse:collapse; margin-top:16px}
            th,td{border:1px solid #e2e8f0; padding:10px; font-size:12px}
            th{background:#f8fafc; text-align:left}
          </style>
        </head>
        <body>
          <h2>${ie.name}</h2>
          <div class="muted">Generated: ${new Date().toLocaleString()}  Time range: ${x}${x==="Custom"?` (${g} to ${$})`:""}</div>
          <div class="muted">Filters: Group ${C}  Cost center ${L}</div>

          <div class="grid">
            <div class="card"><div class="muted">EV share</div><div style="font-size:20px;font-weight:700">${he.evSharePct}%</div></div>
            <div class="card"><div class="muted">Charging kWh</div><div style="font-size:20px;font-weight:700">${Math.round(he.kWh)}</div></div>
            <div class="card"><div class="muted">Avoided emissions</div><div style="font-size:20px;font-weight:700">${kn(de.avoidedKg)}</div></div>
          </div>

          <h3 style="margin-top:18px">Core metrics</h3>
          <table>
            <thead><tr><th>Metric</th><th>Value</th></tr></thead>
            <tbody>
              <tr><td>Total km</td><td>${Math.round(he.kmAll)}</td></tr>
              <tr><td>EV km</td><td>${Math.round(he.kmEV)}</td></tr>
              <tr><td>ICE km</td><td>${Math.round(he.kmICE)}</td></tr>
              <tr><td>Charging spend</td><td>${oo(he.chargingSpend)}</td></tr>
              <tr><td>EV Scope 2 emissions</td><td>${kn(de.evScope2Kg)}</td></tr>
              <tr><td>ICE emissions</td><td>${kn(de.iceKg)}</td></tr>
              <tr><td>Sustainability score</td><td>${ye.overall}</td></tr>
            </tbody>
          </table>

          <div class="muted" style="margin-top:16px">Note: emission factors are organization-configurable. This export uses your current factor settings.</div>
          <div class="muted" style="margin-top:8px">Use browser Print and select Save as PDF.</div>
        </body>
      </html>
    `,Te=window.open("","_blank");if(!Te){n({title:"Popup blocked",message:"Allow popups to export PDF via Print.",kind:"warn"});return}Te.document.open(),Te.document.write(Se),Te.document.close(),Te.focus(),Te.print(),n({title:"Print ready",message:"Use Print to PDF to save.",kind:"info"}),je(!1)},ge=async()=>{const ie={templateId:_e,fields:{ev_km:"number",ice_km:"number",charging_kwh:"number",charging_spend_ugx:"number",ev_scope2_kgco2e:"number",avoided_kgco2e:"number",sustainability_score:"0-100"},notes:"Align these keys to your internal ESG format templates."};try{await navigator.clipboard.writeText(JSON.stringify(ie,null,2)),n({title:"Copied",message:"Template example copied.",kind:"success"})}catch{n({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},$e=gC(ye.overall);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(cB,{toasts:a,onDismiss:ie=>l(Oe=>Oe.filter(Se=>Se.id!==ie))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:Eo.green},children:e.jsx(Fd,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Sustainability and ESG Reporting"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"EV usage, charging utilization and spend, emissions estimates, and ESG scorecards with export templates."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(Ss,{label:`EV share ${he.evSharePct}%`,tone:he.evSharePct>=50?"good":he.evSharePct>=30?"info":"warn"}),e.jsx(Ss,{label:`Charging ${Math.round(he.kWh)} kWh`,tone:"neutral"}),e.jsx(Ss,{label:`Charging spend ${oo(he.chargingSpend)}`,tone:"neutral"}),e.jsx(Ss,{label:`Avoided ${kn(de.avoidedKg)}`,tone:de.avoidedKg>0?"good":"neutral"}),e.jsx(Ss,{label:`Score ${ye.overall} (${$e.label})`,tone:$e.tone})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Za,{variant:"outline",onClick:()=>Y(!0),children:[e.jsx(kl,{className:"h-4 w-4"})," Factors"]}),e.jsxs(Za,{variant:"outline",onClick:()=>je(!0),children:[e.jsx(pt,{className:"h-4 w-4"})," Export"]}),e.jsxs(Za,{variant:"primary",onClick:()=>i(ie=>!ie),children:[e.jsx(ct,{className:"h-4 w-4"})," ",r?"Tracking on":"Tracking off"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"overview",label:"Overview"},{id:"ev-usage",label:"EV usage"},{id:"charging",label:"Charging"},{id:"emissions",label:"Emissions"},{id:"scorecards",label:"Scorecards"},{id:"templates",label:"Templates"}].map(ie=>e.jsx("button",{className:Kl("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",o===ie.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:o===ie.id?{background:Eo.green}:void 0,onClick:()=>c(ie.id),children:ie.label},ie.id))}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 rounded-3xl border border-slate-200 bg-white p-4 md:grid-cols-12",children:[e.jsx("div",{className:"md:col-span-3",children:e.jsx(Mm,{label:"Time range",value:x,onChange:ie=>j(ie),options:[{value:"7d",label:"Last 7 days"},{value:"30d",label:"Last 30 days"},{value:"90d",label:"Last 90 days"},{value:"YTD",label:"Year to date"},{value:"Custom",label:"Custom"}]})}),e.jsx("div",{className:Kl("md:col-span-2",x!=="Custom"&&"opacity-60"),children:e.jsx(yb,{label:"From",type:"date",value:g,onChange:y,disabled:x!=="Custom"})}),e.jsx("div",{className:Kl("md:col-span-2",x!=="Custom"&&"opacity-60"),children:e.jsx(yb,{label:"To",type:"date",value:$,onChange:T,disabled:x!=="Custom"})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Mm,{label:"Group",value:C,onChange:ie=>W(ie),options:[{value:"All",label:"All"},...t.map(ie=>({value:ie,label:ie}))]})}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2.5",children:[e.jsx(pa,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:F,onChange:ie=>te(ie.target.value),placeholder:"site, requester, tag...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"}),F?e.jsx("button",{className:"rounded-xl p-1 text-slate-500 hover:bg-slate-100",onClick:()=>te(""),"aria-label":"Clear",children:e.jsx(Qe,{className:"h-4 w-4"})}):null]})]}),e.jsxs("div",{className:"md:col-span-12 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsx(Mm,{label:"Cost center",value:L,onChange:R,options:[{value:"All",label:"All"},...s.map(ie=>({value:ie,label:ie}))]}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:"Note: emission factors are defaults for demo. Update Factors to match your internal ESG standards."})]}),e.jsxs("div",{className:"md:col-span-12 flex flex-wrap items-center justify-between gap-2",children:[e.jsxs("div",{className:"text-xs text-slate-500",children:["Showing ",e.jsx("span",{className:"font-semibold text-slate-900",children:ce.length})," mobility event(s) and ",e.jsx("span",{className:"font-semibold text-slate-900",children:xe.length})," charging session(s)."]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Za,{variant:"outline",onClick:()=>{W("All"),R("All"),te(""),n({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(vn,{className:"h-4 w-4"})," Reset"]}),e.jsxs(Za,{variant:"outline",onClick:()=>je(!0),children:[e.jsx(pt,{className:"h-4 w-4"})," Export"]})]})]})]})]}),e.jsx("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:r?o==="overview"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsxs(ol,{title:"Core ESG metrics",subtitle:"Core: EV usage metrics plus charging spend and utilization.",right:e.jsx(Ss,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-4",children:[e.jsx(Hn,{title:"EV share",value:`${he.evSharePct}%`,sub:`${ys(he.kmEV,0)} km EV`,icon:e.jsx(Fd,{className:"h-5 w-5"}),tone:he.evSharePct>=50?"good":he.evSharePct>=30?"info":"warn"}),e.jsx(Hn,{title:"Charging kWh",value:`${ys(he.kWh,0)}`,sub:`${he.sessions} sessions`,icon:e.jsx(yv,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(Hn,{title:"Charging spend",value:oo(he.chargingSpend),sub:`Off-peak ${he.offPeakPct}%`,icon:e.jsx(Hx,{className:"h-5 w-5"}),tone:he.offPeakPct>=60?"good":"warn"}),e.jsx(Hn,{title:"Avoided emissions",value:kn(de.avoidedKg),sub:`Intensity ${ys(de.intensityKgPerKm,3)} kg/km`,icon:e.jsx(ht,{className:"h-5 w-5"}),tone:de.avoidedKg>0?"good":"neutral"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(ol,{title:"Mobility breakdown by group",subtitle:"EV km and ICE km",right:e.jsx(Ss,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[Ke.map(ie=>{const Oe=ie.kmAll,Se=Oe?Math.round(ie.kmEV/Oe*100):0;return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:ie.group}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["EV share ",Se,"%"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:[ys(Oe,0)," km"]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["EV ",ys(ie.kmEV,0),"  ICE ",ys(ie.kmICE,0)]})]})]}),e.jsx("div",{className:"mt-3 h-2 w-full overflow-hidden rounded-full bg-slate-100",children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${Math.min(100,Se)}%`,background:Eo.green}})})]},ie.group)}),Ke.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-sm text-slate-600",children:"No group data."})]})}),e.jsx(ol,{title:"Charging utilization by site",subtitle:"kWh, spend, off-peak",right:e.jsx(Ss,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[Le.map(ie=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:ie.site}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Sessions ",ie.sessions,"  Off-peak ",ie.offPeakPct,"%"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:[ys(ie.kWh,0)," kWh"]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Spend ",oo(ie.spend)]})]})]}),e.jsx("div",{className:"mt-3 h-2 w-full overflow-hidden rounded-full bg-slate-100",children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${Math.min(100,ie.offPeakPct)}%`,background:Eo.green}})})]},ie.site)),Le.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-sm text-slate-600",children:"No charging data."})]})})]})]}),e.jsxs(ol,{title:"Data quality",subtitle:"Premium: receipt coverage and audit readiness.",right:e.jsx(Ss,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(gi,{value:he.receiptPct,label:"Receipt coverage"}),e.jsx(gi,{value:he.offPeakPct,label:"Off-peak share"}),e.jsx(gi,{value:ye.overall,label:"Sustainability score"})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: integrate receipt coverage into your audit controls and dispute workflows."})]})]}),e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(ol,{title:"Quick actions",subtitle:"Exports and configuration.",right:e.jsx(Ss,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs(Za,{variant:"outline",onClick:()=>je(!0),children:[e.jsx(pt,{className:"h-4 w-4"})," Export ESG"]}),e.jsxs(Za,{variant:"outline",onClick:()=>Y(!0),children:[e.jsx(kl,{className:"h-4 w-4"})," Edit factors"]}),e.jsxs(Za,{variant:"outline",onClick:ge,children:[e.jsx(ss,{className:"h-4 w-4"})," Copy template keys"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: schedule delivery using the Scheduling section in Reporting & Analytics (V)."})]}),e.jsx(ol,{title:"Core notes",subtitle:"What is included.",right:e.jsx(Ss,{label:"Core",tone:"neutral"}),children:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"1) EV usage metrics computed from mobility events"}),e.jsx("li",{children:"2) Charging spend and utilization from EVs & Charging sessions"}),e.jsx("li",{children:"3) Emissions estimates depend on configured factors"})]})})}),e.jsx(ol,{title:"Premium notes",subtitle:"Scorecards and templates.",right:e.jsx(Ss,{label:"Premium",tone:"info"}),children:e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium includes scorecards, anomaly signals, and exports aligned to internal ESG templates."})})]})]}):o==="ev-usage"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(ol,{title:"EV usage summary",subtitle:"Core: EV usage metrics.",right:e.jsx(Ss,{label:"Core",tone:"neutral"}),children:[e.jsx(Hn,{title:"Total km",value:ys(he.kmAll,0),sub:`EV ${ys(he.kmEV,0)}  ICE ${ys(he.kmICE,0)}`,icon:e.jsx(zd,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(Hn,{title:"EV share",value:`${he.evSharePct}%`,sub:"EV km over total km",icon:e.jsx(Fd,{className:"h-5 w-5"}),tone:he.evSharePct>=50?"good":he.evSharePct>=30?"info":"warn"}),e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:"Best practice: enforce purpose tags and cost centers on mobility transactions so ESG reporting is auditable."})]})}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsx(ol,{title:"Mobility events",subtitle:"Drilldown list",right:e.jsx(Ss,{label:`${ce.length}`,tone:"neutral"}),children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Cost center"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Type"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vehicle"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"km"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Requester"})]})}),e.jsxs("tbody",{children:[ce.slice(0,18).map(ie=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:xC(ie.ts)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:ie.group}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:ie.costCenter}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:ie.mobilityType}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Ss,{label:ie.vehicleType,tone:ie.vehicleType==="EV"?"good":"neutral"})}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:ys(ie.km,1)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:ie.requester})]},ie.id)),ce.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No mobility events."})})]})]})})})})]}):o==="charging"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(ol,{title:"Charging metrics",subtitle:"Core: spend and utilization.",right:e.jsx(Ss,{label:"Core",tone:"neutral"}),children:[e.jsx(Hn,{title:"Sessions",value:`${he.sessions}`,sub:`Off-peak ${he.offPeakPct}%`,icon:e.jsx(yv,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(Hn,{title:"kWh",value:ys(he.kWh,0),sub:`Avg ${he.sessions?ys(he.kWh/he.sessions,1):"0"} kWh/session`,icon:e.jsx(Hx,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(Hn,{title:"Spend",value:oo(he.chargingSpend),sub:`Receipt coverage ${he.receiptPct}%`,icon:e.jsx(kt,{className:"h-5 w-5"}),tone:he.receiptPct>=85?"good":"warn"}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Tip: Shift non-urgent charging to off-peak windows to reduce costs."})]}),e.jsx(ol,{title:"Site utilization",subtitle:"kWh by site",right:e.jsx(Ss,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[Le.map(ie=>e.jsx(uB,{label:ie.site,value:ie.kWh,total:Math.max(1,he.kWh),right:`${ys(ie.kWh,0)} kWh`},ie.site)),Le.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-sm text-slate-600",children:"No charging data."})]})})]}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsx(ol,{title:"Charging sessions",subtitle:"Drilldown list",right:e.jsx(Ss,{label:`${xe.length}`,tone:"neutral"}),children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Site"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Group"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"kWh"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Spend"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Off-peak"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Receipt"})]})}),e.jsxs("tbody",{children:[xe.slice(0,18).map(ie=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:xC(ie.ts)}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:ie.site}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:ie.group}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:ys(ie.kWh,1)}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:oo(ie.costUGX)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Ss,{label:ie.offPeak?"Yes":"No",tone:ie.offPeak?"good":"warn"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Ss,{label:ie.hasReceipt?"Yes":"No",tone:ie.hasReceipt?"good":"warn"})})]},ie.id)),xe.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10 text-center text-sm text-slate-600",children:"No sessions."})})]})]})})})})]}):o==="emissions"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(ol,{title:"Emissions",subtitle:"Premium: estimates and scorecards.",right:e.jsx(Ss,{label:"Premium",tone:"info"}),children:[e.jsx(Hn,{title:"EV Scope 2",value:kn(de.evScope2Kg),sub:`Grid factor ${ys(de.effectiveGridFactor,3)} kg/kWh`,icon:e.jsx(yv,{className:"h-5 w-5"}),tone:"info"}),e.jsx(Hn,{title:"ICE emissions",value:kn(de.iceKg),sub:`ICE factor ${ys(oe.iceKgCO2ePerKm,3)} kg/km`,icon:e.jsx(zd,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(Hn,{title:"Avoided",value:kn(de.avoidedKg),sub:"If EV km would otherwise be ICE",icon:e.jsx(ht,{className:"h-5 w-5"}),tone:de.avoidedKg>0?"good":"neutral"}),e.jsxs(Za,{variant:"outline",onClick:()=>Y(!0),children:[e.jsx(kl,{className:"h-4 w-4"})," Edit factors"]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Factors are organization-configurable. Align to your internal ESG standards."})]})}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs(ol,{title:"Emissions table",subtitle:"Key values used in exports",right:e.jsx(Ss,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Metric"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Value"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Notes"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:"EV kWh"}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[ys(he.kWh,1)," kWh"]}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:"From EVs & Charging sessions"})]}),e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:"Effective grid factor"}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[ys(de.effectiveGridFactor,3)," kgCO2e/kWh"]}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:"Grid factor adjusted for renewable share"})]}),e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:"EV Scope 2 emissions"}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:kn(de.evScope2Kg)}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:"kWh multiplied by effective grid factor"})]}),e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:"ICE emissions"}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:kn(de.iceKg)}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:"ICE km multiplied by ICE factor"})]}),e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:"Avoided emissions"}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:kn(de.avoidedKg)}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:"Baseline ICE for EV km minus EV Scope 2"})]}),e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:"Overall intensity"}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[ys(de.intensityKgPerKm,3)," kgCO2e/km"]}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:"(ICE + EV Scope 2) divided by total km"})]})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: export these values in templates aligned to your internal ESG formats."})]})})]}):o==="scorecards"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsxs(ol,{title:"Sustainability scorecards",subtitle:"Premium: scorecards and grades.",right:e.jsx(Ss,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(gi,{value:ye.overall,label:"Overall"}),e.jsx(gi,{value:ye.adoptionScore,label:"EV adoption"}),e.jsx(gi,{value:ye.offPeakScore,label:"Off-peak charging"}),e.jsx(gi,{value:ye.renewableScore,label:"Renewable share"}),e.jsx(gi,{value:ye.dataQualityScore,label:"Data quality"}),e.jsx(gi,{value:ye.intensityScore,label:"Emissions intensity"})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Overall grade: ",e.jsx("span",{className:"font-semibold",children:$e.label}),". Weights are explainable and can be customized to your ESG framework."]})]})}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs(ol,{title:"Scorecard detail",subtitle:"How the score is computed",right:e.jsx(Ss,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Dimension"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Score"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Meaning"})]})}),e.jsx("tbody",{children:[{k:"EV adoption",v:ye.adoptionScore,d:"EV km share of total mobility"},{k:"Off-peak charging",v:ye.offPeakScore,d:"Off-peak sessions share"},{k:"Renewable share",v:ye.renewableScore,d:"Renewable electricity share used to adjust Scope 2"},{k:"Data quality",v:ye.dataQualityScore,d:"Receipt coverage in charging logs"},{k:"Emissions intensity",v:ye.intensityScore,d:"Lower kgCO2e per km is better"}].map(ie=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:ie.k}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Ss,{label:`${Math.round(ie.v)}`,tone:gC(ie.v).tone})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:ie.d})]},ie.k))})]})}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Za,{variant:"outline",onClick:()=>je(!0),children:[e.jsx(pt,{className:"h-4 w-4"})," Export scorecard"]}),e.jsxs(Za,{variant:"outline",onClick:ge,children:[e.jsx(ss,{className:"h-4 w-4"})," Copy template keys"]})]})]})})]}):o==="templates"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsxs(ol,{title:"ESG template library",subtitle:"Premium: exports aligned to internal format templates.",right:e.jsx(Ss,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"space-y-2",children:we.map(ie=>e.jsx("button",{type:"button",className:Kl("w-full rounded-3xl border bg-white p-4 text-left hover:bg-slate-50",_e===ie?"border-emerald-300 ring-4 ring-emerald-100":"border-slate-200"),onClick:()=>Ee(ie),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:ie}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:ie==="Internal ESG Template v1"?"Summary for internal ESG packs":ie==="Scorecard Template v1"?"Scorecards and ratings":ie==="Mobility Emissions Template v1"?"Mobility and emissions by group":"Custom mapping slot"})]}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]})},ie))}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Za,{variant:"primary",onClick:()=>je(!0),children:[e.jsx(pt,{className:"h-4 w-4"})," Export now"]}),e.jsxs(Za,{variant:"outline",onClick:ge,children:[e.jsx(ss,{className:"h-4 w-4"})," Copy keys"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: schedule reports using Reporting & Analytics schedules, and deliver via Email, WhatsApp, WeChat, or SMS."})]})}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsx(ol,{title:"Template preview",subtitle:"Fields included",right:e.jsx(Ss,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:_e}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Preview is based on current filters and factor settings."})]}),e.jsx(Ss,{label:be,tone:"neutral"})]}),e.jsx("div",{className:"mt-4 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Field"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Value"})]})}),e.jsx("tbody",{children:[{k:"ev_km",v:ys(he.kmEV,1)},{k:"ice_km",v:ys(he.kmICE,1)},{k:"charging_kwh",v:ys(he.kWh,1)},{k:"charging_spend_ugx",v:oo(he.chargingSpend)},{k:"ev_scope2_kgco2e",v:kn(de.evScope2Kg)},{k:"avoided_kgco2e",v:kn(de.avoidedKg)},{k:"sustainability_score",v:`${ye.overall} (${$e.label})`}].map(ie=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:ie.k}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:ie.v})]},ie.k))})]})}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Za,{variant:"outline",onClick:()=>je(!0),children:[e.jsx(pt,{className:"h-4 w-4"})," Export"]}),e.jsxs(Za,{variant:"outline",onClick:ge,children:[e.jsx(ss,{className:"h-4 w-4"})," Copy keys"]})]})]})})})]}):e.jsx(hC,{title:"Select a tab",subtitle:"Use the tabs to view ESG dashboards."}):e.jsx(hC,{title:"Tracking disabled",subtitle:"Enable tracking to compute EV usage and ESG metrics."})}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"W Sustainability and ESG Reporting v2. Core: EV usage metrics and EV charging spend/utilization. Premium: emissions estimates, scorecards, and template-aligned ESG exports."})})]})}),e.jsx(pC,{open:H,title:"Emission factors",subtitle:"Set values to match your internal ESG standards. Defaults are placeholders for demo.",onClose:()=>Y(!1),actions:[{label:"Save",onClick:()=>{G(ie=>({gridKgCO2ePerKWh:fr(ie.gridKgCO2ePerKWh,0,5),iceKgCO2ePerKm:fr(ie.iceKgCO2ePerKm,0,2),renewableSharePct:fr(ie.renewableSharePct,0,100)})),n({title:"Saved",message:"Factors updated.",kind:"success"}),Y(!1)}}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Za,{variant:"outline",onClick:()=>Y(!1),children:"Close"}),e.jsxs(Za,{variant:"primary",onClick:()=>{G(ie=>({gridKgCO2ePerKWh:fr(ie.gridKgCO2ePerKWh,0,5),iceKgCO2ePerKm:fr(ie.iceKgCO2ePerKm,0,2),renewableSharePct:fr(ie.renewableSharePct,0,100)})),n({title:"Saved",message:"Factors updated.",kind:"success"}),Y(!1)},children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Nb,{label:"Grid factor",value:oe.gridKgCO2ePerKWh,onChange:ie=>G(Oe=>({...Oe,gridKgCO2ePerKWh:ie})),hint:"kgCO2e per kWh",min:0,max:5,step:.001}),e.jsx(Nb,{label:"ICE baseline factor",value:oe.iceKgCO2ePerKm,onChange:ie=>G(Oe=>({...Oe,iceKgCO2ePerKm:ie})),hint:"kgCO2e per km",min:0,max:2,step:.001}),e.jsx(Nb,{label:"Renewable share",value:oe.renewableSharePct,onChange:ie=>G(Oe=>({...Oe,renewableSharePct:ie})),hint:"Percent",min:0,max:100,step:1}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"How it works"}),e.jsx("div",{className:"mt-2 text-xs text-slate-700",children:"Effective grid factor = grid factor multiplied by (1 - renewable share). EV Scope 2 = charging kWh multiplied by effective grid factor."}),e.jsx("div",{className:"mt-3 text-xs text-slate-600",children:"Avoided emissions = baseline ICE for EV km minus EV Scope 2."})]}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Use the same factors across your organization for consistent reporting."})]})}),e.jsx(pC,{open:q,title:"Export ESG report",subtitle:"Choose a template and format. Exports use current filters and factor settings.",onClose:()=>je(!1),actions:[{label:"Export",onClick:Ne}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Za,{variant:"outline",onClick:()=>je(!1),children:"Cancel"}),e.jsxs(Za,{variant:"primary",onClick:Ne,children:[e.jsx(pt,{className:"h-4 w-4"})," Export"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(yb,{label:"Export name",value:Pe,onChange:pe,placeholder:"ESG Report",hint:"Used in file name"}),e.jsx(Mm,{label:"Format",value:be,onChange:ie=>Fe(ie),options:[{value:"CSV",label:"CSV"},{value:"JSON",label:"JSON"},{value:"PDF",label:"PDF (Print)"}]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Mm,{label:"Template",value:_e,onChange:ie=>Ee(ie),options:we.map(ie=>({value:ie,label:ie})),hint:"Aligned to internal templates"})}),e.jsxs("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Current totals: EV ",ys(he.kmEV,0)," km, ICE ",ys(he.kmICE,0)," km, Charging ",ys(he.kWh,0)," kWh, Spend ",oo(he.chargingSpend),"."]}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"PDF export uses Print to PDF. Allow popups if prompted."})]})})]})}const vg={green:"#03CD8C",orange:"#F77F00"};function Ql(...t){return t.filter(Boolean).join(" ")}function Pm(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function fC(t,s,a){return Math.max(s,Math.min(a,t))}function xB(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function _r(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function $h(t){return t?t.length<=8?"":`${t.slice(0,4)}${t.slice(-4)}`:""}function ft({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Ql("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Ht({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:vg.green}:t==="accent"?{background:vg.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Ql(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Br({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:Ql("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:Ql("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function Om({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:Ql(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:Ql("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function co({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:Ql(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:Ql("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function eM({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:Ql("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function Lh({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="980px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:12,scale:.985},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:12,scale:.985},transition:{duration:.18},className:"fixed inset-x-0 top-[7vh] z-50 mx-auto w-[min(1040px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(eM,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[72vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function pB({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,actions:i}){return d.useEffect(()=>{const o=c=>c.key==="Escape"&&n();return t&&window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,x:18},animate:{opacity:1,x:0},exit:{opacity:0,x:18},transition:{duration:.18},className:Ql("fixed z-50 overflow-hidden border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]","left-2 right-2 bottom-2 top-[10vh] rounded-[28px]","lg:left-auto lg:right-4 lg:top-4 lg:bottom-4 lg:w-[760px]"),role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-base font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i&&e.jsx(eM,{actions:i}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"h-full min-h-0 overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function hB({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(480px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Ql("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function ha({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function Tm({title:t,subtitle:s}){return e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(tu,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:s})]})}function Fh(t){return t==="Success"?"good":t==="Retrying"?"warn":"bad"}function gB(t){return t==="Active"?"good":"neutral"}function fB(t){return t==="Enabled"?"good":"neutral"}function Uh(t){const s=Math.random().toString(36).slice(2)+Math.random().toString(36).slice(2);return`${t}_${s.slice(0,24)}`}function Rm(){return`req_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function vB(){const t=[{scope:"read:transactions",label:"Read transactions",desc:"View wallet, charging, rides, and purchase ledger events"},{scope:"read:invoices",label:"Read invoices",desc:"Fetch invoices, statements, and line items"},{scope:"read:approvals",label:"Read approvals",desc:"Fetch approval requests and decision history"},{scope:"write:approvals",label:"Write approvals",desc:"Approve or reject requests via API"},{scope:"read:budgets",label:"Read budgets",desc:"Read group and user budgets, caps, and alerts"},{scope:"write:budgets",label:"Write budgets",desc:"Update budgets (recommended to restrict)"},{scope:"webhooks:read",label:"Read webhooks",desc:"List webhook endpoints and deliveries"},{scope:"webhooks:write",label:"Write webhooks",desc:"Create, update, rotate secrets, and delete endpoints"},{scope:"exports:read",label:"Read exports",desc:"List ERP export jobs and download results"},{scope:"exports:write",label:"Write exports",desc:"Create ERP export jobs"}],s=[{ev:"invoice.created",desc:"Triggered when an invoice is created"},{ev:"invoice.paid",desc:"Triggered when an invoice is marked paid"},{ev:"approval.completed",desc:"Triggered when an approval flow completes"},{ev:"limit.breached",desc:"Triggered when a hard/soft limit is breached"}],[a,l]=d.useState([]),n=u=>{const P=Pm("toast");l(se=>[{id:P,...u},...se].slice(0,4)),window.setTimeout(()=>l(se=>se.filter(D=>D.id!==P)),3200)},[r,i]=d.useState(()=>({apiBaseProd:"https://api.evzone.example/corporatepay/v1",apiBaseSandbox:"https://sandbox-api.evzone.example/corporatepay/v1",webhookSigningAlgo:"HMAC-SHA256",rateLimitRpm:300,ipAllowlist:"",requireHmac:!0,sandboxEnabled:!0,webhookInspectorEnabled:!0})),[o,c]=d.useState("overview"),[x,j]=d.useState(()=>{const u=Date.now();return[{id:"EXP-001",createdAt:u-3*24*60*60*1e3,createdBy:"Finance Desk",env:"Production",kind:"Invoices",format:"CSV",status:"Ready",rangeLabel:"Last 30 days",rows:84,sizeKB:92,notes:"Weekly AP pack"},{id:"EXP-002",createdAt:u-1*24*60*60*1e3,createdBy:"Finance Desk",env:"Production",kind:"Transactions",format:"JSON",status:"Ready",rangeLabel:"Last 7 days",rows:260,sizeKB:210,notes:"ERP sync"}]}),[g,y]=d.useState(()=>{const u=Date.now();return[{id:"KEY-001",name:"ERP sync",env:"Production",scopes:["read:transactions","read:invoices","exports:read"],status:"Active",createdAt:u-18*24*60*60*1e3,lastUsedAt:u-6*60*60*1e3,keyPrefix:"cp_live_4f8a",ipAllowlist:"10.0.0.0/24"},{id:"KEY-002",name:"Ops dashboard",env:"Sandbox",scopes:["read:transactions","read:approvals","webhooks:read"],status:"Active",createdAt:u-6*24*60*60*1e3,lastUsedAt:u-2*24*60*60*1e3,keyPrefix:"cp_test_c21b",ipAllowlist:""},{id:"KEY-003",name:"Legacy key",env:"Production",scopes:["read:transactions"],status:"Revoked",createdAt:u-120*24*60*60*1e3,lastUsedAt:u-90*24*60*60*1e3,keyPrefix:"cp_live_9a1c",ipAllowlist:""}]}),[$,T]=d.useState(()=>{const u=Date.now();return[{id:"WH-001",env:"Production",url:"https://erp.acme.com/webhooks/evzone",events:["invoice.created","invoice.paid","approval.completed"],status:"Enabled",createdAt:u-25*24*60*60*1e3,lastDeliveryAt:u-45*60*1e3,secretHint:"a9c3",hmacEnabled:!0,retryCount:5},{id:"WH-002",env:"Sandbox",url:"https://requestbin.example/sandbox",events:["limit.breached","approval.completed"],status:"Enabled",createdAt:u-3*24*60*60*1e3,lastDeliveryAt:u-10*60*1e3,secretHint:"7b1d",hmacEnabled:!0,retryCount:3}]}),[C,W]=d.useState(()=>{const u=Date.now();return[{id:"DLV-1001",env:"Production",endpointId:"WH-001",at:u-45*60*1e3,event:"invoice.created",status:"Success",httpStatus:200,attempts:1,durationMs:240,requestId:Rm(),responseSnippet:"OK",bodyPreview:{event:"invoice.created",invoiceId:"INV-0083",amountUGX:128e4,status:"sent"},headersPreview:{"x-evzone-signature":"sha256=","x-evzone-env":"production"}},{id:"DLV-1002",env:"Production",endpointId:"WH-001",at:u-41*60*1e3,event:"approval.completed",status:"Retrying",httpStatus:502,attempts:2,durationMs:900,requestId:Rm(),responseSnippet:"Bad gateway",bodyPreview:{event:"approval.completed",approvalId:"APR-221",outcome:"approved",amountUGX:45e4},headersPreview:{"x-evzone-signature":"sha256=","x-evzone-env":"production"}},{id:"DLV-2001",env:"Sandbox",endpointId:"WH-002",at:u-10*60*1e3,event:"limit.breached",status:"Success",httpStatus:200,attempts:1,durationMs:160,requestId:Rm(),responseSnippet:"OK",bodyPreview:{event:"limit.breached",scope:"group",group:"Finance",pct:102},headersPreview:{"x-evzone-signature":"sha256=","x-evzone-env":"sandbox"}}]}),L=d.useMemo(()=>g.filter(u=>u.status==="Active").length,[g]),R=d.useMemo(()=>$.filter(u=>u.status==="Enabled").length,[$]);d.useMemo(()=>x.slice().sort((u,P)=>P.createdAt-u.createdAt)[0]||null,[x]);const[F,te]=d.useState(""),[oe,G]=d.useState("All"),[H,Y]=d.useState(!1),[we,q]=d.useState(()=>{const u={};return t.forEach(P=>u[P.scope]=["read:transactions","read:invoices"].includes(P.scope)),{name:"",env:"Production",ipAllowlist:"",scopes:u}}),[je,_e]=d.useState(!1),[Ee,be]=d.useState(null),[Fe,Pe]=d.useState(!1),[pe,Q]=d.useState(()=>({env:"Production",url:"",hmac:!0,retryCount:5,events:{"invoice.created":!0,"invoice.paid":!0,"approval.completed":!0,"limit.breached":!0}})),[Re,ce]=d.useState(!1),[xe,he]=d.useState(()=>{const u=new Date().toISOString().slice(0,10);return{env:"Production",kind:"Transactions",format:"CSV",range:"30d",from:new Date(Date.now()-30*24*60*60*1e3).toISOString().slice(0,10),to:u}}),[de,ye]=d.useState(!1),[Ke,Le]=d.useState(null),Ne=d.useMemo(()=>Ke&&C.find(u=>u.id===Ke)||null,[Ke,C]),[ge,$e]=d.useState(()=>({enabled:r.sandboxEnabled,routeWebhooksToInspector:!0,testModeBanner:!0})),[ie,Oe]=d.useState(()=>({ssoGoogle:!1,ssoMicrosoft:!1,hrisImport:!1})),Se=d.useMemo(()=>{const u=F.trim().toLowerCase();return g.filter(P=>oe==="All"?!0:P.env===oe).filter(P=>u?`${P.name} ${P.id} ${P.env} ${P.status} ${P.scopes.join(" ")} ${P.ipAllowlist}`.toLowerCase().includes(u):!0).slice().sort((P,se)=>se.createdAt-P.createdAt)},[g,F,oe]),Te=d.useMemo(()=>{const u=F.trim().toLowerCase();return $.filter(P=>oe==="All"?!0:P.env===oe).filter(P=>u?`${P.url} ${P.id} ${P.env} ${P.events.join(" ")} ${P.status}`.toLowerCase().includes(u):!0).slice().sort((P,se)=>se.createdAt-P.createdAt)},[$,F,oe]),Ge=d.useMemo(()=>{const u=F.trim().toLowerCase();return C.filter(P=>oe==="All"?!0:P.env===oe).filter(P=>u?`${P.id} ${P.endpointId} ${P.event} ${P.status} ${P.httpStatus} ${P.requestId}`.toLowerCase().includes(u):!0).slice().sort((P,se)=>se.at-P.at)},[C,F,oe]),We=d.useMemo(()=>{const u=F.trim().toLowerCase();return x.filter(P=>oe==="All"?!0:P.env===oe).filter(P=>u?`${P.id} ${P.kind} ${P.format} ${P.status} ${P.rangeLabel} ${P.createdBy} ${P.notes}`.toLowerCase().includes(u):!0).slice().sort((P,se)=>se.createdAt-P.createdAt)},[x,F,oe]),ze=()=>{const u={};t.forEach(P=>u[P.scope]=["read:transactions","read:invoices","exports:read"].includes(P.scope)),q({name:"",env:"Production",ipAllowlist:r.ipAllowlist,scopes:u}),Y(!0)},Ue=()=>{if(we.name.trim().length<3){n({title:"Name required",message:"Enter a key name.",kind:"warn"});return}const u=Object.entries(we.scopes).filter(([,re])=>re).map(([re])=>re);if(!u.length){n({title:"Scopes required",message:"Select at least one scope.",kind:"warn"});return}const P=Uh(we.env==="Production"?"cp_live":"cp_test"),se=$h(P),D={id:Pm("KEY"),name:we.name.trim(),env:we.env,scopes:u,status:"Active",createdAt:Date.now(),lastUsedAt:void 0,keyPrefix:`${P.slice(0,10)}`,ipAllowlist:we.ipAllowlist.trim()};y(re=>[D,...re]),be({title:"API key created",secret:P,hint:se}),_e(!0),n({title:"Created",message:"API key created. Copy the secret now.",kind:"success"}),Y(!1)},le=u=>{y(P=>P.map(se=>se.id===u?{...se,status:"Revoked"}:se)),n({title:"Revoked",message:"API key revoked.",kind:"info"})},z=u=>{const P=g.find(re=>re.id===u);if(!P)return;const se=Uh(P.env==="Production"?"cp_live":"cp_test"),D=$h(se);y(re=>re.map(v=>v.id===u?{...v,keyPrefix:`${se.slice(0,10)}`,lastUsedAt:void 0}:v)),be({title:"API key rotated",secret:se,hint:D}),_e(!0),n({title:"Rotated",message:"Secret rotated. Copy the new secret.",kind:"success"})},Ae=()=>{Q({env:"Production",url:"",hmac:!0,retryCount:5,events:{"invoice.created":!0,"invoice.paid":!0,"approval.completed":!0,"limit.breached":!0}}),Pe(!0)},Ve=()=>{if(!pe.url.trim().startsWith("http")){n({title:"Invalid URL",message:"Enter a valid https URL.",kind:"warn"});return}const u=Object.entries(pe.events).filter(([,re])=>re).map(([re])=>re);if(!u.length){n({title:"Events required",message:"Select at least one event.",kind:"warn"});return}const P=Uh(pe.env==="Production"?"wh_live":"wh_test"),se=$h(P),D={id:Pm("WH"),env:pe.env,url:pe.url.trim(),events:u,status:"Enabled",createdAt:Date.now(),lastDeliveryAt:void 0,secretHint:se,hmacEnabled:pe.hmac,retryCount:fC(pe.retryCount,0,12)};T(re=>[D,...re]),be({title:"Webhook secret created",secret:P,hint:se}),_e(!0),n({title:"Created",message:"Webhook endpoint created.",kind:"success"}),Pe(!1)},Ye=u=>{T(P=>P.map(se=>se.id===u?{...se,status:se.status==="Enabled"?"Disabled":"Enabled"}:se))},Be=u=>{const P=$.find(re=>re.id===u);if(!P)return;const se=Uh(P.env==="Production"?"wh_live":"wh_test"),D=$h(se);T(re=>re.map(v=>v.id===u?{...v,secretHint:D}:v)),be({title:"Webhook secret rotated",secret:se,hint:D}),_e(!0),n({title:"Rotated",message:"Webhook secret rotated.",kind:"success"})},w=u=>{T(P=>P.filter(se=>se.id!==u)),W(P=>P.filter(se=>se.endpointId!==u)),n({title:"Deleted",message:"Webhook endpoint deleted.",kind:"info"})},B=(u,P)=>{const se=$.find(S=>S.id===u);if(!se)return;const D=Math.random()<.86,re=D?"Success":Math.random()<.5?"Retrying":"Failed",v=D?200:re==="Retrying"?502:400,k=re==="Retrying"?2:1,m={id:Pm("DLV"),env:se.env,endpointId:se.id,at:Date.now(),event:P,status:re,httpStatus:v,attempts:k,durationMs:Math.round(120+Math.random()*900),requestId:Rm(),responseSnippet:D?"OK":re==="Retrying"?"Bad gateway":"Bad request",bodyPreview:P==="invoice.created"?{event:P,invoiceId:"INV-NEW",amountUGX:98e4,status:"sent"}:P==="invoice.paid"?{event:P,invoiceId:"INV-NEW",paidAt:new Date().toISOString()}:P==="approval.completed"?{event:P,approvalId:"APR-NEW",outcome:"approved",amountUGX:25e4}:{event:P,scope:"group",group:"Finance",pct:101},headersPreview:{"x-evzone-env":se.env.toLowerCase(),"x-evzone-signature":r.requireHmac?"sha256=":"(disabled)","x-evzone-request-id":Rm()}};W(S=>[m,...S].slice(0,250)),T(S=>S.map(f=>f.id===se.id?{...f,lastDeliveryAt:m.at}:f)),n({title:"Test sent",message:`${P} sent to ${se.id}.`,kind:"success"})},ue=()=>{const u=new Date().toISOString().slice(0,10),P=new Date(Date.now()-30*24*60*60*1e3).toISOString().slice(0,10);he({env:"Production",kind:"Transactions",format:"CSV",range:"30d",from:P,to:u}),ce(!0)},ne=()=>{const u=Pm("EXP"),P=xe.range==="custom"?`${xe.from} to ${xe.to}`:xe.range==="7d"?"Last 7 days":xe.range==="90d"?"Last 90 days":"Last 30 days",se={id:u,createdAt:Date.now(),createdBy:"You",env:xe.env,kind:xe.kind,format:xe.format,status:"Running",rangeLabel:P,rows:0,sizeKB:0,notes:""};j(D=>[se,...D]),ce(!1),n({title:"Started",message:"Export job started.",kind:"info"}),window.setTimeout(()=>{j(D=>D.map(re=>{if(re.id!==u)return re;const v=Math.random()<.93;return{...re,status:v?"Ready":"Failed",rows:v?Math.round(80+Math.random()*600):0,sizeKB:v?Math.round(60+Math.random()*400):0,notes:v?"Ready for download":"Exporter error (demo)"}})),n({title:"Export finished",message:Me(x,u),kind:"success"})},850)};function Me(u,P){return u.find(D=>D.id===P),"Completed."}const De=u=>{const P=x.find(p=>p.id===u);if(!P||P.status!=="Ready")return;const se={meta:{exportId:P.id,env:P.env,kind:P.kind,format:P.format,range:P.rangeLabel,generatedAt:new Date().toISOString()},rows:Array.from({length:Math.min(20,Math.max(3,Math.round(3+Math.random()*8)))}).map((p,M)=>({id:`row_${M+1}`,amountUGX:Math.round(1e4+Math.random()*12e5),costCenter:"OPS-001",vendor:"EVzone",createdAt:new Date(Date.now()-M*36e5).toISOString()}))};if(P.format==="JSON"){const p=JSON.stringify(se,null,2),M=new Blob([p],{type:"application/json"}),ee=URL.createObjectURL(M),b=document.createElement("a");b.href=ee,b.download=`export-${P.id}.json`,b.click(),URL.revokeObjectURL(ee),n({title:"Downloaded",message:"JSON export downloaded.",kind:"success"});return}const D=[{key:"id",label:"id"},{key:"amountUGX",label:"amount_ugx"},{key:"costCenter",label:"cost_center"},{key:"vendor",label:"vendor"},{key:"createdAt",label:"created_at"}],re=p=>{const M=String(p??"");return/[",\n]/.test(M)?`"${M.replace(/"/g,'""')}"`:M},v=D.map(p=>re(p.label)).join(","),k=se.rows.map(p=>D.map(M=>re(p[M.key])).join(",")).join(`
`),m=`${v}
${k}`,S=new Blob([m],{type:"text/csv"}),f=URL.createObjectURL(S),U=document.createElement("a");U.href=f,U.download=`export-${P.id}.csv`,U.click(),URL.revokeObjectURL(f),n({title:"Downloaded",message:"CSV export downloaded.",kind:"success"})},fe=()=>{const u={openapi:"3.0.0",info:{title:"EVzone CorporatePay API",version:"v1"},servers:[{url:r.apiBaseProd},{url:r.apiBaseSandbox}],paths:{"/transactions":{get:{summary:"List transactions",security:[{apiKey:[]}]}},"/invoices":{get:{summary:"List invoices",security:[{apiKey:[]}]}},"/approvals":{get:{summary:"List approvals",security:[{apiKey:[]}]}},"/webhooks":{get:{summary:"List webhooks",security:[{apiKey:[]}]},post:{summary:"Create webhook"}}},components:{securitySchemes:{apiKey:{type:"apiKey",in:"header",name:"Authorization"}}}},P=JSON.stringify(u,null,2),se=new Blob([P],{type:"application/json"}),D=URL.createObjectURL(se),re=document.createElement("a");re.href=D,re.download="openapi-corporatepay.json",re.click(),URL.revokeObjectURL(D),n({title:"Downloaded",message:"OpenAPI JSON downloaded.",kind:"success"})},me=async(u,P)=>{try{await navigator.clipboard.writeText(u),n({title:"Copied",message:P,kind:"success"})}catch{n({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},Xe=d.useMemo(()=>{const u=g.filter(se=>se.env==="Production"&&se.status==="Active").length,P=g.filter(se=>se.env==="Sandbox"&&se.status==="Active").length;return{prod:u,sand:P}},[g]),V=d.useMemo(()=>{const u=$.filter(se=>se.env==="Production"&&se.status==="Enabled").length,P=$.filter(se=>se.env==="Sandbox"&&se.status==="Enabled").length;return{prod:u,sand:P}},[$]);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(hB,{toasts:a,onDismiss:u=>l(P=>P.filter(se=>se.id!==u))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:vg.green},children:e.jsx(tu,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Integrations and Developer Center"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"ERP exports, secure API keys, webhook automation, sandbox tools, and phase 2 SSO and HRIS."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(ft,{label:`API keys: ${L} active`,tone:L?"good":"neutral"}),e.jsx(ft,{label:`Webhooks: ${R} enabled`,tone:R?"good":"neutral"}),e.jsx(ft,{label:`Sandbox: ${r.sandboxEnabled?"On":"Off"}`,tone:r.sandboxEnabled?"info":"neutral"}),e.jsx(ft,{label:`HMAC: ${r.requireHmac?"Required":"Optional"}`,tone:r.requireHmac?"info":"neutral"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ht,{variant:"outline",onClick:fe,children:[e.jsx(pt,{className:"h-4 w-4"})," OpenAPI"]}),e.jsxs(Ht,{variant:"outline",onClick:ue,children:[e.jsx(pt,{className:"h-4 w-4"})," New export"]}),e.jsxs(Ht,{variant:"outline",onClick:Ae,children:[e.jsx(Co,{className:"h-4 w-4"})," New webhook"]}),e.jsxs(Ht,{variant:"primary",onClick:ze,children:[e.jsx(kd,{className:"h-4 w-4"})," New API key"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"overview",label:"Overview"},{id:"exports",label:"ERP exports"},{id:"keys",label:"API keys"},{id:"webhooks",label:"Webhooks"},{id:"sandbox",label:"Sandbox"},{id:"sso",label:"SSO and HRIS"}].map(u=>e.jsx("button",{className:Ql("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",o===u.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:o===u.id?{background:vg.green}:void 0,onClick:()=>c(u.id),children:u.label},u.id))}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 rounded-3xl border border-slate-200 bg-white p-4 md:grid-cols-12",children:[e.jsxs("div",{className:"md:col-span-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2.5",children:[e.jsx(pa,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:F,onChange:u=>te(u.target.value),placeholder:"key, webhook, export...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"}),F?e.jsx("button",{className:"rounded-xl p-1 text-slate-500 hover:bg-slate-100",onClick:()=>te(""),"aria-label":"Clear",children:e.jsx(Qe,{className:"h-4 w-4"})}):null]})]}),e.jsx("div",{className:"md:col-span-3",children:e.jsx(co,{label:"Environment",value:oe,onChange:u=>G(u),options:[{value:"All",label:"All"},{value:"Production",label:"Production"},{value:"Sandbox",label:"Sandbox"}]})}),e.jsx("div",{className:"md:col-span-5",children:e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Base URLs: ",e.jsx("span",{className:"font-semibold",children:"Prod"})," ",r.apiBaseProd,"  ",e.jsx("span",{className:"font-semibold",children:"Sandbox"})," ",r.apiBaseSandbox]})})]})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[o==="overview"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsxs(ha,{title:"Developer posture",subtitle:"Security, observability, and operational readiness.",right:e.jsx(ft,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-4",children:[e.jsx(E,{title:"Production keys",value:`${Xe.prod}`,icon:e.jsx(kd,{className:"h-5 w-5"}),tone:Xe.prod?"good":"neutral",sub:"Active"}),e.jsx(E,{title:"Sandbox keys",value:`${Xe.sand}`,icon:e.jsx(tu,{className:"h-5 w-5"}),tone:r.sandboxEnabled?"info":"neutral",sub:"Active"}),e.jsx(E,{title:"Prod webhooks",value:`${V.prod}`,icon:e.jsx(Co,{className:"h-5 w-5"}),tone:V.prod?"good":"neutral",sub:"Enabled"}),e.jsx(E,{title:"HMAC signing",value:r.requireHmac?"On":"Off",icon:e.jsx(yt,{className:"h-5 w-5"}),tone:r.requireHmac?"info":"neutral",sub:r.webhookSigningAlgo})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(ha,{title:"ERP and accounting exports",subtitle:"CSV and JSON exports for ERP systems.",right:e.jsx(ft,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[We.slice(0,4).map(u=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ft,{label:u.env,tone:u.env==="Production"?"neutral":"info"}),e.jsx(ft,{label:u.kind,tone:"neutral"}),e.jsx(ft,{label:u.format,tone:"info"}),e.jsx(ft,{label:u.status,tone:u.status==="Ready"?"good":u.status==="Failed"?"bad":"warn"})]}),e.jsxs("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:[u.id,"  ",u.rangeLabel]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",_r(u.createdAt),"  ",u.createdBy]})]}),e.jsxs(Ht,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>De(u.id),disabled:u.status!=="Ready",children:[e.jsx(pt,{className:"h-4 w-4"})," Download"]})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Rows ",u.rows,"  Size ",u.sizeKB," KB  ",u.notes||""]})]},u.id)),We.length?null:e.jsx(Tm,{title:"No exports",subtitle:"Create an export job to begin."})]})}),e.jsxs(ha,{title:"Webhook inspector",subtitle:"Premium: inspect deliveries and payloads.",right:e.jsx(ft,{label:r.webhookInspectorEnabled?"Premium":"Off",tone:r.webhookInspectorEnabled?"info":"neutral"}),children:[e.jsxs("div",{className:"space-y-2",children:[Ge.slice(0,5).map(u=>e.jsx("button",{type:"button",className:"w-full rounded-3xl border border-slate-200 bg-white p-4 text-left hover:bg-slate-50",onClick:()=>{Le(u.id),ye(!0)},disabled:!r.webhookInspectorEnabled,children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ft,{label:u.env,tone:u.env==="Production"?"neutral":"info"}),e.jsx(ft,{label:u.event,tone:"neutral"}),e.jsx(ft,{label:u.status,tone:Fh(u.status)}),e.jsx(ft,{label:`HTTP ${u.httpStatus}`,tone:u.httpStatus>=200&&u.httpStatus<300?"good":"warn"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[_r(u.at),"  Attempts ",u.attempts,"  ",u.durationMs,"ms"]})]}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]})},u.id)),Ge.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No deliveries yet."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: inspector shows request and response with retry traces. Use Sandbox to test safely."})]})]})]}),e.jsx(ha,{title:"Security controls",subtitle:"Keys, scopes, and network restrictions.",right:e.jsx(ft,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"API keys"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Rotate and revoke keys. Use least privilege scopes."})]}),e.jsx(kd,{className:"h-5 w-5 text-slate-400"})]}),e.jsx("div",{className:"mt-3 text-xs text-slate-600",children:"Best practice: create separate keys per integration (ERP, BI, approvals automation). Restrict by IP allowlist where possible."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Webhook signing"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"HMAC signature verification to prevent spoofing."})]}),e.jsx(ia,{className:"h-5 w-5 text-slate-400"})]}),e.jsxs("div",{className:"mt-3 text-xs text-slate-600",children:["Use header ",e.jsx("span",{className:"font-semibold",children:"x-evzone-signature"})," to verify payload integrity."]})]})]})})]}),e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(ha,{title:"Quick actions",subtitle:"Common tasks",right:e.jsx(ft,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs(Ht,{variant:"primary",onClick:ze,children:[e.jsx(kd,{className:"h-4 w-4"})," Create API key"]}),e.jsxs(Ht,{variant:"outline",onClick:Ae,children:[e.jsx(Co,{className:"h-4 w-4"})," Create webhook"]}),e.jsxs(Ht,{variant:"outline",onClick:ue,children:[e.jsx(pt,{className:"h-4 w-4"})," Create ERP export"]}),e.jsxs(Ht,{variant:"outline",onClick:fe,children:[e.jsx(kt,{className:"h-4 w-4"})," Download OpenAPI"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: sandbox and webhook inspector available under Sandbox tab."})]}),e.jsx(ha,{title:"Environment",subtitle:"Production vs sandbox",right:e.jsx(ft,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(Br,{enabled:r.sandboxEnabled,onChange:u=>{i(P=>({...P,sandboxEnabled:u})),n({title:"Updated",message:`Sandbox ${u?"enabled":"disabled"}.`,kind:"success"})},label:"Sandbox enabled",description:"Allows test keys and test webhook events"}),e.jsx(Br,{enabled:r.webhookInspectorEnabled,onChange:u=>{i(P=>({...P,webhookInspectorEnabled:u})),n({title:"Updated",message:`Inspector ${u?"enabled":"disabled"}.`,kind:"success"})},label:"Webhook inspector",description:"Premium debugging for payloads and retries"})]})})]})]}):null,o==="exports"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(ha,{title:"ERP exports",subtitle:"Core: CSV/JSON exports",right:e.jsx(ft,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Supported export types:",e.jsxs("ul",{className:"mt-2 space-y-1",children:[e.jsx("li",{children:" Transactions (ledger)"}),e.jsx("li",{children:" Invoices and line items"}),e.jsx("li",{children:" Approvals history"})]})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2",children:[e.jsxs(Ht,{variant:"primary",onClick:ue,children:[e.jsx(pt,{className:"h-4 w-4"})," New export"]}),e.jsxs(Ht,{variant:"outline",onClick:()=>{const u={version:1,gl_code:"string",cost_center:"string",vendor_code:"string",tax_code:"string",amount_ugx:"number",module:"string",marketplace:"string",invoice_group_code:"string"},P=new Blob([JSON.stringify(u,null,2)],{type:"application/json"}),se=URL.createObjectURL(P),D=document.createElement("a");D.href=se,D.download="erp-mapping-template.json",D.click(),URL.revokeObjectURL(se),n({title:"Downloaded",message:"ERP mapping template downloaded.",kind:"success"})},children:[e.jsx(kt,{className:"h-4 w-4"})," Mapping template"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Best practice: include AP codes and invoice group codes for clean ERP routing."})]})}),e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsx(ha,{title:"Export jobs",subtitle:"Downloadable jobs for ERP sync",right:e.jsx(ft,{label:`${We.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[We.map(u=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ft,{label:u.env,tone:u.env==="Production"?"neutral":"info"}),e.jsx(ft,{label:u.kind,tone:"neutral"}),e.jsx(ft,{label:u.format,tone:"info"}),e.jsx(ft,{label:u.status,tone:u.status==="Ready"?"good":u.status==="Failed"?"bad":"warn"})]}),e.jsxs("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:[u.id,"  ",u.rangeLabel]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",_r(u.createdAt),"  ",u.createdBy]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Rows ",u.rows,"  Size ",u.sizeKB," KB  ",u.notes||""]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ht,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>De(u.id),disabled:u.status!=="Ready",children:[e.jsx(pt,{className:"h-4 w-4"})," Download"]}),e.jsxs(Ht,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{j(P=>P.filter(se=>se.id!==u.id)),n({title:"Removed",message:"Export job removed.",kind:"info"})},children:[e.jsx(as,{className:"h-4 w-4"})," Remove"]})]})]})},u.id)),We.length?null:e.jsx(Tm,{title:"No export jobs",subtitle:"Create an export job to begin."})]})}),e.jsx(ha,{title:"Export formats",subtitle:"CSV and JSON",right:e.jsx(ft,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"CSV"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Good for spreadsheets and ERP imports"})]}),e.jsx(kt,{className:"h-5 w-5 text-slate-400"})]}),e.jsx("div",{className:"mt-3 text-xs text-slate-600",children:"Includes stable column names for mapping."})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"JSON"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Best for API based ingestion"})]}),e.jsx($i,{className:"h-5 w-5 text-slate-400"})]}),e.jsx("div",{className:"mt-3 text-xs text-slate-600",children:"Includes meta block and structured rows."})]})]})})]})]}):null,o==="keys"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(ha,{title:"API keys",subtitle:"Core: secure endpoints, keys, scopes",right:e.jsx(ft,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"How auth works"}),e.jsxs("ul",{className:"mt-2 space-y-1",children:[e.jsx("li",{children:"1) Create an API key"}),e.jsx("li",{children:"2) Assign least-privilege scopes"}),e.jsx("li",{children:"3) Use Authorization: Bearer <key>"}),e.jsx("li",{children:"4) Rotate periodically and revoke on compromise"})]})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2",children:[e.jsxs(Ht,{variant:"primary",onClick:ze,children:[e.jsx(kd,{className:"h-4 w-4"})," New API key"]}),e.jsxs(Ht,{variant:"outline",onClick:()=>me(r.apiBaseProd,"Production base URL copied"),children:[e.jsx(ss,{className:"h-4 w-4"})," Copy API base"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Security tip: restrict integrations to IP allowlist and scope only the endpoints needed."})]})}),e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsx(ha,{title:"Keys list",subtitle:"Create, rotate, revoke",right:e.jsx(ft,{label:`${Se.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[Se.map(u=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ft,{label:u.env,tone:u.env==="Production"?"neutral":"info"}),e.jsx(ft,{label:u.status,tone:gB(u.status)}),e.jsx(ft,{label:u.id,tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:u.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",_r(u.createdAt),"  Last used ",u.lastUsedAt?_r(u.lastUsedAt):"Never"]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[u.scopes.slice(0,6).map(P=>e.jsx(ft,{label:P,tone:"neutral"},`${u.id}-${P}`)),u.scopes.length>6?e.jsx(ft,{label:"+more",tone:"neutral"}):null]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Key prefix: ",u.keyPrefix,u.ipAllowlist?`  IP allowlist: ${u.ipAllowlist}`:""]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ht,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>z(u.id),disabled:u.status!=="Active",title:u.status!=="Active"?"Revoked":"Rotate secret",children:[e.jsx(Mr,{className:"h-4 w-4"})," Rotate"]}),e.jsxs(Ht,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>le(u.id),disabled:u.status!=="Active",children:[e.jsx(as,{className:"h-4 w-4"})," Revoke"]})]})]})},u.id)),Se.length?null:e.jsx(Tm,{title:"No keys",subtitle:"Create an API key to start."})]})}),e.jsx(ha,{title:"Scopes reference",subtitle:"What each scope allows",right:e.jsx(ft,{label:"Core",tone:"neutral"}),children:e.jsx("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:t.map(u=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:u.label}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:u.scope}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:u.desc})]}),e.jsx(ia,{className:"h-5 w-5 text-slate-400"})]})},u.scope))})})]})]}):null,o==="webhooks"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(ha,{title:"Webhooks",subtitle:"Core: invoice, approvals, limits",right:e.jsx(ft,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Events"}),e.jsx("ul",{className:"mt-2 space-y-1",children:s.map(u=>e.jsxs("li",{children:[" ",e.jsx("span",{className:"font-semibold",children:u.ev}),": ",u.desc]},u.ev))})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2",children:[e.jsxs(Ht,{variant:"primary",onClick:Ae,children:[e.jsx(Co,{className:"h-4 w-4"})," New webhook"]}),e.jsxs(Ht,{variant:"outline",onClick:()=>ye(!0),disabled:!r.webhookInspectorEnabled,children:[e.jsx(tu,{className:"h-4 w-4"})," Webhook inspector"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Security tip: verify HMAC signature and implement idempotency using requestId."})]}),e.jsx(ha,{title:"Webhook security",subtitle:"HMAC and retries",right:e.jsx(ft,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(Br,{enabled:r.requireHmac,onChange:u=>{i(P=>({...P,requireHmac:u})),n({title:"Updated",message:`HMAC ${u?"required":"optional"}.`,kind:"success"})},label:"Require HMAC signatures",description:"Adds x-evzone-signature and rejects unsigned payloads"}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Signing algorithm: ",e.jsx("span",{className:"font-semibold",children:r.webhookSigningAlgo}),e.jsxs("div",{className:"mt-2",children:["Header: ",e.jsx("span",{className:"font-semibold",children:"x-evzone-signature"})]}),e.jsxs("div",{className:"mt-1",children:["Header: ",e.jsx("span",{className:"font-semibold",children:"x-evzone-request-id"})]})]})]})})]}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs(ha,{title:"Webhook endpoints",subtitle:"Manage endpoints",right:e.jsx(ft,{label:`${Te.length}`,tone:"neutral"}),children:[e.jsxs("div",{className:"space-y-2",children:[Te.map(u=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ft,{label:u.env,tone:u.env==="Production"?"neutral":"info"}),e.jsx(ft,{label:u.status,tone:fB(u.status)}),e.jsx(ft,{label:u.id,tone:"neutral"}),e.jsx(ft,{label:`Retries ${u.retryCount}`,tone:"neutral"}),e.jsx(ft,{label:u.hmacEnabled?"HMAC":"No HMAC",tone:u.hmacEnabled?"info":"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:u.url}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",_r(u.createdAt),"  Last delivery ",u.lastDeliveryAt?_r(u.lastDeliveryAt):"Never"]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:u.events.map(P=>e.jsx(ft,{label:P,tone:"neutral"},`${u.id}-${P}`))}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Secret: ",u.secretHint]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ht,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{const P=u.events[0]||"invoice.created";B(u.id,P)},disabled:u.status!=="Enabled",children:[e.jsx(tt,{className:"h-4 w-4"})," Test"]}),e.jsxs(Ht,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Be(u.id),children:[e.jsx(Mr,{className:"h-4 w-4"})," Rotate"]}),e.jsxs(Ht,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Ye(u.id),n({title:"Updated",message:`Webhook ${u.status==="Enabled"?"disabled":"enabled"}.`,kind:"success"})},children:[e.jsx(kl,{className:"h-4 w-4"})," Toggle"]}),e.jsxs(Ht,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>w(u.id),children:[e.jsx(as,{className:"h-4 w-4"})," Delete"]})]})]})},u.id)),Te.length?null:e.jsx(Tm,{title:"No webhooks",subtitle:"Create a webhook endpoint."})]}),e.jsxs(ha,{title:"Delivery logs",subtitle:"Recent deliveries",right:e.jsx(ft,{label:r.webhookInspectorEnabled?"Premium":"Off",tone:r.webhookInspectorEnabled?"info":"neutral"}),children:[e.jsxs("div",{className:"space-y-2",children:[Ge.slice(0,10).map(u=>e.jsx("button",{type:"button",className:"w-full rounded-3xl border border-slate-200 bg-white p-4 text-left hover:bg-slate-50",onClick:()=>{Le(u.id),ye(!0)},disabled:!r.webhookInspectorEnabled,children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ft,{label:u.env,tone:u.env==="Production"?"neutral":"info"}),e.jsx(ft,{label:u.event,tone:"neutral"}),e.jsx(ft,{label:u.status,tone:Fh(u.status)}),e.jsx(ft,{label:`HTTP ${u.httpStatus}`,tone:u.httpStatus>=200&&u.httpStatus<300?"good":"warn"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[_r(u.at),"  ",u.endpointId,"  Attempts ",u.attempts,"  ",u.durationMs,"ms"]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Response: ",u.responseSnippet]})]}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]})},u.id)),Ge.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No deliveries found."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: open a delivery to see payload, headers, and retry traces."})]})]})})]}):null,o==="sandbox"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsxs(ha,{title:"Sandbox mode",subtitle:"Premium: safe testing",right:e.jsx(ft,{label:"Premium",tone:"info"}),children:[e.jsx(Br,{enabled:r.sandboxEnabled,onChange:u=>{i(P=>({...P,sandboxEnabled:u})),n({title:"Updated",message:`Sandbox ${u?"enabled":"disabled"}.`,kind:"success"})},label:"Enable sandbox",description:"Allows test keys, test exports, and test webhook deliveries"}),e.jsx(Br,{enabled:ge.routeWebhooksToInspector,onChange:u=>$e(P=>({...P,routeWebhooksToInspector:u})),label:"Route test deliveries to inspector",description:"Sends sandbox events into the inspector feed"}),e.jsx(Br,{enabled:r.webhookInspectorEnabled,onChange:u=>i(P=>({...P,webhookInspectorEnabled:u})),label:"Webhook inspector",description:"Inspect payloads, retries, and signatures"}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Sandbox base: ",e.jsx("span",{className:"font-semibold",children:r.apiBaseSandbox}),e.jsxs("div",{className:"mt-2",children:["Use keys with prefix ",e.jsx("span",{className:"font-semibold",children:"cp_test_"})]})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2",children:[e.jsxs(Ht,{variant:"outline",onClick:()=>{const u=$.find(P=>P.env==="Sandbox"&&P.status==="Enabled");if(!u){n({title:"No sandbox webhook",message:"Create a sandbox webhook first.",kind:"warn"});return}B(u.id,"invoice.created")},disabled:!r.sandboxEnabled,children:[e.jsx(tt,{className:"h-4 w-4"})," Send test invoice.created"]}),e.jsxs(Ht,{variant:"outline",onClick:()=>{const u=$.find(P=>P.env==="Sandbox"&&P.status==="Enabled");if(!u){n({title:"No sandbox webhook",message:"Create a sandbox webhook first.",kind:"warn"});return}B(u.id,"limit.breached")},disabled:!r.sandboxEnabled,children:[e.jsx(Et,{className:"h-4 w-4"})," Simulate limit breach"]}),e.jsxs(Ht,{variant:"outline",onClick:()=>{var u;Le(((u=Ge[0])==null?void 0:u.id)||null),ye(!0)},disabled:!r.webhookInspectorEnabled,children:[e.jsx(tu,{className:"h-4 w-4"})," Open inspector"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: sandbox/test mode + webhook inspector."})]})}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs(ha,{title:"Sandbox exports",subtitle:"Test ERP exports",right:e.jsx(ft,{label:"Core",tone:"neutral"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:"You can run exports in sandbox to validate mappings before production."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Ht,{variant:"primary",onClick:()=>{he(u=>({...u,env:"Sandbox"})),ce(!0)},disabled:!r.sandboxEnabled,children:[e.jsx(pt,{className:"h-4 w-4"})," New sandbox export"]}),e.jsxs(Ht,{variant:"outline",onClick:fe,children:[e.jsx(kt,{className:"h-4 w-4"})," OpenAPI"]})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[x.filter(u=>u.env==="Sandbox").slice(0,6).map(u=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ft,{label:u.env,tone:"info"}),e.jsx(ft,{label:u.kind,tone:"neutral"}),e.jsx(ft,{label:u.format,tone:"info"}),e.jsx(ft,{label:u.status,tone:u.status==="Ready"?"good":u.status==="Failed"?"bad":"warn"})]}),e.jsxs("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:[u.id,"  ",u.rangeLabel]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",_r(u.createdAt),"  ",u.createdBy]})]}),e.jsxs(Ht,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>De(u.id),disabled:u.status!=="Ready",children:[e.jsx(pt,{className:"h-4 w-4"})," Download"]})]})},u.id)),x.some(u=>u.env==="Sandbox")?null:e.jsx(Tm,{title:"No sandbox exports",subtitle:"Create a sandbox export job."})]})]})})]}):null,o==="sso"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsxs(ha,{title:"SSO (Phase 2)",subtitle:"Premium: Google and Microsoft",right:e.jsx(ft,{label:"Phase 2",tone:"info"}),children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["SSO is planned for phase 2 and will support:",e.jsxs("ul",{className:"mt-2 space-y-1",children:[e.jsx("li",{children:" Google Workspace and Microsoft Entra ID"}),e.jsx("li",{children:" Domain allowlist and just-in-time provisioning"}),e.jsx("li",{children:" Optional SCIM user sync"})]})]}),e.jsx(Br,{enabled:ie.ssoGoogle,onChange:u=>{Oe(P=>({...P,ssoGoogle:u})),n({title:"Phase 2",message:"SSO configuration placeholder toggled (demo).",kind:"info"})},label:"Google SSO",description:"Coming soon"}),e.jsx(Br,{enabled:ie.ssoMicrosoft,onChange:u=>{Oe(P=>({...P,ssoMicrosoft:u})),n({title:"Phase 2",message:"SSO configuration placeholder toggled (demo).",kind:"info"})},label:"Microsoft SSO",description:"Coming soon"}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Phase 2: when enabled, login pages (X1/X2) will show SSO buttons."})]})}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs(ha,{title:"HRIS import (Phase 2)",subtitle:"Premium: HRIS connectors",right:e.jsx(ft,{label:"Phase 2",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:"HRIS import will support scheduled user sync and group assignment rules."}),e.jsx(Br,{enabled:ie.hrisImport,onChange:u=>{Oe(P=>({...P,hrisImport:u})),n({title:"Phase 2",message:"HRIS import placeholder toggled (demo).",kind:"info"})},label:"Enable HRIS import",description:"Coming soon"}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[{name:"Workday",desc:"User sync and cost centers"},{name:"BambooHR",desc:"Employee directory import"},{name:"SAP SuccessFactors",desc:"Org structure and roles"},{name:"Custom CSV",desc:"Fallback import for any HRIS"}].map(u=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:u.name}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:u.desc})]}),e.jsx(ft,{label:"Phase 2",tone:"info"})]})},u.name))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Best practice: even before HRIS sync, bulk import (C) can seed users with groups and cost centers."})]})})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"Y Integrations & Developer Center v2. Core: ERP exports (CSV/JSON), secure API keys and scopes, webhooks for invoices, approvals, and limit breaches. Premium: sandbox and webhook inspector, plus phase 2 SSO and HRIS import placeholders."})})]})}),e.jsx(Lh,{open:H,title:"Create API key",subtitle:"Secrets are shown once. Use least privilege scopes.",onClose:()=>Y(!1),actions:[{label:"Create",onClick:Ue}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Ht,{variant:"outline",onClick:()=>Y(!1),children:"Cancel"}),e.jsxs(Ht,{variant:"primary",onClick:Ue,children:[e.jsx(ct,{className:"h-4 w-4"})," Create"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Om,{label:"Key name",value:we.name,onChange:u=>q(P=>({...P,name:u})),placeholder:"Example: ERP sync"}),e.jsx(co,{label:"Environment",value:we.env,onChange:u=>q(P=>({...P,env:u})),options:[{value:"Production",label:"Production"},{value:"Sandbox",label:"Sandbox"}]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Om,{label:"IP allowlist",value:we.ipAllowlist,onChange:u=>q(P=>({...P,ipAllowlist:u})),placeholder:"Example: 10.0.0.0/24",hint:"Optional"})}),e.jsxs("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Scopes"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Select what this key can do."}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2 md:grid-cols-2",children:t.map(u=>e.jsxs("label",{className:"flex items-start gap-3 rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("input",{type:"checkbox",className:"mt-1 h-4 w-4 rounded border-slate-300",checked:we.scopes[u.scope],onChange:P=>q(se=>({...se,scopes:{...se.scopes,[u.scope]:P.target.checked}}))}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:u.label}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:u.scope}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:u.desc})]})]},u.scope))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Best practice: avoid write scopes unless needed. Prefer separate keys per system."})]})]})}),e.jsx(Lh,{open:Fe,title:"Create webhook",subtitle:"Receive event callbacks (HMAC recommended).",onClose:()=>Pe(!1),actions:[{label:"Create",onClick:Ve}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Ht,{variant:"outline",onClick:()=>Pe(!1),children:"Cancel"}),e.jsxs(Ht,{variant:"primary",onClick:Ve,children:[e.jsx(ct,{className:"h-4 w-4"})," Create"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(co,{label:"Environment",value:pe.env,onChange:u=>Q(P=>({...P,env:u})),options:[{value:"Production",label:"Production"},{value:"Sandbox",label:"Sandbox"}]}),e.jsx(Om,{label:"Endpoint URL",value:pe.url,onChange:u=>Q(P=>({...P,url:u})),placeholder:"https://your-system.com/webhooks/evzone"}),e.jsx(co,{label:"Retry count",value:`${pe.retryCount}`,onChange:u=>Q(P=>({...P,retryCount:fC(Number(u),0,12)})),options:Array.from({length:13},(u,P)=>({value:`${P}`,label:`${P}`})),hint:"0 to 12"}),e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsx(Br,{enabled:pe.hmac,onChange:u=>Q(P=>({...P,hmac:u})),label:"HMAC signing",description:"Adds x-evzone-signature header"})}),e.jsxs("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Events"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Choose which events to receive."}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2 md:grid-cols-2",children:s.map(u=>e.jsxs("label",{className:"flex items-start gap-3 rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("input",{type:"checkbox",className:"mt-1 h-4 w-4 rounded border-slate-300",checked:pe.events[u.ev],onChange:P=>Q(se=>({...se,events:{...se.events,[u.ev]:P.target.checked}}))}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:u.ev}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:u.desc})]})]},u.ev))}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Secrets are shown once on create and can be rotated later."})]})]})}),e.jsx(Lh,{open:Re,title:"Create ERP export",subtitle:"CSV/JSON exports for accounting systems.",onClose:()=>ce(!1),actions:[{label:"Run export",onClick:ne}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Ht,{variant:"outline",onClick:()=>ce(!1),children:"Cancel"}),e.jsxs(Ht,{variant:"primary",onClick:ne,children:[e.jsx(pt,{className:"h-4 w-4"})," Run export"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(co,{label:"Environment",value:xe.env,onChange:u=>he(P=>({...P,env:u})),options:[{value:"Production",label:"Production"},{value:"Sandbox",label:"Sandbox"}]}),e.jsx(co,{label:"Export kind",value:xe.kind,onChange:u=>he(P=>({...P,kind:u})),options:[{value:"Transactions",label:"Transactions"},{value:"Invoices",label:"Invoices"},{value:"Approvals",label:"Approvals"}]}),e.jsx(co,{label:"Format",value:xe.format,onChange:u=>he(P=>({...P,format:u})),options:[{value:"CSV",label:"CSV"},{value:"JSON",label:"JSON"}]}),e.jsx(co,{label:"Range",value:xe.range,onChange:u=>he(P=>({...P,range:u})),options:[{value:"7d",label:"Last 7 days"},{value:"30d",label:"Last 30 days"},{value:"90d",label:"Last 90 days"},{value:"custom",label:"Custom"}]}),e.jsx("div",{className:Ql(xe.range!=="custom"&&"opacity-60"),children:e.jsx(Om,{label:"From",type:"date",value:xe.from,onChange:u=>he(P=>({...P,from:u})),disabled:xe.range!=="custom"})}),e.jsx("div",{className:Ql(xe.range!=="custom"&&"opacity-60"),children:e.jsx(Om,{label:"To",type:"date",value:xe.to,onChange:u=>he(P=>({...P,to:u})),disabled:xe.range!=="custom"})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:"In production, exports can also push directly to ERP via secure API endpoints."})]})}),e.jsxs(Lh,{open:je,title:(Ee==null?void 0:Ee.title)||"Secret",subtitle:"Copy now. You will not be able to view this secret again.",onClose:()=>{_e(!1),be(null)},footer:e.jsx("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:e.jsxs(Ht,{variant:"primary",onClick:()=>{_e(!1),be(null)},children:[e.jsx(tt,{className:"h-4 w-4"})," Done"]})}),children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Secret"}),e.jsx("div",{className:"mt-2 font-mono text-sm font-semibold text-slate-900 break-all",children:(Ee==null?void 0:Ee.secret)||""}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Hint: ",(Ee==null?void 0:Ee.hint)||""]})]}),e.jsx(Ht,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>me((Ee==null?void 0:Ee.secret)||"","Secret copied"),children:e.jsx(ss,{className:"h-4 w-4"})})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Store this in your secrets manager. If lost, rotate to generate a new secret."})]}),e.jsx(pB,{open:de,title:Ne?`Webhook delivery ${Ne.id}`:"Webhook inspector",subtitle:Ne?`${Ne.event}  ${Ne.env}  ${xB(Ne.at)}`:"Inspect deliveries and payloads",onClose:()=>{ye(!1),Le(null)},footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Inspector is premium and intended for debugging."}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ht,{variant:"outline",onClick:()=>{Le(null),n({title:"Cleared",message:"Selection cleared.",kind:"info"})},children:[e.jsx(Qe,{className:"h-4 w-4"})," Clear"]}),e.jsxs(Ht,{variant:"primary",onClick:()=>{ye(!1)},children:[e.jsx(tt,{className:"h-4 w-4"})," Close"]})]})]}),children:Ne?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ft,{label:Ne.env,tone:Ne.env==="Production"?"neutral":"info"}),e.jsx(ft,{label:Ne.event,tone:"neutral"}),e.jsx(ft,{label:Ne.status,tone:Fh(Ne.status)}),e.jsx(ft,{label:`HTTP ${Ne.httpStatus}`,tone:Ne.httpStatus>=200&&Ne.httpStatus<300?"good":"warn"}),e.jsx(ft,{label:`Attempts ${Ne.attempts}`,tone:"neutral"}),e.jsx(ft,{label:`${Ne.durationMs}ms`,tone:"neutral"})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Endpoint: ",Ne.endpointId,"  Request: ",Ne.requestId]}),e.jsxs("div",{className:"mt-2 text-sm text-slate-700",children:["Response: ",e.jsx("span",{className:"font-semibold",children:Ne.responseSnippet})]})]}),e.jsxs(ha,{title:"Headers",subtitle:"Preview",right:e.jsx(ft,{label:"Premium",tone:"info"}),children:[e.jsx("pre",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-800 overflow-auto",children:JSON.stringify(Ne.headersPreview,null,2)}),e.jsxs(Ht,{variant:"outline",onClick:()=>me(JSON.stringify(Ne.headersPreview,null,2),"Headers copied"),children:[" ",e.jsx(ss,{className:"h-4 w-4"})," Copy"]})]}),e.jsxs(ha,{title:"Body",subtitle:"Payload",right:e.jsx(ft,{label:"Premium",tone:"info"}),children:[e.jsx("pre",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-800 overflow-auto",children:JSON.stringify(Ne.bodyPreview,null,2)}),e.jsxs(Ht,{variant:"outline",onClick:()=>me(JSON.stringify(Ne.bodyPreview,null,2),"Body copied"),children:[" ",e.jsx(ss,{className:"h-4 w-4"})," Copy"]})]}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Best practice: implement idempotency in your receiver using x-evzone-request-id."})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Select a delivery from Webhooks or Overview to see full details."}),e.jsx("div",{className:"space-y-2",children:Ge.slice(0,30).map(u=>e.jsx("button",{type:"button",className:"w-full rounded-3xl border border-slate-200 bg-white p-4 text-left hover:bg-slate-50",onClick:()=>Le(u.id),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ft,{label:u.env,tone:u.env==="Production"?"neutral":"info"}),e.jsx(ft,{label:u.event,tone:"neutral"}),e.jsx(ft,{label:u.status,tone:Fh(u.status)}),e.jsx(ft,{label:`HTTP ${u.httpStatus}`,tone:u.httpStatus>=200&&u.httpStatus<300?"good":"warn"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[_r(u.at),"  ",u.endpointId,"  Attempts ",u.attempts]})]}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]})},u.id))})]})})]});function E({title:u,value:P,sub:se,icon:D,tone:re}){const v=re==="good"?"bg-emerald-50 text-emerald-700":re==="warn"?"bg-amber-50 text-amber-800":re==="bad"?"bg-rose-50 text-rose-700":re==="info"?"bg-blue-50 text-blue-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:u}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:P}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:se})]}),e.jsx("div",{className:Ql("grid h-10 w-10 place-items-center rounded-2xl",v),children:D})]})})}}const bg={green:"#03CD8C",orange:"#F77F00"};function tn(...t){return t.filter(Boolean).join(" ")}function Tc(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function vC(t,s,a){return Math.max(s,Math.min(a,t))}function uo(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function mo(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function bB(t){return Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function rt({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:tn("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function wb(t){return t==="Critical"?"bad":t==="Warning"?"warn":"info"}function jB(t){return t==="Valid"?"good":t==="Expiring"?"warn":t==="Expired"||t==="Missing"?"bad":"neutral"}function Rt({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:bg.green}:t==="accent"?{background:bg.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:tn(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function fi({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:tn("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:tn("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function Vh({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:tn(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:tn("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function bC({label:t,value:s,onChange:a,hint:l,disabled:n,min:r=0,max:i=3650}){return e.jsxs("div",{className:tn(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",min:r,max:i,value:Number.isFinite(s)?s:0,onChange:o=>a(Number(o.target.value||0)),disabled:n,className:tn("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function Cn({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:tn(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:tn("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function _h({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:i=>a(i.target.value),placeholder:l,rows:r,className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"})]})}function tM({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:tn("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function Bh({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="980px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:12,scale:.985},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:12,scale:.985},transition:{duration:.18},className:"fixed inset-x-0 top-[7vh] z-50 mx-auto w-[min(1040px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(tM,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[72vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function yB({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,actions:i}){return d.useEffect(()=>{const o=c=>c.key==="Escape"&&n();return t&&window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,x:18},animate:{opacity:1,x:0},exit:{opacity:0,x:18},transition:{duration:.18},className:tn("fixed z-50 overflow-hidden border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]","left-2 right-2 bottom-2 top-[10vh] rounded-[28px]","lg:left-auto lg:right-4 lg:top-4 lg:bottom-4 lg:w-[760px]"),role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-base font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i&&e.jsx(tM,{actions:i}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"h-full min-h-0 overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function NB({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(480px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:tn("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function Bs({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function Gr({title:t,subtitle:s}){return e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(yt,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:s})]})}function jC(t){let s=2166136261;for(let a=0;a<t.length;a++)s^=t.charCodeAt(a),s=Math.imul(s,16777619);return(s>>>0).toString(16).padStart(8,"0")}async function Gh(t){try{const a=new TextEncoder().encode(t);if(!(crypto!=null&&crypto.subtle))return jC(t);const l=await crypto.subtle.digest("SHA-256",a);return Array.from(new Uint8Array(l)).map(r=>r.toString(16).padStart(2,"0")).join("")}catch{return jC(t)}}function yC(t){const s=new WeakSet,a=l=>{if(l&&typeof l=="object"){if(s.has(l))return"[Circular]";if(s.add(l),Array.isArray(l))return l.map(a);const n=Object.keys(l).sort(),r={};for(const i of n)r[i]=a(l[i]);return r}return l};return JSON.stringify(a(t))}function wB(){const t=["E-Commerce","EVs & Charging","Rides & Logistics","School & E-Learning","Medical & Health Care","Travel & Tourism","Green Investments","FaithHub","Virtual Workspace","Finance & Payments","Other Service Module"],[s,a]=d.useState([]),l=h=>{const K=Tc("toast");a(_=>[{id:K,...h},..._].slice(0,4)),window.setTimeout(()=>a(_=>_.filter(ke=>ke.id!==K)),3200)},[n,r]=d.useState("Org Admin"),[i,o]=d.useState("overview"),[c,x]=d.useState(()=>({requireMfaOrgAdmin:!0,requireMfaFinance:!0,requireMfaApprover:!0,requireMfaSupport:!0,trustDeviceDays:30,requireStepUpNewDevice:!0,requireStepUpSensitive:!0,ipAllowlist:""})),[j,g]=d.useState(!0),[y,$]=d.useState(()=>{const h=Date.now();return[{id:"RET-01",category:"Audit logs",retentionDays:365,legalHold:!1,purgeMode:"Archive",lastPurgeAt:h-7*24*60*60*1e3,notes:"Archive to cold storage after 365 days"},{id:"RET-02",category:"Invoices and statements",retentionDays:2555,legalHold:!1,purgeMode:"Archive",lastPurgeAt:h-30*24*60*60*1e3,notes:"7 years retention"},{id:"RET-03",category:"Transaction ledger",retentionDays:2555,legalHold:!1,purgeMode:"Archive",lastPurgeAt:h-30*24*60*60*1e3,notes:"7 years retention"},{id:"RET-04",category:"Approvals",retentionDays:730,legalHold:!1,purgeMode:"Archive",lastPurgeAt:h-14*24*60*60*1e3,notes:"2 years retention"},{id:"RET-05",category:"Webhook deliveries",retentionDays:90,legalHold:!1,purgeMode:"Hard delete",lastPurgeAt:h-3*24*60*60*1e3,notes:"Operational logs"},{id:"RET-06",category:"API access logs",retentionDays:180,legalHold:!1,purgeMode:"Hard delete",lastPurgeAt:h-3*24*60*60*1e3,notes:"Security analytics"},{id:"RET-07",category:"Support sessions",retentionDays:365,legalHold:!1,purgeMode:"Archive",lastPurgeAt:h-14*24*60*60*1e3,notes:"Support audit trails"},{id:"RET-08",category:"Exports",retentionDays:60,legalHold:!1,purgeMode:"Hard delete",lastPurgeAt:h-3*24*60*60*1e3,notes:"Reduce sensitive artifacts"}]}),[T,C]=d.useState(()=>[{id:"DC-01",actionKey:"retention_change",title:"Change data retention",enabled:!0,approversRequired:2,stepUpMfaRequired:!0,allowBreakGlass:!0,notes:"Prevents silent data deletion changes"},{id:"DC-02",actionKey:"mfa_policy_change",title:"Change MFA policy",enabled:!0,approversRequired:2,stepUpMfaRequired:!0,allowBreakGlass:!0,notes:"Protects auth baseline"},{id:"DC-03",actionKey:"support_write_action",title:"Support write actions",enabled:!0,approversRequired:2,stepUpMfaRequired:!0,allowBreakGlass:!1,notes:"EVzone Support cannot write without org approval"},{id:"DC-04",actionKey:"rotate_prod_key",title:"Rotate production API keys",enabled:!0,approversRequired:2,stepUpMfaRequired:!0,allowBreakGlass:!0,notes:"Reduce integration outage risk"},{id:"DC-05",actionKey:"forensic_export_prod",title:"Generate production forensic exports",enabled:!0,approversRequired:2,stepUpMfaRequired:!0,allowBreakGlass:!0,notes:"Sensitive logs export"},{id:"DC-06",actionKey:"disable_support_mode",title:"Disable support mode",enabled:!0,approversRequired:2,stepUpMfaRequired:!0,allowBreakGlass:!0,notes:"Avoid accidental lockout during incident"}]),[W,L]=d.useState(()=>{const h=Date.now();return[{id:"DCR-001",createdAt:h-2*60*60*1e3,requestedBy:"EVzone Support",requesterRole:"EVzone Support",env:"Production",actionKey:"support_write_action",reason:"Need to re-send overdue invoices with corrected AP routing",status:"Pending",approvals:[{by:"Org Admin",role:"Org Admin",at:h-30*60*1e3}],required:2}]}),[R,F]=d.useState(()=>[{id:"SUP-001",startedAt:Date.now()-3*60*60*1e3,env:"Production",agent:"EVzone Support",reason:"Invoice delivery troubleshooting",writeEnabled:!1,writeRequests:["DCR-001"]}]),[te,oe]=d.useState(()=>{const h=Date.now();return[{id:"DEV-001",user:"Org Admin",role:"Org Admin",device:"iPhone 15 Pro",deviceType:"Phone",firstSeenAt:h-40*24*60*60*1e3,lastSeenAt:h-2*60*60*1e3,status:"Trusted",trustedUntil:h+22*24*60*60*1e3,ipLast:"197.157.0.12",geoLast:"Kampala, UG",riskSignals:[]},{id:"DEV-002",user:"Finance Desk",role:"Finance",device:"Windows Laptop",deviceType:"Laptop",firstSeenAt:h-120*24*60*60*1e3,lastSeenAt:h-10*60*1e3,status:"Trusted",trustedUntil:h+10*24*60*60*1e3,ipLast:"197.157.0.18",geoLast:"Kampala, UG",riskSignals:["New IP observed"]},{id:"DEV-003",user:"EVzone Support",role:"EVzone Support",device:"Support Console",deviceType:"Other",firstSeenAt:h-12*24*60*60*1e3,lastSeenAt:h-45*60*1e3,status:"Trusted",trustedUntil:h+7*24*60*60*1e3,ipLast:"41.210.0.9",geoLast:"Nairobi, KE",riskSignals:["Support mode"]},{id:"DEV-004",user:"John S.",role:"Employee",device:"Android",deviceType:"Phone",firstSeenAt:h-9*24*60*60*1e3,lastSeenAt:h-3*24*60*60*1e3,status:"Revoked",ipLast:"102.88.1.11",geoLast:"Entebbe, UG",riskSignals:["Password reset"]}]}),[G,H]=d.useState(()=>{const h=Date.now();return[{id:"LG-001",at:h-2*60*60*1e3,user:"Org Admin",role:"Org Admin",ip:"197.157.0.12",geo:"Kampala, UG",device:"iPhone 15 Pro",outcome:"Success",note:"Trusted device"},{id:"LG-002",at:h-70*60*1e3,user:"Finance Desk",role:"Finance",ip:"197.157.0.18",geo:"Kampala, UG",device:"Windows Laptop",outcome:"Step-up required",note:"New IP observed"},{id:"LG-003",at:h-45*60*1e3,user:"EVzone Support",role:"EVzone Support",ip:"41.210.0.9",geo:"Nairobi, KE",device:"Support Console",outcome:"Success",note:"Support session"},{id:"LG-004",at:h-2*24*60*60*1e3,user:"John S.",role:"Employee",ip:"102.88.1.11",geo:"Entebbe, UG",device:"Android",outcome:"Blocked",note:"Device revoked"}]}),[Y,we]=d.useState(()=>{const h=Date.now();return[{id:"AUD-001",ts:h-2*60*60*1e3,env:"Production",severity:"Info",actor:"Org Admin",role:"Org Admin",ip:"197.157.0.12",device:"iPhone 15 Pro",module:"Security",marketplace:"-",event:"Auth.Login",targetType:"session",targetId:"sess_001",summary:"Login success",metadata:{outcome:"success",method:"password+mfa"}},{id:"AUD-002",ts:h-65*60*1e3,env:"Production",severity:"Warning",actor:"Finance Desk",role:"Finance",ip:"197.157.0.18",device:"Windows Laptop",module:"Security",marketplace:"-",event:"Auth.Login",targetType:"session",targetId:"sess_002",summary:"Step-up required",metadata:{outcome:"step-up",reason:"new ip"}},{id:"AUD-003",ts:h-3*24*60*60*1e3,env:"Production",severity:"Info",actor:"Org Admin",role:"Org Admin",ip:"197.157.0.12",device:"iPhone 15 Pro",module:"Security",marketplace:"-",event:"Policy.Retention.Updated",targetType:"retention",targetId:"RET-05",summary:"Updated retention rule",metadata:{category:"Webhook deliveries"},diff:{before:{retentionDays:60},after:{retentionDays:90}}},{id:"AUD-004",ts:h-3*60*60*1e3,env:"Production",severity:"Warning",actor:"EVzone Support",role:"EVzone Support",ip:"41.210.0.9",device:"Support Console",module:"System",marketplace:"-",event:"Support.Session.Start",targetType:"support_session",targetId:"SUP-001",summary:"Support session started",metadata:{supportMode:!0}},{id:"AUD-005",ts:h-2*60*60*1e3,env:"Production",severity:"Critical",actor:"System",role:"System",ip:"-",device:"-",module:"Billing",marketplace:"-",event:"Support.Action.Requested",targetType:"dual_control_request",targetId:"DCR-001",summary:"Support write requested",metadata:{action:"resend invoices"}}]}),[q,je]=d.useState(()=>[]),[_e,Ee]=d.useState(()=>{const h=Date.now();return[{id:"ATT-001",policyName:"CorporatePay Acceptable Use",version:"v1.2",requiredForRoles:["Org Admin","Finance","Approver","EVzone Support"],dueBy:h+14*24*60*60*1e3,lastUpdatedAt:h-14*24*60*60*1e3,completion:[{user:"Org Admin",role:"Org Admin",at:h-10*24*60*60*1e3},{user:"Finance Desk",role:"Finance",at:h-9*24*60*60*1e3}]},{id:"ATT-002",policyName:"Support Mode Rules",version:"v2.0",requiredForRoles:["EVzone Support","Org Admin"],dueBy:h+21*24*60*60*1e3,lastUpdatedAt:h-30*24*60*60*1e3,completion:[{user:"EVzone Support",role:"EVzone Support",at:h-5*24*60*60*1e3}]}]}),[be,Fe]=d.useState(()=>{const h=Date.now(),K=h+20*24*60*60*1e3,_=h-12*24*60*60*1e3;return[{id:"VD-001",vendor:"EVzone Rides",docType:"Insurance",fileName:"insurance-2026.pdf",verified:!0,expiryDate:K,status:"Expiring",uploadedAt:h-40*24*60*60*1e3,uploadedBy:"Procurement Desk",notes:"Renewal requested"},{id:"VD-002",vendor:"Shenzhen Store",docType:"License",fileName:"license.pdf",verified:!0,expiryDate:h+210*24*60*60*1e3,status:"Valid",uploadedAt:h-70*24*60*60*1e3,uploadedBy:"Procurement Desk",notes:""},{id:"VD-003",vendor:"Express CN",docType:"Safety",fileName:"safety-cert.pdf",verified:!1,expiryDate:_,status:"Expired",uploadedAt:h-190*24*60*60*1e3,uploadedBy:"Procurement Desk",notes:"Awaiting updated certificate"},{id:"VD-004",vendor:"ServicePro",docType:"Tax",fileName:"tax-clearance.pdf",verified:!0,expiryDate:h+30*24*60*60*1e3,status:"Valid",uploadedAt:h-10*24*60*60*1e3,uploadedBy:"Procurement Desk",notes:""}]}),[Pe,pe]=d.useState(""),[Q,Re]=d.useState("All"),[ce,xe]=d.useState("All"),[he,de]=d.useState("All"),[ye,Ke]=d.useState("All"),[Le,Ne]=d.useState(!1),[ge,$e]=d.useState(null),ie=d.useMemo(()=>ge&&Y.find(h=>h.id===ge)||null,[ge,Y]),[Oe,Se]=d.useState(null),[Te,Ge]=d.useState(""),[We,ze]=d.useState(!1),[Ue,le]=d.useState(()=>({env:"Production",range:"Last 7 days",includeSupport:!0,includeCompliance:!0,reason:""})),[z,Ae]=d.useState(!1),[Ve,Ye]=d.useState(()=>({vendor:"",docType:"License",fileName:"",expiryDate:"",verified:!1,notes:""})),[Be,w]=d.useState(!1),[B,ue]=d.useState({attId:"ATT-001",confirm:!1,note:""}),ne=h=>{const K={id:Tc("AUD"),ts:h.ts??Date.now(),...h};return we(_=>[K,..._].slice(0,800)),K},Me=d.useMemo(()=>Object.fromEntries(T.map(h=>[h.actionKey,h])),[T]),De=(h,K)=>{const _=Me[h];return _!=null&&_.enabled?h==="forensic_export_prod"||h==="rotate_prod_key"?K==="Production":!0:!1},fe=(h,K,_)=>{const ke=Me[h],I=(ke==null?void 0:ke.approversRequired)??2,Z={id:Tc("DCR"),createdAt:Date.now(),requestedBy:n,requesterRole:n,env:K,actionKey:h,reason:_.trim()||"Policy required",status:"Pending",approvals:[],required:I};return L(Ce=>[Z,...Ce]),ne({env:K,severity:"Critical",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Support.Action.Requested",targetType:"dual_control_request",targetId:Z.id,summary:"Dual control request created",metadata:{actionKey:h,required:I,reason:Z.reason}}),l({title:"Approval required",message:`Created request ${Z.id}.`,kind:"warn"}),Z},me=h=>{const K=Date.now();L(_=>_.map(ke=>{if(ke.id!==h||ke.status!=="Pending"||ke.approvals.some(Ce=>Ce.by===n))return ke;const I=[...ke.approvals,{by:n,role:n,at:K}],Z=I.length>=ke.required?"Approved":"Pending";return{...ke,approvals:I,status:Z}})),ne({env:"Production",severity:"Info",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Policy.DualControl.Updated",targetType:"dual_control_request",targetId:h,summary:"Dual control approval recorded",metadata:{by:n}}),l({title:"Approved",message:"Approval recorded.",kind:"success"})},Xe=h=>{L(K=>K.map(_=>_.id===h?{..._,status:"Rejected"}:_)),ne({env:"Production",severity:"Warning",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Policy.DualControl.Updated",targetType:"dual_control_request",targetId:h,summary:"Dual control request rejected",metadata:{by:n}}),l({title:"Rejected",message:"Request rejected.",kind:"info"})},V=d.useMemo(()=>{const h=Pe.trim().toLowerCase();return Y.filter(K=>Q==="All"?!0:K.env===Q).filter(K=>ce==="All"?!0:K.severity===ce).filter(K=>he==="All"?!0:K.role===he).filter(K=>ye==="All"?!0:K.module===ye).filter(K=>h?`${K.id} ${K.actor} ${K.role} ${K.event} ${K.targetType} ${K.targetId} ${K.summary} ${K.module} ${K.marketplace}`.toLowerCase().includes(h):!0).slice().sort((K,_)=>_.ts-K.ts)},[Y,Pe,Q,ce,he,ye]),E=d.useMemo(()=>be.filter(h=>h.status==="Expiring"||h.status==="Expired"||h.status==="Missing"),[be]),u=d.useMemo(()=>W.filter(h=>h.status==="Pending").length,[W]),P=d.useMemo(()=>R.filter(h=>!h.endedAt).length,[R]),se=d.useMemo(()=>{const h=[];c.requireMfaOrgAdmin&&h.push("Org Admin"),c.requireMfaFinance&&h.push("Finance"),c.requireMfaApprover&&h.push("Approver"),c.requireMfaSupport&&h.push("EVzone Support");const K=Array.from(new Set(h)),_=K.length?100:0;return{requiredRoles:K,pct:_}},[c]),D=()=>{const h={filters:{envFilter:Q,sevFilter:ce,roleFilter:he,moduleFilter:ye,q:Pe},entries:V,exportedAt:new Date().toISOString()},K=new Blob([JSON.stringify(h,null,2)],{type:"application/json"}),_=URL.createObjectURL(K),ke=document.createElement("a");ke.href=_,ke.download="corporatepay-audit.json",ke.click(),URL.revokeObjectURL(_),l({title:"Exported",message:"Audit JSON downloaded.",kind:"success"})},re=()=>{const h=["ts","env","severity","actor","role","event","module","marketplace","targetType","targetId","summary"],K=ot=>{const Nt=String(ot??"");return/[",\n]/.test(Nt)?`"${Nt.replace(/"/g,'""')}"`:Nt},_=V.map(ot=>({ts:uo(ot.ts),env:ot.env,severity:ot.severity,actor:ot.actor,role:ot.role,event:ot.event,module:ot.module,marketplace:ot.marketplace,targetType:ot.targetType,targetId:ot.targetId,summary:ot.summary})),ke=h.join(","),I=_.map(ot=>h.map(Nt=>K(ot[Nt])).join(",")).join(`
`),Z=`${ke}
${I}`,Ce=new Blob([Z],{type:"text/csv"}),He=URL.createObjectURL(Ce),mt=document.createElement("a");mt.href=He,mt.download="corporatepay-audit.csv",mt.click(),URL.revokeObjectURL(He),l({title:"Exported",message:"Audit CSV downloaded.",kind:"success"})},v=h=>{Ge(""),Se(h)},k=()=>{if(Te.trim().length<8){l({title:"Reason required",message:"Provide a clear reason for audit.",kind:"warn"});return}const h=Oe==="enable";if(!h&&De("disable_support_mode","Production")){fe("disable_support_mode","Production",Te),Se(null);return}g(h),Se(null),ne({env:"Production",severity:"Warning",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:h?"Support.Session.Start":"Support.Session.End",targetType:"support_mode",targetId:"org",summary:h?"Support mode enabled":"Support mode disabled",metadata:{reason:Te.trim()}}),l({title:"Updated",message:h?"Support enabled.":"Support disabled.",kind:"success"})},m=h=>{const K=Date.now();oe(_=>_.map(ke=>ke.id===h?{...ke,status:"Revoked",trustedUntil:void 0,lastSeenAt:K}:ke)),ne({env:"Production",severity:"Warning",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Auth.Device.Revoked",targetType:"device",targetId:h,summary:"Device revoked",metadata:{deviceId:h}}),l({title:"Revoked",message:"Device access revoked.",kind:"success"})},S=()=>{if(De("retention_change","Production")){fe("retention_change","Production","Update retention settings");return}ne({env:"Production",severity:"Info",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Policy.Retention.Updated",targetType:"retention",targetId:"bulk",summary:"Retention policy updated",metadata:{count:y.length}}),l({title:"Applied",message:"Retention settings applied.",kind:"success"})},f=()=>{if(De("mfa_policy_change","Production")){fe("mfa_policy_change","Production","Update MFA and device trust policy");return}ne({env:"Production",severity:"Info",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Auth.MFA.Enabled",targetType:"mfa_policy",targetId:"org",summary:"MFA policy updated",metadata:{...c}}),l({title:"Saved",message:"MFA policy saved.",kind:"success"})},U=h=>{$e(h),Ne(!0)},p=async()=>{const h=Ue.env;if(h==="Production"&&De("forensic_export_prod","Production")){if(!Ue.reason.trim()){l({title:"Reason required",message:"Add a reason for production forensic export.",kind:"warn"});return}fe("forensic_export_prod","Production",Ue.reason),ze(!1);return}const K=V.slice(0,200).slice().reverse(),_=crypto!=null&&crypto.subtle?"SHA-256":"FNV-1a";let ke=await Gh("0");for(const nt of K){const Vs=yC({id:nt.id,ts:nt.ts,env:nt.env,severity:nt.severity,actor:nt.actor,role:nt.role,ip:nt.ip,device:nt.device,module:nt.module,marketplace:nt.marketplace,event:nt.event,targetType:nt.targetType,targetId:nt.targetId,summary:nt.summary,metadata:nt.metadata,diff:nt.diff||null});ke=await Gh(`${ke}|${Vs}`)}const I=ke,Z={exportId:Tc("FXM"),createdAt:new Date().toISOString(),env:h,algorithm:_,recordCount:K.length,rangeLabel:Ue.range,finalHash:I,disclaimer:_==="FNV-1a"?"FNV used because SHA-256 not available.":"SHA-256 used for hash chain."},Ce={id:Tc("FX"),createdAt:Date.now(),createdBy:n,env:h,rangeLabel:Ue.range,recordCount:K.length,algo:_,finalHash:I,status:"Ready",manifest:Z,entries:K};je(nt=>[Ce,...nt]),ne({env:h,severity:"Critical",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Export.Forensic.Created",targetType:"forensic_export",targetId:Ce.id,summary:"Forensic export created",metadata:{recordCount:Ce.recordCount,finalHash:Ce.finalHash,algo:Ce.algo,reason:Ue.reason||""}}),l({title:"Created",message:`Forensic export ${Ce.id} ready.`,kind:"success"}),ze(!1);const He={manifest:Z,entries:K},mt=new Blob([JSON.stringify(He,null,2)],{type:"application/json"}),ot=URL.createObjectURL(mt),Nt=document.createElement("a");Nt.href=ot,Nt.download=`forensic-export-${Ce.id}.json`,Nt.click(),URL.revokeObjectURL(ot)},M=async h=>{const K=q.find(Z=>Z.id===h);if(!K)return;const _=K.entries.slice().sort((Z,Ce)=>Z.ts-Ce.ts);let ke=await Gh("0");for(const Z of _){const Ce=yC({id:Z.id,ts:Z.ts,env:Z.env,severity:Z.severity,actor:Z.actor,role:Z.role,ip:Z.ip,device:Z.device,module:Z.module,marketplace:Z.marketplace,event:Z.event,targetType:Z.targetType,targetId:Z.targetId,summary:Z.summary,metadata:Z.metadata,diff:Z.diff||null});ke=await Gh(`${ke}|${Ce}`)}const I=ke===K.finalHash;je(Z=>Z.map(Ce=>Ce.id===h?{...Ce,verifiedAt:Date.now(),verifiedOk:I}:Ce)),ne({env:K.env,severity:I?"Info":"Critical",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Export.Forensic.Verified",targetType:"forensic_export",targetId:h,summary:I?"Forensic export verified":"Forensic export verification failed",metadata:{ok:I}}),l({title:I?"Verified":"Mismatch",message:I?"Hash chain valid.":"Hash mismatch detected.",kind:I?"success":"error"})},ee=()=>{if(!Ve.vendor.trim()||!Ve.fileName.trim()){l({title:"Missing",message:"Vendor and file name are required.",kind:"warn"});return}const h=Ve.expiryDate?new Date(Ve.expiryDate).getTime():void 0;let K="Valid";const _=Date.now();h?h<_?K="Expired":h<_+30*24*60*60*1e3&&(K="Expiring"):K="Valid";const ke={id:Tc("VD"),vendor:Ve.vendor.trim(),docType:Ve.docType,fileName:Ve.fileName.trim(),verified:Ve.verified,expiryDate:h,status:K,uploadedAt:_,uploadedBy:n,notes:Ve.notes.trim()};Fe(I=>[ke,...I]),ne({env:"Production",severity:K==="Expired"?"Critical":K==="Expiring"?"Warning":"Info",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Compliance.VendorDoc.Updated",targetType:"vendor_doc",targetId:ke.id,summary:"Vendor compliance doc added",metadata:{vendor:ke.vendor,docType:ke.docType,status:ke.status}}),l({title:"Saved",message:"Vendor document saved.",kind:"success"}),Ae(!1)},b=()=>{if(!B.confirm){l({title:"Confirm required",message:"Confirm your attestation.",kind:"warn"});return}const h=Date.now();Ee(K=>K.map(_=>_.id!==B.attId||_.completion.some(ke=>ke.user===n)?_:{..._,completion:[{user:n,role:n,at:h},..._.completion]})),ne({env:"Production",severity:"Info",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Compliance.Attestation.Completed",targetType:"policy_attestation",targetId:B.attId,summary:"Policy attestation completed",metadata:{note:B.note||""}}),l({title:"Completed",message:"Attestation recorded.",kind:"success"}),w(!1)},ae=h=>{const K=q.find(Ce=>Ce.id===h);if(!K)return;const _={manifest:K.manifest,entries:K.entries},ke=new Blob([JSON.stringify(_,null,2)],{type:"application/json"}),I=URL.createObjectURL(ke),Z=document.createElement("a");Z.href=I,Z.download=`forensic-export-${K.id}.json`,Z.click(),URL.revokeObjectURL(I),l({title:"Downloaded",message:"Forensic bundle downloaded.",kind:"success"})},ve=d.useMemo(()=>be.filter(h=>h.status==="Expired"||h.status==="Missing").length,[be]),O=d.useMemo(()=>{const h=new Date,K=new Date(h.getFullYear(),h.getMonth(),h.getDate()).getTime();return Y.filter(_=>_.ts>=K).length},[Y]),X=d.useMemo(()=>{const h=se.pct,K=te.filter(I=>I.status==="Trusted").length,_=te.length||1,ke=Math.round(K/_*100);return{mfa:h,trustPct:ke}},[se.pct,te]),A=[{id:"overview",label:"Overview"},{id:"audit",label:"Audit logs"},{id:"mfa",label:"MFA and device trust"},{id:"retention",label:"Data retention"},{id:"support",label:"Support mode"},{id:"dual",label:"Dual control"},{id:"forensics",label:"Forensic exports"},{id:"compliance",label:"Compliance center"}];return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(NB,{toasts:s,onDismiss:h=>a(K=>K.filter(_=>_.id!==h))}),n==="EVzone Support"?e.jsx("div",{className:"sticky top-0 z-30 border-b border-amber-200 bg-amber-50 px-4 py-2 text-sm text-amber-900",children:e.jsxs("div",{className:"mx-auto flex max-w-[1400px] items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(yt,{className:"h-4 w-4"})," Support session view. No silent actions. Writes require approvals."]}),e.jsx(rt,{label:j?"Support mode enabled":"Support mode disabled",tone:j?"info":"warn"})]})}):null,e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:bg.green},children:e.jsx(yt,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Security, Audit and Compliance"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Audit logs, MFA policies, device trust, retention, support gating, dual control, forensic exports, and compliance evidence."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(rt,{label:`Audit today: ${O}`,tone:"neutral"}),e.jsx(rt,{label:`Dual pending: ${u}`,tone:u?"warn":"good"}),e.jsx(rt,{label:`Support sessions: ${P}`,tone:P?"info":"neutral"}),e.jsx(rt,{label:`Docs alerts: ${E.length}`,tone:E.length?"warn":"good"}),e.jsx(rt,{label:`MFA coverage: ${X.mfa}%`,tone:X.mfa>=100?"good":"warn"}),e.jsx(rt,{label:`Trust coverage: ${X.trustPct}%`,tone:X.trustPct>=70?"good":"warn"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Cn,{label:"View as",value:n,onChange:h=>r(h),options:[{value:"Org Admin",label:"Org Admin"},{value:"Finance",label:"Finance"},{value:"Approver",label:"Approver"},{value:"EVzone Support",label:"EVzone Support"}]}),e.jsxs(Rt,{variant:"outline",onClick:re,children:[e.jsx(pt,{className:"h-4 w-4"})," Export CSV"]}),e.jsxs(Rt,{variant:"outline",onClick:D,children:[e.jsx(pt,{className:"h-4 w-4"})," Export JSON"]}),e.jsxs(Rt,{variant:"primary",onClick:()=>ze(!0),children:[e.jsx(zi,{className:"h-4 w-4"})," Forensic export"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:A.map(h=>e.jsx("button",{className:tn("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",i===h.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:i===h.id?{background:bg.green}:void 0,onClick:()=>o(h.id),children:h.label},h.id))}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 rounded-3xl border border-slate-200 bg-white p-4 md:grid-cols-12",children:[e.jsxs("div",{className:"md:col-span-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2.5",children:[e.jsx(pa,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:Pe,onChange:h=>pe(h.target.value),placeholder:"audit, device, vendor, request...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"}),Pe?e.jsx("button",{className:"rounded-xl p-1 text-slate-500 hover:bg-slate-100",onClick:()=>pe(""),"aria-label":"Clear",children:e.jsx(Qe,{className:"h-4 w-4"})}):null]})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Cn,{label:"Environment",value:Q,onChange:h=>Re(h),options:[{value:"All",label:"All"},{value:"Production",label:"Production"},{value:"Sandbox",label:"Sandbox"}]})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Cn,{label:"Severity",value:ce,onChange:h=>xe(h),options:[{value:"All",label:"All"},{value:"Info",label:"Info"},{value:"Warning",label:"Warning"},{value:"Critical",label:"Critical"}]})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Cn,{label:"Actor role",value:he,onChange:h=>de(h),options:[{value:"All",label:"All"},{value:"Org Admin",label:"Org Admin"},{value:"Finance",label:"Finance"},{value:"Approver",label:"Approver"},{value:"EVzone Support",label:"EVzone Support"},{value:"System",label:"System"},{value:"Employee",label:"Employee"}]})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Cn,{label:"Module",value:ye,onChange:h=>Ke(h),options:[{value:"All",label:"All"},{value:"Security",label:"Security"},{value:"Billing",label:"Billing"},{value:"System",label:"System"},...t.map(h=>({value:h,label:h}))]})}),e.jsxs("div",{className:"md:col-span-12 flex flex-wrap items-center justify-between gap-2",children:[e.jsxs("div",{className:"text-xs text-slate-500",children:["Filtered audit entries: ",e.jsx("span",{className:"font-semibold text-slate-900",children:V.length})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Rt,{variant:"outline",onClick:()=>{Re("All"),xe("All"),de("All"),Ke("All"),pe(""),l({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(vn,{className:"h-4 w-4"})," Reset"]}),e.jsxs(Rt,{variant:"outline",onClick:()=>ze(!0),children:[e.jsx(zi,{className:"h-4 w-4"})," Forensic export"]})]})]})]})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[i==="overview"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs(Bs,{title:"Security posture",subtitle:"Core controls plus premium compliance.",right:e.jsx(rt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-4",children:[e.jsx(N,{title:"Audit",value:`${O}`,sub:"Today",icon:e.jsx(kt,{className:"h-5 w-5"}),tone:"neutral"}),e.jsx(N,{title:"MFA coverage",value:`${X.mfa}%`,sub:"Privileged roles",icon:e.jsx(Su,{className:"h-5 w-5"}),tone:X.mfa>=100?"good":"warn"}),e.jsx(N,{title:"Device trust",value:`${X.trustPct}%`,sub:"Trusted devices",icon:e.jsx(og,{className:"h-5 w-5"}),tone:X.trustPct>=70?"good":"warn"}),e.jsx(N,{title:"Compliance",value:`${E.length}`,sub:"Docs needing action",icon:e.jsx(yt,{className:"h-5 w-5"}),tone:E.length?"warn":"good"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs(Bs,{title:"Latest audit events",subtitle:"Recent security and compliance activity",right:e.jsx(rt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"space-y-2",children:[V.slice(0,6).map(h=>e.jsx("button",{type:"button",className:"w-full rounded-3xl border border-slate-200 bg-white p-4 text-left hover:bg-slate-50",onClick:()=>U(h.id),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(rt,{label:h.severity,tone:wb(h.severity)}),e.jsx(rt,{label:h.env,tone:h.env==="Sandbox"?"info":"neutral"}),e.jsx(rt,{label:h.role,tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:h.summary}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[mo(h.ts),"  ",h.event,"  ",h.targetId]})]}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]})},h.id)),V.length?null:e.jsx(Gr,{title:"No audit data",subtitle:"No events found."})]}),e.jsx("div",{className:"mt-3",children:e.jsxs(Rt,{variant:"outline",className:"w-full",onClick:()=>o("audit"),children:[" ",e.jsx(et,{className:"h-4 w-4"})," Open audit logs"]})})]}),e.jsxs(Bs,{title:"Risk hotspots",subtitle:"Premium: dual control and expiring docs",right:e.jsx(rt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Dual control pending"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Sensitive actions awaiting approvals"})]}),e.jsx(rt,{label:`${u}`,tone:u?"warn":"good"})]}),e.jsx("div",{className:"mt-3",children:e.jsxs(Rt,{variant:"outline",className:"w-full",onClick:()=>o("dual"),children:[" ",e.jsx(et,{className:"h-4 w-4"})," Review requests"]})})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Vendor docs"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Expiring or expired"})]}),e.jsx(rt,{label:`${E.length}`,tone:E.length?"warn":"good"})]}),e.jsx("div",{className:"mt-3",children:e.jsxs(Rt,{variant:"outline",className:"w-full",onClick:()=>o("compliance"),children:[" ",e.jsx(et,{className:"h-4 w-4"})," Open compliance"]})})]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: dual control policies prevent accidental irreversible changes."})]})]})]})}),e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(Bs,{title:"Quick actions",subtitle:"Common security operations",right:e.jsx(rt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs(Rt,{variant:"outline",onClick:()=>o("mfa"),children:[" ",e.jsx(Su,{className:"h-4 w-4"})," MFA policies"]}),e.jsxs(Rt,{variant:"outline",onClick:()=>o("retention"),children:[" ",e.jsx(zi,{className:"h-4 w-4"})," Data retention"]}),e.jsxs(Rt,{variant:"outline",onClick:()=>o("support"),children:[" ",e.jsx(yt,{className:"h-4 w-4"})," Support mode"]}),e.jsxs(Rt,{variant:"primary",onClick:()=>ze(!0),children:[" ",e.jsx(zi,{className:"h-4 w-4"})," Forensic export"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Tip: use Forensic exports only for investigations and keep dual control enabled."})]}),e.jsxs(Bs,{title:"Retention snapshot",subtitle:"Top retention rules",right:e.jsx(rt,{label:"Core",tone:"neutral"}),children:[e.jsx("div",{className:"space-y-2",children:y.slice(0,5).map(h=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:h.category}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[h.retentionDays," days  ",h.purgeMode]})]}),e.jsx(rt,{label:h.legalHold?"Legal hold":"Normal",tone:h.legalHold?"warn":"neutral"})]})},h.id))}),e.jsx("div",{className:"mt-3",children:e.jsxs(Rt,{variant:"outline",className:"w-full",onClick:()=>o("retention"),children:[" ",e.jsx(et,{className:"h-4 w-4"})," Manage retention"]})})]})]})]}):null,i==="audit"?e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsxs(Bs,{title:"Audit logs",subtitle:"Core: every action is logged. Premium: forensic exports and immutable verification.",right:e.jsx(rt,{label:`${V.length}`,tone:"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Severity"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Event"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Target"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Module"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Action"})]})}),e.jsxs("tbody",{children:[V.slice(0,60).map(h=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:uo(h.ts)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(rt,{label:h.severity,tone:wb(h.severity)})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:h.actor}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[h.role,"  ",h.env]})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:h.event}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[h.targetType,"  ",h.targetId]}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[h.module,h.marketplace!=="-"?`  ${h.marketplace}`:""]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(Rt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>U(h.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]})})]},h.id)),V.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10",children:e.jsx(Gr,{title:"No events",subtitle:"No audit events match your filters."})})})]})]})}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Rt,{variant:"outline",onClick:re,children:[e.jsx(pt,{className:"h-4 w-4"})," Export CSV"]}),e.jsxs(Rt,{variant:"outline",onClick:D,children:[e.jsx(pt,{className:"h-4 w-4"})," Export JSON"]}),e.jsxs(Rt,{variant:"primary",onClick:()=>ze(!0),children:[e.jsx(zi,{className:"h-4 w-4"})," Forensic export"]})]})]})}):null,i==="mfa"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-5 space-y-4",children:[e.jsxs(Bs,{title:"MFA policies",subtitle:"Core: MFA policies and device trust",right:e.jsx(rt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx(fi,{enabled:c.requireMfaOrgAdmin,onChange:h=>x(K=>({...K,requireMfaOrgAdmin:h})),label:"Require MFA for Org Admin",description:"Strongly recommended"}),e.jsx(fi,{enabled:c.requireMfaFinance,onChange:h=>x(K=>({...K,requireMfaFinance:h})),label:"Require MFA for Finance",description:"Recommended"}),e.jsx(fi,{enabled:c.requireMfaApprover,onChange:h=>x(K=>({...K,requireMfaApprover:h})),label:"Require MFA for Approver",description:"Recommended"}),e.jsx(fi,{enabled:c.requireMfaSupport,onChange:h=>x(K=>({...K,requireMfaSupport:h})),label:"Require MFA for EVzone Support",description:"Required for support mode"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(bC,{label:"Trust device days",value:c.trustDeviceDays,onChange:h=>x(K=>({...K,trustDeviceDays:vC(h,1,180)})),hint:"1-180"}),e.jsx(Vh,{label:"IP allowlist",value:c.ipAllowlist,onChange:h=>x(K=>({...K,ipAllowlist:h})),placeholder:"Optional",hint:"CIDR"}),e.jsxs("div",{className:"md:col-span-2 grid grid-cols-1 gap-3",children:[e.jsx(fi,{enabled:c.requireStepUpNewDevice,onChange:h=>x(K=>({...K,requireStepUpNewDevice:h})),label:"Step-up on new device",description:"Force MFA on new device sign-in"}),e.jsx(fi,{enabled:c.requireStepUpSensitive,onChange:h=>x(K=>({...K,requireStepUpSensitive:h})),label:"Step-up on sensitive actions",description:"Extra challenge for retention, keys, exports"})]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Rt,{variant:"primary",onClick:f,children:[e.jsx(ct,{className:"h-4 w-4"})," Save policy"]}),e.jsxs(Rt,{variant:"outline",onClick:()=>l({title:"Break-glass",message:"Break-glass controls live in admin security console (demo).",kind:"info"}),children:[e.jsx(ia,{className:"h-4 w-4"})," Break-glass"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: conditional access policies like geo allowlist, time restrictions, and tamper alerts."})]}),e.jsx(Bs,{title:"Login history",subtitle:"Security events",right:e.jsx(rt,{label:`${G.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[G.slice(0,6).map(h=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(rt,{label:h.outcome,tone:h.outcome==="Success"?"good":h.outcome==="Blocked"?"bad":"warn"}),e.jsx(rt,{label:h.role,tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:h.user}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[uo(h.at),"  ",h.geo,"  ",h.ip]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:[h.device,"  ",h.note]})]}),e.jsx(Dn,{className:"h-5 w-5 text-slate-400"})]})},h.id)),G.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No login events."})]})})]}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs(Bs,{title:"Device trust",subtitle:"Trusted devices and session controls",right:e.jsx(rt,{label:"Core",tone:"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"User"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Device"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Last seen"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Risk"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[te.map(h=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:h.user}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[h.role,"  ",h.geoLast]})]}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-700",children:[h.deviceType==="Phone"?e.jsx(ww,{className:"h-4 w-4"}):h.deviceType==="Laptop"?e.jsx(og,{className:"h-4 w-4"}):e.jsx(tu,{className:"h-4 w-4"}),h.device]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:h.ipLast})]}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx(rt,{label:h.status,tone:h.status==="Trusted"?"good":h.status==="Revoked"?"bad":"neutral"}),h.trustedUntil?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Until ",uo(h.trustedUntil)]}):null]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:mo(h.lastSeenAt)}),e.jsxs("td",{className:"px-4 py-3",children:[h.riskSignals.length?e.jsx(rt,{label:h.riskSignals[0],tone:"warn"}):e.jsx(rt,{label:"None",tone:"good"}),h.riskSignals.length>1?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["+",h.riskSignals.length-1," more"]}):null]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Rt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{l({title:"Signed out",message:"Forced sign-out executed (demo).",kind:"info"}),ne({env:"Production",severity:"Warning",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Auth.Device.Revoked",targetType:"session",targetId:h.id,summary:"Forced sign-out",metadata:{deviceId:h.id}})},disabled:h.status==="Revoked",children:[e.jsx(ia,{className:"h-4 w-4"})," Sign out"]}),e.jsxs(Rt,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>m(h.id),disabled:h.status==="Revoked",children:[e.jsx(as,{className:"h-4 w-4"})," Revoke"]})]})})]},h.id)),te.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-10",children:e.jsx(Gr,{title:"No devices",subtitle:"No device trust records found."})})})]})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: conditional access includes geo allowlist, impossible travel checks, and tamper alert exports."})]})})]}):null,i==="retention"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(Bs,{title:"Retention settings",subtitle:"Core: data retention settings",right:e.jsx(rt,{label:"Core",tone:"neutral"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:"Retention applies per category. Legal hold prevents deletion. Use archive for audit grade categories."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Rt,{variant:"primary",onClick:S,children:[e.jsx(ct,{className:"h-4 w-4"})," Apply"]}),e.jsxs(Rt,{variant:"outline",onClick:()=>{const h=y.reduce((K,_)=>K+Math.round(2e3/Math.max(30,_.retentionDays)),0);l({title:"Preview",message:`Estimated purge impact: ${bB(h)} records.`,kind:"info"})},children:[e.jsx(pa,{className:"h-4 w-4"})," Preview purge"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: forensic exports are tamper-evident and suitable for investigations."})]}),e.jsx(Bs,{title:"Legal hold",subtitle:"Prevent deletion",right:e.jsx(rt,{label:"Core",tone:"neutral"}),children:e.jsx("div",{className:"space-y-2",children:y.filter(h=>h.legalHold).length?y.filter(h=>h.legalHold).map(h=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:h.category}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Hold active"})]}),e.jsx(rt,{label:"Legal hold",tone:"warn"})]})},h.id)):e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No legal holds enabled."})})})]}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsxs(Bs,{title:"Retention rules",subtitle:"Edit days, legal hold, and purge mode",right:e.jsx(rt,{label:`${y.length}`,tone:"neutral"}),children:[e.jsxs("div",{className:"space-y-2",children:[y.map(h=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:h.category}),e.jsx(rt,{label:h.purgeMode,tone:"neutral"}),e.jsx(rt,{label:h.legalHold?"Legal hold":"Normal",tone:h.legalHold?"warn":"neutral"}),e.jsx(rt,{label:h.id,tone:"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Last purge: ",h.lastPurgeAt?uo(h.lastPurgeAt):"Never"]}),h.notes?e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:h.notes}):null]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-3",children:[e.jsx(bC,{label:"Days",value:h.retentionDays,onChange:K=>$(_=>_.map(ke=>ke.id===h.id?{...ke,retentionDays:vC(K,1,3650)}:ke)),hint:"1-3650"}),e.jsx(Cn,{label:"Mode",value:h.purgeMode,onChange:K=>$(_=>_.map(ke=>ke.id===h.id?{...ke,purgeMode:K}:ke)),options:[{value:"Soft delete",label:"Soft delete"},{value:"Hard delete",label:"Hard delete"},{value:"Archive",label:"Archive"}]}),e.jsx("div",{className:"mt-6",children:e.jsx(fi,{enabled:h.legalHold,onChange:K=>$(_=>_.map(ke=>ke.id===h.id?{...ke,legalHold:K}:ke)),label:"Hold",description:""})})]})]})},h.id)),y.length?null:e.jsx(Gr,{title:"No rules",subtitle:"No retention rules configured."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Core: retention settings. Premium: dual control for changes and tamper-evident forensic exports."})]})})]}):null,i==="support"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsxs(Bs,{title:"Support mode",subtitle:"Core: support mode gating, no silent actions",right:e.jsx(rt,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"EVzone Support access"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Role-gated support sign-in. Writes require approvals."})]}),e.jsx(rt,{label:j?"Enabled":"Disabled",tone:j?"good":"warn"})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:["Rules:",e.jsxs("ul",{className:"mt-2 space-y-1",children:[e.jsx("li",{children:"1) View-only by default"}),e.jsx("li",{children:"2) No silent actions"}),e.jsx("li",{children:"3) Step-up authentication for sensitive actions"}),e.jsx("li",{children:"4) Always audited and visible to org admins"})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs(Rt,{variant:"primary",onClick:()=>v("enable"),disabled:j,children:[e.jsx(yt,{className:"h-4 w-4"})," Enable"]}),e.jsxs(Rt,{variant:"danger",onClick:()=>v("disable"),disabled:!j,children:[e.jsx(yt,{className:"h-4 w-4"})," Disable"]})]})]}),e.jsx(Bs,{title:"Support sessions",subtitle:"Active and recent",right:e.jsx(rt,{label:`${R.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[R.map(h=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(rt,{label:h.env,tone:h.env==="Sandbox"?"info":"neutral"}),e.jsx(rt,{label:h.endedAt?"Closed":"Active",tone:h.endedAt?"neutral":"info"}),e.jsx(rt,{label:h.writeEnabled?"Write enabled":"View only",tone:h.writeEnabled?"warn":"neutral"}),e.jsx(rt,{label:h.id,tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:h.agent}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Started ",mo(h.startedAt),"  Reason: ",h.reason]}),h.writeRequests.length?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Write requests: ",h.writeRequests.join(", ")]}):null]}),h.endedAt?null:e.jsxs(Rt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{F(K=>K.map(_=>_.id===h.id?{..._,endedAt:Date.now()}:_)),ne({env:h.env,severity:"Info",actor:n,role:n,ip:"-",device:"-",module:"System",marketplace:"-",event:"Support.Session.End",targetType:"support_session",targetId:h.id,summary:"Support session ended",metadata:{}}),l({title:"Closed",message:"Session ended.",kind:"success"})},children:[e.jsx(Qe,{className:"h-4 w-4"})," End"]})]})},h.id)),R.length?null:e.jsx(Gr,{title:"No sessions",subtitle:"No support sessions."})]})})]})}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs(Bs,{title:"Support write requests",subtitle:"Premium: dual control gating",right:e.jsx(rt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"space-y-2",children:[W.filter(h=>h.actionKey==="support_write_action").map(h=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(rt,{label:h.env,tone:h.env==="Sandbox"?"info":"neutral"}),e.jsx(rt,{label:h.status,tone:h.status==="Approved"?"good":h.status==="Rejected"?"bad":"warn"}),e.jsx(rt,{label:h.id,tone:"neutral"}),e.jsx(rt,{label:`${h.approvals.length}/${h.required} approvals`,tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:h.reason}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Requested ",mo(h.createdAt)," by ",h.requestedBy]}),h.approvals.length?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Approvals: ",h.approvals.map(K=>`${K.by}`).join(", ")]}):e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"No approvals yet."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Rt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>me(h.id),disabled:n==="EVzone Support"||h.status!=="Pending",title:n==="EVzone Support"?"Support cannot approve":"Approve",children:[e.jsx(tt,{className:"h-4 w-4"})," Approve"]}),e.jsxs(Rt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Xe(h.id),disabled:n==="EVzone Support"||h.status!=="Pending",children:[e.jsx(Qe,{className:"h-4 w-4"})," Reject"]})]})]})},h.id)),W.filter(h=>h.actionKey==="support_write_action").length?null:e.jsx(Gr,{title:"No requests",subtitle:"No support write requests."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Support mode gating: EVzone Support cannot silently change anything. Every write action must be requested and approved."})]})})]}):null,i==="dual"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-5 space-y-4",children:[e.jsx(Bs,{title:"Dual control policies",subtitle:"Premium: two-person control for sensitive actions",right:e.jsx(rt,{label:"Premium",tone:"info"}),children:e.jsx("div",{className:"space-y-2",children:T.map(h=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:h.title}),e.jsx(rt,{label:h.enabled?"Enabled":"Disabled",tone:h.enabled?"good":"neutral"}),e.jsx(rt,{label:`${h.approversRequired} approver(s)`,tone:"neutral"}),h.stepUpMfaRequired?e.jsx(rt,{label:"Step-up MFA",tone:"info"}):e.jsx(rt,{label:"No step-up",tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:h.notes}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(fi,{enabled:h.enabled,onChange:K=>{C(_=>_.map(ke=>ke.id===h.id?{...ke,enabled:K}:ke)),ne({env:"Production",severity:"Info",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Policy.DualControl.Updated",targetType:"dual_control_policy",targetId:h.id,summary:"Dual control policy updated",metadata:{actionKey:h.actionKey,enabled:K}}),l({title:"Updated",message:"Policy updated.",kind:"success"})},label:"Enabled"}),e.jsx(Cn,{label:"Approvers",value:`${h.approversRequired}`,onChange:K=>{const _=Number(K)||2;C(ke=>ke.map(I=>I.id===h.id?{...I,approversRequired:_}:I))},options:[{value:"2",label:"2"},{value:"3",label:"3"}]})]})]}),e.jsx(yt,{className:"h-5 w-5 text-slate-400"})]})},h.id))})}),e.jsx(Bs,{title:"Simulation",subtitle:"See what a sensitive action would require",right:e.jsx(rt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Scenario"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx(Cn,{label:"Action",value:"forensic_export_prod",onChange:()=>{},options:[{value:"forensic_export_prod",label:"Forensic export (production)"},{value:"retention_change",label:"Change retention"},{value:"mfa_policy_change",label:"Change MFA policy"},{value:"support_write_action",label:"Support write action"},{value:"rotate_prod_key",label:"Rotate production keys"}],disabled:!0}),e.jsx(Cn,{label:"Environment",value:"Production",onChange:()=>{},options:[{value:"Production",label:"Production"}],disabled:!0})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"With dual control enabled: two approvals and step-up MFA are required before export."})]})})]}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsx(Bs,{title:"Requests",subtitle:"Approve or reject",right:e.jsx(rt,{label:`${W.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[W.map(h=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(rt,{label:h.env,tone:h.env==="Sandbox"?"info":"neutral"}),e.jsx(rt,{label:h.status,tone:h.status==="Approved"?"good":h.status==="Rejected"?"bad":"warn"}),e.jsx(rt,{label:h.actionKey,tone:"neutral"}),e.jsx(rt,{label:`${h.approvals.length}/${h.required} approvals`,tone:"neutral"}),e.jsx(rt,{label:h.id,tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:h.reason}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Requested ",mo(h.createdAt)," by ",h.requestedBy]}),h.approvals.length?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Approvals: ",h.approvals.map(K=>`${K.by}`).join(", ")]}):e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"No approvals yet."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Rt,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>me(h.id),disabled:n==="EVzone Support"||h.status!=="Pending",children:[e.jsx(tt,{className:"h-4 w-4"})," Approve"]}),e.jsxs(Rt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Xe(h.id),disabled:n==="EVzone Support"||h.status!=="Pending",children:[e.jsx(Qe,{className:"h-4 w-4"})," Reject"]})]})]})},h.id)),W.length?null:e.jsx(Gr,{title:"No requests",subtitle:"No dual control requests."})]})})})]}):null,i==="forensics"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsxs(Bs,{title:"Forensic exports",subtitle:"Premium: tamper-evident exports",right:e.jsx(rt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:"Forensic exports create a hash chain over selected audit entries. Verification recomputes the chain."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2",children:[e.jsxs(Rt,{variant:"primary",onClick:()=>ze(!0),children:[e.jsx(zi,{className:"h-4 w-4"})," New forensic export"]}),e.jsxs(Rt,{variant:"outline",onClick:()=>l({title:"Tip",message:"Keep dual control enabled for production exports.",kind:"info"}),children:[e.jsx(en,{className:"h-4 w-4"})," Tip"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: forensic exports can be used for investigations and compliance audits."})]})}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsx(Bs,{title:"Export jobs",subtitle:"Create, download, verify",right:e.jsx(rt,{label:`${q.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[q.map(h=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(rt,{label:h.env,tone:h.env==="Sandbox"?"info":"neutral"}),e.jsx(rt,{label:h.status,tone:h.status==="Ready"?"good":"bad"}),e.jsx(rt,{label:h.algo,tone:"neutral"}),typeof h.verifiedOk=="boolean"?e.jsx(rt,{label:h.verifiedOk?"Verified":"Mismatch",tone:h.verifiedOk?"good":"bad"}):e.jsx(rt,{label:"Not verified",tone:"neutral"}),e.jsx(rt,{label:h.id,tone:"neutral"})]}),e.jsxs("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:[h.rangeLabel,"  ",h.recordCount," record(s)"]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",mo(h.createdAt)," by ",h.createdBy]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Final hash: ",e.jsxs("span",{className:"font-mono",children:[h.finalHash.slice(0,10),""]})]}),h.verifiedAt?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Verified ",mo(h.verifiedAt)]}):null]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Rt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>ae(h.id),children:[e.jsx(pt,{className:"h-4 w-4"})," Download"]}),e.jsxs(Rt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>M(h.id),children:[e.jsx(tt,{className:"h-4 w-4"})," Verify"]})]})]})},h.id)),q.length?null:e.jsx(Gr,{title:"No forensic exports",subtitle:"Create a forensic export to start."})]})})})]}):null,i==="compliance"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-5 space-y-4",children:[e.jsxs(Bs,{title:"Compliance center",subtitle:"Premium: attestations and vendor docs",right:e.jsx(rt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:"Keep policy attestations current and vendor compliance documents valid."}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2",children:[e.jsxs(Rt,{variant:"primary",onClick:()=>{Ye({vendor:"",docType:"License",fileName:"",expiryDate:"",verified:!1,notes:""}),Ae(!0)},children:[e.jsx(gt,{className:"h-4 w-4"})," Add vendor doc"]}),e.jsxs(Rt,{variant:"outline",onClick:()=>{var h;ue({attId:((h=_e[0])==null?void 0:h.id)||"ATT-001",confirm:!1,note:""}),w(!0)},children:[e.jsx(ct,{className:"h-4 w-4"})," Attest policy"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: store evidence attachments and expiry alerts in Notifications Center."})]}),e.jsx(Bs,{title:"Policy attestations",subtitle:"Track completion by role",right:e.jsx(rt,{label:`${_e.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[_e.map(h=>{const K=h.requiredForRoles.includes(n),_=h.completion.some(I=>I.user===n),ke=h.dueBy?h.dueBy<Date.now()+7*24*60*60*1e3:!1;return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:h.policyName}),e.jsx(rt,{label:h.version,tone:"neutral"}),K?e.jsx(rt,{label:"Required",tone:"warn"}):e.jsx(rt,{label:"Optional",tone:"neutral"}),_?e.jsx(rt,{label:"Done",tone:"good"}):e.jsx(rt,{label:"Pending",tone:K?"warn":"neutral"}),ke?e.jsx(rt,{label:"Due soon",tone:"warn"}):null]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Updated ",mo(h.lastUpdatedAt),"  Completed ",h.completion.length]}),h.dueBy?e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Due by ",uo(h.dueBy)]}):null]}),e.jsxs(Rt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{ue({attId:h.id,confirm:!1,note:""}),w(!0)},disabled:_,children:[e.jsx(ct,{className:"h-4 w-4"})," Attest"]})]})},h.id)}),_e.length?null:e.jsx(Gr,{title:"No policies",subtitle:"No attestations configured."})]})})]}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs(Bs,{title:"Vendor compliance docs",subtitle:"Licenses, insurance, and more",right:e.jsx(rt,{label:`${be.length}`,tone:"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Doc"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Expiry"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Verified"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[be.map(h=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:h.vendor}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:h.id})]}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[h.docType,"  ",h.fileName]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(rt,{label:h.status,tone:jB(h.status)})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:h.expiryDate?uo(h.expiryDate):"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(rt,{label:h.verified?"Yes":"No",tone:h.verified?"good":"warn"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Rt,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Fe(K=>K.map(_=>_.id===h.id?{..._,verified:!_.verified,uploadedAt:Date.now(),uploadedBy:n}:_)),l({title:"Updated",message:"Verification updated.",kind:"success"}),ne({env:"Production",severity:"Info",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Compliance.VendorDoc.Updated",targetType:"vendor_doc",targetId:h.id,summary:"Vendor doc verification updated",metadata:{verified:!h.verified}})},children:[e.jsx(tt,{className:"h-4 w-4"})," Toggle verify"]}),e.jsxs(Rt,{variant:"danger",className:"px-3 py-2 text-xs",onClick:()=>{Fe(K=>K.filter(_=>_.id!==h.id)),l({title:"Deleted",message:"Doc removed.",kind:"info"}),ne({env:"Production",severity:"Warning",actor:n,role:n,ip:"-",device:"-",module:"Security",marketplace:"-",event:"Compliance.VendorDoc.Updated",targetType:"vendor_doc",targetId:h.id,summary:"Vendor doc deleted",metadata:{}})},children:[e.jsx(as,{className:"h-4 w-4"})," Remove"]})]})})]},h.id)),be.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-10",children:e.jsx(Gr,{title:"No docs",subtitle:"Add a vendor compliance doc."})})})]})]})}),ve?e.jsxs("div",{className:"mt-3 rounded-2xl bg-rose-50 p-3 text-xs text-rose-800 ring-1 ring-rose-200",children:["Attention: ",ve," vendor doc(s) are missing or expired."]}):e.jsx("div",{className:"mt-3 rounded-2xl bg-emerald-50 p-3 text-xs text-emerald-900 ring-1 ring-emerald-200",children:"All critical vendor docs look healthy."})]})})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"Z Security, Audit and Compliance v2. Core: audit logs, MFA policies, device trust, retention, support gating. Premium: dual-control policies, tamper-evident forensic exports, and compliance center."})})]})}),e.jsx(yB,{open:Le,title:ie?`Audit ${ie.id}`:"Audit",subtitle:ie?`${ie.event}  ${uo(ie.ts)}`:"Details",onClose:()=>Ne(!1),footer:ie?e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Core: every action logged. Premium: forensic exports for investigations."}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Rt,{variant:"outline",onClick:async()=>{if(ie)try{await navigator.clipboard.writeText(JSON.stringify(ie,null,2)),l({title:"Copied",message:"Audit JSON copied.",kind:"success"})}catch{l({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},children:[e.jsx(ss,{className:"h-4 w-4"})," Copy JSON"]}),e.jsxs(Rt,{variant:"primary",onClick:()=>ze(!0),children:[e.jsx(zi,{className:"h-4 w-4"})," Forensic export"]})]})]}):null,children:ie?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(rt,{label:ie.severity,tone:wb(ie.severity)}),e.jsx(rt,{label:ie.env,tone:ie.env==="Sandbox"?"info":"neutral"}),e.jsx(rt,{label:ie.role,tone:"neutral"}),e.jsx(rt,{label:ie.module,tone:"neutral"}),ie.marketplace!=="-"?e.jsx(rt,{label:ie.marketplace,tone:"neutral"}):null]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:ie.summary}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Actor: ",ie.actor,"  IP ",ie.ip,"  Device ",ie.device]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Target: ",ie.targetType,"  ",ie.targetId]})]}),e.jsx(Bs,{title:"Metadata",subtitle:"Raw payload",right:e.jsx(rt,{label:"Core",tone:"neutral"}),children:e.jsx("pre",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-800 overflow-auto",children:JSON.stringify(ie.metadata,null,2)})}),ie.diff?e.jsx(Bs,{title:"Diff",subtitle:"Before and after",right:e.jsx(rt,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx("pre",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-800 overflow-auto",children:JSON.stringify(ie.diff.before,null,2)}),e.jsx("pre",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3 text-xs text-slate-800 overflow-auto",children:JSON.stringify(ie.diff.after,null,2)})]})}):null,e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Audit is linked to approvals and support actions. No silent actions are permitted."})]}):null}),e.jsxs(Bh,{open:Oe!==null,title:Oe==="enable"?"Enable support mode":"Disable support mode",subtitle:"Reason is required and always audited.",onClose:()=>Se(null),actions:[{label:"Confirm",onClick:k,variant:Oe==="disable"?"danger":"default"}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Rt,{variant:"outline",onClick:()=>Se(null),children:"Cancel"}),e.jsxs(Rt,{variant:Oe==="disable"?"danger":"primary",onClick:k,children:[e.jsx(yt,{className:"h-4 w-4"})," Confirm"]})]}),children:[e.jsx(_h,{label:"Reason",value:Te,onChange:Ge,placeholder:"Example: troubleshooting billing delivery",rows:4}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"If dual control is enabled, disabling support requires approvals."})]}),e.jsx(Bh,{open:We,title:"Create forensic export",subtitle:"Premium: tamper-evident export of audit logs.",onClose:()=>ze(!1),actions:[{label:"Generate",onClick:p}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Rt,{variant:"outline",onClick:()=>ze(!1),children:"Cancel"}),e.jsxs(Rt,{variant:"primary",onClick:p,children:[e.jsx(zi,{className:"h-4 w-4"})," Generate"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Cn,{label:"Environment",value:Ue.env,onChange:h=>le(K=>({...K,env:h})),options:[{value:"Production",label:"Production"},{value:"Sandbox",label:"Sandbox"}],hint:"Production may require approvals"}),e.jsx(Cn,{label:"Range",value:Ue.range,onChange:h=>le(K=>({...K,range:h})),options:[{value:"Last 7 days",label:"Last 7 days"},{value:"Last 30 days",label:"Last 30 days"},{value:"Custom",label:"Custom"}]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(_h,{label:"Reason",value:Ue.reason,onChange:h=>le(K=>({...K,reason:h})),placeholder:"Required for production exports",rows:4,hint:"Audit logged"})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Forensic export bundles include a manifest and a hash chain. Verification recomputes the chain."})]})}),e.jsx(Bh,{open:z,title:"Add vendor compliance doc",subtitle:"Premium: store evidence and track expiry.",onClose:()=>Ae(!1),actions:[{label:"Save",onClick:ee}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Rt,{variant:"outline",onClick:()=>Ae(!1),children:"Cancel"}),e.jsxs(Rt,{variant:"primary",onClick:ee,children:[e.jsx(ct,{className:"h-4 w-4"})," Save"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(Vh,{label:"Vendor",value:Ve.vendor,onChange:h=>Ye(K=>({...K,vendor:h})),placeholder:"Vendor name"}),e.jsx(Cn,{label:"Doc type",value:Ve.docType,onChange:h=>Ye(K=>({...K,docType:h})),options:[{value:"License",label:"License"},{value:"Insurance",label:"Insurance"},{value:"Tax",label:"Tax"},{value:"Safety",label:"Safety"},{value:"Other",label:"Other"}]}),e.jsx(Vh,{label:"File name",value:Ve.fileName,onChange:h=>Ye(K=>({...K,fileName:h})),placeholder:"doc.pdf",hint:"Simulated"}),e.jsx(Vh,{label:"Expiry",type:"date",value:Ve.expiryDate,onChange:h=>Ye(K=>({...K,expiryDate:h})),hint:"Optional"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(fi,{enabled:Ve.verified,onChange:h=>Ye(K=>({...K,verified:h})),label:"Verified",description:"Mark as verified after review"})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(_h,{label:"Notes",value:Ve.notes,onChange:h=>Ye(K=>({...K,notes:h})),placeholder:"Optional",rows:4})})]})}),e.jsx(Bh,{open:Be,title:"Policy attestation",subtitle:"Premium: policy attestations are auditable.",onClose:()=>w(!1),actions:[{label:"Attest",onClick:b}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",children:[e.jsx(Rt,{variant:"outline",onClick:()=>w(!1),children:"Cancel"}),e.jsxs(Rt,{variant:"primary",onClick:b,children:[e.jsx(ct,{className:"h-4 w-4"})," Attest"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx(Cn,{label:"Policy",value:B.attId,onChange:h=>ue(K=>({...K,attId:h})),options:_e.map(h=>({value:h.id,label:`${h.policyName} (${h.version})`}))}),e.jsxs("label",{className:"flex items-start gap-3 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("input",{type:"checkbox",className:"mt-1 h-4 w-4 rounded border-slate-300",checked:B.confirm,onChange:h=>ue(K=>({...K,confirm:h.target.checked}))}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Confirm"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"I have read and agree to follow this policy."})]})]}),e.jsx(_h,{label:"Note",value:B.note,onChange:h=>ue(K=>({...K,note:h})),placeholder:"Optional",rows:3})]})})]});function N({title:h,value:K,sub:_,icon:ke,tone:I}){const Z=I==="good"?"bg-emerald-50 text-emerald-700":I==="warn"?"bg-amber-50 text-amber-800":I==="bad"?"bg-rose-50 text-rose-700":I==="info"?"bg-blue-50 text-blue-700":"bg-slate-50 text-slate-700";return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:h}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:K}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:_})]}),e.jsx("div",{className:tn("grid h-10 w-10 place-items-center rounded-2xl",Z),children:ke})]})})}}const jg={green:"#03CD8C",orange:"#F77F00"};function bn(...t){return t.filter(Boolean).join(" ")}function za(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function Dm(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function fd(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function jt({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:bn("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function kB(t){return t==="Critical"?"bad":t==="Warning"?"warn":"info"}function NC(t){return t==="Critical"?"bad":t==="High"?"warn":t==="Medium"?"info":"neutral"}function CB(t){return t==="Major Outage"?"bad":t==="Partial Outage"?"warn":t==="Degraded"?"info":"neutral"}function Ps({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:jg.green}:t==="accent"?{background:jg.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:bn(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function Rc({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:bn("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:bn("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function wC({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:bn(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:bn("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function vd({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:bn(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:bn("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function qh({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4,disabled:i}){return e.jsxs("div",{className:bn(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:o=>a(o.target.value),placeholder:l,rows:r,disabled:i,className:bn("mt-2 w-full rounded-2xl border p-3 text-sm font-semibold shadow-sm outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function SB({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:bn("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function kb({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="980px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:12,scale:.985},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:12,scale:.985},transition:{duration:.18},className:"fixed inset-x-0 top-[7vh] z-50 mx-auto w-[min(1040px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(SB,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[72vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function kC({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r}){return d.useEffect(()=>{const i=o=>o.key==="Escape"&&n();return t&&window.addEventListener("keydown",i),()=>window.removeEventListener("keydown",i)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,x:18},animate:{opacity:1,x:0},exit:{opacity:0,x:18},transition:{duration:.18},className:bn("fixed z-50 overflow-hidden border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]","left-2 right-2 bottom-2 top-[10vh] rounded-[28px]","lg:left-auto lg:right-4 lg:top-4 lg:bottom-4 lg:w-[760px]"),role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-base font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"h-full min-h-0 overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function AB({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(480px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:bn("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function Ol({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function Im({title:t,subtitle:s}){return e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(ny,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:s})]})}function EB(){const t=["Billing","Security","Integrations","Rides & Logistics","EVs & Charging","E-Commerce","Finance & Payments","Travel & Tourism","Other"],s=["MyLiveDealz","ServiceMart","EVmart","GadgetMart","LivingMart","StyleMart","EduMart","HealthMart","PropertyMart","GeneratMart","ExpressMart","FaithMart","Other Marketplace"],[a,l]=d.useState([]),n=v=>{const k=za("toast");l(m=>[{id:k,...v},...m].slice(0,4)),window.setTimeout(()=>l(m=>m.filter(S=>S.id!==k)),3200)},[r,i]=d.useState("Org Admin"),o=r==="Org Admin",c=r==="EVzone Support",x=o||c,[j,g]=d.useState(!0),[y,$]=d.useState(!0),[T,C]=d.useState({enabled:!0,allowSupportToToggle:!1,requireOrgApproval:!0,storageDays:30,noticeText:"This support session may be recorded for security, QA, and incident review."}),[W,L]=d.useState(()=>{const v=Date.now();return[{id:"CASE-001",createdAt:v-2*24*60*60*1e3,updatedAt:v-40*60*1e3,createdBy:"Finance Desk",requesterRole:"Finance",title:"Invoice email delivery is delayed",description:"AP email did not receive weekly invoice. Need to confirm delivery logs and retry policy.",module:"Billing",marketplace:"-",priority:"High",status:"In Progress",assignedTo:"EVzone Support",tags:["billing","email","weekly"],attachments:1,watchers:["Org Admin","Finance Desk"],timeline:[{id:za("T"),at:v-2*24*60*60*1e3,by:"Finance Desk",message:"Invoice not received",kind:"customer"},{id:za("T"),at:v-23*60*60*1e3,by:"EVzone Support",message:"Investigating delivery logs and AP routing.",kind:"support"},{id:za("T"),at:v-40*60*1e3,by:"System",message:"Webhook delivery retry observed (502).",kind:"system"}]},{id:"CASE-002",createdAt:v-6*60*60*1e3,updatedAt:v-55*60*1e3,createdBy:"Org Admin",requesterRole:"Org Admin",title:"Need audit export for dispute",description:"Generate a forensic export for last 30 days for compliance review.",module:"Security",marketplace:"-",priority:"Medium",status:"Open",assignedTo:"EVzone Support",tags:["audit","forensic"],attachments:0,watchers:["Org Admin"],timeline:[{id:za("T"),at:v-6*60*60*1e3,by:"Org Admin",message:"Please help generate forensic export",kind:"customer"},{id:za("T"),at:v-55*60*1e3,by:"EVzone Support",message:"Ready to proceed. Require approval for production export.",kind:"support"}]}]}),[R,F]=d.useState(()=>{const v=Date.now();return[{id:"SUP-SESSION-001",startedAt:v-3*60*60*1e3,startedBy:"EVzone Support",orgVisible:!0,bannerEnabled:!0,watermarkEnabled:!0,mode:"View-only",recordingEnabled:!1,recordingApproved:!1,relatedCaseId:"CASE-001",toolsScope:{readOnly:!0,guidedActionsAllowed:!1},actions:[{id:za("A"),at:v-175*60*1e3,by:"EVzone Support",type:"Read-only check",label:"Check invoice delivery logs",outcome:"OK",notes:"Email channel shows delayed queue."},{id:za("A"),at:v-155*60*1e3,by:"EVzone Support",type:"Read-only check",label:"Verify invoice group routing",outcome:"OK",notes:"AP email matches invoice group."},{id:za("A"),at:v-45*60*1e3,by:"EVzone Support",type:"Read-only check",label:"Inspect webhook deliveries",outcome:"Failed",notes:"502 from ERP endpoint, retrying."}]}]}),[te,oe]=d.useState(()=>{const v=Date.now();return[{id:"INC-001",createdAt:v-10*60*60*1e3,createdBy:"EVzone Support",title:"Webhook delivery delays (some orgs)",severity:"Degraded",status:"Monitoring",message:"Some webhook endpoints experiencing intermittent 5xx. Retries in progress.",modules:["Integrations","Billing"],pinned:!0,visibleToOrgAdmins:!0,updates:[{id:za("U"),at:v-10*60*60*1e3,status:"Investigating",message:"We are investigating intermittent 5xx errors.",by:"EVzone Support"},{id:za("U"),at:v-7*60*60*1e3,status:"Identified",message:"Issue identified on edge gateway. Rolling restart.",by:"EVzone Support"},{id:za("U"),at:v-2*60*60*1e3,status:"Monitoring",message:"Recovery in progress; monitoring success rate.",by:"EVzone Support"}]}]}),[G,H]=d.useState(()=>{const v=Date.now();return[{id:"AUD-001",at:v-3*60*60*1e3,severity:"Warning",actor:"EVzone Support",role:"EVzone Support",event:"Support session started",why:"Troubleshoot invoice delivery",metadata:{sessionId:"SUP-SESSION-001",caseId:"CASE-001"}},{id:"AUD-002",at:v-2*60*60*1e3,severity:"Info",actor:"Org Admin",role:"Org Admin",event:"Support mode verified",why:"Org admin visibility",metadata:{supportEnabled:!0,watermark:!0}}]}),Y=[{id:"tool_delivery_logs",label:"Inspect delivery logs",module:"Billing",kind:"Read-only check",risk:"Low",description:"Check invoice delivery status by channel (Email/WhatsApp/WeChat/SMS) and latest attempts."},{id:"tool_invoice_group",label:"Validate invoice group routing",module:"Billing",kind:"Read-only check",risk:"Low",description:"Verify invoice group AP emails, CCs, frequency, and mapping for the selected entity."},{id:"tool_webhook_inspector",label:"Webhook inspector",module:"Integrations",kind:"Read-only check",risk:"Medium",description:"Inspect a delivery payload, signature headers, status, and retry trace."},{id:"tool_resend_invoice",label:"Resend invoice (guided)",module:"Billing",kind:"Guided action",risk:"High",description:"Guided action that requests approval, re-validates recipients, and then re-sends invoice."},{id:"tool_rotate_key",label:"Rotate production API key (guided)",module:"Integrations",kind:"Guided action",risk:"High",description:"Guided rotation using dual-control approval with downtime warning."},{id:"tool_forensic_export",label:"Generate forensic export",module:"Security",kind:"Guided action",risk:"High",description:"Creates a tamper-evident audit export (production requires approval)."}],[we,q]=d.useState("cases"),[je,_e]=d.useState(""),[Ee,be]=d.useState(!1),[Fe,Pe]=d.useState({title:"",description:"",module:"Billing",marketplace:"-",priority:"Medium",tags:[]}),[pe,Q]=d.useState(!1),[Re,ce]=d.useState(null),xe=d.useMemo(()=>Re&&W.find(v=>v.id===Re)||null,[W,Re]),[he,de]=d.useState(!1),[ye,Ke]=d.useState(null),Le=d.useMemo(()=>ye&&R.find(v=>v.id===ye)||null,[R,ye]),[Ne,ge]=d.useState(!1),[$e,ie]=d.useState({title:"",severity:"Info",status:"Investigating",message:"",modules:["Billing"],pinned:!1,visibleToOrgAdmins:!0}),[Oe,Se]=d.useState(!1),[Te,Ge]=d.useState(""),We=d.useMemo(()=>W.filter(v=>v.status!=="Closed").length,[W]),ze=d.useMemo(()=>R.filter(v=>!v.endedAt).length,[R]),Ue=d.useMemo(()=>te.filter(v=>v.pinned&&v.visibleToOrgAdmins).length,[te]),le=d.useMemo(()=>{const v=je.trim().toLowerCase();return W.filter(k=>v?`${k.id} ${k.title} ${k.description} ${k.module} ${k.marketplace} ${k.priority} ${k.status} ${k.tags.join(" ")}`.toLowerCase().includes(v):!0).slice().sort((k,m)=>m.updatedAt-k.updatedAt)},[W,je]),z=d.useMemo(()=>{const v=je.trim().toLowerCase();return R.filter(k=>v?`${k.id} ${k.startedBy} ${k.mode} ${k.relatedCaseId||""}`.toLowerCase().includes(v):!0).slice().sort((k,m)=>(m.endedAt||m.startedAt)-(k.endedAt||k.startedAt))},[R,je]),Ae=d.useMemo(()=>{const v=je.trim().toLowerCase();return te.filter(k=>c||o?!0:k.visibleToOrgAdmins).filter(k=>v?`${k.id} ${k.title} ${k.severity} ${k.status} ${k.message} ${k.modules.join(" ")}`.toLowerCase().includes(v):!0).slice().sort((k,m)=>m.createdAt-k.createdAt)},[te,je,c,o]),Ve=d.useMemo(()=>{const v=je.trim().toLowerCase();return G.filter(k=>v?`${k.id} ${k.actor} ${k.role} ${k.event} ${k.why} ${JSON.stringify(k.metadata)}`.toLowerCase().includes(v):!0).slice().sort((k,m)=>m.at-k.at)},[G,je]),Ye=d.useMemo(()=>{const v=je.trim().toLowerCase();return Y.filter(k=>v?`${k.label} ${k.module} ${k.kind} ${k.risk} ${k.description}`.toLowerCase().includes(v):!0)},[je]),Be=v=>{const k={id:za("AUD"),at:v.at??Date.now(),severity:v.severity,actor:v.actor,role:v.role,event:v.event,why:v.why,metadata:v.metadata};H(m=>[k,...m].slice(0,600))},w=()=>{Pe({title:"",description:"",module:"Billing",marketplace:"-",priority:"Medium",tags:[]}),be(!0)},B=()=>{const v=String(Fe.title||"").trim(),k=String(Fe.description||"").trim();if(v.length<4||k.length<8){n({title:"Missing",message:"Provide a title and description.",kind:"warn"});return}const m=Date.now(),S=za("CASE"),f={id:S,createdAt:m,updatedAt:m,createdBy:c?"EVzone Support":r,requesterRole:r,title:v,description:k,module:Fe.module||"Billing",marketplace:Fe.marketplace||"-",priority:Fe.priority||"Medium",status:"New",assignedTo:"EVzone Support",tags:Array.isArray(Fe.tags)?Fe.tags:[],attachments:0,watchers:["Org Admin"],timeline:[{id:za("T"),at:m,by:r,message:"Case created",kind:"system"}]};L(U=>[f,...U]),Be({severity:"Info",actor:r,role:r,event:"Support case created",why:"Request support",metadata:{caseId:S,module:f.module,priority:f.priority}}),n({title:"Created",message:`Case ${S} created.`,kind:"success"}),be(!1),ce(S),Q(!0)},ue=(v,k,m)=>{const S=k.trim();if(!S)return;const f=Date.now();L(U=>U.map(p=>p.id===v?{...p,updatedAt:f,timeline:[...p.timeline,{id:za("T"),at:f,by:r,message:S,kind:m}],status:p.status==="New"?"Open":p.status}:p)),Be({severity:"Info",actor:r,role:r,event:"Case message added",why:"Case collaboration",metadata:{caseId:v,kind:m}})},ne=v=>{if(!j){n({title:"Blocked",message:"Support mode is disabled by the organization.",kind:"warn"});return}if(!c){n({title:"Support role required",message:"Switch to EVzone Support to start a session.",kind:"info"});return}const k=Date.now(),m={id:za("SUP"),startedAt:k,startedBy:"EVzone Support",orgVisible:!0,bannerEnabled:!0,watermarkEnabled:y,mode:"View-only",recordingEnabled:!1,recordingApproved:!T.requireOrgApproval,relatedCaseId:v,toolsScope:{readOnly:!0,guidedActionsAllowed:!1},actions:[]};F(S=>[m,...S]),Be({severity:"Warning",actor:"EVzone Support",role:"EVzone Support",event:"Support session started",why:"Troubleshooting",metadata:{sessionId:m.id,caseId:v||null,mode:m.mode}}),n({title:"Session started",message:`Session ${m.id} started.`,kind:"success"}),Ke(m.id),de(!0)},Me=v=>{const k=Date.now();F(m=>m.map(S=>S.id===v?{...S,endedAt:k}:S)),Be({severity:"Info",actor:r,role:r,event:"Support session ended",why:"Session closed",metadata:{sessionId:v}}),n({title:"Ended",message:"Session ended.",kind:"info"})},De=v=>{const k=Le;if(!k||k.endedAt){n({title:"No active session",message:"Open an active support session first.",kind:"warn"});return}if(v.kind==="Read-only check"&&!k.toolsScope.readOnly){n({title:"Blocked",message:"Read-only tools are disabled for this session.",kind:"warn"});return}if(v.kind==="Guided action"&&!k.toolsScope.guidedActionsAllowed){n({title:"Approval required",message:"Guided actions are not enabled. Request approval.",kind:"warn"});return}const S=v.risk==="High"?.75:v.risk==="Medium"?.85:.92,f=Math.random()<S,U=f?"OK":"Failed",p=Date.now(),M={id:za("ACT"),at:p,by:r,type:v.kind,label:v.label,outcome:U,notes:v.kind==="Read-only check"?f?"Check completed. No write actions performed.":"Check failed. Review integrations and retry.":f?"Guided action completed with guardrails.":"Guided action failed. Requires manual review."};F(ee=>ee.map(b=>b.id===k.id?{...b,actions:[...b.actions,M]}:b)),Be({severity:v.kind==="Guided action"&&v.risk==="High"?"Warning":"Info",actor:r,role:r,event:"Support tool executed",why:v.kind==="Read-only check"?"Troubleshooting":"Guided remediation",metadata:{sessionId:k.id,tool:v.id,outcome:U}}),n({title:f?"Done":"Failed",message:`${v.label}: ${U}.`,kind:f?"success":"warn"})},fe=v=>{F(k=>k.map(m=>m.id===v?{...m,mode:"Guided actions"}:m)),Be({severity:"Warning",actor:r,role:r,event:"Guided actions requested",why:"Support remediation request",metadata:{sessionId:v,requestedBy:r}}),n({title:"Requested",message:"Guided actions request created (demo).",kind:"info"})},me=v=>{if(!o){n({title:"Org Admin required",message:"Only Org Admin can approve guided actions.",kind:"warn"});return}F(k=>k.map(m=>m.id===v?{...m,toolsScope:{...m.toolsScope,guidedActionsAllowed:!0},mode:"Guided actions"}:m)),Be({severity:"Info",actor:r,role:r,event:"Guided actions approved",why:"Enable remediation",metadata:{sessionId:v}}),n({title:"Approved",message:"Guided actions enabled for this session.",kind:"success"})},Xe=()=>{if(!Le||Le.endedAt){n({title:"No active session",message:"Open an active session first.",kind:"warn"});return}Ge(""),Se(!0)},V=()=>{if(!Le)return;const v=Le;if(!T.enabled){n({title:"Disabled",message:"Recording is disabled by policy.",kind:"warn"}),Se(!1);return}if(c&&!T.allowSupportToToggle){n({title:"Blocked",message:"Support cannot toggle recording. Org Admin must approve.",kind:"warn"}),Se(!1);return}if(T.requireOrgApproval&&!o){n({title:"Approval required",message:"Recording toggle requires Org Admin approval.",kind:"warn"}),Se(!1);return}if(Te.trim().length<8){n({title:"Reason required",message:"Provide a clear reason.",kind:"warn"});return}const k=!v.recordingEnabled;F(m=>m.map(S=>S.id===v.id?{...S,recordingEnabled:k,recordingApproved:!0}:S)),Be({severity:"Warning",actor:r,role:r,event:k?"Session recording enabled":"Session recording disabled",why:"Policy-controlled recording toggle",metadata:{sessionId:v.id,reason:Te.trim(),storageDays:T.storageDays}}),n({title:"Updated",message:k?"Recording enabled.":"Recording disabled.",kind:"success"}),Se(!1)},E=()=>{ie({title:"",severity:"Info",status:"Investigating",message:"",modules:["Billing"],pinned:!1,visibleToOrgAdmins:!0}),ge(!0)},u=()=>{if(!x){n({title:"Blocked",message:"You cannot create incident messages.",kind:"warn"});return}const v=String($e.title||"").trim(),k=String($e.message||"").trim();if(v.length<4||k.length<8){n({title:"Missing",message:"Provide a title and message.",kind:"warn"});return}const m=Date.now(),S={id:za("INC"),createdAt:m,createdBy:r,title:v,severity:$e.severity||"Info",status:$e.status||"Investigating",message:k,modules:$e.modules||["Billing"],pinned:!!$e.pinned,visibleToOrgAdmins:$e.visibleToOrgAdmins!==!1,updates:[{id:za("U"),at:m,status:$e.status||"Investigating",message:k,by:r}]};oe(f=>[S,...f]),Be({severity:"Warning",actor:r,role:r,event:"Incident message created",why:"Org status update",metadata:{incidentId:S.id,severity:S.severity,status:S.status}}),n({title:"Published",message:`Incident ${S.id} published.`,kind:"success"}),ge(!1)},P=()=>{const v={exportedAt:new Date().toISOString(),cases:W,sessions:R,incidents:te,audit:G},k=new Blob([JSON.stringify(v,null,2)],{type:"application/json"}),m=URL.createObjectURL(k),S=document.createElement("a");S.href=m,S.download="corporatepay-support-tools.json",S.click(),URL.revokeObjectURL(m),n({title:"Exported",message:"Downloaded JSON.",kind:"success"})},se=d.useMemo(()=>!Le||Le.endedAt||!Le.bannerEnabled?null:{text:`Support session active (${Le.id}). Mode: ${Le.mode}.`,watermark:y&&Le.watermarkEnabled,recording:Le.recordingEnabled},[Le,y]),D=v=>{if(!o){n({title:"Org Admin required",message:"Only Org Admin can change support enablement.",kind:"warn"});return}g(v),Be({severity:"Warning",actor:r,role:r,event:v?"Support mode enabled":"Support mode disabled",why:"Org policy change",metadata:{supportEnabled:v}}),n({title:"Updated",message:v?"Support enabled.":"Support disabled.",kind:"success"})},re=v=>{if(!o){n({title:"Org Admin required",message:"Only Org Admin can change recording policy.",kind:"warn"});return}C(k=>{const m=v(k);return Be({severity:"Warning",actor:r,role:r,event:"Recording policy updated",why:"Policy change",metadata:m}),m}),n({title:"Saved",message:"Recording policy updated.",kind:"success"})};return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(AB,{toasts:a,onDismiss:v=>l(k=>k.filter(m=>m.id!==v))}),se?e.jsxs("div",{className:"sticky top-0 z-30 border-b border-emerald-200 bg-emerald-50 px-4 py-2",children:[e.jsxs("div",{className:"mx-auto flex max-w-[1400px] flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-emerald-900",children:[e.jsx(yt,{className:"h-4 w-4"}),se.text,se.recording?e.jsx(jt,{label:"Recording",tone:"warn"}):e.jsx(jt,{label:"Not recording",tone:"neutral"}),xe?e.jsx(jt,{label:`Case ${xe.id}`,tone:"info"}):null]}),e.jsx("div",{className:"text-xs text-emerald-900",children:"Visible to org admins. No silent actions."})]}),se.watermark?e.jsx("div",{className:"pointer-events-none fixed inset-0 z-10 grid place-items-center opacity-[0.06]",children:e.jsx("div",{className:"rotate-[-18deg] text-[44px] font-black tracking-tight text-slate-900",children:"SUPPORT SESSION"})}):null]}):null,e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:jg.green},children:e.jsx(mu,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Support and EVzone Admin Tools"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Embedded EVzone support inside the org console with auditable sessions, case tracking, scoped tools, and incident messaging."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(jt,{label:`Cases: ${We}`,tone:We?"info":"neutral"}),e.jsx(jt,{label:`Sessions: ${ze}`,tone:ze?"warn":"neutral"}),e.jsx(jt,{label:`Pinned incidents: ${Ue}`,tone:Ue?"warn":"neutral"}),e.jsx(jt,{label:`Support mode: ${j?"On":"Off"}`,tone:j?"good":"warn"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"min-w-[220px]",children:e.jsx(vd,{label:"View as",value:r,onChange:v=>i(v),options:[{value:"Org Admin",label:"Org Admin"},{value:"Finance",label:"Finance"},{value:"Approver",label:"Approver"},{value:"Employee",label:"Employee"},{value:"EVzone Support",label:"EVzone Support"}],hint:"Role gated"})}),e.jsxs(Ps,{variant:"outline",onClick:P,children:[e.jsx(pt,{className:"h-4 w-4"})," Export JSON"]}),e.jsxs(Ps,{variant:"primary",onClick:w,children:[e.jsx(gt,{className:"h-4 w-4"})," Request support"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"cases",label:"Cases"},{id:"sessions",label:"Sessions"},{id:"tools",label:"Troubleshooting tools"},{id:"incidents",label:"Incidents and status"},{id:"audit",label:"Audit"}].map(v=>e.jsx("button",{className:bn("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",we===v.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:we===v.id?{background:jg.green}:void 0,onClick:()=>q(v.id),children:v.label},v.id))}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 rounded-3xl border border-slate-200 bg-white p-4 md:grid-cols-12",children:[e.jsxs("div",{className:"md:col-span-7",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2.5",children:[e.jsx(pa,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:je,onChange:v=>_e(v.target.value),placeholder:"case id, incident, session, tool...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"}),je?e.jsx("button",{className:"rounded-xl p-1 text-slate-500 hover:bg-slate-100",onClick:()=>_e(""),"aria-label":"Clear",children:e.jsx(Qe,{className:"h-4 w-4"})}):null]})]}),e.jsx("div",{className:"md:col-span-5",children:e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Support is embedded here as a role. For deeper policies see ",e.jsx("span",{className:"font-semibold",children:"Z Security"})," and ",e.jsx("span",{className:"font-semibold",children:"D Org Setup"}),"."]})})]})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[we==="cases"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsx(Ol,{title:"Support cases",subtitle:"Core: request support and track cases.",right:e.jsx(jt,{label:`${le.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[le.map(v=>e.jsx("button",{type:"button",className:"w-full rounded-3xl border border-slate-200 bg-white p-4 text-left hover:bg-slate-50",onClick:()=>{ce(v.id),Q(!0)},children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(jt,{label:v.priority,tone:NC(v.priority)}),e.jsx(jt,{label:v.status,tone:v.status==="Resolved"?"good":v.status==="In Progress"?"info":v.status==="New"?"warn":"neutral"}),e.jsx(jt,{label:v.module,tone:"neutral"}),v.marketplace!=="-"?e.jsx(jt,{label:v.marketplace,tone:"neutral"}):null,e.jsx(jt,{label:v.id,tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:v.title}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",fd(v.createdAt)," by ",v.createdBy,"  Updated ",fd(v.updatedAt)]}),e.jsx("div",{className:"mt-2 text-xs text-slate-600 line-clamp-2",children:v.description}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[v.tags.slice(0,4).map(k=>e.jsx(jt,{label:k,tone:"neutral"},`${v.id}-${k}`)),v.tags.length>4?e.jsx(jt,{label:"+more",tone:"neutral"}):null]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(jt,{label:v.attachments?`${v.attachments} attachment(s)`:"No attachments",tone:v.attachments?"info":"neutral"}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]})]})},v.id)),le.length?null:e.jsx(Im,{title:"No cases",subtitle:"Create a support request to get help."})]})})}),e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(Ol,{title:"Org admin controls",subtitle:"Core: support enablement and visibility.",right:e.jsx(jt,{label:o?"Editable":"View",tone:o?"info":"neutral"}),children:[e.jsx(Rc,{enabled:j,onChange:v=>D(v),label:"Support mode",description:"EVzone support can sign in when enabled"}),e.jsx(Rc,{enabled:y,onChange:v=>{if(!o){n({title:"Org Admin required",message:"Only Org Admin can change watermark.",kind:"warn"});return}$(v),Be({severity:"Warning",actor:r,role:r,event:"Support watermark updated",why:"Visibility control",metadata:{watermark:v}}),n({title:"Saved",message:"Watermark updated.",kind:"success"})},label:"Watermark",description:"Banner and watermark during sessions"}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:"Safety: sessions are always visible and audited. Support cannot silently change settings."})]}),e.jsxs(Ol,{title:"Premium recording policy",subtitle:"Session recording toggle (policy-controlled).",right:e.jsx(jt,{label:"Premium",tone:"info"}),children:[e.jsx(Rc,{enabled:T.enabled,onChange:v=>re(k=>({...k,enabled:v})),label:"Recording enabled",description:"Allow session recording"}),e.jsx(Rc,{enabled:T.requireOrgApproval,onChange:v=>re(k=>({...k,requireOrgApproval:v})),label:"Require org approval",description:"Recording toggles require Org Admin"}),e.jsx(Rc,{enabled:T.allowSupportToToggle,onChange:v=>re(k=>({...k,allowSupportToToggle:v})),label:"Allow support to toggle",description:"If off, only Org Admin can toggle"}),e.jsx(vd,{label:"Storage",value:`${T.storageDays}`,onChange:v=>re(k=>({...k,storageDays:Number(v)})),options:[{value:"7",label:"7 days"},{value:"14",label:"14 days"},{value:"30",label:"30 days"},{value:"90",label:"90 days"}]}),e.jsx(qh,{label:"Notice text",value:T.noticeText,onChange:v=>re(k=>({...k,noticeText:v})),rows:3})]})]})]}):null,we==="sessions"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsx(Ol,{title:"Support sessions",subtitle:"Core: sessions are always auditable and visible (banner + watermark).",right:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ps,{variant:"outline",onClick:()=>ne(Re||void 0),disabled:!j||!c,children:[e.jsx(mu,{className:"h-4 w-4"})," Start session"]}),e.jsx(jt,{label:j?"Support enabled":"Support disabled",tone:j?"good":"warn"})]}),children:e.jsxs("div",{className:"space-y-2",children:[z.map(v=>e.jsx("button",{type:"button",className:"w-full rounded-3xl border border-slate-200 bg-white p-4 text-left hover:bg-slate-50",onClick:()=>{Ke(v.id),de(!0)},children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(jt,{label:v.endedAt?"Ended":"Active",tone:v.endedAt?"neutral":"warn"}),e.jsx(jt,{label:v.mode,tone:v.mode==="Guided actions"?"info":"neutral"}),e.jsx(jt,{label:v.recordingEnabled?"Recording":"Not recording",tone:v.recordingEnabled?"warn":"neutral"}),e.jsx(jt,{label:v.toolsScope.guidedActionsAllowed?"Guided allowed":"Guided off",tone:v.toolsScope.guidedActionsAllowed?"info":"neutral"}),e.jsx(jt,{label:v.id,tone:"neutral"})]}),e.jsxs("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:["Support agent: ",v.startedBy]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Started ",fd(v.startedAt),v.endedAt?`  Ended ${fd(v.endedAt)}`:""]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Case: ",v.relatedCaseId||"-","  Actions: ",v.actions.length]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[v.endedAt?null:e.jsxs(Ps,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Me(v.id),children:[e.jsx(Qe,{className:"h-4 w-4"})," End"]}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]})]})},v.id)),z.length?null:e.jsx(Im,{title:"No sessions",subtitle:"Start a session from a case."})]})})}),e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(Ol,{title:"Session actions",subtitle:"Premium: recording and guided actions.",right:e.jsx(jt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs(Ps,{variant:"outline",onClick:Xe,disabled:!Le||!!Le.endedAt,children:[e.jsx(Sv,{className:"h-4 w-4"})," Toggle recording"]}),e.jsxs(Ps,{variant:"outline",onClick:()=>{if(!Le){n({title:"No session",message:"Select a session first.",kind:"warn"});return}fe(Le.id)},disabled:!Le||!!Le.endedAt,children:[e.jsx(LE,{className:"h-4 w-4"})," Request guided actions"]}),e.jsxs(Ps,{variant:"primary",onClick:()=>{if(!Le){n({title:"No session",message:"Select a session first.",kind:"warn"});return}me(Le.id)},disabled:!Le||!!Le.endedAt||!o,title:o?"Approve":"Org Admin required",children:[e.jsx(ct,{className:"h-4 w-4"})," Approve guided actions"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Guided actions are scoped and guarded. All changes are auditable and visible."})]}),e.jsx(Ol,{title:"Recording notice",subtitle:"Policy controlled",right:e.jsx(jt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[T.noticeText,e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Storage: ",T.storageDays," days  Org approval: ",T.requireOrgApproval?"Required":"Not required"]})]})})]})]}):null,we==="tools"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsx(Ol,{title:"Scoped troubleshooting tools",subtitle:"Premium: read-only and guided actions.",right:e.jsx(jt,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"space-y-2",children:[Ye.map(v=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(jt,{label:v.kind,tone:v.kind==="Guided action"?"warn":"good"}),e.jsx(jt,{label:v.module,tone:"neutral"}),e.jsx(jt,{label:`Risk ${v.risk}`,tone:v.risk==="High"?"bad":v.risk==="Medium"?"warn":"good"}),e.jsx(jt,{label:v.id,tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:v.label}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:v.description})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ps,{variant:v.kind==="Guided action"?"primary":"outline",className:"px-3 py-2 text-xs",onClick:()=>De(v),disabled:!Le||!!Le.endedAt,title:Le?"Run":"Open a session first",children:[e.jsx(ht,{className:"h-4 w-4"})," Run"]}),e.jsxs(Ps,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{if(!Le){n({title:"No session",message:"Select an active session first.",kind:"warn"});return}de(!0)},children:[e.jsx(et,{className:"h-4 w-4"})," Session"]})]})]}),v.kind==="Guided action"?e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Guided actions require approval and will always show confirmations and audit logs."}):e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Read-only check. No data changes."})]},v.id)),Ye.length?null:e.jsx(Im,{title:"No tools",subtitle:"No tools match your search."})]})})}),e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsx(Ol,{title:"Active session",subtitle:"Select a session to run tools.",right:e.jsx(jt,{label:Le&&!Le.endedAt?"Active":"None",tone:Le&&!Le.endedAt?"warn":"neutral"}),children:Le?e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(jt,{label:Le.id,tone:"neutral"}),e.jsx(jt,{label:Le.mode,tone:Le.mode==="Guided actions"?"info":"neutral"}),e.jsx(jt,{label:Le.toolsScope.guidedActionsAllowed?"Guided allowed":"Guided off",tone:Le.toolsScope.guidedActionsAllowed?"info":"neutral"})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Case: ",Le.relatedCaseId||"-"]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Ps,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>de(!0),children:[e.jsx(et,{className:"h-4 w-4"})," Open session"]}),Le.endedAt?null:e.jsxs(Ps,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>Me(Le.id),children:[e.jsx(Qe,{className:"h-4 w-4"})," End"]})]})]}):e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center text-sm text-slate-600",children:"Select a session from Sessions tab."})}),e.jsx(Ol,{title:"Policy reminder",subtitle:"Support scope",right:e.jsx(jt,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Support is embedded with role gating. Sessions are visible and audited.",e.jsxs("ul",{className:"mt-2 space-y-1",children:[e.jsx("li",{children:"1) View-only by default"}),e.jsx("li",{children:"2) Guided actions require approvals"}),e.jsx("li",{children:"3) Recording is policy-controlled"})]})]})})]})]}):null,we==="incidents"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsx(Ol,{title:"Incident and status messaging",subtitle:"Premium: communicate incidents to org admins.",right:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ps,{variant:"outline",onClick:E,disabled:!x,title:x?"Create":"Not allowed",children:[e.jsx(a4,{className:"h-4 w-4"})," New status"]}),e.jsx(jt,{label:x?"Publisher":"Viewer",tone:x?"info":"neutral"})]}),children:e.jsxs("div",{className:"space-y-2",children:[Ae.map(v=>{var k;return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(jt,{label:v.severity,tone:CB(v.severity)}),e.jsx(jt,{label:v.status,tone:v.status==="Resolved"?"good":v.status==="Monitoring"?"info":"warn"}),v.pinned?e.jsx(jt,{label:"Pinned",tone:"info"}):null,e.jsx(jt,{label:v.id,tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:v.title}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Posted ",fd(v.createdAt)," by ",v.createdBy]}),e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:v.message}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:v.modules.map(m=>e.jsx(jt,{label:m,tone:"neutral"},`${v.id}-${m}`))})]}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[e.jsx("div",{className:"font-semibold",children:"Latest update"}),e.jsx("div",{className:"mt-1",children:(k=v.updates[v.updates.length-1])==null?void 0:k.message})]})]})},v.id)}),Ae.length?null:e.jsx(Im,{title:"No incidents",subtitle:"No active incidents to display."})]})})}),e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsxs(Ol,{title:"Org admin notice",subtitle:"Status feed is for org admins",right:e.jsx(jt,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: incident messages can be routed to email and WhatsApp as well. Logs appear in Notifications Center (B)."}),e.jsxs(Ps,{variant:"outline",className:"w-full",onClick:()=>{n({title:"Scheduled",message:"Digest scheduling is handled in Reporting (V) and Notifications (B).",kind:"info"})},children:[e.jsx(Fo,{className:"h-4 w-4"})," Digest routing"]})]}),e.jsx(Ol,{title:"Visibility rules",subtitle:"Who sees what",right:e.jsx(jt,{label:"Core",tone:"neutral"}),children:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"1) Org admins always see org incidents"}),e.jsx("li",{children:"2) Support can publish only if enabled"}),e.jsx("li",{children:"3) Actions remain auditable and visible"})]})})})]})]}):null,we==="audit"?e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsxs(Ol,{title:"Audit",subtitle:"Core: sessions are auditable and visible.",right:e.jsx(jt,{label:`${Ve.length}`,tone:"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Time"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Severity"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actor"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Event"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Why"})]})}),e.jsxs("tbody",{children:[Ve.slice(0,60).map(v=>e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:Dm(v.at)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(jt,{label:v.severity,tone:kB(v.severity)})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:v.actor}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:v.role})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:v.event}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:v.why})]},v.id)),Ve.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-10",children:e.jsx(Im,{title:"No audit entries",subtitle:"Actions will appear here."})})})]})]})}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(Ps,{variant:"outline",onClick:P,children:[e.jsx(pt,{className:"h-4 w-4"})," Export bundle"]}),e.jsxs(Ps,{variant:"outline",onClick:async()=>{try{await navigator.clipboard.writeText(JSON.stringify({audit:Ve},null,2)),n({title:"Copied",message:"Audit JSON copied.",kind:"success"})}catch{n({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},children:[e.jsx(ss,{className:"h-4 w-4"})," Copy JSON"]})]})]})}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"AA Support and EVzone Admin Tools v2. Core: embedded EVzone support role, auditable sessions, request support, and case tracking. Premium: session recording policy, scoped troubleshooting tools, and incident/status messaging."})})]})}),e.jsx(kb,{open:Ee,title:"Request support",subtitle:"Core: create a support case.",onClose:()=>be(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Ps,{variant:"outline",onClick:()=>be(!1),children:"Cancel"}),e.jsxs(Ps,{variant:"primary",onClick:B,children:[e.jsx(ct,{className:"h-4 w-4"})," Create case"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(wC,{label:"Title",value:String(Fe.title||""),onChange:v=>Pe(k=>({...k,title:v})),placeholder:"Short summary"}),e.jsx(vd,{label:"Module",value:String(Fe.module||"Billing"),onChange:v=>Pe(k=>({...k,module:v})),options:t.map(v=>({value:v,label:v}))}),e.jsx(vd,{label:"Marketplace",value:String(Fe.marketplace||"-"),onChange:v=>Pe(k=>({...k,marketplace:v})),options:[{value:"-",label:"-"},...s.map(v=>({value:v,label:v}))],disabled:Fe.module!=="E-Commerce",hint:Fe.module!=="E-Commerce"?"Only for E-Commerce":void 0}),e.jsx(vd,{label:"Priority",value:String(Fe.priority||"Medium"),onChange:v=>Pe(k=>({...k,priority:v})),options:[{value:"Low",label:"Low"},{value:"Medium",label:"Medium"},{value:"High",label:"High"},{value:"Critical",label:"Critical"}]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(qh,{label:"Description",value:String(Fe.description||""),onChange:v=>Pe(k=>({...k,description:v})),placeholder:"Describe the issue, impact, and expected outcome",rows:5})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:"Attachments and evidence can be added in the case timeline (demo)."})]})}),e.jsx(kC,{open:pe,title:xe?`Case ${xe.id}`:"Case",subtitle:xe?`${xe.title}  ${xe.status}`:"",onClose:()=>Q(!1),footer:xe?e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Core: case tracking. Premium: start a session and use scoped tools."}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ps,{variant:"outline",onClick:()=>ne(xe.id),disabled:!c||!j,children:[e.jsx(mu,{className:"h-4 w-4"})," Start session"]}),e.jsxs(Ps,{variant:"primary",onClick:()=>q("sessions"),children:[e.jsx(et,{className:"h-4 w-4"})," Sessions"]})]})]}):null,children:xe?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(jt,{label:xe.priority,tone:NC(xe.priority)}),e.jsx(jt,{label:xe.status,tone:xe.status==="Resolved"?"good":xe.status==="In Progress"?"info":"neutral"}),e.jsx(jt,{label:xe.module,tone:"neutral"}),xe.marketplace!=="-"?e.jsx(jt,{label:xe.marketplace,tone:"neutral"}):null,e.jsx(jt,{label:`Assigned: ${xe.assignedTo||"-"}`,tone:"info"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:xe.title}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:xe.description}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Created ",Dm(xe.createdAt),"  Updated ",Dm(xe.updatedAt)]})]}),e.jsxs(Ol,{title:"Timeline",subtitle:"Messages and system notes",right:e.jsx(jt,{label:`${xe.timeline.length}`,tone:"neutral"}),children:[e.jsx("div",{className:"space-y-2",children:xe.timeline.slice().sort((v,k)=>v.at-k.at).map(v=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(jt,{label:v.kind,tone:v.kind==="support"?"info":(v.kind==="customer","neutral")}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:v.by}),e.jsx("div",{className:"text-xs text-slate-500",children:fd(v.at)})]}),e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:v.message})]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:async()=>{try{await navigator.clipboard.writeText(v.message),n({title:"Copied",message:"Message copied.",kind:"success"})}catch{n({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},"aria-label":"Copy",children:e.jsx(ss,{className:"h-4 w-4"})})]})},v.id))}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2",children:e.jsxs(Ps,{variant:"outline",onClick:()=>{const v=prompt("Add a note to the case");v&&(ue(xe.id,v,c?"support":"customer"),n({title:"Added",message:"Timeline updated.",kind:"success"}))},children:[e.jsx(yi,{className:"h-4 w-4"})," Add message"]})})]})]}):null}),e.jsx(kC,{open:he,title:Le?`Session ${Le.id}`:"Session",subtitle:Le?`${Le.mode}  ${Le.endedAt?"Ended":"Active"}`:"",onClose:()=>de(!1),footer:Le?e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Premium: scoped tools and recording policy controlled."}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Ps,{variant:"outline",onClick:Xe,disabled:!!Le.endedAt,children:[e.jsx(Sv,{className:"h-4 w-4"})," Recording"]}),Le.endedAt?null:e.jsxs(Ps,{variant:"outline",onClick:()=>Me(Le.id),children:[e.jsx(Qe,{className:"h-4 w-4"})," End"]})]})]}):null,children:Le?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(jt,{label:Le.mode,tone:Le.mode==="Guided actions"?"info":"neutral"}),e.jsx(jt,{label:Le.recordingEnabled?"Recording":"Not recording",tone:Le.recordingEnabled?"warn":"neutral"}),e.jsx(jt,{label:Le.toolsScope.guidedActionsAllowed?"Guided allowed":"Guided off",tone:Le.toolsScope.guidedActionsAllowed?"info":"neutral"}),e.jsx(jt,{label:Le.orgVisible?"Org-visible":"Hidden",tone:Le.orgVisible?"good":"warn"})]}),e.jsxs("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:["Started by ",Le.startedBy]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Started ",Dm(Le.startedAt),Le.endedAt?`  Ended ${Dm(Le.endedAt)}`:""]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Case: ",Le.relatedCaseId||"-"]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"No silent actions: every tool execution creates an audit entry."})]}),e.jsx(Ol,{title:"Actions log",subtitle:"Executed checks and guided actions",right:e.jsx(jt,{label:`${Le.actions.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[Le.actions.map(v=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(jt,{label:v.type,tone:v.type==="Guided action"?"warn":"good"}),e.jsx(jt,{label:v.outcome,tone:v.outcome==="OK"?"good":v.outcome==="Failed"?"warn":"neutral"}),e.jsx("div",{className:"text-xs text-slate-500",children:fd(v.at)})]}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:v.label}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:v.notes})]}),e.jsxs("div",{className:"text-xs text-slate-500",children:["By ",v.by]})]})},v.id)),Le.actions.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No actions yet. Run a tool from Tools tab."})]})}),e.jsxs(Ol,{title:"Permissions",subtitle:"Scoped troubleshooting tools",right:e.jsx(jt,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Read-only tools"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Enabled"}),e.jsx(jt,{label:Le.toolsScope.readOnly?"On":"Off",tone:Le.toolsScope.readOnly?"good":"warn"})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Guided actions"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Approval required"}),e.jsx(jt,{label:Le.toolsScope.guidedActionsAllowed?"Allowed":"Not allowed",tone:Le.toolsScope.guidedActionsAllowed?"info":"neutral"})]})]}),e.jsx("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:e.jsxs(Ps,{variant:"outline",onClick:()=>q("tools"),children:[e.jsx(et,{className:"h-4 w-4"})," Open tools"]})})]})]}):null}),e.jsxs(kb,{open:Oe,title:"Toggle session recording",subtitle:"Premium: policy controlled. Requires reason and may require org approval.",onClose:()=>Se(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Ps,{variant:"outline",onClick:()=>Se(!1),children:"Cancel"}),e.jsxs(Ps,{variant:"primary",onClick:V,children:[e.jsx(Sv,{className:"h-4 w-4"})," Confirm"]})]}),children:[e.jsx(qh,{label:"Reason",value:Te,onChange:Ge,placeholder:"Example: capture evidence for incident review",rows:4}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Policy: enabled ",String(T.enabled),"  support toggle ",String(T.allowSupportToToggle),"  org approval ",String(T.requireOrgApproval),"  storage ",T.storageDays," days."]})]}),e.jsx(kb,{open:Ne,title:"New incident or status message",subtitle:"Premium: incident/status messaging module.",onClose:()=>ge(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Ps,{variant:"outline",onClick:()=>ge(!1),children:"Cancel"}),e.jsxs(Ps,{variant:"primary",onClick:u,children:[e.jsx(a4,{className:"h-4 w-4"})," Publish"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(wC,{label:"Title",value:String($e.title||""),onChange:v=>ie(k=>({...k,title:v})),placeholder:"Short incident title"}),e.jsx(vd,{label:"Severity",value:String($e.severity||"Info"),onChange:v=>ie(k=>({...k,severity:v})),options:[{value:"Info",label:"Info"},{value:"Degraded",label:"Degraded"},{value:"Partial Outage",label:"Partial Outage"},{value:"Major Outage",label:"Major Outage"}]}),e.jsx(vd,{label:"Status",value:String($e.status||"Investigating"),onChange:v=>ie(k=>({...k,status:v})),options:[{value:"Investigating",label:"Investigating"},{value:"Identified",label:"Identified"},{value:"Monitoring",label:"Monitoring"},{value:"Resolved",label:"Resolved"}]}),e.jsx(Rc,{enabled:!!$e.pinned,onChange:v=>ie(k=>({...k,pinned:v})),label:"Pinned",description:"Show at top"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(qh,{label:"Message",value:String($e.message||""),onChange:v=>ie(k=>({...k,message:v})),placeholder:"What is happening, impact, ETA",rows:5})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:"In production, status messages can be delivered via email and WhatsApp and show in Notifications Center."})]})})]})}const Dd={green:"#03CD8C",orange:"#F77F00"};function En(...t){return t.filter(Boolean).join(" ")}function CC(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function MB(t,s,a){return Math.max(s,Math.min(a,t))}function Cb(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function PB(t,s,a="text/plain"){const l=new Blob([s],{type:a}),n=URL.createObjectURL(l),r=document.createElement("a");r.href=n,r.download=t,r.click(),URL.revokeObjectURL(n)}function dl({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:En("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function SC(t){return t==="Premium"?"info":"neutral"}function Sb(t){return t==="At risk"?"bad":t==="Needs attention"?"warn":"good"}function pr({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:Dd.green}:t==="accent"?{background:Dd.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:En(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function OB({value:t}){const s=MB(t,0,100),a=78,l=10,n=(a-l)/2,r=2*Math.PI*n,i=s/100*r;return e.jsxs("div",{className:"relative grid place-items-center",children:[e.jsxs("svg",{width:a,height:a,className:"-rotate-90",children:[e.jsx("circle",{cx:a/2,cy:a/2,r:n,stroke:"#E2E8F0",strokeWidth:l,fill:"none"}),e.jsx("circle",{cx:a/2,cy:a/2,r:n,stroke:Dd.green,strokeWidth:l,fill:"none",strokeDasharray:`${i} ${r}`,strokeLinecap:"round"})]}),e.jsxs("div",{className:"absolute text-sm font-semibold text-slate-900",children:[Math.round(s),"%"]})]})}function TB({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:En("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function RB({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="920px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[8vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(TB,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function DB({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:En("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function Dc({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function AC({title:t,subtitle:s}){return e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(kl,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:s})]})}function IB(){const[t,s]=d.useState([]),a=pe=>{const Q=CC("toast");s(Re=>[{id:Q,...pe},...Re].slice(0,4)),window.setTimeout(()=>s(Re=>Re.filter(ce=>ce.id!==Q)),3200)},l=Date.now(),n=d.useMemo(()=>{const pe=Q=>({...Q,lastUpdatedAt:l-Q.lastUpdatedDaysAgo*24*60*60*1e3});return[pe({id:"org_setup",title:"Organization Profile and Program Setup",description:"Company profile, entities, billing contacts, branding, invoice groups, and support toggle.",category:"Organization",path:"/settings/org/setup",tier:"Core",roles:["Org Admin"],tags:["profile","entities","billing","invoice groups","support"],icon:Xl,lastUpdatedDaysAgo:2,health:"Healthy",quickActions:[{id:"open",label:"Open wizard",kind:"open"},{id:"copy",label:"Copy link",kind:"copy"}]}),pe({id:"modules_marketplaces",title:"Modules and Marketplaces Enablement",description:"Enable service modules and marketplaces including MyLiveDealz. Includes Other slots for expansion.",category:"Organization",path:"/settings/modules",tier:"Core",roles:["Org Admin"],tags:["service modules","marketplaces","rollout"],icon:La,lastUpdatedDaysAgo:3,health:"Healthy",quickActions:[{id:"open",label:"Manage enablement",kind:"open"},{id:"copy",label:"Copy link",kind:"copy"}]}),pe({id:"users_invites",title:"Users and Invitations",description:"Invite employees, set group and cost center defaults, bulk import, and offboarding.",category:"Access",path:"/settings/users",tier:"Core",roles:["Org Admin","Finance"],tags:["users","invites","CSV import","offboarding"],icon:Os,lastUpdatedDaysAgo:6,health:"Needs attention",quickActions:[{id:"open",label:"Open users",kind:"open"},{id:"action",label:"Invite user",kind:"action",hint:"Quick create"}]}),pe({id:"groups_cost_centers",title:"Groups and Cost Centers",description:"Create Groups, cost centers, project tags, and chargeback rules.",category:"Access",path:"/settings/groups",tier:"Core",roles:["Org Admin","Finance"],tags:["groups","cost centers","project codes"],icon:aU,lastUpdatedDaysAgo:9,health:"Healthy",quickActions:[{id:"open",label:"Open groups",kind:"open"},{id:"copy",label:"Copy link",kind:"copy"}]}),pe({id:"roles_permissions",title:"Roles, Permissions and Governance",description:"Custom roles, module permissions, two-admin model controls, delegation, and simulation.",category:"Access",path:"/settings/roles",tier:"Core",roles:["Org Admin"],tags:["RBAC","governance","delegation"],icon:Ao,lastUpdatedDaysAgo:12,health:"Healthy",quickActions:[{id:"open",label:"Open roles",kind:"open"},{id:"copy",label:"Copy link",kind:"copy"}]}),pe({id:"policy_builder",title:"Policies",description:"Policy builder for rides, services, purchases and marketplace restrictions with inheritance.",category:"Controls",path:"/settings/policies",tier:"Core",roles:["Org Admin","Approver"],tags:["policy","inheritance","simulator"],icon:LE,lastUpdatedDaysAgo:4,health:"Needs attention",quickActions:[{id:"open",label:"Open policies",kind:"open"},{id:"action",label:"Simulate scenario",kind:"action"}]}),pe({id:"approval_workflows",title:"Approval Workflow Builder",description:"Create approval flows per module and marketplace including RFQs and high value assets.",category:"Controls",path:"/settings/approvals/workflows",tier:"Core",roles:["Org Admin","Approver","Finance"],tags:["approvals","rules","SLA"],icon:ct,lastUpdatedDaysAgo:7,health:"Healthy",quickActions:[{id:"open",label:"Open builder",kind:"open"},{id:"action",label:"Create template",kind:"action"}]}),pe({id:"budgets",title:"Budgets, Spend Limits and Controls",description:"Org, group, user, module, and marketplace budgets with forecasting and exceptions.",category:"Finance",path:"/settings/budgets",tier:"Core",roles:["Org Admin","Finance"],tags:["budgets","caps","exceptions"],icon:Ia,lastUpdatedDaysAgo:1,health:"At risk",quickActions:[{id:"open",label:"Open budgets",kind:"open"},{id:"action",label:"Request exception",kind:"action"}]}),pe({id:"billing_invoice_groups",title:"Billing Setup and Invoice Groups",description:"Invoice frequency, invoice groups, tax, templates, and billing simulations.",category:"Finance",path:"/settings/billing",tier:"Core",roles:["Org Admin","Finance"],tags:["billing","invoice groups","tax"],icon:kt,lastUpdatedDaysAgo:5,health:"Healthy",quickActions:[{id:"open",label:"Open billing",kind:"open"},{id:"copy",label:"Copy link",kind:"copy"}]}),pe({id:"reporting",title:"Reporting and Analytics",description:"Spend reports, approval performance, exports, custom report builder, and schedules.",category:"Reporting",path:"/reports",tier:"Core",roles:["Org Admin","Finance","Approver"],tags:["reports","exports","schedules"],icon:Er,lastUpdatedDaysAgo:2,health:"Healthy",quickActions:[{id:"open",label:"Open reports",kind:"open"},{id:"action",label:"Schedule report",kind:"action"}]}),pe({id:"esg",title:"Sustainability and ESG Reporting",description:"EV usage metrics, charging utilization, emissions estimates, and ESG template exports.",category:"Reporting",path:"/reports/esg",tier:"Premium",roles:["Org Admin","Finance"],tags:["ESG","emissions","templates"],icon:Fd,lastUpdatedDaysAgo:2,health:"Healthy",quickActions:[{id:"open",label:"Open ESG",kind:"open"},{id:"action",label:"Update factors",kind:"action"}]}),pe({id:"integrations",title:"Integrations and Developer Center",description:"ERP exports, secure API keys, scopes, webhooks, sandbox mode, and inspector.",category:"Integrations",path:"/settings/integrations",tier:"Core",roles:["Org Admin","Finance"],tags:["exports","API keys","webhooks"],icon:Co,lastUpdatedDaysAgo:1,health:"Healthy",quickActions:[{id:"open",label:"Open integrations",kind:"open"},{id:"action",label:"Create webhook",kind:"action"}]}),pe({id:"security",title:"Security, Audit and Compliance",description:"Audit logs, MFA policies, retention, support mode gating, dual control, forensic exports.",category:"Security",path:"/settings/security",tier:"Core",roles:["Org Admin","Finance"],tags:["audit","MFA","retention","dual control"],icon:ia,lastUpdatedDaysAgo:1,health:"Needs attention",quickActions:[{id:"open",label:"Open security",kind:"open"},{id:"action",label:"Run posture check",kind:"action"}]}),pe({id:"support_tools",title:"Support and EVzone Admin Tools",description:"Embedded support role, auditable sessions, scoped tools, recording policy, and status messages.",category:"Support",path:"/settings/support-tools",tier:"Premium",roles:["Org Admin","EVzone Support","Finance"],tags:["support","cases","sessions","incidents"],icon:mu,lastUpdatedDaysAgo:0,health:"Healthy",quickActions:[{id:"open",label:"Open support tools",kind:"open"},{id:"action",label:"Request support",kind:"action"}]})]},[l]),r=["All","Organization","Access","Controls","Finance","Integrations","Security","Support","Reporting"],[i,o]=d.useState("All"),[c,x]=d.useState(""),[j,g]=d.useState("Org Admin"),[y,$]=d.useState(()=>["org_setup","security","integrations"]),[T,C]=d.useState("org_setup"),[W,L]=d.useState(!1),[R,F]=d.useState(null),[te,oe]=d.useState(""),G=d.useMemo(()=>n.find(pe=>pe.id===T)||n[0],[n,T]),H=d.useMemo(()=>G.roles.includes(j),[G.roles,j]),Y=d.useMemo(()=>{const pe=c.trim().toLowerCase();return n.filter(Q=>i==="All"?!0:Q.category===i).filter(Q=>pe?`${Q.title} ${Q.description} ${Q.category} ${Q.tags.join(" ")} ${Q.path} ${Q.tier}`.toLowerCase().includes(pe):!0).slice().sort((Q,Re)=>{const ce=y.includes(Q.id)?1:0,xe=y.includes(Re.id)?1:0;if(ce!==xe)return xe-ce;const he=Ke=>Ke==="At risk"?3:Ke==="Needs attention"?2:1,de=he(Q.health),ye=he(Re.health);return de!==ye?ye-de:Re.lastUpdatedAt-Q.lastUpdatedAt})},[n,i,c,y]),we=d.useMemo(()=>{const pe=["org_setup","modules_marketplaces","billing_invoice_groups","security","integrations"],Q=pe.filter(Re=>{const ce=n.find(xe=>xe.id===Re);return ce?ce.health==="Healthy":!1}).length;return Math.round(Q/pe.length*100)},[n]),q=d.useMemo(()=>{const pe=n.length,Q=n.filter(he=>he.health==="At risk").length,Re=n.filter(he=>he.health==="Needs attention").length,ce=n.filter(he=>he.tier==="Premium").length,xe=n.filter(he=>he.tier==="Phase 2").length;return{total:pe,risk:Q,attention:Re,premium:ce,phase2:xe}},[n]),je=()=>{const pe={generatedAt:new Date().toISOString(),viewAs:j,category:i,query:c||void 0,pinned:y,items:n.map(Q=>({id:Q.id,title:Q.title,category:Q.category,path:Q.path,tier:Q.tier,roles:Q.roles,tags:Q.tags,health:Q.health,lastUpdatedAt:Q.lastUpdatedAt}))};PB("admin-settings-hub.json",JSON.stringify(pe,null,2),"application/json"),a({title:"Exported",message:"Settings manifest downloaded.",kind:"success"})},_e=async pe=>{try{await navigator.clipboard.writeText(pe),a({title:"Copied",message:"Link copied.",kind:"success"})}catch{a({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},Ee=pe=>{if(!pe.roles.includes(j)){F(pe.id),oe(""),L(!0);return}C(pe.id),a({title:"Navigate",message:`Open ${pe.path}`,kind:"info"})},be=pe=>{$(Q=>Q.includes(pe)?Q.filter(Re=>Re!==pe):[pe,...Q].slice(0,8))},Fe=()=>{if(R){if(te.trim().length<8){a({title:"Reason required",message:"Explain why you need access.",kind:"warn"});return}a({title:"Requested",message:`Access request created for ${R}.`,kind:"success"}),L(!1)}},Pe=d.useMemo(()=>n.slice().sort((pe,Q)=>Q.lastUpdatedAt-pe.lastUpdatedAt).slice(0,6).map(pe=>({id:CC("chg"),at:pe.lastUpdatedAt,title:pe.title,note:pe.health==="Healthy"?"Updated configuration":pe.health==="Needs attention"?"Requires review":"At risk limit",path:pe.path,health:pe.health})),[n]);return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(DB,{toasts:t,onDismiss:pe=>s(Q=>Q.filter(Re=>Re.id!==pe))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:Dd.green},children:e.jsx(kl,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Admin Settings Hub"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"One place to manage every CorporatePay setting. Use search, filters, and role-based access."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(dl,{label:`Total ${q.total}`,tone:"neutral"}),e.jsx(dl,{label:`At risk ${q.risk}`,tone:q.risk?"warn":"good"}),e.jsx(dl,{label:`Needs attention ${q.attention}`,tone:q.attention?"warn":"good"}),e.jsx(dl,{label:`Premium ${q.premium}`,tone:q.premium?"info":"neutral"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"min-w-[220px]",children:e.jsx($B,{label:"View as",value:j,onChange:pe=>g(pe),options:[{value:"Org Admin",label:"Org Admin"},{value:"Finance",label:"Finance"},{value:"Approver",label:"Approver"},{value:"Employee",label:"Employee"},{value:"EVzone Support",label:"EVzone Support"}],hint:"Role gating"})}),e.jsxs(pr,{variant:"outline",onClick:je,children:[e.jsx(pt,{className:"h-4 w-4"})," Export manifest"]}),e.jsxs(pr,{variant:"primary",onClick:()=>{C("support_tools"),a({title:"Support",message:"Open support tools",kind:"info"})},children:[e.jsx(mu,{className:"h-4 w-4"})," Support tools"]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 rounded-3xl border border-slate-200 bg-white p-4 md:grid-cols-12",children:[e.jsxs("div",{className:"md:col-span-7",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search settings"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-2.5",children:[e.jsx(pa,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:c,onChange:pe=>x(pe.target.value),placeholder:"policy, budgets, invoice groups, API keys...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"}),c?e.jsx("button",{className:"rounded-xl p-1 text-slate-500 hover:bg-slate-100",onClick:()=>x(""),"aria-label":"Clear",type:"button",children:e.jsx(Qe,{className:"h-4 w-4"})}):null]})]}),e.jsxs("div",{className:"md:col-span-5",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Category"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:r.map(pe=>e.jsx("button",{type:"button",className:En("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",i===pe?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:i===pe?{background:Dd.green}:void 0,onClick:()=>o(pe),children:pe},pe))})]})]})]}),e.jsx("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsx(Dc,{title:"Settings",subtitle:"Click a card to view details and actions. Locked items can request access.",right:e.jsx(dl,{label:`${Y.length} shown`,tone:"neutral"}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[Y.map(pe=>{const Q=pe.icon,Re=!pe.roles.includes(j),ce=y.includes(pe.id);return e.jsxs("button",{type:"button",className:En("relative rounded-3xl border bg-white p-4 text-left shadow-sm transition hover:bg-slate-50",T===pe.id?"border-emerald-300 ring-4 ring-emerald-100":"border-slate-200"),onClick:()=>{C(pe.id),Re&&a({title:"Locked",message:"Request access to open.",kind:"warn"})},children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex min-w-0 items-start gap-3",children:[e.jsx("div",{className:En("grid h-11 w-11 shrink-0 place-items-center rounded-2xl text-white",Re?"bg-slate-400":""),style:Re?void 0:{background:Dd.green},children:e.jsx(Q,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:pe.title}),e.jsx(dl,{label:pe.tier,tone:SC(pe.tier)}),e.jsx(dl,{label:pe.health,tone:Sb(pe.health)})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[pe.category,"  Updated ",Cb(pe.lastUpdatedAt)]}),e.jsx("div",{className:"mt-2 line-clamp-2 text-sm text-slate-700",children:pe.description}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[pe.tags.slice(0,4).map(xe=>e.jsx(dl,{label:xe,tone:"neutral"},`${pe.id}-${xe}`)),pe.tags.length>4?e.jsx(dl,{label:"+more",tone:"neutral"}):null]})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsx("button",{type:"button",className:En("rounded-2xl p-2",ce?"bg-amber-50 text-amber-900 ring-1 ring-amber-200":"text-slate-500 hover:bg-slate-100"),onClick:xe=>{xe.stopPropagation(),be(pe.id),a({title:ce?"Unpinned":"Pinned",message:pe.title,kind:"info"})},"aria-label":ce?"Unpin":"Pin",children:e.jsx(Il,{className:En("h-4 w-4",ce&&"fill-current")})}),e.jsxs(pr,{variant:Re?"outline":"primary",className:"px-3 py-2 text-xs",onClick:xe=>{xe.stopPropagation(),Ee(pe)},children:[Re?e.jsx(ia,{className:"h-4 w-4"}):e.jsx(et,{className:"h-4 w-4"}),Re?"Request":"Open"]})]})]}),Re?e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Locked for role: ",e.jsx("span",{className:"font-semibold",children:j}),". Request access to proceed."]}):null]},pe.id)}),Y.length?null:e.jsx(AC,{title:"No matches",subtitle:"Try a different search or category."})]})})}),e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsx(Dc,{title:"Selected",subtitle:"Details and quick actions",right:e.jsx(dl,{label:H?"Accessible":"Locked",tone:H?"good":"warn"}),children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"flex items-start justify-between gap-3",children:e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:G.title}),e.jsx(dl,{label:G.tier,tone:SC(G.tier)}),e.jsx(dl,{label:G.health,tone:Sb(G.health)})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[G.category,"  Updated ",Cb(G.lastUpdatedAt)]}),e.jsx("div",{className:"mt-3 text-sm text-slate-700",children:G.description}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Path: ",e.jsx("span",{className:"font-mono",children:G.path})]}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:e.jsx(dl,{label:`Allowed roles: ${G.roles.join(", ")}`,tone:"neutral"})})]})}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(pr,{variant:H?"primary":"outline",onClick:()=>Ee(G),children:[e.jsx(et,{className:"h-4 w-4"}),H?"Open":"Request access"]}),e.jsxs(pr,{variant:"outline",onClick:()=>void _e(G.path),children:[e.jsx(ss,{className:"h-4 w-4"})," Copy link"]}),e.jsxs(pr,{variant:"outline",onClick:()=>{be(G.id),a({title:y.includes(G.id)?"Unpinned":"Pinned",message:G.title,kind:"info"})},children:[e.jsx(Il,{className:En("h-4 w-4",y.includes(G.id)&&"fill-current")}),y.includes(G.id)?"Unpin":"Pin"]})]}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2",children:G.quickActions.map(pe=>e.jsxs("button",{type:"button",className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-3 text-left hover:bg-slate-50",onClick:()=>{if(pe.kind==="copy"){_e(G.path);return}if(pe.kind==="open"){Ee(G);return}a({title:"Action",message:pe.hint||pe.label,kind:"info"})},children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:pe.label}),pe.hint?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:pe.hint}):null]}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]},pe.id))})]})}),e.jsxs(Dc,{title:"Go-live readiness",subtitle:"Quick snapshot of key configuration.",right:e.jsx(dl,{label:we>=80?"On track":"Needs work",tone:we>=80?"good":"warn"}),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(OB,{value:we}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:[we,"%"]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Org setup, modules, billing, security, integrations"})]})]}),e.jsxs(pr,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{C("org_setup"),a({title:"Tip",message:"Start with Organization Setup wizard.",kind:"info"})},children:[e.jsx(et,{className:"h-4 w-4"})," Wizard"]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"This is a demo readiness score for the settings hub."})]}),e.jsx(Dc,{title:"Pinned",subtitle:"Your top shortcuts",right:e.jsx(dl,{label:`${y.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[y.map(pe=>n.find(Q=>Q.id===pe)).filter(Boolean).map(pe=>{const Q=pe,Re=Q.icon,ce=!Q.roles.includes(j);return e.jsx("button",{type:"button",className:"w-full rounded-3xl border border-slate-200 bg-white p-4 text-left hover:bg-slate-50",onClick:()=>C(Q.id),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:En("grid h-10 w-10 place-items-center rounded-2xl text-white",ce?"bg-slate-400":""),style:ce?void 0:{background:Dd.green},children:e.jsx(Re,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:Q.title}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:Q.path})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:ce?e.jsx(ia,{className:"h-4 w-4 text-slate-400"}):e.jsx(et,{className:"h-5 w-5 text-slate-400"})})]})},Q.id)}),y.length?null:e.jsx(AC,{title:"No pinned items",subtitle:"Pin settings you use most."})]})}),e.jsx(Dc,{title:"Recent changes",subtitle:"Last updates",right:e.jsx(dl,{label:"Live",tone:"info"}),children:e.jsx("div",{className:"space-y-2",children:Pe.map(pe=>e.jsx("button",{type:"button",className:"w-full rounded-3xl border border-slate-200 bg-white p-4 text-left hover:bg-slate-50",onClick:()=>{const Q=n.find(Re=>Re.path===pe.path);Q&&C(Q.id)},children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(dl,{label:pe.health,tone:Sb(pe.health)}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:pe.title})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[Cb(pe.at),"  ",pe.note]})]}),e.jsx(et,{className:"h-5 w-5 text-slate-400"})]})},pe.id))})}),e.jsx(Dc,{title:"Help",subtitle:"Guidance and support",right:e.jsx(dl,{label:"Core",tone:"neutral"}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs(pr,{variant:"outline",onClick:()=>a({title:"Help Center",message:"Opening help center (demo).",kind:"info"}),children:[e.jsx(Fu,{className:"h-4 w-4"})," Help Center"]}),e.jsxs(pr,{variant:"outline",onClick:()=>{C("support_tools"),a({title:"Request support",message:"Create a support case from Support Tools.",kind:"info"})},children:[e.jsx(yi,{className:"h-4 w-4"})," Request support"]})]})})]})]})}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"Admin Settings Hub v2: single umbrella page linking to all CorporatePay settings. Includes search, category filters, pinned shortcuts, role-gated access requests, and a readiness snapshot."})})]})}),e.jsxs(RB,{open:W,title:"Request access",subtitle:"This creates a request for Org Admin to grant permissions.",onClose:()=>L(!1),actions:[{label:"Submit",onClick:Fe}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(pr,{variant:"outline",onClick:()=>L(!1),children:"Cancel"}),e.jsxs(pr,{variant:"primary",onClick:Fe,children:[e.jsx(ct,{className:"h-4 w-4"})," Submit"]})]}),children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Role"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:j}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:"Setting"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:R})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("textarea",{value:te,onChange:pe=>oe(pe.target.value),placeholder:"Explain why you need access and for how long",rows:4,className:"w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Requests should be auditable and time-bounded in production."})]})]})]})}function $B({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:En(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:En("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}const fx={green:"#03CD8C",orange:"#F77F00"};function Na(...t){return t.filter(Boolean).join(" ")}function qr(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function bd(t,s,a){return Math.max(s,Math.min(a,t))}function EC(t){return new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"2-digit"})}function vi(t){return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function Ab(t){const s=Date.now()-t,a=Math.floor(s/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}function MC(t){const s=new Date(t),a=c=>String(c).padStart(2,"0"),l=s.getFullYear(),n=a(s.getMonth()+1),r=a(s.getDate()),i=a(s.getHours()),o=a(s.getMinutes());return`${l}-${n}-${r}T${i}:${o}`}function PC(t){const s=new Date(t).getTime();return Number.isFinite(s)?s:Date.now()}function zh(t){return new Date(t).getHours()}function Wh(t){return`UGX ${Math.round(Number(t||0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}function LB(t,s="06:00",a="22:00"){const l=new Date(t),n=l.getHours()*60+l.getMinutes(),r=c=>{const[x,j]=c.split(":").map(g=>Number(g));return(x||0)*60+(j||0)},i=r(s),o=r(a);return n<i||n>o}function Eb(t){return t>=7&&t<=9||t>=17&&t<=20}function ut({label:t,tone:s="neutral"}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Na("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function ts({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:fx.green}:t==="accent"?{background:fx.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Na(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function $m({enabled:t,onChange:s,label:a,description:l}){return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a}),l?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:l}):null]}),e.jsx("button",{type:"button",className:Na("relative h-7 w-12 rounded-full border transition",t?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>s(!t),"aria-label":a,children:e.jsx("span",{className:Na("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",t?"left-[22px]":"left-1")})})]})}function zr({label:t,value:s,onChange:a,placeholder:l,hint:n,type:r="text",disabled:i}){return e.jsxs("div",{className:Na(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("input",{type:r,value:s,onChange:o=>a(o.target.value),placeholder:l,disabled:i,className:Na("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function Wr({label:t,value:s,onChange:a,hint:l,disabled:n}){return e.jsxs("div",{className:Na(n&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),l?e.jsx("div",{className:"text-xs text-slate-500",children:l}):null]}),e.jsx("input",{type:"number",value:s,onChange:r=>a(Number(r.target.value||0)),disabled:n,className:Na("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",n?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function hr({label:t,value:s,onChange:a,options:l,hint:n,disabled:r}){return e.jsxs("div",{className:Na(r&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("select",{value:s,onChange:i=>a(i.target.value),disabled:r,className:Na("mt-2 w-full rounded-2xl border px-3 py-2.5 text-sm font-semibold outline-none focus:ring-4",r?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100"),children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function OC({label:t,value:s,onChange:a,placeholder:l,hint:n,rows:r=4,disabled:i}){return e.jsxs("div",{className:Na(i&&"opacity-70"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:t}),n?e.jsx("div",{className:"text-xs text-slate-500",children:n}):null]}),e.jsx("textarea",{value:s,onChange:o=>a(o.target.value),placeholder:l,rows:r,disabled:i,className:Na("mt-2 w-full rounded-2xl border p-3 text-sm font-semibold shadow-sm outline-none focus:ring-4",i?"border-slate-200 bg-slate-50 text-slate-500":"border-slate-200 bg-white text-slate-900 focus:ring-emerald-100")})]})}function sM({actions:t}){const[s,a]=d.useState(!1),l=qt.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:Na("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function Mb({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="980px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:12,scale:.985},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:12,scale:.985},transition:{duration:.18},className:"fixed inset-x-0 top-[7vh] z-50 mx-auto w-[min(1040px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(sM,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[72vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function FB({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,actions:i}){return d.useEffect(()=>{const o=c=>c.key==="Escape"&&n();return t&&window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,x:18},animate:{opacity:1,x:0},exit:{opacity:0,x:18},transition:{duration:.18},className:Na("fixed z-50 overflow-hidden border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]","left-2 right-2 bottom-2 top-[10vh] rounded-[28px]","lg:left-auto lg:right-4 lg:top-4 lg:bottom-4 lg:w-[760px]"),role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-base font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i&&e.jsx(sM,{actions:i}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"h-full min-h-0 overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function UB({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(480px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Na("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function vl({title:t,subtitle:s,right:a,children:l}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:s}):null]}),a]}),e.jsx("div",{className:"mt-4",children:l})]})}function Lm({title:t,subtitle:s}){return e.jsxs("div",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-slate-100 text-slate-700",children:e.jsx(Hx,{className:"h-6 w-6"})}),e.jsx("div",{className:"mt-3 text-sm font-semibold text-slate-900",children:t}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:s})]})}function Pb(t){return t==="Completed"?"good":t==="In progress"||t==="Confirmed"?"info":t==="Pending approval"?"warn":t==="Cancelled"?"bad":"neutral"}function Hh(t){return t==="Approved"?"good":t==="Rejected"?"bad":"warn"}function TC(t){return t==="Online"?"good":t==="Limited"?"warn":"bad"}function Ic(t){return`${t}-${Math.floor(100+Math.random()*900)}`}function RC(t){const s=t.some(l=>l.includes("DC")||l.includes("VIP")||l.includes("Priority")),a=[{role:"Manager",slaHours:8},{role:"Finance",slaHours:12}];return s&&a.push({role:"CFO",slaHours:24}),a}function VB(){var E,u,P,se,D,re,v,k,m,S;const t=Date.now(),s=["Operations","Office commute","Delivery","Executive","Event","Visitor","Other"],a=["Type 2 (AC)","CCS2 (DC)","GB/T (DC)","CHAdeMO (DC)"],[l,n]=d.useState([]),r=f=>{const U=qr("toast");n(p=>[{id:U,...f},...p].slice(0,4)),window.setTimeout(()=>n(p=>p.filter(M=>M.id!==U)),3200)},[i,o]=d.useState(()=>({workStart:"06:00",workEnd:"22:00",requirePurpose:!0,requireProjectTag:!0,requireCostCenter:!0,dcRequiresApproval:!0,priorityRequiresApproval:!0,maxKWhPerSession:60,maxBudgetUGXPerSession:5e5,peakHourThreshold:5})),[c]=d.useState(()=>[{id:"SITE-UG-HQ",name:"Kampala HQ Charging",city:"Kampala",address:"Kampala HQ, Nsambya",operator:"EVzone",status:"Online",reliabilityPct:96,connectors:[{connector:"Type 2 (AC)",powerKW:22,count:4,priceUGXPerKWh:850},{connector:"CCS2 (DC)",powerKW:60,count:2,priceUGXPerKWh:1200}]},{id:"SITE-UG-EBB",name:"Entebbe Airport Fast Hub",city:"Entebbe",address:"Entebbe Airport Road",operator:"Partner CPO",status:"Limited",reliabilityPct:88,connectors:[{connector:"CCS2 (DC)",powerKW:120,count:2,priceUGXPerKWh:1450},{connector:"CHAdeMO (DC)",powerKW:50,count:1,priceUGXPerKWh:1400}]},{id:"SITE-UG-JJA",name:"Jinja Road Hub",city:"Wakiso",address:"Jinja Road",operator:"EVzone",status:"Online",reliabilityPct:92,connectors:[{connector:"Type 2 (AC)",powerKW:11,count:6,priceUGXPerKWh:800},{connector:"CCS2 (DC)",powerKW:60,count:1,priceUGXPerKWh:1200}]}]),[x]=d.useState(()=>[{id:"VEH-001",label:"Company EV 01",ownerType:"Company",ownerName:"Acme Fleet",group:"Operations",costCenter:"OPS-001",vip:!1,batteryKWh:62},{id:"VEH-002",label:"Company EV 02",ownerType:"Company",ownerName:"Acme Fleet",group:"Operations",costCenter:"OPS-001",vip:!1,batteryKWh:62},{id:"VEH-003",label:"Employee EV (John)",ownerType:"Employee",ownerName:"John S.",group:"Sales",costCenter:"SALES-TRAVEL",vip:!1,batteryKWh:50},{id:"VEH-004",label:"Executive EV",ownerType:"Employee",ownerName:"Irene K.",group:"Operations",costCenter:"OPS-001",vip:!0,batteryKWh:75},{id:"VEH-005",label:"Visitor EV",ownerType:"Visitor",ownerName:"Alex Chen",group:"Sales",costCenter:"SALES-TRAVEL",vip:!0,batteryKWh:70}]),j=d.useMemo(()=>Object.fromEntries(c.map(f=>[f.id,f])),[c]),g=d.useMemo(()=>Object.fromEntries(x.map(f=>[f.id,f])),[x]),[y,$]=d.useState(()=>[{id:"VX-001",vehicleId:"VEH-004",exceptionType:"DC fast",validFrom:t-3*864e5,validTo:t+30*864e5,requestedBy:"Org Admin",status:"Approved",reason:"Executive charging allowance",approvalId:"APR-EX-001"}]),[T,C]=d.useState(()=>{const U=t-108e5;return[{id:"APR-001",createdAt:U,createdBy:"Charging Coordinator",status:"Pending",scope:"Session",scopeId:"CS-001",reason:"Visitor VIP requested DC fast at Airport",flags:["VIP","DC"],steps:RC(["VIP","DC"]).map(p=>({id:qr("AS"),role:p.role,assignee:p.role==="Manager"?"Manager":p.role==="Finance"?"Finance Desk":"CFO",status:"Pending",requestedAt:U,slaHours:p.slaHours}))}]}),[W,L]=d.useState(()=>[{id:"PLAN-001",name:"Daily depot top-up",days:["Mon","Tue","Wed","Thu","Fri"],timeLocal:"19:30",siteId:"SITE-UG-HQ",connector:"Type 2 (AC)",durationMins:120,expectedKWh:35,maxBudgetUGX:35e3,purpose:"Operations",tags:["Depot","Operations"],vehicles:["VEH-001","VEH-002"],enabled:!0}]),[R,F]=d.useState(()=>{const p=t+864e5+324e5,M=t+1*864e5+18*36e5,ee=t+2*864e5+7*36e5;return[{id:"CS-001",ref:Ic("CHG"),vehicleId:"VEH-005",bookedBy:"Charging Coordinator",createdAt:t-3*36e5,scheduledAt:p,durationMins:40,siteId:"SITE-UG-EBB",connector:"CCS2 (DC)",expectedKWh:45,maxBudgetUGX:12e4,purpose:"Visitor",tags:["VIP","Airport"],costCenter:"SALES-TRAVEL",projectTag:"Roadshow",module:"EVs & Charging",status:"Pending approval",policyNotes:["VIP","DC fast"],proofs:[]},{id:"CS-002",ref:Ic("CHG"),vehicleId:"VEH-001",bookedBy:"Charging Coordinator",createdAt:t-90*60*1e3,scheduledAt:M,durationMins:120,siteId:"SITE-UG-HQ",connector:"Type 2 (AC)",expectedKWh:30,maxBudgetUGX:3e4,purpose:"Operations",tags:["Depot"],costCenter:"OPS-001",projectTag:"Daily ops",module:"EVs & Charging",status:"Confirmed",policyNotes:[],proofs:[]},{id:"CS-003",ref:Ic("CHG"),vehicleId:"VEH-003",bookedBy:"Charging Coordinator",createdAt:t-2*36e5,scheduledAt:ee,durationMins:60,siteId:"SITE-UG-JJA",connector:"Type 2 (AC)",expectedKWh:25,maxBudgetUGX:25e3,purpose:"Office commute",tags:["Commute"],costCenter:"SALES-TRAVEL",projectTag:"Commute program",module:"EVs & Charging",status:"Confirmed",policyNotes:[],proofs:[]}]}),[te,oe]=d.useState("overview"),[G,H]=d.useState(""),[Y,we]=d.useState("All"),[q,je]=d.useState("All"),[_e,Ee]=d.useState("All"),[be,Fe]=d.useState(!1),[Pe,pe]=d.useState(null),Q=d.useMemo(()=>Pe&&R.find(f=>f.id===Pe)||null,[Pe,R]),[Re,ce]=d.useState(!1),[xe,he]=d.useState(0),[de,ye]=d.useState(()=>{var f,U;return{vehicleId:((f=x[0])==null?void 0:f.id)||"",bookedBy:"Charging Coordinator",scheduledAt:MC(t+24*60*60*1e3),durationMins:60,siteId:((U=c[0])==null?void 0:U.id)||"",connector:"Type 2 (AC)",expectedKWh:25,maxBudgetUGX:25e3,purpose:"Operations",purposeOther:"",tags:"Operations",costCenter:"OPS-001",projectTag:"Charging",prioritySlot:!1}}),[Ke,Le]=d.useState(!1),[Ne,ge]=d.useState(()=>{var f;return{name:"Fleet morning top-up",siteId:((f=c[0])==null?void 0:f.id)||"",startAt:MC(t+2*24*60*60*1e3+8*60*60*1e3),intervalMins:20,durationMins:40,connector:"Type 2 (AC)",expectedKWh:18,maxBudgetUGX:18e3,purpose:"Operations",tags:"Fleet",costCenter:"OPS-001",projectTag:"Fleet plan",vehicleIds:["VEH-001","VEH-002"],prioritySlot:!1}}),[$e,ie]=d.useState(!1),[Oe,Se]=d.useState(()=>({vehicleId:"VEH-004",exceptionType:"DC fast",validDays:30,reason:""})),Te=f=>{var U;return((U=g[f])==null?void 0:U.label)||f},Ge=f=>{const U=g[f];return U?`${U.ownerName} (${U.ownerType})`:"-"},We=(f,U,p)=>y.some(M=>M.vehicleId===f&&M.exceptionType===U&&M.status==="Approved"&&p>=M.validFrom&&p<=M.validTo),ze=f=>{var ae;const U=[],p=LB(f.whenTs,i.workStart,i.workEnd),M=Eb(zh(f.whenTs)),ee=f.connector.includes("DC"),b=!!((ae=g[f.vehicleId])!=null&&ae.vip);return p&&U.push("After-hours"),M&&U.push("Peak tariff"),b&&U.push("VIP"),f.prioritySlot&&U.push("Priority slot"),ee&&U.push("DC fast"),f.expectedKWh>i.maxKWhPerSession&&U.push("Above kWh limit"),f.maxBudgetUGX>i.maxBudgetUGXPerSession&&U.push("Above budget limit"),{flags:U,after:p,peak:M,vip:b,isDC:ee}},Ue=d.useMemo(()=>{const f=PC(de.scheduledAt),U=[];i.requirePurpose&&(!de.purpose||de.purpose==="Other"&&!de.purposeOther.trim())&&U.push("Purpose required"),i.requireCostCenter&&!de.costCenter.trim()&&U.push("Cost center required"),i.requireProjectTag&&!de.projectTag.trim()&&U.push("Project tag required");const p=ze({whenTs:f,connector:de.connector,prioritySlot:de.prioritySlot,expectedKWh:de.expectedKWh,maxBudgetUGX:de.maxBudgetUGX,vehicleId:de.vehicleId});let M=!1;p.isDC&&i.dcRequiresApproval&&!We(de.vehicleId,"DC fast",f)&&(M=!0),de.prioritySlot&&i.priorityRequiresApproval&&!We(de.vehicleId,"Priority slot",f)&&(M=!0),p.after&&!We(de.vehicleId,"After-hours",f)&&(M=!0),(de.expectedKWh>i.maxKWhPerSession||de.maxBudgetUGX>i.maxBudgetUGXPerSession)&&(M=!0),p.vip&&(p.isDC||de.prioritySlot||p.after)&&(M=!0);const ee=U.length===0,b=p.peak?"Consider scheduling 30-60 minutes earlier or later to avoid peak tariff.":"No peak tariff warning.",ae=p.flags.filter(O=>O!=="Peak tariff"),ve=p.isDC&&We(de.vehicleId,"DC fast",f)||de.prioritySlot&&We(de.vehicleId,"Priority slot",f)||p.after&&We(de.vehicleId,"After-hours",f);return{whenTs:f,requiredErrors:U,...p,needsApproval:M,canCreate:ee,suggestion:b,approvalFlags:ae,hasActiveVipException:ve}},[de,i,y,g]),le=d.useMemo(()=>{const f=G.trim().toLowerCase();return R.filter(U=>Y==="All"?!0:U.status===Y).filter(U=>q==="All"?!0:U.vehicleId===q).filter(U=>_e==="All"?!0:U.siteId===_e).filter(U=>{if(!f)return!0;const p=g[U.vehicleId],M=j[U.siteId];return`${U.ref} ${U.id} ${(p==null?void 0:p.label)||""} ${(p==null?void 0:p.ownerName)||""} ${(M==null?void 0:M.name)||""} ${U.connector} ${U.purpose} ${U.tags.join(" ")} ${U.costCenter} ${U.projectTag}`.toLowerCase().includes(f)}).slice().sort((U,p)=>U.scheduledAt-p.scheduledAt)},[R,G,Y,q,_e,g,j]),z=d.useMemo(()=>R.filter(f=>f.scheduledAt>t&&f.status!=="Cancelled"),[R,t]),Ae=d.useMemo(()=>{const f=Array.from({length:24},()=>0);for(const U of z)f[zh(U.scheduledAt)]+=1;return f},[z]),Ve=d.useMemo(()=>{let f=0,U=-1;return Ae.forEach((p,M)=>{p>U&&(U=p,f=M)}),{hour:f,count:U}},[Ae]),Ye=Ve.count>=i.peakHourThreshold,Be=d.useMemo(()=>{const f={};for(const M of c)f[M.id]=M.connectors.reduce((ee,b)=>ee+b.count,0);const U={};for(const M of c)U[M.id]=Array.from({length:24},()=>0);for(const M of z){const ee=zh(M.scheduledAt);U[M.siteId][ee]+=1}const p=Object.keys(U).flatMap(M=>U[M].map((ee,b)=>({siteId:M,h:b,count:ee,cap:f[M]||1})).filter(ee=>ee.count>ee.cap)).sort((M,ee)=>ee.count-M.count);return{capBySite:f,booked:U,congested:p}},[z,c]),w=d.useMemo(()=>{const f=R.filter(ee=>["Draft","Pending approval","Confirmed"].includes(ee.status)).length,U=T.filter(ee=>ee.status==="Pending").length,p=T.filter(ee=>ee.status==="Pending"&&ee.flags.some(b=>b.toLowerCase().includes("vip"))).length,M=R.filter(ee=>ee.connector.includes("DC")).length;return{open:f,pendingApprovals:U,vipPending:p,dcCount:M}},[R,T]),B=f=>{pe(f),Fe(!0)},ue=f=>{const U=Date.now(),p={Manager:"Manager",Finance:"Finance Desk",CFO:"CFO",CEO:"CEO"},M=RC(f.flags).map(b=>({id:qr("AS"),role:b.role,assignee:p[b.role],status:"Pending",requestedAt:U,slaHours:b.slaHours})),ee={id:qr("APR"),createdAt:U,createdBy:f.createdBy,status:"Pending",scope:f.scope,scopeId:f.scopeId,reason:f.reason,flags:f.flags,steps:M};return C(b=>[ee,...b]),ee},ne=()=>{if(!Ue.canCreate){r({title:"Fix required fields",message:Ue.requiredErrors.join("  "),kind:"warn"});return}const f=Date.now(),U=qr("CS"),p=de.tags.split(",").map(b=>b.trim()).filter(Boolean).slice(0,12),M=de.purpose==="Other"?de.purposeOther.trim():void 0,ee={id:U,ref:Ic("CHG"),vehicleId:de.vehicleId,bookedBy:de.bookedBy,createdAt:f,scheduledAt:Ue.whenTs,durationMins:bd(de.durationMins,10,360),siteId:de.siteId,connector:de.connector,expectedKWh:Math.max(1,de.expectedKWh),maxBudgetUGX:Math.max(0,de.maxBudgetUGX),purpose:de.purpose,purposeOther:M,tags:p,costCenter:de.costCenter.trim(),projectTag:de.projectTag.trim(),module:"EVs & Charging",status:Ue.needsApproval?"Pending approval":"Confirmed",policyNotes:Ue.flags.filter(b=>!b.endsWith("required")),proofs:[]};F(b=>[ee,...b]),Ue.needsApproval&&ue({scope:"Session",scopeId:ee.id,createdBy:ee.bookedBy,reason:"Policy exception required for EV charging session",flags:Ue.approvalFlags.length?Ue.approvalFlags:["Policy exception"]}),r({title:"Created",message:Ue.needsApproval?"Session created and sent for approval.":"Session confirmed.",kind:"success"}),ce(!1),he(0),oe("sessions")},Me=()=>{const f=PC(Ne.startAt),U=Date.now();if(!Ne.vehicleIds.length){r({title:"No vehicles",message:"Select at least one vehicle.",kind:"warn"});return}const p=[];let M=!1;if(Ne.vehicleIds.forEach((ee,b)=>{const ae=f+b*Ne.intervalMins*60*1e3,ve=ze({whenTs:ae,connector:Ne.connector,prioritySlot:Ne.prioritySlot,expectedKWh:Ne.expectedKWh,maxBudgetUGX:Ne.maxBudgetUGX,vehicleId:ee}).flags,O=ve.some(X=>X==="After-hours"||X==="DC fast"||X==="Priority slot"||X==="VIP");M=M||O,p.push({id:qr("CS"),ref:Ic("FLT"),vehicleId:ee,bookedBy:"Charging Coordinator",createdAt:U,scheduledAt:ae,durationMins:bd(Ne.durationMins,10,360),siteId:Ne.siteId,connector:Ne.connector,expectedKWh:Math.max(1,Ne.expectedKWh),maxBudgetUGX:Math.max(0,Ne.maxBudgetUGX),purpose:Ne.purpose,tags:Ne.tags.split(",").map(X=>X.trim()).filter(Boolean),costCenter:Ne.costCenter,projectTag:Ne.projectTag,module:"EVs & Charging",status:O?"Pending approval":"Confirmed",policyNotes:ve.filter(X=>X!=="Peak tariff"),proofs:[]})}),F(ee=>[...p,...ee]),M){const ee=Array.from(new Set(p.flatMap(b=>b.policyNotes))).filter(Boolean);ue({scope:"Fleet plan",scopeId:qr("PLANRUN"),createdBy:"Charging Coordinator",reason:`Bulk fleet charging requires policy approval (${p.filter(b=>b.status==="Pending approval").length} pending).`,flags:ee.length?ee:["Bulk charging"]})}r({title:"Bulk created",message:`Created ${p.length} session(s).`,kind:"success"}),Le(!1),oe("sessions")},De=f=>{const U=Date.now();C(p=>p.map(M=>{if(M.id!==f)return M;const ee=M.steps.findIndex(ve=>ve.status==="Pending");if(ee<0)return M;const b=M.steps.slice();b[ee]={...b[ee],status:"Approved",decidedAt:U,note:"Approved"};const ae=b.every(ve=>ve.status==="Approved");return{...M,steps:b,status:ae?"Approved":"Pending"}})),setTimeout(()=>{C(p=>{const M=p.find(ee=>ee.id===f);return!M||M.status!=="Approved"||(M.scope==="Session"&&F(ee=>ee.map(b=>b.id===M.scopeId?{...b,status:"Confirmed"}:b)),M.scope==="VIP Exception"&&$(ee=>ee.map(b=>b.approvalId===M.id?{...b,status:"Approved"}:b)),r({title:"Approved",message:"Approval progressed.",kind:"success"})),p})},0)},fe=f=>{const U=Date.now();C(M=>M.map(ee=>{if(ee.id!==f)return ee;const b=ee.steps.findIndex(ve=>ve.status==="Pending"),ae=ee.steps.slice();return b>=0&&(ae[b]={...ae[b],status:"Rejected",decidedAt:U,note:"Rejected"}),{...ee,steps:ae,status:"Rejected"}}));const p=T.find(M=>M.id===f);(p==null?void 0:p.scope)==="Session"&&F(M=>M.map(ee=>ee.id===p.scopeId?{...ee,status:"Cancelled",policyNotes:[...ee.policyNotes,"Rejected"]}:ee)),r({title:"Rejected",message:"Approval rejected.",kind:"warn"})},me=()=>{if(!Oe.reason.trim()){r({title:"Missing",message:"Add a reason.",kind:"warn"});return}const U=Date.now(),p={id:qr("VX"),vehicleId:Oe.vehicleId,exceptionType:Oe.exceptionType,validFrom:U,validTo:U+bd(Oe.validDays,1,365)*864e5,requestedBy:"Org Admin",status:"Pending",reason:Oe.reason.trim()},M=["VIP",Oe.exceptionType==="DC fast"?"DC":Oe.exceptionType==="Priority slot"?"Priority":"After-hours"],ee=ue({scope:"VIP Exception",scopeId:p.id,createdBy:p.requestedBy,reason:p.reason,flags:M});p.approvalId=ee.id,$(b=>[p,...b]),r({title:"Requested",message:"VIP exception requested and routed to approvals.",kind:"success"}),ie(!1),oe("approvals")},Xe=()=>{const f=le.map(X=>{const A=g[X.vehicleId],N=j[X.siteId];return{ref:X.ref,status:X.status,when:vi(X.scheduledAt),vehicle:(A==null?void 0:A.label)||X.vehicleId,owner:A?`${A.ownerName} (${A.ownerType})`:"-",site:(N==null?void 0:N.name)||X.siteId,connector:X.connector,expectedKWh:X.expectedKWh,maxBudgetUGX:X.maxBudgetUGX,purpose:X.purpose==="Other"?X.purposeOther||"Other":X.purpose,tags:X.tags.join(";"),costCenter:X.costCenter,projectTag:X.projectTag,policyNotes:X.policyNotes.join(";")}}),U=Object.keys(f[0]||{ref:""}),p=X=>{const A=String(X??"");return/[",\n]/.test(A)?`"${A.replace(/"/g,'""')}"`:A},M=U.join(","),ee=f.map(X=>U.map(A=>p(X[A])).join(",")).join(`
`),b=`${M}
${ee}`,ae=new Blob([b],{type:"text/csv"}),ve=URL.createObjectURL(ae),O=document.createElement("a");O.href=ve,O.download="corporate-ev-charging-sessions.csv",O.click(),URL.revokeObjectURL(ve),r({title:"Exported",message:"Sessions CSV downloaded.",kind:"success"})};return e.jsxs("div",{className:"min-h-screen",style:{background:"radial-gradient(90% 60% at 50% 0%, rgba(3,205,140,0.18), rgba(255,255,255,0))"},children:[e.jsx(UB,{toasts:l,onDismiss:f=>n(U=>U.filter(p=>p.id!==f))}),e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 py-6 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-white px-4 py-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:fx.green},children:e.jsx(Hx,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Corporate EV Charging Scheduling"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Pre-book charging sessions for employees, visitors, and company vehicles. Enforce purpose tagging, coordinate bulk plans, and handle VIP exceptions with approvals."}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(ut,{label:`Open: ${w.open}`,tone:w.open?"warn":"good"}),e.jsx(ut,{label:`Approvals: ${w.pendingApprovals}`,tone:w.pendingApprovals?"warn":"good"}),e.jsx(ut,{label:`VIP pending: ${w.vipPending}`,tone:w.vipPending?"warn":"good"}),e.jsx(ut,{label:`DC sessions: ${w.dcCount}`,tone:w.dcCount?"info":"neutral"}),e.jsx(ut,{label:Ye?`Peak hour: ${Ve.hour}:00 (${Ve.count})`:`Peak hour: ${Ve.hour}:00`,tone:Ye?"warn":"neutral"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ts,{variant:"outline",onClick:Xe,children:[e.jsx(pt,{className:"h-4 w-4"})," Export CSV"]}),e.jsxs(ts,{variant:"outline",onClick:()=>Le(!0),children:[e.jsx(Os,{className:"h-4 w-4"})," Bulk fleet plan"]}),e.jsxs(ts,{variant:"primary",onClick:()=>{ce(!0),he(0)},children:[e.jsx(gt,{className:"h-4 w-4"})," New session"]})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:[{id:"overview",label:"Overview"},{id:"sessions",label:"Sessions"},{id:"sites",label:"Sites"},{id:"recurring",label:"Recurring"},{id:"vip",label:"VIP"},{id:"approvals",label:"Approvals"},{id:"insights",label:"Insights"}].map(f=>e.jsx("button",{className:Na("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",te===f.id?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:te===f.id?{background:fx.green}:void 0,onClick:()=>oe(f.id),children:f.label},f.id))})]}),e.jsxs("div",{className:"bg-slate-50 px-4 py-5 md:px-6",children:[te==="overview"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsxs(vl,{title:"Upcoming sessions",subtitle:"Next scheduled sessions across all sites.",right:e.jsx(ut,{label:`${z.length} upcoming`,tone:z.length?"info":"neutral"}),children:[e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"When"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vehicle"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Site"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Connector"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Purpose"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Action"})]})}),e.jsxs("tbody",{children:[z.slice().sort((f,U)=>f.scheduledAt-U.scheduledAt).slice(0,7).map(f=>{const U=g[f.vehicleId],p=j[f.siteId],M=Eb(zh(f.scheduledAt));return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-3 text-slate-700",children:vi(f.scheduledAt)}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:(U==null?void 0:U.label)||f.vehicleId}),U!=null&&U.vip?e.jsx(ut,{label:"VIP",tone:"info"}):null,e.jsx(ut,{label:U?U.ownerType:"-",tone:"neutral"}),M?e.jsx(ut,{label:"Peak",tone:"warn"}):e.jsx(ut,{label:"Off-peak",tone:"good"})]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:U?`${U.ownerName}  ${U.costCenter}`:"-"})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(p==null?void 0:p.name)||f.siteId}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx(ut,{label:f.connector,tone:f.connector.includes("DC")?"info":"neutral"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[f.expectedKWh," kWh  ",f.durationMins," min"]})]}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx(ut,{label:f.purpose==="Other"?f.purposeOther||"Other":f.purpose,tone:"neutral"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[f.tags.slice(0,3).join(", "),f.tags.length>3?"":""]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ut,{label:f.status,tone:Pb(f.status)})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(ts,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>B(f.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]})})]},f.id)}),z.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10",children:e.jsx(Lm,{title:"No upcoming sessions",subtitle:"Create a new charging session or run a recurring plan."})})})]})]})}),Be.congested.length?e.jsxs("div",{className:"mt-3 rounded-2xl bg-rose-50 p-3 text-xs text-rose-800 ring-1 ring-rose-200",children:["Congestion risk: ",((E=j[Be.congested[0].siteId])==null?void 0:E.name)||Be.congested[0].siteId," at ",Be.congested[0].h,":00 is over capacity (",Be.congested[0].count,"/",Be.congested[0].cap,")."]}):Ye?e.jsxs("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:["Smart scheduling: peak hour detected around ",Ve.hour,":00. Consider off-peak scheduling or distributing sessions across sites."]}):e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Smart scheduling: no peak congestion detected in upcoming sessions."})]}),e.jsxs(vl,{title:"Policy guardrails",subtitle:"Purpose enforcement, limits, and approvals.",right:e.jsx(ut,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx($m,{enabled:i.requirePurpose,onChange:f=>o(U=>({...U,requirePurpose:f})),label:"Require purpose",description:"Purpose stored for reporting and audits."}),e.jsx($m,{enabled:i.requireProjectTag,onChange:f=>o(U=>({...U,requireProjectTag:f})),label:"Require project tag",description:"Used for chargeback and analytics."}),e.jsx($m,{enabled:i.requireCostCenter,onChange:f=>o(U=>({...U,requireCostCenter:f})),label:"Require cost center",description:"Enforced on creation."}),e.jsx($m,{enabled:i.dcRequiresApproval,onChange:f=>o(U=>({...U,dcRequiresApproval:f})),label:"DC requires approval",description:"DC fast charging is approval-gated."}),e.jsx($m,{enabled:i.priorityRequiresApproval,onChange:f=>o(U=>({...U,priorityRequiresApproval:f})),label:"Priority requires approval",description:"Priority slot requests require approval."}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Limits"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3",children:[e.jsx(Wr,{label:"Max kWh per session",value:i.maxKWhPerSession,onChange:f=>o(U=>({...U,maxKWhPerSession:Math.max(1,f)})),hint:"kWh"}),e.jsx(Wr,{label:"Max budget per session",value:i.maxBudgetUGXPerSession,onChange:f=>o(U=>({...U,maxBudgetUGXPerSession:Math.max(0,f)})),hint:"UGX"})]})]})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:["Working hours: ",i.workStart," to ",i.workEnd,". After-hours sessions require approval unless an exception is active."]})]})]}),e.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[e.jsx(vl,{title:"Sites",subtitle:"Operational health and pricing.",right:e.jsx(ut,{label:`${c.length}`,tone:"neutral"}),children:e.jsx("div",{className:"space-y-2",children:c.map(f=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:f.name}),e.jsx(ut,{label:f.status,tone:TC(f.status)}),e.jsx(ut,{label:`${f.reliabilityPct}%`,tone:f.reliabilityPct>=90?"good":f.reliabilityPct>=80?"warn":"bad"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[f.city,"  ",f.operator]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Connectors: ",f.connectors.reduce((U,p)=>U+p.count,0)," total"]})]}),e.jsxs(ts,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{oe("sites"),Ee(f.id),r({title:"Filtered",message:"Showing sessions for this site.",kind:"info"})},children:[e.jsx(et,{className:"h-4 w-4"})," View"]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[f.connectors.slice(0,3).map(U=>e.jsx(ut,{label:`${U.connector}  ${U.powerKW}kW`,tone:U.connector.includes("DC")?"info":"neutral"},`${f.id}-${U.connector}`)),f.connectors.length>3?e.jsx(ut,{label:"+more",tone:"neutral"}):null]})]},f.id))})}),e.jsxs(vl,{title:"Approvals",subtitle:"Policy exceptions and VIP handling.",right:e.jsx(ut,{label:`${T.filter(f=>f.status==="Pending").length}`,tone:T.filter(f=>f.status==="Pending").length?"warn":"good"}),children:[e.jsxs("div",{className:"space-y-2",children:[T.filter(f=>f.status==="Pending").slice(0,4).map(f=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ut,{label:f.scope,tone:"neutral"}),e.jsx(ut,{label:f.status,tone:Hh(f.status)}),e.jsx(ut,{label:`${f.steps.filter(U=>U.status==="Pending").length} step(s)`,tone:"info"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:f.reason}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[Ab(f.createdAt),"  ",f.createdBy]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(ts,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>De(f.id),children:[e.jsx(tt,{className:"h-4 w-4"})," Approve"]}),e.jsxs(ts,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>fe(f.id),children:[e.jsx(Qe,{className:"h-4 w-4"})," Reject"]})]})]})},f.id)),T.filter(f=>f.status==="Pending").length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No pending approvals."})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(ts,{variant:"outline",onClick:()=>oe("approvals"),children:[e.jsx(et,{className:"h-4 w-4"})," Open approvals"]}),e.jsxs(ts,{variant:"outline",onClick:()=>ie(!0),children:[e.jsx(Qr,{className:"h-4 w-4"})," VIP exception"]})]})]})]})]}):null,te==="sessions"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(vl,{title:"Search and filters",subtitle:"Coordinator view",right:e.jsx(ut,{label:"Core",tone:"neutral"}),children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Search"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-2 py-2",children:[e.jsx(pa,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:G,onChange:f=>H(f.target.value),placeholder:"ref, vehicle, site, tag...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsx(hr,{label:"Status",value:Y,onChange:f=>we(f),options:[{value:"All",label:"All"},...["Draft","Pending approval","Confirmed","In progress","Completed","Cancelled"].map(f=>({value:f,label:f}))]}),e.jsx(hr,{label:"Vehicle",value:q,onChange:je,options:[{value:"All",label:"All"},...x.map(f=>({value:f.id,label:f.label}))]}),e.jsx(hr,{label:"Site",value:_e,onChange:Ee,options:[{value:"All",label:"All"},...c.map(f=>({value:f.id,label:f.name}))]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(ts,{variant:"outline",onClick:()=>{H(""),we("All"),je("All"),Ee("All"),r({title:"Reset",message:"Filters reset.",kind:"info"})},children:[e.jsx(vn,{className:"h-4 w-4"})," Reset"]}),e.jsxs(ts,{variant:"outline",onClick:Xe,children:[e.jsx(pt,{className:"h-4 w-4"})," CSV"]}),e.jsxs(ts,{variant:"primary",onClick:()=>ce(!0),children:[e.jsx(gt,{className:"h-4 w-4"})," New"]})]})]}),e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Best practice: store purpose tags, cost center, and project tag on every charging session."})]})}),e.jsx("div",{className:"lg:col-span-8",children:e.jsx(vl,{title:"Sessions",subtitle:"Pre-booked corporate charging sessions.",right:e.jsx(ut,{label:`${le.length}`,tone:"neutral"}),children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Ref"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"When"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Vehicle"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Site"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"kWh and budget"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Actions"})]})}),e.jsxs("tbody",{children:[le.map(f=>{const U=g[f.vehicleId],p=j[f.siteId];return e.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:f.ref}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:f.id})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:vi(f.scheduledAt)}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:(U==null?void 0:U.label)||f.vehicleId}),U!=null&&U.vip?e.jsx(ut,{label:"VIP",tone:"info"}):null,e.jsx(ut,{label:U?U.ownerType:"-",tone:"neutral"})]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:U?`${U.ownerName}  ${U.costCenter}`:"-"})]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:(p==null?void 0:p.name)||f.siteId}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx(ut,{label:`${f.expectedKWh} kWh`,tone:"neutral"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Budget ",Wh(f.maxBudgetUGX),"  ",f.connector]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ut,{label:f.status,tone:Pb(f.status)})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(ts,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>B(f.id),children:[e.jsx(et,{className:"h-4 w-4"})," Open"]})})]},f.id)}),le.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10",children:e.jsx(Lm,{title:"No sessions",subtitle:"Create a session or change filters."})})})]})]})})})})]}):null,te==="sites"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsx(vl,{title:"Charging sites",subtitle:"Status, reliability, and connectors.",right:e.jsx(ut,{label:"Core",tone:"neutral"}),children:e.jsx("div",{className:"space-y-2",children:c.map(f=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:f.name}),e.jsx(ut,{label:f.status,tone:TC(f.status)}),e.jsx(ut,{label:`${f.reliabilityPct}%`,tone:f.reliabilityPct>=90?"good":f.reliabilityPct>=80?"warn":"bad"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[f.city,"  ",f.operator]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:f.address})]}),e.jsxs(ts,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{Ee(f.id),oe("sessions"),r({title:"Filtered",message:"Showing sessions for this site.",kind:"info"})},children:[e.jsx(et,{className:"h-4 w-4"})," Sessions"]})]}),e.jsx("div",{className:"mt-3 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-xs text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Connector"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Power"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Count"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Price"})]})}),e.jsx("tbody",{children:f.connectors.map(U=>e.jsxs("tr",{className:"border-t border-slate-100",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx(ut,{label:U.connector,tone:U.connector.includes("DC")?"info":"neutral"})}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[U.powerKW," kW"]}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:U.count}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[Wh(U.priceUGXPerKWh)," / kWh"]})]},`${f.id}-${U.connector}-${U.powerKW}`))})]})})]},f.id))})})}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsx(vl,{title:"Site utilization",subtitle:"Premium: detect over-capacity time windows.",right:e.jsx(ut,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Over-capacity alerts"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"If sessions scheduled exceed connector capacity per hour."}),e.jsxs("div",{className:"mt-3 space-y-2",children:[Be.congested.slice(0,6).map(f=>{var U;return e.jsxs("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 p-3 text-xs text-rose-800",children:[((U=j[f.siteId])==null?void 0:U.name)||f.siteId," at ",f.h,":00 is over capacity (",f.count,"/",f.cap,")."]},`${f.siteId}-${f.h}`)}),Be.congested.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No over-capacity windows detected."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Premium: you can add load management rules and stagger sessions by connector power."})]})})})]}):null,te==="recurring"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-6 space-y-4",children:e.jsxs(vl,{title:"Recurring plans",subtitle:"Core: recurring charging schedules.",right:e.jsx(ut,{label:`${W.length}`,tone:"neutral"}),children:[e.jsxs("div",{className:"space-y-2",children:[W.map(f=>{var U;return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:f.name}),e.jsx(ut,{label:f.enabled?"Enabled":"Disabled",tone:f.enabled?"good":"neutral"}),e.jsx(ut,{label:f.timeLocal,tone:"neutral"}),e.jsx(ut,{label:f.connector.includes("DC")?"DC":"AC",tone:f.connector.includes("DC")?"info":"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Days: ",f.days.join(", ")]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Site: ",((U=j[f.siteId])==null?void 0:U.name)||f.siteId]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Vehicles: ",f.vehicles.map(p=>{var M;return((M=g[p])==null?void 0:M.label)||p}).join(", ")]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(ts,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{L(p=>p.map(M=>M.id===f.id?{...M,enabled:!M.enabled}:M)),r({title:"Updated",message:"Plan updated.",kind:"success"})},children:[e.jsx(IE,{className:"h-4 w-4"})," Toggle"]}),e.jsxs(ts,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{const p=Date.now()+1728e5,[M,ee]=f.timeLocal.split(":").map(X=>Number(X)),b=new Date(p);b.setHours(M||0,ee||0,0,0);const ae=b.getTime(),ve=f.vehicles.map(X=>{var h;const A=ze({whenTs:ae,connector:f.connector,prioritySlot:!1,expectedKWh:f.expectedKWh,maxBudgetUGX:f.maxBudgetUGX,vehicleId:X}).flags,N=A.some(K=>K==="After-hours"||K==="DC fast"||K==="VIP");return{id:qr("CS"),ref:Ic("RC"),vehicleId:X,bookedBy:"Charging Coordinator",createdAt:Date.now(),scheduledAt:ae,durationMins:f.durationMins,siteId:f.siteId,connector:f.connector,expectedKWh:f.expectedKWh,maxBudgetUGX:f.maxBudgetUGX,purpose:f.purpose,tags:f.tags,costCenter:((h=g[X])==null?void 0:h.costCenter)||"OPS-001",projectTag:f.name,module:"EVs & Charging",status:N?"Pending approval":"Confirmed",policyNotes:A.filter(K=>K!=="Peak tariff"),proofs:[]}});F(X=>[...ve,...X]),ve.some(X=>X.status==="Pending approval")&&ue({scope:"Fleet plan",scopeId:f.id,createdBy:"Charging Coordinator",reason:"Recurring plan generated sessions requiring approval",flags:Array.from(new Set(ve.flatMap(X=>X.policyNotes))).filter(Boolean)}),r({title:"Generated",message:`Created ${ve.length} session(s) from plan.`,kind:"success"}),oe("sessions")},disabled:!f.enabled,title:f.enabled?"":"Enable plan first",children:[e.jsx(ht,{className:"h-4 w-4"})," Generate"]})]})]})},f.id)}),W.length?null:e.jsx(Lm,{title:"No plans",subtitle:"Create a recurring charging plan."})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: plans can be extended with tariff calendars and site load constraints."})]})}),e.jsx("div",{className:"lg:col-span-6 space-y-4",children:e.jsxs(vl,{title:"Best practices",subtitle:"Operational tips",right:e.jsx(ut,{label:"Premium",tone:"info"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"1) Use off-peak windows for depot top-ups"}),e.jsx("li",{children:"2) Stagger sessions by 15-30 minutes to avoid connector contention"}),e.jsx("li",{children:"3) Enforce purpose tags and cost centers for chargeback"}),e.jsx("li",{children:"4) Maintain VIP exceptions with approvals and audit trails"})]})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Tip: Link these approvals to your global Approval Workflow Builder so Corporate Travel and EV Charging share the same governance."})]})})]}):null,te==="vip"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-6 space-y-4",children:e.jsx(vl,{title:"Vehicles",subtitle:"Company, employee, and visitor EVs.",right:e.jsx(ut,{label:`${x.length}`,tone:"neutral"}),children:e.jsx("div",{className:"space-y-2",children:x.map(f=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:f.label}),e.jsx(ut,{label:f.ownerType,tone:"neutral"}),f.vip?e.jsx(ut,{label:"VIP",tone:"info"}):null,e.jsx(ut,{label:`${f.batteryKWh}kWh`,tone:"neutral"})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Owner: ",f.ownerName]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Cost center: ",f.costCenter,"  Group: ",f.group]})]}),e.jsxs(ts,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>{ye(U=>({...U,vehicleId:f.id,category:f.vip?"Premium":"Standard",connector:f.vip?"CCS2 (DC)":"Type 2 (AC)",purpose:f.ownerType==="Visitor"?"Visitor":"Operations",tags:f.vip?"VIP":"Operations",costCenter:f.costCenter,projectTag:f.ownerType==="Visitor"?"Visitor charging":"Charging",prioritySlot:f.vip})),he(1),ce(!0)},children:[e.jsx(Hx,{className:"h-4 w-4"})," Schedule"]})]})},f.id))})})}),e.jsx("div",{className:"lg:col-span-6 space-y-4",children:e.jsxs(vl,{title:"VIP exceptions",subtitle:"Premium: DC, priority slot, after-hours",right:e.jsx(ut,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ts,{variant:"primary",onClick:()=>ie(!0),children:[e.jsx(Qr,{className:"h-4 w-4"})," Request exception"]}),e.jsxs(ts,{variant:"outline",onClick:()=>oe("approvals"),children:[e.jsx(et,{className:"h-4 w-4"})," View approvals"]})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[y.map(f=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ut,{label:f.exceptionType,tone:"neutral"}),e.jsx(ut,{label:f.status,tone:Hh(f.status)}),e.jsx(ut,{label:`${EC(f.validFrom)} to ${EC(f.validTo)}`,tone:"info"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:Te(f.vehicleId)}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Requested by ",f.requestedBy,"  ",f.reason]}),f.approvalId?e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Approval: ",f.approvalId]}):null]}),e.jsx(Qr,{className:Na("h-5 w-5",f.status==="Approved"?"text-amber-500":"text-slate-300")})]})},f.id)),y.length?null:e.jsx(Lm,{title:"No VIP exceptions",subtitle:"Request an exception to allow DC, priority, or after-hours."})]})]})})]}):null,te==="approvals"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-4 space-y-4",children:e.jsxs(vl,{title:"Approvals",subtitle:"Policy exceptions for DC, priority, after-hours.",right:e.jsx(ut,{label:"Core",tone:"neutral"}),children:[e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700",children:"Approvals are required before a session is sent to the station booking engine."}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs(ts,{variant:"primary",onClick:()=>ie(!0),children:[e.jsx(Qr,{className:"h-4 w-4"})," VIP exception"]}),e.jsxs(ts,{variant:"outline",onClick:()=>r({title:"Tip",message:"Map these approvals to your global Approval Workflow Builder.",kind:"info"}),children:[e.jsx(en,{className:"h-4 w-4"})," Tip"]})]})]})}),e.jsx("div",{className:"lg:col-span-8 space-y-4",children:e.jsx(vl,{title:"Approval requests",subtitle:"Approve or reject with audit trail.",right:e.jsx(ut,{label:`${T.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[T.slice().sort((f,U)=>U.createdAt-f.createdAt).map(f=>{const U=f.steps.findIndex(M=>M.status==="Pending"),p=U>=0?f.steps[U]:null;return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ut,{label:f.scope,tone:"neutral"}),e.jsx(ut,{label:f.status,tone:Hh(f.status)}),e.jsx(ut,{label:f.id,tone:"neutral"})]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:f.reason}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Created ",Ab(f.createdAt),"  ",f.createdBy]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:f.flags.map((M,ee)=>e.jsx(ut,{label:M,tone:M.toLowerCase().includes("vip")?"info":"neutral"},`${f.id}-f-${ee}`))}),p?e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:["Next: ",e.jsx("span",{className:"font-semibold",children:p.role})," (",p.assignee,")  SLA ",p.slaHours,"h"]}):null]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ts,{variant:"primary",className:"px-3 py-2 text-xs",onClick:()=>De(f.id),disabled:f.status!=="Pending",children:[e.jsx(tt,{className:"h-4 w-4"})," Approve"]}),e.jsxs(ts,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>fe(f.id),disabled:f.status!=="Pending",children:[e.jsx(Qe,{className:"h-4 w-4"})," Reject"]}),f.scope==="Session"?e.jsxs(ts,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>{B(f.scopeId)},children:[e.jsx(et,{className:"h-4 w-4"})," Open session"]}):null]})]}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2 md:grid-cols-2",children:f.steps.map(M=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:M.role}),e.jsx(ut,{label:M.status,tone:Hh(M.status)})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Assignee: ",M.assignee,"  SLA ",M.slaHours,"h"]}),M.decidedAt?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Decided ",vi(M.decidedAt),"  ",M.note||""]}):null]},M.id))})]},f.id)}),T.length?null:e.jsx(Lm,{title:"No approvals",subtitle:"Policy exceptions will appear here."})]})})})]}):null,te==="insights"?e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-5 space-y-4",children:e.jsx(vl,{title:"Peak tariff detection",subtitle:"Premium: recommend off-peak scheduling.",right:e.jsx(ut,{label:"Premium",tone:"info"}),children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Peak hour"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Upcoming sessions by hour (0-23)"})]}),e.jsx(ut,{label:`${Ve.hour}:00  ${Ve.count}`,tone:Ye?"warn":"neutral"})]}),e.jsx("div",{className:"mt-4 grid grid-cols-6 gap-2 sm:grid-cols-8 md:grid-cols-12",children:Ae.map((f,U)=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-2 text-center",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-700",children:U}),e.jsx("div",{className:Na("mt-2 h-2 rounded-full",Eb(U)?"bg-amber-200":"bg-emerald-200")}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:f})]},U))}),e.jsx("div",{className:"mt-4 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Suggestion: avoid peak tariff windows (7-9 and 17-20) for non-urgent charging. Use AC off-peak top-ups."})]})})}),e.jsx("div",{className:"lg:col-span-7 space-y-4",children:e.jsxs(vl,{title:"Smart recommendations",subtitle:"Next best coordinator actions.",right:e.jsx(ut,{label:"Premium",tone:"info"}),children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{title:"Bulk schedule a fleet top-up",detail:"Use bulk fleet plan to create staged sessions and reduce congestion.",cta:"Bulk plan",onClick:()=>Le(!0)}),e.jsx(V,{title:"Resolve pending approvals",detail:`There are ${T.filter(f=>f.status==="Pending").length} approval request(s) pending.`,cta:"Open approvals",onClick:()=>oe("approvals")}),e.jsx(V,{title:"Create a VIP exception",detail:"For recurring executive DC fast charging, request an approved VIP exception with audit trail.",cta:"Request",onClick:()=>ie(!0)})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"Premium: you can extend this with tariff calendars, dynamic pricing, and station reliability predictions."})]})})]}):null]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 py-6",children:e.jsx("div",{className:"mx-auto max-w-[1400px] px-4 text-xs text-slate-500 md:px-6",children:"Corporate EV Charging Scheduling v2. Core: pre-book sessions, book on behalf, enforce purpose and tags. Premium: bulk fleet booking, VIP exceptions with approvals, and smart peak time insights."})})]})}),e.jsx(FB,{open:be,title:Q?`${Q.ref}  ${Q.connector}`:"Session",subtitle:Q?`${Te(Q.vehicleId)}  ${vi(Q.scheduledAt)}  ${((u=j[Q.siteId])==null?void 0:u.name)||Q.siteId}`:"",onClose:()=>Fe(!1),footer:Q?e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"In production, this links to station reservation and session telemetry."}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ts,{variant:"outline",onClick:()=>{F(f=>f.map(U=>U.id===Q.id?{...U,status:"Cancelled"}:U)),r({title:"Cancelled",message:"Session cancelled.",kind:"warn"}),Fe(!1)},disabled:Q.status==="Cancelled"||Q.status==="Completed",children:[e.jsx(Qe,{className:"h-4 w-4"})," Cancel"]}),e.jsxs(ts,{variant:"primary",onClick:()=>{var b;const f=Date.now(),U=Math.min(Q.expectedKWh,Math.max(1,Math.round(Q.expectedKWh*.92))),p=j[Q.siteId],M=((b=p==null?void 0:p.connectors.find(ae=>ae.connector===Q.connector))==null?void 0:b.priceUGXPerKWh)||900,ee=Math.round(U*M);F(ae=>ae.map(ve=>ve.id===Q.id?{...ve,status:"Completed",proofs:[{id:qr("AT"),name:"Charge receipt.pdf",note:"Receipt",addedAt:f,addedBy:"System"},...ve.proofs],result:{kWhDelivered:U,costUGX:ee,endedAt:f}}:ve)),r({title:"Completed",message:"Session marked completed.",kind:"success"})},disabled:Q.status!=="Confirmed",title:Q.status!=="Confirmed"?"Only confirmed sessions can complete":"",children:[e.jsx(tt,{className:"h-4 w-4"})," Complete"]})]})]}):null,children:Q?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ut,{label:Q.status,tone:Pb(Q.status)}),e.jsx(ut,{label:Q.connector,tone:Q.connector.includes("DC")?"info":"neutral"}),(P=g[Q.vehicleId])!=null&&P.vip?e.jsx(ut,{label:"VIP",tone:"info"}):null]}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-slate-900",children:Te(Q.vehicleId)}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Owner: ",Ge(Q.vehicleId)]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Booked by ",Q.bookedBy,"  Created ",Ab(Q.createdAt)]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Scheduled"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:vi(Q.scheduledAt)}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Budget"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:Wh(Q.maxBudgetUGX)})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Site"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:((se=j[Q.siteId])==null?void 0:se.name)||Q.siteId}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:((D=j[Q.siteId])==null?void 0:D.address)||""})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Plan"}),e.jsxs("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:[Q.expectedKWh," kWh  ",Q.durationMins," min"]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Cost center ",Q.costCenter,"  Project ",Q.projectTag]})]})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Tags"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:Q.tags.length?Q.tags.map((f,U)=>e.jsx(ut,{label:f,tone:"neutral"},`${Q.id}-t-${U}`)):e.jsx(ut,{label:"None",tone:"neutral"})}),e.jsxs("div",{className:"mt-3 text-xs text-slate-600",children:["Purpose: ",Q.purpose==="Other"?Q.purposeOther||"Other":Q.purpose]})]}),Q.policyNotes.length?e.jsxs("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:[e.jsx("div",{className:"font-semibold",children:"Policy notes"}),e.jsx("ul",{className:"mt-2 space-y-1",children:Q.policyNotes.map((f,U)=>e.jsxs("li",{children:[" ",f]},`${Q.id}-pn-${U}`))})]}):null,Q.result?e.jsxs("div",{className:"mt-3 rounded-2xl bg-emerald-50 p-3 text-xs text-emerald-900 ring-1 ring-emerald-200",children:["Completed: ",Q.result.kWhDelivered," kWh  Cost ",Wh(Q.result.costUGX),"  Ended ",vi(Q.result.endedAt)]}):null]}),e.jsx(vl,{title:"Proofs",subtitle:"Receipts and meter logs",right:e.jsx(ut,{label:`${Q.proofs.length}`,tone:"neutral"}),children:e.jsxs("div",{className:"space-y-2",children:[Q.proofs.map(f=>e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:f.name}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[vi(f.addedAt),"  ",f.addedBy]}),f.note?e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["Note: ",f.note]}):null]}),e.jsx(ts,{variant:"outline",className:"px-3 py-2 text-xs",onClick:async()=>{try{await navigator.clipboard.writeText(f.name),r({title:"Copied",message:"Proof name copied.",kind:"success"})}catch{r({title:"Copy failed",message:"Copy manually.",kind:"warn"})}},children:e.jsx(ss,{className:"h-4 w-4"})})]})},f.id)),Q.proofs.length?null:e.jsx("div",{className:"rounded-2xl bg-slate-50 p-3 text-xs text-slate-600",children:"No proofs yet."})]})})]}):null}),e.jsx(Mb,{open:Re,title:"New charging session",subtitle:"Book on behalf. Purpose tags and policy enforcement are required.",onClose:()=>ce(!1),actions:[{label:"Create",onClick:ne}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(ts,{variant:"outline",onClick:()=>ce(!1),children:"Cancel"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ts,{variant:"outline",onClick:()=>he(f=>f>0?f-1:f),disabled:xe===0,children:"Back"}),xe<2?e.jsxs(ts,{variant:"primary",onClick:()=>he(f=>f+1),children:["Next",e.jsx(et,{className:"h-4 w-4"})]}):e.jsxs(ts,{variant:"primary",onClick:ne,children:[e.jsx(ct,{className:"h-4 w-4"})," Create"]})]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:[0,1,2].map(f=>e.jsx("button",{type:"button",className:Na("rounded-full px-4 py-2 text-sm font-semibold ring-1 transition",xe===f?"text-white ring-emerald-600":"bg-white text-slate-700 ring-slate-200 hover:bg-slate-50"),style:xe===f?{background:fx.green}:void 0,onClick:()=>he(f),children:f===0?"Vehicle":f===1?"Session":"Policy check"},f))}),xe===0?e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(hr,{label:"Vehicle",value:de.vehicleId,onChange:f=>{const U=g[f];ye(p=>({...p,vehicleId:f,costCenter:(U==null?void 0:U.costCenter)||p.costCenter,prioritySlot:!!(U!=null&&U.vip)}))},options:x.map(f=>({value:f.id,label:`${f.label} (${f.ownerType})${f.vip?"  VIP":""}`}))}),e.jsx(zr,{label:"Booked by",value:de.bookedBy,onChange:f=>ye(U=>({...U,bookedBy:f})),placeholder:"Charging Coordinator"}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 md:col-span-2",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Vehicle context"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"VIP, battery size, and default cost center."})]}),e.jsx(GF,{className:"h-5 w-5 text-slate-400"})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[(re=g[de.vehicleId])!=null&&re.vip?e.jsx(ut,{label:"VIP",tone:"info"}):e.jsx(ut,{label:"Standard",tone:"neutral"}),e.jsx(ut,{label:`${((v=g[de.vehicleId])==null?void 0:v.batteryKWh)||0} kWh`,tone:"neutral"}),e.jsx(ut,{label:((k=g[de.vehicleId])==null?void 0:k.costCenter)||"-",tone:"neutral"}),e.jsx(ut,{label:((m=g[de.vehicleId])==null?void 0:m.ownerType)||"-",tone:"neutral"})]}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Owner: ",((S=g[de.vehicleId])==null?void 0:S.ownerName)||"-"]})]})]}):null,xe===1?e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(zr,{label:"Scheduled time",type:"datetime-local",value:de.scheduledAt,onChange:f=>ye(U=>({...U,scheduledAt:f})),hint:"Local time"}),e.jsx(Wr,{label:"Duration",value:de.durationMins,onChange:f=>ye(U=>({...U,durationMins:bd(f,10,360)})),hint:"Minutes"}),e.jsx(hr,{label:"Site",value:de.siteId,onChange:f=>ye(U=>({...U,siteId:f})),options:c.map(f=>({value:f.id,label:`${f.name} (${f.status})`}))}),e.jsx(hr,{label:"Connector",value:de.connector,onChange:f=>ye(U=>({...U,connector:f})),options:a.map(f=>({value:f,label:f}))}),e.jsx(Wr,{label:"Expected energy",value:de.expectedKWh,onChange:f=>ye(U=>({...U,expectedKWh:Math.max(1,f)})),hint:"kWh"}),e.jsx(Wr,{label:"Max budget",value:de.maxBudgetUGX,onChange:f=>ye(U=>({...U,maxBudgetUGX:Math.max(0,f)})),hint:"UGX"}),e.jsx(hr,{label:"Purpose",value:de.purpose,onChange:f=>ye(U=>({...U,purpose:f})),options:s.map(f=>({value:f,label:f}))}),e.jsx(zr,{label:"Tags",value:de.tags,onChange:f=>ye(U=>({...U,tags:f})),placeholder:"Comma separated",hint:"Example: Fleet,Airport"}),e.jsx(zr,{label:"Cost center",value:de.costCenter,onChange:f=>ye(U=>({...U,costCenter:f})),placeholder:"OPS-001"}),e.jsx(zr,{label:"Project tag",value:de.projectTag,onChange:f=>ye(U=>({...U,projectTag:f})),placeholder:"Charging program"}),e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4 md:col-span-2",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Priority slot"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Premium: request priority reservation, approval-gated."})]}),e.jsx("button",{type:"button",className:Na("relative h-7 w-12 rounded-full border transition",de.prioritySlot?"border-emerald-300 bg-emerald-200":"border-slate-200 bg-white"),onClick:()=>ye(f=>({...f,prioritySlot:!f.prioritySlot})),"aria-label":"Toggle priority",children:e.jsx("span",{className:Na("absolute top-0.5 h-6 w-6 rounded-full bg-white shadow-sm transition",de.prioritySlot?"left-[22px]":"left-1")})})]})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(OC,{label:"If purpose is Other",value:de.purposeOther,onChange:f=>ye(U=>({...U,purposeOther:f})),placeholder:"Explain the purpose",rows:3,disabled:de.purpose!=="Other",hint:de.purpose!=="Other"?"Disabled":"Required when Other"})})]}):null,xe===2?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Policy check"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"This preview shows why approval may be required."})]}),Ue.needsApproval?e.jsx(ut,{label:"Approval required",tone:"warn"}):e.jsx(ut,{label:"No approval",tone:"good"})]}),Ue.requiredErrors.length?e.jsxs("div",{className:"mt-3 rounded-2xl bg-rose-50 p-3 text-xs text-rose-800 ring-1 ring-rose-200",children:[e.jsx("div",{className:"font-semibold",children:"Missing"}),e.jsx("ul",{className:"mt-2 space-y-1",children:Ue.requiredErrors.map((f,U)=>e.jsxs("li",{children:[" ",f]},`err-${U}`))})]}):null,e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Scheduled"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:vi(Ue.whenTs)}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["After-hours: ",Ue.after?"Yes":"No"]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Tariff"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:Ue.peak?"Peak":"Off-peak"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:Ue.suggestion})]})]}),e.jsxs("div",{className:"mt-3 rounded-2xl bg-slate-50 p-3 text-xs text-slate-700 ring-1 ring-slate-200",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Flags"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[Ue.flags.length?Ue.flags.map((f,U)=>e.jsx(ut,{label:f,tone:f.endsWith("required")?"bad":f==="Peak tariff"?"warn":"neutral"},`flag-${U}`)):e.jsx(ut,{label:"None",tone:"neutral"}),Ue.hasActiveVipException?e.jsx(ut,{label:"VIP exception active",tone:"info"}):null]})]}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"If approval is required, the session is created in Pending approval and routed to Manager then Finance, and optionally CFO for VIP, DC fast, or priority."})]})}):null]})}),e.jsx(Mb,{open:Ke,title:"Bulk fleet charging plan",subtitle:"Premium: schedule many vehicles with staggered slots.",onClose:()=>Le(!1),actions:[{label:"Create",onClick:Me}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(ts,{variant:"outline",onClick:()=>Le(!1),children:"Cancel"}),e.jsxs(ts,{variant:"primary",onClick:Me,children:[e.jsx(ct,{className:"h-4 w-4"})," Create"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(zr,{label:"Plan name",value:Ne.name,onChange:f=>ge(U=>({...U,name:f}))}),e.jsx(hr,{label:"Site",value:Ne.siteId,onChange:f=>ge(U=>({...U,siteId:f})),options:c.map(f=>({value:f.id,label:f.name}))}),e.jsx(zr,{label:"Start time",type:"datetime-local",value:Ne.startAt,onChange:f=>ge(U=>({...U,startAt:f}))}),e.jsx(Wr,{label:"Interval",value:Ne.intervalMins,onChange:f=>ge(U=>({...U,intervalMins:bd(f,5,120)})),hint:"Minutes"}),e.jsx(Wr,{label:"Duration",value:Ne.durationMins,onChange:f=>ge(U=>({...U,durationMins:bd(f,10,360)})),hint:"Minutes"}),e.jsx(hr,{label:"Connector",value:Ne.connector,onChange:f=>ge(U=>({...U,connector:f})),options:a.map(f=>({value:f,label:f}))}),e.jsx(Wr,{label:"Expected kWh",value:Ne.expectedKWh,onChange:f=>ge(U=>({...U,expectedKWh:Math.max(1,f)})),hint:"kWh"}),e.jsx(Wr,{label:"Max budget",value:Ne.maxBudgetUGX,onChange:f=>ge(U=>({...U,maxBudgetUGX:Math.max(0,f)})),hint:"UGX"}),e.jsx(zr,{label:"Tags",value:Ne.tags,onChange:f=>ge(U=>({...U,tags:f})),hint:"Comma separated"}),e.jsx(zr,{label:"Cost center",value:Ne.costCenter,onChange:f=>ge(U=>({...U,costCenter:f}))}),e.jsx(zr,{label:"Project tag",value:Ne.projectTag,onChange:f=>ge(U=>({...U,projectTag:f}))}),e.jsxs("div",{className:"md:col-span-2 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Vehicles"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Select vehicles to schedule in sequence."})]}),e.jsx(ut,{label:`${Ne.vehicleIds.length} selected`,tone:Ne.vehicleIds.length?"info":"neutral"})]}),e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2 sm:grid-cols-2",children:x.map(f=>{const U=Ne.vehicleIds.includes(f.id);return e.jsxs("button",{type:"button",className:Na("rounded-2xl border px-3 py-3 text-left",U?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"),onClick:()=>ge(p=>({...p,vehicleIds:U?p.vehicleIds.filter(M=>M!==f.id):[...p.vehicleIds,f.id]})),children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:f.label}),f.vip?e.jsx(ut,{label:"VIP",tone:"info"}):null]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[f.ownerName,"  ",f.costCenter]})]},f.id)})}),e.jsx("div",{className:"mt-3 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Bulk plan creates sessions and creates one fleet-plan approval if any session violates policy."})]})]})}),e.jsx(Mb,{open:$e,title:"Request VIP charging exception",subtitle:"Premium: allow DC fast, priority slots, or after-hours through approvals.",onClose:()=>ie(!1),actions:[{label:"Submit",onClick:me}],footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(ts,{variant:"outline",onClick:()=>ie(!1),children:"Cancel"}),e.jsxs(ts,{variant:"primary",onClick:me,children:[e.jsx(yt,{className:"h-4 w-4"})," Submit"]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(hr,{label:"Vehicle",value:Oe.vehicleId,onChange:f=>Se(U=>({...U,vehicleId:f})),options:x.map(f=>({value:f.id,label:`${f.label}${f.vip?"  VIP":""}`}))}),e.jsx(hr,{label:"Exception type",value:Oe.exceptionType,onChange:f=>Se(U=>({...U,exceptionType:f})),options:[{value:"DC fast",label:"DC fast"},{value:"Priority slot",label:"Priority slot"},{value:"After-hours",label:"After-hours"}]}),e.jsx(Wr,{label:"Valid days",value:Oe.validDays,onChange:f=>Se(U=>({...U,validDays:bd(f,1,365)})),hint:"1 to 365"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(OC,{label:"Reason",value:Oe.reason,onChange:f=>Se(U=>({...U,reason:f})),placeholder:"Explain the business justification",rows:4})}),e.jsx("div",{className:"md:col-span-2 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"Best practice: CFO is added automatically for DC or priority exceptions."})]})})]});function V({title:f,detail:U,cta:p,onClick:M}){return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:f}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:U})]}),e.jsxs(ts,{variant:"outline",className:"px-3 py-2 text-xs",onClick:M,children:[e.jsx(et,{className:"h-4 w-4"})," ",p]})]})})}}const Sf={dashboard:IU,notifications_activity:_U,command_center:KU,org_setup:lV,modules_enablement:cV,users:gV,groups:yV,roles_permissions:MV,policies:IV,approval_workflows:qV,approvals_inbox:KV,budgets:l_,wallet_billing:o_,billing_setup:x_,invoices:v_,collections:C_,reconciliation:T_,vendors:F_,rfq:q_,fulfillment:K_,travel:tB,reporting:rB,esg:mB,integrations:vB,security:wB,support_tools:EB,settings_hub:IB,ev_charging:VB};({...Sf});const Fi={green:"#03CD8C",orange:"#F77F00"};function Hs(...t){return t.filter(Boolean).join(" ")}function _B(t="id"){return`${t}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`}function BB(t){const[s,a]=d.useState(()=>typeof window>"u"?!1:window.matchMedia(t).matches);return d.useEffect(()=>{var r;if(typeof window>"u")return;const l=window.matchMedia(t),n=()=>a(l.matches);return n(),(r=l.addEventListener)==null||r.call(l,"change",n),()=>{var i;return(i=l.removeEventListener)==null?void 0:i.call(l,"change",n)}},[t]),s}function zl({label:t,tone:s}){const a={good:"bg-emerald-50 text-emerald-700 ring-emerald-200",warn:"bg-amber-50 text-amber-800 ring-amber-200",bad:"bg-rose-50 text-rose-700 ring-rose-200",info:"bg-blue-50 text-blue-700 ring-blue-200",neutral:"bg-slate-50 text-slate-700 ring-slate-200"};return e.jsx("span",{className:Hs("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1",a[s]),children:t})}function Si({variant:t="outline",className:s,children:a,onClick:l,disabled:n,title:r}){const i="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-4",o={primary:"text-white shadow-[0_12px_24px_rgba(3,205,140,0.22)] hover:opacity-95 focus:ring-emerald-200",accent:"text-white shadow-[0_12px_24px_rgba(247,127,0,0.22)] hover:opacity-95 focus:ring-orange-200",outline:"border border-slate-200 bg-white text-slate-800 shadow-sm hover:bg-slate-50 focus:ring-slate-200",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus:ring-slate-200",danger:"border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-100"},c=t==="primary"?{background:Fi.green}:t==="accent"?{background:Fi.orange}:void 0;return e.jsx("button",{type:"button",title:r,disabled:n,onClick:l,style:c,className:Hs(i,o[t],n&&"cursor-not-allowed opacity-60",s),children:a})}function GB({channel:t}){const a={Email:{bg:"bg-slate-50",fg:"text-slate-700",icon:e.jsx(Xs,{className:"h-3.5 w-3.5"})},WhatsApp:{bg:"bg-emerald-50",fg:"text-emerald-700",icon:e.jsx(g0,{className:"h-3.5 w-3.5"})},WeChat:{bg:"bg-green-50",fg:"text-green-700",icon:e.jsx(g0,{className:"h-3.5 w-3.5"})},SMS:{bg:"bg-blue-50",fg:"text-blue-700",icon:e.jsx(g0,{className:"h-3.5 w-3.5"})}}[t];return e.jsxs("span",{className:Hs("inline-flex items-center gap-1.5 rounded-full px-2 py-1 text-xs font-semibold",a.bg,a.fg),children:[a.icon,t]})}function Xh({open:t,onClose:s,anchorRef:a,children:l,width:n=360}){var c;d.useEffect(()=>{const x=j=>{j.key==="Escape"&&s()};return t&&window.addEventListener("keydown",x),()=>window.removeEventListener("keydown",x)},[t,s]);const r=(c=a.current)==null?void 0:c.getBoundingClientRect(),i=r?Math.max(16,window.innerWidth-r.right):16,o=r?r.bottom+10:54;return e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40",onClick:s,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}),e.jsx(qe.div,{initial:{opacity:0,y:8,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:8,scale:.98},transition:{duration:.16},className:"fixed z-50 overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-[0_24px_70px_rgba(2,8,23,0.18)]",style:{width:n,right:i,top:o},role:"menu",children:l})]}):null})}function DC({nav:t,active:s,onSelect:a,collapsed:l,theme:n,onToggleTheme:r}){const i=n==="dark"?"bg-slate-900":"bg-slate-50",o=n==="dark"?"border-slate-800":"border-slate-200",c=n==="dark"?"text-white":"text-slate-900",x=n==="dark"?"text-slate-400":"text-slate-500";return e.jsxs("div",{className:Hs("flex h-full flex-col",l?"px-1":"px-2",i),children:[e.jsxs("div",{className:Hs("flex items-center gap-2 border-b py-3",o,l?"justify-center px-1":"px-2"),children:[e.jsx("div",{className:"grid h-8 w-8 shrink-0 place-items-center rounded-xl text-white",style:{background:Fi.green},children:e.jsx(ht,{className:"h-4 w-4"})}),!l&&e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:Hs("truncate text-xs font-bold",c),children:"CorporatePay"}),e.jsx("div",{className:Hs("truncate text-[10px]",x),children:"Console"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto py-2",children:e.jsx("div",{className:"space-y-0.5",children:t.map(j=>e.jsx(qB,{item:j,active:s,onSelect:a,collapsed:l,theme:n},j.id))})}),e.jsxs("div",{className:Hs("border-t py-2",o),children:[e.jsxs("button",{onClick:r,className:Hs("flex w-full items-center gap-2 rounded-xl px-2 py-1.5 text-left transition-colors",n==="dark"?"text-slate-300 hover:bg-slate-800":"text-slate-700 hover:bg-slate-100",l&&"justify-center"),title:n==="light"?"Switch to dark mode":"Switch to light mode",children:[n==="light"?e.jsx(tU,{className:"h-4 w-4"}):e.jsx(nU,{className:"h-4 w-4"}),!l&&e.jsx("span",{className:"text-xs font-medium",children:n==="light"?"Dark mode":"Light mode"})]}),e.jsxs("button",{onClick:()=>a("support_tools"),className:Hs("flex w-full items-center gap-2 rounded-xl px-2 py-1.5 text-left transition-colors",n==="dark"?"text-slate-300 hover:bg-slate-800":"text-slate-700 hover:bg-slate-100",l&&"justify-center"),children:[e.jsx(Fu,{className:"h-4 w-4"}),!l&&e.jsx("span",{className:"text-xs font-medium",children:"Help & Support"})]})]})]})}function qB({item:t,active:s,onSelect:a,collapsed:l,theme:n}){var y,$;const r=s===t.id||((y=t.children)==null?void 0:y.some(T=>T.id===s)),i=s===t.id,o=!!(($=t.children)!=null&&$.length),[c,x]=d.useState(r),j=i?"text-white":n==="dark"?"text-slate-300 hover:bg-slate-800":"text-slate-700 hover:bg-slate-100",g=i?"text-white":n==="dark"?"text-slate-400":"text-slate-500";return e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>{o?x(T=>!T):a(t.id)},className:Hs("flex w-full items-center gap-2 rounded-xl px-2 py-1.5 text-left text-xs font-medium transition-all hover-lift",j,l&&"justify-center px-1"),style:i?{background:Fi.green}:void 0,children:[e.jsx("div",{className:Hs("shrink-0",g),children:t.icon}),!l&&e.jsx("div",{className:"min-w-0 flex-1 truncate",children:t.label}),!l&&t.badge&&e.jsx("span",{className:Hs("rounded-full px-1.5 py-0.5 text-[10px] font-semibold",i?"bg-white/20 text-white":n==="dark"?"bg-slate-700 text-slate-300":"bg-slate-200 text-slate-600"),children:t.badge}),!l&&o&&e.jsx(ni,{className:Hs("h-3 w-3 transition-transform",c?"rotate-0":"-rotate-90")})]}),!l&&o&&e.jsx(lt,{initial:!1,children:c&&e.jsx(qe.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.12},className:"ml-4 mt-0.5 space-y-0.5 border-l border-slate-200 pl-2 dark:border-slate-700",children:t.children.map(T=>e.jsxs("button",{onClick:()=>a(T.id),className:Hs("flex w-full items-center justify-between rounded-lg px-2 py-1 text-left text-xs transition-colors hover-lift",s===T.id?"bg-emerald-50 font-semibold text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400":n==="dark"?"text-slate-400 hover:bg-slate-800":"text-slate-600 hover:bg-slate-100"),children:[e.jsx("span",{className:"truncate",children:T.label}),T.badge&&e.jsx("span",{className:Hs("ml-1 rounded-full px-1.5 py-0.5 text-[10px] font-semibold",n==="dark"?"bg-slate-700 text-slate-300":"bg-slate-200 text-slate-600"),children:T.badge})]},T.id))})})]})}function zB({actions:t}){const[s,a]=d.useState(!1),l=d.useRef(null);return d.useEffect(()=>{const n=r=>{l.current&&!l.current.contains(r.target)&&a(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),t.length?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx("button",{onClick:()=>a(!s),className:"rounded-full p-2 text-slate-500 hover:bg-slate-100 hover:text-slate-700",children:e.jsx(xs,{className:"h-5 w-5"})}),s&&e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-48 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",children:t.map((n,r)=>e.jsxs("button",{onClick:()=>{n.onClick(),a(!1)},disabled:n.disabled,className:Hs("flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50",n.variant==="danger"?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:[n.icon,n.label]},r))})]}):null}function WB({open:t,title:s,subtitle:a,children:l,onClose:n,footer:r,maxW:i="920px",actions:o}){return d.useEffect(()=>{const c=x=>x.key==="Escape"&&n();return t&&window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,n]),e.jsx(lt,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/35",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n}),e.jsxs(qe.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.98},transition:{duration:.18},className:"fixed inset-x-0 top-[8vh] z-50 mx-auto w-[min(980px,calc(100vw-2rem))] overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.22)]",style:{maxWidth:i},role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 border-b border-slate-200 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:s}),a?e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:a}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(zB,{actions:o}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:n,"aria-label":"Close",children:e.jsx(Qe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-auto px-5 py-4",children:l}),r?e.jsx("div",{className:"border-t border-slate-200 px-5 py-4",children:r}):null]})]}):null})}function HB({toasts:t,onDismiss:s}){return e.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-50 w-[min(460px,calc(100vw-2rem))] space-y-2",children:e.jsx(lt,{initial:!1,children:t.map(a=>e.jsx(qe.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:"pointer-events-auto rounded-3xl border border-slate-200 bg-white/90 p-3 shadow-[0_18px_45px_rgba(2,8,23,0.18)] backdrop-blur",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Hs("mt-0.5 grid h-9 w-9 place-items-center rounded-2xl",a.kind==="success"&&"bg-emerald-50 text-emerald-700",a.kind==="warn"&&"bg-amber-50 text-amber-800",a.kind==="error"&&"bg-rose-50 text-rose-700",a.kind==="info"&&"bg-blue-50 text-blue-700"),children:a.kind==="error"||a.kind==="warn"?e.jsx(Et,{className:"h-5 w-5"}):e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),a.message?e.jsx("div",{className:"mt-0.5 text-sm text-slate-600",children:a.message}):null]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-500 hover:bg-slate-100",onClick:()=>s(a.id),"aria-label":"Dismiss",children:e.jsx(Qe,{className:"h-4 w-4"})})]})},a.id))})})}function IC({title:t,subtitle:s,tier:a,bullets:l,onPrimary:n,primaryLabel:r}){return e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Page"}),e.jsx("div",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:t}),e.jsx("div",{className:"mt-2 max-w-2xl text-sm text-slate-600",children:s}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsx(zl,{label:a,tone:a==="Premium"?"info":"neutral"}),e.jsx(zl,{label:"Shell ready",tone:"good"})]})]}),n?e.jsxs(Si,{variant:"primary",onClick:n,children:[e.jsx(et,{className:"h-4 w-4"})," ",r||"Open"]}):null]}),l!=null&&l.length?e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Included features"}),e.jsx("ul",{className:"mt-3 space-y-2 text-sm text-slate-700",children:l.map(i=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-2 h-1.5 w-1.5 rounded-full",style:{background:Fi.green}}),e.jsx("span",{children:i})]},i))})]}):null,e.jsx("div",{className:"mt-4 rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"This AppShell is designed so each route can be replaced with the full page component when you integrate files into your codebase."})]})}function XB({pageTitle:t,role:s,onRequest:a}){return e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl bg-rose-50 text-rose-700",children:e.jsx(ia,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"Access denied"}),e.jsxs("div",{className:"mt-1 text-sm text-slate-600",children:["Your role ",e.jsx("span",{className:"font-semibold",children:s})," cannot access ",e.jsx("span",{className:"font-semibold",children:t}),"."]}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:[e.jsxs(Si,{variant:"primary",onClick:a,children:[e.jsx(ri,{className:"h-4 w-4"})," Request access"]}),e.jsx("div",{className:"text-xs text-slate-500",children:"Requests should be auditable and time-bounded in production."})]})]})]})})}function KB({onLogin:t,orgs:s,roles:a}){const[l,n]=d.useState(s[0]||"Organization"),[r,i]=d.useState(a[0]||"Org Admin"),[o,c]=d.useState("admin@company.com"),[x,j]=d.useState("demo"),[g,y]=d.useState(!0);return e.jsx("div",{className:"min-h-screen bg-[radial-gradient(90%_60%_at_50%_0%,rgba(3,205,140,0.18),rgba(255,255,255,0))]",children:e.jsx("div",{className:"mx-auto max-w-[980px] px-4 py-10 md:px-6",children:e.jsxs("div",{className:"overflow-hidden rounded-[28px] border border-slate-200 bg-white shadow-[0_30px_90px_rgba(2,8,23,0.12)]",children:[e.jsx("div",{className:"border-b border-slate-200 bg-white px-6 py-5",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-2xl text-white",style:{background:Fi.green},children:e.jsx(ht,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"CorporatePay"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Login and org selector"})]})]}),e.jsx(zl,{label:"SSO-ready",tone:"info"})]})}),e.jsxs("div",{className:"bg-slate-50 px-6 py-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Sign in"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Email and password. SSO buttons can be added in phase 2."}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("label",{className:"block",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Email"}),e.jsx("input",{value:o,onChange:$=>c($.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"})]}),e.jsxs("label",{className:"block",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Password"}),e.jsx("input",{type:"password",value:x,onChange:$=>j($.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100"})]}),e.jsxs("label",{className:"flex items-start gap-3 rounded-3xl border border-slate-200 bg-slate-50 p-3",children:[e.jsx("input",{type:"checkbox",checked:g,onChange:$=>y($.target.checked),className:"mt-1 h-4 w-4 rounded border-slate-300"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Device trust notice"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Unusual logins may require step-up prompts (MFA)."})]})]}),e.jsxs(Si,{variant:"primary",className:"w-full",onClick:()=>{!o.trim()||!x.trim()||g&&t(l,r)},disabled:!o.trim()||!x.trim()||!g,children:[e.jsx(ct,{className:"h-4 w-4"})," Sign in"]})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-5",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Select organization"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Shown when your user belongs to multiple orgs."}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("label",{className:"block",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Organization"}),e.jsx("select",{value:l,onChange:$=>n($.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",children:s.map($=>e.jsx("option",{value:$,children:$},$))})]}),e.jsxs("label",{className:"block",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Role (demo)"}),e.jsx("select",{value:r,onChange:$=>i($.target.value),className:"mt-2 w-full rounded-2xl border border-slate-200 bg-white px-3 py-2.5 text-sm font-semibold text-slate-900 outline-none focus:ring-4 focus:ring-emerald-100",children:a.map($=>e.jsx("option",{value:$,children:$},$))})]}),e.jsx("div",{className:"rounded-2xl bg-amber-50 p-3 text-xs text-amber-900 ring-1 ring-amber-200",children:"In production, role and org membership is resolved from access policy and invites."}),e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs(Si,{variant:"outline",onClick:()=>alert("Request access: creates ticket for org admin (demo)."),children:[" ",e.jsx(ri,{className:"h-4 w-4"})," Request access"]}),e.jsxs(Si,{variant:"outline",onClick:()=>alert("MFA setup happens after login in X2 (demo)."),children:[" ",e.jsx(ia,{className:"h-4 w-4"})," MFA and device trust"]})]})]})]})]}),e.jsxs("div",{className:"mt-4 rounded-3xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"EVzone Support sign-in entry"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Support role is embedded. Support sessions are always audited, visible, and watermarked."})]})]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/60 px-6 py-5 text-xs text-slate-500",children:"Access and onboarding screens are part of the complete system. This login page is a premium shell starter."})]})})})}function Ob(){const t=BB("(min-width: 1024px)"),{pageId:s}=ZS(),a=Kd(),[l,n]=d.useState(!0),[r,i]=d.useState(!1),[o,c]=d.useState(!1),x=s||"dashboard",[j,g]=d.useState("Active"),[y,$]=d.useState("Org Admin"),[T,C]=d.useState("Acme Group Ltd"),[W,L]=d.useState([]),R=z=>{const Ae=_B("toast");L(Ve=>[{id:Ae,...z},...Ve].slice(0,4)),window.setTimeout(()=>L(Ve=>Ve.filter(Ye=>Ye.id!==Ae)),3200)},[F,te]=d.useState(()=>typeof window<"u"&&localStorage.getItem("theme")||"light");d.useEffect(()=>{const z=window.document.documentElement;F==="dark"?z.classList.add("dark"):z.classList.remove("dark"),localStorage.setItem("theme",F)},[F]);const[oe,G]=d.useState(""),[H,Y]=d.useState(!1),[we,q]=d.useState(!1),[je,_e]=d.useState(!1),[Ee,be]=d.useState(!1),[Fe,Pe]=d.useState(!1),[pe,Q]=d.useState(!1),Re=d.useRef(null),ce=d.useRef(null),xe=d.useRef(null),he=d.useRef(null),[de,ye]=d.useState(!1),[Ke,Le]=d.useState(""),Ne=d.useMemo(()=>({dashboard:{id:"dashboard",title:"Corporate Dashboard",subtitle:"KPIs, account health, issues, and next best admin actions.",tier:"Core",roles:["Org Owner","Org Admin","Manager","Accountant","Approver","Travel Coordinator","Employee","EVzone Support"],keywords:["kpi","spend","approvals","budget","health"],status:"Ready",bullets:["Spend today/week/month, approvals pending, budget remaining","Account health: wallet balance, credit usage, prepaid runway","Top issues: failed payments, breaches, overdue invoices","Quick actions: add funds, approve queue, create RFQ"]},notifications_activity:{id:"notifications_activity",title:"Notifications and Activity Center",subtitle:"Unified feed for approvals, reminders, alerts, and vendor updates with channel delivery logs.",tier:"Core",roles:["Org Owner","Org Admin","Manager","Accountant","Approver","Travel Coordinator","Employee","EVzone Support"],keywords:["alerts","reminders","activity","logs","whatsapp","wechat","sms"],status:"Ready"},command_center:{id:"command_center",title:"Global Search and Command Center",subtitle:"Search users, invoices, approvals, vendors and run quick admin actions.",tier:"Core",roles:["Org Owner","Org Admin","Manager","Accountant","Approver","Travel Coordinator","Employee","EVzone Support"],keywords:["search","command","operator","shortcuts"],status:"Ready"},org_setup:{id:"org_setup",title:"Organization Profile and Program Setup",subtitle:"Company profile, entities, branding, billing contacts, invoice groups, support toggle and go-live readiness.",tier:"Core",roles:["Org Owner","Org Admin"],keywords:["profile","entities","billing","branding","go-live"],status:"Ready"},modules_enablement:{id:"modules_enablement",title:"Modules and Marketplaces Enablement",subtitle:"Enable service modules and marketplaces including MyLiveDealz. Includes Other slots.",tier:"Core",roles:["Org Owner","Org Admin"],keywords:["modules","marketplaces","mylivedealz","enable"],status:"Planned",bullets:["Enable/disable service modules","Enable/disable marketplaces under E-Commerce","Controlled rollout: pilot group then expand","Change impact preview"]},users:{id:"users",title:"Users and Invitations",subtitle:"Invite users, assign roles, groups and spend limits. Bulk import and offboarding.",tier:"Core",roles:["Org Owner","Org Admin","Manager","Accountant"],keywords:["users","invites","csv","hris"],status:"Planned",bullets:["Users list: Invited/Active/Suspended/Offboarded","Bulk import CSV, HRIS import in phase 2","Offboarding: revoke CorporatePay immediately, keep audit"]},groups:{id:"groups",title:"Groups and Cost Centers",subtitle:"Departments (groups), cost centers, project tags and chargeback rules.",tier:"Core",roles:["Org Owner","Org Admin","Accountant"],keywords:["groups","cost center","tags"],status:"Planned"},roles_permissions:{id:"roles_permissions",title:"Roles, Permissions and Governance",subtitle:"RBAC, custom roles, approval delegation and two-admin model controls.",tier:"Core",roles:["Org Owner","Org Admin"],keywords:["rbac","permissions","governance"],status:"Planned"},policies:{id:"policies",title:"Policies",subtitle:"Ride, services and purchases policies with inheritance and simulator.",tier:"Core",roles:["Org Owner","Org Admin","Manager","Approver"],keywords:["policy","rides","purchases","services"],status:"Planned"},approval_workflows:{id:"approval_workflows",title:"Approval Workflow Builder",subtitle:"Rule engine and multi-level approvals per module and marketplace including RFQs.",tier:"Core",roles:["Org Owner","Org Admin","Approver"],keywords:["workflow","approvals","sla"],status:"Planned"},approvals_inbox:{id:"approvals_inbox",title:"Approvals Inbox",subtitle:"Unified queue for rides, purchases, services, RFQs and exceptions.",tier:"Core",roles:["Org Owner","Org Admin","Approver","Accountant","Manager"],keywords:["approve","queue","sla"],status:"Planned"},budgets:{id:"budgets",title:"Budgets, Spend Limits and Controls",subtitle:"Org, group, module and marketplace budgets with forecasting and emergency exceptions.",tier:"Core",roles:["Org Owner","Org Admin","Accountant"],keywords:["budget","cap","limits","exceptions"],status:"Ready"},wallet_billing:{id:"wallet_billing",title:"Corporate Wallet, Credit Line and Prepaid Funding",subtitle:"Pay-as-you-go wallet, credit with limit, and prepaid deposit with hard stop.",tier:"Core",roles:["Org Owner","Org Admin","Accountant"],keywords:["wallet","credit","prepaid"],status:"Planned"},billing_setup:{id:"billing_setup",title:"Billing Setup and Invoice Groups",subtitle:"Invoice frequency, invoice groups, tax settings, and billing simulations.",tier:"Core",roles:["Org Owner","Org Admin","Accountant"],keywords:["invoice groups","billing","tax"],status:"Planned"},invoices:{id:"invoices",title:"Invoices and Statements",subtitle:"Invoice list, line item explorer, disputes, exports.",tier:"Core",roles:["Org Owner","Org Admin","Accountant"],keywords:["invoice","statement","dispute"],status:"Planned"},collections:{id:"collections",title:"Collections, Reminders and Enforcement",subtitle:"Automated reminders and service suspension rules.",tier:"Core",roles:["Org Owner","Org Admin","Accountant"],keywords:["reminders","dunning","enforcement"],status:"Planned"},reconciliation:{id:"reconciliation",title:"Transactions and Reconciliation",subtitle:"Ledger, matching tools, exceptions queue, ERP mappings.",tier:"Core",roles:["Org Owner","Org Admin","Accountant"],keywords:["ledger","reconcile","erp"],status:"Planned"},vendors:{id:"vendors",title:"Vendor and Catalog Management",subtitle:"Allowlist/denylist vendors, risk scoring, rate cards and compliance docs.",tier:"Core",roles:["Org Owner","Org Admin","Manager","Accountant"],keywords:["vendors","catalog","allowlist"],status:"Planned"},rfq:{id:"rfq",title:"RFQ and Quote Requests",subtitle:"High value assets: request quote, compare quotes, convert to purchase order.",tier:"Core",roles:["Org Owner","Org Admin","Manager","Accountant","Approver"],keywords:["rfq","quote","assets"],status:"Planned"},fulfillment:{id:"fulfillment",title:"Orders, Service Requests and Fulfillment",subtitle:"Track purchase orders, service bookings, deliveries and schedules.",tier:"Core",roles:["Org Owner","Org Admin","Manager","Accountant"],keywords:["orders","fulfillment","sla"],status:"Planned"},travel:{id:"travel",title:"Corporate Travel and Scheduling",subtitle:"Pre-book rides, visitors, events, and recurring commutes.",tier:"Core",roles:["Org Owner","Org Admin","Manager","Travel Coordinator"],keywords:["travel","schedule","events"],status:"Planned"},reporting:{id:"reporting",title:"Reporting and Analytics",subtitle:"Spend reports, approvals performance, exports and scheduled reports.",tier:"Core",roles:["Org Owner","Org Admin","Manager","Accountant","Approver"],keywords:["reports","analytics","exports"],status:"Ready"},esg:{id:"esg",title:"Sustainability and ESG Reporting",subtitle:"EV usage, charging utilization, emissions estimates, and ESG template exports.",tier:"Premium",roles:["Org Owner","Org Admin","Accountant"],keywords:["esg","emissions","charging"],status:"Ready"},integrations:{id:"integrations",title:"Integrations and Developer Center",subtitle:"API keys, scopes, webhooks, ERP exports, sandbox and inspector.",tier:"Core",roles:["Org Owner","Org Admin","Accountant","EVzone Support"],keywords:["api","webhooks","sandbox","erp"],status:"Ready"},security:{id:"security",title:"Security, Audit and Compliance",subtitle:"Audit logs, MFA policy, retention, support mode gating, forensic exports, compliance center.",tier:"Core",roles:["Org Owner","Org Admin","Accountant","EVzone Support"],keywords:["audit","mfa","retention","dual control"],status:"Ready"},support_tools:{id:"support_tools",title:"Support and EVzone Admin Tools",subtitle:"Embedded EVzone support role with auditable sessions, scoped tools and incidents.",tier:"Premium",roles:["Org Owner","Org Admin","Accountant","EVzone Support"],keywords:["support","cases","sessions","incidents"],status:"Ready"},ev_charging:{id:"ev_charging",title:"EV Charging",subtitle:"Charging schedules, sites, credits, and utilization controls.",tier:"Core",roles:["Org Owner","Org Admin","Manager","Accountant","Approver","Travel Coordinator","Employee","EVzone Support"],keywords:["ev","charging","station","credits","utilization"],status:"Ready"},settings_hub:{id:"settings_hub",title:"Admin Settings Hub",subtitle:"Single settings umbrella linking to all configuration pages.",tier:"Core",roles:["Org Owner","Org Admin","Accountant","Manager","Approver","EVzone Support"],keywords:["settings","hub","config"],status:"Ready"}}),[]),ge=d.useMemo(()=>[{id:"n1",title:"Invoice due tomorrow",message:"INV-2026-0117 is due. Auto-reminders are enabled.",when:"2h ago",tone:"warning",channel:"Email"},{id:"n2",title:"7 approvals pending",message:"Purchases and RFQs waiting. SLA target: 8 hours.",when:"Now",tone:"info",channel:"WhatsApp"},{id:"n3",title:"Prepaid balance low",message:"Deposit runway estimated: 3 days. Top up to avoid service stop.",when:"30m ago",tone:"danger",channel:"SMS"},{id:"n4",title:"ERP sync healthy",message:"Last export delivered successfully. Webhook success: 99.2%.",when:"Today",tone:"success",channel:"WeChat"}],[]),$e=d.useMemo(()=>({approvals:7,rfqs:3,users:128,alerts:ge.length,cases:2}),[ge.length]),ie=d.useMemo(()=>[{id:"dashboard",label:"Dashboard",icon:e.jsx(ly,{className:"h-4 w-4"})},{id:"notifications_activity",label:"Activity",icon:e.jsx(Fo,{className:"h-4 w-4"}),badge:`${$e.alerts}`},{id:"command_center",label:"Command center",icon:e.jsx(pa,{className:"h-4 w-4"})},{id:"org",label:"Organization",icon:e.jsx(Xl,{className:"h-4 w-4"}),children:[{id:"org_setup",label:"Setup wizard",icon:e.jsx("div",{})},{id:"modules_enablement",label:"Modules and marketplaces",icon:e.jsx("div",{}),badge:"MyLiveDealz"}]},{id:"people",label:"People",icon:e.jsx(Os,{className:"h-4 w-4"}),badge:`${$e.users}`,children:[{id:"users",label:"Users and invites",icon:e.jsx("div",{})},{id:"groups",label:"Groups and cost centers",icon:e.jsx("div",{})},{id:"roles_permissions",label:"Roles and permissions",icon:e.jsx("div",{})}]},{id:"controls",label:"Controls",icon:e.jsx(yt,{className:"h-4 w-4"}),children:[{id:"policies",label:"Policies",icon:e.jsx("div",{})},{id:"approval_workflows",label:"Approval workflows",icon:e.jsx("div",{})},{id:"approvals_inbox",label:"Approvals inbox",icon:e.jsx("div",{}),badge:`${$e.approvals}`}]},{id:"money",label:"Budgets and billing",icon:e.jsx(Ia,{className:"h-4 w-4"}),children:[{id:"budgets",label:"Budgets and spend",icon:e.jsx("div",{}),badge:"Caps"},{id:"wallet_billing",label:"Wallet and funding",icon:e.jsx("div",{})},{id:"billing_setup",label:"Billing setup",icon:e.jsx("div",{})},{id:"invoices",label:"Invoices",icon:e.jsx("div",{})},{id:"collections",label:"Collections",icon:e.jsx("div",{}),badge:"Auto"},{id:"reconciliation",label:"Reconciliation",icon:e.jsx("div",{})}]},{id:"procurement",label:"Procurement",icon:e.jsx(kt,{className:"h-4 w-4"}),badge:"RFQ",children:[{id:"vendors",label:"Vendors and catalog",icon:e.jsx("div",{})},{id:"rfq",label:"RFQs and quotes",icon:e.jsx("div",{}),badge:`${$e.rfqs}`},{id:"fulfillment",label:"Orders and fulfillment",icon:e.jsx("div",{})},{id:"travel",label:"Travel and scheduling",icon:e.jsx("div",{})}]},{id:"evs_charging",label:"EVs & Charging",icon:e.jsx(Fd,{className:"h-4 w-4"}),children:[{id:"ev_charging",label:"EV Charging",icon:e.jsx("div",{}),badge:"EV"}]},{id:"reports",label:"Reporting",icon:e.jsx(RE,{className:"h-4 w-4"}),children:[{id:"reporting",label:"Analytics",icon:e.jsx("div",{})},{id:"esg",label:"Sustainability and ESG",icon:e.jsx("div",{}),badge:"Premium"}]},{id:"integrations",label:"Integrations",icon:e.jsx($i,{className:"h-4 w-4"}),children:[{id:"integrations",label:"Developer center",icon:e.jsx("div",{})}]},{id:"security",label:"Security",icon:e.jsx(ia,{className:"h-4 w-4"}),children:[{id:"security",label:"Audit and compliance",icon:e.jsx("div",{})}]},{id:"support",label:"Support",icon:e.jsx(mu,{className:"h-4 w-4"}),badge:`${$e.cases}`,children:[{id:"support_tools",label:"Support tools",icon:e.jsx("div",{})}]},{id:"settings_hub",label:"Settings",icon:e.jsx(Ni,{className:"h-4 w-4"})}],[$e]),Oe=Ne[x]||Ne.dashboard,Se=j==="Active"?"good":j==="Past due"?"warn":"bad",Te=y==="EVzone Support",Ge=d.useMemo(()=>{const z=[{k:"Approvals inbox",id:"approvals_inbox",kind:"page"},{k:"Create RFQ",id:"rfq",kind:"page"},{k:"Issue budget",id:"budgets",kind:"page"},{k:"Top up wallet",id:"wallet_billing",kind:"page"},{k:"Security: audit and compliance",id:"security",kind:"page"},{k:"Integrations: API keys and webhooks",id:"integrations",kind:"page"},{k:"Support tools",id:"support_tools",kind:"page"},{k:"EV Charging",id:"ev_charging",kind:"page"},{k:"Settings hub",id:"settings_hub",kind:"page"}],Ae=oe.trim().toLowerCase();return Ae?z.filter(Ve=>Ve.k.toLowerCase().includes(Ae)).slice(0,10):z.slice(0,8)},[oe]);d.useEffect(()=>{t&&c(!1)},[t]),d.useEffect(()=>{_e(!1),be(!1),Y(!1),q(!1)},[s]),d.useEffect(()=>{const z=Ae=>{(Ae.ctrlKey||Ae.metaKey)&&Ae.key.toLowerCase()==="k"&&(Ae.preventDefault(),Q(!0),a(`${is.CONSOLE.ROOT}/command_center`)),Ae.key==="Escape"&&Q(!1)};return window.addEventListener("keydown",z),()=>window.removeEventListener("keydown",z)},[]);const We=z=>{const Ae=Ne[z];return Ae?Ae.roles.includes(y):!0},ze=()=>{const z=Ne[x];if(!z)return e.jsx(IC,{title:"Not found",subtitle:"This route does not exist.",tier:"Core"});if(!We(x))return e.jsx(XB,{pageTitle:z.title,role:y,onRequest:()=>{Le(""),ye(!0)}});const Ae=Sf[x];return Ae?e.jsx(Ae,{}):e.jsx(IC,{title:z.title,subtitle:z.subtitle,tier:z.tier,bullets:z.bullets,onPrimary:()=>R({title:"Route",message:`Open ${z.id} (demo)`,kind:"info"}),primaryLabel:"Open"})},Ue=z=>{$(z),R({title:"Role switched",message:z,kind:"info"}),We(x)||a(`${is.CONSOLE.ROOT}/dashboard`)},le=z=>{C(z),R({title:"Organization",message:z,kind:"info"})};return l?e.jsxs("div",{className:"min-h-screen bg-white transition-colors duration-300 dark:bg-slate-950",children:[e.jsx(HB,{toasts:W,onDismiss:z=>L(Ae=>Ae.filter(Ve=>Ve.id!==z))}),Te?e.jsx("div",{className:"sticky top-0 z-30 border-b border-amber-200 bg-amber-50 px-4 py-2 text-xs text-amber-900",children:e.jsxs("div",{className:"mx-auto flex max-w-[1400px] items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(yt,{className:"h-4 w-4"})," Support role active. Sessions are visible and auditable. No silent actions."]}),e.jsx(zl,{label:"Support mode",tone:"warn"})]})}):null,j==="Suspended"?e.jsx("div",{className:"border-b border-rose-200 bg-rose-50 px-4 py-2 text-xs text-rose-900",children:e.jsxs("div",{className:"mx-auto flex max-w-[1400px] items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Et,{className:"h-4 w-4"})," Services are currently suspended due to payment non-compliance."]}),e.jsxs(Si,{variant:"outline",className:"px-3 py-2 text-xs",onClick:()=>a(`${is.CONSOLE.ROOT}/collections`),children:[e.jsx(Fo,{className:"h-4 w-4"})," Open collections"]})]})}):null,e.jsx("div",{className:"flex h-screen",children:e.jsxs("div",{className:"flex flex-1 overflow-hidden bg-white transition-colors dark:bg-slate-950",children:[e.jsx("div",{className:Hs("hidden h-full border-r border-slate-200 bg-slate-50 transition-colors lg:block dark:border-slate-800 dark:bg-slate-900",r?"w-[56px]":"w-[200px]"),children:e.jsx(DC,{nav:ie,active:x,onSelect:z=>a(`${is.CONSOLE.ROOT}/${z}`),collapsed:r,theme:F,onToggleTheme:()=>te(z=>z==="light"?"dark":"light")})}),e.jsx(lt,{children:o?e.jsx(qe.div,{className:"fixed inset-0 z-40 bg-black/30 lg:hidden",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsxs(qe.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},exit:{x:-20,opacity:0},transition:{duration:.18},className:"h-full w-[86vw] max-w-[360px] bg-slate-50",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 px-4 py-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-2xl text-white",style:{background:Fi.green},children:e.jsx(ht,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"CorporatePay"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Navigation"})]})]}),e.jsx("button",{className:"rounded-2xl p-2 text-slate-600 hover:bg-slate-100",onClick:()=>c(!1),"aria-label":"Close menu",children:e.jsx(Qe,{className:"h-5 w-5"})})]}),e.jsx(DC,{nav:ie,active:x,onSelect:z=>{a(`${is.CONSOLE.ROOT}/${z}`),c(!1)},collapsed:!1,theme:F,onToggleTheme:()=>te(z=>z==="light"?"dark":"light")})]})}):null}),e.jsxs("div",{className:"flex h-full min-w-0 flex-1 flex-col",children:[e.jsxs("div",{className:"border-b border-emerald-700/30 transition-colors",style:{background:"linear-gradient(90deg, #03CD8C 0%, #F77F00 100%)"},children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 px-4 py-3 md:px-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"rounded-2xl border border-white/30 bg-white/20 p-2 text-white shadow-sm backdrop-blur hover:bg-white/30 lg:hidden",onClick:()=>c(!0),"aria-label":"Open menu",children:e.jsx(ry,{className:"h-5 w-5"})}),e.jsx("button",{className:"hidden rounded-2xl border border-white/30 bg-white/20 p-2 text-white shadow-sm backdrop-blur hover:bg-white/30 lg:inline-flex",onClick:()=>i(z=>!z),"aria-label":r?"Expand sidebar":"Collapse sidebar",children:r?e.jsx(et,{className:"h-5 w-5"}):e.jsx(HF,{className:"h-5 w-5"})}),e.jsxs("div",{className:"relative hidden md:flex",children:[e.jsxs("button",{className:"flex items-center gap-2 rounded-2xl border border-white/30 bg-white/20 px-3 py-2 text-sm font-semibold text-white shadow-sm backdrop-blur hover:bg-white/30",onClick:()=>{Pe(!Fe),be(!1),_e(!1),q(!1),Y(!1)},children:[e.jsx("span",{children:"Account"}),e.jsx(zl,{label:j,tone:Se}),e.jsx(ni,{className:"h-3 w-3 opacity-70"})]}),e.jsx(lt,{children:Fe&&e.jsxs(qe.div,{initial:{opacity:0,y:8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:8,scale:.95},className:"absolute left-0 top-full z-50 mt-2 w-48 rounded-2xl border border-slate-200 bg-white p-2 shadow-xl",children:[e.jsx("div",{className:"px-2 py-1.5 text-xs font-semibold text-slate-500",children:"Account status"}),e.jsxs("button",{className:"flex w-full items-center justify-between rounded-xl px-2 py-2 text-sm font-medium hover:bg-slate-50",onClick:()=>{g("Active"),Pe(!1)},children:[e.jsx("span",{className:"text-emerald-700",children:"Active"}),j==="Active"&&e.jsx(tt,{className:"h-4 w-4 text-emerald-600"})]}),e.jsxs("button",{className:"flex w-full items-center justify-between rounded-xl px-2 py-2 text-sm font-medium hover:bg-slate-50",onClick:()=>{g("Past due"),Pe(!1)},children:[e.jsx("span",{className:"text-amber-700",children:"Past due"}),j==="Past due"&&e.jsx(tt,{className:"h-4 w-4 text-emerald-600"})]}),e.jsxs("button",{className:"flex w-full items-center justify-between rounded-xl px-2 py-2 text-sm font-medium hover:bg-slate-50",onClick:()=>{g("Suspended"),Pe(!1)},children:[e.jsx("span",{className:"text-rose-700",children:"Suspended"}),j==="Suspended"&&e.jsx(tt,{className:"h-4 w-4 text-emerald-600"})]})]})})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex w-[min(320px,35vw)] items-center gap-2 rounded-2xl border border-white/30 bg-white/95 px-3 py-2 shadow-sm focus-within:ring-4 focus-within:ring-white/30",children:[e.jsx(pa,{className:"h-4 w-4 text-slate-500"}),e.jsx("input",{value:oe,onChange:z=>G(z.target.value),onFocus:()=>Q(!0),placeholder:"Search users, invoices, approvals, vendors, RFQs...",className:"w-full bg-transparent text-sm font-semibold text-slate-900 outline-none placeholder:text-slate-400"})]}),e.jsx(lt,{children:pe?e.jsxs(qe.div,{initial:{opacity:0,y:8,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:8,scale:.98},transition:{duration:.16},className:"absolute z-30 mt-2 w-full overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-[0_24px_70px_rgba(2,8,23,0.18)]",children:[e.jsx("div",{className:"px-4 py-3 text-xs font-semibold text-slate-600",children:"Suggestions"}),e.jsx("div",{className:"max-h-[260px] overflow-auto pb-2",children:Ge.map(z=>e.jsxs("button",{className:"flex w-full items-center justify-between gap-3 px-4 py-2 text-left hover:bg-slate-50",onClick:()=>{a(`${is.CONSOLE.ROOT}/${z.id}`),Q(!1)},children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:z.k}),e.jsx("div",{className:"truncate text-xs text-slate-500",children:"Jump to page"})]}),e.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-1 text-xs font-semibold text-slate-600",children:"Open"})]},z.k))}),e.jsx("div",{className:"border-t border-slate-200 px-4 py-3 text-xs text-slate-500",children:"Tip: search is role-aware and should return only what you can access."})]}):null})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{ref:xe,className:"hidden items-center gap-2 rounded-2xl border border-white/30 bg-white/20 px-3 py-2 text-sm font-semibold text-white shadow-sm backdrop-blur hover:bg-white/30 md:flex",onClick:()=>{be(z=>!z),_e(!1),Y(!1),q(!1)},title:"Switch organization",children:[e.jsx(Xl,{className:"h-4 w-4"}),e.jsx("span",{className:"max-w-[200px] truncate",children:T}),e.jsx(ni,{className:"h-4 w-4 opacity-70"})]}),e.jsxs("button",{ref:ce,className:"hidden items-center gap-2 rounded-2xl border border-white/30 bg-white/20 px-3 py-2 text-sm font-semibold text-white shadow-sm backdrop-blur hover:bg-white/30 md:flex",onClick:()=>{_e(z=>!z),be(!1),Y(!1),q(!1)},title:"Switch role",children:[e.jsx(ct,{className:"h-4 w-4"}),e.jsx("span",{className:"max-w-[170px] truncate",children:y}),e.jsx(ni,{className:"h-4 w-4 opacity-70"})]}),e.jsx("button",{ref:he,className:"rounded-2xl border border-white/30 bg-white p-2 text-emerald-600 shadow-lg hover:bg-white/95",onClick:()=>{q(z=>!z),Y(!1),_e(!1),be(!1)},"aria-label":"Quick create",disabled:j==="Suspended",title:j==="Suspended"?"Disabled while suspended":"Quick create",children:e.jsx(gt,{className:"h-5 w-5"})}),e.jsxs("button",{ref:Re,className:"relative rounded-2xl border border-white/30 bg-white/20 p-2 text-white shadow-sm backdrop-blur hover:bg-white/30",onClick:()=>{Y(z=>!z),q(!1),_e(!1),be(!1)},"aria-label":"Notifications",children:[e.jsx(Fo,{className:"h-5 w-5"}),e.jsx("span",{className:"absolute -right-1 -top-1 grid h-5 w-5 place-items-center rounded-full text-xs font-semibold text-white",style:{background:Fi.orange},children:ge.length})]}),e.jsx("button",{className:"hidden rounded-2xl border border-white/30 bg-white/20 p-2 text-white shadow-sm backdrop-blur hover:bg-white/30 md:inline-flex","aria-label":"Settings",onClick:()=>a(`${is.CONSOLE.ROOT}/settings_hub`),children:e.jsx(Ni,{className:"h-5 w-5"})}),e.jsx("button",{className:"hidden rounded-2xl border border-white/30 bg-white/20 p-2 text-white shadow-sm backdrop-blur hover:bg-white/30 md:inline-flex","aria-label":"Sign out",onClick:()=>{n(!1),R({title:"Signed out",message:"",kind:"info"})},children:e.jsx(jo,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3 px-4 pb-3 md:hidden",children:[e.jsx(zl,{label:`Account: ${j}`,tone:Se}),e.jsxs("div",{className:"text-xs font-semibold text-white",children:["Role: ",y]})]})]}),e.jsxs(Xh,{open:H,onClose:()=>Y(!1),anchorRef:Re,width:420,children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 px-4 py-3",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Notifications"}),e.jsx("button",{className:"rounded-2xl px-3 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-100",onClick:()=>{Y(!1),a(`${is.CONSOLE.ROOT}/notifications_activity`)},children:"View all"})]}),e.jsx("div",{className:"max-h-[420px] overflow-auto p-2",children:ge.map(z=>e.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:z.title}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:z.message}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx(zl,{label:z.when,tone:"neutral"}),z.channel?e.jsx(GB,{channel:z.channel}):null,z.tone==="success"?e.jsx(zl,{label:"OK",tone:"good"}):z.tone==="warning"?e.jsx(zl,{label:"Attention",tone:"warn"}):z.tone==="danger"?e.jsx(zl,{label:"Action",tone:"bad"}):e.jsx(zl,{label:"Info",tone:"info"})]})]}),e.jsx("button",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2 text-xs font-semibold text-slate-700 hover:bg-slate-50",onClick:()=>{Y(!1),a(`${is.CONSOLE.ROOT}/notifications_activity`)},children:"Open"})]})},z.id))}),e.jsx("div",{className:"border-t border-slate-200 px-4 py-3 text-xs text-slate-500",children:"Reminders support Email, WhatsApp, WeChat, and SMS. Delivery logs are saved for audit."})]}),e.jsxs(Xh,{open:je,onClose:()=>_e(!1),anchorRef:ce,width:320,children:[e.jsxs("div",{className:"border-b border-slate-200 px-4 py-3",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Switch role"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Role-aware views change navigation and permissions."})]}),e.jsx("div",{className:"p-2",children:["Org Owner","Org Admin","Manager","Accountant","Approver","Travel Coordinator","Employee","EVzone Support"].map(z=>e.jsxs("button",{className:Hs("flex w-full items-center justify-between rounded-2xl px-3 py-2 text-left text-sm hover:bg-slate-50",z===y&&"bg-emerald-50"),onClick:()=>{Ue(z),_e(!1)},children:[e.jsx("span",{className:Hs("font-semibold",z===y?"text-emerald-800":"text-slate-800"),children:z}),z===y?e.jsx(ct,{className:"h-4 w-4 text-emerald-700"}):null]},z))}),e.jsx("div",{className:"border-t border-slate-200 px-4 py-3 text-xs text-slate-500",children:"Support role is audited and can be disabled by organization policy."})]}),e.jsxs(Xh,{open:Ee,onClose:()=>be(!1),anchorRef:xe,width:340,children:[e.jsxs("div",{className:"border-b border-slate-200 px-4 py-3",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Organizations"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Switch admin view across organizations you manage."})]}),e.jsx("div",{className:"p-2",children:["Acme Group Ltd","EVzone Demo Org","Kampala Holdings"].map(z=>e.jsxs("button",{className:Hs("flex w-full items-center justify-between rounded-2xl px-3 py-2 text-left text-sm hover:bg-slate-50",z===T&&"bg-emerald-50"),onClick:()=>{le(z),be(!1)},children:[e.jsx("span",{className:Hs("font-semibold",z===T?"text-emerald-800":"text-slate-800"),children:z}),z===T?e.jsx(ct,{className:"h-4 w-4 text-emerald-700"}):null]},z))})]}),e.jsxs(Xh,{open:we,onClose:()=>q(!1),anchorRef:he,width:360,children:[e.jsxs("div",{className:"border-b border-slate-200 px-4 py-3",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Quick create"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Fast actions that open the correct workflows."})]}),e.jsx("div",{className:"p-2",children:[{label:"Invite user",icon:e.jsx(Os,{className:"h-4 w-4"}),id:"users"},{label:"Create policy",icon:e.jsx(yt,{className:"h-4 w-4"}),id:"policies"},{label:"Create RFQ",icon:e.jsx(kt,{className:"h-4 w-4"}),id:"rfq"},{label:"Issue budget",icon:e.jsx(rg,{className:"h-4 w-4"}),id:"budgets"},{label:"Create webhook",icon:e.jsx($i,{className:"h-4 w-4"}),id:"integrations"},{label:"Open support case",icon:e.jsx(ri,{className:"h-4 w-4"}),id:"support_tools"}].map(z=>e.jsxs("button",{className:"flex w-full items-center justify-between rounded-2xl px-3 py-2 text-left text-sm hover:bg-slate-50",onClick:()=>{a(`${is.CONSOLE.ROOT}/${z.id}`),q(!1)},children:[e.jsxs("span",{className:"flex items-center gap-2 font-semibold text-slate-800",children:[e.jsx("span",{className:"text-slate-600",children:z.icon}),z.label]}),e.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-1 text-xs font-semibold text-slate-600",children:"Open"})]},z.label))}),e.jsx("div",{className:"border-t border-slate-200 px-4 py-3 text-xs text-slate-500",children:"All actions are permission checked and logged for audit."})]}),e.jsx("div",{className:"min-h-0 flex-1 overflow-auto bg-slate-50",children:e.jsxs("div",{className:"px-4 py-5 md:px-5",children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Current view"}),e.jsx("h1",{className:"mt-1 text-2xl font-semibold tracking-tight text-slate-900",children:Oe.title}),e.jsx("p",{className:"mt-2 max-w-2xl text-sm text-slate-600",children:Oe.subtitle})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(zl,{label:Oe.tier,tone:Oe.tier==="Premium"?"info":(Oe.tier==="Phase 2","neutral")}),Oe.status?e.jsx(zl,{label:Oe.status,tone:Oe.status==="Ready"?"good":"warn"}):null,Te?e.jsx(zl,{label:"Support role",tone:"warn"}):e.jsx(zl,{label:"Org role",tone:"neutral"}),e.jsxs(Si,{variant:"outline",onClick:()=>a(`${is.CONSOLE.ROOT}/settings_hub`),children:[e.jsx(Ni,{className:"h-4 w-4"})," Settings"]})]})]})}),ze()]})}),e.jsx("div",{className:"border-t border-slate-200 bg-white lg:hidden",children:e.jsxs("div",{className:"grid grid-cols-5 gap-2 px-3 py-2",children:[e.jsx(Fm,{active:x==="dashboard",label:"Home",icon:e.jsx(ly,{className:"h-5 w-5"}),onClick:()=>a(`${is.CONSOLE.ROOT}/dashboard`)}),e.jsx(Fm,{active:x==="approvals_inbox",label:"Approvals",icon:e.jsx(ig,{className:"h-5 w-5"}),badge:`${$e.approvals}`,onClick:()=>a(`${is.CONSOLE.ROOT}/approvals_inbox`)}),e.jsx(Fm,{active:x==="budgets",label:"Spend",icon:e.jsx(rg,{className:"h-5 w-5"}),onClick:()=>a(`${is.CONSOLE.ROOT}/budgets`)}),e.jsx(Fm,{active:x==="wallet_billing",label:"Wallet",icon:e.jsx(Ia,{className:"h-5 w-5"}),onClick:()=>a(`${is.CONSOLE.ROOT}/wallet_billing`)}),e.jsx(Fm,{active:!1,label:"More",icon:e.jsx(ry,{className:"h-5 w-5"}),onClick:()=>c(!0)})]})})]})]})}),e.jsxs(WB,{open:de,title:"Request access",subtitle:"This creates a request for Org Admin to grant permissions.",onClose:()=>ye(!1),footer:e.jsxs("div",{className:"flex flex-col-reverse gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Si,{variant:"outline",onClick:()=>ye(!1),children:"Cancel"}),e.jsxs(Si,{variant:"primary",onClick:()=>{if(Ke.trim().length<8){R({title:"Reason required",message:"Explain why you need access.",kind:"warn"});return}R({title:"Requested",message:"Access request created.",kind:"success"}),ye(!1)},children:[e.jsx(ri,{className:"h-4 w-4"})," Submit"]})]}),children:[e.jsx("textarea",{value:Ke,onChange:z=>Le(z.target.value),placeholder:"Explain why you need access and for how long",rows:4,className:"w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm font-semibold text-slate-900 shadow-sm outline-none focus:ring-4 focus:ring-emerald-100"}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Requests should be auditable and time-bounded in production."})]}),e.jsx(QB,{onAway:()=>{Q(!1)}})]}):e.jsx(KB,{onLogin:(z,Ae)=>{C(z),$(Ae),n(!0),a(`${is.CONSOLE.ROOT}/dashboard`),R({title:"Signed in",message:`${z} - ${Ae}`,kind:"success"})},orgs:["Acme Group Ltd","EVzone Demo Org","Kampala Holdings"],roles:["Org Owner","Org Admin","Manager","Accountant","Approver","Travel Coordinator","Employee","EVzone Support"]})}function QB({onAway:t}){return d.useEffect(()=>{const s=a=>{const l=a.target;l&&(l.closest("[role='menu']")||l.closest("input")||t())};return window.addEventListener("mousedown",s),()=>window.removeEventListener("mousedown",s)},[t]),null}function Fm({label:t,icon:s,badge:a,active:l,onClick:n}){return e.jsxs("button",{onClick:n,className:Hs("relative flex flex-col items-center justify-center gap-1 rounded-2xl px-2 py-2 text-xs font-semibold",l?"text-white":"text-slate-700 hover:bg-slate-100"),style:l?{background:Fi.green}:void 0,children:[e.jsx("div",{className:Hs("relative",l?"text-white":"text-slate-700"),children:s}),e.jsx("div",{className:"leading-none",children:t}),a?e.jsx("span",{className:"absolute right-2 top-1 rounded-full bg-rose-500 px-1.5 py-0.5 text-[10px] font-semibold text-white",children:a}):null]})}function YB(t){return Object.prototype.hasOwnProperty.call(Sf,t)}function JB(){const{id:t}=ZS(),s=t||"";if(!s||!YB(s))return e.jsx("div",{className:"min-h-screen bg-slate-50 px-4 py-10",children:e.jsxs("div",{className:"mx-auto max-w-3xl rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Page not found"}),e.jsxs("div",{className:"mt-2 text-sm text-slate-600",children:["Unknown page id: ",e.jsx("span",{className:"font-mono",children:s||"(missing)"})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[e.jsx(Tp,{to:"/",className:"rounded-2xl border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-800 hover:bg-slate-50",children:"Go to landing"}),e.jsx(Tp,{to:"/console",className:"rounded-2xl bg-emerald-600 px-4 py-2 text-sm font-semibold text-white hover:bg-emerald-700",children:"Open console"})]}),e.jsxs("div",{className:"mt-6 text-xs text-slate-500",children:["Tip: valid ids include ",e.jsx("span",{className:"font-mono",children:"dashboard"}),", ",e.jsx("span",{className:"font-mono",children:"notifications_activity"}),","," ",e.jsx("span",{className:"font-mono",children:"rfq"}),", etc."]})]})});const a=Sf[s];return e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx("div",{className:"border-b border-slate-200 bg-white",children:e.jsxs("div",{className:"mx-auto flex max-w-[1200px] items-center justify-between px-4 py-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"Standalone preview"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:s})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Tp,{to:"/console",className:"rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-800 hover:bg-slate-50",children:"Console"}),e.jsx(Tp,{to:"/",className:"rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-800 hover:bg-slate-50",children:"Landing"})]})]})}),e.jsx("div",{className:"mx-auto max-w-[1200px] px-4 py-6",children:e.jsx(a,{})})]})}const ZB=[{path:is.CONSOLE.ROOT,element:qt.createElement(Ob)},{path:`${is.CONSOLE.ROOT}/:pageId`,element:qt.createElement(Ob)},{path:`${is.CONSOLE.ROOT}/:pageId/:subPageId`,element:qt.createElement(Ob)}],eG=[{path:is.PAGES_PREVIEW,element:qt.createElement(JB)}];function tG(){return e.jsxs(AO,{children:[uU.map(t=>e.jsx($c,{path:t.path,element:t.element},t.path)),ZB.map(t=>e.jsx($c,{path:t.path,element:t.element},t.path)),MU.map(t=>e.jsx($c,{path:t.path,element:t.element},t.path)),eG.map(t=>e.jsx($c,{path:t.path,element:t.element},t.path)),e.jsx($c,{path:"*",element:e.jsx(CO,{to:is.HOME,replace:!0})})]})}class sG extends qt.Component{constructor(){super(...arguments);Mw(this,"state",{hasError:!1})}static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,l){console.error("ErrorBoundary caught:",a,l)}render(){var a;return this.state.hasError?e.jsx("div",{className:"min-h-screen bg-slate-50 px-4 py-10",children:e.jsx("div",{className:"mx-auto max-w-3xl",children:e.jsxs(B9,{severity:"error",variant:"outlined",children:[e.jsx(e$,{children:"Something went wrong"}),e.jsx("div",{className:"mt-2 text-sm",children:((a=this.state.error)==null?void 0:a.message)||"An unexpected error occurred."}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[e.jsx(F1,{variant:"contained",color:"primary",onClick:()=>window.location.reload(),children:"Reload"}),e.jsx(F1,{variant:"outlined",onClick:()=>this.setState({hasError:!1,error:void 0}),children:"Dismiss"})]})]})})}):this.props.children}}const Tb={green:"#03CD8C",orange:"#F77F00",slate:"#0F172A"},aG=yI(Y5({palette:{primary:{main:Tb.green},secondary:{main:Tb.orange},background:{default:"#F8FAFC",paper:"#FFFFFF"},text:{primary:Tb.slate}},shape:{borderRadius:16},typography:{fontFamily:["ui-sans-serif","system-ui","-apple-system","Segoe UI","Roboto","Helvetica","Arial","Apple Color Emoji","Segoe UI Emoji"].join(","),button:{textTransform:"none",fontWeight:700}},components:{MuiButton:{styleOverrides:{root:{borderRadius:18}}},MuiPaper:{styleOverrides:{root:{borderRadius:22}}}}}));Rb.createRoot(document.getElementById("root")).render(e.jsx(qt.StrictMode,{children:e.jsx(sG,{children:e.jsx(k5,{injectFirst:!0,children:e.jsxs(zI,{theme:aG,children:[e.jsx(x$,{}),e.jsx(DO,{children:e.jsx(tG,{})})]})})})}));
